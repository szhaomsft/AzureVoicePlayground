var Xz=Object.defineProperty;var l1=n=>{throw TypeError(n)};var Yz=(n,e,t)=>e in n?Xz(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var G=(n,e,t)=>Yz(n,typeof e!="symbol"?e+"":e,t),Nw=(n,e,t)=>e.has(n)||l1("Cannot "+t);var h=(n,e,t)=>(Nw(n,e,"read from private field"),t?t.call(n):e.get(n)),_=(n,e,t)=>e.has(n)?l1("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),T=(n,e,t,r)=>(Nw(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),D=(n,e,t)=>(Nw(n,e,"access private method"),t);var dn=(n,e,t,r)=>({set _(i){T(n,e,i,t)},get _(){return h(n,e,r)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function RN(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Qz(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var Ow={exports:{}},Ip={},Lw={exports:{}},Je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u1;function Zz(){if(u1)return Je;u1=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.iterator;function g(j){return j===null||typeof j!="object"?null:(j=f&&j[f]||j["@@iterator"],typeof j=="function"?j:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,S={};function w(j,$,pe){this.props=j,this.context=$,this.refs=S,this.updater=pe||m}w.prototype.isReactComponent={},w.prototype.setState=function(j,$){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,$,"setState")},w.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function b(){}b.prototype=w.prototype;function R(j,$,pe){this.props=j,this.context=$,this.refs=S,this.updater=pe||m}var P=R.prototype=new b;P.constructor=R,C(P,w.prototype),P.isPureReactComponent=!0;var I=Array.isArray,M=Object.prototype.hasOwnProperty,k={current:null},O={key:!0,ref:!0,__self:!0,__source:!0};function L(j,$,pe){var ge,ye={},re=null,te=null;if($!=null)for(ge in $.ref!==void 0&&(te=$.ref),$.key!==void 0&&(re=""+$.key),$)M.call($,ge)&&!O.hasOwnProperty(ge)&&(ye[ge]=$[ge]);var ae=arguments.length-2;if(ae===1)ye.children=pe;else if(1<ae){for(var ve=Array(ae),_e=0;_e<ae;_e++)ve[_e]=arguments[_e+2];ye.children=ve}if(j&&j.defaultProps)for(ge in ae=j.defaultProps,ae)ye[ge]===void 0&&(ye[ge]=ae[ge]);return{$$typeof:n,type:j,key:re,ref:te,props:ye,_owner:k.current}}function F(j,$){return{$$typeof:n,type:j.type,key:$,ref:j.ref,props:j.props,_owner:j._owner}}function H(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function V(j){var $={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(pe){return $[pe]})}var ie=/\/+/g;function J(j,$){return typeof j=="object"&&j!==null&&j.key!=null?V(""+j.key):$.toString(36)}function ee(j,$,pe,ge,ye){var re=typeof j;(re==="undefined"||re==="boolean")&&(j=null);var te=!1;if(j===null)te=!0;else switch(re){case"string":case"number":te=!0;break;case"object":switch(j.$$typeof){case n:case e:te=!0}}if(te)return te=j,ye=ye(te),j=ge===""?"."+J(te,0):ge,I(ye)?(pe="",j!=null&&(pe=j.replace(ie,"$&/")+"/"),ee(ye,$,pe,"",function(_e){return _e})):ye!=null&&(H(ye)&&(ye=F(ye,pe+(!ye.key||te&&te.key===ye.key?"":(""+ye.key).replace(ie,"$&/")+"/")+j)),$.push(ye)),1;if(te=0,ge=ge===""?".":ge+":",I(j))for(var ae=0;ae<j.length;ae++){re=j[ae];var ve=ge+J(re,ae);te+=ee(re,$,pe,ve,ye)}else if(ve=g(j),typeof ve=="function")for(j=ve.call(j),ae=0;!(re=j.next()).done;)re=re.value,ve=ge+J(re,ae++),te+=ee(re,$,pe,ve,ye);else if(re==="object")throw $=String(j),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return te}function se(j,$,pe){if(j==null)return j;var ge=[],ye=0;return ee(j,ge,"","",function(re){return $.call(pe,re,ye++)}),ge}function ne(j){if(j._status===-1){var $=j._result;$=$(),$.then(function(pe){(j._status===0||j._status===-1)&&(j._status=1,j._result=pe)},function(pe){(j._status===0||j._status===-1)&&(j._status=2,j._result=pe)}),j._status===-1&&(j._status=0,j._result=$)}if(j._status===1)return j._result.default;throw j._result}var Q={current:null},K={transition:null},oe={ReactCurrentDispatcher:Q,ReactCurrentBatchConfig:K,ReactCurrentOwner:k};function B(){throw Error("act(...) is not supported in production builds of React.")}return Je.Children={map:se,forEach:function(j,$,pe){se(j,function(){$.apply(this,arguments)},pe)},count:function(j){var $=0;return se(j,function(){$++}),$},toArray:function(j){return se(j,function($){return $})||[]},only:function(j){if(!H(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},Je.Component=w,Je.Fragment=t,Je.Profiler=i,Je.PureComponent=R,Je.StrictMode=r,Je.Suspense=l,Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oe,Je.act=B,Je.cloneElement=function(j,$,pe){if(j==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+j+".");var ge=C({},j.props),ye=j.key,re=j.ref,te=j._owner;if($!=null){if($.ref!==void 0&&(re=$.ref,te=k.current),$.key!==void 0&&(ye=""+$.key),j.type&&j.type.defaultProps)var ae=j.type.defaultProps;for(ve in $)M.call($,ve)&&!O.hasOwnProperty(ve)&&(ge[ve]=$[ve]===void 0&&ae!==void 0?ae[ve]:$[ve])}var ve=arguments.length-2;if(ve===1)ge.children=pe;else if(1<ve){ae=Array(ve);for(var _e=0;_e<ve;_e++)ae[_e]=arguments[_e+2];ge.children=ae}return{$$typeof:n,type:j.type,key:ye,ref:re,props:ge,_owner:te}},Je.createContext=function(j){return j={$$typeof:o,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},j.Provider={$$typeof:s,_context:j},j.Consumer=j},Je.createElement=L,Je.createFactory=function(j){var $=L.bind(null,j);return $.type=j,$},Je.createRef=function(){return{current:null}},Je.forwardRef=function(j){return{$$typeof:a,render:j}},Je.isValidElement=H,Je.lazy=function(j){return{$$typeof:p,_payload:{_status:-1,_result:j},_init:ne}},Je.memo=function(j,$){return{$$typeof:u,type:j,compare:$===void 0?null:$}},Je.startTransition=function(j){var $=K.transition;K.transition={};try{j()}finally{K.transition=$}},Je.unstable_act=B,Je.useCallback=function(j,$){return Q.current.useCallback(j,$)},Je.useContext=function(j){return Q.current.useContext(j)},Je.useDebugValue=function(){},Je.useDeferredValue=function(j){return Q.current.useDeferredValue(j)},Je.useEffect=function(j,$){return Q.current.useEffect(j,$)},Je.useId=function(){return Q.current.useId()},Je.useImperativeHandle=function(j,$,pe){return Q.current.useImperativeHandle(j,$,pe)},Je.useInsertionEffect=function(j,$){return Q.current.useInsertionEffect(j,$)},Je.useLayoutEffect=function(j,$){return Q.current.useLayoutEffect(j,$)},Je.useMemo=function(j,$){return Q.current.useMemo(j,$)},Je.useReducer=function(j,$,pe){return Q.current.useReducer(j,$,pe)},Je.useRef=function(j){return Q.current.useRef(j)},Je.useState=function(j){return Q.current.useState(j)},Je.useSyncExternalStore=function(j,$,pe){return Q.current.useSyncExternalStore(j,$,pe)},Je.useTransition=function(){return Q.current.useTransition()},Je.version="18.3.1",Je}var d1;function ZR(){return d1||(d1=1,Lw.exports=Zz()),Lw.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h1;function eF(){if(h1)return Ip;h1=1;var n=ZR(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,u){var p,f={},g=null,m=null;u!==void 0&&(g=""+u),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(m=l.ref);for(p in l)r.call(l,p)&&!s.hasOwnProperty(p)&&(f[p]=l[p]);if(a&&a.defaultProps)for(p in l=a.defaultProps,l)f[p]===void 0&&(f[p]=l[p]);return{$$typeof:e,type:a,key:g,ref:m,props:f,_owner:i.current}}return Ip.Fragment=t,Ip.jsx=o,Ip.jsxs=o,Ip}var p1;function tF(){return p1||(p1=1,Ow.exports=eF()),Ow.exports}var A=tF(),W=ZR();const nF=RN(W);var dC={},jw={exports:{}},vr={},zw={exports:{}},Fw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f1;function rF(){return f1||(f1=1,(function(n){function e(K,oe){var B=K.length;K.push(oe);e:for(;0<B;){var j=B-1>>>1,$=K[j];if(0<i($,oe))K[j]=oe,K[B]=$,B=j;else break e}}function t(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var oe=K[0],B=K.pop();if(B!==oe){K[0]=B;e:for(var j=0,$=K.length,pe=$>>>1;j<pe;){var ge=2*(j+1)-1,ye=K[ge],re=ge+1,te=K[re];if(0>i(ye,B))re<$&&0>i(te,ye)?(K[j]=te,K[re]=B,j=re):(K[j]=ye,K[ge]=B,j=ge);else if(re<$&&0>i(te,B))K[j]=te,K[re]=B,j=re;else break e}}return oe}function i(K,oe){var B=K.sortIndex-oe.sortIndex;return B!==0?B:K.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],p=1,f=null,g=3,m=!1,C=!1,S=!1,w=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(K){for(var oe=t(u);oe!==null;){if(oe.callback===null)r(u);else if(oe.startTime<=K)r(u),oe.sortIndex=oe.expirationTime,e(l,oe);else break;oe=t(u)}}function I(K){if(S=!1,P(K),!C)if(t(l)!==null)C=!0,ne(M);else{var oe=t(u);oe!==null&&Q(I,oe.startTime-K)}}function M(K,oe){C=!1,S&&(S=!1,b(L),L=-1),m=!0;var B=g;try{for(P(oe),f=t(l);f!==null&&(!(f.expirationTime>oe)||K&&!V());){var j=f.callback;if(typeof j=="function"){f.callback=null,g=f.priorityLevel;var $=j(f.expirationTime<=oe);oe=n.unstable_now(),typeof $=="function"?f.callback=$:f===t(l)&&r(l),P(oe)}else r(l);f=t(l)}if(f!==null)var pe=!0;else{var ge=t(u);ge!==null&&Q(I,ge.startTime-oe),pe=!1}return pe}finally{f=null,g=B,m=!1}}var k=!1,O=null,L=-1,F=5,H=-1;function V(){return!(n.unstable_now()-H<F)}function ie(){if(O!==null){var K=n.unstable_now();H=K;var oe=!0;try{oe=O(!0,K)}finally{oe?J():(k=!1,O=null)}}else k=!1}var J;if(typeof R=="function")J=function(){R(ie)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,se=ee.port2;ee.port1.onmessage=ie,J=function(){se.postMessage(null)}}else J=function(){w(ie,0)};function ne(K){O=K,k||(k=!0,J())}function Q(K,oe){L=w(function(){K(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(K){K.callback=null},n.unstable_continueExecution=function(){C||m||(C=!0,ne(M))},n.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<K?Math.floor(1e3/K):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(K){switch(g){case 1:case 2:case 3:var oe=3;break;default:oe=g}var B=g;g=oe;try{return K()}finally{g=B}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(K,oe){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var B=g;g=K;try{return oe()}finally{g=B}},n.unstable_scheduleCallback=function(K,oe,B){var j=n.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?j+B:j):B=j,K){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=B+$,K={id:p++,callback:oe,priorityLevel:K,startTime:B,expirationTime:$,sortIndex:-1},B>j?(K.sortIndex=B,e(u,K),t(l)===null&&K===t(u)&&(S?(b(L),L=-1):S=!0,Q(I,B-j))):(K.sortIndex=$,e(l,K),C||m||(C=!0,ne(M))),K},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(K){var oe=g;return function(){var B=g;g=oe;try{return K.apply(this,arguments)}finally{g=B}}}})(Fw)),Fw}var g1;function iF(){return g1||(g1=1,zw.exports=rF()),zw.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v1;function sF(){if(v1)return vr;v1=1;var n=ZR(),e=iF();function t(c){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+c,v=1;v<arguments.length;v++)d+="&args[]="+encodeURIComponent(arguments[v]);return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(c,d){o(c,d),o(c+"Capture",d)}function o(c,d){for(i[c]=d,c=0;c<d.length;c++)r.add(d[c])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function g(c){return l.call(f,c)?!0:l.call(p,c)?!1:u.test(c)?f[c]=!0:(p[c]=!0,!1)}function m(c,d,v,y){if(v!==null&&v.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return y?!1:v!==null?!v.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function C(c,d,v,y){if(d===null||typeof d>"u"||m(c,d,v,y))return!0;if(y)return!1;if(v!==null)switch(v.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function S(c,d,v,y,E,x,N){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=y,this.attributeNamespace=E,this.mustUseProperty=v,this.propertyName=c,this.type=d,this.sanitizeURL=x,this.removeEmptyString=N}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){w[c]=new S(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var d=c[0];w[d]=new S(d,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){w[c]=new S(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){w[c]=new S(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){w[c]=new S(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){w[c]=new S(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){w[c]=new S(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){w[c]=new S(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){w[c]=new S(c,5,!1,c.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function R(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var d=c.replace(b,R);w[d]=new S(d,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var d=c.replace(b,R);w[d]=new S(d,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var d=c.replace(b,R);w[d]=new S(d,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){w[c]=new S(c,1,!1,c.toLowerCase(),null,!1,!1)}),w.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){w[c]=new S(c,1,!1,c.toLowerCase(),null,!0,!0)});function P(c,d,v,y){var E=w.hasOwnProperty(d)?w[d]:null;(E!==null?E.type!==0:y||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(C(d,v,E,y)&&(v=null),y||E===null?g(d)&&(v===null?c.removeAttribute(d):c.setAttribute(d,""+v)):E.mustUseProperty?c[E.propertyName]=v===null?E.type===3?!1:"":v:(d=E.attributeName,y=E.attributeNamespace,v===null?c.removeAttribute(d):(E=E.type,v=E===3||E===4&&v===!0?"":""+v,y?c.setAttributeNS(y,d,v):c.setAttribute(d,v))))}var I=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,M=Symbol.for("react.element"),k=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),H=Symbol.for("react.provider"),V=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),se=Symbol.for("react.memo"),ne=Symbol.for("react.lazy"),Q=Symbol.for("react.offscreen"),K=Symbol.iterator;function oe(c){return c===null||typeof c!="object"?null:(c=K&&c[K]||c["@@iterator"],typeof c=="function"?c:null)}var B=Object.assign,j;function $(c){if(j===void 0)try{throw Error()}catch(v){var d=v.stack.trim().match(/\n( *(at )?)/);j=d&&d[1]||""}return`
`+j+c}var pe=!1;function ge(c,d){if(!c||pe)return"";pe=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Z){var y=Z}Reflect.construct(c,[],d)}else{try{d.call()}catch(Z){y=Z}c.call(d.prototype)}else{try{throw Error()}catch(Z){y=Z}c()}}catch(Z){if(Z&&y&&typeof Z.stack=="string"){for(var E=Z.stack.split(`
`),x=y.stack.split(`
`),N=E.length-1,z=x.length-1;1<=N&&0<=z&&E[N]!==x[z];)z--;for(;1<=N&&0<=z;N--,z--)if(E[N]!==x[z]){if(N!==1||z!==1)do if(N--,z--,0>z||E[N]!==x[z]){var U=`
`+E[N].replace(" at new "," at ");return c.displayName&&U.includes("<anonymous>")&&(U=U.replace("<anonymous>",c.displayName)),U}while(1<=N&&0<=z);break}}}finally{pe=!1,Error.prepareStackTrace=v}return(c=c?c.displayName||c.name:"")?$(c):""}function ye(c){switch(c.tag){case 5:return $(c.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return c=ge(c.type,!1),c;case 11:return c=ge(c.type.render,!1),c;case 1:return c=ge(c.type,!0),c;default:return""}}function re(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case O:return"Fragment";case k:return"Portal";case F:return"Profiler";case L:return"StrictMode";case J:return"Suspense";case ee:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case V:return(c.displayName||"Context")+".Consumer";case H:return(c._context.displayName||"Context")+".Provider";case ie:var d=c.render;return c=c.displayName,c||(c=d.displayName||d.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case se:return d=c.displayName||null,d!==null?d:re(c.type)||"Memo";case ne:d=c._payload,c=c._init;try{return re(c(d))}catch{}}return null}function te(c){var d=c.type;switch(c.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=d.render,c=c.displayName||c.name||"",d.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return re(d);case 8:return d===L?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function ae(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function ve(c){var d=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function _e(c){var d=ve(c)?"checked":"value",v=Object.getOwnPropertyDescriptor(c.constructor.prototype,d),y=""+c[d];if(!c.hasOwnProperty(d)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var E=v.get,x=v.set;return Object.defineProperty(c,d,{configurable:!0,get:function(){return E.call(this)},set:function(N){y=""+N,x.call(this,N)}}),Object.defineProperty(c,d,{enumerable:v.enumerable}),{getValue:function(){return y},setValue:function(N){y=""+N},stopTracking:function(){c._valueTracker=null,delete c[d]}}}}function Ce(c){c._valueTracker||(c._valueTracker=_e(c))}function Ke(c){if(!c)return!1;var d=c._valueTracker;if(!d)return!0;var v=d.getValue(),y="";return c&&(y=ve(c)?c.checked?"true":"false":c.value),c=y,c!==v?(d.setValue(c),!0):!1}function he(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function $e(c,d){var v=d.checked;return B({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:v??c._wrapperState.initialChecked})}function Ge(c,d){var v=d.defaultValue==null?"":d.defaultValue,y=d.checked!=null?d.checked:d.defaultChecked;v=ae(d.value!=null?d.value:v),c._wrapperState={initialChecked:y,initialValue:v,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function Ve(c,d){d=d.checked,d!=null&&P(c,"checked",d,!1)}function st(c,d){Ve(c,d);var v=ae(d.value),y=d.type;if(v!=null)y==="number"?(v===0&&c.value===""||c.value!=v)&&(c.value=""+v):c.value!==""+v&&(c.value=""+v);else if(y==="submit"||y==="reset"){c.removeAttribute("value");return}d.hasOwnProperty("value")?Yn(c,d.type,v):d.hasOwnProperty("defaultValue")&&Yn(c,d.type,ae(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(c.defaultChecked=!!d.defaultChecked)}function xn(c,d,v){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var y=d.type;if(!(y!=="submit"&&y!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+c._wrapperState.initialValue,v||d===c.value||(c.value=d),c.defaultValue=d}v=c.name,v!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,v!==""&&(c.name=v)}function Yn(c,d,v){(d!=="number"||he(c.ownerDocument)!==c)&&(v==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+v&&(c.defaultValue=""+v))}var oi=Array.isArray;function Tr(c,d,v,y){if(c=c.options,d){d={};for(var E=0;E<v.length;E++)d["$"+v[E]]=!0;for(v=0;v<c.length;v++)E=d.hasOwnProperty("$"+c[v].value),c[v].selected!==E&&(c[v].selected=E),E&&y&&(c[v].defaultSelected=!0)}else{for(v=""+ae(v),d=null,E=0;E<c.length;E++){if(c[E].value===v){c[E].selected=!0,y&&(c[E].defaultSelected=!0);return}d!==null||c[E].disabled||(d=c[E])}d!==null&&(d.selected=!0)}}function is(c,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return B({},d,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function ss(c,d){var v=d.value;if(v==null){if(v=d.children,d=d.defaultValue,v!=null){if(d!=null)throw Error(t(92));if(oi(v)){if(1<v.length)throw Error(t(93));v=v[0]}d=v}d==null&&(d=""),v=d}c._wrapperState={initialValue:ae(v)}}function os(c,d){var v=ae(d.value),y=ae(d.defaultValue);v!=null&&(v=""+v,v!==c.value&&(c.value=v),d.defaultValue==null&&c.defaultValue!==v&&(c.defaultValue=v)),y!=null&&(c.defaultValue=""+y)}function as(c){var d=c.textContent;d===c._wrapperState.initialValue&&d!==""&&d!==null&&(c.value=d)}function ce(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ye(c,d){return c==null||c==="http://www.w3.org/1999/xhtml"?ce(d):c==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var vt,Qn=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,v,y,E){MSApp.execUnsafeLocalFunction(function(){return c(d,v,y,E)})}:c})(function(c,d){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=d;else{for(vt=vt||document.createElement("div"),vt.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=vt.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;d.firstChild;)c.appendChild(d.firstChild)}});function cs(c,d){if(d){var v=c.firstChild;if(v&&v===c.lastChild&&v.nodeType===3){v.nodeValue=d;return}}c.textContent=d}var ls={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_u=["Webkit","ms","Moz","O"];Object.keys(ls).forEach(function(c){_u.forEach(function(d){d=d+c.charAt(0).toUpperCase()+c.substring(1),ls[d]=ls[c]})});function Cc(c,d,v){return d==null||typeof d=="boolean"||d===""?"":v||typeof d!="number"||d===0||ls.hasOwnProperty(c)&&ls[c]?(""+d).trim():d+"px"}function bc(c,d){c=c.style;for(var v in d)if(d.hasOwnProperty(v)){var y=v.indexOf("--")===0,E=Cc(v,d[v],y);v==="float"&&(v="cssFloat"),y?c.setProperty(v,E):c[v]=E}}var ku=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yo(c,d){if(d){if(ku[c]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function Qo(c,d){if(c.indexOf("-")===-1)return typeof d.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zo=null;function wc(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Gh=null,qs=null,ea=null;function nS(c){if(c=fp(c)){if(typeof Gh!="function")throw Error(t(280));var d=c.stateNode;d&&(d=PS(d),Gh(c.stateNode,c.type,d))}}function rS(c){qs?ea?ea.push(c):ea=[c]:qs=c}function xP(){if(qs){var c=qs,d=ea;if(ea=qs=null,nS(c),d)for(c=0;c<d.length;c++)nS(d[c])}}function IP(c,d){return c(d)}function _P(){}var Y0=!1;function kP(c,d,v){if(Y0)return c(d,v);Y0=!0;try{return IP(c,d,v)}finally{Y0=!1,(qs!==null||ea!==null)&&(_P(),xP())}}function Kh(c,d){var v=c.stateNode;if(v===null)return null;var y=PS(v);if(y===null)return null;v=y[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(c=c.type,y=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!y;break e;default:c=!1}if(c)return null;if(v&&typeof v!="function")throw Error(t(231,d,typeof v));return v}var Q0=!1;if(a)try{var $h={};Object.defineProperty($h,"passive",{get:function(){Q0=!0}}),window.addEventListener("test",$h,$h),window.removeEventListener("test",$h,$h)}catch{Q0=!1}function nj(c,d,v,y,E,x,N,z,U){var Z=Array.prototype.slice.call(arguments,3);try{d.apply(v,Z)}catch(ue){this.onError(ue)}}var Jh=!1,iS=null,sS=!1,Z0=null,rj={onError:function(c){Jh=!0,iS=c}};function ij(c,d,v,y,E,x,N,z,U){Jh=!1,iS=null,nj.apply(rj,arguments)}function sj(c,d,v,y,E,x,N,z,U){if(ij.apply(this,arguments),Jh){if(Jh){var Z=iS;Jh=!1,iS=null}else throw Error(t(198));sS||(sS=!0,Z0=Z)}}function Ac(c){var d=c,v=c;if(c.alternate)for(;d.return;)d=d.return;else{c=d;do d=c,(d.flags&4098)!==0&&(v=d.return),c=d.return;while(c)}return d.tag===3?v:null}function MP(c){if(c.tag===13){var d=c.memoizedState;if(d===null&&(c=c.alternate,c!==null&&(d=c.memoizedState)),d!==null)return d.dehydrated}return null}function DP(c){if(Ac(c)!==c)throw Error(t(188))}function oj(c){var d=c.alternate;if(!d){if(d=Ac(c),d===null)throw Error(t(188));return d!==c?null:c}for(var v=c,y=d;;){var E=v.return;if(E===null)break;var x=E.alternate;if(x===null){if(y=E.return,y!==null){v=y;continue}break}if(E.child===x.child){for(x=E.child;x;){if(x===v)return DP(E),c;if(x===y)return DP(E),d;x=x.sibling}throw Error(t(188))}if(v.return!==y.return)v=E,y=x;else{for(var N=!1,z=E.child;z;){if(z===v){N=!0,v=E,y=x;break}if(z===y){N=!0,y=E,v=x;break}z=z.sibling}if(!N){for(z=x.child;z;){if(z===v){N=!0,v=x,y=E;break}if(z===y){N=!0,y=x,v=E;break}z=z.sibling}if(!N)throw Error(t(189))}}if(v.alternate!==y)throw Error(t(190))}if(v.tag!==3)throw Error(t(188));return v.stateNode.current===v?c:d}function NP(c){return c=oj(c),c!==null?OP(c):null}function OP(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var d=OP(c);if(d!==null)return d;c=c.sibling}return null}var LP=e.unstable_scheduleCallback,jP=e.unstable_cancelCallback,aj=e.unstable_shouldYield,cj=e.unstable_requestPaint,Zt=e.unstable_now,lj=e.unstable_getCurrentPriorityLevel,eb=e.unstable_ImmediatePriority,zP=e.unstable_UserBlockingPriority,oS=e.unstable_NormalPriority,uj=e.unstable_LowPriority,FP=e.unstable_IdlePriority,aS=null,us=null;function dj(c){if(us&&typeof us.onCommitFiberRoot=="function")try{us.onCommitFiberRoot(aS,c,void 0,(c.current.flags&128)===128)}catch{}}var ki=Math.clz32?Math.clz32:fj,hj=Math.log,pj=Math.LN2;function fj(c){return c>>>=0,c===0?32:31-(hj(c)/pj|0)|0}var cS=64,lS=4194304;function Xh(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function uS(c,d){var v=c.pendingLanes;if(v===0)return 0;var y=0,E=c.suspendedLanes,x=c.pingedLanes,N=v&268435455;if(N!==0){var z=N&~E;z!==0?y=Xh(z):(x&=N,x!==0&&(y=Xh(x)))}else N=v&~E,N!==0?y=Xh(N):x!==0&&(y=Xh(x));if(y===0)return 0;if(d!==0&&d!==y&&(d&E)===0&&(E=y&-y,x=d&-d,E>=x||E===16&&(x&4194240)!==0))return d;if((y&4)!==0&&(y|=v&16),d=c.entangledLanes,d!==0)for(c=c.entanglements,d&=y;0<d;)v=31-ki(d),E=1<<v,y|=c[v],d&=~E;return y}function gj(c,d){switch(c){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vj(c,d){for(var v=c.suspendedLanes,y=c.pingedLanes,E=c.expirationTimes,x=c.pendingLanes;0<x;){var N=31-ki(x),z=1<<N,U=E[N];U===-1?((z&v)===0||(z&y)!==0)&&(E[N]=gj(z,d)):U<=d&&(c.expiredLanes|=z),x&=~z}}function tb(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function BP(){var c=cS;return cS<<=1,(cS&4194240)===0&&(cS=64),c}function nb(c){for(var d=[],v=0;31>v;v++)d.push(c);return d}function Yh(c,d,v){c.pendingLanes|=d,d!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,d=31-ki(d),c[d]=v}function mj(c,d){var v=c.pendingLanes&~d;c.pendingLanes=d,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=d,c.mutableReadLanes&=d,c.entangledLanes&=d,d=c.entanglements;var y=c.eventTimes;for(c=c.expirationTimes;0<v;){var E=31-ki(v),x=1<<E;d[E]=0,y[E]=-1,c[E]=-1,v&=~x}}function rb(c,d){var v=c.entangledLanes|=d;for(c=c.entanglements;v;){var y=31-ki(v),E=1<<y;E&d|c[y]&d&&(c[y]|=d),v&=~E}}var ht=0;function UP(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var HP,ib,WP,qP,VP,sb=!1,dS=[],ta=null,na=null,ra=null,Qh=new Map,Zh=new Map,ia=[],yj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function GP(c,d){switch(c){case"focusin":case"focusout":ta=null;break;case"dragenter":case"dragleave":na=null;break;case"mouseover":case"mouseout":ra=null;break;case"pointerover":case"pointerout":Qh.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zh.delete(d.pointerId)}}function ep(c,d,v,y,E,x){return c===null||c.nativeEvent!==x?(c={blockedOn:d,domEventName:v,eventSystemFlags:y,nativeEvent:x,targetContainers:[E]},d!==null&&(d=fp(d),d!==null&&ib(d)),c):(c.eventSystemFlags|=y,d=c.targetContainers,E!==null&&d.indexOf(E)===-1&&d.push(E),c)}function Sj(c,d,v,y,E){switch(d){case"focusin":return ta=ep(ta,c,d,v,y,E),!0;case"dragenter":return na=ep(na,c,d,v,y,E),!0;case"mouseover":return ra=ep(ra,c,d,v,y,E),!0;case"pointerover":var x=E.pointerId;return Qh.set(x,ep(Qh.get(x)||null,c,d,v,y,E)),!0;case"gotpointercapture":return x=E.pointerId,Zh.set(x,ep(Zh.get(x)||null,c,d,v,y,E)),!0}return!1}function KP(c){var d=Ec(c.target);if(d!==null){var v=Ac(d);if(v!==null){if(d=v.tag,d===13){if(d=MP(v),d!==null){c.blockedOn=d,VP(c.priority,function(){WP(v)});return}}else if(d===3&&v.stateNode.current.memoizedState.isDehydrated){c.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}c.blockedOn=null}function hS(c){if(c.blockedOn!==null)return!1;for(var d=c.targetContainers;0<d.length;){var v=ab(c.domEventName,c.eventSystemFlags,d[0],c.nativeEvent);if(v===null){v=c.nativeEvent;var y=new v.constructor(v.type,v);Zo=y,v.target.dispatchEvent(y),Zo=null}else return d=fp(v),d!==null&&ib(d),c.blockedOn=v,!1;d.shift()}return!0}function $P(c,d,v){hS(c)&&v.delete(d)}function Cj(){sb=!1,ta!==null&&hS(ta)&&(ta=null),na!==null&&hS(na)&&(na=null),ra!==null&&hS(ra)&&(ra=null),Qh.forEach($P),Zh.forEach($P)}function tp(c,d){c.blockedOn===d&&(c.blockedOn=null,sb||(sb=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Cj)))}function np(c){function d(E){return tp(E,c)}if(0<dS.length){tp(dS[0],c);for(var v=1;v<dS.length;v++){var y=dS[v];y.blockedOn===c&&(y.blockedOn=null)}}for(ta!==null&&tp(ta,c),na!==null&&tp(na,c),ra!==null&&tp(ra,c),Qh.forEach(d),Zh.forEach(d),v=0;v<ia.length;v++)y=ia[v],y.blockedOn===c&&(y.blockedOn=null);for(;0<ia.length&&(v=ia[0],v.blockedOn===null);)KP(v),v.blockedOn===null&&ia.shift()}var Mu=I.ReactCurrentBatchConfig,pS=!0;function bj(c,d,v,y){var E=ht,x=Mu.transition;Mu.transition=null;try{ht=1,ob(c,d,v,y)}finally{ht=E,Mu.transition=x}}function wj(c,d,v,y){var E=ht,x=Mu.transition;Mu.transition=null;try{ht=4,ob(c,d,v,y)}finally{ht=E,Mu.transition=x}}function ob(c,d,v,y){if(pS){var E=ab(c,d,v,y);if(E===null)Eb(c,d,y,fS,v),GP(c,y);else if(Sj(E,c,d,v,y))y.stopPropagation();else if(GP(c,y),d&4&&-1<yj.indexOf(c)){for(;E!==null;){var x=fp(E);if(x!==null&&HP(x),x=ab(c,d,v,y),x===null&&Eb(c,d,y,fS,v),x===E)break;E=x}E!==null&&y.stopPropagation()}else Eb(c,d,y,null,v)}}var fS=null;function ab(c,d,v,y){if(fS=null,c=wc(y),c=Ec(c),c!==null)if(d=Ac(c),d===null)c=null;else if(v=d.tag,v===13){if(c=MP(d),c!==null)return c;c=null}else if(v===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;c=null}else d!==c&&(c=null);return fS=c,null}function JP(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lj()){case eb:return 1;case zP:return 4;case oS:case uj:return 16;case FP:return 536870912;default:return 16}default:return 16}}var sa=null,cb=null,gS=null;function XP(){if(gS)return gS;var c,d=cb,v=d.length,y,E="value"in sa?sa.value:sa.textContent,x=E.length;for(c=0;c<v&&d[c]===E[c];c++);var N=v-c;for(y=1;y<=N&&d[v-y]===E[x-y];y++);return gS=E.slice(c,1<y?1-y:void 0)}function vS(c){var d=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&d===13&&(c=13)):c=d,c===10&&(c=13),32<=c||c===13?c:0}function mS(){return!0}function YP(){return!1}function xr(c){function d(v,y,E,x,N){this._reactName=v,this._targetInst=E,this.type=y,this.nativeEvent=x,this.target=N,this.currentTarget=null;for(var z in c)c.hasOwnProperty(z)&&(v=c[z],this[z]=v?v(x):x[z]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?mS:YP,this.isPropagationStopped=YP,this}return B(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=mS)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=mS)},persist:function(){},isPersistent:mS}),d}var Du={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lb=xr(Du),rp=B({},Du,{view:0,detail:0}),Aj=xr(rp),ub,db,ip,yS=B({},rp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pb,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==ip&&(ip&&c.type==="mousemove"?(ub=c.screenX-ip.screenX,db=c.screenY-ip.screenY):db=ub=0,ip=c),ub)},movementY:function(c){return"movementY"in c?c.movementY:db}}),QP=xr(yS),Ej=B({},yS,{dataTransfer:0}),Rj=xr(Ej),Pj=B({},rp,{relatedTarget:0}),hb=xr(Pj),Tj=B({},Du,{animationName:0,elapsedTime:0,pseudoElement:0}),xj=xr(Tj),Ij=B({},Du,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),_j=xr(Ij),kj=B({},Du,{data:0}),ZP=xr(kj),Mj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Oj(c){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(c):(c=Nj[c])?!!d[c]:!1}function pb(){return Oj}var Lj=B({},rp,{key:function(c){if(c.key){var d=Mj[c.key]||c.key;if(d!=="Unidentified")return d}return c.type==="keypress"?(c=vS(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?Dj[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pb,charCode:function(c){return c.type==="keypress"?vS(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?vS(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),jj=xr(Lj),zj=B({},yS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),eT=xr(zj),Fj=B({},rp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pb}),Bj=xr(Fj),Uj=B({},Du,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hj=xr(Uj),Wj=B({},yS,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),qj=xr(Wj),Vj=[9,13,27,32],fb=a&&"CompositionEvent"in window,sp=null;a&&"documentMode"in document&&(sp=document.documentMode);var Gj=a&&"TextEvent"in window&&!sp,tT=a&&(!fb||sp&&8<sp&&11>=sp),nT=" ",rT=!1;function iT(c,d){switch(c){case"keyup":return Vj.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sT(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Nu=!1;function Kj(c,d){switch(c){case"compositionend":return sT(d);case"keypress":return d.which!==32?null:(rT=!0,nT);case"textInput":return c=d.data,c===nT&&rT?null:c;default:return null}}function $j(c,d){if(Nu)return c==="compositionend"||!fb&&iT(c,d)?(c=XP(),gS=cb=sa=null,Nu=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return tT&&d.locale!=="ko"?null:d.data;default:return null}}var Jj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oT(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d==="input"?!!Jj[c.type]:d==="textarea"}function aT(c,d,v,y){rS(y),d=AS(d,"onChange"),0<d.length&&(v=new lb("onChange","change",null,v,y),c.push({event:v,listeners:d}))}var op=null,ap=null;function Xj(c){RT(c,0)}function SS(c){var d=Fu(c);if(Ke(d))return c}function Yj(c,d){if(c==="change")return d}var cT=!1;if(a){var gb;if(a){var vb="oninput"in document;if(!vb){var lT=document.createElement("div");lT.setAttribute("oninput","return;"),vb=typeof lT.oninput=="function"}gb=vb}else gb=!1;cT=gb&&(!document.documentMode||9<document.documentMode)}function uT(){op&&(op.detachEvent("onpropertychange",dT),ap=op=null)}function dT(c){if(c.propertyName==="value"&&SS(ap)){var d=[];aT(d,ap,c,wc(c)),kP(Xj,d)}}function Qj(c,d,v){c==="focusin"?(uT(),op=d,ap=v,op.attachEvent("onpropertychange",dT)):c==="focusout"&&uT()}function Zj(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return SS(ap)}function ez(c,d){if(c==="click")return SS(d)}function tz(c,d){if(c==="input"||c==="change")return SS(d)}function nz(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var Mi=typeof Object.is=="function"?Object.is:nz;function cp(c,d){if(Mi(c,d))return!0;if(typeof c!="object"||c===null||typeof d!="object"||d===null)return!1;var v=Object.keys(c),y=Object.keys(d);if(v.length!==y.length)return!1;for(y=0;y<v.length;y++){var E=v[y];if(!l.call(d,E)||!Mi(c[E],d[E]))return!1}return!0}function hT(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function pT(c,d){var v=hT(c);c=0;for(var y;v;){if(v.nodeType===3){if(y=c+v.textContent.length,c<=d&&y>=d)return{node:v,offset:d-c};c=y}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=hT(v)}}function fT(c,d){return c&&d?c===d?!0:c&&c.nodeType===3?!1:d&&d.nodeType===3?fT(c,d.parentNode):"contains"in c?c.contains(d):c.compareDocumentPosition?!!(c.compareDocumentPosition(d)&16):!1:!1}function gT(){for(var c=window,d=he();d instanceof c.HTMLIFrameElement;){try{var v=typeof d.contentWindow.location.href=="string"}catch{v=!1}if(v)c=d.contentWindow;else break;d=he(c.document)}return d}function mb(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d&&(d==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||d==="textarea"||c.contentEditable==="true")}function rz(c){var d=gT(),v=c.focusedElem,y=c.selectionRange;if(d!==v&&v&&v.ownerDocument&&fT(v.ownerDocument.documentElement,v)){if(y!==null&&mb(v)){if(d=y.start,c=y.end,c===void 0&&(c=d),"selectionStart"in v)v.selectionStart=d,v.selectionEnd=Math.min(c,v.value.length);else if(c=(d=v.ownerDocument||document)&&d.defaultView||window,c.getSelection){c=c.getSelection();var E=v.textContent.length,x=Math.min(y.start,E);y=y.end===void 0?x:Math.min(y.end,E),!c.extend&&x>y&&(E=y,y=x,x=E),E=pT(v,x);var N=pT(v,y);E&&N&&(c.rangeCount!==1||c.anchorNode!==E.node||c.anchorOffset!==E.offset||c.focusNode!==N.node||c.focusOffset!==N.offset)&&(d=d.createRange(),d.setStart(E.node,E.offset),c.removeAllRanges(),x>y?(c.addRange(d),c.extend(N.node,N.offset)):(d.setEnd(N.node,N.offset),c.addRange(d)))}}for(d=[],c=v;c=c.parentNode;)c.nodeType===1&&d.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<d.length;v++)c=d[v],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var iz=a&&"documentMode"in document&&11>=document.documentMode,Ou=null,yb=null,lp=null,Sb=!1;function vT(c,d,v){var y=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;Sb||Ou==null||Ou!==he(y)||(y=Ou,"selectionStart"in y&&mb(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),lp&&cp(lp,y)||(lp=y,y=AS(yb,"onSelect"),0<y.length&&(d=new lb("onSelect","select",null,d,v),c.push({event:d,listeners:y}),d.target=Ou)))}function CS(c,d){var v={};return v[c.toLowerCase()]=d.toLowerCase(),v["Webkit"+c]="webkit"+d,v["Moz"+c]="moz"+d,v}var Lu={animationend:CS("Animation","AnimationEnd"),animationiteration:CS("Animation","AnimationIteration"),animationstart:CS("Animation","AnimationStart"),transitionend:CS("Transition","TransitionEnd")},Cb={},mT={};a&&(mT=document.createElement("div").style,"AnimationEvent"in window||(delete Lu.animationend.animation,delete Lu.animationiteration.animation,delete Lu.animationstart.animation),"TransitionEvent"in window||delete Lu.transitionend.transition);function bS(c){if(Cb[c])return Cb[c];if(!Lu[c])return c;var d=Lu[c],v;for(v in d)if(d.hasOwnProperty(v)&&v in mT)return Cb[c]=d[v];return c}var yT=bS("animationend"),ST=bS("animationiteration"),CT=bS("animationstart"),bT=bS("transitionend"),wT=new Map,AT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oa(c,d){wT.set(c,d),s(d,[c])}for(var bb=0;bb<AT.length;bb++){var wb=AT[bb],sz=wb.toLowerCase(),oz=wb[0].toUpperCase()+wb.slice(1);oa(sz,"on"+oz)}oa(yT,"onAnimationEnd"),oa(ST,"onAnimationIteration"),oa(CT,"onAnimationStart"),oa("dblclick","onDoubleClick"),oa("focusin","onFocus"),oa("focusout","onBlur"),oa(bT,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var up="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),az=new Set("cancel close invalid load scroll toggle".split(" ").concat(up));function ET(c,d,v){var y=c.type||"unknown-event";c.currentTarget=v,sj(y,d,void 0,c),c.currentTarget=null}function RT(c,d){d=(d&4)!==0;for(var v=0;v<c.length;v++){var y=c[v],E=y.event;y=y.listeners;e:{var x=void 0;if(d)for(var N=y.length-1;0<=N;N--){var z=y[N],U=z.instance,Z=z.currentTarget;if(z=z.listener,U!==x&&E.isPropagationStopped())break e;ET(E,z,Z),x=U}else for(N=0;N<y.length;N++){if(z=y[N],U=z.instance,Z=z.currentTarget,z=z.listener,U!==x&&E.isPropagationStopped())break e;ET(E,z,Z),x=U}}}if(sS)throw c=Z0,sS=!1,Z0=null,c}function kt(c,d){var v=d[_b];v===void 0&&(v=d[_b]=new Set);var y=c+"__bubble";v.has(y)||(PT(d,c,2,!1),v.add(y))}function Ab(c,d,v){var y=0;d&&(y|=4),PT(v,c,y,d)}var wS="_reactListening"+Math.random().toString(36).slice(2);function dp(c){if(!c[wS]){c[wS]=!0,r.forEach(function(v){v!=="selectionchange"&&(az.has(v)||Ab(v,!1,c),Ab(v,!0,c))});var d=c.nodeType===9?c:c.ownerDocument;d===null||d[wS]||(d[wS]=!0,Ab("selectionchange",!1,d))}}function PT(c,d,v,y){switch(JP(d)){case 1:var E=bj;break;case 4:E=wj;break;default:E=ob}v=E.bind(null,d,v,c),E=void 0,!Q0||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(E=!0),y?E!==void 0?c.addEventListener(d,v,{capture:!0,passive:E}):c.addEventListener(d,v,!0):E!==void 0?c.addEventListener(d,v,{passive:E}):c.addEventListener(d,v,!1)}function Eb(c,d,v,y,E){var x=y;if((d&1)===0&&(d&2)===0&&y!==null)e:for(;;){if(y===null)return;var N=y.tag;if(N===3||N===4){var z=y.stateNode.containerInfo;if(z===E||z.nodeType===8&&z.parentNode===E)break;if(N===4)for(N=y.return;N!==null;){var U=N.tag;if((U===3||U===4)&&(U=N.stateNode.containerInfo,U===E||U.nodeType===8&&U.parentNode===E))return;N=N.return}for(;z!==null;){if(N=Ec(z),N===null)return;if(U=N.tag,U===5||U===6){y=x=N;continue e}z=z.parentNode}}y=y.return}kP(function(){var Z=x,ue=wc(v),de=[];e:{var le=wT.get(c);if(le!==void 0){var we=lb,Pe=c;switch(c){case"keypress":if(vS(v)===0)break e;case"keydown":case"keyup":we=jj;break;case"focusin":Pe="focus",we=hb;break;case"focusout":Pe="blur",we=hb;break;case"beforeblur":case"afterblur":we=hb;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=QP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=Rj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=Bj;break;case yT:case ST:case CT:we=xj;break;case bT:we=Hj;break;case"scroll":we=Aj;break;case"wheel":we=qj;break;case"copy":case"cut":case"paste":we=_j;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=eT}var Te=(d&4)!==0,en=!Te&&c==="scroll",X=Te?le!==null?le+"Capture":null:le;Te=[];for(var q=Z,Y;q!==null;){Y=q;var fe=Y.stateNode;if(Y.tag===5&&fe!==null&&(Y=fe,X!==null&&(fe=Kh(q,X),fe!=null&&Te.push(hp(q,fe,Y)))),en)break;q=q.return}0<Te.length&&(le=new we(le,Pe,null,v,ue),de.push({event:le,listeners:Te}))}}if((d&7)===0){e:{if(le=c==="mouseover"||c==="pointerover",we=c==="mouseout"||c==="pointerout",le&&v!==Zo&&(Pe=v.relatedTarget||v.fromElement)&&(Ec(Pe)||Pe[Vs]))break e;if((we||le)&&(le=ue.window===ue?ue:(le=ue.ownerDocument)?le.defaultView||le.parentWindow:window,we?(Pe=v.relatedTarget||v.toElement,we=Z,Pe=Pe?Ec(Pe):null,Pe!==null&&(en=Ac(Pe),Pe!==en||Pe.tag!==5&&Pe.tag!==6)&&(Pe=null)):(we=null,Pe=Z),we!==Pe)){if(Te=QP,fe="onMouseLeave",X="onMouseEnter",q="mouse",(c==="pointerout"||c==="pointerover")&&(Te=eT,fe="onPointerLeave",X="onPointerEnter",q="pointer"),en=we==null?le:Fu(we),Y=Pe==null?le:Fu(Pe),le=new Te(fe,q+"leave",we,v,ue),le.target=en,le.relatedTarget=Y,fe=null,Ec(ue)===Z&&(Te=new Te(X,q+"enter",Pe,v,ue),Te.target=Y,Te.relatedTarget=en,fe=Te),en=fe,we&&Pe)t:{for(Te=we,X=Pe,q=0,Y=Te;Y;Y=ju(Y))q++;for(Y=0,fe=X;fe;fe=ju(fe))Y++;for(;0<q-Y;)Te=ju(Te),q--;for(;0<Y-q;)X=ju(X),Y--;for(;q--;){if(Te===X||X!==null&&Te===X.alternate)break t;Te=ju(Te),X=ju(X)}Te=null}else Te=null;we!==null&&TT(de,le,we,Te,!1),Pe!==null&&en!==null&&TT(de,en,Pe,Te,!0)}}e:{if(le=Z?Fu(Z):window,we=le.nodeName&&le.nodeName.toLowerCase(),we==="select"||we==="input"&&le.type==="file")var Ie=Yj;else if(oT(le))if(cT)Ie=tz;else{Ie=Zj;var Me=Qj}else(we=le.nodeName)&&we.toLowerCase()==="input"&&(le.type==="checkbox"||le.type==="radio")&&(Ie=ez);if(Ie&&(Ie=Ie(c,Z))){aT(de,Ie,v,ue);break e}Me&&Me(c,le,Z),c==="focusout"&&(Me=le._wrapperState)&&Me.controlled&&le.type==="number"&&Yn(le,"number",le.value)}switch(Me=Z?Fu(Z):window,c){case"focusin":(oT(Me)||Me.contentEditable==="true")&&(Ou=Me,yb=Z,lp=null);break;case"focusout":lp=yb=Ou=null;break;case"mousedown":Sb=!0;break;case"contextmenu":case"mouseup":case"dragend":Sb=!1,vT(de,v,ue);break;case"selectionchange":if(iz)break;case"keydown":case"keyup":vT(de,v,ue)}var De;if(fb)e:{switch(c){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Nu?iT(c,v)&&(je="onCompositionEnd"):c==="keydown"&&v.keyCode===229&&(je="onCompositionStart");je&&(tT&&v.locale!=="ko"&&(Nu||je!=="onCompositionStart"?je==="onCompositionEnd"&&Nu&&(De=XP()):(sa=ue,cb="value"in sa?sa.value:sa.textContent,Nu=!0)),Me=AS(Z,je),0<Me.length&&(je=new ZP(je,c,null,v,ue),de.push({event:je,listeners:Me}),De?je.data=De:(De=sT(v),De!==null&&(je.data=De)))),(De=Gj?Kj(c,v):$j(c,v))&&(Z=AS(Z,"onBeforeInput"),0<Z.length&&(ue=new ZP("onBeforeInput","beforeinput",null,v,ue),de.push({event:ue,listeners:Z}),ue.data=De))}RT(de,d)})}function hp(c,d,v){return{instance:c,listener:d,currentTarget:v}}function AS(c,d){for(var v=d+"Capture",y=[];c!==null;){var E=c,x=E.stateNode;E.tag===5&&x!==null&&(E=x,x=Kh(c,v),x!=null&&y.unshift(hp(c,x,E)),x=Kh(c,d),x!=null&&y.push(hp(c,x,E))),c=c.return}return y}function ju(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function TT(c,d,v,y,E){for(var x=d._reactName,N=[];v!==null&&v!==y;){var z=v,U=z.alternate,Z=z.stateNode;if(U!==null&&U===y)break;z.tag===5&&Z!==null&&(z=Z,E?(U=Kh(v,x),U!=null&&N.unshift(hp(v,U,z))):E||(U=Kh(v,x),U!=null&&N.push(hp(v,U,z)))),v=v.return}N.length!==0&&c.push({event:d,listeners:N})}var cz=/\r\n?/g,lz=/\u0000|\uFFFD/g;function xT(c){return(typeof c=="string"?c:""+c).replace(cz,`
`).replace(lz,"")}function ES(c,d,v){if(d=xT(d),xT(c)!==d&&v)throw Error(t(425))}function RS(){}var Rb=null,Pb=null;function Tb(c,d){return c==="textarea"||c==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var xb=typeof setTimeout=="function"?setTimeout:void 0,uz=typeof clearTimeout=="function"?clearTimeout:void 0,IT=typeof Promise=="function"?Promise:void 0,dz=typeof queueMicrotask=="function"?queueMicrotask:typeof IT<"u"?function(c){return IT.resolve(null).then(c).catch(hz)}:xb;function hz(c){setTimeout(function(){throw c})}function Ib(c,d){var v=d,y=0;do{var E=v.nextSibling;if(c.removeChild(v),E&&E.nodeType===8)if(v=E.data,v==="/$"){if(y===0){c.removeChild(E),np(d);return}y--}else v!=="$"&&v!=="$?"&&v!=="$!"||y++;v=E}while(v);np(d)}function aa(c){for(;c!=null;c=c.nextSibling){var d=c.nodeType;if(d===1||d===3)break;if(d===8){if(d=c.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return c}function _T(c){c=c.previousSibling;for(var d=0;c;){if(c.nodeType===8){var v=c.data;if(v==="$"||v==="$!"||v==="$?"){if(d===0)return c;d--}else v==="/$"&&d++}c=c.previousSibling}return null}var zu=Math.random().toString(36).slice(2),ds="__reactFiber$"+zu,pp="__reactProps$"+zu,Vs="__reactContainer$"+zu,_b="__reactEvents$"+zu,pz="__reactListeners$"+zu,fz="__reactHandles$"+zu;function Ec(c){var d=c[ds];if(d)return d;for(var v=c.parentNode;v;){if(d=v[Vs]||v[ds]){if(v=d.alternate,d.child!==null||v!==null&&v.child!==null)for(c=_T(c);c!==null;){if(v=c[ds])return v;c=_T(c)}return d}c=v,v=c.parentNode}return null}function fp(c){return c=c[ds]||c[Vs],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function Fu(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function PS(c){return c[pp]||null}var kb=[],Bu=-1;function ca(c){return{current:c}}function Mt(c){0>Bu||(c.current=kb[Bu],kb[Bu]=null,Bu--)}function Tt(c,d){Bu++,kb[Bu]=c.current,c.current=d}var la={},Bn=ca(la),dr=ca(!1),Rc=la;function Uu(c,d){var v=c.type.contextTypes;if(!v)return la;var y=c.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===d)return y.__reactInternalMemoizedMaskedChildContext;var E={},x;for(x in v)E[x]=d[x];return y&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=d,c.__reactInternalMemoizedMaskedChildContext=E),E}function hr(c){return c=c.childContextTypes,c!=null}function TS(){Mt(dr),Mt(Bn)}function kT(c,d,v){if(Bn.current!==la)throw Error(t(168));Tt(Bn,d),Tt(dr,v)}function MT(c,d,v){var y=c.stateNode;if(d=d.childContextTypes,typeof y.getChildContext!="function")return v;y=y.getChildContext();for(var E in y)if(!(E in d))throw Error(t(108,te(c)||"Unknown",E));return B({},v,y)}function xS(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||la,Rc=Bn.current,Tt(Bn,c),Tt(dr,dr.current),!0}function DT(c,d,v){var y=c.stateNode;if(!y)throw Error(t(169));v?(c=MT(c,d,Rc),y.__reactInternalMemoizedMergedChildContext=c,Mt(dr),Mt(Bn),Tt(Bn,c)):Mt(dr),Tt(dr,v)}var Gs=null,IS=!1,Mb=!1;function NT(c){Gs===null?Gs=[c]:Gs.push(c)}function gz(c){IS=!0,NT(c)}function ua(){if(!Mb&&Gs!==null){Mb=!0;var c=0,d=ht;try{var v=Gs;for(ht=1;c<v.length;c++){var y=v[c];do y=y(!0);while(y!==null)}Gs=null,IS=!1}catch(E){throw Gs!==null&&(Gs=Gs.slice(c+1)),LP(eb,ua),E}finally{ht=d,Mb=!1}}return null}var Hu=[],Wu=0,_S=null,kS=0,ai=[],ci=0,Pc=null,Ks=1,$s="";function Tc(c,d){Hu[Wu++]=kS,Hu[Wu++]=_S,_S=c,kS=d}function OT(c,d,v){ai[ci++]=Ks,ai[ci++]=$s,ai[ci++]=Pc,Pc=c;var y=Ks;c=$s;var E=32-ki(y)-1;y&=~(1<<E),v+=1;var x=32-ki(d)+E;if(30<x){var N=E-E%5;x=(y&(1<<N)-1).toString(32),y>>=N,E-=N,Ks=1<<32-ki(d)+E|v<<E|y,$s=x+c}else Ks=1<<x|v<<E|y,$s=c}function Db(c){c.return!==null&&(Tc(c,1),OT(c,1,0))}function Nb(c){for(;c===_S;)_S=Hu[--Wu],Hu[Wu]=null,kS=Hu[--Wu],Hu[Wu]=null;for(;c===Pc;)Pc=ai[--ci],ai[ci]=null,$s=ai[--ci],ai[ci]=null,Ks=ai[--ci],ai[ci]=null}var Ir=null,_r=null,Nt=!1,Di=null;function LT(c,d){var v=hi(5,null,null,0);v.elementType="DELETED",v.stateNode=d,v.return=c,d=c.deletions,d===null?(c.deletions=[v],c.flags|=16):d.push(v)}function jT(c,d){switch(c.tag){case 5:var v=c.type;return d=d.nodeType!==1||v.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(c.stateNode=d,Ir=c,_r=aa(d.firstChild),!0):!1;case 6:return d=c.pendingProps===""||d.nodeType!==3?null:d,d!==null?(c.stateNode=d,Ir=c,_r=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(v=Pc!==null?{id:Ks,overflow:$s}:null,c.memoizedState={dehydrated:d,treeContext:v,retryLane:1073741824},v=hi(18,null,null,0),v.stateNode=d,v.return=c,c.child=v,Ir=c,_r=null,!0):!1;default:return!1}}function Ob(c){return(c.mode&1)!==0&&(c.flags&128)===0}function Lb(c){if(Nt){var d=_r;if(d){var v=d;if(!jT(c,d)){if(Ob(c))throw Error(t(418));d=aa(v.nextSibling);var y=Ir;d&&jT(c,d)?LT(y,v):(c.flags=c.flags&-4097|2,Nt=!1,Ir=c)}}else{if(Ob(c))throw Error(t(418));c.flags=c.flags&-4097|2,Nt=!1,Ir=c}}}function zT(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Ir=c}function MS(c){if(c!==Ir)return!1;if(!Nt)return zT(c),Nt=!0,!1;var d;if((d=c.tag!==3)&&!(d=c.tag!==5)&&(d=c.type,d=d!=="head"&&d!=="body"&&!Tb(c.type,c.memoizedProps)),d&&(d=_r)){if(Ob(c))throw FT(),Error(t(418));for(;d;)LT(c,d),d=aa(d.nextSibling)}if(zT(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,d=0;c;){if(c.nodeType===8){var v=c.data;if(v==="/$"){if(d===0){_r=aa(c.nextSibling);break e}d--}else v!=="$"&&v!=="$!"&&v!=="$?"||d++}c=c.nextSibling}_r=null}}else _r=Ir?aa(c.stateNode.nextSibling):null;return!0}function FT(){for(var c=_r;c;)c=aa(c.nextSibling)}function qu(){_r=Ir=null,Nt=!1}function jb(c){Di===null?Di=[c]:Di.push(c)}var vz=I.ReactCurrentBatchConfig;function gp(c,d,v){if(c=v.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(v._owner){if(v=v._owner,v){if(v.tag!==1)throw Error(t(309));var y=v.stateNode}if(!y)throw Error(t(147,c));var E=y,x=""+c;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===x?d.ref:(d=function(N){var z=E.refs;N===null?delete z[x]:z[x]=N},d._stringRef=x,d)}if(typeof c!="string")throw Error(t(284));if(!v._owner)throw Error(t(290,c))}return c}function DS(c,d){throw c=Object.prototype.toString.call(d),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":c))}function BT(c){var d=c._init;return d(c._payload)}function UT(c){function d(X,q){if(c){var Y=X.deletions;Y===null?(X.deletions=[q],X.flags|=16):Y.push(q)}}function v(X,q){if(!c)return null;for(;q!==null;)d(X,q),q=q.sibling;return null}function y(X,q){for(X=new Map;q!==null;)q.key!==null?X.set(q.key,q):X.set(q.index,q),q=q.sibling;return X}function E(X,q){return X=ya(X,q),X.index=0,X.sibling=null,X}function x(X,q,Y){return X.index=Y,c?(Y=X.alternate,Y!==null?(Y=Y.index,Y<q?(X.flags|=2,q):Y):(X.flags|=2,q)):(X.flags|=1048576,q)}function N(X){return c&&X.alternate===null&&(X.flags|=2),X}function z(X,q,Y,fe){return q===null||q.tag!==6?(q=xw(Y,X.mode,fe),q.return=X,q):(q=E(q,Y),q.return=X,q)}function U(X,q,Y,fe){var Ie=Y.type;return Ie===O?ue(X,q,Y.props.children,fe,Y.key):q!==null&&(q.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===ne&&BT(Ie)===q.type)?(fe=E(q,Y.props),fe.ref=gp(X,q,Y),fe.return=X,fe):(fe=rC(Y.type,Y.key,Y.props,null,X.mode,fe),fe.ref=gp(X,q,Y),fe.return=X,fe)}function Z(X,q,Y,fe){return q===null||q.tag!==4||q.stateNode.containerInfo!==Y.containerInfo||q.stateNode.implementation!==Y.implementation?(q=Iw(Y,X.mode,fe),q.return=X,q):(q=E(q,Y.children||[]),q.return=X,q)}function ue(X,q,Y,fe,Ie){return q===null||q.tag!==7?(q=Oc(Y,X.mode,fe,Ie),q.return=X,q):(q=E(q,Y),q.return=X,q)}function de(X,q,Y){if(typeof q=="string"&&q!==""||typeof q=="number")return q=xw(""+q,X.mode,Y),q.return=X,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case M:return Y=rC(q.type,q.key,q.props,null,X.mode,Y),Y.ref=gp(X,null,q),Y.return=X,Y;case k:return q=Iw(q,X.mode,Y),q.return=X,q;case ne:var fe=q._init;return de(X,fe(q._payload),Y)}if(oi(q)||oe(q))return q=Oc(q,X.mode,Y,null),q.return=X,q;DS(X,q)}return null}function le(X,q,Y,fe){var Ie=q!==null?q.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Ie!==null?null:z(X,q,""+Y,fe);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case M:return Y.key===Ie?U(X,q,Y,fe):null;case k:return Y.key===Ie?Z(X,q,Y,fe):null;case ne:return Ie=Y._init,le(X,q,Ie(Y._payload),fe)}if(oi(Y)||oe(Y))return Ie!==null?null:ue(X,q,Y,fe,null);DS(X,Y)}return null}function we(X,q,Y,fe,Ie){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return X=X.get(Y)||null,z(q,X,""+fe,Ie);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case M:return X=X.get(fe.key===null?Y:fe.key)||null,U(q,X,fe,Ie);case k:return X=X.get(fe.key===null?Y:fe.key)||null,Z(q,X,fe,Ie);case ne:var Me=fe._init;return we(X,q,Y,Me(fe._payload),Ie)}if(oi(fe)||oe(fe))return X=X.get(Y)||null,ue(q,X,fe,Ie,null);DS(q,fe)}return null}function Pe(X,q,Y,fe){for(var Ie=null,Me=null,De=q,je=q=0,Cn=null;De!==null&&je<Y.length;je++){De.index>je?(Cn=De,De=null):Cn=De.sibling;var lt=le(X,De,Y[je],fe);if(lt===null){De===null&&(De=Cn);break}c&&De&&lt.alternate===null&&d(X,De),q=x(lt,q,je),Me===null?Ie=lt:Me.sibling=lt,Me=lt,De=Cn}if(je===Y.length)return v(X,De),Nt&&Tc(X,je),Ie;if(De===null){for(;je<Y.length;je++)De=de(X,Y[je],fe),De!==null&&(q=x(De,q,je),Me===null?Ie=De:Me.sibling=De,Me=De);return Nt&&Tc(X,je),Ie}for(De=y(X,De);je<Y.length;je++)Cn=we(De,X,je,Y[je],fe),Cn!==null&&(c&&Cn.alternate!==null&&De.delete(Cn.key===null?je:Cn.key),q=x(Cn,q,je),Me===null?Ie=Cn:Me.sibling=Cn,Me=Cn);return c&&De.forEach(function(Sa){return d(X,Sa)}),Nt&&Tc(X,je),Ie}function Te(X,q,Y,fe){var Ie=oe(Y);if(typeof Ie!="function")throw Error(t(150));if(Y=Ie.call(Y),Y==null)throw Error(t(151));for(var Me=Ie=null,De=q,je=q=0,Cn=null,lt=Y.next();De!==null&&!lt.done;je++,lt=Y.next()){De.index>je?(Cn=De,De=null):Cn=De.sibling;var Sa=le(X,De,lt.value,fe);if(Sa===null){De===null&&(De=Cn);break}c&&De&&Sa.alternate===null&&d(X,De),q=x(Sa,q,je),Me===null?Ie=Sa:Me.sibling=Sa,Me=Sa,De=Cn}if(lt.done)return v(X,De),Nt&&Tc(X,je),Ie;if(De===null){for(;!lt.done;je++,lt=Y.next())lt=de(X,lt.value,fe),lt!==null&&(q=x(lt,q,je),Me===null?Ie=lt:Me.sibling=lt,Me=lt);return Nt&&Tc(X,je),Ie}for(De=y(X,De);!lt.done;je++,lt=Y.next())lt=we(De,X,je,lt.value,fe),lt!==null&&(c&&lt.alternate!==null&&De.delete(lt.key===null?je:lt.key),q=x(lt,q,je),Me===null?Ie=lt:Me.sibling=lt,Me=lt);return c&&De.forEach(function(Jz){return d(X,Jz)}),Nt&&Tc(X,je),Ie}function en(X,q,Y,fe){if(typeof Y=="object"&&Y!==null&&Y.type===O&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case M:e:{for(var Ie=Y.key,Me=q;Me!==null;){if(Me.key===Ie){if(Ie=Y.type,Ie===O){if(Me.tag===7){v(X,Me.sibling),q=E(Me,Y.props.children),q.return=X,X=q;break e}}else if(Me.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===ne&&BT(Ie)===Me.type){v(X,Me.sibling),q=E(Me,Y.props),q.ref=gp(X,Me,Y),q.return=X,X=q;break e}v(X,Me);break}else d(X,Me);Me=Me.sibling}Y.type===O?(q=Oc(Y.props.children,X.mode,fe,Y.key),q.return=X,X=q):(fe=rC(Y.type,Y.key,Y.props,null,X.mode,fe),fe.ref=gp(X,q,Y),fe.return=X,X=fe)}return N(X);case k:e:{for(Me=Y.key;q!==null;){if(q.key===Me)if(q.tag===4&&q.stateNode.containerInfo===Y.containerInfo&&q.stateNode.implementation===Y.implementation){v(X,q.sibling),q=E(q,Y.children||[]),q.return=X,X=q;break e}else{v(X,q);break}else d(X,q);q=q.sibling}q=Iw(Y,X.mode,fe),q.return=X,X=q}return N(X);case ne:return Me=Y._init,en(X,q,Me(Y._payload),fe)}if(oi(Y))return Pe(X,q,Y,fe);if(oe(Y))return Te(X,q,Y,fe);DS(X,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,q!==null&&q.tag===6?(v(X,q.sibling),q=E(q,Y),q.return=X,X=q):(v(X,q),q=xw(Y,X.mode,fe),q.return=X,X=q),N(X)):v(X,q)}return en}var Vu=UT(!0),HT=UT(!1),NS=ca(null),OS=null,Gu=null,zb=null;function Fb(){zb=Gu=OS=null}function Bb(c){var d=NS.current;Mt(NS),c._currentValue=d}function Ub(c,d,v){for(;c!==null;){var y=c.alternate;if((c.childLanes&d)!==d?(c.childLanes|=d,y!==null&&(y.childLanes|=d)):y!==null&&(y.childLanes&d)!==d&&(y.childLanes|=d),c===v)break;c=c.return}}function Ku(c,d){OS=c,zb=Gu=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&d)!==0&&(pr=!0),c.firstContext=null)}function li(c){var d=c._currentValue;if(zb!==c)if(c={context:c,memoizedValue:d,next:null},Gu===null){if(OS===null)throw Error(t(308));Gu=c,OS.dependencies={lanes:0,firstContext:c}}else Gu=Gu.next=c;return d}var xc=null;function Hb(c){xc===null?xc=[c]:xc.push(c)}function WT(c,d,v,y){var E=d.interleaved;return E===null?(v.next=v,Hb(d)):(v.next=E.next,E.next=v),d.interleaved=v,Js(c,y)}function Js(c,d){c.lanes|=d;var v=c.alternate;for(v!==null&&(v.lanes|=d),v=c,c=c.return;c!==null;)c.childLanes|=d,v=c.alternate,v!==null&&(v.childLanes|=d),v=c,c=c.return;return v.tag===3?v.stateNode:null}var da=!1;function Wb(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qT(c,d){c=c.updateQueue,d.updateQueue===c&&(d.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function Xs(c,d){return{eventTime:c,lane:d,tag:0,payload:null,callback:null,next:null}}function ha(c,d,v){var y=c.updateQueue;if(y===null)return null;if(y=y.shared,(ot&2)!==0){var E=y.pending;return E===null?d.next=d:(d.next=E.next,E.next=d),y.pending=d,Js(c,v)}return E=y.interleaved,E===null?(d.next=d,Hb(y)):(d.next=E.next,E.next=d),y.interleaved=d,Js(c,v)}function LS(c,d,v){if(d=d.updateQueue,d!==null&&(d=d.shared,(v&4194240)!==0)){var y=d.lanes;y&=c.pendingLanes,v|=y,d.lanes=v,rb(c,v)}}function VT(c,d){var v=c.updateQueue,y=c.alternate;if(y!==null&&(y=y.updateQueue,v===y)){var E=null,x=null;if(v=v.firstBaseUpdate,v!==null){do{var N={eventTime:v.eventTime,lane:v.lane,tag:v.tag,payload:v.payload,callback:v.callback,next:null};x===null?E=x=N:x=x.next=N,v=v.next}while(v!==null);x===null?E=x=d:x=x.next=d}else E=x=d;v={baseState:y.baseState,firstBaseUpdate:E,lastBaseUpdate:x,shared:y.shared,effects:y.effects},c.updateQueue=v;return}c=v.lastBaseUpdate,c===null?v.firstBaseUpdate=d:c.next=d,v.lastBaseUpdate=d}function jS(c,d,v,y){var E=c.updateQueue;da=!1;var x=E.firstBaseUpdate,N=E.lastBaseUpdate,z=E.shared.pending;if(z!==null){E.shared.pending=null;var U=z,Z=U.next;U.next=null,N===null?x=Z:N.next=Z,N=U;var ue=c.alternate;ue!==null&&(ue=ue.updateQueue,z=ue.lastBaseUpdate,z!==N&&(z===null?ue.firstBaseUpdate=Z:z.next=Z,ue.lastBaseUpdate=U))}if(x!==null){var de=E.baseState;N=0,ue=Z=U=null,z=x;do{var le=z.lane,we=z.eventTime;if((y&le)===le){ue!==null&&(ue=ue.next={eventTime:we,lane:0,tag:z.tag,payload:z.payload,callback:z.callback,next:null});e:{var Pe=c,Te=z;switch(le=d,we=v,Te.tag){case 1:if(Pe=Te.payload,typeof Pe=="function"){de=Pe.call(we,de,le);break e}de=Pe;break e;case 3:Pe.flags=Pe.flags&-65537|128;case 0:if(Pe=Te.payload,le=typeof Pe=="function"?Pe.call(we,de,le):Pe,le==null)break e;de=B({},de,le);break e;case 2:da=!0}}z.callback!==null&&z.lane!==0&&(c.flags|=64,le=E.effects,le===null?E.effects=[z]:le.push(z))}else we={eventTime:we,lane:le,tag:z.tag,payload:z.payload,callback:z.callback,next:null},ue===null?(Z=ue=we,U=de):ue=ue.next=we,N|=le;if(z=z.next,z===null){if(z=E.shared.pending,z===null)break;le=z,z=le.next,le.next=null,E.lastBaseUpdate=le,E.shared.pending=null}}while(!0);if(ue===null&&(U=de),E.baseState=U,E.firstBaseUpdate=Z,E.lastBaseUpdate=ue,d=E.shared.interleaved,d!==null){E=d;do N|=E.lane,E=E.next;while(E!==d)}else x===null&&(E.shared.lanes=0);kc|=N,c.lanes=N,c.memoizedState=de}}function GT(c,d,v){if(c=d.effects,d.effects=null,c!==null)for(d=0;d<c.length;d++){var y=c[d],E=y.callback;if(E!==null){if(y.callback=null,y=v,typeof E!="function")throw Error(t(191,E));E.call(y)}}}var vp={},hs=ca(vp),mp=ca(vp),yp=ca(vp);function Ic(c){if(c===vp)throw Error(t(174));return c}function qb(c,d){switch(Tt(yp,d),Tt(mp,c),Tt(hs,vp),c=d.nodeType,c){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:Ye(null,"");break;default:c=c===8?d.parentNode:d,d=c.namespaceURI||null,c=c.tagName,d=Ye(d,c)}Mt(hs),Tt(hs,d)}function $u(){Mt(hs),Mt(mp),Mt(yp)}function KT(c){Ic(yp.current);var d=Ic(hs.current),v=Ye(d,c.type);d!==v&&(Tt(mp,c),Tt(hs,v))}function Vb(c){mp.current===c&&(Mt(hs),Mt(mp))}var zt=ca(0);function zS(c){for(var d=c;d!==null;){if(d.tag===13){var v=d.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||v.data==="$?"||v.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var Gb=[];function Kb(){for(var c=0;c<Gb.length;c++)Gb[c]._workInProgressVersionPrimary=null;Gb.length=0}var FS=I.ReactCurrentDispatcher,$b=I.ReactCurrentBatchConfig,_c=0,Ft=null,ln=null,yn=null,BS=!1,Sp=!1,Cp=0,mz=0;function Un(){throw Error(t(321))}function Jb(c,d){if(d===null)return!1;for(var v=0;v<d.length&&v<c.length;v++)if(!Mi(c[v],d[v]))return!1;return!0}function Xb(c,d,v,y,E,x){if(_c=x,Ft=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,FS.current=c===null||c.memoizedState===null?bz:wz,c=v(y,E),Sp){x=0;do{if(Sp=!1,Cp=0,25<=x)throw Error(t(301));x+=1,yn=ln=null,d.updateQueue=null,FS.current=Az,c=v(y,E)}while(Sp)}if(FS.current=WS,d=ln!==null&&ln.next!==null,_c=0,yn=ln=Ft=null,BS=!1,d)throw Error(t(300));return c}function Yb(){var c=Cp!==0;return Cp=0,c}function ps(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yn===null?Ft.memoizedState=yn=c:yn=yn.next=c,yn}function ui(){if(ln===null){var c=Ft.alternate;c=c!==null?c.memoizedState:null}else c=ln.next;var d=yn===null?Ft.memoizedState:yn.next;if(d!==null)yn=d,ln=c;else{if(c===null)throw Error(t(310));ln=c,c={memoizedState:ln.memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},yn===null?Ft.memoizedState=yn=c:yn=yn.next=c}return yn}function bp(c,d){return typeof d=="function"?d(c):d}function Qb(c){var d=ui(),v=d.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=c;var y=ln,E=y.baseQueue,x=v.pending;if(x!==null){if(E!==null){var N=E.next;E.next=x.next,x.next=N}y.baseQueue=E=x,v.pending=null}if(E!==null){x=E.next,y=y.baseState;var z=N=null,U=null,Z=x;do{var ue=Z.lane;if((_c&ue)===ue)U!==null&&(U=U.next={lane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),y=Z.hasEagerState?Z.eagerState:c(y,Z.action);else{var de={lane:ue,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null};U===null?(z=U=de,N=y):U=U.next=de,Ft.lanes|=ue,kc|=ue}Z=Z.next}while(Z!==null&&Z!==x);U===null?N=y:U.next=z,Mi(y,d.memoizedState)||(pr=!0),d.memoizedState=y,d.baseState=N,d.baseQueue=U,v.lastRenderedState=y}if(c=v.interleaved,c!==null){E=c;do x=E.lane,Ft.lanes|=x,kc|=x,E=E.next;while(E!==c)}else E===null&&(v.lanes=0);return[d.memoizedState,v.dispatch]}function Zb(c){var d=ui(),v=d.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=c;var y=v.dispatch,E=v.pending,x=d.memoizedState;if(E!==null){v.pending=null;var N=E=E.next;do x=c(x,N.action),N=N.next;while(N!==E);Mi(x,d.memoizedState)||(pr=!0),d.memoizedState=x,d.baseQueue===null&&(d.baseState=x),v.lastRenderedState=x}return[x,y]}function $T(){}function JT(c,d){var v=Ft,y=ui(),E=d(),x=!Mi(y.memoizedState,E);if(x&&(y.memoizedState=E,pr=!0),y=y.queue,ew(QT.bind(null,v,y,c),[c]),y.getSnapshot!==d||x||yn!==null&&yn.memoizedState.tag&1){if(v.flags|=2048,wp(9,YT.bind(null,v,y,E,d),void 0,null),Sn===null)throw Error(t(349));(_c&30)!==0||XT(v,d,E)}return E}function XT(c,d,v){c.flags|=16384,c={getSnapshot:d,value:v},d=Ft.updateQueue,d===null?(d={lastEffect:null,stores:null},Ft.updateQueue=d,d.stores=[c]):(v=d.stores,v===null?d.stores=[c]:v.push(c))}function YT(c,d,v,y){d.value=v,d.getSnapshot=y,ZT(d)&&ex(c)}function QT(c,d,v){return v(function(){ZT(d)&&ex(c)})}function ZT(c){var d=c.getSnapshot;c=c.value;try{var v=d();return!Mi(c,v)}catch{return!0}}function ex(c){var d=Js(c,1);d!==null&&ji(d,c,1,-1)}function tx(c){var d=ps();return typeof c=="function"&&(c=c()),d.memoizedState=d.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bp,lastRenderedState:c},d.queue=c,c=c.dispatch=Cz.bind(null,Ft,c),[d.memoizedState,c]}function wp(c,d,v,y){return c={tag:c,create:d,destroy:v,deps:y,next:null},d=Ft.updateQueue,d===null?(d={lastEffect:null,stores:null},Ft.updateQueue=d,d.lastEffect=c.next=c):(v=d.lastEffect,v===null?d.lastEffect=c.next=c:(y=v.next,v.next=c,c.next=y,d.lastEffect=c)),c}function nx(){return ui().memoizedState}function US(c,d,v,y){var E=ps();Ft.flags|=c,E.memoizedState=wp(1|d,v,void 0,y===void 0?null:y)}function HS(c,d,v,y){var E=ui();y=y===void 0?null:y;var x=void 0;if(ln!==null){var N=ln.memoizedState;if(x=N.destroy,y!==null&&Jb(y,N.deps)){E.memoizedState=wp(d,v,x,y);return}}Ft.flags|=c,E.memoizedState=wp(1|d,v,x,y)}function rx(c,d){return US(8390656,8,c,d)}function ew(c,d){return HS(2048,8,c,d)}function ix(c,d){return HS(4,2,c,d)}function sx(c,d){return HS(4,4,c,d)}function ox(c,d){if(typeof d=="function")return c=c(),d(c),function(){d(null)};if(d!=null)return c=c(),d.current=c,function(){d.current=null}}function ax(c,d,v){return v=v!=null?v.concat([c]):null,HS(4,4,ox.bind(null,d,c),v)}function tw(){}function cx(c,d){var v=ui();d=d===void 0?null:d;var y=v.memoizedState;return y!==null&&d!==null&&Jb(d,y[1])?y[0]:(v.memoizedState=[c,d],c)}function lx(c,d){var v=ui();d=d===void 0?null:d;var y=v.memoizedState;return y!==null&&d!==null&&Jb(d,y[1])?y[0]:(c=c(),v.memoizedState=[c,d],c)}function ux(c,d,v){return(_c&21)===0?(c.baseState&&(c.baseState=!1,pr=!0),c.memoizedState=v):(Mi(v,d)||(v=BP(),Ft.lanes|=v,kc|=v,c.baseState=!0),d)}function yz(c,d){var v=ht;ht=v!==0&&4>v?v:4,c(!0);var y=$b.transition;$b.transition={};try{c(!1),d()}finally{ht=v,$b.transition=y}}function dx(){return ui().memoizedState}function Sz(c,d,v){var y=va(c);if(v={lane:y,action:v,hasEagerState:!1,eagerState:null,next:null},hx(c))px(d,v);else if(v=WT(c,d,v,y),v!==null){var E=er();ji(v,c,y,E),fx(v,d,y)}}function Cz(c,d,v){var y=va(c),E={lane:y,action:v,hasEagerState:!1,eagerState:null,next:null};if(hx(c))px(d,E);else{var x=c.alternate;if(c.lanes===0&&(x===null||x.lanes===0)&&(x=d.lastRenderedReducer,x!==null))try{var N=d.lastRenderedState,z=x(N,v);if(E.hasEagerState=!0,E.eagerState=z,Mi(z,N)){var U=d.interleaved;U===null?(E.next=E,Hb(d)):(E.next=U.next,U.next=E),d.interleaved=E;return}}catch{}finally{}v=WT(c,d,E,y),v!==null&&(E=er(),ji(v,c,y,E),fx(v,d,y))}}function hx(c){var d=c.alternate;return c===Ft||d!==null&&d===Ft}function px(c,d){Sp=BS=!0;var v=c.pending;v===null?d.next=d:(d.next=v.next,v.next=d),c.pending=d}function fx(c,d,v){if((v&4194240)!==0){var y=d.lanes;y&=c.pendingLanes,v|=y,d.lanes=v,rb(c,v)}}var WS={readContext:li,useCallback:Un,useContext:Un,useEffect:Un,useImperativeHandle:Un,useInsertionEffect:Un,useLayoutEffect:Un,useMemo:Un,useReducer:Un,useRef:Un,useState:Un,useDebugValue:Un,useDeferredValue:Un,useTransition:Un,useMutableSource:Un,useSyncExternalStore:Un,useId:Un,unstable_isNewReconciler:!1},bz={readContext:li,useCallback:function(c,d){return ps().memoizedState=[c,d===void 0?null:d],c},useContext:li,useEffect:rx,useImperativeHandle:function(c,d,v){return v=v!=null?v.concat([c]):null,US(4194308,4,ox.bind(null,d,c),v)},useLayoutEffect:function(c,d){return US(4194308,4,c,d)},useInsertionEffect:function(c,d){return US(4,2,c,d)},useMemo:function(c,d){var v=ps();return d=d===void 0?null:d,c=c(),v.memoizedState=[c,d],c},useReducer:function(c,d,v){var y=ps();return d=v!==void 0?v(d):d,y.memoizedState=y.baseState=d,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:d},y.queue=c,c=c.dispatch=Sz.bind(null,Ft,c),[y.memoizedState,c]},useRef:function(c){var d=ps();return c={current:c},d.memoizedState=c},useState:tx,useDebugValue:tw,useDeferredValue:function(c){return ps().memoizedState=c},useTransition:function(){var c=tx(!1),d=c[0];return c=yz.bind(null,c[1]),ps().memoizedState=c,[d,c]},useMutableSource:function(){},useSyncExternalStore:function(c,d,v){var y=Ft,E=ps();if(Nt){if(v===void 0)throw Error(t(407));v=v()}else{if(v=d(),Sn===null)throw Error(t(349));(_c&30)!==0||XT(y,d,v)}E.memoizedState=v;var x={value:v,getSnapshot:d};return E.queue=x,rx(QT.bind(null,y,x,c),[c]),y.flags|=2048,wp(9,YT.bind(null,y,x,v,d),void 0,null),v},useId:function(){var c=ps(),d=Sn.identifierPrefix;if(Nt){var v=$s,y=Ks;v=(y&~(1<<32-ki(y)-1)).toString(32)+v,d=":"+d+"R"+v,v=Cp++,0<v&&(d+="H"+v.toString(32)),d+=":"}else v=mz++,d=":"+d+"r"+v.toString(32)+":";return c.memoizedState=d},unstable_isNewReconciler:!1},wz={readContext:li,useCallback:cx,useContext:li,useEffect:ew,useImperativeHandle:ax,useInsertionEffect:ix,useLayoutEffect:sx,useMemo:lx,useReducer:Qb,useRef:nx,useState:function(){return Qb(bp)},useDebugValue:tw,useDeferredValue:function(c){var d=ui();return ux(d,ln.memoizedState,c)},useTransition:function(){var c=Qb(bp)[0],d=ui().memoizedState;return[c,d]},useMutableSource:$T,useSyncExternalStore:JT,useId:dx,unstable_isNewReconciler:!1},Az={readContext:li,useCallback:cx,useContext:li,useEffect:ew,useImperativeHandle:ax,useInsertionEffect:ix,useLayoutEffect:sx,useMemo:lx,useReducer:Zb,useRef:nx,useState:function(){return Zb(bp)},useDebugValue:tw,useDeferredValue:function(c){var d=ui();return ln===null?d.memoizedState=c:ux(d,ln.memoizedState,c)},useTransition:function(){var c=Zb(bp)[0],d=ui().memoizedState;return[c,d]},useMutableSource:$T,useSyncExternalStore:JT,useId:dx,unstable_isNewReconciler:!1};function Ni(c,d){if(c&&c.defaultProps){d=B({},d),c=c.defaultProps;for(var v in c)d[v]===void 0&&(d[v]=c[v]);return d}return d}function nw(c,d,v,y){d=c.memoizedState,v=v(y,d),v=v==null?d:B({},d,v),c.memoizedState=v,c.lanes===0&&(c.updateQueue.baseState=v)}var qS={isMounted:function(c){return(c=c._reactInternals)?Ac(c)===c:!1},enqueueSetState:function(c,d,v){c=c._reactInternals;var y=er(),E=va(c),x=Xs(y,E);x.payload=d,v!=null&&(x.callback=v),d=ha(c,x,E),d!==null&&(ji(d,c,E,y),LS(d,c,E))},enqueueReplaceState:function(c,d,v){c=c._reactInternals;var y=er(),E=va(c),x=Xs(y,E);x.tag=1,x.payload=d,v!=null&&(x.callback=v),d=ha(c,x,E),d!==null&&(ji(d,c,E,y),LS(d,c,E))},enqueueForceUpdate:function(c,d){c=c._reactInternals;var v=er(),y=va(c),E=Xs(v,y);E.tag=2,d!=null&&(E.callback=d),d=ha(c,E,y),d!==null&&(ji(d,c,y,v),LS(d,c,y))}};function gx(c,d,v,y,E,x,N){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(y,x,N):d.prototype&&d.prototype.isPureReactComponent?!cp(v,y)||!cp(E,x):!0}function vx(c,d,v){var y=!1,E=la,x=d.contextType;return typeof x=="object"&&x!==null?x=li(x):(E=hr(d)?Rc:Bn.current,y=d.contextTypes,x=(y=y!=null)?Uu(c,E):la),d=new d(v,x),c.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=qS,c.stateNode=d,d._reactInternals=c,y&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=E,c.__reactInternalMemoizedMaskedChildContext=x),d}function mx(c,d,v,y){c=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(v,y),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(v,y),d.state!==c&&qS.enqueueReplaceState(d,d.state,null)}function rw(c,d,v,y){var E=c.stateNode;E.props=v,E.state=c.memoizedState,E.refs={},Wb(c);var x=d.contextType;typeof x=="object"&&x!==null?E.context=li(x):(x=hr(d)?Rc:Bn.current,E.context=Uu(c,x)),E.state=c.memoizedState,x=d.getDerivedStateFromProps,typeof x=="function"&&(nw(c,d,x,v),E.state=c.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(d=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),d!==E.state&&qS.enqueueReplaceState(E,E.state,null),jS(c,v,E,y),E.state=c.memoizedState),typeof E.componentDidMount=="function"&&(c.flags|=4194308)}function Ju(c,d){try{var v="",y=d;do v+=ye(y),y=y.return;while(y);var E=v}catch(x){E=`
Error generating stack: `+x.message+`
`+x.stack}return{value:c,source:d,stack:E,digest:null}}function iw(c,d,v){return{value:c,source:null,stack:v??null,digest:d??null}}function sw(c,d){try{console.error(d.value)}catch(v){setTimeout(function(){throw v})}}var Ez=typeof WeakMap=="function"?WeakMap:Map;function yx(c,d,v){v=Xs(-1,v),v.tag=3,v.payload={element:null};var y=d.value;return v.callback=function(){YS||(YS=!0,Cw=y),sw(c,d)},v}function Sx(c,d,v){v=Xs(-1,v),v.tag=3;var y=c.type.getDerivedStateFromError;if(typeof y=="function"){var E=d.value;v.payload=function(){return y(E)},v.callback=function(){sw(c,d)}}var x=c.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(v.callback=function(){sw(c,d),typeof y!="function"&&(fa===null?fa=new Set([this]):fa.add(this));var N=d.stack;this.componentDidCatch(d.value,{componentStack:N!==null?N:""})}),v}function Cx(c,d,v){var y=c.pingCache;if(y===null){y=c.pingCache=new Ez;var E=new Set;y.set(d,E)}else E=y.get(d),E===void 0&&(E=new Set,y.set(d,E));E.has(v)||(E.add(v),c=zz.bind(null,c,d,v),d.then(c,c))}function bx(c){do{var d;if((d=c.tag===13)&&(d=c.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return c;c=c.return}while(c!==null);return null}function wx(c,d,v,y,E){return(c.mode&1)===0?(c===d?c.flags|=65536:(c.flags|=128,v.flags|=131072,v.flags&=-52805,v.tag===1&&(v.alternate===null?v.tag=17:(d=Xs(-1,1),d.tag=2,ha(v,d,1))),v.lanes|=1),c):(c.flags|=65536,c.lanes=E,c)}var Rz=I.ReactCurrentOwner,pr=!1;function Zn(c,d,v,y){d.child=c===null?HT(d,null,v,y):Vu(d,c.child,v,y)}function Ax(c,d,v,y,E){v=v.render;var x=d.ref;return Ku(d,E),y=Xb(c,d,v,y,x,E),v=Yb(),c!==null&&!pr?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~E,Ys(c,d,E)):(Nt&&v&&Db(d),d.flags|=1,Zn(c,d,y,E),d.child)}function Ex(c,d,v,y,E){if(c===null){var x=v.type;return typeof x=="function"&&!Tw(x)&&x.defaultProps===void 0&&v.compare===null&&v.defaultProps===void 0?(d.tag=15,d.type=x,Rx(c,d,x,y,E)):(c=rC(v.type,null,y,d,d.mode,E),c.ref=d.ref,c.return=d,d.child=c)}if(x=c.child,(c.lanes&E)===0){var N=x.memoizedProps;if(v=v.compare,v=v!==null?v:cp,v(N,y)&&c.ref===d.ref)return Ys(c,d,E)}return d.flags|=1,c=ya(x,y),c.ref=d.ref,c.return=d,d.child=c}function Rx(c,d,v,y,E){if(c!==null){var x=c.memoizedProps;if(cp(x,y)&&c.ref===d.ref)if(pr=!1,d.pendingProps=y=x,(c.lanes&E)!==0)(c.flags&131072)!==0&&(pr=!0);else return d.lanes=c.lanes,Ys(c,d,E)}return ow(c,d,v,y,E)}function Px(c,d,v){var y=d.pendingProps,E=y.children,x=c!==null?c.memoizedState:null;if(y.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tt(Yu,kr),kr|=v;else{if((v&1073741824)===0)return c=x!==null?x.baseLanes|v:v,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:c,cachePool:null,transitions:null},d.updateQueue=null,Tt(Yu,kr),kr|=c,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=x!==null?x.baseLanes:v,Tt(Yu,kr),kr|=y}else x!==null?(y=x.baseLanes|v,d.memoizedState=null):y=v,Tt(Yu,kr),kr|=y;return Zn(c,d,E,v),d.child}function Tx(c,d){var v=d.ref;(c===null&&v!==null||c!==null&&c.ref!==v)&&(d.flags|=512,d.flags|=2097152)}function ow(c,d,v,y,E){var x=hr(v)?Rc:Bn.current;return x=Uu(d,x),Ku(d,E),v=Xb(c,d,v,y,x,E),y=Yb(),c!==null&&!pr?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~E,Ys(c,d,E)):(Nt&&y&&Db(d),d.flags|=1,Zn(c,d,v,E),d.child)}function xx(c,d,v,y,E){if(hr(v)){var x=!0;xS(d)}else x=!1;if(Ku(d,E),d.stateNode===null)GS(c,d),vx(d,v,y),rw(d,v,y,E),y=!0;else if(c===null){var N=d.stateNode,z=d.memoizedProps;N.props=z;var U=N.context,Z=v.contextType;typeof Z=="object"&&Z!==null?Z=li(Z):(Z=hr(v)?Rc:Bn.current,Z=Uu(d,Z));var ue=v.getDerivedStateFromProps,de=typeof ue=="function"||typeof N.getSnapshotBeforeUpdate=="function";de||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(z!==y||U!==Z)&&mx(d,N,y,Z),da=!1;var le=d.memoizedState;N.state=le,jS(d,y,N,E),U=d.memoizedState,z!==y||le!==U||dr.current||da?(typeof ue=="function"&&(nw(d,v,ue,y),U=d.memoizedState),(z=da||gx(d,v,z,y,le,U,Z))?(de||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(d.flags|=4194308)):(typeof N.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=y,d.memoizedState=U),N.props=y,N.state=U,N.context=Z,y=z):(typeof N.componentDidMount=="function"&&(d.flags|=4194308),y=!1)}else{N=d.stateNode,qT(c,d),z=d.memoizedProps,Z=d.type===d.elementType?z:Ni(d.type,z),N.props=Z,de=d.pendingProps,le=N.context,U=v.contextType,typeof U=="object"&&U!==null?U=li(U):(U=hr(v)?Rc:Bn.current,U=Uu(d,U));var we=v.getDerivedStateFromProps;(ue=typeof we=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(z!==de||le!==U)&&mx(d,N,y,U),da=!1,le=d.memoizedState,N.state=le,jS(d,y,N,E);var Pe=d.memoizedState;z!==de||le!==Pe||dr.current||da?(typeof we=="function"&&(nw(d,v,we,y),Pe=d.memoizedState),(Z=da||gx(d,v,Z,y,le,Pe,U)||!1)?(ue||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(y,Pe,U),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(y,Pe,U)),typeof N.componentDidUpdate=="function"&&(d.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof N.componentDidUpdate!="function"||z===c.memoizedProps&&le===c.memoizedState||(d.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||z===c.memoizedProps&&le===c.memoizedState||(d.flags|=1024),d.memoizedProps=y,d.memoizedState=Pe),N.props=y,N.state=Pe,N.context=U,y=Z):(typeof N.componentDidUpdate!="function"||z===c.memoizedProps&&le===c.memoizedState||(d.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||z===c.memoizedProps&&le===c.memoizedState||(d.flags|=1024),y=!1)}return aw(c,d,v,y,x,E)}function aw(c,d,v,y,E,x){Tx(c,d);var N=(d.flags&128)!==0;if(!y&&!N)return E&&DT(d,v,!1),Ys(c,d,x);y=d.stateNode,Rz.current=d;var z=N&&typeof v.getDerivedStateFromError!="function"?null:y.render();return d.flags|=1,c!==null&&N?(d.child=Vu(d,c.child,null,x),d.child=Vu(d,null,z,x)):Zn(c,d,z,x),d.memoizedState=y.state,E&&DT(d,v,!0),d.child}function Ix(c){var d=c.stateNode;d.pendingContext?kT(c,d.pendingContext,d.pendingContext!==d.context):d.context&&kT(c,d.context,!1),qb(c,d.containerInfo)}function _x(c,d,v,y,E){return qu(),jb(E),d.flags|=256,Zn(c,d,v,y),d.child}var cw={dehydrated:null,treeContext:null,retryLane:0};function lw(c){return{baseLanes:c,cachePool:null,transitions:null}}function kx(c,d,v){var y=d.pendingProps,E=zt.current,x=!1,N=(d.flags&128)!==0,z;if((z=N)||(z=c!==null&&c.memoizedState===null?!1:(E&2)!==0),z?(x=!0,d.flags&=-129):(c===null||c.memoizedState!==null)&&(E|=1),Tt(zt,E&1),c===null)return Lb(d),c=d.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((d.mode&1)===0?d.lanes=1:c.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(N=y.children,c=y.fallback,x?(y=d.mode,x=d.child,N={mode:"hidden",children:N},(y&1)===0&&x!==null?(x.childLanes=0,x.pendingProps=N):x=iC(N,y,0,null),c=Oc(c,y,v,null),x.return=d,c.return=d,x.sibling=c,d.child=x,d.child.memoizedState=lw(v),d.memoizedState=cw,c):uw(d,N));if(E=c.memoizedState,E!==null&&(z=E.dehydrated,z!==null))return Pz(c,d,N,y,z,E,v);if(x){x=y.fallback,N=d.mode,E=c.child,z=E.sibling;var U={mode:"hidden",children:y.children};return(N&1)===0&&d.child!==E?(y=d.child,y.childLanes=0,y.pendingProps=U,d.deletions=null):(y=ya(E,U),y.subtreeFlags=E.subtreeFlags&14680064),z!==null?x=ya(z,x):(x=Oc(x,N,v,null),x.flags|=2),x.return=d,y.return=d,y.sibling=x,d.child=y,y=x,x=d.child,N=c.child.memoizedState,N=N===null?lw(v):{baseLanes:N.baseLanes|v,cachePool:null,transitions:N.transitions},x.memoizedState=N,x.childLanes=c.childLanes&~v,d.memoizedState=cw,y}return x=c.child,c=x.sibling,y=ya(x,{mode:"visible",children:y.children}),(d.mode&1)===0&&(y.lanes=v),y.return=d,y.sibling=null,c!==null&&(v=d.deletions,v===null?(d.deletions=[c],d.flags|=16):v.push(c)),d.child=y,d.memoizedState=null,y}function uw(c,d){return d=iC({mode:"visible",children:d},c.mode,0,null),d.return=c,c.child=d}function VS(c,d,v,y){return y!==null&&jb(y),Vu(d,c.child,null,v),c=uw(d,d.pendingProps.children),c.flags|=2,d.memoizedState=null,c}function Pz(c,d,v,y,E,x,N){if(v)return d.flags&256?(d.flags&=-257,y=iw(Error(t(422))),VS(c,d,N,y)):d.memoizedState!==null?(d.child=c.child,d.flags|=128,null):(x=y.fallback,E=d.mode,y=iC({mode:"visible",children:y.children},E,0,null),x=Oc(x,E,N,null),x.flags|=2,y.return=d,x.return=d,y.sibling=x,d.child=y,(d.mode&1)!==0&&Vu(d,c.child,null,N),d.child.memoizedState=lw(N),d.memoizedState=cw,x);if((d.mode&1)===0)return VS(c,d,N,null);if(E.data==="$!"){if(y=E.nextSibling&&E.nextSibling.dataset,y)var z=y.dgst;return y=z,x=Error(t(419)),y=iw(x,y,void 0),VS(c,d,N,y)}if(z=(N&c.childLanes)!==0,pr||z){if(y=Sn,y!==null){switch(N&-N){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(y.suspendedLanes|N))!==0?0:E,E!==0&&E!==x.retryLane&&(x.retryLane=E,Js(c,E),ji(y,c,E,-1))}return Pw(),y=iw(Error(t(421))),VS(c,d,N,y)}return E.data==="$?"?(d.flags|=128,d.child=c.child,d=Fz.bind(null,c),E._reactRetry=d,null):(c=x.treeContext,_r=aa(E.nextSibling),Ir=d,Nt=!0,Di=null,c!==null&&(ai[ci++]=Ks,ai[ci++]=$s,ai[ci++]=Pc,Ks=c.id,$s=c.overflow,Pc=d),d=uw(d,y.children),d.flags|=4096,d)}function Mx(c,d,v){c.lanes|=d;var y=c.alternate;y!==null&&(y.lanes|=d),Ub(c.return,d,v)}function dw(c,d,v,y,E){var x=c.memoizedState;x===null?c.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:y,tail:v,tailMode:E}:(x.isBackwards=d,x.rendering=null,x.renderingStartTime=0,x.last=y,x.tail=v,x.tailMode=E)}function Dx(c,d,v){var y=d.pendingProps,E=y.revealOrder,x=y.tail;if(Zn(c,d,y.children,v),y=zt.current,(y&2)!==0)y=y&1|2,d.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=d.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&Mx(c,v,d);else if(c.tag===19)Mx(c,v,d);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break e;for(;c.sibling===null;){if(c.return===null||c.return===d)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}y&=1}if(Tt(zt,y),(d.mode&1)===0)d.memoizedState=null;else switch(E){case"forwards":for(v=d.child,E=null;v!==null;)c=v.alternate,c!==null&&zS(c)===null&&(E=v),v=v.sibling;v=E,v===null?(E=d.child,d.child=null):(E=v.sibling,v.sibling=null),dw(d,!1,E,v,x);break;case"backwards":for(v=null,E=d.child,d.child=null;E!==null;){if(c=E.alternate,c!==null&&zS(c)===null){d.child=E;break}c=E.sibling,E.sibling=v,v=E,E=c}dw(d,!0,v,null,x);break;case"together":dw(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function GS(c,d){(d.mode&1)===0&&c!==null&&(c.alternate=null,d.alternate=null,d.flags|=2)}function Ys(c,d,v){if(c!==null&&(d.dependencies=c.dependencies),kc|=d.lanes,(v&d.childLanes)===0)return null;if(c!==null&&d.child!==c.child)throw Error(t(153));if(d.child!==null){for(c=d.child,v=ya(c,c.pendingProps),d.child=v,v.return=d;c.sibling!==null;)c=c.sibling,v=v.sibling=ya(c,c.pendingProps),v.return=d;v.sibling=null}return d.child}function Tz(c,d,v){switch(d.tag){case 3:Ix(d),qu();break;case 5:KT(d);break;case 1:hr(d.type)&&xS(d);break;case 4:qb(d,d.stateNode.containerInfo);break;case 10:var y=d.type._context,E=d.memoizedProps.value;Tt(NS,y._currentValue),y._currentValue=E;break;case 13:if(y=d.memoizedState,y!==null)return y.dehydrated!==null?(Tt(zt,zt.current&1),d.flags|=128,null):(v&d.child.childLanes)!==0?kx(c,d,v):(Tt(zt,zt.current&1),c=Ys(c,d,v),c!==null?c.sibling:null);Tt(zt,zt.current&1);break;case 19:if(y=(v&d.childLanes)!==0,(c.flags&128)!==0){if(y)return Dx(c,d,v);d.flags|=128}if(E=d.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Tt(zt,zt.current),y)break;return null;case 22:case 23:return d.lanes=0,Px(c,d,v)}return Ys(c,d,v)}var Nx,hw,Ox,Lx;Nx=function(c,d){for(var v=d.child;v!==null;){if(v.tag===5||v.tag===6)c.appendChild(v.stateNode);else if(v.tag!==4&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===d)break;for(;v.sibling===null;){if(v.return===null||v.return===d)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},hw=function(){},Ox=function(c,d,v,y){var E=c.memoizedProps;if(E!==y){c=d.stateNode,Ic(hs.current);var x=null;switch(v){case"input":E=$e(c,E),y=$e(c,y),x=[];break;case"select":E=B({},E,{value:void 0}),y=B({},y,{value:void 0}),x=[];break;case"textarea":E=is(c,E),y=is(c,y),x=[];break;default:typeof E.onClick!="function"&&typeof y.onClick=="function"&&(c.onclick=RS)}Yo(v,y);var N;v=null;for(Z in E)if(!y.hasOwnProperty(Z)&&E.hasOwnProperty(Z)&&E[Z]!=null)if(Z==="style"){var z=E[Z];for(N in z)z.hasOwnProperty(N)&&(v||(v={}),v[N]="")}else Z!=="dangerouslySetInnerHTML"&&Z!=="children"&&Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&Z!=="autoFocus"&&(i.hasOwnProperty(Z)?x||(x=[]):(x=x||[]).push(Z,null));for(Z in y){var U=y[Z];if(z=E!=null?E[Z]:void 0,y.hasOwnProperty(Z)&&U!==z&&(U!=null||z!=null))if(Z==="style")if(z){for(N in z)!z.hasOwnProperty(N)||U&&U.hasOwnProperty(N)||(v||(v={}),v[N]="");for(N in U)U.hasOwnProperty(N)&&z[N]!==U[N]&&(v||(v={}),v[N]=U[N])}else v||(x||(x=[]),x.push(Z,v)),v=U;else Z==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,z=z?z.__html:void 0,U!=null&&z!==U&&(x=x||[]).push(Z,U)):Z==="children"?typeof U!="string"&&typeof U!="number"||(x=x||[]).push(Z,""+U):Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&(i.hasOwnProperty(Z)?(U!=null&&Z==="onScroll"&&kt("scroll",c),x||z===U||(x=[])):(x=x||[]).push(Z,U))}v&&(x=x||[]).push("style",v);var Z=x;(d.updateQueue=Z)&&(d.flags|=4)}},Lx=function(c,d,v,y){v!==y&&(d.flags|=4)};function Ap(c,d){if(!Nt)switch(c.tailMode){case"hidden":d=c.tail;for(var v=null;d!==null;)d.alternate!==null&&(v=d),d=d.sibling;v===null?c.tail=null:v.sibling=null;break;case"collapsed":v=c.tail;for(var y=null;v!==null;)v.alternate!==null&&(y=v),v=v.sibling;y===null?d||c.tail===null?c.tail=null:c.tail.sibling=null:y.sibling=null}}function Hn(c){var d=c.alternate!==null&&c.alternate.child===c.child,v=0,y=0;if(d)for(var E=c.child;E!==null;)v|=E.lanes|E.childLanes,y|=E.subtreeFlags&14680064,y|=E.flags&14680064,E.return=c,E=E.sibling;else for(E=c.child;E!==null;)v|=E.lanes|E.childLanes,y|=E.subtreeFlags,y|=E.flags,E.return=c,E=E.sibling;return c.subtreeFlags|=y,c.childLanes=v,d}function xz(c,d,v){var y=d.pendingProps;switch(Nb(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hn(d),null;case 1:return hr(d.type)&&TS(),Hn(d),null;case 3:return y=d.stateNode,$u(),Mt(dr),Mt(Bn),Kb(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(c===null||c.child===null)&&(MS(d)?d.flags|=4:c===null||c.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Di!==null&&(Aw(Di),Di=null))),hw(c,d),Hn(d),null;case 5:Vb(d);var E=Ic(yp.current);if(v=d.type,c!==null&&d.stateNode!=null)Ox(c,d,v,y,E),c.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!y){if(d.stateNode===null)throw Error(t(166));return Hn(d),null}if(c=Ic(hs.current),MS(d)){y=d.stateNode,v=d.type;var x=d.memoizedProps;switch(y[ds]=d,y[pp]=x,c=(d.mode&1)!==0,v){case"dialog":kt("cancel",y),kt("close",y);break;case"iframe":case"object":case"embed":kt("load",y);break;case"video":case"audio":for(E=0;E<up.length;E++)kt(up[E],y);break;case"source":kt("error",y);break;case"img":case"image":case"link":kt("error",y),kt("load",y);break;case"details":kt("toggle",y);break;case"input":Ge(y,x),kt("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!x.multiple},kt("invalid",y);break;case"textarea":ss(y,x),kt("invalid",y)}Yo(v,x),E=null;for(var N in x)if(x.hasOwnProperty(N)){var z=x[N];N==="children"?typeof z=="string"?y.textContent!==z&&(x.suppressHydrationWarning!==!0&&ES(y.textContent,z,c),E=["children",z]):typeof z=="number"&&y.textContent!==""+z&&(x.suppressHydrationWarning!==!0&&ES(y.textContent,z,c),E=["children",""+z]):i.hasOwnProperty(N)&&z!=null&&N==="onScroll"&&kt("scroll",y)}switch(v){case"input":Ce(y),xn(y,x,!0);break;case"textarea":Ce(y),as(y);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(y.onclick=RS)}y=E,d.updateQueue=y,y!==null&&(d.flags|=4)}else{N=E.nodeType===9?E:E.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=ce(v)),c==="http://www.w3.org/1999/xhtml"?v==="script"?(c=N.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof y.is=="string"?c=N.createElement(v,{is:y.is}):(c=N.createElement(v),v==="select"&&(N=c,y.multiple?N.multiple=!0:y.size&&(N.size=y.size))):c=N.createElementNS(c,v),c[ds]=d,c[pp]=y,Nx(c,d,!1,!1),d.stateNode=c;e:{switch(N=Qo(v,y),v){case"dialog":kt("cancel",c),kt("close",c),E=y;break;case"iframe":case"object":case"embed":kt("load",c),E=y;break;case"video":case"audio":for(E=0;E<up.length;E++)kt(up[E],c);E=y;break;case"source":kt("error",c),E=y;break;case"img":case"image":case"link":kt("error",c),kt("load",c),E=y;break;case"details":kt("toggle",c),E=y;break;case"input":Ge(c,y),E=$e(c,y),kt("invalid",c);break;case"option":E=y;break;case"select":c._wrapperState={wasMultiple:!!y.multiple},E=B({},y,{value:void 0}),kt("invalid",c);break;case"textarea":ss(c,y),E=is(c,y),kt("invalid",c);break;default:E=y}Yo(v,E),z=E;for(x in z)if(z.hasOwnProperty(x)){var U=z[x];x==="style"?bc(c,U):x==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,U!=null&&Qn(c,U)):x==="children"?typeof U=="string"?(v!=="textarea"||U!=="")&&cs(c,U):typeof U=="number"&&cs(c,""+U):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(i.hasOwnProperty(x)?U!=null&&x==="onScroll"&&kt("scroll",c):U!=null&&P(c,x,U,N))}switch(v){case"input":Ce(c),xn(c,y,!1);break;case"textarea":Ce(c),as(c);break;case"option":y.value!=null&&c.setAttribute("value",""+ae(y.value));break;case"select":c.multiple=!!y.multiple,x=y.value,x!=null?Tr(c,!!y.multiple,x,!1):y.defaultValue!=null&&Tr(c,!!y.multiple,y.defaultValue,!0);break;default:typeof E.onClick=="function"&&(c.onclick=RS)}switch(v){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Hn(d),null;case 6:if(c&&d.stateNode!=null)Lx(c,d,c.memoizedProps,y);else{if(typeof y!="string"&&d.stateNode===null)throw Error(t(166));if(v=Ic(yp.current),Ic(hs.current),MS(d)){if(y=d.stateNode,v=d.memoizedProps,y[ds]=d,(x=y.nodeValue!==v)&&(c=Ir,c!==null))switch(c.tag){case 3:ES(y.nodeValue,v,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&ES(y.nodeValue,v,(c.mode&1)!==0)}x&&(d.flags|=4)}else y=(v.nodeType===9?v:v.ownerDocument).createTextNode(y),y[ds]=d,d.stateNode=y}return Hn(d),null;case 13:if(Mt(zt),y=d.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(Nt&&_r!==null&&(d.mode&1)!==0&&(d.flags&128)===0)FT(),qu(),d.flags|=98560,x=!1;else if(x=MS(d),y!==null&&y.dehydrated!==null){if(c===null){if(!x)throw Error(t(318));if(x=d.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(t(317));x[ds]=d}else qu(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Hn(d),x=!1}else Di!==null&&(Aw(Di),Di=null),x=!0;if(!x)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=v,d):(y=y!==null,y!==(c!==null&&c.memoizedState!==null)&&y&&(d.child.flags|=8192,(d.mode&1)!==0&&(c===null||(zt.current&1)!==0?un===0&&(un=3):Pw())),d.updateQueue!==null&&(d.flags|=4),Hn(d),null);case 4:return $u(),hw(c,d),c===null&&dp(d.stateNode.containerInfo),Hn(d),null;case 10:return Bb(d.type._context),Hn(d),null;case 17:return hr(d.type)&&TS(),Hn(d),null;case 19:if(Mt(zt),x=d.memoizedState,x===null)return Hn(d),null;if(y=(d.flags&128)!==0,N=x.rendering,N===null)if(y)Ap(x,!1);else{if(un!==0||c!==null&&(c.flags&128)!==0)for(c=d.child;c!==null;){if(N=zS(c),N!==null){for(d.flags|=128,Ap(x,!1),y=N.updateQueue,y!==null&&(d.updateQueue=y,d.flags|=4),d.subtreeFlags=0,y=v,v=d.child;v!==null;)x=v,c=y,x.flags&=14680066,N=x.alternate,N===null?(x.childLanes=0,x.lanes=c,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=N.childLanes,x.lanes=N.lanes,x.child=N.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=N.memoizedProps,x.memoizedState=N.memoizedState,x.updateQueue=N.updateQueue,x.type=N.type,c=N.dependencies,x.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),v=v.sibling;return Tt(zt,zt.current&1|2),d.child}c=c.sibling}x.tail!==null&&Zt()>Qu&&(d.flags|=128,y=!0,Ap(x,!1),d.lanes=4194304)}else{if(!y)if(c=zS(N),c!==null){if(d.flags|=128,y=!0,v=c.updateQueue,v!==null&&(d.updateQueue=v,d.flags|=4),Ap(x,!0),x.tail===null&&x.tailMode==="hidden"&&!N.alternate&&!Nt)return Hn(d),null}else 2*Zt()-x.renderingStartTime>Qu&&v!==1073741824&&(d.flags|=128,y=!0,Ap(x,!1),d.lanes=4194304);x.isBackwards?(N.sibling=d.child,d.child=N):(v=x.last,v!==null?v.sibling=N:d.child=N,x.last=N)}return x.tail!==null?(d=x.tail,x.rendering=d,x.tail=d.sibling,x.renderingStartTime=Zt(),d.sibling=null,v=zt.current,Tt(zt,y?v&1|2:v&1),d):(Hn(d),null);case 22:case 23:return Rw(),y=d.memoizedState!==null,c!==null&&c.memoizedState!==null!==y&&(d.flags|=8192),y&&(d.mode&1)!==0?(kr&1073741824)!==0&&(Hn(d),d.subtreeFlags&6&&(d.flags|=8192)):Hn(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function Iz(c,d){switch(Nb(d),d.tag){case 1:return hr(d.type)&&TS(),c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 3:return $u(),Mt(dr),Mt(Bn),Kb(),c=d.flags,(c&65536)!==0&&(c&128)===0?(d.flags=c&-65537|128,d):null;case 5:return Vb(d),null;case 13:if(Mt(zt),c=d.memoizedState,c!==null&&c.dehydrated!==null){if(d.alternate===null)throw Error(t(340));qu()}return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 19:return Mt(zt),null;case 4:return $u(),null;case 10:return Bb(d.type._context),null;case 22:case 23:return Rw(),null;case 24:return null;default:return null}}var KS=!1,Wn=!1,_z=typeof WeakSet=="function"?WeakSet:Set,Re=null;function Xu(c,d){var v=c.ref;if(v!==null)if(typeof v=="function")try{v(null)}catch(y){Vt(c,d,y)}else v.current=null}function pw(c,d,v){try{v()}catch(y){Vt(c,d,y)}}var jx=!1;function kz(c,d){if(Rb=pS,c=gT(),mb(c)){if("selectionStart"in c)var v={start:c.selectionStart,end:c.selectionEnd};else e:{v=(v=c.ownerDocument)&&v.defaultView||window;var y=v.getSelection&&v.getSelection();if(y&&y.rangeCount!==0){v=y.anchorNode;var E=y.anchorOffset,x=y.focusNode;y=y.focusOffset;try{v.nodeType,x.nodeType}catch{v=null;break e}var N=0,z=-1,U=-1,Z=0,ue=0,de=c,le=null;t:for(;;){for(var we;de!==v||E!==0&&de.nodeType!==3||(z=N+E),de!==x||y!==0&&de.nodeType!==3||(U=N+y),de.nodeType===3&&(N+=de.nodeValue.length),(we=de.firstChild)!==null;)le=de,de=we;for(;;){if(de===c)break t;if(le===v&&++Z===E&&(z=N),le===x&&++ue===y&&(U=N),(we=de.nextSibling)!==null)break;de=le,le=de.parentNode}de=we}v=z===-1||U===-1?null:{start:z,end:U}}else v=null}v=v||{start:0,end:0}}else v=null;for(Pb={focusedElem:c,selectionRange:v},pS=!1,Re=d;Re!==null;)if(d=Re,c=d.child,(d.subtreeFlags&1028)!==0&&c!==null)c.return=d,Re=c;else for(;Re!==null;){d=Re;try{var Pe=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(Pe!==null){var Te=Pe.memoizedProps,en=Pe.memoizedState,X=d.stateNode,q=X.getSnapshotBeforeUpdate(d.elementType===d.type?Te:Ni(d.type,Te),en);X.__reactInternalSnapshotBeforeUpdate=q}break;case 3:var Y=d.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(fe){Vt(d,d.return,fe)}if(c=d.sibling,c!==null){c.return=d.return,Re=c;break}Re=d.return}return Pe=jx,jx=!1,Pe}function Ep(c,d,v){var y=d.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var E=y=y.next;do{if((E.tag&c)===c){var x=E.destroy;E.destroy=void 0,x!==void 0&&pw(d,v,x)}E=E.next}while(E!==y)}}function $S(c,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var v=d=d.next;do{if((v.tag&c)===c){var y=v.create;v.destroy=y()}v=v.next}while(v!==d)}}function fw(c){var d=c.ref;if(d!==null){var v=c.stateNode;switch(c.tag){case 5:c=v;break;default:c=v}typeof d=="function"?d(c):d.current=c}}function zx(c){var d=c.alternate;d!==null&&(c.alternate=null,zx(d)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(d=c.stateNode,d!==null&&(delete d[ds],delete d[pp],delete d[_b],delete d[pz],delete d[fz])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function Fx(c){return c.tag===5||c.tag===3||c.tag===4}function Bx(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||Fx(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function gw(c,d,v){var y=c.tag;if(y===5||y===6)c=c.stateNode,d?v.nodeType===8?v.parentNode.insertBefore(c,d):v.insertBefore(c,d):(v.nodeType===8?(d=v.parentNode,d.insertBefore(c,v)):(d=v,d.appendChild(c)),v=v._reactRootContainer,v!=null||d.onclick!==null||(d.onclick=RS));else if(y!==4&&(c=c.child,c!==null))for(gw(c,d,v),c=c.sibling;c!==null;)gw(c,d,v),c=c.sibling}function vw(c,d,v){var y=c.tag;if(y===5||y===6)c=c.stateNode,d?v.insertBefore(c,d):v.appendChild(c);else if(y!==4&&(c=c.child,c!==null))for(vw(c,d,v),c=c.sibling;c!==null;)vw(c,d,v),c=c.sibling}var In=null,Oi=!1;function pa(c,d,v){for(v=v.child;v!==null;)Ux(c,d,v),v=v.sibling}function Ux(c,d,v){if(us&&typeof us.onCommitFiberUnmount=="function")try{us.onCommitFiberUnmount(aS,v)}catch{}switch(v.tag){case 5:Wn||Xu(v,d);case 6:var y=In,E=Oi;In=null,pa(c,d,v),In=y,Oi=E,In!==null&&(Oi?(c=In,v=v.stateNode,c.nodeType===8?c.parentNode.removeChild(v):c.removeChild(v)):In.removeChild(v.stateNode));break;case 18:In!==null&&(Oi?(c=In,v=v.stateNode,c.nodeType===8?Ib(c.parentNode,v):c.nodeType===1&&Ib(c,v),np(c)):Ib(In,v.stateNode));break;case 4:y=In,E=Oi,In=v.stateNode.containerInfo,Oi=!0,pa(c,d,v),In=y,Oi=E;break;case 0:case 11:case 14:case 15:if(!Wn&&(y=v.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){E=y=y.next;do{var x=E,N=x.destroy;x=x.tag,N!==void 0&&((x&2)!==0||(x&4)!==0)&&pw(v,d,N),E=E.next}while(E!==y)}pa(c,d,v);break;case 1:if(!Wn&&(Xu(v,d),y=v.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=v.memoizedProps,y.state=v.memoizedState,y.componentWillUnmount()}catch(z){Vt(v,d,z)}pa(c,d,v);break;case 21:pa(c,d,v);break;case 22:v.mode&1?(Wn=(y=Wn)||v.memoizedState!==null,pa(c,d,v),Wn=y):pa(c,d,v);break;default:pa(c,d,v)}}function Hx(c){var d=c.updateQueue;if(d!==null){c.updateQueue=null;var v=c.stateNode;v===null&&(v=c.stateNode=new _z),d.forEach(function(y){var E=Bz.bind(null,c,y);v.has(y)||(v.add(y),y.then(E,E))})}}function Li(c,d){var v=d.deletions;if(v!==null)for(var y=0;y<v.length;y++){var E=v[y];try{var x=c,N=d,z=N;e:for(;z!==null;){switch(z.tag){case 5:In=z.stateNode,Oi=!1;break e;case 3:In=z.stateNode.containerInfo,Oi=!0;break e;case 4:In=z.stateNode.containerInfo,Oi=!0;break e}z=z.return}if(In===null)throw Error(t(160));Ux(x,N,E),In=null,Oi=!1;var U=E.alternate;U!==null&&(U.return=null),E.return=null}catch(Z){Vt(E,d,Z)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)Wx(d,c),d=d.sibling}function Wx(c,d){var v=c.alternate,y=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(Li(d,c),fs(c),y&4){try{Ep(3,c,c.return),$S(3,c)}catch(Te){Vt(c,c.return,Te)}try{Ep(5,c,c.return)}catch(Te){Vt(c,c.return,Te)}}break;case 1:Li(d,c),fs(c),y&512&&v!==null&&Xu(v,v.return);break;case 5:if(Li(d,c),fs(c),y&512&&v!==null&&Xu(v,v.return),c.flags&32){var E=c.stateNode;try{cs(E,"")}catch(Te){Vt(c,c.return,Te)}}if(y&4&&(E=c.stateNode,E!=null)){var x=c.memoizedProps,N=v!==null?v.memoizedProps:x,z=c.type,U=c.updateQueue;if(c.updateQueue=null,U!==null)try{z==="input"&&x.type==="radio"&&x.name!=null&&Ve(E,x),Qo(z,N);var Z=Qo(z,x);for(N=0;N<U.length;N+=2){var ue=U[N],de=U[N+1];ue==="style"?bc(E,de):ue==="dangerouslySetInnerHTML"?Qn(E,de):ue==="children"?cs(E,de):P(E,ue,de,Z)}switch(z){case"input":st(E,x);break;case"textarea":os(E,x);break;case"select":var le=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!x.multiple;var we=x.value;we!=null?Tr(E,!!x.multiple,we,!1):le!==!!x.multiple&&(x.defaultValue!=null?Tr(E,!!x.multiple,x.defaultValue,!0):Tr(E,!!x.multiple,x.multiple?[]:"",!1))}E[pp]=x}catch(Te){Vt(c,c.return,Te)}}break;case 6:if(Li(d,c),fs(c),y&4){if(c.stateNode===null)throw Error(t(162));E=c.stateNode,x=c.memoizedProps;try{E.nodeValue=x}catch(Te){Vt(c,c.return,Te)}}break;case 3:if(Li(d,c),fs(c),y&4&&v!==null&&v.memoizedState.isDehydrated)try{np(d.containerInfo)}catch(Te){Vt(c,c.return,Te)}break;case 4:Li(d,c),fs(c);break;case 13:Li(d,c),fs(c),E=c.child,E.flags&8192&&(x=E.memoizedState!==null,E.stateNode.isHidden=x,!x||E.alternate!==null&&E.alternate.memoizedState!==null||(Sw=Zt())),y&4&&Hx(c);break;case 22:if(ue=v!==null&&v.memoizedState!==null,c.mode&1?(Wn=(Z=Wn)||ue,Li(d,c),Wn=Z):Li(d,c),fs(c),y&8192){if(Z=c.memoizedState!==null,(c.stateNode.isHidden=Z)&&!ue&&(c.mode&1)!==0)for(Re=c,ue=c.child;ue!==null;){for(de=Re=ue;Re!==null;){switch(le=Re,we=le.child,le.tag){case 0:case 11:case 14:case 15:Ep(4,le,le.return);break;case 1:Xu(le,le.return);var Pe=le.stateNode;if(typeof Pe.componentWillUnmount=="function"){y=le,v=le.return;try{d=y,Pe.props=d.memoizedProps,Pe.state=d.memoizedState,Pe.componentWillUnmount()}catch(Te){Vt(y,v,Te)}}break;case 5:Xu(le,le.return);break;case 22:if(le.memoizedState!==null){Gx(de);continue}}we!==null?(we.return=le,Re=we):Gx(de)}ue=ue.sibling}e:for(ue=null,de=c;;){if(de.tag===5){if(ue===null){ue=de;try{E=de.stateNode,Z?(x=E.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(z=de.stateNode,U=de.memoizedProps.style,N=U!=null&&U.hasOwnProperty("display")?U.display:null,z.style.display=Cc("display",N))}catch(Te){Vt(c,c.return,Te)}}}else if(de.tag===6){if(ue===null)try{de.stateNode.nodeValue=Z?"":de.memoizedProps}catch(Te){Vt(c,c.return,Te)}}else if((de.tag!==22&&de.tag!==23||de.memoizedState===null||de===c)&&de.child!==null){de.child.return=de,de=de.child;continue}if(de===c)break e;for(;de.sibling===null;){if(de.return===null||de.return===c)break e;ue===de&&(ue=null),de=de.return}ue===de&&(ue=null),de.sibling.return=de.return,de=de.sibling}}break;case 19:Li(d,c),fs(c),y&4&&Hx(c);break;case 21:break;default:Li(d,c),fs(c)}}function fs(c){var d=c.flags;if(d&2){try{e:{for(var v=c.return;v!==null;){if(Fx(v)){var y=v;break e}v=v.return}throw Error(t(160))}switch(y.tag){case 5:var E=y.stateNode;y.flags&32&&(cs(E,""),y.flags&=-33);var x=Bx(c);vw(c,x,E);break;case 3:case 4:var N=y.stateNode.containerInfo,z=Bx(c);gw(c,z,N);break;default:throw Error(t(161))}}catch(U){Vt(c,c.return,U)}c.flags&=-3}d&4096&&(c.flags&=-4097)}function Mz(c,d,v){Re=c,qx(c)}function qx(c,d,v){for(var y=(c.mode&1)!==0;Re!==null;){var E=Re,x=E.child;if(E.tag===22&&y){var N=E.memoizedState!==null||KS;if(!N){var z=E.alternate,U=z!==null&&z.memoizedState!==null||Wn;z=KS;var Z=Wn;if(KS=N,(Wn=U)&&!Z)for(Re=E;Re!==null;)N=Re,U=N.child,N.tag===22&&N.memoizedState!==null?Kx(E):U!==null?(U.return=N,Re=U):Kx(E);for(;x!==null;)Re=x,qx(x),x=x.sibling;Re=E,KS=z,Wn=Z}Vx(c)}else(E.subtreeFlags&8772)!==0&&x!==null?(x.return=E,Re=x):Vx(c)}}function Vx(c){for(;Re!==null;){var d=Re;if((d.flags&8772)!==0){var v=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Wn||$S(5,d);break;case 1:var y=d.stateNode;if(d.flags&4&&!Wn)if(v===null)y.componentDidMount();else{var E=d.elementType===d.type?v.memoizedProps:Ni(d.type,v.memoizedProps);y.componentDidUpdate(E,v.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var x=d.updateQueue;x!==null&&GT(d,x,y);break;case 3:var N=d.updateQueue;if(N!==null){if(v=null,d.child!==null)switch(d.child.tag){case 5:v=d.child.stateNode;break;case 1:v=d.child.stateNode}GT(d,N,v)}break;case 5:var z=d.stateNode;if(v===null&&d.flags&4){v=z;var U=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":U.autoFocus&&v.focus();break;case"img":U.src&&(v.src=U.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Z=d.alternate;if(Z!==null){var ue=Z.memoizedState;if(ue!==null){var de=ue.dehydrated;de!==null&&np(de)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Wn||d.flags&512&&fw(d)}catch(le){Vt(d,d.return,le)}}if(d===c){Re=null;break}if(v=d.sibling,v!==null){v.return=d.return,Re=v;break}Re=d.return}}function Gx(c){for(;Re!==null;){var d=Re;if(d===c){Re=null;break}var v=d.sibling;if(v!==null){v.return=d.return,Re=v;break}Re=d.return}}function Kx(c){for(;Re!==null;){var d=Re;try{switch(d.tag){case 0:case 11:case 15:var v=d.return;try{$S(4,d)}catch(U){Vt(d,v,U)}break;case 1:var y=d.stateNode;if(typeof y.componentDidMount=="function"){var E=d.return;try{y.componentDidMount()}catch(U){Vt(d,E,U)}}var x=d.return;try{fw(d)}catch(U){Vt(d,x,U)}break;case 5:var N=d.return;try{fw(d)}catch(U){Vt(d,N,U)}}}catch(U){Vt(d,d.return,U)}if(d===c){Re=null;break}var z=d.sibling;if(z!==null){z.return=d.return,Re=z;break}Re=d.return}}var Dz=Math.ceil,JS=I.ReactCurrentDispatcher,mw=I.ReactCurrentOwner,di=I.ReactCurrentBatchConfig,ot=0,Sn=null,rn=null,_n=0,kr=0,Yu=ca(0),un=0,Rp=null,kc=0,XS=0,yw=0,Pp=null,fr=null,Sw=0,Qu=1/0,Qs=null,YS=!1,Cw=null,fa=null,QS=!1,ga=null,ZS=0,Tp=0,bw=null,eC=-1,tC=0;function er(){return(ot&6)!==0?Zt():eC!==-1?eC:eC=Zt()}function va(c){return(c.mode&1)===0?1:(ot&2)!==0&&_n!==0?_n&-_n:vz.transition!==null?(tC===0&&(tC=BP()),tC):(c=ht,c!==0||(c=window.event,c=c===void 0?16:JP(c.type)),c)}function ji(c,d,v,y){if(50<Tp)throw Tp=0,bw=null,Error(t(185));Yh(c,v,y),((ot&2)===0||c!==Sn)&&(c===Sn&&((ot&2)===0&&(XS|=v),un===4&&ma(c,_n)),gr(c,y),v===1&&ot===0&&(d.mode&1)===0&&(Qu=Zt()+500,IS&&ua()))}function gr(c,d){var v=c.callbackNode;vj(c,d);var y=uS(c,c===Sn?_n:0);if(y===0)v!==null&&jP(v),c.callbackNode=null,c.callbackPriority=0;else if(d=y&-y,c.callbackPriority!==d){if(v!=null&&jP(v),d===1)c.tag===0?gz(Jx.bind(null,c)):NT(Jx.bind(null,c)),dz(function(){(ot&6)===0&&ua()}),v=null;else{switch(UP(y)){case 1:v=eb;break;case 4:v=zP;break;case 16:v=oS;break;case 536870912:v=FP;break;default:v=oS}v=r1(v,$x.bind(null,c))}c.callbackPriority=d,c.callbackNode=v}}function $x(c,d){if(eC=-1,tC=0,(ot&6)!==0)throw Error(t(327));var v=c.callbackNode;if(Zu()&&c.callbackNode!==v)return null;var y=uS(c,c===Sn?_n:0);if(y===0)return null;if((y&30)!==0||(y&c.expiredLanes)!==0||d)d=nC(c,y);else{d=y;var E=ot;ot|=2;var x=Yx();(Sn!==c||_n!==d)&&(Qs=null,Qu=Zt()+500,Dc(c,d));do try{Lz();break}catch(z){Xx(c,z)}while(!0);Fb(),JS.current=x,ot=E,rn!==null?d=0:(Sn=null,_n=0,d=un)}if(d!==0){if(d===2&&(E=tb(c),E!==0&&(y=E,d=ww(c,E))),d===1)throw v=Rp,Dc(c,0),ma(c,y),gr(c,Zt()),v;if(d===6)ma(c,y);else{if(E=c.current.alternate,(y&30)===0&&!Nz(E)&&(d=nC(c,y),d===2&&(x=tb(c),x!==0&&(y=x,d=ww(c,x))),d===1))throw v=Rp,Dc(c,0),ma(c,y),gr(c,Zt()),v;switch(c.finishedWork=E,c.finishedLanes=y,d){case 0:case 1:throw Error(t(345));case 2:Nc(c,fr,Qs);break;case 3:if(ma(c,y),(y&130023424)===y&&(d=Sw+500-Zt(),10<d)){if(uS(c,0)!==0)break;if(E=c.suspendedLanes,(E&y)!==y){er(),c.pingedLanes|=c.suspendedLanes&E;break}c.timeoutHandle=xb(Nc.bind(null,c,fr,Qs),d);break}Nc(c,fr,Qs);break;case 4:if(ma(c,y),(y&4194240)===y)break;for(d=c.eventTimes,E=-1;0<y;){var N=31-ki(y);x=1<<N,N=d[N],N>E&&(E=N),y&=~x}if(y=E,y=Zt()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*Dz(y/1960))-y,10<y){c.timeoutHandle=xb(Nc.bind(null,c,fr,Qs),y);break}Nc(c,fr,Qs);break;case 5:Nc(c,fr,Qs);break;default:throw Error(t(329))}}}return gr(c,Zt()),c.callbackNode===v?$x.bind(null,c):null}function ww(c,d){var v=Pp;return c.current.memoizedState.isDehydrated&&(Dc(c,d).flags|=256),c=nC(c,d),c!==2&&(d=fr,fr=v,d!==null&&Aw(d)),c}function Aw(c){fr===null?fr=c:fr.push.apply(fr,c)}function Nz(c){for(var d=c;;){if(d.flags&16384){var v=d.updateQueue;if(v!==null&&(v=v.stores,v!==null))for(var y=0;y<v.length;y++){var E=v[y],x=E.getSnapshot;E=E.value;try{if(!Mi(x(),E))return!1}catch{return!1}}}if(v=d.child,d.subtreeFlags&16384&&v!==null)v.return=d,d=v;else{if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function ma(c,d){for(d&=~yw,d&=~XS,c.suspendedLanes|=d,c.pingedLanes&=~d,c=c.expirationTimes;0<d;){var v=31-ki(d),y=1<<v;c[v]=-1,d&=~y}}function Jx(c){if((ot&6)!==0)throw Error(t(327));Zu();var d=uS(c,0);if((d&1)===0)return gr(c,Zt()),null;var v=nC(c,d);if(c.tag!==0&&v===2){var y=tb(c);y!==0&&(d=y,v=ww(c,y))}if(v===1)throw v=Rp,Dc(c,0),ma(c,d),gr(c,Zt()),v;if(v===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=d,Nc(c,fr,Qs),gr(c,Zt()),null}function Ew(c,d){var v=ot;ot|=1;try{return c(d)}finally{ot=v,ot===0&&(Qu=Zt()+500,IS&&ua())}}function Mc(c){ga!==null&&ga.tag===0&&(ot&6)===0&&Zu();var d=ot;ot|=1;var v=di.transition,y=ht;try{if(di.transition=null,ht=1,c)return c()}finally{ht=y,di.transition=v,ot=d,(ot&6)===0&&ua()}}function Rw(){kr=Yu.current,Mt(Yu)}function Dc(c,d){c.finishedWork=null,c.finishedLanes=0;var v=c.timeoutHandle;if(v!==-1&&(c.timeoutHandle=-1,uz(v)),rn!==null)for(v=rn.return;v!==null;){var y=v;switch(Nb(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&TS();break;case 3:$u(),Mt(dr),Mt(Bn),Kb();break;case 5:Vb(y);break;case 4:$u();break;case 13:Mt(zt);break;case 19:Mt(zt);break;case 10:Bb(y.type._context);break;case 22:case 23:Rw()}v=v.return}if(Sn=c,rn=c=ya(c.current,null),_n=kr=d,un=0,Rp=null,yw=XS=kc=0,fr=Pp=null,xc!==null){for(d=0;d<xc.length;d++)if(v=xc[d],y=v.interleaved,y!==null){v.interleaved=null;var E=y.next,x=v.pending;if(x!==null){var N=x.next;x.next=E,y.next=N}v.pending=y}xc=null}return c}function Xx(c,d){do{var v=rn;try{if(Fb(),FS.current=WS,BS){for(var y=Ft.memoizedState;y!==null;){var E=y.queue;E!==null&&(E.pending=null),y=y.next}BS=!1}if(_c=0,yn=ln=Ft=null,Sp=!1,Cp=0,mw.current=null,v===null||v.return===null){un=1,Rp=d,rn=null;break}e:{var x=c,N=v.return,z=v,U=d;if(d=_n,z.flags|=32768,U!==null&&typeof U=="object"&&typeof U.then=="function"){var Z=U,ue=z,de=ue.tag;if((ue.mode&1)===0&&(de===0||de===11||de===15)){var le=ue.alternate;le?(ue.updateQueue=le.updateQueue,ue.memoizedState=le.memoizedState,ue.lanes=le.lanes):(ue.updateQueue=null,ue.memoizedState=null)}var we=bx(N);if(we!==null){we.flags&=-257,wx(we,N,z,x,d),we.mode&1&&Cx(x,Z,d),d=we,U=Z;var Pe=d.updateQueue;if(Pe===null){var Te=new Set;Te.add(U),d.updateQueue=Te}else Pe.add(U);break e}else{if((d&1)===0){Cx(x,Z,d),Pw();break e}U=Error(t(426))}}else if(Nt&&z.mode&1){var en=bx(N);if(en!==null){(en.flags&65536)===0&&(en.flags|=256),wx(en,N,z,x,d),jb(Ju(U,z));break e}}x=U=Ju(U,z),un!==4&&(un=2),Pp===null?Pp=[x]:Pp.push(x),x=N;do{switch(x.tag){case 3:x.flags|=65536,d&=-d,x.lanes|=d;var X=yx(x,U,d);VT(x,X);break e;case 1:z=U;var q=x.type,Y=x.stateNode;if((x.flags&128)===0&&(typeof q.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(fa===null||!fa.has(Y)))){x.flags|=65536,d&=-d,x.lanes|=d;var fe=Sx(x,z,d);VT(x,fe);break e}}x=x.return}while(x!==null)}Zx(v)}catch(Ie){d=Ie,rn===v&&v!==null&&(rn=v=v.return);continue}break}while(!0)}function Yx(){var c=JS.current;return JS.current=WS,c===null?WS:c}function Pw(){(un===0||un===3||un===2)&&(un=4),Sn===null||(kc&268435455)===0&&(XS&268435455)===0||ma(Sn,_n)}function nC(c,d){var v=ot;ot|=2;var y=Yx();(Sn!==c||_n!==d)&&(Qs=null,Dc(c,d));do try{Oz();break}catch(E){Xx(c,E)}while(!0);if(Fb(),ot=v,JS.current=y,rn!==null)throw Error(t(261));return Sn=null,_n=0,un}function Oz(){for(;rn!==null;)Qx(rn)}function Lz(){for(;rn!==null&&!aj();)Qx(rn)}function Qx(c){var d=n1(c.alternate,c,kr);c.memoizedProps=c.pendingProps,d===null?Zx(c):rn=d,mw.current=null}function Zx(c){var d=c;do{var v=d.alternate;if(c=d.return,(d.flags&32768)===0){if(v=xz(v,d,kr),v!==null){rn=v;return}}else{if(v=Iz(v,d),v!==null){v.flags&=32767,rn=v;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{un=6,rn=null;return}}if(d=d.sibling,d!==null){rn=d;return}rn=d=c}while(d!==null);un===0&&(un=5)}function Nc(c,d,v){var y=ht,E=di.transition;try{di.transition=null,ht=1,jz(c,d,v,y)}finally{di.transition=E,ht=y}return null}function jz(c,d,v,y){do Zu();while(ga!==null);if((ot&6)!==0)throw Error(t(327));v=c.finishedWork;var E=c.finishedLanes;if(v===null)return null;if(c.finishedWork=null,c.finishedLanes=0,v===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var x=v.lanes|v.childLanes;if(mj(c,x),c===Sn&&(rn=Sn=null,_n=0),(v.subtreeFlags&2064)===0&&(v.flags&2064)===0||QS||(QS=!0,r1(oS,function(){return Zu(),null})),x=(v.flags&15990)!==0,(v.subtreeFlags&15990)!==0||x){x=di.transition,di.transition=null;var N=ht;ht=1;var z=ot;ot|=4,mw.current=null,kz(c,v),Wx(v,c),rz(Pb),pS=!!Rb,Pb=Rb=null,c.current=v,Mz(v),cj(),ot=z,ht=N,di.transition=x}else c.current=v;if(QS&&(QS=!1,ga=c,ZS=E),x=c.pendingLanes,x===0&&(fa=null),dj(v.stateNode),gr(c,Zt()),d!==null)for(y=c.onRecoverableError,v=0;v<d.length;v++)E=d[v],y(E.value,{componentStack:E.stack,digest:E.digest});if(YS)throw YS=!1,c=Cw,Cw=null,c;return(ZS&1)!==0&&c.tag!==0&&Zu(),x=c.pendingLanes,(x&1)!==0?c===bw?Tp++:(Tp=0,bw=c):Tp=0,ua(),null}function Zu(){if(ga!==null){var c=UP(ZS),d=di.transition,v=ht;try{if(di.transition=null,ht=16>c?16:c,ga===null)var y=!1;else{if(c=ga,ga=null,ZS=0,(ot&6)!==0)throw Error(t(331));var E=ot;for(ot|=4,Re=c.current;Re!==null;){var x=Re,N=x.child;if((Re.flags&16)!==0){var z=x.deletions;if(z!==null){for(var U=0;U<z.length;U++){var Z=z[U];for(Re=Z;Re!==null;){var ue=Re;switch(ue.tag){case 0:case 11:case 15:Ep(8,ue,x)}var de=ue.child;if(de!==null)de.return=ue,Re=de;else for(;Re!==null;){ue=Re;var le=ue.sibling,we=ue.return;if(zx(ue),ue===Z){Re=null;break}if(le!==null){le.return=we,Re=le;break}Re=we}}}var Pe=x.alternate;if(Pe!==null){var Te=Pe.child;if(Te!==null){Pe.child=null;do{var en=Te.sibling;Te.sibling=null,Te=en}while(Te!==null)}}Re=x}}if((x.subtreeFlags&2064)!==0&&N!==null)N.return=x,Re=N;else e:for(;Re!==null;){if(x=Re,(x.flags&2048)!==0)switch(x.tag){case 0:case 11:case 15:Ep(9,x,x.return)}var X=x.sibling;if(X!==null){X.return=x.return,Re=X;break e}Re=x.return}}var q=c.current;for(Re=q;Re!==null;){N=Re;var Y=N.child;if((N.subtreeFlags&2064)!==0&&Y!==null)Y.return=N,Re=Y;else e:for(N=q;Re!==null;){if(z=Re,(z.flags&2048)!==0)try{switch(z.tag){case 0:case 11:case 15:$S(9,z)}}catch(Ie){Vt(z,z.return,Ie)}if(z===N){Re=null;break e}var fe=z.sibling;if(fe!==null){fe.return=z.return,Re=fe;break e}Re=z.return}}if(ot=E,ua(),us&&typeof us.onPostCommitFiberRoot=="function")try{us.onPostCommitFiberRoot(aS,c)}catch{}y=!0}return y}finally{ht=v,di.transition=d}}return!1}function e1(c,d,v){d=Ju(v,d),d=yx(c,d,1),c=ha(c,d,1),d=er(),c!==null&&(Yh(c,1,d),gr(c,d))}function Vt(c,d,v){if(c.tag===3)e1(c,c,v);else for(;d!==null;){if(d.tag===3){e1(d,c,v);break}else if(d.tag===1){var y=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(fa===null||!fa.has(y))){c=Ju(v,c),c=Sx(d,c,1),d=ha(d,c,1),c=er(),d!==null&&(Yh(d,1,c),gr(d,c));break}}d=d.return}}function zz(c,d,v){var y=c.pingCache;y!==null&&y.delete(d),d=er(),c.pingedLanes|=c.suspendedLanes&v,Sn===c&&(_n&v)===v&&(un===4||un===3&&(_n&130023424)===_n&&500>Zt()-Sw?Dc(c,0):yw|=v),gr(c,d)}function t1(c,d){d===0&&((c.mode&1)===0?d=1:(d=lS,lS<<=1,(lS&130023424)===0&&(lS=4194304)));var v=er();c=Js(c,d),c!==null&&(Yh(c,d,v),gr(c,v))}function Fz(c){var d=c.memoizedState,v=0;d!==null&&(v=d.retryLane),t1(c,v)}function Bz(c,d){var v=0;switch(c.tag){case 13:var y=c.stateNode,E=c.memoizedState;E!==null&&(v=E.retryLane);break;case 19:y=c.stateNode;break;default:throw Error(t(314))}y!==null&&y.delete(d),t1(c,v)}var n1;n1=function(c,d,v){if(c!==null)if(c.memoizedProps!==d.pendingProps||dr.current)pr=!0;else{if((c.lanes&v)===0&&(d.flags&128)===0)return pr=!1,Tz(c,d,v);pr=(c.flags&131072)!==0}else pr=!1,Nt&&(d.flags&1048576)!==0&&OT(d,kS,d.index);switch(d.lanes=0,d.tag){case 2:var y=d.type;GS(c,d),c=d.pendingProps;var E=Uu(d,Bn.current);Ku(d,v),E=Xb(null,d,y,c,E,v);var x=Yb();return d.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,hr(y)?(x=!0,xS(d)):x=!1,d.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,Wb(d),E.updater=qS,d.stateNode=E,E._reactInternals=d,rw(d,y,c,v),d=aw(null,d,y,!0,x,v)):(d.tag=0,Nt&&x&&Db(d),Zn(null,d,E,v),d=d.child),d;case 16:y=d.elementType;e:{switch(GS(c,d),c=d.pendingProps,E=y._init,y=E(y._payload),d.type=y,E=d.tag=Hz(y),c=Ni(y,c),E){case 0:d=ow(null,d,y,c,v);break e;case 1:d=xx(null,d,y,c,v);break e;case 11:d=Ax(null,d,y,c,v);break e;case 14:d=Ex(null,d,y,Ni(y.type,c),v);break e}throw Error(t(306,y,""))}return d;case 0:return y=d.type,E=d.pendingProps,E=d.elementType===y?E:Ni(y,E),ow(c,d,y,E,v);case 1:return y=d.type,E=d.pendingProps,E=d.elementType===y?E:Ni(y,E),xx(c,d,y,E,v);case 3:e:{if(Ix(d),c===null)throw Error(t(387));y=d.pendingProps,x=d.memoizedState,E=x.element,qT(c,d),jS(d,y,null,v);var N=d.memoizedState;if(y=N.element,x.isDehydrated)if(x={element:y,isDehydrated:!1,cache:N.cache,pendingSuspenseBoundaries:N.pendingSuspenseBoundaries,transitions:N.transitions},d.updateQueue.baseState=x,d.memoizedState=x,d.flags&256){E=Ju(Error(t(423)),d),d=_x(c,d,y,v,E);break e}else if(y!==E){E=Ju(Error(t(424)),d),d=_x(c,d,y,v,E);break e}else for(_r=aa(d.stateNode.containerInfo.firstChild),Ir=d,Nt=!0,Di=null,v=HT(d,null,y,v),d.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(qu(),y===E){d=Ys(c,d,v);break e}Zn(c,d,y,v)}d=d.child}return d;case 5:return KT(d),c===null&&Lb(d),y=d.type,E=d.pendingProps,x=c!==null?c.memoizedProps:null,N=E.children,Tb(y,E)?N=null:x!==null&&Tb(y,x)&&(d.flags|=32),Tx(c,d),Zn(c,d,N,v),d.child;case 6:return c===null&&Lb(d),null;case 13:return kx(c,d,v);case 4:return qb(d,d.stateNode.containerInfo),y=d.pendingProps,c===null?d.child=Vu(d,null,y,v):Zn(c,d,y,v),d.child;case 11:return y=d.type,E=d.pendingProps,E=d.elementType===y?E:Ni(y,E),Ax(c,d,y,E,v);case 7:return Zn(c,d,d.pendingProps,v),d.child;case 8:return Zn(c,d,d.pendingProps.children,v),d.child;case 12:return Zn(c,d,d.pendingProps.children,v),d.child;case 10:e:{if(y=d.type._context,E=d.pendingProps,x=d.memoizedProps,N=E.value,Tt(NS,y._currentValue),y._currentValue=N,x!==null)if(Mi(x.value,N)){if(x.children===E.children&&!dr.current){d=Ys(c,d,v);break e}}else for(x=d.child,x!==null&&(x.return=d);x!==null;){var z=x.dependencies;if(z!==null){N=x.child;for(var U=z.firstContext;U!==null;){if(U.context===y){if(x.tag===1){U=Xs(-1,v&-v),U.tag=2;var Z=x.updateQueue;if(Z!==null){Z=Z.shared;var ue=Z.pending;ue===null?U.next=U:(U.next=ue.next,ue.next=U),Z.pending=U}}x.lanes|=v,U=x.alternate,U!==null&&(U.lanes|=v),Ub(x.return,v,d),z.lanes|=v;break}U=U.next}}else if(x.tag===10)N=x.type===d.type?null:x.child;else if(x.tag===18){if(N=x.return,N===null)throw Error(t(341));N.lanes|=v,z=N.alternate,z!==null&&(z.lanes|=v),Ub(N,v,d),N=x.sibling}else N=x.child;if(N!==null)N.return=x;else for(N=x;N!==null;){if(N===d){N=null;break}if(x=N.sibling,x!==null){x.return=N.return,N=x;break}N=N.return}x=N}Zn(c,d,E.children,v),d=d.child}return d;case 9:return E=d.type,y=d.pendingProps.children,Ku(d,v),E=li(E),y=y(E),d.flags|=1,Zn(c,d,y,v),d.child;case 14:return y=d.type,E=Ni(y,d.pendingProps),E=Ni(y.type,E),Ex(c,d,y,E,v);case 15:return Rx(c,d,d.type,d.pendingProps,v);case 17:return y=d.type,E=d.pendingProps,E=d.elementType===y?E:Ni(y,E),GS(c,d),d.tag=1,hr(y)?(c=!0,xS(d)):c=!1,Ku(d,v),vx(d,y,E),rw(d,y,E,v),aw(null,d,y,!0,c,v);case 19:return Dx(c,d,v);case 22:return Px(c,d,v)}throw Error(t(156,d.tag))};function r1(c,d){return LP(c,d)}function Uz(c,d,v,y){this.tag=c,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hi(c,d,v,y){return new Uz(c,d,v,y)}function Tw(c){return c=c.prototype,!(!c||!c.isReactComponent)}function Hz(c){if(typeof c=="function")return Tw(c)?1:0;if(c!=null){if(c=c.$$typeof,c===ie)return 11;if(c===se)return 14}return 2}function ya(c,d){var v=c.alternate;return v===null?(v=hi(c.tag,d,c.key,c.mode),v.elementType=c.elementType,v.type=c.type,v.stateNode=c.stateNode,v.alternate=c,c.alternate=v):(v.pendingProps=d,v.type=c.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=c.flags&14680064,v.childLanes=c.childLanes,v.lanes=c.lanes,v.child=c.child,v.memoizedProps=c.memoizedProps,v.memoizedState=c.memoizedState,v.updateQueue=c.updateQueue,d=c.dependencies,v.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},v.sibling=c.sibling,v.index=c.index,v.ref=c.ref,v}function rC(c,d,v,y,E,x){var N=2;if(y=c,typeof c=="function")Tw(c)&&(N=1);else if(typeof c=="string")N=5;else e:switch(c){case O:return Oc(v.children,E,x,d);case L:N=8,E|=8;break;case F:return c=hi(12,v,d,E|2),c.elementType=F,c.lanes=x,c;case J:return c=hi(13,v,d,E),c.elementType=J,c.lanes=x,c;case ee:return c=hi(19,v,d,E),c.elementType=ee,c.lanes=x,c;case Q:return iC(v,E,x,d);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case H:N=10;break e;case V:N=9;break e;case ie:N=11;break e;case se:N=14;break e;case ne:N=16,y=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return d=hi(N,v,d,E),d.elementType=c,d.type=y,d.lanes=x,d}function Oc(c,d,v,y){return c=hi(7,c,y,d),c.lanes=v,c}function iC(c,d,v,y){return c=hi(22,c,y,d),c.elementType=Q,c.lanes=v,c.stateNode={isHidden:!1},c}function xw(c,d,v){return c=hi(6,c,null,d),c.lanes=v,c}function Iw(c,d,v){return d=hi(4,c.children!==null?c.children:[],c.key,d),d.lanes=v,d.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},d}function Wz(c,d,v,y,E){this.tag=d,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nb(0),this.expirationTimes=nb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nb(0),this.identifierPrefix=y,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function _w(c,d,v,y,E,x,N,z,U){return c=new Wz(c,d,v,z,U),d===1?(d=1,x===!0&&(d|=8)):d=0,x=hi(3,null,null,d),c.current=x,x.stateNode=c,x.memoizedState={element:y,isDehydrated:v,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wb(x),c}function qz(c,d,v){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:k,key:y==null?null:""+y,children:c,containerInfo:d,implementation:v}}function i1(c){if(!c)return la;c=c._reactInternals;e:{if(Ac(c)!==c||c.tag!==1)throw Error(t(170));var d=c;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(hr(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(c.tag===1){var v=c.type;if(hr(v))return MT(c,v,d)}return d}function s1(c,d,v,y,E,x,N,z,U){return c=_w(v,y,!0,c,E,x,N,z,U),c.context=i1(null),v=c.current,y=er(),E=va(v),x=Xs(y,E),x.callback=d??null,ha(v,x,E),c.current.lanes=E,Yh(c,E,y),gr(c,y),c}function sC(c,d,v,y){var E=d.current,x=er(),N=va(E);return v=i1(v),d.context===null?d.context=v:d.pendingContext=v,d=Xs(x,N),d.payload={element:c},y=y===void 0?null:y,y!==null&&(d.callback=y),c=ha(E,d,N),c!==null&&(ji(c,E,N,x),LS(c,E,N)),N}function oC(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function o1(c,d){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var v=c.retryLane;c.retryLane=v!==0&&v<d?v:d}}function kw(c,d){o1(c,d),(c=c.alternate)&&o1(c,d)}function Vz(){return null}var a1=typeof reportError=="function"?reportError:function(c){console.error(c)};function Mw(c){this._internalRoot=c}aC.prototype.render=Mw.prototype.render=function(c){var d=this._internalRoot;if(d===null)throw Error(t(409));sC(c,d,null,null)},aC.prototype.unmount=Mw.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var d=c.containerInfo;Mc(function(){sC(null,c,null,null)}),d[Vs]=null}};function aC(c){this._internalRoot=c}aC.prototype.unstable_scheduleHydration=function(c){if(c){var d=qP();c={blockedOn:null,target:c,priority:d};for(var v=0;v<ia.length&&d!==0&&d<ia[v].priority;v++);ia.splice(v,0,c),v===0&&KP(c)}};function Dw(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function cC(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function c1(){}function Gz(c,d,v,y,E){if(E){if(typeof y=="function"){var x=y;y=function(){var Z=oC(N);x.call(Z)}}var N=s1(d,y,c,0,null,!1,!1,"",c1);return c._reactRootContainer=N,c[Vs]=N.current,dp(c.nodeType===8?c.parentNode:c),Mc(),N}for(;E=c.lastChild;)c.removeChild(E);if(typeof y=="function"){var z=y;y=function(){var Z=oC(U);z.call(Z)}}var U=_w(c,0,!1,null,null,!1,!1,"",c1);return c._reactRootContainer=U,c[Vs]=U.current,dp(c.nodeType===8?c.parentNode:c),Mc(function(){sC(d,U,v,y)}),U}function lC(c,d,v,y,E){var x=v._reactRootContainer;if(x){var N=x;if(typeof E=="function"){var z=E;E=function(){var U=oC(N);z.call(U)}}sC(d,N,c,E)}else N=Gz(v,d,c,E,y);return oC(N)}HP=function(c){switch(c.tag){case 3:var d=c.stateNode;if(d.current.memoizedState.isDehydrated){var v=Xh(d.pendingLanes);v!==0&&(rb(d,v|1),gr(d,Zt()),(ot&6)===0&&(Qu=Zt()+500,ua()))}break;case 13:Mc(function(){var y=Js(c,1);if(y!==null){var E=er();ji(y,c,1,E)}}),kw(c,1)}},ib=function(c){if(c.tag===13){var d=Js(c,134217728);if(d!==null){var v=er();ji(d,c,134217728,v)}kw(c,134217728)}},WP=function(c){if(c.tag===13){var d=va(c),v=Js(c,d);if(v!==null){var y=er();ji(v,c,d,y)}kw(c,d)}},qP=function(){return ht},VP=function(c,d){var v=ht;try{return ht=c,d()}finally{ht=v}},Gh=function(c,d,v){switch(d){case"input":if(st(c,v),d=v.name,v.type==="radio"&&d!=null){for(v=c;v.parentNode;)v=v.parentNode;for(v=v.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<v.length;d++){var y=v[d];if(y!==c&&y.form===c.form){var E=PS(y);if(!E)throw Error(t(90));Ke(y),st(y,E)}}}break;case"textarea":os(c,v);break;case"select":d=v.value,d!=null&&Tr(c,!!v.multiple,d,!1)}},IP=Ew,_P=Mc;var Kz={usingClientEntryPoint:!1,Events:[fp,Fu,PS,rS,xP,Ew]},xp={findFiberByHostInstance:Ec,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$z={bundleType:xp.bundleType,version:xp.version,rendererPackageName:xp.rendererPackageName,rendererConfig:xp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=NP(c),c===null?null:c.stateNode},findFiberByHostInstance:xp.findFiberByHostInstance||Vz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var uC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uC.isDisabled&&uC.supportsFiber)try{aS=uC.inject($z),us=uC}catch{}}return vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kz,vr.createPortal=function(c,d){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dw(d))throw Error(t(200));return qz(c,d,null,v)},vr.createRoot=function(c,d){if(!Dw(c))throw Error(t(299));var v=!1,y="",E=a1;return d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(y=d.identifierPrefix),d.onRecoverableError!==void 0&&(E=d.onRecoverableError)),d=_w(c,1,!1,null,null,v,!1,y,E),c[Vs]=d.current,dp(c.nodeType===8?c.parentNode:c),new Mw(d)},vr.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var d=c._reactInternals;if(d===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=NP(d),c=c===null?null:c.stateNode,c},vr.flushSync=function(c){return Mc(c)},vr.hydrate=function(c,d,v){if(!cC(d))throw Error(t(200));return lC(null,c,d,!0,v)},vr.hydrateRoot=function(c,d,v){if(!Dw(c))throw Error(t(405));var y=v!=null&&v.hydratedSources||null,E=!1,x="",N=a1;if(v!=null&&(v.unstable_strictMode===!0&&(E=!0),v.identifierPrefix!==void 0&&(x=v.identifierPrefix),v.onRecoverableError!==void 0&&(N=v.onRecoverableError)),d=s1(d,null,c,1,v??null,E,!1,x,N),c[Vs]=d.current,dp(c),y)for(c=0;c<y.length;c++)v=y[c],E=v._getVersion,E=E(v._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[v,E]:d.mutableSourceEagerHydrationData.push(v,E);return new aC(d)},vr.render=function(c,d,v){if(!cC(d))throw Error(t(200));return lC(null,c,d,!1,v)},vr.unmountComponentAtNode=function(c){if(!cC(c))throw Error(t(40));return c._reactRootContainer?(Mc(function(){lC(null,null,c,!1,function(){c._reactRootContainer=null,c[Vs]=null})}),!0):!1},vr.unstable_batchedUpdates=Ew,vr.unstable_renderSubtreeIntoContainer=function(c,d,v,y){if(!cC(v))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return lC(c,d,v,!1,y)},vr.version="18.3.1-next-f1338f8080-20240426",vr}var m1;function oF(){if(m1)return jw.exports;m1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),jw.exports=sF(),jw.exports}var y1;function aF(){if(y1)return dC;y1=1;var n=oF();return dC.createRoot=n.createRoot,dC.hydrateRoot=n.hydrateRoot,dC}var cF=aF();const lF=RN(cF),S1="azure-tts-settings",eP="azure-tts-api-keys",PN="azure-voice-live-settings",hC={apiKey:"",region:"eastus",selectedVoice:"en-US-JennyNeural",voiceLiveEndpoint:"",voiceLiveApiKey:""};function uF(){try{const n=localStorage.getItem(PN);if(n)return JSON.parse(n)}catch(n){console.error("Failed to load Voice Live settings from localStorage:",n)}return{endpoint:"",apiKey:""}}function dF(n,e){try{localStorage.setItem(PN,JSON.stringify({endpoint:n,apiKey:e}))}catch(t){console.error("Failed to save Voice Live settings to localStorage:",t)}}function _p(){try{const n=localStorage.getItem(eP);if(n)return JSON.parse(n)}catch(n){console.error("Failed to load API keys from localStorage:",n)}return{}}function C1(n){try{localStorage.setItem(eP,JSON.stringify(n))}catch(e){console.error("Failed to save API keys to localStorage:",e)}}function hF(){const[n,e]=W.useState(()=>{try{const o=localStorage.getItem(S1),a=_p(),l=uF();console.log("=== LOADING SETTINGS ===");const u={};if(Object.keys(a).forEach(p=>{const f=a[p];u[p]=f.length>8?`${f.substring(0,4)}...${f.substring(f.length-4)}`:"****"}),console.log("Stored API keys by region:",u),o){const p=JSON.parse(o),f=p.region||hC.region,g=a[f]||p.apiKey||"",m=g.length>8?`${g.substring(0,4)}...${g.substring(g.length-4)}`:"****";return console.log("Loading settings for region:",f),console.log("Loaded API key:",m),console.log("========================"),{...hC,...p,apiKey:g,voiceLiveEndpoint:l.endpoint,voiceLiveApiKey:l.apiKey}}return{...hC,voiceLiveEndpoint:l.endpoint,voiceLiveApiKey:l.apiKey}}catch(o){console.error("Failed to load settings from localStorage:",o)}return hC});W.useEffect(()=>{try{const o=n.apiKey.length>8?`${n.apiKey.substring(0,4)}...${n.apiKey.substring(n.apiKey.length-4)}`:"****";console.log("=== SAVING SETTINGS (useEffect) ==="),console.log("Region:",n.region),console.log("API Key being saved:",o),console.log("This key will be saved FOR region:",n.region),console.log("===================================");const{apiKey:a,voiceLiveEndpoint:l,voiceLiveApiKey:u,...p}=n;if(localStorage.setItem(S1,JSON.stringify(p)),a){const f=_p();f[n.region]=a,C1(f),console.log(` API key ${o} saved for region: ${n.region}`)}(l||u)&&dF(l||"",u||"")}catch(o){console.error("Failed to save settings to localStorage:",o)}},[n]);const t=o=>{console.log("=== UPDATE SETTINGS CALLED ==="),console.trace("Called from:"),e(a=>{const l=a.apiKey.length>8?`${a.apiKey.substring(0,4)}...${a.apiKey.substring(a.apiKey.length-4)}`:"****";console.log("Previous settings:",{region:a.region,apiKey:l});const u={...o};if(o.apiKey){const f=o.apiKey;u.apiKey=f.length>8?`${f.substring(0,4)}...${f.substring(f.length-4)}`:"****"}console.log("Partial update:",u);const p={...a,...o};if(o.region&&o.region!==a.region&&!o.apiKey){const g=_p()[o.region]||"";p.apiKey=g;const m=a.apiKey.length>8?`${a.apiKey.substring(0,4)}...${a.apiKey.substring(a.apiKey.length-4)}`:"****",C=g.length>8?`${g.substring(0,4)}...${g.substring(g.length-4)}`:"****";console.log(` Region changed from "${a.region}" to "${o.region}"`),console.log(` Loading saved API key for "${o.region}": ${m}  ${C}`),g||console.warn(` No API key found for region "${o.region}" - you'll need to enter one`)}return console.log("New settings:",{region:p.region,apiKey:p.apiKey.length>8?`${p.apiKey.substring(0,4)}...${p.apiKey.substring(p.apiKey.length-4)}`:"****"}),console.log("=============================="),p})},r=n.apiKey.length>0&&n.region.length>0,i=o=>{const a=_p();delete a[o],C1(a),console.log(` Cleared API key for region: ${o}`),console.log("Remaining keys:",a)},s=()=>{localStorage.removeItem(eP),console.log(" Cleared all API keys from localStorage")};return typeof window<"u"&&(window.debugSettings={clearRegionKey:i,clearAllKeys:s,viewKeys:()=>{console.log("Current API keys in localStorage:",_p())}}),{settings:n,updateSettings:t,isConfigured:r}}function pF(){const[n,e]=W.useState([]),t=W.useCallback(s=>{const o={...s,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(a=>[...a,o])},[]),r=W.useCallback(s=>{e(o=>o.filter(a=>a.id!==s))},[]),i=W.useCallback(()=>{e([])},[]);return{history:n,addToHistory:t,removeFromHistory:r,clearHistory:i}}function fF(){const[n,e]=W.useState([]),t=W.useCallback(s=>{const o={...s,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(a=>[...a,o])},[]),r=W.useCallback(s=>{e(o=>o.filter(a=>a.id!==s))},[]),i=W.useCallback(()=>{e([])},[]);return{history:n,addToHistory:t,removeFromHistory:r,clearHistory:i}}function gF(){const[n,e]=W.useState([]),t=W.useCallback(s=>{const o={...s,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(a=>[...a,o])},[]),r=W.useCallback(s=>{e(o=>o.filter(a=>a.id!==s))},[]),i=W.useCallback(()=>{e([])},[]);return{history:n,addToHistory:t,removeFromHistory:r,clearHistory:i}}const vF="2026-01-19T08:20:43.271Z",b1="478f8d8",mF=[{value:"brazilsouth",label:"Brazil South"},{value:"canadacentral",label:"Canada Central"},{value:"canadaeast",label:"Canada East"},{value:"centralus",label:"Central US"},{value:"eastus",label:"East US"},{value:"eastus2",label:"East US 2"},{value:"northcentralus",label:"North Central US"},{value:"southcentralus",label:"South Central US"},{value:"westcentralus",label:"West Central US"},{value:"westus",label:"West US"},{value:"westus2",label:"West US 2"},{value:"westus3",label:"West US 3"},{value:"francecentral",label:"France Central"},{value:"germanywestcentral",label:"Germany West Central"},{value:"italynorth",label:"Italy North"},{value:"northeurope",label:"North Europe"},{value:"norwayeast",label:"Norway East"},{value:"swedencentral",label:"Sweden Central"},{value:"switzerlandnorth",label:"Switzerland North"},{value:"switzerlandwest",label:"Switzerland West"},{value:"uksouth",label:"UK South"},{value:"ukwest",label:"UK West"},{value:"westeurope",label:"West Europe"},{value:"australiaeast",label:"Australia East"},{value:"centralindia",label:"Central India"},{value:"eastasia",label:"East Asia"},{value:"japaneast",label:"Japan East"},{value:"japanwest",label:"Japan West"},{value:"koreacentral",label:"Korea Central"},{value:"southeastasia",label:"Southeast Asia"},{value:"qatarcentral",label:"Qatar Central"},{value:"southafricanorth",label:"South Africa North"},{value:"uaenorth",label:"UAE North"}],yF=[{mode:"text-to-speech",label:"Text to Speech",category:"content",icon:A.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})},{mode:"multi-talker",label:"Podcast Generator",category:"content",icon:A.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})},{mode:"voice-changer",label:"Voice Changer",category:"content",icon:A.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},{mode:"voice-live-chat",label:"Voice Live Chat",category:"agent",icon:A.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})},{mode:"voice-live-translator",label:"Voice Live Translator",category:"agent",icon:A.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})})}];function SF({activeMode:n,onModeChange:e,settings:t,onSettingsChange:r}){const[i,s]=W.useState(!1),o=yF,a=n==="voice-live-chat"||n==="voice-live-translator";return A.jsxs("div",{className:`h-full bg-gray-900 text-white flex flex-col flex-shrink-0 transition-all duration-300 ${i?"w-16":"w-56"}`,children:[A.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[!i&&A.jsxs("div",{children:[A.jsx("h1",{className:"text-lg font-bold text-white",children:"Azure Voice"}),A.jsx("p",{className:"text-xs text-gray-400",children:"Playground"})]}),A.jsx("button",{onClick:()=>s(!i),className:`p-1.5 rounded-lg hover:bg-gray-800 transition-colors ${i?"mx-auto":""}`,title:i?"Expand sidebar":"Collapse sidebar",children:A.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform duration-300 ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})})]}),A.jsxs("div",{className:"p-3",children:[!i&&A.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-2 px-2",children:"Content Generation"}),A.jsx("nav",{className:"space-y-1",children:o.filter(l=>l.category==="content").map(({mode:l,label:u,icon:p})=>A.jsxs("button",{onClick:()=>e(l),title:i?u:void 0,className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${n===l?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"} ${i?"justify-center":""}`,children:[p,!i&&A.jsx("span",{children:u})]},l))})]}),A.jsxs("div",{className:"p-3 pt-0",children:[!i&&A.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-2 px-2",children:"Voice Agent"}),A.jsx("nav",{className:"space-y-1",children:o.filter(l=>l.category==="agent").map(({mode:l,label:u,icon:p})=>A.jsxs("button",{onClick:()=>e(l),title:i?u:void 0,className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${n===l?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"} ${i?"justify-center":""}`,children:[p,!i&&A.jsx("span",{children:u})]},l))})]}),A.jsx("div",{className:"border-t border-gray-700 mx-3 my-2"}),A.jsx("div",{className:`flex-1 overflow-y-auto p-3 ${i?"hidden":""}`,children:a?A.jsxs(A.Fragment,{children:[A.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-3 px-2",children:"Voice Live Config"}),A.jsxs("div",{className:"space-y-2 px-2 mb-4",children:[A.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"Endpoint"}),A.jsx("input",{type:"text",value:t.voiceLiveEndpoint||"",onChange:l=>{const u=l.target.value;r({voiceLiveEndpoint:u})},placeholder:"https://{resource}.cognitiveservices.azure.com/",autoComplete:"off",className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),A.jsxs("div",{className:"space-y-2 px-2 mb-4",children:[A.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"API Key"}),A.jsx("input",{type:"password",value:t.voiceLiveApiKey||"",onChange:l=>{const u=l.target.value;r({voiceLiveApiKey:u})},placeholder:"Enter API key",autoComplete:"new-password","data-lpignore":"true","data-form-type":"other",className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),A.jsx("a",{href:"https://ai.azure.com",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-400 hover:text-blue-300 underline",children:"Get credentials from Azure AI Foundry"})]}),A.jsxs("div",{className:"mt-4 p-3 bg-yellow-900/30 border border-yellow-700/50 rounded-md",children:[A.jsx("h3",{className:"text-xs font-semibold text-yellow-400 mb-1",children:"Security Notice"}),A.jsx("p",{className:"text-xs text-yellow-200/70",children:"Your credentials are stored in browser localStorage. Never share your key or use on untrusted devices."})]}),A.jsxs("div",{className:"mt-4 p-3 bg-blue-900/30 border border-blue-700/50 rounded-md",children:[A.jsx("h3",{className:"text-xs font-semibold text-blue-400 mb-2",children:"Getting Started"}),A.jsxs("ol",{className:"text-xs text-blue-200/70 space-y-1 list-decimal list-inside",children:[A.jsx("li",{children:A.jsx("a",{href:"https://ai.azure.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"Get credentials from Azure AI Foundry"})}),A.jsx("li",{children:"Enter Endpoint and API Key"}),A.jsx("li",{children:"Select Model and Target Language"}),A.jsx("li",{children:"Click Start to begin"})]})]})]}):A.jsxs(A.Fragment,{children:[A.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-3 px-2",children:"Azure Speech Config"}),A.jsxs("div",{className:"space-y-2 px-2 mb-4",children:[A.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"API Key"}),A.jsx("input",{type:"password",value:t.apiKey,onChange:l=>{const u=l.target.value;u!==t.apiKey&&r({apiKey:u})},placeholder:"Enter API key",autoComplete:"new-password","data-lpignore":"true","data-form-type":"other",className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),A.jsx("a",{href:"https://portal.azure.com/#view/Microsoft_Azure_ProjectOxford/CognitiveServicesHub/~/SpeechServices",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-400 hover:text-blue-300 underline",children:"Get API key"})]}),A.jsxs("div",{className:"space-y-2 px-2",children:[A.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"Region"}),A.jsx("select",{value:t.region,onChange:l=>r({region:l.target.value}),className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:mF.map(l=>A.jsx("option",{value:l.value,children:l.label},l.value))})]}),A.jsxs("div",{className:"mt-6 p-3 bg-yellow-900/30 border border-yellow-700/50 rounded-md",children:[A.jsx("h3",{className:"text-xs font-semibold text-yellow-400 mb-1",children:"Security Notice"}),A.jsx("p",{className:"text-xs text-yellow-200/70",children:"Your API key is stored in browser localStorage. Never share your key or use on untrusted devices."})]}),A.jsxs("div",{className:"mt-4 p-3 bg-blue-900/30 border border-blue-700/50 rounded-md",children:[A.jsx("h3",{className:"text-xs font-semibold text-blue-400 mb-2",children:"Getting Started"}),A.jsxs("ol",{className:"text-xs text-blue-200/70 space-y-1 list-decimal list-inside",children:[A.jsx("li",{children:A.jsx("a",{href:"https://portal.azure.com/#view/Microsoft_Azure_ProjectOxford/CognitiveServicesHub/~/SpeechServices",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"Get API key from Azure"})}),A.jsx("li",{children:"Select your Azure region"}),A.jsx("li",{children:"Choose a voice"}),A.jsx("li",{children:"Enter text and click Play"})]})]})]})}),i&&A.jsx("div",{className:"flex-1 flex flex-col items-center pt-2",children:A.jsx("div",{className:"p-2 text-gray-500",title:"Expand to configure Azure settings",children:A.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})}),A.jsx("div",{className:"p-3 border-t border-gray-700",children:!i&&A.jsxs("div",{className:"text-xs text-gray-500 text-center space-y-1",children:[A.jsx("p",{children:"API key stored locally"}),A.jsxs("p",{className:"text-gray-600",children:["Build: ",A.jsx("a",{href:`https://github.com/szhaomsft/AzureVoicePlayground/commit/${b1}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:b1})]}),A.jsx("p",{className:"text-gray-600",children:new Date(vF).toLocaleString()})]})})]})}var Lc={},jc={},kp={},zc={},Bt={},Bw={},Fc={},Uw={},Mp={},pC={},w1;function TN(){if(w1)return pC;w1=1,Object.defineProperty(pC,"__esModule",{value:!0}),pC.default=t;let n;const e=new Uint8Array(16);function t(){if(!n&&(n=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(e)}return pC}var ed={},Dp={},Np={},A1;function CF(){if(A1)return Np;A1=1,Object.defineProperty(Np,"__esModule",{value:!0}),Np.default=void 0;var n=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;return Np.default=n,Np}var E1;function F0(){if(E1)return Dp;E1=1,Object.defineProperty(Dp,"__esModule",{value:!0}),Dp.default=void 0;var n=e(CF());function e(i){return i&&i.__esModule?i:{default:i}}function t(i){return typeof i=="string"&&n.default.test(i)}var r=t;return Dp.default=r,Dp}var R1;function B0(){if(R1)return ed;R1=1,Object.defineProperty(ed,"__esModule",{value:!0}),ed.default=void 0,ed.unsafeStringify=r;var n=e(F0());function e(o){return o&&o.__esModule?o:{default:o}}const t=[];for(let o=0;o<256;++o)t.push((o+256).toString(16).slice(1));function r(o,a=0){return t[o[a+0]]+t[o[a+1]]+t[o[a+2]]+t[o[a+3]]+"-"+t[o[a+4]]+t[o[a+5]]+"-"+t[o[a+6]]+t[o[a+7]]+"-"+t[o[a+8]]+t[o[a+9]]+"-"+t[o[a+10]]+t[o[a+11]]+t[o[a+12]]+t[o[a+13]]+t[o[a+14]]+t[o[a+15]]}function i(o,a=0){const l=r(o,a);if(!(0,n.default)(l))throw TypeError("Stringified UUID is invalid");return l}var s=i;return ed.default=s,ed}var P1;function bF(){if(P1)return Mp;P1=1,Object.defineProperty(Mp,"__esModule",{value:!0}),Mp.default=void 0;var n=t(TN()),e=B0();function t(u){return u&&u.__esModule?u:{default:u}}let r,i,s=0,o=0;function a(u,p,f){let g=p&&f||0;const m=p||new Array(16);u=u||{};let C=u.node||r,S=u.clockseq!==void 0?u.clockseq:i;if(C==null||S==null){const M=u.random||(u.rng||n.default)();C==null&&(C=r=[M[0]|1,M[1],M[2],M[3],M[4],M[5]]),S==null&&(S=i=(M[6]<<8|M[7])&16383)}let w=u.msecs!==void 0?u.msecs:Date.now(),b=u.nsecs!==void 0?u.nsecs:o+1;const R=w-s+(b-o)/1e4;if(R<0&&u.clockseq===void 0&&(S=S+1&16383),(R<0||w>s)&&u.nsecs===void 0&&(b=0),b>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=w,o=b,i=S,w+=122192928e5;const P=((w&268435455)*1e4+b)%4294967296;m[g++]=P>>>24&255,m[g++]=P>>>16&255,m[g++]=P>>>8&255,m[g++]=P&255;const I=w/4294967296*1e4&268435455;m[g++]=I>>>8&255,m[g++]=I&255,m[g++]=I>>>24&15|16,m[g++]=I>>>16&255,m[g++]=S>>>8|128,m[g++]=S&255;for(let M=0;M<6;++M)m[g+M]=C[M];return p||(0,e.unsafeStringify)(m)}var l=a;return Mp.default=l,Mp}var Op={},Ca={},Lp={},T1;function xN(){if(T1)return Lp;T1=1,Object.defineProperty(Lp,"__esModule",{value:!0}),Lp.default=void 0;var n=e(F0());function e(i){return i&&i.__esModule?i:{default:i}}function t(i){if(!(0,n.default)(i))throw TypeError("Invalid UUID");let s;const o=new Uint8Array(16);return o[0]=(s=parseInt(i.slice(0,8),16))>>>24,o[1]=s>>>16&255,o[2]=s>>>8&255,o[3]=s&255,o[4]=(s=parseInt(i.slice(9,13),16))>>>8,o[5]=s&255,o[6]=(s=parseInt(i.slice(14,18),16))>>>8,o[7]=s&255,o[8]=(s=parseInt(i.slice(19,23),16))>>>8,o[9]=s&255,o[10]=(s=parseInt(i.slice(24,36),16))/1099511627776&255,o[11]=s/4294967296&255,o[12]=s>>>24&255,o[13]=s>>>16&255,o[14]=s>>>8&255,o[15]=s&255,o}var r=t;return Lp.default=r,Lp}var x1;function IN(){if(x1)return Ca;x1=1,Object.defineProperty(Ca,"__esModule",{value:!0}),Ca.URL=Ca.DNS=void 0,Ca.default=o;var n=B0(),e=t(xN());function t(a){return a&&a.__esModule?a:{default:a}}function r(a){a=unescape(encodeURIComponent(a));const l=[];for(let u=0;u<a.length;++u)l.push(a.charCodeAt(u));return l}const i="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Ca.DNS=i;const s="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Ca.URL=s;function o(a,l,u){function p(f,g,m,C){var S;if(typeof f=="string"&&(f=r(f)),typeof g=="string"&&(g=(0,e.default)(g)),((S=g)===null||S===void 0?void 0:S.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let w=new Uint8Array(16+f.length);if(w.set(g),w.set(f,g.length),w=u(w),w[6]=w[6]&15|l,w[8]=w[8]&63|128,m){C=C||0;for(let b=0;b<16;++b)m[C+b]=w[b];return m}return(0,n.unsafeStringify)(w)}try{p.name=a}catch{}return p.DNS=i,p.URL=s,p}return Ca}var jp={},I1;function wF(){if(I1)return jp;I1=1,Object.defineProperty(jp,"__esModule",{value:!0}),jp.default=void 0;function n(m){if(typeof m=="string"){const C=unescape(encodeURIComponent(m));m=new Uint8Array(C.length);for(let S=0;S<C.length;++S)m[S]=C.charCodeAt(S)}return e(r(i(m),m.length*8))}function e(m){const C=[],S=m.length*32,w="0123456789abcdef";for(let b=0;b<S;b+=8){const R=m[b>>5]>>>b%32&255,P=parseInt(w.charAt(R>>>4&15)+w.charAt(R&15),16);C.push(P)}return C}function t(m){return(m+64>>>9<<4)+14+1}function r(m,C){m[C>>5]|=128<<C%32,m[t(C)-1]=C;let S=1732584193,w=-271733879,b=-1732584194,R=271733878;for(let P=0;P<m.length;P+=16){const I=S,M=w,k=b,O=R;S=l(S,w,b,R,m[P],7,-680876936),R=l(R,S,w,b,m[P+1],12,-389564586),b=l(b,R,S,w,m[P+2],17,606105819),w=l(w,b,R,S,m[P+3],22,-1044525330),S=l(S,w,b,R,m[P+4],7,-176418897),R=l(R,S,w,b,m[P+5],12,1200080426),b=l(b,R,S,w,m[P+6],17,-1473231341),w=l(w,b,R,S,m[P+7],22,-45705983),S=l(S,w,b,R,m[P+8],7,1770035416),R=l(R,S,w,b,m[P+9],12,-1958414417),b=l(b,R,S,w,m[P+10],17,-42063),w=l(w,b,R,S,m[P+11],22,-1990404162),S=l(S,w,b,R,m[P+12],7,1804603682),R=l(R,S,w,b,m[P+13],12,-40341101),b=l(b,R,S,w,m[P+14],17,-1502002290),w=l(w,b,R,S,m[P+15],22,1236535329),S=u(S,w,b,R,m[P+1],5,-165796510),R=u(R,S,w,b,m[P+6],9,-1069501632),b=u(b,R,S,w,m[P+11],14,643717713),w=u(w,b,R,S,m[P],20,-373897302),S=u(S,w,b,R,m[P+5],5,-701558691),R=u(R,S,w,b,m[P+10],9,38016083),b=u(b,R,S,w,m[P+15],14,-660478335),w=u(w,b,R,S,m[P+4],20,-405537848),S=u(S,w,b,R,m[P+9],5,568446438),R=u(R,S,w,b,m[P+14],9,-1019803690),b=u(b,R,S,w,m[P+3],14,-187363961),w=u(w,b,R,S,m[P+8],20,1163531501),S=u(S,w,b,R,m[P+13],5,-1444681467),R=u(R,S,w,b,m[P+2],9,-51403784),b=u(b,R,S,w,m[P+7],14,1735328473),w=u(w,b,R,S,m[P+12],20,-1926607734),S=p(S,w,b,R,m[P+5],4,-378558),R=p(R,S,w,b,m[P+8],11,-2022574463),b=p(b,R,S,w,m[P+11],16,1839030562),w=p(w,b,R,S,m[P+14],23,-35309556),S=p(S,w,b,R,m[P+1],4,-1530992060),R=p(R,S,w,b,m[P+4],11,1272893353),b=p(b,R,S,w,m[P+7],16,-155497632),w=p(w,b,R,S,m[P+10],23,-1094730640),S=p(S,w,b,R,m[P+13],4,681279174),R=p(R,S,w,b,m[P],11,-358537222),b=p(b,R,S,w,m[P+3],16,-722521979),w=p(w,b,R,S,m[P+6],23,76029189),S=p(S,w,b,R,m[P+9],4,-640364487),R=p(R,S,w,b,m[P+12],11,-421815835),b=p(b,R,S,w,m[P+15],16,530742520),w=p(w,b,R,S,m[P+2],23,-995338651),S=f(S,w,b,R,m[P],6,-198630844),R=f(R,S,w,b,m[P+7],10,1126891415),b=f(b,R,S,w,m[P+14],15,-1416354905),w=f(w,b,R,S,m[P+5],21,-57434055),S=f(S,w,b,R,m[P+12],6,1700485571),R=f(R,S,w,b,m[P+3],10,-1894986606),b=f(b,R,S,w,m[P+10],15,-1051523),w=f(w,b,R,S,m[P+1],21,-2054922799),S=f(S,w,b,R,m[P+8],6,1873313359),R=f(R,S,w,b,m[P+15],10,-30611744),b=f(b,R,S,w,m[P+6],15,-1560198380),w=f(w,b,R,S,m[P+13],21,1309151649),S=f(S,w,b,R,m[P+4],6,-145523070),R=f(R,S,w,b,m[P+11],10,-1120210379),b=f(b,R,S,w,m[P+2],15,718787259),w=f(w,b,R,S,m[P+9],21,-343485551),S=s(S,I),w=s(w,M),b=s(b,k),R=s(R,O)}return[S,w,b,R]}function i(m){if(m.length===0)return[];const C=m.length*8,S=new Uint32Array(t(C));for(let w=0;w<C;w+=8)S[w>>5]|=(m[w/8]&255)<<w%32;return S}function s(m,C){const S=(m&65535)+(C&65535);return(m>>16)+(C>>16)+(S>>16)<<16|S&65535}function o(m,C){return m<<C|m>>>32-C}function a(m,C,S,w,b,R){return s(o(s(s(C,m),s(w,R)),b),S)}function l(m,C,S,w,b,R,P){return a(C&S|~C&w,m,C,b,R,P)}function u(m,C,S,w,b,R,P){return a(C&w|S&~w,m,C,b,R,P)}function p(m,C,S,w,b,R,P){return a(C^S^w,m,C,b,R,P)}function f(m,C,S,w,b,R,P){return a(S^(C|~w),m,C,b,R,P)}var g=n;return jp.default=g,jp}var _1;function AF(){if(_1)return Op;_1=1,Object.defineProperty(Op,"__esModule",{value:!0}),Op.default=void 0;var n=t(IN()),e=t(wF());function t(s){return s&&s.__esModule?s:{default:s}}var i=(0,n.default)("v3",48,e.default);return Op.default=i,Op}var zp={},Fp={},k1;function EF(){if(k1)return Fp;k1=1,Object.defineProperty(Fp,"__esModule",{value:!0}),Fp.default=void 0;var e={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};return Fp.default=e,Fp}var M1;function RF(){if(M1)return zp;M1=1,Object.defineProperty(zp,"__esModule",{value:!0}),zp.default=void 0;var n=r(EF()),e=r(TN()),t=B0();function r(o){return o&&o.__esModule?o:{default:o}}function i(o,a,l){if(n.default.randomUUID&&!a&&!o)return n.default.randomUUID();o=o||{};const u=o.random||(o.rng||e.default)();if(u[6]=u[6]&15|64,u[8]=u[8]&63|128,a){l=l||0;for(let p=0;p<16;++p)a[l+p]=u[p];return a}return(0,t.unsafeStringify)(u)}var s=i;return zp.default=s,zp}var Bp={},Up={},D1;function PF(){if(D1)return Up;D1=1,Object.defineProperty(Up,"__esModule",{value:!0}),Up.default=void 0;function n(i,s,o,a){switch(i){case 0:return s&o^~s&a;case 1:return s^o^a;case 2:return s&o^s&a^o&a;case 3:return s^o^a}}function e(i,s){return i<<s|i>>>32-s}function t(i){const s=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof i=="string"){const p=unescape(encodeURIComponent(i));i=[];for(let f=0;f<p.length;++f)i.push(p.charCodeAt(f))}else Array.isArray(i)||(i=Array.prototype.slice.call(i));i.push(128);const a=i.length/4+2,l=Math.ceil(a/16),u=new Array(l);for(let p=0;p<l;++p){const f=new Uint32Array(16);for(let g=0;g<16;++g)f[g]=i[p*64+g*4]<<24|i[p*64+g*4+1]<<16|i[p*64+g*4+2]<<8|i[p*64+g*4+3];u[p]=f}u[l-1][14]=(i.length-1)*8/Math.pow(2,32),u[l-1][14]=Math.floor(u[l-1][14]),u[l-1][15]=(i.length-1)*8&4294967295;for(let p=0;p<l;++p){const f=new Uint32Array(80);for(let b=0;b<16;++b)f[b]=u[p][b];for(let b=16;b<80;++b)f[b]=e(f[b-3]^f[b-8]^f[b-14]^f[b-16],1);let g=o[0],m=o[1],C=o[2],S=o[3],w=o[4];for(let b=0;b<80;++b){const R=Math.floor(b/20),P=e(g,5)+n(R,m,C,S)+w+s[R]+f[b]>>>0;w=S,S=C,C=e(m,30)>>>0,m=g,g=P}o[0]=o[0]+g>>>0,o[1]=o[1]+m>>>0,o[2]=o[2]+C>>>0,o[3]=o[3]+S>>>0,o[4]=o[4]+w>>>0}return[o[0]>>24&255,o[0]>>16&255,o[0]>>8&255,o[0]&255,o[1]>>24&255,o[1]>>16&255,o[1]>>8&255,o[1]&255,o[2]>>24&255,o[2]>>16&255,o[2]>>8&255,o[2]&255,o[3]>>24&255,o[3]>>16&255,o[3]>>8&255,o[3]&255,o[4]>>24&255,o[4]>>16&255,o[4]>>8&255,o[4]&255]}var r=t;return Up.default=r,Up}var N1;function TF(){if(N1)return Bp;N1=1,Object.defineProperty(Bp,"__esModule",{value:!0}),Bp.default=void 0;var n=t(IN()),e=t(PF());function t(s){return s&&s.__esModule?s:{default:s}}var i=(0,n.default)("v5",80,e.default);return Bp.default=i,Bp}var Hp={},O1;function xF(){if(O1)return Hp;O1=1,Object.defineProperty(Hp,"__esModule",{value:!0}),Hp.default=void 0;var n="00000000-0000-0000-0000-000000000000";return Hp.default=n,Hp}var Wp={},L1;function IF(){if(L1)return Wp;L1=1,Object.defineProperty(Wp,"__esModule",{value:!0}),Wp.default=void 0;var n=e(F0());function e(i){return i&&i.__esModule?i:{default:i}}function t(i){if(!(0,n.default)(i))throw TypeError("Invalid UUID");return parseInt(i.slice(14,15),16)}var r=t;return Wp.default=r,Wp}var j1;function _F(){return j1||(j1=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"NIL",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"parse",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"stringify",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"v1",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"v3",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"v4",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"validate",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"version",{enumerable:!0,get:function(){return o.default}});var e=p(bF()),t=p(AF()),r=p(RF()),i=p(TF()),s=p(xF()),o=p(IF()),a=p(F0()),l=p(B0()),u=p(xN());function p(f){return f&&f.__esModule?f:{default:f}}})(Uw)),Uw}var z1;function Pu(){if(z1)return Fc;z1=1,Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.createNoDashGuid=Fc.createGuid=void 0;const n=_F(),e=()=>(0,n.v4)();Fc.createGuid=e;const t=()=>e().replace(new RegExp("-","g"),"").toUpperCase();return Fc.createNoDashGuid=t,Fc}var F1;function Vy(){return F1||(F1=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.PlatformEvent=n.EventType=void 0;const e=Pu();(function(r){r[r.Debug=0]="Debug",r[r.Info=1]="Info",r[r.Warning=2]="Warning",r[r.Error=3]="Error",r[r.None=4]="None"})(n.EventType||(n.EventType={}));class t{constructor(i,s){this.privName=i,this.privEventId=(0,e.createNoDashGuid)(),this.privEventTime=new Date().toISOString(),this.privEventType=s,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}n.PlatformEvent=t})(Bw)),Bw}var B1;function kF(){if(B1)return Bt;B1=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.AudioStreamNodeErrorEvent=Bt.AudioStreamNodeDetachedEvent=Bt.AudioStreamNodeAttachedEvent=Bt.AudioStreamNodeAttachingEvent=Bt.AudioStreamNodeEvent=Bt.AudioSourceErrorEvent=Bt.AudioSourceOffEvent=Bt.AudioSourceReadyEvent=Bt.AudioSourceInitializingEvent=Bt.AudioSourceEvent=void 0;const n=Vy();class e extends n.PlatformEvent{constructor(g,m,C=n.EventType.Info){super(g,C),this.privAudioSourceId=m}get audioSourceId(){return this.privAudioSourceId}}Bt.AudioSourceEvent=e;class t extends e{constructor(g){super("AudioSourceInitializingEvent",g)}}Bt.AudioSourceInitializingEvent=t;class r extends e{constructor(g){super("AudioSourceReadyEvent",g)}}Bt.AudioSourceReadyEvent=r;class i extends e{constructor(g){super("AudioSourceOffEvent",g)}}Bt.AudioSourceOffEvent=i;class s extends e{constructor(g,m){super("AudioSourceErrorEvent",g,n.EventType.Error),this.privError=m}get error(){return this.privError}}Bt.AudioSourceErrorEvent=s;class o extends e{constructor(g,m,C){super(g,m),this.privAudioNodeId=C}get audioNodeId(){return this.privAudioNodeId}}Bt.AudioStreamNodeEvent=o;class a extends o{constructor(g,m){super("AudioStreamNodeAttachingEvent",g,m)}}Bt.AudioStreamNodeAttachingEvent=a;class l extends o{constructor(g,m){super("AudioStreamNodeAttachedEvent",g,m)}}Bt.AudioStreamNodeAttachedEvent=l;class u extends o{constructor(g,m){super("AudioStreamNodeDetachedEvent",g,m)}}Bt.AudioStreamNodeDetachedEvent=u;class p extends o{constructor(g,m,C){super("AudioStreamNodeErrorEvent",g,m),this.privError=C}get error(){return this.privError}}return Bt.AudioStreamNodeErrorEvent=p,Bt}var Ut={},U1;function MF(){if(U1)return Ut;U1=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.ConnectionRedirectEvent=Ut.ConnectionMessageSentEvent=Ut.ConnectionMessageReceivedEvent=Ut.ConnectionEstablishErrorEvent=Ut.ConnectionErrorEvent=Ut.ConnectionClosedEvent=Ut.ConnectionEstablishedEvent=Ut.ConnectionStartEvent=Ut.ConnectionEvent=Ut.ServiceEvent=void 0;const n=Vy();class e extends n.PlatformEvent{constructor(g,m,C=n.EventType.Info){super(g,C),this.privJsonResult=m}get jsonString(){return this.privJsonResult}}Ut.ServiceEvent=e;class t extends n.PlatformEvent{constructor(g,m,C=n.EventType.Info){super(g,C),this.privConnectionId=m}get connectionId(){return this.privConnectionId}}Ut.ConnectionEvent=t;class r extends t{constructor(g,m,C){super("ConnectionStartEvent",g),this.privUri=m,this.privHeaders=C}get uri(){return this.privUri}get headers(){return this.privHeaders}}Ut.ConnectionStartEvent=r;class i extends t{constructor(g){super("ConnectionEstablishedEvent",g)}}Ut.ConnectionEstablishedEvent=i;class s extends t{constructor(g,m,C){super("ConnectionClosedEvent",g,n.EventType.Debug),this.privReason=C,this.privStatusCode=m}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}Ut.ConnectionClosedEvent=s;class o extends t{constructor(g,m,C){super("ConnectionErrorEvent",g,n.EventType.Debug),this.privMessage=m,this.privType=C}get message(){return this.privMessage}get type(){return this.privType}}Ut.ConnectionErrorEvent=o;class a extends t{constructor(g,m,C){super("ConnectionEstablishErrorEvent",g,n.EventType.Error),this.privStatusCode=m,this.privReason=C}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}Ut.ConnectionEstablishErrorEvent=a;class l extends t{constructor(g,m,C){super("ConnectionMessageReceivedEvent",g),this.privNetworkReceivedTime=m,this.privMessage=C}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}Ut.ConnectionMessageReceivedEvent=l;class u extends t{constructor(g,m,C){super("ConnectionMessageSentEvent",g),this.privNetworkSentTime=m,this.privMessage=C}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}Ut.ConnectionMessageSentEvent=u;class p extends t{constructor(g,m,C,S){super("ConnectionRedirectEvent",g,n.EventType.Info),this.privRedirectUrl=m,this.privOriginalUrl=C,this.privContext=S}get redirectUrl(){return this.privRedirectUrl}get originalUrl(){return this.privOriginalUrl}get context(){return this.privContext}}return Ut.ConnectionRedirectEvent=p,Ut}var Hw={},Zs={},H1;function Ws(){if(H1)return Zs;H1=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.ObjectDisposedError=Zs.InvalidOperationError=Zs.ArgumentNullError=void 0;class n extends Error{constructor(i){super(i),this.name="ArgumentNull",this.message=i}}Zs.ArgumentNullError=n;class e extends Error{constructor(i){super(i),this.name="InvalidOperation",this.message=i}}Zs.InvalidOperationError=e;class t extends Error{constructor(i,s){super(s),this.name=i+"ObjectDisposed",this.message=s}}return Zs.ObjectDisposedError=t,Zs}var W1;function _N(){return W1||(W1=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConnectionMessage=n.MessageType=void 0;const e=Ws(),t=Pu();var r;(function(s){s[s.Text=0]="Text",s[s.Binary=1]="Binary"})(r=n.MessageType||(n.MessageType={}));class i{constructor(o,a,l,u){if(this.privBody=null,o===r.Text&&a&&typeof a!="string")throw new e.InvalidOperationError("Payload must be a string");if(o===r.Binary&&a&&!(a instanceof ArrayBuffer))throw new e.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=o,this.privBody=a,this.privHeaders=l||{},this.privId=u||(0,t.createNoDashGuid)(),this.messageType){case r.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case r.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===r.Binary)throw new e.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===r.Text)throw new e.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}n.ConnectionMessage=i})(Hw)),Hw}var qp={},q1;function DF(){if(q1)return qp;q1=1,Object.defineProperty(qp,"__esModule",{value:!0}),qp.ConnectionOpenResponse=void 0;let n=class{constructor(t,r){this.privStatusCode=t,this.privReason=r}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};return qp.ConnectionOpenResponse=n,qp}var Vp={},V1;function NF(){if(V1)return Vp;V1=1,Object.defineProperty(Vp,"__esModule",{value:!0}),Vp.DeferralMap=void 0;let n=class{constructor(){this.privMap={}}add(t,r){this.privMap[t]=r}getId(t){return this.privMap[t]}complete(t,r){try{this.privMap[t].resolve(r)}catch(i){this.privMap[t].reject(i)}finally{this.privMap[t]=void 0}}};return Vp.DeferralMap=n,Vp}var Bc={},G1;function kN(){if(G1)return Bc;G1=1,Object.defineProperty(Bc,"__esModule",{value:!0}),Bc.SendingAgentContextMessageEvent=Bc.DialogEvent=void 0;const n=Vy();class e extends n.PlatformEvent{constructor(i,s=n.EventType.Info){super(i,s)}}Bc.DialogEvent=e;class t extends e{constructor(i){super("SendingAgentContextMessageEvent"),this.privAgentConfig=i}get agentConfig(){return this.privAgentConfig}}return Bc.SendingAgentContextMessageEvent=t,Bc}var Gp={},Kp={},K1;function MN(){if(K1)return Kp;K1=1,Object.defineProperty(Kp,"__esModule",{value:!0}),Kp.EventSource=void 0;const n=Ws(),e=Pu();let t=class{constructor(i){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=i}onEvent(i){if(this.isDisposed())throw new n.ObjectDisposedError("EventSource");if(this.metadata)for(const s in this.metadata)s&&i.metadata&&(i.metadata[s]||(i.metadata[s]=this.metadata[s]));for(const s in this.privEventListeners)s&&this.privEventListeners[s]&&this.privEventListeners[s](i)}attach(i){const s=(0,e.createNoDashGuid)();return this.privEventListeners[s]=i,{detach:()=>(delete this.privEventListeners[s],Promise.resolve())}}attachListener(i){return this.attach(s=>i.onEvent(s))}attachConsoleListener(i){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(s=>i.onEvent(s)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};return Kp.EventSource=t,Kp}var $1;function OF(){if($1)return Gp;$1=1,Object.defineProperty(Gp,"__esModule",{value:!0}),Gp.Events=void 0;const n=Ws(),e=MN();let t=class pE{static setEventSource(i){if(!i)throw new n.ArgumentNullError("eventSource");pE.privInstance=i}static get instance(){return pE.privInstance}};return Gp.Events=t,t.privInstance=new e.EventSource,Gp}var Ww={},J1;function LF(){return J1||(J1=1,Object.defineProperty(Ww,"__esModule",{value:!0})),Ww}var qw={},X1;function jF(){return X1||(X1=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConnectionState=void 0,(function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"})(n.ConnectionState||(n.ConnectionState={}))})(qw)),qw}var Vw={},Y1;function zF(){return Y1||(Y1=1,Object.defineProperty(Vw,"__esModule",{value:!0})),Vw}var Gw={},Q1;function FF(){return Q1||(Q1=1,Object.defineProperty(Gw,"__esModule",{value:!0})),Gw}var Kw={},Z1;function BF(){return Z1||(Z1=1,Object.defineProperty(Kw,"__esModule",{value:!0})),Kw}var $w={},eI;function UF(){return eI||(eI=1,Object.defineProperty($w,"__esModule",{value:!0})),$w}var Jw={},tI;function HF(){return tI||(tI=1,Object.defineProperty(Jw,"__esModule",{value:!0})),Jw}var Xw={},nI;function WF(){return nI||(nI=1,Object.defineProperty(Xw,"__esModule",{value:!0})),Xw}var Yw={},rI;function qF(){return rI||(rI=1,Object.defineProperty(Yw,"__esModule",{value:!0})),Yw}var Qw={},iI;function VF(){return iI||(iI=1,Object.defineProperty(Qw,"__esModule",{value:!0})),Qw}var $p={},sI;function DN(){if(sI)return $p;sI=1,Object.defineProperty($p,"__esModule",{value:!0}),$p.List=void 0;const n=Ws();let e=class el{constructor(r){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],r)for(const i of r)this.privList.push(i)}get(r){return this.throwIfDisposed(),this.privList[r]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(r){this.throwIfDisposed(),this.insertAt(this.privList.length,r)}insertAt(r,i){this.throwIfDisposed(),r===0?this.privList.unshift(i):r===this.privList.length?this.privList.push(i):this.privList.splice(r,0,i),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(r){return this.throwIfDisposed(),this.remove(r,1)[0]}remove(r,i){this.throwIfDisposed();const s=this.privList.splice(r,i);return this.triggerSubscriptions(this.privRemoveSubscriptions),s}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(r){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[i]=r,{detach:()=>(delete this.privAddSubscriptions[i],Promise.resolve())}}onRemoved(r){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[i]=r,{detach:()=>(delete this.privRemoveSubscriptions[i],Promise.resolve())}}onDisposed(r){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[i]=r,{detach:()=>(delete this.privDisposedSubscriptions[i],Promise.resolve())}}join(r){return this.throwIfDisposed(),this.privList.join(r)}toArray(){const r=Array();return this.privList.forEach(i=>{r.push(i)}),r}any(r){return this.throwIfDisposed(),r?this.where(r).length()>0:this.length()>0}all(r){return this.throwIfDisposed(),this.where(r).length()===this.length()}forEach(r){this.throwIfDisposed();for(let i=0;i<this.length();i++)r(this.privList[i],i)}select(r){this.throwIfDisposed();const i=[];for(let s=0;s<this.privList.length;s++)i.push(r(this.privList[s],s));return new el(i)}where(r){this.throwIfDisposed();const i=new el;for(let s=0;s<this.privList.length;s++)r(this.privList[s],s)&&i.add(this.privList[s]);return i}orderBy(r){this.throwIfDisposed();const s=this.toArray().sort(r);return new el(s)}orderByDesc(r){return this.throwIfDisposed(),this.orderBy((i,s)=>r(s,i))}clone(){return this.throwIfDisposed(),new el(this.toArray())}concat(r){return this.throwIfDisposed(),new el(this.privList.concat(r.toArray()))}concatArray(r){return this.throwIfDisposed(),new el(this.privList.concat(r))}isDisposed(){return this.privList==null}dispose(r){this.isDisposed()||(this.privDisposeReason=r,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new n.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(r){if(r)for(const i in r)i&&r[i]()}};return $p.List=e,$p}var Zw={},oI;function NN(){return oI||(oI=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.marshalPromiseToCallbacks=n.Sink=n.Deferred=n.PromiseResultEventSource=n.PromiseResult=n.PromiseState=void 0;var e;(function(a){a[a.None=0]="None",a[a.Resolved=1]="Resolved",a[a.Rejected=2]="Rejected"})(e=n.PromiseState||(n.PromiseState={}));class t{constructor(l){this.throwIfError=()=>{if(this.isError)throw this.error},l.on(u=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=u)},u=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=u)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}n.PromiseResult=t;class r{constructor(){this.setResult=l=>{this.privOnSetResult(l)},this.setError=l=>{this.privOnSetError(l)},this.on=(l,u)=>{this.privOnSetResult=l,this.privOnSetError=u}}}n.PromiseResultEventSource=r;class i{constructor(){this.resolve=l=>(this.privResolve(l),this),this.reject=l=>(this.privReject(l),this),this.privPromise=new Promise((l,u)=>{this.privResolve=l,this.privReject=u})}get promise(){return this.privPromise}}n.Deferred=i;class s{constructor(){this.privState=e.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new r,this.privPromiseResult=new t(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(l){if(this.privState!==e.None)throw new Error("'Cannot resolve a completed promise'");this.privState=e.Resolved,this.privPromiseResultEvents.setResult(l);for(let u=0;u<this.privSuccessHandlers.length;u++)this.executeSuccessCallback(l,this.privSuccessHandlers[u],this.privErrorHandlers[u]);this.detachHandlers()}reject(l){if(this.privState!==e.None)throw new Error("'Cannot reject a completed promise'");this.privState=e.Rejected,this.privPromiseResultEvents.setError(l);for(const u of this.privErrorHandlers)this.executeErrorCallback(l,u);this.detachHandlers()}on(l,u){l==null&&(l=()=>{}),this.privState===e.None?(this.privSuccessHandlers.push(l),this.privErrorHandlers.push(u)):(this.privState===e.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,l,u):this.privState===e.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,u),this.detachHandlers())}executeSuccessCallback(l,u,p){try{u(l)}catch(f){this.executeErrorCallback(`'Unhandled callback error: ${f}'`,p)}}executeErrorCallback(l,u){if(u)try{u(l)}catch(p){throw new Error(`'Unhandled callback error: ${p}. InnerError: ${l}'`)}else throw new Error(`'Unhandled error: ${l}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}}n.Sink=s;function o(a,l,u){a.then(p=>{try{l&&l(p)}catch(f){if(u)try{if(f instanceof Error){const g=f;u(g.name+": "+g.message)}else u(f)}catch{}}},p=>{if(u)try{if(p instanceof Error){const f=p;u(f.name+": "+f.message)}else u(p)}catch{}})}n.marshalPromiseToCallbacks=o})(Zw)),Zw}var Jp={},aI;function ON(){if(aI)return Jp;aI=1,Object.defineProperty(Jp,"__esModule",{value:!0}),Jp.Queue=void 0;const n=Ws(),e=DN(),t=NN();var r;(function(s){s[s.Dequeue=0]="Dequeue",s[s.Peek=1]="Peek"})(r||(r={}));let i=class{constructor(o){this.privPromiseStore=new e.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=o||new e.List,this.privDetachables=[],this.privSubscribers=new e.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(o){this.throwIfDispose(),this.enqueueFromPromise(new Promise(a=>a(o)))}enqueueFromPromise(o){this.throwIfDispose(),o.then(a=>{this.privList.add(a)},()=>{})}dequeue(){this.throwIfDispose();const o=new t.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:o,type:r.Dequeue}),this.drain()),o.promise}peek(){this.throwIfDispose();const o=new t.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:o,type:r.Peek}),this.drain()),o.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(o,a){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=a,this.privIsDisposing=!0;const l=this.privSubscribers;if(l){for(;l.length()>0;)l.removeFirst().deferral.resolve(void 0);this.privSubscribers===l&&(this.privSubscribers=l)}for(const u of this.privDetachables)await u.detach();if(this.privPromiseStore.length()>0&&o){const u=[];return this.privPromiseStore.toArray().forEach(p=>{u.push(p)}),Promise.all(u).finally(()=>{this.privSubscribers=null,this.privList.forEach(p=>{o(p)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}}async dispose(o){await this.drainAndDispose(null,o)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const o=this.privSubscribers,a=this.privList;if(o&&a){for(;a.length()>0&&o.length()>0&&!this.privIsDisposing;){const l=o.removeFirst();if(l.type===r.Peek)l.deferral.resolve(a.first());else{const u=a.removeFirst();l.deferral.resolve(u)}}this.privSubscribers===o&&(this.privSubscribers=o),this.privList===a&&(this.privList=a)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new n.InvalidOperationError(this.privDisposeReason):new n.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new n.InvalidOperationError("Queue disposing")}};return Jp.Queue=i,Jp}var Xp={},cI;function GF(){if(cI)return Xp;cI=1,Object.defineProperty(Xp,"__esModule",{value:!0}),Xp.RawWebsocketMessage=void 0;const n=_N(),e=Ws(),t=Pu();let r=class{constructor(s,o,a){if(this.privPayload=null,!o)throw new e.ArgumentNullError("payload");if(s===n.MessageType.Binary&&Object.getPrototypeOf(o).constructor.name!=="ArrayBuffer")throw new e.InvalidOperationError("Payload must be ArrayBuffer");if(s===n.MessageType.Text&&typeof o!="string")throw new e.InvalidOperationError("Payload must be a string");this.privMessageType=s,this.privPayload=o,this.privId=a||(0,t.createNoDashGuid)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===n.MessageType.Binary)throw new e.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===n.MessageType.Text)throw new e.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};return Xp.RawWebsocketMessage=r,Xp}var Yp={},lI;function KF(){if(lI)return Yp;lI=1,Object.defineProperty(Yp,"__esModule",{value:!0}),Yp.RiffPcmEncoder=void 0;let n=class{constructor(t,r){this.privActualSampleRate=t,this.privDesiredSampleRate=r}encode(t){const r=this.downSampleAudioFrame(t,this.privActualSampleRate,this.privDesiredSampleRate);if(!r)return null;const i=r.length*2,s=new ArrayBuffer(i),o=new DataView(s);return this.floatTo16BitPCM(o,0,r),s}setString(t,r,i){for(let s=0;s<i.length;s++)t.setUint8(r+s,i.charCodeAt(s))}floatTo16BitPCM(t,r,i){for(let s=0;s<i.length;s++,r+=2){const o=Math.max(-1,Math.min(1,i[s]));t.setInt16(r,o<0?o*32768:o*32767,!0)}}downSampleAudioFrame(t,r,i){if(!t)return null;if(i===r||i>r)return t;const s=r/i,o=Math.round(t.length/s),a=new Float32Array(o);let l=0,u=0;for(;u<o;){const p=Math.round((u+1)*s);let f=0,g=0;for(;l<p&&l<t.length;)f+=t[l++],g++;a[u++]=f/g}return a}};return Yp.RiffPcmEncoder=n,Yp}var Qp={},uI;function $F(){if(uI)return Qp;uI=1,Object.defineProperty(Qp,"__esModule",{value:!0}),Qp.Stream=void 0;const n=Ws(),e=Pu(),t=ON();let r=class{constructor(s){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=s||(0,e.createNoDashGuid)(),this.privReaderQueue=new t.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(s){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(s)}catch{}}read(){if(this.privIsReadEnded)throw new n.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async s=>((s===void 0||s.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),s))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new t.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new n.InvalidOperationError("Stream closed")}};return Qp.Stream=r,Qp}var eA={},dI;function tP(){return dI||(dI=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.TranslationStatus=void 0,(function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"})(n.TranslationStatus||(n.TranslationStatus={}))})(eA)),eA}var Zp={},hI;function JF(){if(hI)return Zp;hI=1,Object.defineProperty(Zp,"__esModule",{value:!0}),Zp.ChunkedArrayBufferStream=void 0;const n=Oe();let e=class extends n.Stream{constructor(r,i){super(i),this.privTargetChunkSize=Math.round(r),this.privNextBufferReadyBytes=0}writeStreamChunk(r){if(r.isEnd||this.privNextBufferReadyBytes===0&&r.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(r);return}let i=0;for(;i<r.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=r.timeReceived);const s=Math.min(r.buffer.byteLength-i,this.privTargetChunkSize-this.privNextBufferReadyBytes),o=new Uint8Array(this.privNextBufferToWrite),a=new Uint8Array(r.buffer.slice(i,s+i));o.set(a,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=s,i+=s,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};return Zp.ChunkedArrayBufferStream=e,Zp}var tA={},pI;function XF(){return pI||(pI=1,Object.defineProperty(tA,"__esModule",{value:!0})),tA}var ef={},fI;function YF(){if(fI)return ef;fI=1,Object.defineProperty(ef,"__esModule",{value:!0}),ef.Timeout=void 0;let n=class ba{static load(){const t=new Map([[0,()=>{}]]),r=new Map,s="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),o=new Worker(s);return o.addEventListener("message",({data:u})=>{if(ba.isCallNotification(u)){const{params:{timerId:p}}=u,f=t.get(p);if(typeof f=="number"){const g=r.get(f);if(g===void 0||g!==p)throw new Error("The timer is in an undefined state.")}else if(typeof f<"u")f(),t.delete(p);else throw new Error("The timer is in an undefined state.")}else if(ba.isClearResponse(u)){const{id:p}=u,f=r.get(p);if(f===void 0)throw new Error("The timer is in an undefined state.");r.delete(p),t.delete(f)}else{const{error:{message:p}}=u;throw new Error(p)}}),{clearTimeout:u=>{const p=Math.random();r.set(p,u),t.set(u,p),o.postMessage({id:p,method:"clear",params:{timerId:u}})},setTimeout:(u,p)=>{const f=Math.random();return t.set(f,u),o.postMessage({id:null,method:"set",params:{delay:p,now:performance.now(),timerId:f}}),f}}}static loadWorkerTimers(){return()=>(ba.workerTimers!==null||(ba.workerTimers=ba.load()),ba.workerTimers)}static isCallNotification(t){return t.method!==void 0&&t.method==="call"}static isClearResponse(t){return t.error===null&&typeof t.id=="number"}};return ef.Timeout=n,n.workerTimers=null,n.clearTimeout=e=>n.timers().clearTimeout(e),n.setTimeout=(e,t)=>n.timers().setTimeout(e,t),n.timers=n.loadWorkerTimers(),ef}var Qe={},gI;function QF(){if(gI)return Qe;gI=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.OCSPCacheUpdateErrorEvent=Qe.OCSPResponseRetrievedEvent=Qe.OCSPCacheFetchErrorEvent=Qe.OCSPVerificationFailedEvent=Qe.OCSPCacheHitEvent=Qe.OCSPCacheEntryNeedsRefreshEvent=Qe.OCSPCacheEntryExpiredEvent=Qe.OCSPWSUpgradeStartedEvent=Qe.OCSPStapleReceivedEvent=Qe.OCSPCacheUpdateCompleteEvent=Qe.OCSPDiskCacheStoreEvent=Qe.OCSPMemoryCacheStoreEvent=Qe.OCSPCacheUpdateNeededEvent=Qe.OCSPDiskCacheHitEvent=Qe.OCSPCacheMissEvent=Qe.OCSPMemoryCacheHitEvent=Qe.OCSPEvent=void 0;const n=Vy();class e extends n.PlatformEvent{constructor(P,I,M){super(P,I),this.privSignature=M}}Qe.OCSPEvent=e;class t extends e{constructor(P){super("OCSPMemoryCacheHitEvent",n.EventType.Debug,P)}}Qe.OCSPMemoryCacheHitEvent=t;class r extends e{constructor(P){super("OCSPCacheMissEvent",n.EventType.Debug,P)}}Qe.OCSPCacheMissEvent=r;class i extends e{constructor(P){super("OCSPDiskCacheHitEvent",n.EventType.Debug,P)}}Qe.OCSPDiskCacheHitEvent=i;class s extends e{constructor(P){super("OCSPCacheUpdateNeededEvent",n.EventType.Debug,P)}}Qe.OCSPCacheUpdateNeededEvent=s;class o extends e{constructor(P){super("OCSPMemoryCacheStoreEvent",n.EventType.Debug,P)}}Qe.OCSPMemoryCacheStoreEvent=o;class a extends e{constructor(P){super("OCSPDiskCacheStoreEvent",n.EventType.Debug,P)}}Qe.OCSPDiskCacheStoreEvent=a;class l extends e{constructor(P){super("OCSPCacheUpdateCompleteEvent",n.EventType.Debug,P)}}Qe.OCSPCacheUpdateCompleteEvent=l;class u extends e{constructor(){super("OCSPStapleReceivedEvent",n.EventType.Debug,"")}}Qe.OCSPStapleReceivedEvent=u;class p extends e{constructor(P){super("OCSPWSUpgradeStartedEvent",n.EventType.Debug,P)}}Qe.OCSPWSUpgradeStartedEvent=p;class f extends e{constructor(P,I){super("OCSPCacheEntryExpiredEvent",n.EventType.Debug,P),this.privExpireTime=I}}Qe.OCSPCacheEntryExpiredEvent=f;class g extends e{constructor(P,I,M){super("OCSPCacheEntryNeedsRefreshEvent",n.EventType.Debug,P),this.privExpireTime=M,this.privStartTime=I}}Qe.OCSPCacheEntryNeedsRefreshEvent=g;class m extends e{constructor(P,I,M){super("OCSPCacheHitEvent",n.EventType.Debug,P),this.privExpireTime=M,this.privExpireTimeString=new Date(M).toLocaleDateString(),this.privStartTime=I,this.privStartTimeString=new Date(I).toLocaleTimeString()}}Qe.OCSPCacheHitEvent=m;class C extends e{constructor(P,I){super("OCSPVerificationFailedEvent",n.EventType.Debug,P),this.privError=I}}Qe.OCSPVerificationFailedEvent=C;class S extends e{constructor(P,I){super("OCSPCacheFetchErrorEvent",n.EventType.Debug,P),this.privError=I}}Qe.OCSPCacheFetchErrorEvent=S;class w extends e{constructor(P){super("OCSPResponseRetrievedEvent",n.EventType.Debug,P)}}Qe.OCSPResponseRetrievedEvent=w;class b extends e{constructor(P,I){super("OCSPCacheUpdateErrorEvent",n.EventType.Debug,P),this.privError=I}}return Qe.OCSPCacheUpdateErrorEvent=b,Qe}var tf={},vI;function ZF(){if(vI)return tf;vI=1,Object.defineProperty(tf,"__esModule",{value:!0}),tf.BackgroundEvent=void 0;const n=Oe();class e extends n.PlatformEvent{constructor(r){super("BackgroundEvent",n.EventType.Error),this.privError=r}get error(){return this.privError}}return tf.BackgroundEvent=e,tf}var mI;function Oe(){return mI||(mI=1,(function(n){var e=zc&&zc.__createBinding||(Object.create?(function(i,s,o,a){a===void 0&&(a=o),Object.defineProperty(i,a,{enumerable:!0,get:function(){return s[o]}})}):(function(i,s,o,a){a===void 0&&(a=o),i[a]=s[o]})),t=zc&&zc.__exportStar||function(i,s){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,i,o)};Object.defineProperty(n,"__esModule",{value:!0}),n.TranslationStatus=void 0,t(kF(),n),t(MF(),n),t(_N(),n),t(DF(),n),t(NF(),n),t(kN(),n),t(Ws(),n),t(OF(),n),t(MN(),n),t(Pu(),n),t(LF(),n),t(jF(),n),t(zF(),n),t(FF(),n),t(BF(),n),t(UF(),n),t(HF(),n),t(WF(),n),t(qF(),n),t(VF(),n),t(DN(),n),t(Vy(),n),t(NN(),n),t(ON(),n),t(GF(),n),t(KF(),n),t($F(),n);var r=tP();Object.defineProperty(n,"TranslationStatus",{enumerable:!0,get:function(){return r.TranslationStatus}}),t(JF(),n),t(XF(),n),t(YF(),n),t(QF(),n),t(ZF(),n)})(zc)),zc}var nf={},yI;function si(){if(yI)return nf;yI=1,Object.defineProperty(nf,"__esModule",{value:!0}),nf.HeaderNames=void 0;let n=class{};return nf.HeaderNames=n,n.AuthKey="Ocp-Apim-Subscription-Key",n.Authorization="Authorization",n.SpIDAuthKey="Apim-Subscription-Id",n.ConnectionId="X-ConnectionId",n.ContentType="Content-Type",n.CustomCommandsAppId="X-CommandsAppId",n.Path="Path",n.RequestId="X-RequestId",n.RequestStreamId="X-StreamId",n.RequestTimestamp="X-Timestamp",nf}var rf={},SI;function nP(){if(SI)return rf;SI=1,Object.defineProperty(rf,"__esModule",{value:!0}),rf.AuthInfo=void 0;class n{constructor(t,r){this.privHeaderName=t,this.privToken=r}get headerName(){return this.privHeaderName}get token(){return this.privToken}}return rf.AuthInfo=n,rf}var CI;function eB(){if(CI)return kp;CI=1,Object.defineProperty(kp,"__esModule",{value:!0}),kp.CognitiveSubscriptionKeyAuthentication=void 0;const n=Oe(),e=si(),t=nP();let r=class{constructor(s){if(!s)throw new n.ArgumentNullError("subscriptionKey");this.privAuthInfo=new t.AuthInfo(e.HeaderNames.AuthKey,s)}fetch(s){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(s){return Promise.resolve(this.privAuthInfo)}};return kp.CognitiveSubscriptionKeyAuthentication=r,kp}var sf={},bI;function tB(){if(bI)return sf;bI=1,Object.defineProperty(sf,"__esModule",{value:!0}),sf.CognitiveTokenAuthentication=void 0;const n=Oe(),e=nP(),t=si();let r=class fE{constructor(s,o){if(!s)throw new n.ArgumentNullError("fetchCallback");if(!o)throw new n.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=s,this.privFetchOnExpiryCallback=o}fetch(s){return this.privFetchCallback(s).then(o=>new e.AuthInfo(t.HeaderNames.Authorization,o===void 0?void 0:fE.privTokenPrefix+o))}fetchOnExpiry(s){return this.privFetchOnExpiryCallback(s).then(o=>new e.AuthInfo(t.HeaderNames.Authorization,o===void 0?void 0:fE.privTokenPrefix+o))}};return sf.CognitiveTokenAuthentication=r,r.privTokenPrefix="Bearer ",sf}var nA={},wI;function nB(){return wI||(wI=1,Object.defineProperty(nA,"__esModule",{value:!0})),nA}var rA={},AI;function rB(){return AI||(AI=1,Object.defineProperty(rA,"__esModule",{value:!0})),rA}var iA={},EI;function rP(){return EI||(EI=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.RecognitionEndedEvent=n.RecognitionCompletionStatus=n.RecognitionStartedEvent=n.ConnectingToServiceEvent=n.ListeningStartedEvent=n.RecognitionTriggeredEvent=n.SpeechRecognitionEvent=void 0;const e=Oe();class t extends e.PlatformEvent{constructor(p,f,g,m=e.EventType.Info){super(p,m),this.privRequestId=f,this.privSessionId=g}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}n.SpeechRecognitionEvent=t;class r extends t{constructor(p,f,g,m){super("RecognitionTriggeredEvent",p,f),this.privAudioSourceId=g,this.privAudioNodeId=m}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}n.RecognitionTriggeredEvent=r;class i extends t{constructor(p,f,g,m){super("ListeningStartedEvent",p,f),this.privAudioSourceId=g,this.privAudioNodeId=m}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}n.ListeningStartedEvent=i;class s extends t{constructor(p,f,g){super("ConnectingToServiceEvent",p,g),this.privAuthFetchEventid=f}get authFetchEventid(){return this.privAuthFetchEventid}}n.ConnectingToServiceEvent=s;class o extends t{constructor(p,f,g,m,C){super("RecognitionStartedEvent",p,C),this.privAudioSourceId=f,this.privAudioNodeId=g,this.privAuthFetchEventId=m}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}n.RecognitionStartedEvent=o;var a;(function(u){u[u.Success=0]="Success",u[u.AudioSourceError=1]="AudioSourceError",u[u.AudioSourceTimeout=2]="AudioSourceTimeout",u[u.AuthTokenFetchError=3]="AuthTokenFetchError",u[u.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",u[u.UnAuthorized=5]="UnAuthorized",u[u.ConnectTimeout=6]="ConnectTimeout",u[u.ConnectError=7]="ConnectError",u[u.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",u[u.UnknownError=9]="UnknownError"})(a=n.RecognitionCompletionStatus||(n.RecognitionCompletionStatus={}));class l extends t{constructor(p,f,g,m,C,S,w,b){super("RecognitionEndedEvent",p,C,w===a.Success?e.EventType.Info:e.EventType.Error),this.privAudioSourceId=f,this.privAudioNodeId=g,this.privAuthFetchEventId=m,this.privStatus=w,this.privError=b,this.privServiceTag=S}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}}n.RecognitionEndedEvent=l})(iA)),iA}var of={},Uc={},zi={};const iB={},sB=Object.freeze(Object.defineProperty({__proto__:null,default:iB},Symbol.toStringTag,{value:"Module"})),il=Qz(sB);var sA={},RI;function LN(){return RI||(RI=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.LogLevel=void 0;const e=Oe();Object.defineProperty(n,"LogLevel",{enumerable:!0,get:function(){return e.EventType}})})(sA)),sA}var af={},PI;function et(){if(PI)return af;PI=1,Object.defineProperty(af,"__esModule",{value:!0}),af.Contracts=void 0;let n=class wa{static throwIfNullOrUndefined(t,r){if(t==null)throw new Error("throwIfNullOrUndefined:"+r)}static throwIfNull(t,r){if(t===null)throw new Error("throwIfNull:"+r)}static throwIfNullOrWhitespace(t,r){if(wa.throwIfNullOrUndefined(t,r),(""+t).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+r)}static throwIfNullOrTooLong(t,r,i){if(wa.throwIfNullOrUndefined(t,r),(""+t).length>i)throw new Error("throwIfNullOrTooLong:"+r+" (more than "+i.toString()+" characters)")}static throwIfNullOrTooShort(t,r,i){if(wa.throwIfNullOrUndefined(t,r),(""+t).length<i)throw new Error("throwIfNullOrTooShort:"+r+" (less than "+i.toString()+" characters)")}static throwIfDisposed(t){if(t)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(t,r){if(wa.throwIfNullOrUndefined(t,r),t.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+r);for(const i of t)wa.throwIfNullOrWhitespace(i,r)}static throwIfFileDoesNotExist(t,r){wa.throwIfNullOrWhitespace(t,r)}static throwIfNotUndefined(t,r){if(t!==void 0)throw new Error("throwIfNotUndefined:"+r)}static throwIfNumberOutOfRange(t,r,i,s){if(wa.throwIfNullOrUndefined(t,r),t<i||t>s)throw new Error("throwIfNumberOutOfRange:"+r+" (must be between "+i.toString()+" and "+s.toString()+")")}};return af.Contracts=n,af}var TI;function oB(){if(TI)return zi;TI=1;var n=zi&&zi.__createBinding||(Object.create?(function(a,l,u,p){p===void 0&&(p=u),Object.defineProperty(a,p,{enumerable:!0,get:function(){return l[u]}})}):(function(a,l,u,p){p===void 0&&(p=u),a[p]=l[u]})),e=zi&&zi.__setModuleDefault||(Object.create?(function(a,l){Object.defineProperty(a,"default",{enumerable:!0,value:l})}):function(a,l){a.default=l}),t=zi&&zi.__importStar||function(a){if(a&&a.__esModule)return a;var l={};if(a!=null)for(var u in a)u!=="default"&&Object.prototype.hasOwnProperty.call(a,u)&&n(l,a,u);return e(l,a),l};Object.defineProperty(zi,"__esModule",{value:!0}),zi.ConsoleLoggingListener=void 0;const r=t(il),i=LN(),s=et();let o=class{constructor(l=i.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=l}set logPath(l){s.Contracts.throwIfNullOrUndefined(r.openSync,`
File System access not available`),this.privLogPath=l}set enableConsoleOutput(l){this.privEnableConsoleOutput=l}onEvent(l){if(l.eventType>=this.privLogLevelFilter){const u=this.toString(l);if(this.logCallback&&this.logCallback(u),this.privLogPath&&r.writeFileSync(this.privLogPath,u+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(l.eventType){case i.LogLevel.Debug:console.debug(u);break;case i.LogLevel.Info:console.info(u);break;case i.LogLevel.Warning:console.warn(u);break;case i.LogLevel.Error:console.error(u);break;default:console.log(u);break}}}toString(l){const u=[`${l.eventTime}`,`${l.name}`],p=l;for(const f in p)if(f&&l.hasOwnProperty(f)&&f!=="eventTime"&&f!=="eventType"&&f!=="eventId"&&f!=="name"&&f!=="constructor"){const g=p[f];let m="<NULL>";g!=null&&(typeof g=="number"||typeof g=="string"?m=g.toString():m=JSON.stringify(g)),u.push(`${f}: ${m}`)}return u.join(" | ")}};return zi.ConsoleLoggingListener=o,zi}var oA={},xI;function aB(){return xI||(xI=1,Object.defineProperty(oA,"__esModule",{value:!0})),oA}var aA={},cA={},II;function Tu(){return II||(II=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.AudioStreamFormatImpl=n.AudioStreamFormat=n.AudioFormatTag=void 0;var e;(function(i){i[i.PCM=1]="PCM",i[i.MuLaw=2]="MuLaw",i[i.Siren=3]="Siren",i[i.MP3=4]="MP3",i[i.SILKSkype=5]="SILKSkype",i[i.OGG_OPUS=6]="OGG_OPUS",i[i.WEBM_OPUS=7]="WEBM_OPUS",i[i.ALaw=8]="ALaw",i[i.FLAC=9]="FLAC",i[i.OPUS=10]="OPUS",i[i.AMR_WB=11]="AMR_WB",i[i.G722=12]="G722"})(e=n.AudioFormatTag||(n.AudioFormatTag={}));class t{static getDefaultInputFormat(){return r.getDefaultInputFormat()}static getWaveFormat(s,o,a,l){return new r(s,o,a,l)}static getWaveFormatPCM(s,o,a){return new r(s,o,a)}}n.AudioStreamFormat=t;class r extends t{constructor(s=16e3,o=16,a=1,l=e.PCM){super();let u=!0;switch(l){case e.PCM:this.formatTag=1;break;case e.ALaw:this.formatTag=6;break;case e.MuLaw:this.formatTag=7;break;default:u=!1}if(this.bitsPerSample=o,this.samplesPerSec=s,this.channels=a,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),u){this.privHeader=new ArrayBuffer(44);const p=new DataView(this.privHeader);this.setString(p,0,"RIFF"),p.setUint32(4,0,!0),this.setString(p,8,"WAVEfmt "),p.setUint32(16,16,!0),p.setUint16(20,this.formatTag,!0),p.setUint16(22,this.channels,!0),p.setUint32(24,this.samplesPerSec,!0),p.setUint32(28,this.avgBytesPerSec,!0),p.setUint16(32,this.channels*(this.bitsPerSample/8),!0),p.setUint16(34,this.bitsPerSample,!0),this.setString(p,36,"data"),p.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new r}static getAudioContext(s){const o=window.AudioContext||window.webkitAudioContext||!1;if(o)return s!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new o({sampleRate:s}):new o;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(s,o,a){for(let l=0;l<a.length;l++)s.setUint8(o+l,a.charCodeAt(l))}}n.AudioStreamFormatImpl=r})(cA)),cA}var _I;function cB(){return _I||(_I=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.MicAudioSource=n.AudioWorkletSourceURLPropertyName=void 0;const e=ke(),t=Oe(),r=Tu();n.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";class i{constructor(o,a,l,u){this.privRecorder=o,this.deviceId=a,this.privStreams={},this.privOutputChunkSize=i.AUDIOFORMAT.avgBytesPerSec/10,this.privId=l||(0,t.createNoDashGuid)(),this.privEvents=new t.EventSource,this.privMediaStream=u||null,this.privIsClosing=!1}get format(){return Promise.resolve(i.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new t.Deferred;try{this.createAudioContext()}catch(l){if(l instanceof Error){const u=l;this.privInitializeDeferral.reject(u.name+": "+u.message)}else this.privInitializeDeferral.reject(l);return this.privInitializeDeferral.promise}const o=window.navigator;let a=o.getUserMedia||o.webkitGetUserMedia||o.mozGetUserMedia||o.msGetUserMedia;if(o.mediaDevices&&(a=(l,u,p)=>{o.mediaDevices.getUserMedia(l).then(u).catch(p)}),a){const l=()=>{this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new t.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):a({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},u=>{this.privMediaStream=u,this.onEvent(new t.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},u=>{const p=`Error occurred during microphone initialization: ${u}`;this.privInitializeDeferral.reject(p),this.onEvent(new t.AudioSourceErrorEvent(this.privId,p))})};this.privContext.state==="suspended"?this.privContext.resume().then(l).catch(u=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${u}`)}):l()}else{const l="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(l),this.onEvent(new t.AudioSourceErrorEvent(l,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(o){return this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,o)),this.listen(o).then(a=>(this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,o)),{detach:async()=>(a.readEnded(),delete this.privStreams[o],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,o)),this.turnOff()),id:()=>o,read:()=>a.read()}))}detach(o){o&&this.privStreams[o]&&(this.privStreams[o].close(),delete this.privStreams[o],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,o)))}async turnOff(){for(const o in this.privStreams)if(o){const a=this.privStreams[o];a&&a.close()}this.onEvent(new t.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(o=>({bitspersample:i.AUDIOFORMAT.bitsPerSample,channelcount:i.AUDIOFORMAT.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:o,samplerate:i.AUDIOFORMAT.samplesPerSec,type:e.type.Microphones}))}setProperty(o,a){if(o===n.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(a);else throw new Error("Property '"+o+"' is not supported on Microphone.")}getMicrophoneLabel(){const o="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(o);this.privMicrophoneLabel=o;const a=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(a===void 0)return Promise.resolve(this.privMicrophoneLabel);const l=new t.Deferred;return navigator.mediaDevices.enumerateDevices().then(u=>{for(const p of u)if(p.deviceId===a){this.privMicrophoneLabel=p.label;break}l.resolve(this.privMicrophoneLabel)},()=>l.resolve(this.privMicrophoneLabel)),l.promise}async listen(o){await this.turnOn();const a=new t.ChunkedArrayBufferStream(this.privOutputChunkSize,o);this.privStreams[o]=a;try{this.privRecorder.record(this.privContext,this.privMediaStream,a)}catch(u){throw this.onEvent(new t.AudioStreamNodeErrorEvent(this.privId,o,u)),u}return a}onEvent(o){this.privEvents.onEvent(o),t.Events.instance.onEvent(o)}createAudioContext(){this.privContext||(this.privContext=r.AudioStreamFormatImpl.getAudioContext(i.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let o=!1;"close"in this.privContext&&(o=!0),o?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}}n.MicAudioSource=i,i.AUDIOFORMAT=r.AudioStreamFormat.getDefaultInputFormat()})(aA)),aA}var cf={},kI;function lB(){if(kI)return cf;kI=1,Object.defineProperty(cf,"__esModule",{value:!0}),cf.FileAudioSource=void 0;const n=ke(),e=Oe(),t=Tu();let r=class{constructor(s,o,a){this.privStreams={},this.privHeaderEnd=44,this.privId=a||(0,e.createNoDashGuid)(),this.privEvents=new e.EventSource,this.privSource=s,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=s.name:this.privFilename=o||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const s=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new e.AudioSourceErrorEvent(s,"")),Promise.reject(s)}this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(s){this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,s));const o=await this.upload(s);return this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,s)),Promise.resolve({detach:async()=>{o.readEnded(),delete this.privStreams[s],this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,s)),await this.turnOff()},id:()=>s,read:()=>o.read()})}detach(s){s&&this.privStreams[s]&&(this.privStreams[s].close(),delete this.privStreams[s],this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,s)))}turnOff(){for(const s in this.privStreams)if(s){const o=this.privStreams[s];o&&!o.isClosed&&o.close()}return this.onEvent(new e.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(s=>Promise.resolve({bitspersample:s.bitsPerSample,channelcount:s.channels,connectivity:n.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:s.samplesPerSec,type:n.type.File}))}readHeader(){const o=this.privSource.slice(0,4296),a=new e.Deferred,l=u=>{const p=new DataView(u),f=b=>String.fromCharCode(p.getUint8(b),p.getUint8(b+1),p.getUint8(b+2),p.getUint8(b+3));if(f(0)!=="RIFF"){a.reject("Invalid WAV header in file, RIFF was not found");return}if(f(8)!=="WAVE"||f(12)!=="fmt "){a.reject("Invalid WAV header in file, WAVEfmt was not found");return}const g=p.getInt32(16,!0),m=p.getUint16(22,!0),C=p.getUint32(24,!0),S=p.getUint16(34,!0);let w=36+Math.max(g-16,0);for(;f(w)!=="data";w+=2)if(w>4288){a.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=w+8,a.resolve(t.AudioStreamFormat.getWaveFormatPCM(C,S,m))};if(typeof window<"u"&&typeof Blob<"u"&&o instanceof Blob){const u=new FileReader;u.onload=p=>{const f=p.target.result;l(f)},u.readAsArrayBuffer(o)}else{const u=o;l(u.buffer.slice(u.byteOffset,u.byteOffset+u.byteLength))}return a.promise}async upload(s){const o=a=>{const l=`Error occurred while processing '${this.privFilename}'. ${a}`;throw this.onEvent(new e.AudioStreamNodeErrorEvent(this.privId,s,l)),new Error(l)};try{await this.turnOn();const a=await this.privAudioFormatPromise,l=new e.ChunkedArrayBufferStream(a.avgBytesPerSec/10,s);this.privStreams[s]=l;const u=this.privSource.slice(this.privHeaderEnd),p=f=>{l.isClosed||(l.writeStreamChunk({buffer:f,isEnd:!1,timeReceived:Date.now()}),l.close())};if(typeof window<"u"&&typeof Blob<"u"&&u instanceof Blob){const f=new FileReader;f.onerror=g=>o(g.toString()),f.onload=g=>{const m=g.target.result;p(m)},f.readAsArrayBuffer(u)}else{const f=u;p(f.buffer.slice(f.byteOffset,f.byteOffset+f.byteLength))}return l}catch(a){o(a)}}onEvent(s){this.privEvents.onEvent(s),e.Events.instance.onEvent(s)}};return cf.FileAudioSource=r,cf}var lf={},MI;function uB(){if(MI)return lf;MI=1,Object.defineProperty(lf,"__esModule",{value:!0}),lf.PcmRecorder=void 0;const n=Oe();class e{constructor(r){this.privStopInputOnRelease=r}record(r,i,s){const a=new n.RiffPcmEncoder(r.sampleRate,16e3),l=r.createMediaStreamSource(i),u=()=>{const f=(()=>{let g=0;try{return r.createScriptProcessor(g,1,1)}catch{g=2048;let C=r.sampleRate;for(;g<16384&&C>=32e3;)g<<=1,C>>=1;return r.createScriptProcessor(g,1,1)}})();f.onaudioprocess=g=>{const m=g.inputBuffer.getChannelData(0);if(s&&!s.isClosed){const C=a.encode(m);C&&s.writeStreamChunk({buffer:C,isEnd:!1,timeReceived:Date.now()})}},l.connect(f),f.connect(r.destination),this.privMediaResources={scriptProcessorNode:f,source:l,stream:i}},p=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(r.audioWorklet&&!p){if(!this.privSpeechProcessorScript){const f=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,g=new Blob([f],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(g)}r.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const f=new AudioWorkletNode(r,"speech-processor");f.port.onmessage=g=>{const m=g.data;if(s&&!s.isClosed){const C=a.encode(m);C&&s.writeStreamChunk({buffer:C,isEnd:!1,timeReceived:Date.now()})}},l.connect(f),f.connect(r.destination),this.privMediaResources={scriptProcessorNode:f,source:l,stream:i}}).catch(()=>{u()})}else try{u()}catch(f){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${f}`)}}releaseMediaResources(r){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(r.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(i=>i.stop()),this.privMediaResources.source=null))}setWorkletUrl(r){this.privSpeechProcessorScript=r}}return lf.PcmRecorder=e,lf}var uf={},Mr={},DI;function jN(){if(DI)return Mr;DI=1;var n=Mr&&Mr.__createBinding||(Object.create?(function(g,m,C,S){S===void 0&&(S=C),Object.defineProperty(g,S,{enumerable:!0,get:function(){return m[C]}})}):(function(g,m,C,S){S===void 0&&(S=C),g[S]=m[C]})),e=Mr&&Mr.__setModuleDefault||(Object.create?(function(g,m){Object.defineProperty(g,"default",{enumerable:!0,value:m})}):function(g,m){g.default=m}),t=Mr&&Mr.__importStar||function(g){if(g&&g.__esModule)return g;var m={};if(g!=null)for(var C in g)C!=="default"&&Object.prototype.hasOwnProperty.call(g,C)&&n(m,g,C);return e(m,g),m},r=Mr&&Mr.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.WebsocketMessageAdapter=void 0;const i=t(il),s=t(il),o=r(il),a=r(il),l=r(il),u=si(),p=Oe();let f=class gE{constructor(m,C,S,w,b,R){if(!m)throw new p.ArgumentNullError("uri");if(!S)throw new p.ArgumentNullError("messageFormatter");this.proxyInfo=w,this.privConnectionEvents=new p.EventSource,this.privConnectionId=C,this.privMessageFormatter=S,this.privConnectionState=p.ConnectionState.None,this.privUri=m,this.privHeaders=b,this.privEnableCompression=R,this.privHeaders[u.HeaderNames.ConnectionId]=this.privConnectionId,this.privHeaders.connectionId=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===p.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new p.Deferred,this.privCertificateValidatedDeferral=new p.Deferred,this.privConnectionState=p.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!gE.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{let C=new URL(this.privUri).protocol;(C==null?void 0:C.toLocaleLowerCase())==="wss:"?C="https:":(C==null?void 0:C.toLocaleLowerCase())==="ws:"&&(C="http:");const S={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression,followRedirects:C.toLocaleLowerCase()==="https:"};this.privCertificateValidatedDeferral.resolve(),S.agent=this.getAgent(),S.agent.protocol=C,this.privWebsocketClient=new l.default(this.privUri,S),this.privWebsocketClient.on("redirect",w=>{const b=new p.ConnectionRedirectEvent(this.privConnectionId,w,this.privUri,`Getting redirect URL from endpoint ${this.privUri} with redirect URL '${w}'`);p.Events.instance.onEvent(b)})}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new p.Queue,this.privDisconnectDeferral=new p.Deferred,this.privSendMessageQueue=new p.Queue,this.processSendQueue().catch(m=>{p.Events.instance.onEvent(new p.BackgroundEvent(m))})}catch(m){return this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(500,m)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new p.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=p.ConnectionState.Connected,this.onEvent(new p.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(200,""))},m=>{this.privConnectionEstablishDeferral.reject(m)})},this.privWebsocketClient.onerror=m=>{this.onEvent(new p.ConnectionErrorEvent(this.privConnectionId,m.message,m.type)),this.privLastErrorReceived=m.message},this.privWebsocketClient.onclose=m=>{this.privConnectionState===p.ConnectionState.Connecting?(this.privConnectionState=p.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(m.code,m.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=p.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new p.ConnectionClosedEvent(this.privConnectionId,m.code,m.reason))),this.onClose(m.code,m.reason).catch(C=>{p.Events.instance.onEvent(new p.BackgroundEvent(C))})},this.privWebsocketClient.onmessage=m=>{const C=new Date().toISOString();if(this.privConnectionState===p.ConnectionState.Connected){const S=new p.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(S.promise),m.data instanceof ArrayBuffer){const w=new p.RawWebsocketMessage(p.MessageType.Binary,m.data);this.privMessageFormatter.toConnectionMessage(w).then(b=>{this.onEvent(new p.ConnectionMessageReceivedEvent(this.privConnectionId,C,b)),S.resolve(b)},b=>{S.reject(`Invalid binary message format. Error: ${b}`)})}else{const w=new p.RawWebsocketMessage(p.MessageType.Text,m.data);this.privMessageFormatter.toConnectionMessage(w).then(b=>{this.onEvent(new p.ConnectionMessageReceivedEvent(this.privConnectionId,C,b)),S.resolve(b)},b=>{S.reject(`Invalid text message format. Error: ${b}`)})}}},this.privConnectionEstablishDeferral.promise}send(m){if(this.privConnectionState!==p.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${p.ConnectionState[this.privConnectionState]} state`);const C=new p.Deferred,S=new p.Deferred;return this.privSendMessageQueue.enqueueFromPromise(S.promise),this.privMessageFormatter.fromConnectionMessage(m).then(w=>{S.resolve({Message:m,RawWebsocketMessage:w,sendStatusDeferral:C})},w=>{S.reject(`Error formatting the message. ${w}`)}),C.promise}read(){return this.privConnectionState!==p.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(m){if(this.privWebsocketClient)this.privConnectionState!==p.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,m||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(m){try{if(!m)return Promise.resolve();if(this.onEvent(new p.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),m.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(m.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+m.Message.id+" "+new Error().stack);return Promise.resolve()}catch(C){return Promise.reject(`websocket send error: ${C}`)}}async onClose(m,C){const S=`Connection closed. ${m}: ${C}`;this.privConnectionState=p.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},S),await this.privSendMessageQueue.drainAndDispose(w=>{w.sendStatusDeferral.reject(S)},S)}async processSendQueue(){for(;;){const C=await this.privSendMessageQueue.dequeue();if(!C)return;try{await this.sendRawMessage(C),C.sendStatusDeferral.resolve()}catch(S){C.sendStatusDeferral.reject(S)}}}onEvent(m){this.privConnectionEvents.onEvent(m),p.Events.instance.onEvent(m)}getAgent(){const m=new o.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(m.proxyInfo=this.proxyInfo),m}static GetProxyAgent(m){const C={host:m.HostName,port:m.Port};return m.UserName?C.headers={"Proxy-Authentication":"Basic "+Buffer.from(`${m.UserName}:${m.Password===void 0?"":m.Password}`).toString("base64")}:C.headers={},C.headers.requestOCSP="true",new a.default(C)}createConnection(m,C){let S;if(C={...C,requestOCSP:!0,servername:C.host},this.proxyInfo){const b=gE.GetProxyAgent(this.proxyInfo);S=new Promise((R,P)=>{b.callback(m,C,(I,M)=>{I?P(I):R(M)})})}else C.secureEndpoint?S=Promise.resolve(s.connect(C)):S=Promise.resolve(i.connect(C));return S}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};return Mr.WebsocketMessageAdapter=f,f.forceNpmWebSocket=!1,Mr}var NI;function dB(){if(NI)return uf;NI=1,Object.defineProperty(uf,"__esModule",{value:!0}),uf.WebsocketConnection=void 0;const n=Oe(),e=jN();let t=class{constructor(i,s,o,a,l,u=!1,p){if(this.privIsDisposed=!1,!i)throw new n.ArgumentNullError("uri");if(!a)throw new n.ArgumentNullError("messageFormatter");this.privMessageFormatter=a;let f="",g=0;if(s){for(const m in s)if(m){f+=g===0&&i.indexOf("?")===-1?"?":"&";const C=encodeURIComponent(m);f+=C;let S=s[m];S&&(S=encodeURIComponent(S),f+=`=${S}`),g++}}if(o){for(const m in o)if(m){f+=g===0&&i.indexOf("?")===-1?"?":"&";const C=encodeURIComponent(o[m]);f+=`${m}=${C}`,g++}}this.privUri=i+f,this.privId=p||(0,n.createNoDashGuid)(),this.privConnectionMessageAdapter=new e.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,l,o,u)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(i){return this.privConnectionMessageAdapter.send(i)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};return uf.WebsocketConnection=t,uf}var df={},OI;function hB(){if(OI)return df;OI=1,Object.defineProperty(df,"__esModule",{value:!0}),df.ReplayableAudioNode=void 0;let n=class{constructor(r,i){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=r,this.privBytesPerSecond=i}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){const r=this.privReplayOffset-this.privBufferStartOffset;let i=Math.round(r*this.privBytesPerSecond*1e-7);i%2!==0&&i++;let s=0;for(;s<this.privBuffers.length&&i>=this.privBuffers[s].chunk.buffer.byteLength;)i-=this.privBuffers[s++].chunk.buffer.byteLength;if(s<this.privBuffers.length){const o=this.privBuffers[s].chunk.buffer.slice(i);return this.privReplayOffset+=o.byteLength/this.privBytesPerSecond*1e7,s===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:o,isEnd:!1,timeReceived:this.privBuffers[s].chunk.timeReceived})}}return this.privAudioNode.read().then(r=>(r&&r.buffer&&this.privBuffers&&(this.privBuffers.push(new e(r,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=r.buffer.byteLength),r))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(r){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=r;const i=r-this.privBufferStartOffset;let s=Math.round(i*this.privBytesPerSecond*1e-7),o=0;for(;o<this.privBuffers.length&&s>=this.privBuffers[o].chunk.buffer.byteLength;)s-=this.privBuffers[o++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(r-s/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(o)}findTimeAtOffset(r){if(r<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const i of this.privBuffers){const s=i.byteOffset/this.privBytesPerSecond*1e7,o=s+i.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(r>=s&&r<=o)return i.chunk.timeReceived}return 0}};df.ReplayableAudioNode=n;class e{constructor(r,i,s){this.chunk=r,this.serial=i,this.byteOffset=s}}return df}var hf={},lA={},eo={},Fi={},LI;function zN(){if(LI)return Fi;LI=1;var n=Fi&&Fi.__createBinding||(Object.create?(function(o,a,l,u){u===void 0&&(u=l),Object.defineProperty(o,u,{enumerable:!0,get:function(){return a[l]}})}):(function(o,a,l,u){u===void 0&&(u=l),o[u]=a[l]})),e=Fi&&Fi.__setModuleDefault||(Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a}),t=Fi&&Fi.__importStar||function(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var l in o)l!=="default"&&Object.prototype.hasOwnProperty.call(o,l)&&n(a,o,l);return e(a,o),a};Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.AudioFileWriter=void 0;const r=t(il),i=et();let s=class{constructor(a){i.Contracts.throwIfNullOrUndefined(r.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=r.openSync(a,"w")}set format(a){i.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=a;let l=0;this.privAudioFormat.hasHeader&&(l=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=r.createWriteStream("",{fd:this.privFd,start:l,autoClose:!1}))}write(a){i.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(a.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),r.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),r.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};return Fi.AudioFileWriter=s,Fi}var Dr={},jI;function FN(){if(jI)return Dr;jI=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.PullAudioInputStreamImpl=Dr.PullAudioInputStream=Dr.PushAudioInputStreamImpl=Dr.PushAudioInputStream=Dr.AudioInputStream=void 0;const n=ke(),e=Oe(),t=Pu(),r=me(),i=Tu();let s=class{constructor(){}static createPushStream(f){return o.create(f)}static createPullStream(f,g){return l.create(f,g)}};Dr.AudioInputStream=s;class o extends s{static create(f){return new a(f)}}Dr.PushAudioInputStream=o;class a extends o{constructor(f){super(),f===void 0?this.privFormat=i.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=f,this.privEvents=new e.EventSource,this.privId=(0,t.createNoDashGuid)(),this.privStream=new e.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(f){this.privStream.writeStreamChunk({buffer:f,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}async attach(f){this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,f)),await this.turnOn();const g=this.privStream;return this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,f)),{detach:async()=>(this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,f)),this.turnOff()),id:()=>f,read:()=>g.read()}}detach(f){this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,f))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:n.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:n.type.Stream})}onEvent(f){this.privEvents.onEvent(f),e.Events.instance.onEvent(f)}toBuffer(f){const g=Buffer.alloc(f.byteLength),m=new Uint8Array(f);for(let C=0;C<g.length;++C)g[C]=m[C];return g}}Dr.PushAudioInputStreamImpl=a;class l extends s{constructor(){super()}static create(f,g){return new u(f,g)}}Dr.PullAudioInputStream=l;class u extends l{constructor(f,g){super(),g===void 0?this.privFormat=r.AudioStreamFormat.getDefaultInputFormat():this.privFormat=g,this.privEvents=new e.EventSource,this.privId=(0,t.createNoDashGuid)(),this.privCallback=f,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}async attach(f){return this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,f)),await this.turnOn(),this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,f)),{detach:()=>(this.privCallback.close(),this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,f)),this.turnOff()),id:()=>f,read:()=>{let g=0,m;for(;g<this.privBufferSize;){const C=new ArrayBuffer(this.privBufferSize-g),S=this.privCallback.read(C);if(m===void 0?m=C:new Int8Array(m).set(new Int8Array(C),g),S===0)break;g+=S}return Promise.resolve({buffer:m.slice(0,g),isEnd:this.privIsClosed||g===0,timeReceived:Date.now()})}}}detach(f){this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,f))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:n.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:n.type.Stream})}onEvent(f){this.privEvents.onEvent(f),e.Events.instance.onEvent(f)}}return Dr.PullAudioInputStreamImpl=u,Dr}var Nr={},pf={},uA={},zI;function BN(){return zI||(zI=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SpeechSynthesisOutputFormat=void 0,(function(e){e[e.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",e[e.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",e[e.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",e[e.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",e[e.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",e[e.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",e[e.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",e[e.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",e[e.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",e[e.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",e[e.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",e[e.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",e[e.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",e[e.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",e[e.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",e[e.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",e[e.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",e[e.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",e[e.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",e[e.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",e[e.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",e[e.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",e[e.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",e[e.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",e[e.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",e[e.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",e[e.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",e[e.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",e[e.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",e[e.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",e[e.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",e[e.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",e[e.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",e[e.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",e[e.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",e[e.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",e[e.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",e[e.AmrWb16000Hz=37]="AmrWb16000Hz",e[e.G72216Khz64Kbps=38]="G72216Khz64Kbps"})(n.SpeechSynthesisOutputFormat||(n.SpeechSynthesisOutputFormat={}))})(uA)),uA}var FI;function Gy(){if(FI)return pf;FI=1,Object.defineProperty(pf,"__esModule",{value:!0}),pf.AudioOutputFormatImpl=void 0;const n=BN(),e=Tu();class t extends e.AudioStreamFormatImpl{constructor(i,s,o,a,l,u,p,f,g){super(o,u,s,i),this.formatTag=i,this.avgBytesPerSec=a,this.blockAlign=l,this.priAudioFormatString=p,this.priRequestAudioFormatString=f,this.priHasHeader=g}static fromSpeechSynthesisOutputFormat(i){return i===void 0?t.getDefaultOutputFormat():t.fromSpeechSynthesisOutputFormatString(t.SpeechSynthesisOutputFormatToString[i])}static fromSpeechSynthesisOutputFormatString(i){switch(i){case"raw-8khz-8bit-mono-mulaw":return new t(e.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,i,i,!1);case"riff-16khz-16kbps-mono-siren":return new t(e.AudioFormatTag.Siren,1,16e3,2e3,40,0,i,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new t(e.AudioFormatTag.Siren,1,16e3,2e3,40,0,i,i,!1);case"audio-16khz-32kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,16e3,4096,2,16,i,i,!1);case"audio-16khz-128kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,16e3,16384,2,16,i,i,!1);case"audio-16khz-64kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,16e3,8192,2,16,i,i,!1);case"audio-24khz-48kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,24e3,6144,2,16,i,i,!1);case"audio-24khz-96kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,24e3,12288,2,16,i,i,!1);case"audio-24khz-160kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,24e3,20480,2,16,i,i,!1);case"raw-16khz-16bit-mono-truesilk":return new t(e.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,i,i,!1);case"riff-8khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,8e3,16e3,2,16,i,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,24e3,48e3,2,16,i,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new t(e.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,i,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,16e3,32e3,2,16,i,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,24e3,48e3,2,16,i,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,8e3,16e3,2,16,i,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new t(e.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,i,i,!1);case"ogg-24khz-16bit-mono-opus":return new t(e.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,i,i,!1);case"raw-48khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,48e3,96e3,2,16,i,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,48e3,96e3,2,16,i,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,48e3,12288,2,16,i,i,!1);case"audio-48khz-192kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,48e3,24576,2,16,i,i,!1);case"ogg-48khz-16bit-mono-opus":return new t(e.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,i,i,!1);case"webm-16khz-16bit-mono-opus":return new t(e.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,i,i,!1);case"webm-24khz-16bit-mono-opus":return new t(e.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,i,i,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new t(e.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,i,i,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new t(e.AudioFormatTag.OPUS,1,16e3,4e3,2,16,i,i,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new t(e.AudioFormatTag.OPUS,1,24e3,6e3,2,16,i,i,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new t(e.AudioFormatTag.OPUS,1,24e3,3e3,2,16,i,i,!1);case"audio-24khz-16bit-mono-flac":return new t(e.AudioFormatTag.FLAC,1,24e3,24e3,2,16,i,i,!1);case"audio-48khz-16bit-mono-flac":return new t(e.AudioFormatTag.FLAC,1,48e3,3e4,2,16,i,i,!1);case"raw-24khz-16bit-mono-truesilk":return new t(e.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,i,i,!1);case"raw-8khz-8bit-mono-alaw":return new t(e.AudioFormatTag.ALaw,1,8e3,8e3,1,8,i,i,!1);case"riff-8khz-8bit-mono-alaw":return new t(e.AudioFormatTag.ALaw,1,8e3,8e3,1,8,i,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,22050,44100,2,16,i,i,!1);case"riff-22050hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,22050,44100,2,16,i,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,44100,88200,2,16,i,i,!1);case"riff-44100hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,44100,88200,2,16,i,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new t(e.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,i,i,!1);case"g722-16khz-64kbps":return new t(e.AudioFormatTag.G722,1,16e3,8e3,2,16,i,i,!1);case"riff-16khz-16bit-mono-pcm":default:return new t(e.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return t.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(i){if(this.priHasHeader){const s=new DataView(this.privHeader);s.setUint32(4,i+this.privHeader.byteLength-8,!0),s.setUint32(40,i,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(i){if(!this.hasHeader)return i;this.updateHeader(i.byteLength);const s=new Uint8Array(i.byteLength+this.header.byteLength);return s.set(new Uint8Array(this.header),0),s.set(new Uint8Array(i),this.header.byteLength),s.buffer}}return pf.AudioOutputFormatImpl=t,t.SpeechSynthesisOutputFormatToString={[n.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[n.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[n.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[n.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[n.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[n.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[n.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[n.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[n.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[n.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[n.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[n.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[n.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[n.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[n.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[n.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[n.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[n.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[n.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"},pf}var BI;function Vh(){if(BI)return Nr;BI=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.PushAudioOutputStreamImpl=Nr.PushAudioOutputStream=Nr.PullAudioOutputStreamImpl=Nr.PullAudioOutputStream=Nr.AudioOutputStream=void 0;const n=Oe(),e=et(),t=Gy();let r=class{constructor(){}static createPullStream(){return i.create()}};Nr.AudioOutputStream=r;class i extends r{static create(){return new s}}Nr.PullAudioOutputStream=i;class s extends i{constructor(){super(),this.privId=(0,n.createNoDashGuid)(),this.privStream=new n.Stream}set format(u){u==null&&(this.privFormat=t.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=u}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(u){const p=new Int8Array(u);let f=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>u.byteLength)return p.set(this.privLastChunkView.slice(0,u.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(u.byteLength),Promise.resolve(u.byteLength);p.set(this.privLastChunkView),f=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;f<u.byteLength&&!this.privStream.isReadEnded;){const g=await this.privStream.read();if(g!==void 0&&!g.isEnd){let m;g.buffer.byteLength>u.byteLength-f?(m=g.buffer.slice(0,u.byteLength-f),this.privLastChunkView=new Int8Array(g.buffer.slice(u.byteLength-f))):m=g.buffer,p.set(new Int8Array(m),f),f+=m.byteLength}else this.privStream.readEnded()}return f}write(u){e.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:u,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}Nr.PullAudioOutputStreamImpl=s;class o extends r{constructor(){super()}static create(u){return new a(u)}}Nr.PushAudioOutputStream=o;class a extends o{constructor(u){super(),this.privId=(0,n.createNoDashGuid)(),this.privCallback=u}set format(u){}write(u){this.privCallback.write&&this.privCallback.write(u)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}return Nr.PushAudioOutputStreamImpl=a,Nr}var UI;function pB(){if(UI)return eo;UI=1,Object.defineProperty(eo,"__esModule",{value:!0}),eo.AudioOutputConfigImpl=eo.AudioConfigImpl=eo.AudioConfig=void 0;const n=Pr(),e=et(),t=me(),r=zN(),i=FN(),s=Vh();let o=class UN{static fromDefaultMicrophoneInput(){const p=new n.PcmRecorder(!0);return new a(new n.MicAudioSource(p))}static fromMicrophoneInput(p){const f=new n.PcmRecorder(!0);return new a(new n.MicAudioSource(f,p))}static fromWavFileInput(p,f="unnamedBuffer.wav"){return new a(new n.FileAudioSource(p,f))}static fromStreamInput(p){if(p instanceof t.PullAudioInputStreamCallback)return new a(new i.PullAudioInputStreamImpl(p));if(p instanceof t.AudioInputStream)return new a(p);if(typeof MediaStream<"u"&&p instanceof MediaStream){const f=new n.PcmRecorder(!1);return new a(new n.MicAudioSource(f,null,null,p))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new l(new t.SpeakerAudioDestination)}static fromSpeakerOutput(p){if(p===void 0)return UN.fromDefaultSpeakerOutput();if(p instanceof t.SpeakerAudioDestination)return new l(p);throw new Error("Not Supported Type")}static fromAudioFileOutput(p){return new l(new r.AudioFileWriter(p))}static fromStreamOutput(p){if(p instanceof t.PushAudioOutputStreamCallback)return new l(new s.PushAudioOutputStreamImpl(p));if(p instanceof t.PushAudioOutputStream)return new l(p);if(p instanceof t.PullAudioOutputStream)return new l(p);throw new Error("Not Supported Type")}};eo.AudioConfig=o;class a extends o{constructor(p){super(),this.privSource=p}get format(){return this.privSource.format}close(p,f){this.privSource.turnOff().then(()=>{p&&p()},g=>{f&&f(g)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(p){return this.privSource.attach(p)}detach(p){return this.privSource.detach(p)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(p,f){if(e.Contracts.throwIfNull(f,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(p,f);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(p,f){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(p,f);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}eo.AudioConfigImpl=a;class l extends o{constructor(p){super(),this.privDestination=p}set format(p){this.privDestination.format=p}write(p){this.privDestination.write(p)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}return eo.AudioOutputConfigImpl=l,eo}var dA={},HI;function fB(){return HI||(HI=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.CancellationReason=void 0,(function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"})(n.CancellationReason||(n.CancellationReason={}))})(dA)),dA}var ff={},WI;function gB(){if(WI)return ff;WI=1,Object.defineProperty(ff,"__esModule",{value:!0}),ff.PullAudioInputStreamCallback=void 0;let n=class{};return ff.PullAudioInputStreamCallback=n,ff}var gf={},qI;function vB(){if(qI)return gf;qI=1,Object.defineProperty(gf,"__esModule",{value:!0}),gf.PushAudioOutputStreamCallback=void 0;let n=class{};return gf.PushAudioOutputStreamCallback=n,gf}var vf={},VI;function mB(){if(VI)return vf;VI=1,Object.defineProperty(vf,"__esModule",{value:!0}),vf.KeywordRecognitionModel=void 0;const n=et();let e=class{constructor(){this.privDisposed=!1}static fromFile(r){throw n.Contracts.throwIfFileDoesNotExist(r,"fileName"),new Error("Not yet implemented.")}static fromStream(r){throw n.Contracts.throwIfNull(r,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};return vf.KeywordRecognitionModel=e,vf}var mf={},GI;function yB(){if(GI)return mf;GI=1,Object.defineProperty(mf,"__esModule",{value:!0}),mf.SessionEventArgs=void 0;let n=class{constructor(t){this.privSessionId=t}get sessionId(){return this.privSessionId}};return mf.SessionEventArgs=n,mf}var yf={},KI;function SB(){if(KI)return yf;KI=1,Object.defineProperty(yf,"__esModule",{value:!0}),yf.RecognitionEventArgs=void 0;const n=me();let e=class extends n.SessionEventArgs{constructor(r,i){super(i),this.privOffset=r}get offset(){return this.privOffset}};return yf.RecognitionEventArgs=e,yf}var hA={},$I;function CB(){return $I||($I=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.OutputFormat=void 0,(function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"})(n.OutputFormat||(n.OutputFormat={}))})(hA)),hA}var Sf={},JI;function bB(){if(JI)return Sf;JI=1,Object.defineProperty(Sf,"__esModule",{value:!0}),Sf.RecognitionResult=void 0;let n=class{constructor(t,r,i,s,o,a,l,u,p,f){this.privResultId=t,this.privReason=r,this.privText=i,this.privDuration=s,this.privOffset=o,this.privLanguage=a,this.privLanguageDetectionConfidence=l,this.privErrorDetails=u,this.privJson=p,this.privProperties=f}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};return Sf.RecognitionResult=n,Sf}var Cf={},XI;function wB(){if(XI)return Cf;XI=1,Object.defineProperty(Cf,"__esModule",{value:!0}),Cf.SpeechRecognitionResult=void 0;const n=me();let e=class extends n.RecognitionResult{constructor(r,i,s,o,a,l,u,p,f,g,m){super(r,i,s,o,a,l,u,f,g,m),this.privSpeakerId=p}get speakerId(){return this.privSpeakerId}};return Cf.SpeechRecognitionResult=e,Cf}var to={},YI;function AB(){if(YI)return to;YI=1,Object.defineProperty(to,"__esModule",{value:!0}),to.MeetingTranscriptionEventArgs=to.ConversationTranscriptionEventArgs=to.SpeechRecognitionEventArgs=void 0;const n=me();let e=class extends n.RecognitionEventArgs{constructor(s,o,a){super(o,a),this.privResult=s}get result(){return this.privResult}};to.SpeechRecognitionEventArgs=e;class t extends n.RecognitionEventArgs{constructor(s,o,a){super(o,a),this.privResult=s}get result(){return this.privResult}}to.ConversationTranscriptionEventArgs=t;class r extends e{}return to.MeetingTranscriptionEventArgs=r,to}var bf={},wf={},QI;function Ky(){if(QI)return wf;QI=1,Object.defineProperty(wf,"__esModule",{value:!0}),wf.CancellationEventArgsBase=void 0;const n=me();let e=class extends n.RecognitionEventArgs{constructor(r,i,s,o,a){super(o,a),this.privReason=r,this.privErrorDetails=i,this.privErrorCode=s}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return wf.CancellationEventArgsBase=e,wf}var ZI;function EB(){if(ZI)return bf;ZI=1,Object.defineProperty(bf,"__esModule",{value:!0}),bf.SpeechRecognitionCanceledEventArgs=void 0;const n=Ky();let e=class extends n.CancellationEventArgsBase{};return bf.SpeechRecognitionCanceledEventArgs=e,bf}var Af={},e_;function RB(){if(e_)return Af;e_=1,Object.defineProperty(Af,"__esModule",{value:!0}),Af.TranslationRecognitionEventArgs=void 0;const n=me();let e=class extends n.RecognitionEventArgs{constructor(r,i,s){super(i,s),this.privResult=r}get result(){return this.privResult}};return Af.TranslationRecognitionEventArgs=e,Af}var Ef={},t_;function PB(){if(t_)return Ef;t_=1,Object.defineProperty(Ef,"__esModule",{value:!0}),Ef.TranslationSynthesisEventArgs=void 0;const n=me();let e=class extends n.SessionEventArgs{constructor(r,i){super(i),this.privResult=r}get result(){return this.privResult}};return Ef.TranslationSynthesisEventArgs=e,Ef}var Rf={},n_;function WN(){if(n_)return Rf;n_=1,Object.defineProperty(Rf,"__esModule",{value:!0}),Rf.TranslationRecognitionResult=void 0;const n=me();let e=class HN extends n.SpeechRecognitionResult{constructor(r,i,s,o,a,l,u,p,f,g,m){super(i,s,o,a,l,u,p,void 0,f,g,m),this.privTranslations=r}static fromSpeechRecognitionResult(r){return new HN(void 0,r.resultId,r.reason,r.text,r.duration,r.offset,r.language,r.languageDetectionConfidence,r.errorDetails,r.json,r.properties)}get translations(){return this.privTranslations}};return Rf.TranslationRecognitionResult=e,Rf}var Pf={},r_;function TB(){if(r_)return Pf;r_=1,Object.defineProperty(Pf,"__esModule",{value:!0}),Pf.TranslationSynthesisResult=void 0;let n=class{constructor(t,r){this.privReason=t,this.privAudio=r}get audio(){return this.privAudio}get reason(){return this.privReason}};return Pf.TranslationSynthesisResult=n,Pf}var pA={},i_;function xB(){return i_||(i_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ResultReason=void 0,(function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizedKeyword=4]="RecognizedKeyword",e[e.TranslatingSpeech=5]="TranslatingSpeech",e[e.TranslatedSpeech=6]="TranslatedSpeech",e[e.SynthesizingAudio=7]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=8]="SynthesizingAudioCompleted",e[e.SynthesizingAudioStarted=9]="SynthesizingAudioStarted",e[e.VoicesListRetrieved=10]="VoicesListRetrieved",e[e.TranslatingParticipantSpeech=11]="TranslatingParticipantSpeech",e[e.TranslatedParticipantSpeech=12]="TranslatedParticipantSpeech",e[e.TranslatedInstantMessage=13]="TranslatedInstantMessage",e[e.TranslatedParticipantInstantMessage=14]="TranslatedParticipantInstantMessage"})(n.ResultReason||(n.ResultReason={}))})(pA)),pA}var Hc={},s_;function IB(){if(s_)return Hc;s_=1,Object.defineProperty(Hc,"__esModule",{value:!0}),Hc.SpeechConfigImpl=Hc.SpeechConfig=void 0;const n=ke(),e=et(),t=me();let r=class{constructor(){}static fromSubscription(o,a){e.Contracts.throwIfNullOrWhitespace(o,"subscriptionKey"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),l}static fromEndpoint(o,a){e.Contracts.throwIfNull(o,"endpoint");const l=typeof a=="string"&&a.trim().length>0,u=typeof a=="object"&&a!==null&&typeof a.getToken=="function",p=typeof a=="object"&&a!==null&&typeof a.key=="string";if(a!==void 0&&!l&&!u&&!p)throw new Error("Invalid 'auth' parameter: expected a non-empty API key string, a TokenCredential, or a KeyCredential.");let f;return typeof a=="string"?(f=new i,f.setProperty(t.PropertyId.SpeechServiceConnection_Key,a)):typeof a=="object"&&typeof a.getToken=="function"?f=new i(a):typeof a=="object"&&typeof a.key=="string"?(f=new i,f.setProperty(t.PropertyId.SpeechServiceConnection_Key,a.key)):f=new i,f.setProperty(t.PropertyId.SpeechServiceConnection_Endpoint,o.href),f}static fromHost(o,a){e.Contracts.throwIfNull(o,"hostName");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Host,o.protocol+"//"+o.hostname+(o.port===""?"":":"+o.port)),l.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),a!==void 0&&l.setProperty(t.PropertyId.SpeechServiceConnection_Key,a),l}static fromAuthorizationToken(o,a){e.Contracts.throwIfNull(o,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l.authorizationToken=o,l}close(){}};Hc.SpeechConfig=r;class i extends r{constructor(o){super(),this.privProperties=new t.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=t.OutputFormat.Simple,this.privTokenCredential=o}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o)}get speechRecognitionLanguage(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,o)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,o)}get outputFormat(){return t.OutputFormat[this.privProperties.getProperty(n.OutputFormatPropertyName,void 0)]}set outputFormat(o){this.privProperties.setProperty(n.OutputFormatPropertyName,t.OutputFormat[o])}get endpointId(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_EndpointId,o)}get tokenCredential(){return this.privTokenCredential}setProperty(o,a){e.Contracts.throwIfNull(a,"value"),this.privProperties.setProperty(o,a)}getProperty(o,a){return this.privProperties.getProperty(o,a)}setProxy(o,a,l,u){this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyHostName],o),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPort],a),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyUserName],l),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPassword],u)}setServiceProperty(o,a){const l=JSON.parse(this.privProperties.getProperty(n.ServicePropertiesPropertyName,"{}"));l[o]=a,this.privProperties.setProperty(n.ServicePropertiesPropertyName,JSON.stringify(l))}setProfanity(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceResponse_ProfanityOption,t.ProfanityOption[o])}enableAudioLogging(){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true"),this.privProperties.setProperty(n.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Detailed])}enableDictation(){this.privProperties.setProperty(n.ForceDictationPropertyName,"true")}clone(){const o=new i(this.tokenCredential);return o.privProperties=this.privProperties.clone(),o}get speechSynthesisLanguage(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage,o)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthVoice,o)}get speechSynthesisOutputFormat(){return t.SpeechSynthesisOutputFormat[this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,t.SpeechSynthesisOutputFormat[o])}}return Hc.SpeechConfigImpl=i,Hc}var Wc={},o_;function _B(){if(o_)return Wc;o_=1,Object.defineProperty(Wc,"__esModule",{value:!0}),Wc.SpeechTranslationConfigImpl=Wc.SpeechTranslationConfig=void 0;const n=ke(),e=et(),t=me();let r=class extends t.SpeechConfig{constructor(){super()}static fromSubscription(o,a){e.Contracts.throwIfNullOrWhitespace(o,"subscriptionKey"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.properties.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),l.properties.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}static fromAuthorizationToken(o,a){e.Contracts.throwIfNullOrWhitespace(o,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.properties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o),l.properties.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}static fromHost(o,a){e.Contracts.throwIfNull(o,"hostName");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Host,o.protocol+"//"+o.hostname+(o.port===""?"":":"+o.port)),a!==void 0&&l.setProperty(t.PropertyId.SpeechServiceConnection_Key,a),l}static fromEndpoint(o,a){e.Contracts.throwIfNull(o,"endpoint");const l=typeof a=="string"&&a.trim().length>0,u=typeof a=="object"&&a!==null&&typeof a.getToken=="function",p=typeof a=="object"&&a!==null&&typeof a.key=="string";if(a!==void 0&&!l&&!u&&!p)throw new Error("Invalid 'auth' parameter: expected a non-empty API key string, a TokenCredential, or a KeyCredential.");let f;return typeof a=="string"?(f=new i,f.setProperty(t.PropertyId.SpeechServiceConnection_Key,a)):typeof a=="object"&&typeof a.getToken=="function"?f=new i(a):typeof a=="object"&&typeof a.key=="string"?(f=new i,f.setProperty(t.PropertyId.SpeechServiceConnection_Key,a.key)):f=new i,f.setProperty(t.PropertyId.SpeechServiceConnection_Endpoint,o.href),f}};Wc.SpeechTranslationConfig=r;class i extends r{constructor(o){super(),this.privSpeechProperties=new t.PropertyCollection,this.outputFormat=t.OutputFormat.Simple,this.privTokenCredential=o}set authorizationToken(o){e.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o)}set speechRecognitionLanguage(o){e.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,o)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return t.OutputFormat[this.privSpeechProperties.getProperty(n.OutputFormatPropertyName,void 0)]}set outputFormat(o){this.privSpeechProperties.setProperty(n.OutputFormatPropertyName,t.OutputFormat[o])}get endpointId(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_EndpointId,o)}addTargetLanguage(o){e.Contracts.throwIfNullOrWhitespace(o,"value");const a=this.targetLanguages;a.includes(o)||(a.push(o),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,a.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(o){e.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,o)}get region(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_Region)}get tokenCredential(){return this.privTokenCredential}setProxy(o,a,l,u){this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyHostName],o),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPort],a),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyUserName],l),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPassword],u)}getProperty(o,a){return this.privSpeechProperties.getProperty(o,a)}setProperty(o,a){this.privSpeechProperties.setProperty(o,a)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(o,a){const l=JSON.parse(this.privSpeechProperties.getProperty(n.ServicePropertiesPropertyName,"{}"));l[o]=a,this.privSpeechProperties.setProperty(n.ServicePropertiesPropertyName,JSON.stringify(l))}setProfanity(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceResponse_ProfanityOption,t.ProfanityOption[o])}enableAudioLogging(){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(n.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage,o)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthVoice,o)}get speechSynthesisOutputFormat(){return t.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,t.SpeechSynthesisOutputFormat[o])}}return Wc.SpeechTranslationConfigImpl=i,Wc}var Tf={},a_;function VN(){if(a_)return Tf;a_=1,Object.defineProperty(Tf,"__esModule",{value:!0}),Tf.PropertyCollection=void 0;const n=me();let e=class qN{constructor(){this.privKeys=[],this.privValues=[]}getProperty(r,i){let s;typeof r=="string"?s=r:s=n.PropertyId[r];for(let o=0;o<this.privKeys.length;o++)if(this.privKeys[o]===s)return this.privValues[o];if(i!==void 0)return String(i)}setProperty(r,i){let s;typeof r=="string"?s=r:s=n.PropertyId[r];for(let o=0;o<this.privKeys.length;o++)if(this.privKeys[o]===s){this.privValues[o]=i;return}this.privKeys.push(s),this.privValues.push(i)}clone(){const r=new qN;for(let i=0;i<this.privKeys.length;i++)r.privKeys.push(this.privKeys[i]),r.privValues.push(this.privValues[i]);return r}mergeTo(r){this.privKeys.forEach(i=>{if(r.getProperty(i,void 0)===void 0){const s=this.getProperty(i);r.setProperty(i,s)}})}get keys(){return this.privKeys}};return Tf.PropertyCollection=e,Tf}var fA={},c_;function iP(){return c_||(c_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.PropertyId=void 0,(function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_TranslationCategoryId=9]="SpeechServiceConnection_TranslationCategoryId",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",e[e.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",e[e.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",e[e.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=25]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",e[e.SpeechServiceConnection_Url=28]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=29]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=30]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.Speech_SegmentationSilenceTimeoutMs=31]="Speech_SegmentationSilenceTimeoutMs",e[e.Speech_SegmentationMaximumTimeMs=32]="Speech_SegmentationMaximumTimeMs",e[e.Speech_SegmentationStrategy=33]="Speech_SegmentationStrategy",e[e.Speech_StartEventSensitivity=34]="Speech_StartEventSensitivity",e[e.SpeechServiceConnection_EnableAudioLogging=35]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceConnection_LanguageIdMode=36]="SpeechServiceConnection_LanguageIdMode",e[e.SpeechServiceConnection_RecognitionEndpointVersion=37]="SpeechServiceConnection_RecognitionEndpointVersion",e[e.SpeechServiceResponse_ProfanityOption=38]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=39]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=40]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=41]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=42]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=43]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.SpeechServiceResponse_RequestWordBoundary=44]="SpeechServiceResponse_RequestWordBoundary",e[e.SpeechServiceResponse_RequestPunctuationBoundary=45]="SpeechServiceResponse_RequestPunctuationBoundary",e[e.SpeechServiceResponse_RequestSentenceBoundary=46]="SpeechServiceResponse_RequestSentenceBoundary",e[e.SpeechServiceResponse_DiarizeIntermediateResults=47]="SpeechServiceResponse_DiarizeIntermediateResults",e[e.Conversation_ApplicationId=48]="Conversation_ApplicationId",e[e.Conversation_DialogType=49]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=50]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=51]="Conversation_From_Id",e[e.Conversation_Conversation_Id=52]="Conversation_Conversation_Id",e[e.Conversation_Custom_Voice_Deployment_Ids=53]="Conversation_Custom_Voice_Deployment_Ids",e[e.Conversation_Speech_Activity_Template=54]="Conversation_Speech_Activity_Template",e[e.Conversation_Request_Bot_Status_Messages=55]="Conversation_Request_Bot_Status_Messages",e[e.Conversation_Agent_Connection_Id=56]="Conversation_Agent_Connection_Id",e[e.SpeechServiceConnection_Host=57]="SpeechServiceConnection_Host",e[e.ConversationTranslator_Host=58]="ConversationTranslator_Host",e[e.ConversationTranslator_Name=59]="ConversationTranslator_Name",e[e.ConversationTranslator_CorrelationId=60]="ConversationTranslator_CorrelationId",e[e.ConversationTranslator_Token=61]="ConversationTranslator_Token",e[e.PronunciationAssessment_ReferenceText=62]="PronunciationAssessment_ReferenceText",e[e.PronunciationAssessment_GradingSystem=63]="PronunciationAssessment_GradingSystem",e[e.PronunciationAssessment_Granularity=64]="PronunciationAssessment_Granularity",e[e.PronunciationAssessment_EnableMiscue=65]="PronunciationAssessment_EnableMiscue",e[e.PronunciationAssessment_Json=66]="PronunciationAssessment_Json",e[e.PronunciationAssessment_Params=67]="PronunciationAssessment_Params",e[e.WebWorkerLoadType=68]="WebWorkerLoadType",e[e.TalkingAvatarService_WebRTC_SDP=69]="TalkingAvatarService_WebRTC_SDP"})(n.PropertyId||(n.PropertyId={}))})(fA)),fA}var xf={},l_;function kB(){if(l_)return xf;l_=1,Object.defineProperty(xf,"__esModule",{value:!0}),xf.Recognizer=void 0;const n=ke(),e=Oe(),t=et(),r=me();let i=class GN{constructor(o,a,l,u){this.audioConfig=o!==void 0?o:r.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=a.clone(),this.privConnectionFactory=l,this.tokenCredential=u,this.implCommonRecognizerSetup()}close(o,a){t.Contracts.throwIfDisposed(this.privDisposed),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),o,a)}get internalData(){return this.privReco}async dispose(o){this.privDisposed||(this.privDisposed=!0,o&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return n.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(o){n.ServiceRecognizerBase.telemetryDataEnabled=o}implCommonRecognizerSetup(){let o=typeof window<"u"?"Browser":"Node",a="unknown",l="unknown";typeof navigator<"u"&&(o=o+"/"+navigator.platform,a=navigator.userAgent,l=navigator.appVersion);const u=this.createRecognizerConfig(new n.SpeechServiceConfig(new n.Context(new n.OS(o,a,l))));this.privReco=this.createServiceRecognizer(GN.getAuth(this.privProperties,this.tokenCredential),this.privConnectionFactory,this.audioConfig,u)}async recognizeOnceAsyncImpl(o){t.Contracts.throwIfDisposed(this.privDisposed);const a=new e.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(o,a.resolve,a.reject);const l=await a.promise;return await this.implRecognizerStop(),l}async startContinuousRecognitionAsyncImpl(o){t.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(o,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){t.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuth(o,a){const l=o.getProperty(r.PropertyId.SpeechServiceConnection_Key,void 0);return l&&l!==""?new n.CognitiveSubscriptionKeyAuthentication(l):a?new n.CognitiveTokenAuthentication(async()=>{try{const u=await a.getToken("https://cognitiveservices.azure.com/.default");return(u==null?void 0:u.token)??""}catch(u){throw u}},async()=>{try{const u=await a.getToken("https://cognitiveservices.azure.com/.default");return(u==null?void 0:u.token)??""}catch(u){throw u}}):new n.CognitiveTokenAuthentication(()=>{const u=o.getProperty(r.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(u)},()=>{const u=o.getProperty(r.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(u)})}};return xf.Recognizer=i,xf}var If={},gA={},u_;function rs(){return u_||(u_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SpeechStartEventSensitivity=n.RecognitionMode=void 0,(function(e){e.Interactive="Interactive",e.Dictation="Dictation",e.Conversation="Conversation",e.None="None"})(n.RecognitionMode||(n.RecognitionMode={})),(function(e){e.Low="low",e.Medium="medium",e.High="high"})(n.SpeechStartEventSensitivity||(n.SpeechStartEventSensitivity={}))})(gA)),gA}var d_;function MB(){if(d_)return If;d_=1,Object.defineProperty(If,"__esModule",{value:!0}),If.SpeechRecognizer=void 0;const n=ke(),e=rs(),t=Oe(),r=et(),i=me();let s=class KN extends i.Recognizer{constructor(a,l){const u=a;r.Contracts.throwIfNull(u,"speechConfig"),r.Contracts.throwIfNullOrWhitespace(u.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),super(l,u.properties,new n.SpeechConnectionFactory,a.tokenCredential),this.privDisposedRecognizer=!1}static FromConfig(a,l,u){const p=a;return l.properties.mergeTo(p.properties),new KN(a,u)}get endpointId(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){r.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,a)}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple])===i.OutputFormat[i.OutputFormat.Simple]?i.OutputFormat.Simple:i.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(e.RecognitionMode.Interactive),a,l)}startContinuousRecognitionAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(this.properties.getProperty(n.ForceDictationPropertyName,void 0)===void 0?e.RecognitionMode.Conversation:e.RecognitionMode.Dictation),a,l)}stopContinuousRecognitionAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),a,l)}startKeywordRecognitionAsync(a,l,u){r.Contracts.throwIfNull(a,"model"),u&&u("Not yet implemented.")}stopKeywordRecognitionAsync(a){a&&a()}close(a,l){r.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),a,l)}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new n.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,l,u,p){const f=u;return new n.SpeechServiceRecognizer(a,l,f,p,this)}};return If.SpeechRecognizer=s,If}var _f={},kf={},qc={},h_;function $N(){if(h_)return qc;h_=1,Object.defineProperty(qc,"__esModule",{value:!0}),qc.ConnectionMessageImpl=qc.ConnectionMessage=void 0;const n=si(),e=Oe(),t=VN(),r=iP();let i=class{};qc.ConnectionMessage=i;class s{constructor(a){this.privConnectionMessage=a,this.privProperties=new t.PropertyCollection,this.privConnectionMessage.headers[n.HeaderNames.ConnectionId]&&this.privProperties.setProperty(r.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[n.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(l=>{this.privProperties.setProperty(l,this.privConnectionMessage.headers[l])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(a=>a.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===e.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===e.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}return qc.ConnectionMessageImpl=s,qc}var p_;function JN(){if(p_)return kf;p_=1,Object.defineProperty(kf,"__esModule",{value:!0}),kf.Connection=void 0;const n=ke(),e=Oe(),t=$N(),r=et(),i=me();let s=class vE{static fromRecognizer(a){const l=a.internalData,u=new vE;return u.privInternalData=l,u.setupEvents(),u}static fromSynthesizer(a){const l=a.internalData,u=new vE;return u.privInternalData=l,u.setupEvents(),u}openConnection(a,l){(0,e.marshalPromiseToCallbacks)(this.privInternalData.connect(),a,l)}closeConnection(a,l){if(this.privInternalData instanceof n.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");(0,e.marshalPromiseToCallbacks)(this.privInternalData.disconnect(),a,l)}setMessageProperty(a,l,u){if(r.Contracts.throwIfNullOrWhitespace(l,"propertyName"),this.privInternalData instanceof n.ServiceRecognizerBase){if(a.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");{const p=this.privInternalData.speechContext.getContext();p[l]=u}}else if(this.privInternalData instanceof n.SynthesisAdapterBase){if(a.toLowerCase()!=="speech.config"&&a.toLowerCase()!=="synthesis.context")throw new Error("Only speech.config and synthesis.context message paths are currently supported for synthesizer");if(a.toLowerCase()==="speech.config"){if(l.toLowerCase()!=="context")throw new Error("Only context property is currently supported for speech.config message path for synthesizer");this.privInternalData.synthesizerConfig.setContextFromJson(u)}else this.privInternalData.synthesisContext.setSection(l,u)}}sendMessageAsync(a,l,u,p){(0,e.marshalPromiseToCallbacks)(this.privInternalData.sendNetworkMessage(a,l),u,p)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(a=>{a.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new i.ConnectionEventArgs(a.connectionId)):a.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new i.ConnectionEventArgs(a.connectionId)):a.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new i.ConnectionMessageEventArgs(new t.ConnectionMessageImpl(a.message))):a.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new i.ConnectionMessageEventArgs(new t.ConnectionMessageImpl(a.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(a=>{this.receivedServiceMessage&&this.receivedServiceMessage(new i.ServiceEventArgs(a.jsonString,a.name))})}};return kf.Connection=s,kf}var f_;function DB(){if(f_)return _f;f_=1,Object.defineProperty(_f,"__esModule",{value:!0}),_f.TranslationRecognizer=void 0;const n=ke(),e=rs(),t=Oe(),r=JN(),i=et(),s=me();let o=class XN extends s.Recognizer{constructor(l,u,p){const f=l;i.Contracts.throwIfNull(f,"speechConfig"),super(u,f.properties,p||new n.TranslationConnectionFactory,l.tokenCredential),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice),s.PropertyId[s.PropertyId.SpeechServiceConnection_TranslationVoice]),i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages),s.PropertyId[s.PropertyId.SpeechServiceConnection_TranslationToLanguages]),i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage),s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(l,u,p){const f=l;return u.properties.mergeTo(f.properties),u.properties.getProperty(s.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)===n.AutoDetectSourceLanguagesOpenRangeOptionName&&f.properties.setProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),new XN(l,p)}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(l){this.properties.setProperty(s.PropertyId.SpeechServiceAuthorization_Token,l)}recognizeOnceAsync(l,u){i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,t.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(e.RecognitionMode.Interactive),l,u)}startContinuousRecognitionAsync(l,u){(0,t.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(e.RecognitionMode.Conversation),l,u)}stopContinuousRecognitionAsync(l,u){(0,t.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),l,u)}removeTargetLanguage(l){if(i.Contracts.throwIfNullOrUndefined(l,"language to be removed"),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){const u=this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),p=u.indexOf(l);p>-1&&(u.splice(p,1),this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,u.join(",")),this.updateLanguages(u))}}addTargetLanguage(l){i.Contracts.throwIfNullOrUndefined(l,"language to be added");let u=[];this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(u=this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),u.includes(l)||(u.push(l),this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,u.join(",")))):(this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,l),u=[l]),this.updateLanguages(u)}close(l,u){i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),l,u)}onConnection(){}async dispose(l){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,l&&(await this.implRecognizerStop(),await super.dispose(l)))}createRecognizerConfig(l){return new n.RecognizerConfig(l,this.privProperties)}createServiceRecognizer(l,u,p,f){const g=p;return new n.TranslationServiceRecognizer(l,u,g,f,this)}updateLanguages(l){const u=r.Connection.fromRecognizer(this);u&&(u.setMessageProperty("speech.context","translationcontext",{to:l}),u.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:l})))}};return _f.TranslationRecognizer=o,_f}var Mf={},g_;function NB(){if(g_)return Mf;g_=1,Object.defineProperty(Mf,"__esModule",{value:!0}),Mf.Translations=void 0;const n=me();let e=class{constructor(){this.privMap=new n.PropertyCollection}get languages(){return this.privMap.keys}get(r,i){return this.privMap.getProperty(r,i)}set(r,i){this.privMap.setProperty(r,i)}};return Mf.Translations=e,Mf}var vA={},v_;function OB(){return v_||(v_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.NoMatchReason=void 0,(function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"})(n.NoMatchReason||(n.NoMatchReason={}))})(vA)),vA}var Df={},m_;function LB(){if(m_)return Df;m_=1,Object.defineProperty(Df,"__esModule",{value:!0}),Df.NoMatchDetails=void 0;const n=ke(),e=me();let t=class YN{constructor(i){this.privReason=i}static fromResult(i){const s=n.SimpleSpeechPhrase.fromJSON(i.json,0);let o=e.NoMatchReason.NotRecognized;switch(s.RecognitionStatus){case n.RecognitionStatus.BabbleTimeout:o=e.NoMatchReason.InitialBabbleTimeout;break;case n.RecognitionStatus.InitialSilenceTimeout:o=e.NoMatchReason.InitialSilenceTimeout;break;default:o=e.NoMatchReason.NotRecognized;break}return new YN(o)}get reason(){return this.privReason}};return Df.NoMatchDetails=t,Df}var Nf={},y_;function jB(){if(y_)return Nf;y_=1,Object.defineProperty(Nf,"__esModule",{value:!0}),Nf.TranslationRecognitionCanceledEventArgs=void 0;let n=class{constructor(t,r,i,s,o){this.privCancelReason=r,this.privErrorDetails=i,this.privResult=o,this.privSessionId=t,this.privErrorCode=s}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return Nf.TranslationRecognitionCanceledEventArgs=n,Nf}var Of={},S_;function QN(){if(S_)return Of;S_=1,Object.defineProperty(Of,"__esModule",{value:!0}),Of.CancellationDetailsBase=void 0;let n=class{constructor(t,r,i){this.privReason=t,this.privErrorDetails=r,this.privErrorCode=i}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};return Of.CancellationDetailsBase=n,Of}var Lf={},C_;function zB(){if(C_)return Lf;C_=1,Object.defineProperty(Lf,"__esModule",{value:!0}),Lf.CancellationDetails=void 0;const n=ke(),e=QN(),t=me();let r=class ZN extends e.CancellationDetailsBase{constructor(s,o,a){super(s,o,a)}static fromResult(s){let o=t.CancellationReason.Error,a=t.CancellationErrorCode.NoError;if(s instanceof t.RecognitionResult&&s.json){const l=n.SimpleSpeechPhrase.fromJSON(s.json,0);o=n.EnumTranslation.implTranslateCancelResult(l.RecognitionStatus)}return s.properties&&(a=t.CancellationErrorCode[s.properties.getProperty(n.CancellationErrorCodePropertyName,t.CancellationErrorCode[t.CancellationErrorCode.NoError])]),new ZN(o,s.errorDetails||n.EnumTranslation.implTranslateErrorDetails(a),a)}};return Lf.CancellationDetails=r,Lf}var mA={},b_;function FB(){return b_||(b_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.CancellationErrorCode=void 0,(function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError",e[e.Forbidden=8]="Forbidden"})(n.CancellationErrorCode||(n.CancellationErrorCode={}))})(mA)),mA}var jf={},w_;function BB(){if(w_)return jf;w_=1,Object.defineProperty(jf,"__esModule",{value:!0}),jf.ConnectionEventArgs=void 0;const n=me();let e=class extends n.SessionEventArgs{};return jf.ConnectionEventArgs=e,jf}var zf={},A_;function UB(){if(A_)return zf;A_=1,Object.defineProperty(zf,"__esModule",{value:!0}),zf.ServiceEventArgs=void 0;const n=me();let e=class extends n.SessionEventArgs{constructor(r,i,s){super(s),this.privJsonResult=r,this.privEventName=i}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};return zf.ServiceEventArgs=e,zf}var Ff={},E_;function HB(){if(E_)return Ff;E_=1,Object.defineProperty(Ff,"__esModule",{value:!0}),Ff.PhraseListGrammar=void 0;const n=et();let e=class eO{constructor(r){this.privGrammerBuilder=r.dynamicGrammar}static fromRecognizer(r){const i=r.internalData;return new eO(i)}addPhrase(r){this.privGrammerBuilder.addPhrase(r)}addPhrases(r){this.privGrammerBuilder.addPhrase(r)}clear(){this.privGrammerBuilder.clearPhrases()}setWeight(r){n.Contracts.throwIfNumberOutOfRange(r,"weight",0,2),this.privGrammerBuilder.setWeight(r)}};return Ff.PhraseListGrammar=e,Ff}var Vc={},R_;function sP(){if(R_)return Vc;R_=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.DialogServiceConfigImpl=Vc.DialogServiceConfig=void 0;const n=et(),e=me();let t=class{constructor(){}set applicationId(s){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};Vc.DialogServiceConfig=t;class r extends t{constructor(){super(),this.privSpeechConfig=new e.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(s){n.Contracts.throwIfNullOrWhitespace(s,"value"),this.privSpeechConfig.speechRecognitionLanguage=s}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(s){this.privSpeechConfig.outputFormat=s}setProperty(s,o){this.privSpeechConfig.setProperty(s,o)}getProperty(s,o){return this.privSpeechConfig.getProperty(s)}setProxy(s,o,a,l){this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyHostName,s),this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyPort,`${o}`),a&&this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyUserName,a),l&&this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyPassword,l)}setServiceProperty(s,o,a){this.privSpeechConfig.setServiceProperty(s,o)}close(){}}return Vc.DialogServiceConfigImpl=r,Vc}var Bf={},P_;function WB(){if(P_)return Bf;P_=1,Object.defineProperty(Bf,"__esModule",{value:!0}),Bf.BotFrameworkConfig=void 0;const n=et(),e=sP(),t=me();let r=class extends e.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(s,o,a){n.Contracts.throwIfNullOrWhitespace(s,"subscription"),n.Contracts.throwIfNullOrWhitespace(o,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),l.setProperty(t.PropertyId.SpeechServiceConnection_Key,s),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,o),a&&l.setProperty(t.PropertyId.Conversation_ApplicationId,a),l}static fromAuthorizationToken(s,o,a){n.Contracts.throwIfNullOrWhitespace(s,"authorizationToken"),n.Contracts.throwIfNullOrWhitespace(o,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),l.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,s),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,o),a&&l.setProperty(t.PropertyId.Conversation_ApplicationId,a),l}static fromHost(s,o,a){n.Contracts.throwIfNullOrUndefined(s,"host");const l=s instanceof URL?s:new URL(`wss://${s}.convai.speech.azure.us`);n.Contracts.throwIfNullOrUndefined(l,"resolvedHost");const u=new e.DialogServiceConfigImpl;return u.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),u.setProperty(t.PropertyId.SpeechServiceConnection_Host,l.toString()),o!==void 0&&u.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),u}static fromEndpoint(s,o){n.Contracts.throwIfNull(s,"endpoint");const a=new e.DialogServiceConfigImpl;return a.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),a.setProperty(t.PropertyId.SpeechServiceConnection_Endpoint,s.toString()),o!==void 0&&a.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),a}};return Bf.BotFrameworkConfig=r,Bf}var Uf={},T_;function qB(){if(T_)return Uf;T_=1,Object.defineProperty(Uf,"__esModule",{value:!0}),Uf.CustomCommandsConfig=void 0;const n=et(),e=sP(),t=me();let r=class extends e.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(s,o,a){n.Contracts.throwIfNullOrWhitespace(s,"applicationId"),n.Contracts.throwIfNullOrWhitespace(o,"subscription"),n.Contracts.throwIfNullOrWhitespace(a,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.CustomCommands),l.setProperty(t.PropertyId.Conversation_ApplicationId,s),l.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}static fromAuthorizationToken(s,o,a){n.Contracts.throwIfNullOrWhitespace(s,"applicationId"),n.Contracts.throwIfNullOrWhitespace(o,"authorizationToken"),n.Contracts.throwIfNullOrWhitespace(a,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.CustomCommands),l.setProperty(t.PropertyId.Conversation_ApplicationId,s),l.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}set applicationId(s){n.Contracts.throwIfNullOrWhitespace(s,"value"),this.setProperty(t.PropertyId.Conversation_ApplicationId,s)}get applicationId(){return this.getProperty(t.PropertyId.Conversation_ApplicationId)}};return Uf.CustomCommandsConfig=r,Uf}var Hf={},Wf={},qf={},Vf={},x_;function Sc(){if(x_)return Vf;x_=1,Object.defineProperty(Vf,"__esModule",{value:!0}),Vf.QueryParameterNames=void 0;let n=class{};return Vf.QueryParameterNames=n,n.BotId="botid",n.CustomSpeechDeploymentId="cid",n.CustomVoiceDeploymentId="deploymentId",n.EnableAudioLogging="storeAudio",n.EnableLanguageId="lidEnabled",n.EnableWordLevelTimestamps="wordLevelTimestamps",n.EndSilenceTimeoutMs="endSilenceTimeoutMs",n.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",n.SegmentationMaximumTimeMs="segmentationMaximumTimeMs",n.SegmentationStrategy="segmentationStrategy",n.Format="format",n.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",n.Language="language",n.Profanity="profanity",n.RequestBotStatusMessages="enableBotMessageStatus",n.StableIntermediateThreshold="stableIntermediateThreshold",n.StableTranslation="stableTranslation",n.TestHooks="testhooks",n.Postprocessing="postprocessing",n.CtsMeetingId="meetingId",n.CtsDeviceId="deviceId",n.CtsIsParticipant="isParticipant",n.EnableAvatar="enableTalkingAvatar",Vf}var I_;function Xo(){if(I_)return qf;I_=1,Object.defineProperty(qf,"__esModule",{value:!0}),qf.ConnectionFactoryBase=void 0;const n=ke(),e=Oe(),t=me(),r=Sc();let i=class{static getHostSuffix(o){if(o){if(o.toLowerCase().startsWith("china"))return".azure.cn";if(o.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(o,a,l){new Map([[t.PropertyId.Speech_SegmentationSilenceTimeoutMs,r.QueryParameterNames.SegmentationSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_EnableAudioLogging,r.QueryParameterNames.EnableAudioLogging],[t.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,r.QueryParameterNames.EndSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,r.QueryParameterNames.InitialSilenceTimeoutMs],[t.PropertyId.SpeechServiceResponse_PostProcessingOption,r.QueryParameterNames.Postprocessing],[t.PropertyId.SpeechServiceResponse_ProfanityOption,r.QueryParameterNames.Profanity],[t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,r.QueryParameterNames.EnableWordLevelTimestamps],[t.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,r.QueryParameterNames.StableIntermediateThreshold]]).forEach((f,g)=>{this.setUrlParameter(g,f,o,a,l)});const p=JSON.parse(o.parameters.getProperty(n.ServicePropertiesPropertyName,"{}"));Object.keys(p).forEach(f=>{a[f]=p[f]})}setUrlParameter(o,a,l,u,p){const f=l.parameters.getProperty(o,void 0);f&&(!p||p.search(a)===-1)&&(u[a]=f.toLocaleLowerCase())}static async getRedirectUrlFromEndpoint(o){const a=new URL(o);a.protocol="https:",a.port="443",a.searchParams.append("GenerateRedirectResponse","true");const u=a.toString();e.Events.instance.onEvent(new e.ConnectionRedirectEvent("",u,void 0,"ConnectionFactoryBase: redirectUrl request"));const p=await fetch(u);if(p.status!==200)return o;const f=await p.text();e.Events.instance.onEvent(new e.ConnectionRedirectEvent("",f,o,"ConnectionFactoryBase: redirectUrlString"));try{return new URL(f.trim()).toString()}catch{return o}}};return qf.ConnectionFactoryBase=i,qf}var __;function VB(){if(__)return Wf;__=1,Object.defineProperty(Wf,"__esModule",{value:!0}),Wf.DialogConnectionFactory=void 0;const n=Pr(),e=ke(),t=me(),r=Xo(),i=ke(),s=si(),o=Sc();class a extends r.ConnectionFactoryBase{create(u,p,f){const g=u.parameters.getProperty(t.PropertyId.Conversation_ApplicationId,""),m=u.parameters.getProperty(t.PropertyId.Conversation_DialogType),C=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region),S=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),w=u.parameters.getProperty(t.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),b={};b[s.HeaderNames.ConnectionId]=f,b[o.QueryParameterNames.Format]=u.parameters.getProperty(e.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple]).toLowerCase(),b[o.QueryParameterNames.Language]=S,b[o.QueryParameterNames.RequestBotStatusMessages]=w,g&&(b[o.QueryParameterNames.BotId]=g,m===t.DialogServiceConfig.DialogTypes.CustomCommands&&(b[s.HeaderNames.CustomCommandsAppId]=g));const R=m===t.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",P=m===t.DialogServiceConfig.DialogTypes.CustomCommands?"v1":m===t.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",I={};p.token!=null&&p.token!==""&&(I[p.headerName]=p.token);let M=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,"");if(!M){const O=r.ConnectionFactoryBase.getHostSuffix(C),L=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,`wss://${C}.${a.BaseUrl}${O}`);M=`${L.endsWith("/")?L:L+"/"}${R}${a.ApiKey}/${P}`}this.setCommonUrlParams(u,b,M);const k=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new n.WebsocketConnection(M,b,I,new i.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(u),k,f))}}return Wf.DialogConnectionFactory=a,a.ApiKey="api",a.BaseUrl="convai.speech",Wf}var k_;function GB(){if(k_)return Hf;k_=1,Object.defineProperty(Hf,"__esModule",{value:!0}),Hf.DialogServiceConnector=void 0;const n=VB(),e=ke(),t=rs(),r=Oe(),i=et(),s=me(),o=iP();let a=class extends s.Recognizer{constructor(u,p){const f=u;i.Contracts.throwIfNull(u,"dialogConfig"),super(p,f.properties,new n.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=f.properties.clone();const g=this.buildAgentConfig();this.privReco.agentConfig.set(g)}connect(u,p){(0,r.marshalPromiseToCallbacks)(this.privReco.connect(),u,p)}disconnect(u,p){(0,r.marshalPromiseToCallbacks)(this.privReco.disconnect(),u,p)}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(u){i.Contracts.throwIfNullOrWhitespace(u,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,u)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(o.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(u){this.properties.setProperty(o.PropertyId.Conversation_Speech_Activity_Template,u)}listenOnceAsync(u,p){if(this.isTurnComplete){i.Contracts.throwIfDisposed(this.privIsDisposed);const g=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;const m=new r.Deferred;await this.privReco.recognize(t.RecognitionMode.Conversation,m.resolve,m.reject);const C=await m.promise;return await this.implRecognizerStop(),C})();g.catch(()=>{this.dispose(!0).catch(()=>{})}),(0,r.marshalPromiseToCallbacks)(g.finally(()=>{this.isTurnComplete=!0}),u,p)}}sendActivityAsync(u,p,f){(0,r.marshalPromiseToCallbacks)(this.privReco.sendMessage(u),p,f)}close(u,p){i.Contracts.throwIfDisposed(this.privIsDisposed),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),u,p)}async dispose(u){this.privIsDisposed||u&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(u))}createRecognizerConfig(u){return new e.RecognizerConfig(u,this.privProperties)}createServiceRecognizer(u,p,f,g){const m=f;return new e.DialogServiceAdapter(u,p,m,g,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(o.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(o.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(o.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};return Hf.DialogServiceConnector=a,Hf}var Gf={},M_;function KB(){if(M_)return Gf;M_=1,Object.defineProperty(Gf,"__esModule",{value:!0}),Gf.ActivityReceivedEventArgs=void 0;let n=class{constructor(t,r){this.privActivity=t,this.privAudioStream=r}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};return Gf.ActivityReceivedEventArgs=n,Gf}var Kf={},$f={},D_;function $B(){if(D_)return $f;D_=1,Object.defineProperty($f,"__esModule",{value:!0}),$f.TurnStatusResponsePayload=void 0;class n{constructor(t){this.privMessageStatusResponse=JSON.parse(t)}static fromJSON(t){return new n(t)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}return $f.TurnStatusResponsePayload=n,$f}var N_;function JB(){if(N_)return Kf;N_=1,Object.defineProperty(Kf,"__esModule",{value:!0}),Kf.TurnStatusReceivedEventArgs=void 0;const n=$B();let e=class{constructor(r){this.privTurnStatus=n.TurnStatusResponsePayload.fromJSON(r)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};return Kf.TurnStatusReceivedEventArgs=e,Kf}var yA={},O_;function XB(){return O_||(O_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ServicePropertyChannel=void 0,(function(e){e[e.UriQueryParameter=0]="UriQueryParameter"})(n.ServicePropertyChannel||(n.ServicePropertyChannel={}))})(yA)),yA}var SA={},L_;function YB(){return L_||(L_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ProfanityOption=void 0,(function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"})(n.ProfanityOption||(n.ProfanityOption={}))})(SA)),SA}var Jf={},j_;function QB(){if(j_)return Jf;j_=1,Object.defineProperty(Jf,"__esModule",{value:!0}),Jf.BaseAudioPlayer=void 0;const n=Ws(),e=me(),t=Tu();let r=class{constructor(s){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,s===void 0&&(s=e.AudioStreamFormat.getDefaultInputFormat()),this.init(s)}playAudioSample(s,o,a){try{this.ensureInitializedContext();const l=this.formatAudioData(s),u=new Float32Array(this.samples.length+l.length);u.set(this.samples,0),u.set(l,this.samples.length),this.samples=u,o&&o()}catch(l){a&&a(l)}}stopAudio(s,o){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{s&&s()},a=>{o&&o(a)}),this.audioContext=null)}init(s){this.audioFormat=s,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();const s=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},s)}}createAudioContext(){this.audioContext=t.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(s){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(s),128);case 16:return this.formatArrayBuffer(new Int16Array(s),32768);case 32:return this.formatArrayBuffer(new Int32Array(s),2147483648);default:throw new n.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(s,o){const a=new Float32Array(s.length);for(let l=0;l<s.length;l++)a[l]=s[l]/o;return a}updateAudioBuffer(){if(this.samples.length===0)return;const s=this.audioFormat.channels,o=this.audioContext.createBufferSource(),a=this.samples.length/s,l=this.audioContext.createBuffer(s,a,this.audioFormat.samplesPerSec);for(let u=0;u<s;u++){let p=u;const f=l.getChannelData(u);for(let g=0;g<this.samples.length;g++,p+=s)f[g]=this.samples[p]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),o.buffer=l,o.connect(this.gainNode),o.start(this.startTime),this.startTime+=l.duration,this.samples=new Float32Array}async playAudio(s){this.audioContext===null&&this.createAudioContext();const o=this.audioContext.createBufferSource(),a=this.audioContext.destination;await this.audioContext.decodeAudioData(s,l=>{o.buffer=l,o.connect(a),o.start(0)})}};return Jf.BaseAudioPlayer=r,Jf}var Xf={},z_;function ZB(){if(z_)return Xf;z_=1,Object.defineProperty(Xf,"__esModule",{value:!0}),Xf.ConnectionMessageEventArgs=void 0;let n=class{constructor(t){this.privConnectionMessage=t}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};return Xf.ConnectionMessageEventArgs=n,Xf}var Yf={},CA={},F_;function tO(){return F_||(F_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.LanguageIdMode=void 0,(function(e){e[e.AtStart=0]="AtStart",e[e.Continuous=1]="Continuous"})(n.LanguageIdMode||(n.LanguageIdMode={}))})(CA)),CA}var B_;function e4(){if(B_)return Yf;B_=1,Object.defineProperty(Yf,"__esModule",{value:!0}),Yf.AutoDetectSourceLanguageConfig=void 0;const n=ke(),e=et(),t=me(),r=tO();let i=class EC{constructor(){this.privProperties=new t.PropertyCollection,this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=r.LanguageIdMode.AtStart}static fromOpenRange(){const o=new EC;return o.properties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,n.AutoDetectSourceLanguagesOpenRangeOptionName),o.properties.setProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),o}static fromLanguages(o){e.Contracts.throwIfArrayEmptyOrWhitespace(o,"languages");const a=new EC;return a.properties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,o.join()),a}static fromSourceLanguageConfigs(o){if(o.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const a=new EC,l=[];return o.forEach(u=>{if(l.push(u.language),u.endpointId!==void 0&&u.endpointId!==""){const p=u.language+t.PropertyId.SpeechServiceConnection_EndpointId.toString();a.properties.setProperty(p,u.endpointId)}}),a.properties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,l.join()),a}get properties(){return this.privProperties}set mode(o){o===r.LanguageIdMode.Continuous?(this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=o}};return Yf.AutoDetectSourceLanguageConfig=i,Yf}var Qf={},U_;function t4(){if(U_)return Qf;U_=1,Object.defineProperty(Qf,"__esModule",{value:!0}),Qf.AutoDetectSourceLanguageResult=void 0;const n=et();let e=class mE{constructor(r,i){n.Contracts.throwIfNullOrUndefined(r,"language"),n.Contracts.throwIfNullOrUndefined(i,"languageDetectionConfidence"),this.privLanguage=r,this.privLanguageDetectionConfidence=i}static fromResult(r){return new mE(r.language,r.languageDetectionConfidence)}static fromConversationTranscriptionResult(r){return new mE(r.language,r.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};return Qf.AutoDetectSourceLanguageResult=e,Qf}var Zf={},H_;function n4(){if(H_)return Zf;H_=1,Object.defineProperty(Zf,"__esModule",{value:!0}),Zf.SourceLanguageConfig=void 0;const n=et();let e=class nO{constructor(r,i){n.Contracts.throwIfNullOrUndefined(r,"language"),this.privLanguage=r,this.privEndpointId=i}static fromLanguage(r,i){return new nO(r,i)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};return Zf.SourceLanguageConfig=e,Zf}var bA={},Gc={},W_;function rO(){if(W_)return Gc;W_=1,Object.defineProperty(Gc,"__esModule",{value:!0}),Gc.ConversationImpl=Gc.Conversation=void 0;const n=ke(),e=Oe(),t=et(),r=me();let i=class{constructor(){}static createConversationAsync(a,l,u,p){t.Contracts.throwIfNullOrUndefined(a,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrUndefined(a.region,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!a.subscriptionKey&&!a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceAuthorization_Token])&&t.Contracts.throwIfNullOrUndefined(a.subscriptionKey,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let f,g,m;return typeof l=="string"?(f=new s(a,l),(0,e.marshalPromiseToCallbacks)((async()=>{})(),u,p)):(f=new s(a),g=l,m=u,f.createConversationAsync((()=>{g&&g()}),C=>{m&&m(C)})),f}};Gc.Conversation=i;class s extends i{constructor(a,l){if(super(),this.privErrors=n.ConversationConnectionConfig.restErrors,this.onConnected=f=>{var g;this.privIsConnected=!0;try{(g=this.privConversationTranslator)!=null&&g.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,f)}catch{}},this.onDisconnected=f=>{var g;try{(g=this.privConversationTranslator)!=null&&g.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,f)}catch{}finally{this.close(!1)}},this.onCanceled=(f,g)=>{var m;try{(m=this.privConversationTranslator)!=null&&m.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,g)}catch{}},this.onParticipantUpdateCommandReceived=(f,g)=>{try{const m=this.privParticipants.getParticipant(g.id);if(m!==void 0){switch(g.key){case n.ConversationTranslatorCommandTypes.changeNickname:m.displayName=g.value;break;case n.ConversationTranslatorCommandTypes.setUseTTS:m.isUsingTts=g.value;break;case n.ConversationTranslatorCommandTypes.setProfanityFiltering:m.profanity=g.value;break;case n.ConversationTranslatorCommandTypes.setMute:m.isMuted=g.value;break;case n.ConversationTranslatorCommandTypes.setTranslateToLanguages:m.translateToLanguages=g.value;break}this.privParticipants.addOrUpdateParticipant(m),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.Updated,[this.toParticipant(m)],g.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(f,g)=>{try{this.privParticipants.participants.forEach(m=>m.isMuted=m.isHost?!1:g.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.Updated,this.toParticipants(!1),g.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(f,g)=>{try{const m=this.privParticipants.addOrUpdateParticipant(g.participant);m!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.JoinedConversation,[this.toParticipant(m)],g.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(f,g)=>{try{const m=this.privParticipants.getParticipant(g.participant.id);m!==void 0&&(this.privParticipants.deleteParticipant(g.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.LeftConversation,[this.toParticipant(m)],g.sessionId)))}catch{}},this.onTranslationReceived=(f,g)=>{try{switch(g.command){case n.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new r.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case n.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new r.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case n.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new r.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break}}catch{}},this.onParticipantsListReceived=(f,g)=>{var m;try{if(g.sessionToken!==void 0&&g.sessionToken!==null&&(this.privRoom.token=g.sessionToken),this.privParticipants.participants=[...g.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),g.sessionId)),this.me.isHost){const C=(m=this.privConversationTranslator)==null?void 0:m.properties.getProperty(r.PropertyId.ConversationTranslator_Name);C!==void 0&&C.length>0&&C!==this.me.displayName&&this.changeNicknameAsync(C)}}catch{}},this.onConversationExpiration=(f,g)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,g)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new r.PropertyCollection,this.privManager=new n.ConversationManager,a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage])||a.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage],n.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage]),l)this.privConversationId=l;else{a.targetLanguages.length===0&&a.addTargetLanguage(this.privLanguage),a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceResponse_ProfanityOption])||a.setProfanity(r.ProfanityOption.Masked);let g=a.getProperty(r.PropertyId[r.PropertyId.ConversationTranslator_Name]);g==null&&(g="Host"),t.Contracts.throwIfNullOrTooLong(g,"nickname",50),t.Contracts.throwIfNullOrTooShort(g,"nickname",2),a.setProperty(r.PropertyId[r.PropertyId.ConversationTranslator_Name],g)}this.privConfig=a;const p=a;t.Contracts.throwIfNull(p,"speechConfig"),this.privProperties=p.properties.clone(),this.privIsConnected=!1,this.privParticipants=new n.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var a,l;return(a=this.privParticipants.me)!=null&&a.isHost?!1:(l=this.privParticipants.me)==null?void 0:l.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const a=this.conversationId,l=this.participants.map(f=>({id:f.id,preferredLanguage:f.preferredLanguage,voice:f.voice})),u={};for(const f of n.ConversationConnectionConfig.transcriptionEventKeys){const g=this.properties.getProperty(f,"");g!==""&&(u[f]=g)}return{id:a,participants:l,conversationProperties:u}}get canSend(){var a;return this.privIsConnected&&!((a=this.privParticipants.me)!=null&&a.isMuted)}get canSendAsHost(){var a;return this.privIsConnected&&((a=this.privParticipants.me)==null?void 0:a.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),this.privToken=a}set conversationTranslator(a){this.privConversationTranslator=a}onToken(a){this.privConversationTranslator.onToken(a)}createConversationAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),this.privManager.createOrJoin(this.privProperties,void 0,(u=>{u||this.handleError(new Error(this.privErrors.permissionDeniedConnect),l),this.privRoom=u,this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}startConversationAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=n.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}addParticipantAsync(a,l,u){t.Contracts.throwIfNullOrUndefined(a,"Participant"),(0,e.marshalPromiseToCallbacks)(this.addParticipantImplAsync(a),l,u)}joinConversationAsync(a,l,u,p,f){try{t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","conversationId")),t.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,a,(g=>{t.Contracts.throwIfNullOrUndefined(g,this.privErrors.permissionDeniedConnect),this.privRoom=g,this.privConfig.authorizationToken=g.cognitiveSpeechAuthToken,p&&p(g.cognitiveSpeechAuthToken)}),(g=>{this.handleError(g,f)}))}catch(g){this.handleError(g,f)}}deleteConversationAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.deleteConversationImplAsync(),a,l)}async deleteConversationImplAsync(){t.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),t.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.endConversationImplAsync(),a,l)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}muteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}muteParticipantAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!0),(()=>{this.handleCallback(l,u)}),(f=>{this.handleError(f,u)}))}catch(p){this.handleError(p,u)}}removeParticipantAsync(a,l,u){try{if(t.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&a.hasOwnProperty("id"))(0,e.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(a),l,u);else{t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),u);let p="";typeof a=="string"?p=a:a.hasOwnProperty("id")?p=a.id:a.hasOwnProperty("userId")&&(p=a.userId),t.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(g=>g.id===p)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(p),(()=>{this.handleCallback(l,u)}),(g=>{this.handleError(g,u)}))}}catch(p){this.handleError(p,u)}}unlockConversationAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}unmuteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}unmuteParticipantAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!1),(()=>{this.handleCallback(l,u)}),(f=>{this.handleError(f,u)}))}catch(p){this.handleError(p,u)}}sendTextMessageAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","message")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),a.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(a),(()=>{this.handleCallback(l,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}setTranslatedLanguagesAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfArrayEmptyOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","languages")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(a),(()=>{this.handleCallback(l,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}changeNicknameAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(a),(()=>{this.handleCallback(l,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(a){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await a.enforceAudioGating(),this.privTranscriberRecognizer=a,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){const a=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:a,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(a){if(this.privParticipants.addOrUpdateParticipant(a)!==void 0&&this.privTranscriberRecognizer){const u=this.conversationInfo;return u.participants=[a],this.privTranscriberRecognizer.pushConversationEvent(u,"join")}}removeParticipantImplAsync(a){this.privParticipants.deleteParticipant(a.id);const l=this.conversationInfo;return l.participants=[a],this.privTranscriberRecognizer.pushConversationEvent(l,"leave")}async close(a){var l;try{this.privIsConnected=!1,await((l=this.privConversationRecognizer)==null?void 0:l.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(u){throw u}a&&this.dispose()}handleCallback(a,l){if(a){try{a()}catch(u){l&&l(u)}a=void 0}}handleError(a,l){if(l)if(a instanceof Error){const u=a;l(u.name+": "+u.message)}else l(a)}toParticipants(a){const l=this.privParticipants.participants.map(u=>this.toParticipant(u));return a?l:l.filter(u=>u.isHost===!1)}toParticipant(a){return new r.Participant(a.id,a.avatar,a.displayName,a.isHost,a.isMuted,a.isUsingTts,a.preferredLanguage,a.voice)}getMuteAllCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMuteCommand(a,l){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setMute,participantId:a,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:l})}getLockCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getEjectCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.ejectParticipant,participantId:a,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getChangeNicknameCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"nickname"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.changeNickname,nickname:a,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMessageCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),t.Contracts.throwIfNullOrWhitespace(a,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:a,type:n.ConversationTranslatorMessageTypes.instantMessage})}}return Gc.ConversationImpl=s,Gc}var eg={},q_;function r4(){if(q_)return eg;q_=1,Object.defineProperty(eg,"__esModule",{value:!0}),eg.ConversationCommon=void 0;let n=class{constructor(t){this.privAudioConfig=t}handleCallback(t,r){if(t){try{t()}catch(i){r&&r(i)}t=void 0}}handleError(t,r){if(r)if(t instanceof Error){const i=t;r(i.name+": "+i.message)}else r(t)}};return eg.ConversationCommon=n,eg}var tg={},V_;function i4(){if(V_)return tg;V_=1,Object.defineProperty(tg,"__esModule",{value:!0}),tg.ConversationExpirationEventArgs=void 0;const n=me();let e=class extends n.SessionEventArgs{constructor(r,i){super(i),this.privExpirationTime=r}get expirationTime(){return this.privExpirationTime}};return tg.ConversationExpirationEventArgs=e,tg}var ng={},G_;function s4(){if(G_)return ng;G_=1,Object.defineProperty(ng,"__esModule",{value:!0}),ng.ConversationParticipantsChangedEventArgs=void 0;const n=me();let e=class extends n.SessionEventArgs{constructor(r,i,s){super(s),this.privReason=r,this.privParticipant=i}get reason(){return this.privReason}get participants(){return this.privParticipant}};return ng.ConversationParticipantsChangedEventArgs=e,ng}var rg={},K_;function o4(){if(K_)return rg;K_=1,Object.defineProperty(rg,"__esModule",{value:!0}),rg.ConversationTranslationCanceledEventArgs=void 0;const n=Ky();let e=class extends n.CancellationEventArgsBase{};return rg.ConversationTranslationCanceledEventArgs=e,rg}var ig={},$_;function a4(){if($_)return ig;$_=1,Object.defineProperty(ig,"__esModule",{value:!0}),ig.ConversationTranslationEventArgs=void 0;const n=me();let e=class extends n.RecognitionEventArgs{constructor(r,i,s){super(i,s),this.privResult=r}get result(){return this.privResult}};return ig.ConversationTranslationEventArgs=e,ig}var sg={},J_;function c4(){if(J_)return sg;J_=1,Object.defineProperty(sg,"__esModule",{value:!0}),sg.ConversationTranslationResult=void 0;const n=WN();let e=class extends n.TranslationRecognitionResult{constructor(r,i,s,o,a,l,u,p,f,g,m){super(i,o,a,l,u,p,void 0,void 0,f,g,m),this.privId=r,this.privOrigLang=s}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};return sg.ConversationTranslationResult=e,sg}var wA={},og={},ag={},X_;function iO(){if(X_)return ag;X_=1,Object.defineProperty(ag,"__esModule",{value:!0}),ag.StringUtils=void 0;let n=class{static formatString(t,r){if(!t)return"";if(!r)return t;let i="",s="";const o=u=>{i+=u},a=u=>{s+=u};let l=o;for(let u=0;u<t.length;u++){const p=t[u],f=u+1<t.length?t[u+1]:"";switch(p){case"{":f==="{"?(l("{"),u++):l=a;break;case"}":f==="}"?(l("}"),u++):(r.hasOwnProperty(s)&&(i+=r[s]),l=o,s="");break;default:l(p);break}}return i}};return ag.StringUtils=n,ag}var Y_;function l4(){if(Y_)return og;Y_=1,Object.defineProperty(og,"__esModule",{value:!0}),og.ConversationTranslatorConnectionFactory=void 0;const n=Pr(),e=iO(),t=et(),r=me(),i=si(),s=Sc(),o=Xo(),a=ke();let l=class sO extends o.ConnectionFactoryBase{constructor(p){super(),t.Contracts.throwIfNullOrUndefined(p,"convGetter"),this.privConvGetter=p}create(p,f,g){const m=p.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",C=this.privConvGetter().room,S=C.cognitiveSpeechRegion||p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,""),w={hostSuffix:o.ConnectionFactoryBase.getHostSuffix(S),path:sO.CTS_VIRT_MIC_PATH,region:encodeURIComponent(S)};w[s.QueryParameterNames.Language]=encodeURIComponent(p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,"")),w[s.QueryParameterNames.CtsMeetingId]=encodeURIComponent(C.roomId),w[s.QueryParameterNames.CtsDeviceId]=encodeURIComponent(C.participantId),w[s.QueryParameterNames.CtsIsParticipant]=C.isHost?"":"&"+s.QueryParameterNames.CtsIsParticipant;let b="";const R={},P={};if(m){b=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint),b||(b="wss://"+p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),b=e.StringUtils.formatString(b,w);const M=new URL(b);M.searchParams.forEach((O,L)=>{R[L]=O}),new a.TranscriberConnectionFactory().setQueryParams(R,p,b),R[s.QueryParameterNames.CtsMeetingId]=w[s.QueryParameterNames.CtsMeetingId],R[s.QueryParameterNames.CtsDeviceId]=w[s.QueryParameterNames.CtsDeviceId],C.isHost||(R[s.QueryParameterNames.CtsIsParticipant]=""),s.QueryParameterNames.Format in R||(R[s.QueryParameterNames.Format]="simple"),M.searchParams.forEach((O,L)=>{M.searchParams.set(L,R[L]),delete R[L]}),b=M.toString()}else{const M=new a.TranslationConnectionFactory;b=M.getEndpointUrl(p,!0),b=e.StringUtils.formatString(b,w),M.setQueryParams(R,p,b)}P[i.HeaderNames.ConnectionId]=g,P[n.RestConfigBase.configParams.token]=C.token,f.token&&(P[f.headerName]=f.token);const I=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return Promise.resolve(new n.WebsocketConnection(b,R,P,new a.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(p),I,g))}};return og.ConversationTranslatorConnectionFactory=l,l.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio",og}var Q_;function u4(){return Q_||(Q_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConversationTranslator=n.SpeechState=void 0;const e=ke(),t=l4(),r=Oe(),i=et(),s=me(),o=rO(),a=oP();var l;(function(f){f[f.Inactive=0]="Inactive",f[f.Connecting=1]="Connecting",f[f.Connected=2]="Connected"})(l=n.SpeechState||(n.SpeechState={}));class u extends s.TranslationRecognizer{constructor(g,m,C,S){super(g,m,new t.ConversationTranslatorConnectionFactory(S)),this.privSpeechState=l.Inactive,C&&(this.privTranslator=C,this.sessionStarted=()=>{this.privSpeechState=l.Connected},this.sessionStopped=()=>{this.privSpeechState=l.Inactive},this.recognizing=(w,b)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,b)},this.recognized=async(w,b)=>{var R;(R=b.result)!=null&&R.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(b.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,b)},this.canceled=async()=>{if(this.privSpeechState!==l.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=l.Inactive}})}get state(){return this.privSpeechState}set state(g){this.privSpeechState=g}set authentication(g){this.privReco.authentication=g}onConnection(){this.privSpeechState=l.Connected}async onCancelSpeech(){this.privSpeechState=l.Inactive,await this.cancelSpeech()}fireCancelEvent(g){try{if(this.privTranslator.canceled){const m=new a.ConversationTranslationCanceledEventArgs(s.CancellationReason.Error,g,s.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,m)}}catch{}}async cancelSpeech(){var g;try{this.stopContinuousRecognitionAsync(),await((g=this.privReco)==null?void 0:g.disconnect()),this.privSpeechState=l.Inactive}catch{}}}class p extends a.ConversationCommon{constructor(g){super(g),this.privErrors=e.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new s.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){var g;return(g=this.privConversation)==null?void 0:g.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===l.Connected||this.privCTRecognizer.state===l.Connecting||this.privConversation.isMutedByHost)}onToken(g){this.privCTRecognizer.authentication=g}setServiceProperty(g,m){const C=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));C[g]=m,this.privProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(C))}joinConversationAsync(g,m,C,S,w){try{if(typeof g=="string"){i.Contracts.throwIfNullOrUndefined(g,this.privErrors.invalidArgs.replace("{arg}","conversation id")),i.Contracts.throwIfNullOrWhitespace(m,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),w);let b=C;(b==null||b==="")&&(b=e.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=s.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(s.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(b),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage],b),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.ConversationTranslator_Name],m);const R=[s.PropertyId.SpeechServiceConnection_Host,s.PropertyId.ConversationTranslator_Host,s.PropertyId.SpeechServiceConnection_Endpoint,s.PropertyId.SpeechServiceConnection_ProxyHostName,s.PropertyId.SpeechServiceConnection_ProxyPassword,s.PropertyId.SpeechServiceConnection_ProxyPort,s.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const I of R){const M=this.privProperties.getProperty(I);if(M){const k=typeof I=="string"?I:s.PropertyId[I];this.privSpeechTranslationConfig.setProperty(k,M)}}const P=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));for(const I of Object.keys(P))this.privSpeechTranslationConfig.setServiceProperty(I,P[I],s.ServicePropertyChannel.UriQueryParameter);this.privConversation=new o.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(g,m,b,(I=>{I||this.handleError(new Error(this.privErrors.permissionDeniedConnect),w),this.privSpeechTranslationConfig.authorizationToken=I,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync((()=>{this.handleCallback(S,w)}),(M=>{this.handleError(M,w)}))}),(I=>{this.handleError(I,w)}))}else typeof g=="object"?(i.Contracts.throwIfNullOrUndefined(g,this.privErrors.invalidArgs.replace("{arg}","conversation id")),i.Contracts.throwIfNullOrWhitespace(m,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(s.PropertyId.ConversationTranslator_Name,m),this.privConversation=g,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),i.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=g.config,this.handleCallback(C,S)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),S)}catch(b){this.handleError(b,typeof C=="string"?w:S)}}leaveConversationAsync(g,m){(0,r.marshalPromiseToCallbacks)((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),g,m)}sendTextMessageAsync(g,m,C){try{i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrWhitespace(g,this.privErrors.invalidArgs.replace("{arg}",g)),this.privConversation.sendTextMessageAsync(g,m,C)}catch(S){this.handleError(S,C)}}startTranscribingAsync(g,m){(0,r.marshalPromiseToCallbacks)((async()=>{try{i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),i.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),m),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(C){throw this.privIsSpeaking=!1,await this.cancelSpeech(),C}})(),g,m)}stopTranscribingAsync(g,m){(0,r.marshalPromiseToCallbacks)((async()=>{try{if(!this.privIsSpeaking){await this.cancelSpeech();return}this.privIsSpeaking=!1,await new Promise((C,S)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(C,S)})}catch{await this.cancelSpeech()}})(),g,m)}isDisposed(){return this.privIsDisposed}dispose(g,m,C){(0,r.marshalPromiseToCallbacks)((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),m,C)}async cancelSpeech(){var g;try{this.privIsSpeaking=!1,await((g=this.privCTRecognizer)==null?void 0:g.onCancelSpeech()),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=s.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key],"");const g=()=>this.privConversation;this.privCTRecognizer=new u(this.privSpeechTranslationConfig,this.privAudioConfig,this,g)}catch(g){throw await this.cancelSpeech(),g}}startContinuousRecognition(){return new Promise((g,m)=>{this.privCTRecognizer.startContinuousRecognitionAsync(g,m)})}}n.ConversationTranslator=p})(wA)),wA}var cg={},Z_;function d4(){if(Z_)return cg;Z_=1,Object.defineProperty(cg,"__esModule",{value:!0}),cg.ConversationTranscriber=void 0;const n=ke(),e=rs(),t=Oe(),r=et(),i=me();let s=class oO extends i.Recognizer{constructor(a,l){const u=a;r.Contracts.throwIfNull(u,"speechConfig"),r.Contracts.throwIfNullOrWhitespace(u.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),super(l,u.properties,new n.ConversationTranscriberConnectionFactory,a.tokenCredential),this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(a,l,u){const p=a;return l.properties.mergeTo(p.properties),new oO(a,u)}get endpointId(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){r.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,a)}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple])===i.OutputFormat[i.OutputFormat.Simple]?i.OutputFormat.Simple:i.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(e.RecognitionMode.Conversation),a,l)}stopTranscribingAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),a,l)}close(a,l){r.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),a,l)}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new n.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,l,u,p){const f=u;return p.isSpeakerDiarizationEnabled=!0,new n.ConversationTranscriptionServiceRecognizer(a,l,f,p,this)}};return cg.ConversationTranscriber=s,cg}var Kc={},ek;function h4(){if(ek)return Kc;ek=1,Object.defineProperty(Kc,"__esModule",{value:!0}),Kc.Participant=Kc.User=void 0;const n=me();class e{constructor(i){this.privUserId=i}get userId(){return this.privUserId}}Kc.User=e;class t{constructor(i,s,o,a,l,u,p,f){this.privId=i,this.privAvatar=s,this.privDisplayName=o,this.privIsHost=a,this.privIsMuted=l,this.privIsUsingTts=u,this.privPreferredLanguage=p,this.privVoice=f,this.privProperties=new n.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(i,s,o){return new t(i,"",i,!1,!1,!1,s,o)}}return Kc.Participant=t,Kc}var AA={},tk;function p4(){return tk||(tk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ParticipantChangedReason=void 0,(function(e){e[e.JoinedConversation=0]="JoinedConversation",e[e.LeftConversation=1]="LeftConversation",e[e.Updated=2]="Updated"})(n.ParticipantChangedReason||(n.ParticipantChangedReason={}))})(AA)),AA}var $c={},nk;function f4(){if(nk)return $c;nk=1,Object.defineProperty($c,"__esModule",{value:!0}),$c.MeetingImpl=$c.Meeting=void 0;const n=ke(),e=Oe(),t=et(),r=me();let i=class{constructor(){}static createMeetingAsync(a,l,u,p){if(t.Contracts.throwIfNullOrUndefined(a,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrUndefined(a.region,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),t.Contracts.throwIfNull(l,"meetingId"),l.length===0)throw new Error("meetingId cannot be empty");!a.subscriptionKey&&!a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceAuthorization_Token])&&t.Contracts.throwIfNullOrUndefined(a.subscriptionKey,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const f=new s(a,l);return(0,e.marshalPromiseToCallbacks)((async()=>{})(),u,p),f}};$c.Meeting=i;class s extends i{constructor(a,l){super(),this.privErrors=n.ConversationConnectionConfig.restErrors,this.onConnected=f=>{var g;this.privIsConnected=!0;try{(g=this.privConversationTranslator)!=null&&g.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,f)}catch{}},this.onDisconnected=f=>{var g;try{(g=this.privConversationTranslator)!=null&&g.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,f)}catch{}finally{this.close(!1)}},this.onCanceled=(f,g)=>{var m;try{(m=this.privConversationTranslator)!=null&&m.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,g)}catch{}},this.onParticipantUpdateCommandReceived=(f,g)=>{try{const m=this.privParticipants.getParticipant(g.id);if(m!==void 0){switch(g.key){case n.ConversationTranslatorCommandTypes.changeNickname:m.displayName=g.value;break;case n.ConversationTranslatorCommandTypes.setUseTTS:m.isUsingTts=g.value;break;case n.ConversationTranslatorCommandTypes.setProfanityFiltering:m.profanity=g.value;break;case n.ConversationTranslatorCommandTypes.setMute:m.isMuted=g.value;break;case n.ConversationTranslatorCommandTypes.setTranslateToLanguages:m.translateToLanguages=g.value;break}this.privParticipants.addOrUpdateParticipant(m),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.Updated,[this.toParticipant(m)],g.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(f,g)=>{try{this.privParticipants.participants.forEach(m=>m.isMuted=m.isHost?!1:g.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.Updated,this.toParticipants(!1),g.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(f,g)=>{try{const m=this.privParticipants.addOrUpdateParticipant(g.participant);m!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.JoinedConversation,[this.toParticipant(m)],g.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(f,g)=>{try{const m=this.privParticipants.getParticipant(g.participant.id);m!==void 0&&(this.privParticipants.deleteParticipant(g.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.LeftConversation,[this.toParticipant(m)],g.sessionId)))}catch{}},this.onTranslationReceived=(f,g)=>{try{switch(g.command){case n.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new r.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case n.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new r.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case n.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new r.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break}}catch{}},this.onParticipantsListReceived=(f,g)=>{var m;try{if(g.sessionToken!==void 0&&g.sessionToken!==null&&(this.privRoom.token=g.sessionToken),this.privParticipants.participants=[...g.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),g.sessionId)),this.me.isHost){const C=(m=this.privConversationTranslator)==null?void 0:m.properties.getProperty(r.PropertyId.ConversationTranslator_Name);C!==void 0&&C.length>0&&C!==this.me.displayName&&this.changeNicknameAsync(C)}}catch{}},this.onConversationExpiration=(f,g)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,g)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new r.PropertyCollection,this.privManager=new n.ConversationManager,a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage])||a.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage],n.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=l,this.privConfig=a;const p=a;t.Contracts.throwIfNull(p,"speechConfig"),this.privProperties=p.properties.clone(),this.privIsConnected=!1,this.privParticipants=new n.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var a,l;return(a=this.privParticipants.me)!=null&&a.isHost?!1:(l=this.privParticipants.me)==null?void 0:l.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const a=this.meetingId,l=this.participants.map(f=>({id:f.id,preferredLanguage:f.preferredLanguage,voice:f.voice})),u={};for(const f of n.ConversationConnectionConfig.transcriptionEventKeys){const g=this.properties.getProperty(f,"");g!==""&&(u[f]=g)}return{id:a,participants:l,meetingProperties:u}}get canSend(){var a;return this.privIsConnected&&!((a=this.privParticipants.me)!=null&&a.isMuted)}get canSendAsHost(){var a;return this.privIsConnected&&((a=this.privParticipants.me)==null?void 0:a.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),this.privToken=a}createMeetingAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),this.privManager.createOrJoin(this.privProperties,void 0,(u=>{u||this.handleError(new Error(this.privErrors.permissionDeniedConnect),l),this.privRoom=u,this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}startMeetingAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}addParticipantAsync(a,l,u){t.Contracts.throwIfNullOrUndefined(a,"Participant"),(0,e.marshalPromiseToCallbacks)(this.addParticipantImplAsync(a),l,u)}joinMeetingAsync(a,l,u,p,f){try{t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","conversationId")),t.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,a,(g=>{t.Contracts.throwIfNullOrUndefined(g,this.privErrors.permissionDeniedConnect),this.privRoom=g,this.privConfig.authorizationToken=g.cognitiveSpeechAuthToken,p&&p(g.cognitiveSpeechAuthToken)}),(g=>{this.handleError(g,f)}))}catch(g){this.handleError(g,f)}}deleteMeetingAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.deleteMeetingImplAsync(),a,l)}async deleteMeetingImplAsync(){t.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),t.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.endMeetingImplAsync(),a,l)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}muteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}muteParticipantAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!0),(()=>{this.handleCallback(l,u)}),(f=>{this.handleError(f,u)}))}catch(p){this.handleError(p,u)}}removeParticipantAsync(a,l,u){try{if(t.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&a.hasOwnProperty("id"))(0,e.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(a),l,u);else{t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),u);let p="";typeof a=="string"?p=a:a.hasOwnProperty("id")?p=a.id:a.hasOwnProperty("userId")&&(p=a.userId),t.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(g=>g.id===p)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(p),(()=>{this.handleCallback(l,u)}),(g=>{this.handleError(g,u)}))}}catch(p){this.handleError(p,u)}}unlockMeetingAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}unmuteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}unmuteParticipantAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!1),(()=>{this.handleCallback(l,u)}),(f=>{this.handleError(f,u)}))}catch(p){this.handleError(p,u)}}sendTextMessageAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","message")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),a.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(a),(()=>{this.handleCallback(l,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}setTranslatedLanguagesAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfArrayEmptyOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","languages")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(a),(()=>{this.handleCallback(l,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}changeNicknameAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(a),(()=>{this.handleCallback(l,u)}),(p=>{this.handleError(p,u)}))}catch(p){this.handleError(p,u)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(a){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await a.enforceAudioGating(),this.privTranscriberRecognizer=a,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){const a=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:a,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(a){if(this.privParticipants.addOrUpdateParticipant(a)!==void 0&&this.privTranscriberRecognizer){const u=this.meetingInfo;return u.participants=[a],this.privTranscriberRecognizer.pushMeetingEvent(u,"join")}}removeParticipantImplAsync(a){this.privParticipants.deleteParticipant(a.id);const l=this.meetingInfo;return l.participants=[a],this.privTranscriberRecognizer.pushMeetingEvent(l,"leave")}async close(a){var l;try{this.privIsConnected=!1,await((l=this.privConversationRecognizer)==null?void 0:l.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(u){throw u}a&&this.dispose()}handleCallback(a,l){if(a){try{a()}catch(u){l&&l(u)}a=void 0}}handleError(a,l){if(l)if(a instanceof Error){const u=a;l(u.name+": "+u.message)}else l(a)}toParticipants(a){const l=this.privParticipants.participants.map(u=>this.toParticipant(u));return a?l:l.filter(u=>u.isHost===!1)}toParticipant(a){return new r.Participant(a.id,a.avatar,a.displayName,a.isHost,a.isMuted,a.isUsingTts,a.preferredLanguage,a.voice)}getMuteAllCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMuteCommand(a,l){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setMute,participantId:a,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:l})}getLockCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getEjectCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.ejectParticipant,participantId:a,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getChangeNicknameCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(a,"nickname"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.changeNickname,nickname:a,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMessageCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),t.Contracts.throwIfNullOrWhitespace(a,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:a,type:n.ConversationTranslatorMessageTypes.instantMessage})}}return $c.MeetingImpl=s,$c}var lg={},rk;function g4(){if(rk)return lg;rk=1,Object.defineProperty(lg,"__esModule",{value:!0}),lg.MeetingTranscriptionCanceledEventArgs=void 0;const n=Ky();class e extends n.CancellationEventArgsBase{}return lg.MeetingTranscriptionCanceledEventArgs=e,lg}var ug={},ik;function v4(){if(ik)return ug;ik=1,Object.defineProperty(ug,"__esModule",{value:!0}),ug.MeetingTranscriber=void 0;const n=ke(),e=Oe(),t=et(),r=me(),i=oP();let s=class{constructor(a){this.privAudioConfig=a,this.privProperties=new r.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return t.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return r.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a)}joinMeetingAsync(a,l,u){const p=a;t.Contracts.throwIfNullOrUndefined(i.MeetingImpl,"Meeting"),this.privRecognizer=new n.TranscriberRecognizer(a.config,this.privAudioConfig),t.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),(0,e.marshalPromiseToCallbacks)(p.connectTranscriberRecognizer(this.privRecognizer),l,u)}startTranscribingAsync(a,l){this.privRecognizer.startContinuousRecognitionAsync(a,l)}stopTranscribingAsync(a,l){this.privRecognizer.stopContinuousRecognitionAsync(a,l)}leaveMeetingAsync(a,l){this.privRecognizer.disconnectCallbacks(),(0,e.marshalPromiseToCallbacks)((async()=>{})(),a,l)}close(a,l){t.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),a,l)}async dispose(a){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),a&&(this.privDisposedRecognizer=!0))}};return ug.MeetingTranscriber=s,ug}var dg={},sk;function m4(){if(sk)return dg;sk=1,Object.defineProperty(dg,"__esModule",{value:!0}),dg.ConversationTranscriptionResult=void 0;const n=me();let e=class extends n.RecognitionResult{constructor(r,i,s,o,a,l,u,p,f,g,m){super(r,i,s,o,a,l,u,f,g,m),this.privSpeakerId=p}get speakerId(){return this.privSpeakerId}};return dg.ConversationTranscriptionResult=e,dg}var ok;function oP(){return ok||(ok=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConversationTranscriptionResult=n.MeetingTranscriber=n.MeetingTranscriptionCanceledEventArgs=n.MeetingImpl=n.Meeting=n.ParticipantChangedReason=n.User=n.Participant=n.ConversationTranscriber=n.ConversationTranslator=n.ConversationTranslationResult=n.ConversationTranslationEventArgs=n.ConversationTranslationCanceledEventArgs=n.ConversationParticipantsChangedEventArgs=n.ConversationExpirationEventArgs=n.ConversationCommon=n.ConversationImpl=n.Conversation=void 0;var e=rO();Object.defineProperty(n,"Conversation",{enumerable:!0,get:function(){return e.Conversation}}),Object.defineProperty(n,"ConversationImpl",{enumerable:!0,get:function(){return e.ConversationImpl}});var t=r4();Object.defineProperty(n,"ConversationCommon",{enumerable:!0,get:function(){return t.ConversationCommon}});var r=i4();Object.defineProperty(n,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return r.ConversationExpirationEventArgs}});var i=s4();Object.defineProperty(n,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return i.ConversationParticipantsChangedEventArgs}});var s=o4();Object.defineProperty(n,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return s.ConversationTranslationCanceledEventArgs}});var o=a4();Object.defineProperty(n,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return o.ConversationTranslationEventArgs}});var a=c4();Object.defineProperty(n,"ConversationTranslationResult",{enumerable:!0,get:function(){return a.ConversationTranslationResult}});var l=u4();Object.defineProperty(n,"ConversationTranslator",{enumerable:!0,get:function(){return l.ConversationTranslator}});var u=d4();Object.defineProperty(n,"ConversationTranscriber",{enumerable:!0,get:function(){return u.ConversationTranscriber}});var p=h4();Object.defineProperty(n,"Participant",{enumerable:!0,get:function(){return p.Participant}}),Object.defineProperty(n,"User",{enumerable:!0,get:function(){return p.User}});var f=p4();Object.defineProperty(n,"ParticipantChangedReason",{enumerable:!0,get:function(){return f.ParticipantChangedReason}});var g=f4();Object.defineProperty(n,"Meeting",{enumerable:!0,get:function(){return g.Meeting}}),Object.defineProperty(n,"MeetingImpl",{enumerable:!0,get:function(){return g.MeetingImpl}});var m=g4();Object.defineProperty(n,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return m.MeetingTranscriptionCanceledEventArgs}});var C=v4();Object.defineProperty(n,"MeetingTranscriber",{enumerable:!0,get:function(){return C.MeetingTranscriber}});var S=m4();Object.defineProperty(n,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return S.ConversationTranscriptionResult}})})(bA)),bA}var Jc={},ak;function aP(){if(ak)return Jc;ak=1,Object.defineProperty(Jc,"__esModule",{value:!0}),Jc.SynthesisRequest=Jc.Synthesizer=void 0;const n=ke(),e=Oe(),t=et(),r=me();let i=class aO{constructor(a){const l=a;t.Contracts.throwIfNull(l,"speechConfig"),this.privProperties=l.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new e.Queue,this.tokenCredential=a.tokenCredential}get authorizationToken(){return this.properties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===n.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(a){const l={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let u=this.properties.getProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),p=this.properties.getProperty(r.PropertyId.SpeechServiceConnection_SynthVoice,""),f=aO.XMLEncode(a);return this.autoDetectSourceLanguage?u="en-US":p=p||l[u],p&&(f=`<voice name='${p}'>${f}</voice>`),f=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${u}'>${f}</speak>`,f}async dispose(a){this.privDisposed||(a&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const a=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(a.text,a.isSSML,a.requestId,a.cb,a.err,a.dataStream)}}createSynthesizerConfig(a){return new n.SynthesizerConfig(a,this.privProperties)}implCommonSynthesizeSetup(){let a=typeof window<"u"?"Browser":"Node",l="unknown",u="unknown";typeof navigator<"u"&&(a=a+"/"+navigator.platform,l=navigator.userAgent,u=navigator.appVersion);const p=this.createSynthesizerConfig(new n.SpeechServiceConfig(new n.Context(new n.OS(a,l,u)))),f=this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Key,void 0),g=f&&f!==""?new n.CognitiveSubscriptionKeyAuthentication(f):this.tokenCredential?new n.CognitiveTokenAuthentication(async()=>{try{const m=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(m==null?void 0:m.token)??""}catch(m){throw m}},async()=>{try{const m=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(m==null?void 0:m.token)??""}catch(m){throw m}}):new n.CognitiveTokenAuthentication(()=>{const m=this.privProperties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(m)},()=>{const m=this.privProperties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(m)});this.privAdapter=this.createSynthesisAdapter(g,this.privConnectionFactory,p),this.privRestAdapter=this.createRestSynthesisAdapter(g,p)}static XMLEncode(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};Jc.Synthesizer=i;class s{constructor(a,l,u,p,f,g){this.requestId=a,this.text=l,this.isSSML=u,this.cb=p,this.err=f,this.dataStream=g}}return Jc.SynthesisRequest=s,Jc}var hg={},ck;function y4(){if(ck)return hg;ck=1,Object.defineProperty(hg,"__esModule",{value:!0}),hg.SpeechSynthesizer=void 0;const n=ke(),e=Oe(),t=zN(),r=Gy(),i=Vh(),s=et(),o=me(),a=aP();let l=class cO extends o.Synthesizer{constructor(p,f){super(p),f!==null&&(f===void 0?this.audioConfig=typeof window>"u"?void 0:o.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=f),this.privConnectionFactory=new n.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(p,f,g){const m=p;return f.properties.mergeTo(m.properties),new cO(p,g)}speakTextAsync(p,f,g,m){this.speakImpl(p,!1,f,g,m)}speakSsmlAsync(p,f,g,m){this.speakImpl(p,!0,f,g,m)}async getVoicesAsync(p=""){return this.getVoices(p)}close(p,f){s.Contracts.throwIfDisposed(this.privDisposed),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),p,f)}get internalData(){return this.privAdapter}createSynthesisAdapter(p,f,g){return new n.SpeechSynthesisAdapter(p,f,g,this,this.audioConfig)}createRestSynthesisAdapter(p,f){return new n.SynthesisRestAdapter(f,p)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=r.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(o.SpeechSynthesisOutputFormat[this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(p,f,g,m,C){try{s.Contracts.throwIfDisposed(this.privDisposed);const S=(0,e.createNoDashGuid)();let w;C instanceof o.PushAudioOutputStreamCallback?w=new i.PushAudioOutputStreamImpl(C):C instanceof o.PullAudioOutputStream?w=C:C!==void 0?w=new t.AudioFileWriter(C):w=void 0,this.synthesisRequestQueue.enqueue(new a.SynthesisRequest(S,p,f,b=>{if(this.privSynthesizing=!1,g)try{g(b)}catch(R){m&&m(R)}g=void 0,this.adapterSpeak().catch(()=>{})},b=>{m&&m(b)},w)),this.adapterSpeak().catch(()=>{})}catch(S){if(m)if(S instanceof Error){const w=S;m(w.name+": "+w.message)}else m(S);this.dispose(!0).catch(()=>{})}}async getVoices(p){const f=(0,e.createNoDashGuid)(),g=await this.privRestAdapter.getVoicesList(f);if(g.ok&&Array.isArray(g.json)){let m=g.json;return p&&p.length>0&&(m=m.filter(C=>!!C.Locale&&C.Locale.toLowerCase()===p.toLowerCase())),new o.SynthesisVoicesResult(f,m,void 0)}else return new o.SynthesisVoicesResult(f,void 0,`Error: ${g.status}: ${g.statusText}`)}};return hg.SpeechSynthesizer=l,hg}var pg={},lk;function S4(){if(lk)return pg;lk=1,Object.defineProperty(pg,"__esModule",{value:!0}),pg.SynthesisResult=void 0;let n=class{constructor(t,r,i,s){this.privResultId=t,this.privReason=r,this.privErrorDetails=i,this.privProperties=s}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};return pg.SynthesisResult=n,pg}var fg={},uk;function C4(){if(uk)return fg;uk=1,Object.defineProperty(fg,"__esModule",{value:!0}),fg.SpeechSynthesisResult=void 0;const n=me();let e=class extends n.SynthesisResult{constructor(r,i,s,o,a,l){super(r,i,o,a),this.privAudioData=s,this.privAudioDuration=l}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};return fg.SpeechSynthesisResult=e,fg}var gg={},dk;function b4(){if(dk)return gg;dk=1,Object.defineProperty(gg,"__esModule",{value:!0}),gg.SpeechSynthesisEventArgs=void 0;let n=class{constructor(t){this.privResult=t}get result(){return this.privResult}};return gg.SpeechSynthesisEventArgs=n,gg}var vg={},hk;function w4(){if(hk)return vg;hk=1,Object.defineProperty(vg,"__esModule",{value:!0}),vg.SpeechSynthesisWordBoundaryEventArgs=void 0;let n=class{constructor(t,r,i,s,o,a){this.privAudioOffset=t,this.privDuration=r,this.privText=i,this.privWordLength=s,this.privTextOffset=o,this.privBoundaryType=a}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};return vg.SpeechSynthesisWordBoundaryEventArgs=n,vg}var mg={},pk;function A4(){if(pk)return mg;pk=1,Object.defineProperty(mg,"__esModule",{value:!0}),mg.SpeechSynthesisBookmarkEventArgs=void 0;let n=class{constructor(t,r){this.privAudioOffset=t,this.privText=r}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};return mg.SpeechSynthesisBookmarkEventArgs=n,mg}var yg={},fk;function E4(){if(fk)return yg;fk=1,Object.defineProperty(yg,"__esModule",{value:!0}),yg.SpeechSynthesisVisemeEventArgs=void 0;let n=class{constructor(t,r,i){this.privAudioOffset=t,this.privVisemeId=r,this.privAnimation=i}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};return yg.SpeechSynthesisVisemeEventArgs=n,yg}var EA={},gk;function R4(){return gk||(gk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SpeechSynthesisBoundaryType=void 0,(function(e){e.Word="WordBoundary",e.Punctuation="PunctuationBoundary",e.Sentence="SentenceBoundary"})(n.SpeechSynthesisBoundaryType||(n.SpeechSynthesisBoundaryType={}))})(EA)),EA}var Sg={},vk;function P4(){if(vk)return Sg;vk=1,Object.defineProperty(Sg,"__esModule",{value:!0}),Sg.SynthesisVoicesResult=void 0;const n=me();let e=class extends n.SynthesisResult{constructor(r,i,s){if(Array.isArray(i)){super(r,n.ResultReason.VoicesListRetrieved,void 0,new n.PropertyCollection),this.privVoices=[];for(const o of i)this.privVoices.push(new n.VoiceInfo(o))}else super(r,n.ResultReason.Canceled,s||"Error information unavailable",new n.PropertyCollection)}get voices(){return this.privVoices}};return Sg.SynthesisVoicesResult=e,Sg}var RA={},mk;function T4(){return mk||(mk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.VoiceInfo=n.SynthesisVoiceType=n.SynthesisVoiceGender=void 0;var e;(function(o){o[o.Unknown=0]="Unknown",o[o.Female=1]="Female",o[o.Male=2]="Male",o[o.Neutral=3]="Neutral"})(e=n.SynthesisVoiceGender||(n.SynthesisVoiceGender={}));var t;(function(o){o[o.Unknown=0]="Unknown",o[o.OnlineNeural=1]="OnlineNeural",o[o.OnlineStandard=2]="OnlineStandard",o[o.OfflineNeural=3]="OfflineNeural",o[o.OfflineStandard=4]="OfflineStandard",o[o.OnlineNeuralHD=5]="OnlineNeuralHD"})(t=n.SynthesisVoiceType||(n.SynthesisVoiceType={}));const r={[e[e.Neutral]]:e.Neutral,[e[e.Male]]:e.Male,[e[e.Female]]:e.Female},i={Neural:t.OnlineNeural,NeuralHD:t.OnlineNeuralHD};class s{constructor(a){if(this.privStyleList=[],a){if(this.privName=a.Name,this.privLocale=a.Locale,this.privShortName=a.ShortName,this.privLocaleName=a.LocaleName,this.privDisplayName=a.DisplayName,this.privLocalName=a.LocalName,this.privVoiceType=i[a.VoiceType]||t.Unknown,this.privGender=r[a.Gender]||e.Unknown,a.StyleList&&Array.isArray(a.StyleList))for(const l of a.StyleList)this.privStyleList.push(l);this.privSampleRateHertz=a.SampleRateHertz,this.privStatus=a.Status,a.ExtendedPropertyMap&&(this.privExtendedPropertyMap=a.ExtendedPropertyMap),this.privWordsPerMinute=a.WordsPerMinute,Array.isArray(a.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...a.SecondaryLocaleList]),Array.isArray(a.RolePlayList)&&(this.privRolePlayList=[...a.RolePlayList]),a.VoiceTag&&(this.privVoiceTag=a.VoiceTag)}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}get voiceTag(){return this.privVoiceTag}}n.VoiceInfo=s})(RA)),RA}var Cg={},yk;function x4(){if(yk)return Cg;yk=1,Object.defineProperty(Cg,"__esModule",{value:!0}),Cg.SpeakerAudioDestination=void 0;const n=Oe(),e=Vh(),t=Tu(),r=1800,i={[t.AudioFormatTag.PCM]:"audio/wav",[t.AudioFormatTag.MuLaw]:"audio/x-wav",[t.AudioFormatTag.MP3]:"audio/mpeg",[t.AudioFormatTag.OGG_OPUS]:"audio/ogg",[t.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[t.AudioFormatTag.ALaw]:"audio/x-wav",[t.AudioFormatTag.FLAC]:"audio/flac",[t.AudioFormatTag.AMR_WB]:"audio/amr-wb",[t.AudioFormatTag.G722]:"audio/G722"};let s=class{constructor(a){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=a||(0,n.createNoDashGuid)(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(a,l,u){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(a),this.updateSourceBuffer().then(()=>{l&&l()},p=>{u&&u(p)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(a),this.privBytesReceived+=a.byteLength)}close(a,l){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{a&&a()},u=>{l&&l(u)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===t.AudioFormatTag.PCM||this.privFormat.formatTag===t.AudioFormatTag.MuLaw||this.privFormat.formatTag===t.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let u=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(u).then(()=>{u=this.privFormat.addHeader(u);const p=new Blob([u],{type:i[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(p),this.notifyPlayback().then(()=>{a&&a()},f=>{l&&l(f)})},p=>{l&&l(p)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(a){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=a;const l=i[this.privFormat.formatTag];l===void 0?console.warn(`Unknown mimeType for format ${t.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(l)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=r,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(l),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(u=>{n.Events.instance.onEvent(new n.BackgroundEvent(u))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(u=>{n.Events.instance.onEvent(new n.BackgroundEvent(u))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(u=>{n.Events.instance.onEvent(new n.BackgroundEvent(u))})):(console.warn(`Format ${t.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new e.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var a;return((a=this.privAudio)==null?void 0:a.volume)??-1}set volume(a){this.privAudio&&(this.privAudio.volume=a)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(a,l){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{a&&a()},u=>{l&&l(u)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const a=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(a)}catch{this.privAudioBuffer.unshift(a),console.log("buffer filled, pausing addition of binaries until space is made");return}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};return Cg.SpeakerAudioDestination=s,Cg}var bg={},Sk;function I4(){if(Sk)return bg;Sk=1,Object.defineProperty(bg,"__esModule",{value:!0}),bg.ConversationTranscriptionCanceledEventArgs=void 0;const n=Ky();let e=class extends n.CancellationEventArgsBase{};return bg.ConversationTranscriptionCanceledEventArgs=e,bg}var wg={},Ck;function _4(){if(Ck)return wg;Ck=1,Object.defineProperty(wg,"__esModule",{value:!0}),wg.MeetingTranscriptionCanceledEventArgs=void 0;const n=Ky();let e=class extends n.CancellationEventArgsBase{};return wg.MeetingTranscriptionCanceledEventArgs=e,wg}var PA={},bk;function k4(){return bk||(bk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.PronunciationAssessmentGradingSystem=void 0,(function(e){e[e.FivePoint=1]="FivePoint",e[e.HundredMark=2]="HundredMark"})(n.PronunciationAssessmentGradingSystem||(n.PronunciationAssessmentGradingSystem={}))})(PA)),PA}var TA={},wk;function M4(){return wk||(wk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.PronunciationAssessmentGranularity=void 0,(function(e){e[e.Phoneme=1]="Phoneme",e[e.Word=2]="Word",e[e.FullText=3]="FullText"})(n.PronunciationAssessmentGranularity||(n.PronunciationAssessmentGranularity={}))})(TA)),TA}var Ag={},Ak;function D4(){if(Ak)return Ag;Ak=1,Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.PronunciationAssessmentConfig=void 0;const n=et(),e=me();let t=class lO{constructor(i,s=e.PronunciationAssessmentGradingSystem.FivePoint,o=e.PronunciationAssessmentGranularity.Phoneme,a=!1){n.Contracts.throwIfNullOrUndefined(i,"referenceText"),this.privProperties=new e.PropertyCollection,this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_ReferenceText,i),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_GradingSystem,e.PronunciationAssessmentGradingSystem[s]),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_Granularity,e.PronunciationAssessmentGranularity[o]),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,String(a))}static fromJSON(i){n.Contracts.throwIfNullOrUndefined(i,"json");const s=new lO("");return s.privProperties=new e.PropertyCollection,s.properties.setProperty(e.PropertyId.PronunciationAssessment_Json,i),s}toJSON(){return this.updateJson(),this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Params)}applyTo(i){this.updateJson();const s=i.internalData;s.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(e.PropertyId.PronunciationAssessment_Params),s.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(e.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(i){n.Contracts.throwIfNullOrWhitespace(i,"referenceText"),this.properties.setProperty(e.PropertyId.PronunciationAssessment_ReferenceText,i)}set phonemeAlphabet(i){n.Contracts.throwIfNullOrWhitespace(i,"phonemeAlphabet"),this.privPhonemeAlphabet=i}set enableMiscue(i){const s=i?"true":"false";this.properties.setProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,s)}get enableMiscue(){return this.properties.getProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(i){this.privNBestPhonemeCount=i}set enableProsodyAssessment(i){this.privEnableProsodyAssessment=i}get properties(){return this.privProperties}updateJson(){const i=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Json,"{}"),s=JSON.parse(i),o=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_ReferenceText);o&&(s.referenceText=o);const a=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_GradingSystem);a&&(s.gradingSystem=a);const l=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Granularity);l&&(s.granularity=l),this.privPhonemeAlphabet&&(s.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(s.nbestPhonemeCount=this.privNBestPhonemeCount),s.enableProsodyAssessment=this.privEnableProsodyAssessment,s.dimension="Comprehensive",this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_EnableMiscue)&&(s.enableMiscue=this.enableMiscue),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_Params,JSON.stringify(s))}};return Ag.PronunciationAssessmentConfig=t,Ag}var Eg={},Ek;function N4(){if(Ek)return Eg;Ek=1,Object.defineProperty(Eg,"__esModule",{value:!0}),Eg.PronunciationAssessmentResult=void 0;const n=et(),e=me();let t=class uO{constructor(i){const s=JSON.parse(i);n.Contracts.throwIfNullOrUndefined(s.NBest[0],"NBest"),this.privPronJson=s.NBest[0]}static fromResult(i){n.Contracts.throwIfNullOrUndefined(i,"result");const s=i.properties.getProperty(e.PropertyId.SpeechServiceResponse_JsonResult);return n.Contracts.throwIfNullOrUndefined(s,"json"),new uO(s)}get detailResult(){return this.privPronJson}get accuracyScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.AccuracyScore}get pronunciationScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.PronScore}get completenessScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.CompletenessScore}get fluencyScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.FluencyScore}get prosodyScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.ProsodyScore}};return Eg.PronunciationAssessmentResult=t,Eg}var Rg={},Rk;function O4(){if(Rk)return Rg;Rk=1,Object.defineProperty(Rg,"__esModule",{value:!0}),Rg.AvatarConfig=void 0;const n=et(),e=me();let t=class{constructor(i,s,o){this.privCustomized=!1,this.privUseBuiltInVoice=!1,n.Contracts.throwIfNullOrWhitespace(i,"character"),this.character=i,this.style=s,o===void 0&&(o=new e.AvatarVideoFormat),this.videoFormat=o}get customized(){return this.privCustomized}set customized(i){this.privCustomized=i}get useBuiltInVoice(){return this.privUseBuiltInVoice}set useBuiltInVoice(i){this.privUseBuiltInVoice=i}get photoAvatarBaseModel(){return this.privPhotoAvatarBaseModel}set photoAvatarBaseModel(i){this.privPhotoAvatarBaseModel=i}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(i){this.privBackgroundColor=i}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(i){this.privBackgroundImage=i}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(i){this.privRemoteIceServers=i}};return Rg.AvatarConfig=t,Rg}var xA={},Pk;function L4(){return Pk||(Pk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.AvatarEventArgs=n.AvatarEventTypes=void 0,(function(t){t.SwitchedToSpeaking="SwitchedToSpeaking",t.SwitchedToIdle="SwitchedToIdle",t.SessionClosed="SessionClosed"})(n.AvatarEventTypes||(n.AvatarEventTypes={}));class e{constructor(r,i){this.privOffset=r,this.privDescription=i}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}n.AvatarEventArgs=e})(xA)),xA}var Pg={},Tg={},Tk;function dO(){if(Tk)return Tg;Tk=1,Object.defineProperty(Tg,"__esModule",{value:!0}),Tg.SpeechSynthesisConnectionFactory=void 0;const n=Pr(),e=me(),t=Xo(),r=ke(),i=si(),s=Sc();let o=class{constructor(){this.synthesisUri="/tts/cognitiveservices/websocket/v1"}async create(l,u,p){let f=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const g=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,void 0),m=t.ConnectionFactoryBase.getHostSuffix(g),C=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),S=C===void 0?"tts":"voice",w=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,"wss://"+g+"."+S+".speech"+m),b={},R={};if(u.token!==void 0&&u.token!==""&&(R[u.headerName]=u.token),R[i.HeaderNames.ConnectionId]=p,C!==void 0&&C!==""&&(!f||f.search(s.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(b[s.QueryParameterNames.CustomVoiceDeploymentId]=C),l.avatarEnabled&&(!f||f.search(s.QueryParameterNames.EnableAvatar)===-1)&&(b[s.QueryParameterNames.EnableAvatar]="true"),f){const I=new URL(f),M=I.pathname;(M===""||M==="/")&&(I.pathname=this.synthesisUri,f=await t.ConnectionFactoryBase.getRedirectUrlFromEndpoint(I.toString()))}f||(f=w+this.synthesisUri),l.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,f);const P=l.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new n.WebsocketConnection(f,b,R,new r.WebsocketMessageFormatter,n.ProxyInfo.fromParameters(l.parameters),P,p)}};return Tg.SpeechSynthesisConnectionFactory=o,Tg}var xk;function j4(){if(xk)return Pg;xk=1,Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.AvatarSynthesizer=void 0;const n=dO(),e=ke(),t=Oe(),r=Gy(),i=me(),s=et(),o=aP();let a=class extends i.Synthesizer{constructor(u,p){super(u),s.Contracts.throwIfNullOrUndefined(p,"avatarConfig"),this.privConnectionFactory=new n.SpeechSynthesisConnectionFactory,this.privAvatarConfig=p,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=r.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(i.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(u){s.Contracts.throwIfNullOrUndefined(u,"peerConnection"),this.privIceServers=u.getConfiguration().iceServers,s.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const p=new t.Deferred;u.onicegatheringstatechange=()=>{t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice gathering state: "+u.iceGatheringState,t.EventType.Debug)),u.iceGatheringState==="complete"&&(t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice gathering complete.",t.EventType.Info)),p.resolve())},u.onicecandidate=S=>{S.candidate?t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice candidate: "+S.candidate.candidate,t.EventType.Debug)):(t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice candidate: complete",t.EventType.Debug)),p.resolve())},setTimeout(()=>{u.iceGatheringState!=="complete"&&(t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice gathering timeout.",t.EventType.Warning)),p.resolve())},2e3);const f=await u.createOffer();await u.setLocalDescription(f),await p.promise,t.Events.instance.onEvent(new t.PlatformEvent("peer connection: got local SDP.",t.EventType.Info)),this.privProperties.setProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(u.localDescription));const g=await this.speak("",!1);if(g.reason!==i.ResultReason.SynthesizingAudioCompleted)return new i.SynthesisResult(g.resultId,g.reason,g.errorDetails,g.properties);const m=atob(g.properties.getProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP)),C=new RTCSessionDescription(JSON.parse(m));return await u.setRemoteDescription(C),new i.SynthesisResult(g.resultId,g.reason,void 0,g.properties)}async speakTextAsync(u){const p=await this.speak(u,!1);return new i.SynthesisResult(p.resultId,p.reason,p.errorDetails,p.properties)}async speakSsmlAsync(u){const p=await this.speak(u,!0);return new i.SynthesisResult(p.resultId,p.reason,p.errorDetails,p.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return s.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(u,p,f){return new e.AvatarSynthesisAdapter(u,p,f,this,this.privAvatarConfig)}createRestSynthesisAdapter(u,p){}createSynthesizerConfig(u){const p=super.createSynthesizerConfig(u);return p.avatarEnabled=!0,p}async speak(u,p){const f=(0,t.createNoDashGuid)(),g=new t.Deferred;return this.synthesisRequestQueue.enqueue(new o.SynthesisRequest(f,u,p,m=>{g.resolve(m),this.privSynthesizing=!1,this.adapterSpeak()},m=>{g.reject(m),this.privSynthesizing=!1})),this.adapterSpeak(),g.promise}};return Pg.AvatarSynthesizer=a,Pg}var Xc={},Ik;function z4(){if(Ik)return Xc;Ik=1,Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.AvatarVideoFormat=Xc.Coordinate=void 0;class n{constructor(r,i){this.x=r,this.y=i}}Xc.Coordinate=n;let e=class{constructor(r="H264",i=2e6,s=1920,o=1080){this.codec=r,this.bitrate=i,this.width=s,this.height=o}setCropRange(r,i){this.cropRange={bottomRight:i,topLeft:r}}};return Xc.AvatarVideoFormat=e,Xc}var xg={},_k;function F4(){if(_k)return xg;_k=1,Object.defineProperty(xg,"__esModule",{value:!0}),xg.AvatarWebRTCConnectionResult=void 0;const n=me();let e=class extends n.SynthesisResult{constructor(r,i,s,o,a){super(i,s,o,a),this.privSDPAnswer=r}get SDPAnswer(){return this.privSDPAnswer}};return xg.AvatarWebRTCConnectionResult=e,xg}var Ig={},kk;function B4(){if(kk)return Ig;kk=1,Object.defineProperty(Ig,"__esModule",{value:!0}),Ig.Diagnostics=void 0;const n=Pr(),e=Oe();let t=class{static SetLoggingLevel(i){this.privListener=new n.ConsoleLoggingListener(i),e.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(i){if(typeof window>"u")this.privListener&&(this.privListener.logPath=i);else throw new Error("File system logging not available in browser.")}static set onLogOutput(i){this.privListener&&(this.privListener.logCallback=i)}};return Ig.Diagnostics=t,t.privListener=void 0,Ig}var Mk;function me(){return Mk||(Mk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.CustomCommandsConfig=n.BotFrameworkConfig=n.DialogServiceConfig=n.PhraseListGrammar=n.Connection=n.ServiceEventArgs=n.ConnectionEventArgs=n.CancellationErrorCode=n.CancellationDetails=n.CancellationDetailsBase=n.TranslationRecognitionCanceledEventArgs=n.NoMatchDetails=n.NoMatchReason=n.Translations=n.TranslationRecognizer=n.SpeechRecognizer=n.Recognizer=n.PropertyId=n.PropertyCollection=n.SpeechTranslationConfigImpl=n.SpeechTranslationConfig=n.SpeechConfigImpl=n.SpeechConfig=n.ResultReason=n.TranslationSynthesisResult=n.TranslationRecognitionResult=n.TranslationSynthesisEventArgs=n.TranslationRecognitionEventArgs=n.SpeechRecognitionCanceledEventArgs=n.MeetingTranscriptionEventArgs=n.ConversationTranscriptionEventArgs=n.SpeechRecognitionEventArgs=n.SpeechRecognitionResult=n.RecognitionResult=n.OutputFormat=n.RecognitionEventArgs=n.SessionEventArgs=n.KeywordRecognitionModel=n.PushAudioOutputStreamCallback=n.PullAudioInputStreamCallback=n.CancellationReason=n.PushAudioOutputStream=n.PullAudioOutputStream=n.AudioOutputStream=n.PushAudioInputStream=n.PullAudioInputStream=n.AudioInputStream=n.AudioFormatTag=n.AudioStreamFormat=n.AudioConfig=void 0,n.AvatarSynthesizer=n.AvatarEventArgs=n.AvatarConfig=n.LanguageIdMode=n.PronunciationAssessmentResult=n.PronunciationAssessmentConfig=n.PronunciationAssessmentGranularity=n.PronunciationAssessmentGradingSystem=n.MeetingTranscriptionCanceledEventArgs=n.ConversationTranscriptionCanceledEventArgs=n.SpeakerAudioDestination=n.VoiceInfo=n.SynthesisVoiceType=n.SynthesisVoiceGender=n.SynthesisVoicesResult=n.SpeechSynthesisBoundaryType=n.SpeechSynthesisVisemeEventArgs=n.SpeechSynthesisBookmarkEventArgs=n.SpeechSynthesisWordBoundaryEventArgs=n.SpeechSynthesisEventArgs=n.SpeechSynthesisResult=n.SynthesisResult=n.SpeechSynthesizer=n.SpeechSynthesisOutputFormat=n.Synthesizer=n.User=n.ParticipantChangedReason=n.Participant=n.MeetingTranscriber=n.Meeting=n.ConversationTranscriptionResult=n.ConversationTranscriber=n.ConversationTranslator=n.ConversationTranslationResult=n.ConversationTranslationEventArgs=n.ConversationTranslationCanceledEventArgs=n.ConversationParticipantsChangedEventArgs=n.ConversationExpirationEventArgs=n.Conversation=n.SourceLanguageConfig=n.AutoDetectSourceLanguageResult=n.AutoDetectSourceLanguageConfig=n.ConnectionMessage=n.ConnectionMessageEventArgs=n.BaseAudioPlayer=n.ProfanityOption=n.ServicePropertyChannel=n.TurnStatusReceivedEventArgs=n.ActivityReceivedEventArgs=n.DialogServiceConnector=void 0,n.LogLevel=n.Diagnostics=n.AvatarWebRTCConnectionResult=n.Coordinate=n.AvatarVideoFormat=void 0;var e=pB();Object.defineProperty(n,"AudioConfig",{enumerable:!0,get:function(){return e.AudioConfig}});var t=Tu();Object.defineProperty(n,"AudioStreamFormat",{enumerable:!0,get:function(){return t.AudioStreamFormat}}),Object.defineProperty(n,"AudioFormatTag",{enumerable:!0,get:function(){return t.AudioFormatTag}});var r=FN();Object.defineProperty(n,"AudioInputStream",{enumerable:!0,get:function(){return r.AudioInputStream}}),Object.defineProperty(n,"PullAudioInputStream",{enumerable:!0,get:function(){return r.PullAudioInputStream}}),Object.defineProperty(n,"PushAudioInputStream",{enumerable:!0,get:function(){return r.PushAudioInputStream}});var i=Vh();Object.defineProperty(n,"AudioOutputStream",{enumerable:!0,get:function(){return i.AudioOutputStream}}),Object.defineProperty(n,"PullAudioOutputStream",{enumerable:!0,get:function(){return i.PullAudioOutputStream}}),Object.defineProperty(n,"PushAudioOutputStream",{enumerable:!0,get:function(){return i.PushAudioOutputStream}});var s=fB();Object.defineProperty(n,"CancellationReason",{enumerable:!0,get:function(){return s.CancellationReason}});var o=gB();Object.defineProperty(n,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return o.PullAudioInputStreamCallback}});var a=vB();Object.defineProperty(n,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return a.PushAudioOutputStreamCallback}});var l=mB();Object.defineProperty(n,"KeywordRecognitionModel",{enumerable:!0,get:function(){return l.KeywordRecognitionModel}});var u=yB();Object.defineProperty(n,"SessionEventArgs",{enumerable:!0,get:function(){return u.SessionEventArgs}});var p=SB();Object.defineProperty(n,"RecognitionEventArgs",{enumerable:!0,get:function(){return p.RecognitionEventArgs}});var f=CB();Object.defineProperty(n,"OutputFormat",{enumerable:!0,get:function(){return f.OutputFormat}});var g=bB();Object.defineProperty(n,"RecognitionResult",{enumerable:!0,get:function(){return g.RecognitionResult}});var m=wB();Object.defineProperty(n,"SpeechRecognitionResult",{enumerable:!0,get:function(){return m.SpeechRecognitionResult}});var C=AB();Object.defineProperty(n,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return C.SpeechRecognitionEventArgs}}),Object.defineProperty(n,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return C.ConversationTranscriptionEventArgs}}),Object.defineProperty(n,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return C.MeetingTranscriptionEventArgs}});var S=EB();Object.defineProperty(n,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return S.SpeechRecognitionCanceledEventArgs}});var w=RB();Object.defineProperty(n,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return w.TranslationRecognitionEventArgs}});var b=PB();Object.defineProperty(n,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return b.TranslationSynthesisEventArgs}});var R=WN();Object.defineProperty(n,"TranslationRecognitionResult",{enumerable:!0,get:function(){return R.TranslationRecognitionResult}});var P=TB();Object.defineProperty(n,"TranslationSynthesisResult",{enumerable:!0,get:function(){return P.TranslationSynthesisResult}});var I=xB();Object.defineProperty(n,"ResultReason",{enumerable:!0,get:function(){return I.ResultReason}});var M=IB();Object.defineProperty(n,"SpeechConfig",{enumerable:!0,get:function(){return M.SpeechConfig}}),Object.defineProperty(n,"SpeechConfigImpl",{enumerable:!0,get:function(){return M.SpeechConfigImpl}});var k=_B();Object.defineProperty(n,"SpeechTranslationConfig",{enumerable:!0,get:function(){return k.SpeechTranslationConfig}}),Object.defineProperty(n,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return k.SpeechTranslationConfigImpl}});var O=VN();Object.defineProperty(n,"PropertyCollection",{enumerable:!0,get:function(){return O.PropertyCollection}});var L=iP();Object.defineProperty(n,"PropertyId",{enumerable:!0,get:function(){return L.PropertyId}});var F=kB();Object.defineProperty(n,"Recognizer",{enumerable:!0,get:function(){return F.Recognizer}});var H=MB();Object.defineProperty(n,"SpeechRecognizer",{enumerable:!0,get:function(){return H.SpeechRecognizer}});var V=DB();Object.defineProperty(n,"TranslationRecognizer",{enumerable:!0,get:function(){return V.TranslationRecognizer}});var ie=NB();Object.defineProperty(n,"Translations",{enumerable:!0,get:function(){return ie.Translations}});var J=OB();Object.defineProperty(n,"NoMatchReason",{enumerable:!0,get:function(){return J.NoMatchReason}});var ee=LB();Object.defineProperty(n,"NoMatchDetails",{enumerable:!0,get:function(){return ee.NoMatchDetails}});var se=jB();Object.defineProperty(n,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return se.TranslationRecognitionCanceledEventArgs}});var ne=QN();Object.defineProperty(n,"CancellationDetailsBase",{enumerable:!0,get:function(){return ne.CancellationDetailsBase}});var Q=zB();Object.defineProperty(n,"CancellationDetails",{enumerable:!0,get:function(){return Q.CancellationDetails}});var K=FB();Object.defineProperty(n,"CancellationErrorCode",{enumerable:!0,get:function(){return K.CancellationErrorCode}});var oe=BB();Object.defineProperty(n,"ConnectionEventArgs",{enumerable:!0,get:function(){return oe.ConnectionEventArgs}});var B=UB();Object.defineProperty(n,"ServiceEventArgs",{enumerable:!0,get:function(){return B.ServiceEventArgs}});var j=JN();Object.defineProperty(n,"Connection",{enumerable:!0,get:function(){return j.Connection}});var $=HB();Object.defineProperty(n,"PhraseListGrammar",{enumerable:!0,get:function(){return $.PhraseListGrammar}});var pe=sP();Object.defineProperty(n,"DialogServiceConfig",{enumerable:!0,get:function(){return pe.DialogServiceConfig}});var ge=WB();Object.defineProperty(n,"BotFrameworkConfig",{enumerable:!0,get:function(){return ge.BotFrameworkConfig}});var ye=qB();Object.defineProperty(n,"CustomCommandsConfig",{enumerable:!0,get:function(){return ye.CustomCommandsConfig}});var re=GB();Object.defineProperty(n,"DialogServiceConnector",{enumerable:!0,get:function(){return re.DialogServiceConnector}});var te=KB();Object.defineProperty(n,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return te.ActivityReceivedEventArgs}});var ae=JB();Object.defineProperty(n,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return ae.TurnStatusReceivedEventArgs}});var ve=XB();Object.defineProperty(n,"ServicePropertyChannel",{enumerable:!0,get:function(){return ve.ServicePropertyChannel}});var _e=YB();Object.defineProperty(n,"ProfanityOption",{enumerable:!0,get:function(){return _e.ProfanityOption}});var Ce=QB();Object.defineProperty(n,"BaseAudioPlayer",{enumerable:!0,get:function(){return Ce.BaseAudioPlayer}});var Ke=ZB();Object.defineProperty(n,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return Ke.ConnectionMessageEventArgs}});var he=$N();Object.defineProperty(n,"ConnectionMessage",{enumerable:!0,get:function(){return he.ConnectionMessage}});var $e=e4();Object.defineProperty(n,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return $e.AutoDetectSourceLanguageConfig}});var Ge=t4();Object.defineProperty(n,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return Ge.AutoDetectSourceLanguageResult}});var Ve=n4();Object.defineProperty(n,"SourceLanguageConfig",{enumerable:!0,get:function(){return Ve.SourceLanguageConfig}});var st=oP();Object.defineProperty(n,"Conversation",{enumerable:!0,get:function(){return st.Conversation}}),Object.defineProperty(n,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return st.ConversationExpirationEventArgs}}),Object.defineProperty(n,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return st.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(n,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return st.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(n,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return st.ConversationTranslationEventArgs}}),Object.defineProperty(n,"ConversationTranslationResult",{enumerable:!0,get:function(){return st.ConversationTranslationResult}}),Object.defineProperty(n,"ConversationTranslator",{enumerable:!0,get:function(){return st.ConversationTranslator}}),Object.defineProperty(n,"ConversationTranscriber",{enumerable:!0,get:function(){return st.ConversationTranscriber}}),Object.defineProperty(n,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return st.ConversationTranscriptionResult}}),Object.defineProperty(n,"Meeting",{enumerable:!0,get:function(){return st.Meeting}}),Object.defineProperty(n,"MeetingTranscriber",{enumerable:!0,get:function(){return st.MeetingTranscriber}}),Object.defineProperty(n,"Participant",{enumerable:!0,get:function(){return st.Participant}}),Object.defineProperty(n,"ParticipantChangedReason",{enumerable:!0,get:function(){return st.ParticipantChangedReason}}),Object.defineProperty(n,"User",{enumerable:!0,get:function(){return st.User}});var xn=aP();Object.defineProperty(n,"Synthesizer",{enumerable:!0,get:function(){return xn.Synthesizer}});var Yn=BN();Object.defineProperty(n,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return Yn.SpeechSynthesisOutputFormat}});var oi=y4();Object.defineProperty(n,"SpeechSynthesizer",{enumerable:!0,get:function(){return oi.SpeechSynthesizer}});var Tr=S4();Object.defineProperty(n,"SynthesisResult",{enumerable:!0,get:function(){return Tr.SynthesisResult}});var is=C4();Object.defineProperty(n,"SpeechSynthesisResult",{enumerable:!0,get:function(){return is.SpeechSynthesisResult}});var ss=b4();Object.defineProperty(n,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return ss.SpeechSynthesisEventArgs}});var os=w4();Object.defineProperty(n,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return os.SpeechSynthesisWordBoundaryEventArgs}});var as=A4();Object.defineProperty(n,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return as.SpeechSynthesisBookmarkEventArgs}});var ce=E4();Object.defineProperty(n,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return ce.SpeechSynthesisVisemeEventArgs}});var Ye=R4();Object.defineProperty(n,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return Ye.SpeechSynthesisBoundaryType}});var vt=P4();Object.defineProperty(n,"SynthesisVoicesResult",{enumerable:!0,get:function(){return vt.SynthesisVoicesResult}});var Qn=T4();Object.defineProperty(n,"SynthesisVoiceGender",{enumerable:!0,get:function(){return Qn.SynthesisVoiceGender}}),Object.defineProperty(n,"SynthesisVoiceType",{enumerable:!0,get:function(){return Qn.SynthesisVoiceType}}),Object.defineProperty(n,"VoiceInfo",{enumerable:!0,get:function(){return Qn.VoiceInfo}});var cs=x4();Object.defineProperty(n,"SpeakerAudioDestination",{enumerable:!0,get:function(){return cs.SpeakerAudioDestination}});var ls=I4();Object.defineProperty(n,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return ls.ConversationTranscriptionCanceledEventArgs}});var _u=_4();Object.defineProperty(n,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return _u.MeetingTranscriptionCanceledEventArgs}});var Cc=k4();Object.defineProperty(n,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return Cc.PronunciationAssessmentGradingSystem}});var bc=M4();Object.defineProperty(n,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return bc.PronunciationAssessmentGranularity}});var ku=D4();Object.defineProperty(n,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return ku.PronunciationAssessmentConfig}});var Yo=N4();Object.defineProperty(n,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return Yo.PronunciationAssessmentResult}});var Qo=tO();Object.defineProperty(n,"LanguageIdMode",{enumerable:!0,get:function(){return Qo.LanguageIdMode}});var Zo=O4();Object.defineProperty(n,"AvatarConfig",{enumerable:!0,get:function(){return Zo.AvatarConfig}});var wc=L4();Object.defineProperty(n,"AvatarEventArgs",{enumerable:!0,get:function(){return wc.AvatarEventArgs}});var Gh=j4();Object.defineProperty(n,"AvatarSynthesizer",{enumerable:!0,get:function(){return Gh.AvatarSynthesizer}});var qs=z4();Object.defineProperty(n,"AvatarVideoFormat",{enumerable:!0,get:function(){return qs.AvatarVideoFormat}}),Object.defineProperty(n,"Coordinate",{enumerable:!0,get:function(){return qs.Coordinate}});var ea=F4();Object.defineProperty(n,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return ea.AvatarWebRTCConnectionResult}});var nS=B4();Object.defineProperty(n,"Diagnostics",{enumerable:!0,get:function(){return nS.Diagnostics}});var rS=LN();Object.defineProperty(n,"LogLevel",{enumerable:!0,get:function(){return rS.LogLevel}})})(lA)),lA}var Dk;function U4(){if(Dk)return hf;Dk=1,Object.defineProperty(hf,"__esModule",{value:!0}),hf.ProxyInfo=void 0;const n=me();let e=class hO{constructor(r,i,s,o){this.privProxyHostName=r,this.privProxyPort=i,this.privProxyUserName=s,this.privProxyPassword=o}static fromParameters(r){return new hO(r.getProperty(n.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(r.getProperty(n.PropertyId.SpeechServiceConnection_ProxyPort),10),r.getProperty(n.PropertyId.SpeechServiceConnection_ProxyUserName),r.getProperty(n.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(r){return this.fromParameters(r.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};return hf.ProxyInfo=e,hf}var _g={},IA,Nk;function H4(){if(Nk)return IA;Nk=1;const n=new Set(["json","buffer","string"]);return IA=e=>(...t)=>{const r=new Set;let i,s,o,a="";return t.forEach(l=>{if(typeof l=="string")if(l.toUpperCase()===l)if(i){const u=`Can't set method to ${l}, already set to ${i}.`;throw new Error(u)}else i=l;else if(l.startsWith("http:")||l.startsWith("https:"))a=l;else if(n.has(l))s=l;else throw new Error(`Unknown encoding, ${l}`);else if(typeof l=="number")r.add(l);else if(typeof l=="object")if(Array.isArray(l)||l instanceof Set)l.forEach(u=>r.add(u));else{if(o)throw new Error("Cannot set headers twice.");o=l}else throw new Error(`Unknown type: ${typeof l}`)}),i||(i="GET"),r.size===0&&r.add(200),e(r,i,s,o,a)},IA}var _A,Ok;function W4(){if(Ok)return _A;Ok=1;const n=H4();class e extends Error{constructor(i,...s){super(...s),Error.captureStackTrace&&Error.captureStackTrace(this,e),this.name="StatusError",this.message=i.statusMessage,this.statusCode=i.status,this.res=i,this.json=i.json.bind(i),this.text=i.text.bind(i),this.arrayBuffer=i.arrayBuffer.bind(i);let o;Object.defineProperty(this,"responseBody",{get:()=>(o||(o=this.arrayBuffer()),o)}),this.headers={};for(const[l,u]of i.headers.entries())this.headers[l.toLowerCase()]=u}}return _A=n((r,i,s,o,a)=>async(l,u,p={})=>{l=a+(l||"");let f=new URL(l);if(o||(o={}),f.username&&(o.Authorization="Basic "+btoa(f.username+":"+f.password),f=new URL(f.protocol+"//"+f.host+f.pathname+f.search)),f.protocol!=="https:"&&f.protocol!=="http:")throw new Error(`Unknown protocol, ${f.protocol}`);if(u&&!(u instanceof ArrayBuffer||ArrayBuffer.isView(u)||typeof u=="string"))if(typeof u=="object")u=JSON.stringify(u),o["Content-Type"]="application/json";else throw new Error("Unknown body type.");p=new Headers({...o||{},...p});const g=await fetch(f,{method:i,headers:p,body:u});if(g.statusCode=g.status,!r.has(g.status))throw new e(g);return s==="json"?g.json():s==="buffer"?g.arrayBuffer():s==="string"?g.text():g}),_A}var Lk;function q4(){return Lk||(Lk=1,(function(n){var e=_g&&_g.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(n,"__esModule",{value:!0}),n.RestMessageAdapter=n.RestRequestType=void 0;const t=e(W4()),r=Oe();var i;(function(o){o.Get="GET",o.Post="POST",o.Delete="DELETE",o.File="file"})(i=n.RestRequestType||(n.RestRequestType={}));let s=class{constructor(a){if(!a)throw new r.ArgumentNullError("configParams");this.privHeaders=a.headers,this.privIgnoreCache=a.ignoreCache}static extractHeaderValue(a,l){let u="";try{const p=l.trim().split(/[\r\n]+/),f={};p.forEach(g=>{const m=g.split(": "),C=m.shift().toLowerCase(),S=m.join(": ");f[C]=S}),u=f[a.toLowerCase()]}catch{}return u}set options(a){this.privHeaders=a.headers,this.privIgnoreCache=a.ignoreCache}setHeaders(a,l){this.privHeaders[a]=l}request(a,l,u={},p=null){const f=new r.Deferred,g=a===i.File?"POST":a,m=(S,w={})=>{const b=S;return{data:JSON.stringify(w),headers:JSON.stringify(S.headers),json:w,ok:S.statusCode>=200&&S.statusCode<300,status:S.statusCode,statusText:w.error?w.error.message:b.statusText?b.statusText:b.statusMessage}},C=S=>{const w=(0,t.default)(l,g,this.privHeaders,200,201,202,204,400,401,402,403,404),b=this.queryParams(u)===""?"":`?${this.queryParams(u)}`;w(b,S).then(async R=>{if(a===i.Delete||R.statusCode===204)f.resolve(m(R));else try{const P=await R.json();f.resolve(m(R,P))}catch{f.resolve(m(R))}}).catch(R=>{f.reject(R)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),a===i.Post&&p&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),C(p),f.promise}queryParams(a={}){return Object.keys(a).map(l=>encodeURIComponent(l)+"="+encodeURIComponent(a[l])).join("&")}};n.RestMessageAdapter=s})(_g)),_g}var kg={},jk;function pO(){if(jk)return kg;jk=1,Object.defineProperty(kg,"__esModule",{value:!0}),kg.RestConfigBase=void 0;let n=class RC{static get requestOptions(){return RC.privDefaultRequestOptions}static get configParams(){return RC.privDefaultParams}static get restErrors(){return RC.privRestErrors}};return kg.RestConfigBase=n,n.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},n.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},n.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"},kg}var zk;function Pr(){return zk||(zk=1,(function(n){var e=Uc&&Uc.__createBinding||(Object.create?(function(r,i,s,o){o===void 0&&(o=s),Object.defineProperty(r,o,{enumerable:!0,get:function(){return i[s]}})}):(function(r,i,s,o){o===void 0&&(o=s),r[o]=i[s]})),t=Uc&&Uc.__exportStar||function(r,i){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,r,s)};Object.defineProperty(n,"__esModule",{value:!0}),t(oB(),n),t(aB(),n),t(cB(),n),t(lB(),n),t(uB(),n),t(dB(),n),t(jN(),n),t(hB(),n),t(U4(),n),t(q4(),n),t(pO(),n)})(Uc)),Uc}var Mg={},Fk;function U0(){if(Fk)return Mg;Fk=1,Object.defineProperty(Mg,"__esModule",{value:!0}),Mg.SpeechConnectionMessage=void 0;const n=Oe(),e=si();class t extends n.ConnectionMessage{constructor(i,s,o,a,l,u,p,f){if(!s)throw new n.ArgumentNullError("path");if(!o)throw new n.ArgumentNullError("requestId");const g={};if(g[e.HeaderNames.Path]=s,g[e.HeaderNames.RequestId]=o,g[e.HeaderNames.RequestTimestamp]=new Date().toISOString(),a&&(g[e.HeaderNames.ContentType]=a),u&&(g[e.HeaderNames.RequestStreamId]=u),p)for(const m in p)m&&(g[m]=p[m]);f?super(i,l,g,f):super(i,l,g),this.privPath=s,this.privRequestId=o,this.privContentType=a,this.privStreamId=u,this.privAdditionalHeaders=p}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(i){let s=null,o=null,a=null,l=null;const u={};if(i.headers)for(const p in i.headers)p&&(p.toLowerCase()===e.HeaderNames.Path.toLowerCase()?s=i.headers[p]:p.toLowerCase()===e.HeaderNames.RequestId.toLowerCase()?o=i.headers[p]:p.toLowerCase()===e.HeaderNames.ContentType.toLowerCase()?a=i.headers[p]:p.toLowerCase()===e.HeaderNames.RequestStreamId.toLowerCase()?l=i.headers[p]:u[p]=i.headers[p]);return new t(i.messageType,s,o,a,i.body,l,u,i.id)}}return Mg.SpeechConnectionMessage=t,Mg}var kA={},Bk;function V4(){return Bk||(Bk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SegmentationMode=void 0,(function(e){e.Normal="Normal",e.Disabled="Disabled",e.Custom="Custom",e.Semantic="Semantic"})(n.SegmentationMode||(n.SegmentationMode={}))})(kA)),kA}var MA={},Uk;function G4(){return Uk||(Uk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.NextAction=void 0,(function(e){e.None="None",e.Synthesize="Synthesize"})(n.NextAction||(n.NextAction={}))})(MA)),MA}var DA={},Hk;function K4(){return Hk||(Hk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Mode=void 0,(function(e){e.None="None",e.Always="Always"})(n.Mode||(n.Mode={}))})(DA)),DA}var NA={},Wk;function $4(){return Wk||(Wk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.LanguageIdDetectionPriority=n.LanguageIdDetectionMode=void 0,(function(e){e.DetectAtAudioStart="DetectAtAudioStart",e.DetectContinuous="DetectContinuous",e.DetectSegments="DetectSegments"})(n.LanguageIdDetectionMode||(n.LanguageIdDetectionMode={})),(function(e){e.Auto="Auto",e.PrioritizeLatency="PrioritizeLatency",e.PrioritizeAccuracy="PrioritizeAccuracy"})(n.LanguageIdDetectionPriority||(n.LanguageIdDetectionPriority={}))})(NA)),NA}var OA={},qk;function J4(){return qk||(qk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.NextAction=void 0,(function(e){e.Recognize="Recognize",e.None="None"})(n.NextAction||(n.NextAction={}))})(OA)),OA}var LA={},Vk;function X4(){return Vk||(Vk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnUnknownAction=void 0,(function(e){e.RecognizeWithDefaultLanguage="RecognizeWithDefaultLanguage",e.None="None"})(n.OnUnknownAction||(n.OnUnknownAction={}))})(LA)),LA}var jA={},Gk;function Y4(){return Gk||(Gk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ResultType=void 0,(function(e){e.Auto="Auto",e.StableFragment="StableFragment",e.Hypothesis="Hypothesis",e.None="None"})(n.ResultType||(n.ResultType={}))})(jA)),jA}var zA={},Kk;function Q4(){return Kk||(Kk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.PhraseResultOutputType=void 0,(function(e){e.Always="Always",e.None="None"})(n.PhraseResultOutputType||(n.PhraseResultOutputType={}))})(zA)),zA}var FA={},$k;function Z4(){return $k||($k=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.NextAction=void 0,(function(e){e.None="None",e.Translate="Translate"})(n.NextAction||(n.NextAction={}))})(FA)),FA}var Jk;function e3(){if(Jk)return of;Jk=1,Object.defineProperty(of,"__esModule",{value:!0}),of.ServiceRecognizerBase=void 0;const n=Pr(),e=Oe(),t=me(),r=ke(),i=U0(),s=V4(),o=rs(),a=G4(),l=K4(),u=$4(),p=J4(),f=X4(),g=Y4(),m=Q4(),C=Z4();let S=class Tv{constructor(b,R,P,I,M){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!b)throw new e.ArgumentNullError("authentication");if(!R)throw new e.ArgumentNullError("connectionFactory");if(!P)throw new e.ArgumentNullError("audioSource");if(!I)throw new e.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=I.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=b,this.privConnectionFactory=R,this.privAudioSource=P,this.privRecognizerConfig=I,this.privIsDisposed=!1,this.privRecognizer=M,this.privRequestSession=new r.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new e.EventSource,this.privServiceEvents=new e.EventSource,this.privDynamicGrammar=new r.DynamicGrammarBuilder,this.privSpeechContext=new r.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new r.AgentConfig,this.privRecognizerConfig.parameters.getProperty(t.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=e.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(O=>{if(O.name==="ConnectionClosedEvent"){const L=O;(L.statusCode===1003||L.statusCode===1007||L.statusCode===1002||L.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(t.CancellationReason.Error,L.statusCode===1007?t.CancellationErrorCode.BadRequestParameters:t.CancellationErrorCode.ConnectionFailure,`${L.reason} websocket error code: ${L.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=(0,e.createNoDashGuid)())}setTranslationJson(){const b=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(b!==void 0){const R=b.split(","),P=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),I=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationCategoryId,void 0),M=P!==void 0?a.NextAction.Synthesize:a.NextAction.None;if(this.privSpeechContext.getContext().translation={onPassthrough:{action:M},onSuccess:{action:M},output:{includePassThroughResults:!0,interimResults:{mode:l.Mode.Always}},targetLanguages:R},I!==void 0&&(this.privSpeechContext.getContext().translation.category=I),P!==void 0){const O={};for(const L of R)O[L]=P;this.privSpeechContext.getContext().synthesis={defaultVoices:O}}const k=this.privSpeechContext.getContext().phraseDetection||{};k.onSuccess={action:C.NextAction.Translate},k.onInterim={action:C.NextAction.Translate},this.privSpeechContext.getContext().phraseDetection=k}}setSpeechSegmentationTimeoutJson(){const b=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0),R=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_SegmentationMaximumTimeMs,void 0),P=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_SegmentationStrategy,void 0),I={mode:s.SegmentationMode.Normal};let M=!1;if(P!==void 0){M=!0;let k=s.SegmentationMode.Normal;switch(P.toLowerCase()){case"default":break;case"time":k=s.SegmentationMode.Custom;break;case"semantic":k=s.SegmentationMode.Semantic;break}I.mode=k}if(b!==void 0){M=!0;const k=parseInt(b,10);I.mode=s.SegmentationMode.Custom,I.segmentationSilenceTimeoutMs=k}if(R!==void 0){M=!0;const k=parseInt(R,10);I.mode=s.SegmentationMode.Custom,I.segmentationForcedTimeoutMs=k}if(M){const k=this.privSpeechContext.getContext().phraseDetection||{};switch(k.mode=this.recognitionMode,this.recognitionMode){case o.RecognitionMode.Conversation:k.conversation=k.conversation??{segmentation:{}},k.conversation.segmentation=I;break;case o.RecognitionMode.Interactive:k.interactive=k.interactive??{segmentation:{}},k.interactive.segmentation=I;break;case o.RecognitionMode.Dictation:k.dictation=k.dictation??{},k.dictation.segmentation=I;break}this.privSpeechContext.getContext().phraseDetection=k}}setLanguageIdJson(){const b=this.privSpeechContext.getContext().phraseDetection||{};if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){const R=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");R.length===1&&R[0]===r.AutoDetectSourceLanguagesOpenRangeOptionName&&(R[0]="UND");let P;this.privRecognizerConfig.languageIdMode==="Continuous"?P=u.LanguageIdDetectionMode.DetectContinuous:P=u.LanguageIdDetectionMode.DetectAtAudioStart,this.privSpeechContext.getContext().languageId={languages:R,mode:P,onSuccess:{action:p.NextAction.Recognize},onUnknown:{action:f.OnUnknownAction.None},priority:u.LanguageIdDetectionPriority.PrioritizeLatency},this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:g.ResultType.Auto},phraseResults:{resultType:m.PhraseResultOutputType.Always}};const I=this.privRecognizerConfig.sourceLanguageModels;I!==void 0&&(b.customModels=I,b.onInterim={action:C.NextAction.None},b.onSuccess={action:C.NextAction.None})}this.privSpeechContext.getContext().phraseDetection=b}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(r.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple]).toLowerCase()===t.OutputFormat[t.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}setSpeechStartEventSensitivityJson(){const b=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_StartEventSensitivity,void 0);if(b!==void 0){let R=!1;switch(b.toLowerCase()){case o.SpeechStartEventSensitivity.Low:case o.SpeechStartEventSensitivity.Medium:case o.SpeechStartEventSensitivity.High:R=!0;break}if(R){const P=this.privSpeechContext.getContext().phraseDetection||{};P.voiceOnsetSensitivity=b.toLowerCase(),this.privSpeechContext.getContext().phraseDetection=P}}}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(b){this.privRecognizerConfig.parameters.setProperty(t.PropertyId.ConversationTranslator_Token,b)}set authentication(b){this.privAuthentication=b}isDisposed(){return this.privIsDisposed}async dispose(b){if(this.privIsDisposed=!0,this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose(b)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(b,R,P){if(this.recognizeOverride!==void 0){await this.recognizeOverride(b,R,P);return}if(this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=b,this.privRecognizerConfig.recognitionEndpointVersion==="2"){const L=this.privSpeechContext.getContext().phraseDetection||{};L.mode=b,this.privSpeechContext.getContext().phraseDetection=L}this.setLanguageIdJson(),this.setTranslationJson(),this.privRecognizerConfig.autoDetectSourceLanguages!==void 0&&this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&this.setupTranslationWithLanguageId(),this.setSpeechSegmentationTimeoutJson(),this.setOutputDetailLevelJson(),this.setSpeechStartEventSensitivityJson(),this.privSuccessCallback=R,this.privErrorCallback=P,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const I=this.connectImpl();let M;try{const L=await this.audioSource.attach(this.privRequestSession.audioNodeId),F=await this.audioSource.format,H=await this.audioSource.deviceInfo;this.privIsLiveAudio=H.type&&H.type===r.type.Microphones,M=new n.ReplayableAudioNode(L,F.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(M,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:H}}catch(L){throw await this.privRequestSession.onStopRecognizing(),L}try{await I}catch(L){await this.cancelRecognitionLocal(t.CancellationReason.Error,t.CancellationErrorCode.ConnectionFailure,L);return}const k=new t.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,k),this.receiveMessage(),this.sendAudio(M).catch(async L=>{await this.cancelRecognitionLocal(t.CancellationReason.Error,t.CancellationErrorCode.RuntimeError,L)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(b,R){this.connectImpl().then(()=>{try{b&&b()}catch(P){R&&R(P)}},P=>{try{R&&R(P)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(t.CancellationReason.Error,t.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(b){}async sendNetworkMessage(b,R){const P=typeof R=="string"?e.MessageType.Text:e.MessageType.Binary,I=typeof R=="string"?"application/json":"";return(await this.fetchConnection()).send(new i.SpeechConnectionMessage(P,b,this.privRequestSession.requestId,I,R))}set activityTemplate(b){this.privActivityTemplate=b}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(b){this.privExpectContentAssessmentResponse=b}async sendTelemetryData(){const b=this.privRequestSession.getTelemetry();if(Tv.telemetryDataEnabled!==!0||this.privIsDisposed||b===null)return;if(Tv.telemetryData)try{Tv.telemetryData(b)}catch{}await(await this.fetchConnection()).send(new i.SpeechConnectionMessage(e.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",b))}async cancelRecognitionLocal(b,R,P){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,b,R,P))}async receiveMessage(){try{if(this.privIsDisposed)return;let b=await this.fetchConnection();const R=await b.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!R)return this.receiveMessage();this.privServiceHasSentMessage=!0;const P=i.SpeechConnectionMessage.fromConnectionMessage(R);if(P.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(P.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const I=r.SpeechDetected.fromJSON(P.textBody,this.privRequestSession.currentTurnAudioOffset),M=new t.RecognitionEventArgs(I.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,M);break;case"speech.enddetected":let k;P.textBody.length>0?k=P.textBody:k="{ Offset: 0 }";const O=r.SpeechDetected.fromJSON(k,this.privRequestSession.currentTurnAudioOffset),L=new t.RecognitionEventArgs(O.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,L);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(t.CancellationReason.EndOfStream,t.CancellationErrorCode.NoError,void 0));const F=new t.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,F);return}else b=await this.fetchConnection(),await this.sendPrePayloadJSON(b);break;default:await this.processTypeSpecificMessages(P)||this.privServiceEvents&&this.serviceEvents.onEvent(new e.ServiceEvent(P.path.toLowerCase(),P.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){const b=this.privRequestSession.recognitionBytesSent,R=this.privAverageBytesPerMs!==0?b/this.privAverageBytesPerMs:0;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(R)}sendSpeechContext(b,R){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const P=this.speechContext.toJSON();if(R&&this.privRequestSession.onSpeechContext(),P)return b.send(new i.SpeechConnectionMessage(e.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",P))}setupTranslationWithLanguageId(){const b=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0),R=this.privRecognizerConfig.autoDetectSourceLanguages!==void 0;if(b!==void 0&&R){this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:g.ResultType.None},phraseResults:{resultType:m.PhraseResultOutputType.None}};const P=this.privSpeechContext.getContext().translation;if(P){const I=this.privRecognizerConfig.sourceLanguageModels;if(I!==void 0&&I.length>0){const k=this.privSpeechContext.getContext().phraseDetection||{};k.customModels=I,this.privSpeechContext.getContext().phraseDetection=k}this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&(P.onSuccess={action:a.NextAction.Synthesize},P.onPassthrough={action:a.NextAction.Synthesize})}}}noOp(){}async sendPrePayloadJSON(b,R=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(b);await this.sendSpeechContext(b,R),await this.sendWaveHeader(b)}async sendWaveHeader(b){const R=await this.audioSource.format;return b.send(new i.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",R.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(b=>b.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(b,R,P){if(R.onSpeechContext(),Tv.telemetryDataEnabled!==!0){const M={context:{system:JSON.parse(P).context.system}};P=JSON.stringify(M)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){const I=JSON.parse(P);I.context.DisableReferenceChannel="True",I.context.MicSpec="1_0_0",P=JSON.stringify(I)}if(P)return b.send(new i.SpeechConnectionMessage(e.MessageType.Text,"speech.config",R.requestId,"application/json",P))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(b=>b.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(b){const R=await this.audioSource.format;this.privAverageBytesPerMs=R.avgBytesPerSec/1e3;let P=Date.now();const I=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),M=R.avgBytesPerSec/1e3*parseInt(I,10),k=this.privRequestSession.recogNumber,O=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===k){const L=await this.fetchConnection(),F=await b.read();if(this.privRequestSession.isSpeechEnded)return;let H,V;if(!F||F.isEnd?(H=null,V=0):(H=F.buffer,this.privRequestSession.onAudioSent(H.byteLength),M>=this.privRequestSession.bytesSent?V=0:V=Math.max(0,P-Date.now())),V!==0&&await this.delay(V),H!==null&&(P=Date.now()+H.byteLength*1e3/(R.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===k)if(L.send(new i.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,null,H)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),F!=null&&F.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return O()}};return O()}async retryableConnect(){let b=!1;this.privAuthFetchEventId=(0,e.createNoDashGuid)();const R=this.privRequestSession.sessionId;this.privConnectionId=R!==void 0?R:(0,e.createNoDashGuid)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let P=0,I="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){this.privRequestSession.onRetryConnection();const k=await(b?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId));await this.privRequestSession.onAuthCompleted(!1);const O=await this.privConnectionFactory.create(this.privRecognizerConfig,k,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(O.events),O.events.attach(F=>{this.connectionEvents.onEvent(F)});const L=await O.open();if(L.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(L.statusCode),Promise.resolve(O);L.statusCode===1006&&(b=!0),P=L.statusCode,I=L.reason}return await this.privRequestSession.onConnectionEstablishCompleted(P,I),Promise.reject(`Unable to contact server. StatusCode: ${P}, ${this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${I}`)}delay(b){return new Promise(R=>this.privSetTimeout(R,b))}writeBufferToConsole(b){let R="Buffer Size: ";if(b===null)R+="null";else{const P=new Uint8Array(b);R+=`${b.byteLength}\r
`;for(let I=0;I<b.byteLength;I++)R+=P[I].toString(16).padStart(2,"0")+" ",(I+1)%16===0&&(console.info(R),R="")}console.info(R)}async sendFinalAudio(){await(await this.fetchConnection()).send(new i.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){const b=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(b):(await this.sendSpeechServiceConfig(b,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(b,!1),b)}};return of.ServiceRecognizerBase=S,S.telemetryDataEnabled=!0,of}var Dg={},Xk;function t3(){if(Xk)return Dg;Xk=1,Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.ConversationServiceRecognizer=void 0;const n=me(),e=ke();let t=class extends e.ServiceRecognizerBase{constructor(i,s,o,a,l){super(i,s,o,a,l),this.handleSpeechPhraseMessage=async u=>this.handleSpeechPhrase(u),this.handleSpeechHypothesisMessage=u=>this.handleSpeechHypothesis(u)}processTypeSpecificMessages(i){}handleRecognizedCallback(i,s,o){}handleRecognizingCallback(i,s,o){}async processSpeechMessages(i){let s=!1;switch(i.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(i.textBody),s=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(i.textBody),s=!0;break}return s}cancelRecognition(i,s,o,a,l){}async handleSpeechPhrase(i){const s=e.SimpleSpeechPhrase.fromJSON(i,this.privRequestSession.currentTurnAudioOffset),o=e.EnumTranslation.implTranslateRecognitionResult(s.RecognitionStatus);let a;const l=new n.PropertyCollection;if(l.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,i),this.privRequestSession.onPhraseRecognized(s.Offset+s.Duration),n.ResultReason.Canceled===o){const u=e.EnumTranslation.implTranslateCancelResult(s.RecognitionStatus),p=e.EnumTranslation.implTranslateCancelErrorCode(s.RecognitionStatus);await this.cancelRecognitionLocal(u,p,e.EnumTranslation.implTranslateErrorDetails(p))}else if(s.RecognitionStatus!==e.RecognitionStatus.EndOfDictation){if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===n.OutputFormat[n.OutputFormat.Simple])a=new n.SpeechRecognitionResult(this.privRequestSession.requestId,o,s.DisplayText,s.Duration,s.Offset,s.Language,s.LanguageDetectionConfidence,s.SpeakerId,void 0,s.asJson(),l);else{const u=e.DetailedSpeechPhrase.fromJSON(i,this.privRequestSession.currentTurnAudioOffset);a=new n.SpeechRecognitionResult(this.privRequestSession.requestId,o,u.Text,u.Duration,u.Offset,u.Language,u.LanguageDetectionConfidence,u.SpeakerId,void 0,u.asJson(),l)}this.handleRecognizedCallback(a,a.offset,this.privRequestSession.sessionId)}}handleSpeechHypothesis(i){const s=e.SpeechHypothesis.fromJSON(i,this.privRequestSession.currentTurnAudioOffset),o=new n.PropertyCollection;o.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,i);const a=new n.SpeechRecognitionResult(this.privRequestSession.requestId,n.ResultReason.RecognizingSpeech,s.Text,s.Duration,s.Offset,s.Language,s.LanguageDetectionConfidence,s.SpeakerId,void 0,s.asJson(),o);this.privRequestSession.onHypothesis(s.Offset),this.handleRecognizingCallback(a,s.Duration,this.privRequestSession.sessionId)}};return Dg.ConversationServiceRecognizer=t,Dg}var BA={},Yk;function n3(){return Yk||(Yk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.RecognizerConfig=n.SpeechResultFormat=void 0;const e=me(),t=ke(),r=rs();(function(s){s[s.Simple=0]="Simple",s[s.Detailed=1]="Detailed"})(n.SpeechResultFormat||(n.SpeechResultFormat={}));class i{constructor(o,a){this.privSpeechServiceConfig=o||new t.SpeechServiceConfig(new t.Context(null)),this.privParameters=a,this.privMaxRetryCount=parseInt(a.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=a.getProperty(e.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(o){this.privRecognitionMode=o,this.privRecognitionActivityTimeout=o===r.RecognitionMode.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=r.RecognitionMode[o]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==r.RecognitionMode.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(e.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2")}set recognitionEndpointVersion(o){this.parameters.setProperty(e.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,o)}get sourceLanguageModels(){const o=[];let a=!1;if(this.autoDetectSourceLanguages!==void 0)for(const l of this.autoDetectSourceLanguages.split(",")){const u=l+e.PropertyId.SpeechServiceConnection_EndpointId.toString(),p=this.parameters.getProperty(u,void 0);p!==void 0?(o.push({language:l,endpoint:p}),a=!0):o.push({language:l,endpoint:""})}return a?o:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(o){this.privEnableSpeakerId=o}}n.RecognizerConfig=i})(BA)),BA}var UA={},Qk;function r3(){return Qk||(Qk=1,Object.defineProperty(UA,"__esModule",{value:!0})),UA}var Ng={},Zk;function i3(){if(Zk)return Ng;Zk=1,Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.WebsocketMessageFormatter=void 0;const n=Oe(),e=`\r
`;let t=class{toConnectionMessage(i){const s=new n.Deferred;try{if(i.messageType===n.MessageType.Text){const o=i.textContent;let a={},l=null;if(o){const u=o.split(`\r
\r
`);u&&u.length>0&&(a=this.parseHeaders(u[0]),u.length>1&&(l=u[1]))}s.resolve(new n.ConnectionMessage(i.messageType,l,a,i.id))}else if(i.messageType===n.MessageType.Binary){const o=i.binaryContent;let a={},l=null;if(!o||o.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const u=new DataView(o),p=u.getInt16(0);if(o.byteLength<p+2)throw new Error("Invalid binary message format. Header content missing.");let f="";for(let g=0;g<p;g++)f+=String.fromCharCode(u.getInt8(g+2));a=this.parseHeaders(f),o.byteLength>p+2&&(l=o.slice(2+p)),s.resolve(new n.ConnectionMessage(i.messageType,l,a,i.id))}}catch(o){s.reject(`Error formatting the message. Error: ${o}`)}return s.promise}fromConnectionMessage(i){const s=new n.Deferred;try{if(i.messageType===n.MessageType.Text){const o=`${this.makeHeaders(i)}${e}${i.textBody?i.textBody:""}`;s.resolve(new n.RawWebsocketMessage(n.MessageType.Text,o,i.id))}else if(i.messageType===n.MessageType.Binary){const o=this.makeHeaders(i),a=i.binaryBody,l=this.stringToArrayBuffer(o),u=new Int8Array(l),p=u.byteLength,f=new Int8Array(2+p+(a?a.byteLength:0));if(f[0]=p>>8&255,f[1]=p&255,f.set(u,2),a){const m=new Int8Array(a);f.set(m,2+p)}const g=f.buffer;s.resolve(new n.RawWebsocketMessage(n.MessageType.Binary,g,i.id))}}catch(o){s.reject(`Error formatting the message. ${o}`)}return s.promise}makeHeaders(i){let s="";if(i.headers)for(const o in i.headers)o&&(s+=`${o}: ${i.headers[o]}${e}`);return s}parseHeaders(i){const s={};if(i){const o=i.match(/[^\r\n]+/g);if(s){for(const a of o)if(a){const l=a.indexOf(":"),u=l>0?a.substr(0,l).trim().toLowerCase():a,p=l>0&&a.length>l+1?a.substr(l+1).trim():"";s[u]=p}}}return s}stringToArrayBuffer(i){const s=new ArrayBuffer(i.length),o=new DataView(s);for(let a=0;a<i.length;a++)o.setUint8(a,i.charCodeAt(a));return s}};return Ng.WebsocketMessageFormatter=t,Ng}var Og={},eM;function s3(){if(eM)return Og;eM=1,Object.defineProperty(Og,"__esModule",{value:!0}),Og.SpeechConnectionFactory=void 0;const n=Pr(),e=ke(),t=me(),r=Xo(),i=ke(),s=si(),o=Sc(),a=rs();let l=class extends r.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/stt/speech/universal/v"}async create(p,f,g){let m=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const C=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),S=r.ConnectionFactoryBase.getHostSuffix(C),w=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+C+".stt.speech"+S),b={},R=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),P=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(R?(!m||m.search(o.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(b[o.QueryParameterNames.CustomSpeechDeploymentId]=R):P&&(!m||m.search(o.QueryParameterNames.Language)===-1)&&(b[o.QueryParameterNames.Language]=P),(!m||m.search(o.QueryParameterNames.Format)===-1)&&(b[o.QueryParameterNames.Format]=p.parameters.getProperty(e.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple]).toLowerCase()),p.autoDetectSourceLanguages!==void 0&&(b[o.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(p,b,m),m){const L=new URL(m),F=L.pathname;(F===""||F==="/")&&(L.pathname=this.universalUri+p.recognitionEndpointVersion,m=await r.ConnectionFactoryBase.getRedirectUrlFromEndpoint(L.toString()))}if(!m)switch(p.recognitionMode){case a.RecognitionMode.Conversation:p.parameters.getProperty(e.ForceDictationPropertyName,"false")==="true"?m=w+this.dictationRelativeUri:p.recognitionEndpointVersion!==void 0&&parseInt(p.recognitionEndpointVersion,10)>1?m=`${w}${this.universalUri}${p.recognitionEndpointVersion}`:m=w+this.conversationRelativeUri;break;case a.RecognitionMode.Dictation:m=w+this.dictationRelativeUri;break;default:p.recognitionEndpointVersion!==void 0&&parseInt(p.recognitionEndpointVersion,10)>1?m=`${w}${this.universalUri}${p.recognitionEndpointVersion}`:m=w+this.interactiveRelativeUri;break}const I={};f.token!==void 0&&f.token!==""&&(I[f.headerName]=f.token),I[s.HeaderNames.ConnectionId]=g,I.connectionId=g;const M=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",k=new n.WebsocketConnection(m,b,I,new i.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(p),M,g),O=k.uri;return p.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,O),k}};return Og.SpeechConnectionFactory=l,Og}var Lg={},tM;function o3(){if(tM)return Lg;tM=1,Object.defineProperty(Lg,"__esModule",{value:!0}),Lg.ConversationTranscriberConnectionFactory=void 0;const n=Pr(),e=me(),t=ke(),r=Xo(),i=ke(),s=si(),o=Sc();let a=class extends r.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.conversationRelativeUriV1="/speech/recognition/conversation/cognitiveservices/v1"}async create(u,p,f){let g=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const m=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,void 0),C=r.ConnectionFactoryBase.getHostSuffix(m),S=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,"wss://"+m+".stt.speech"+C),w={},b=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),R=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(b?(!g||g.search(o.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(w[o.QueryParameterNames.CustomSpeechDeploymentId]=b):R&&(!g||g.search(o.QueryParameterNames.Language)===-1)&&(w[o.QueryParameterNames.Language]=R),u.autoDetectSourceLanguages!==void 0&&(w[o.QueryParameterNames.EnableLanguageId]="true"),u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,void 0)==="1")g=`${S}${this.universalUri}`;else{if(this.setV2UrlParams(u,w,g),g){const L=new URL(g),F=L.pathname;(F===""||F==="/")&&(L.pathname=this.universalUri,g=await r.ConnectionFactoryBase.getRedirectUrlFromEndpoint(L.toString()))}g||(g=`${S}${this.conversationRelativeUriV1}`)}const I={};p.token!==void 0&&p.token!==""&&(I[p.headerName]=p.token),I[s.HeaderNames.ConnectionId]=f;const M=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",k=new n.WebsocketConnection(g,w,I,new i.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(u),M,f),O=k.uri;return u.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,O),k}setV2UrlParams(u,p,f){new Map([[e.PropertyId.Speech_SegmentationSilenceTimeoutMs,o.QueryParameterNames.SegmentationSilenceTimeoutMs],[e.PropertyId.SpeechServiceConnection_EnableAudioLogging,o.QueryParameterNames.EnableAudioLogging],[e.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,o.QueryParameterNames.EndSilenceTimeoutMs],[e.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,o.QueryParameterNames.InitialSilenceTimeoutMs],[e.PropertyId.SpeechServiceResponse_PostProcessingOption,o.QueryParameterNames.Postprocessing],[e.PropertyId.SpeechServiceResponse_ProfanityOption,o.QueryParameterNames.Profanity],[e.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,o.QueryParameterNames.StableIntermediateThreshold]]).forEach((C,S)=>{this.setUrlParameter(S,C,u,p,f)});const m=JSON.parse(u.parameters.getProperty(t.ServicePropertiesPropertyName,"{}"));Object.keys(m).forEach(C=>{p[C]=m[C]})}};return Lg.ConversationTranscriberConnectionFactory=a,Lg}var jg={},nM;function a3(){if(nM)return jg;nM=1,Object.defineProperty(jg,"__esModule",{value:!0}),jg.TranscriberConnectionFactory=void 0;const n=Pr(),e=me(),t=Xo(),r=ke(),i=si(),s=Sc();let o=class extends t.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(l,u,p){let f=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const g=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,"centralus"),m=t.ConnectionFactoryBase.getHostSuffix(g),C="wss://transcribe."+g+".cts.speech"+m+this.multiaudioRelativeUri,S=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,C),w={};this.setQueryParams(w,l,f),f||(f=S);const b={};u.token!==void 0&&u.token!==""&&(b[u.headerName]=u.token),b[i.HeaderNames.ConnectionId]=p,l.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,f);const R=l.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new n.WebsocketConnection(f,w,b,new r.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(l),R,p))}setQueryParams(l,u,p){const f=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),g=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);f&&!(s.QueryParameterNames.CustomSpeechDeploymentId in l)&&(l[s.QueryParameterNames.CustomSpeechDeploymentId]=f),g&&!(s.QueryParameterNames.Language in l)&&(l[s.QueryParameterNames.Language]=g);const m=u.parameters.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",C=u.parameters.getProperty(r.OutputFormatPropertyName,e.OutputFormat[e.OutputFormat.Simple])!==e.OutputFormat[e.OutputFormat.Simple];(m||C)&&(l[s.QueryParameterNames.Format]=e.OutputFormat[e.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(u,l,p)}};return jg.TranscriberConnectionFactory=o,jg}var zg={},rM;function c3(){if(rM)return zg;rM=1,Object.defineProperty(zg,"__esModule",{value:!0}),zg.TranslationConnectionFactory=void 0;const n=Pr(),e=iO(),t=me(),r=Xo(),i=ke(),s=si(),o=Sc(),a=rs();let l=class extends r.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.translationV1Uri="/speech/translation/cognitiveservices/v1"}async create(p,f,g){let m=this.getEndpointUrl(p);const C={};if(this.setQueryParams(C,p,m),m){const R=new URL(m),P=R.pathname;(P===""||P==="/")&&(R.pathname=this.universalUri,m=await r.ConnectionFactoryBase.getRedirectUrlFromEndpoint(R.toString()))}const S={};f.token!==void 0&&f.token!==""&&(S[f.headerName]=f.token),S[s.HeaderNames.ConnectionId]=g,p.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,m);const w=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new n.WebsocketConnection(m,C,S,new i.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(p),w,g)}getEndpointUrl(p,f){const g=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region),m=r.ConnectionFactoryBase.getHostSuffix(g);let C=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);return C?f===!0?C:e.StringUtils.formatString(C,{region:g}):(p.parameters.getProperty("SPEECH-ForceV1Endpoint","false")==="true"?C=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+m)+this.translationV1Uri:C=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+m)+this.universalUri,f===!0?C:e.StringUtils.formatString(C,{region:g}))}setQueryParams(p,f,g){p.from=f.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage),p.to=f.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages),p.scenario=f.recognitionMode===a.RecognitionMode.Interactive?"interactive":f.recognitionMode===a.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(f,p,g),this.setUrlParameter(t.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,o.QueryParameterNames.StableTranslation,f,p,g);const m=f.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);m!==void 0&&(p.voice=m,p.features="requireVoice")}};return zg.TranslationConnectionFactory=l,zg}var Fg={},iM;function l3(){if(iM)return Fg;iM=1,Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.EnumTranslation=void 0;const n=me(),e=ke();let t=class{static implTranslateRecognitionResult(i,s=!1){let o=n.ResultReason.Canceled;switch(i){case e.RecognitionStatus.Success:o=n.ResultReason.RecognizedSpeech;break;case e.RecognitionStatus.EndOfDictation:o=s?n.ResultReason.RecognizedSpeech:n.ResultReason.NoMatch;break;case e.RecognitionStatus.NoMatch:case e.RecognitionStatus.InitialSilenceTimeout:case e.RecognitionStatus.BabbleTimeout:o=n.ResultReason.NoMatch;break;case e.RecognitionStatus.Error:case e.RecognitionStatus.BadRequest:case e.RecognitionStatus.Forbidden:default:o=n.ResultReason.Canceled;break}return o}static implTranslateCancelResult(i){let s=n.CancellationReason.EndOfStream;switch(i){case e.RecognitionStatus.Success:case e.RecognitionStatus.EndOfDictation:case e.RecognitionStatus.NoMatch:s=n.CancellationReason.EndOfStream;break;case e.RecognitionStatus.InitialSilenceTimeout:case e.RecognitionStatus.BabbleTimeout:case e.RecognitionStatus.Error:case e.RecognitionStatus.BadRequest:case e.RecognitionStatus.Forbidden:default:s=n.CancellationReason.Error;break}return s}static implTranslateCancelErrorCode(i){let s=n.CancellationErrorCode.NoError;switch(i){case e.RecognitionStatus.Error:s=n.CancellationErrorCode.ServiceError;break;case e.RecognitionStatus.TooManyRequests:s=n.CancellationErrorCode.TooManyRequests;break;case e.RecognitionStatus.BadRequest:s=n.CancellationErrorCode.BadRequestParameters;break;case e.RecognitionStatus.Forbidden:s=n.CancellationErrorCode.Forbidden;break;default:s=n.CancellationErrorCode.NoError;break}return s}static implTranslateErrorDetails(i){let s="The speech service encountered an internal error and could not continue.";switch(i){case n.CancellationErrorCode.Forbidden:s="The recognizer is using a free subscription that ran out of quota.";break;case n.CancellationErrorCode.BadRequestParameters:s="Invalid parameter or unsupported audio format in the request.";break;case n.CancellationErrorCode.TooManyRequests:s="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break}return s}};return Fg.EnumTranslation=t,Fg}var HA={},sM;function u3(){return sM||(sM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.RecognitionStatus=n.SynthesisStatus=void 0,(function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"})(n.SynthesisStatus||(n.SynthesisStatus={})),(function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests",e[e.BadRequest=7]="BadRequest",e[e.Forbidden=8]="Forbidden"})(n.RecognitionStatus||(n.RecognitionStatus={}))})(HA)),HA}var Bg={},oM;function d3(){if(oM)return Bg;oM=1,Object.defineProperty(Bg,"__esModule",{value:!0}),Bg.TranslationSynthesisEnd=void 0;const n=ke();let e=class fO{constructor(r){this.privSynthesisEnd=JSON.parse(r),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=n.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=n.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(r){return new fO(r)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};return Bg.TranslationSynthesisEnd=e,Bg}var Ug={},aM;function h3(){if(aM)return Ug;aM=1,Object.defineProperty(Ug,"__esModule",{value:!0}),Ug.TranslationHypothesis=void 0;const n=et(),e=tP();let t=class yE{constructor(i,s){this.privTranslationHypothesis=i,this.privTranslationHypothesis.Offset+=s,this.privTranslationHypothesis.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationHypothesis.Translation.TranslationStatus)}static fromJSON(i,s){return new yE(JSON.parse(i),s)}static fromTranslationResponse(i,s){n.Contracts.throwIfNullOrUndefined(i,"translationHypothesis");const o=i.SpeechHypothesis;return i.SpeechHypothesis=void 0,o.Translation=i,new yE(o,s)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){var i;return(i=this.privTranslationHypothesis.PrimaryLanguage)==null?void 0:i.Language}asJson(){const i={...this.privTranslationHypothesis};return i.Translation!==void 0?JSON.stringify({...i,TranslationStatus:e.TranslationStatus[i.Translation.TranslationStatus]}):JSON.stringify(i)}mapTranslationStatus(i){if(typeof i=="string")return e.TranslationStatus[i];if(typeof i=="number")return i}};return Ug.TranslationHypothesis=t,Ug}var Hg={},cM;function p3(){if(cM)return Hg;cM=1,Object.defineProperty(Hg,"__esModule",{value:!0}),Hg.TranslationPhrase=void 0;const n=et(),e=ke(),t=tP();let r=class SE{constructor(s,o){this.privTranslationPhrase=s,this.privTranslationPhrase.Offset+=o,this.privTranslationPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privTranslationPhrase.RecognitionStatus),this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationPhrase.Translation.TranslationStatus))}static fromJSON(s,o){return new SE(JSON.parse(s),o)}static fromTranslationResponse(s,o){n.Contracts.throwIfNullOrUndefined(s,"translationResponse");const a=s.SpeechPhrase;return s.SpeechPhrase=void 0,a.Translation=s,a.Text=a.DisplayText,new SE(a,o)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){var s;return(s=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:s.Language}get Confidence(){var s;return(s=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:s.Confidence}get Translation(){return this.privTranslationPhrase.Translation}asJson(){const s={...this.privTranslationPhrase},o={...s,RecognitionStatus:e.RecognitionStatus[s.RecognitionStatus]};return s.Translation&&(o.Translation={...s.Translation,TranslationStatus:t.TranslationStatus[s.Translation.TranslationStatus]}),JSON.stringify(o)}mapRecognitionStatus(s){if(typeof s=="string")return e.RecognitionStatus[s];if(typeof s=="number")return s}mapTranslationStatus(s){if(typeof s=="string")return t.TranslationStatus[s];if(typeof s=="number")return s}};return Hg.TranslationPhrase=r,Hg}var Wg={},lM;function f3(){if(lM)return Wg;lM=1,Object.defineProperty(Wg,"__esModule",{value:!0}),Wg.TranslationServiceRecognizer=void 0;const n=Oe(),e=me(),t=ke();let r=class extends t.ConversationServiceRecognizer{constructor(s,o,a,l,u){super(s,o,a,l,u),this.privTranslationRecognizer=u,this.connectionEvents.attach(p=>{p.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(s){const o=new e.PropertyCollection;let a=await this.processSpeechMessages(s);if(a)return!0;const l=async p=>{if(o.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,p.asJson()),this.privRequestSession.onPhraseRecognized(p.Offset+p.Duration),p.RecognitionStatus===t.RecognitionStatus.Success){const f=this.fireEventForResult(p,o);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,f)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(f.result)}catch(g){this.privErrorCallback&&this.privErrorCallback(g)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const f=t.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus),g=new e.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,f,p.Text,p.Duration,p.Offset,p.Language,p.Confidence,void 0,p.asJson(),o);if(f===e.ResultReason.Canceled){const m=t.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus),C=t.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus);await this.cancelRecognitionLocal(m,C,t.EnumTranslation.implTranslateErrorDetails(C))}else if(p.RecognitionStatus!==t.RecognitionStatus.EndOfDictation){const m=new e.TranslationRecognitionEventArgs(g,g.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,m)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(g)}catch(C){this.privErrorCallback&&this.privErrorCallback(C)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}a=!0}},u=p=>{o.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,p.asJson());const f=this.fireEventForResult(p,o);if(this.privRequestSession.onHypothesis(f.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,f)}catch{}a=!0};switch(s.messageType===n.MessageType.Text&&o.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,s.textBody),s.path.toLowerCase()){case"translation.hypothesis":u(t.TranslationHypothesis.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.response":const p=JSON.parse(s.textBody);if(p.SpeechPhrase)await l(t.TranslationPhrase.fromTranslationResponse(p,this.privRequestSession.currentTurnAudioOffset));else{const g=JSON.parse(s.textBody);g.SpeechHypothesis&&u(t.TranslationHypothesis.fromTranslationResponse(g,this.privRequestSession.currentTurnAudioOffset))}break;case"translation.phrase":await l(t.TranslationPhrase.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.synthesis":case"audio":this.sendSynthesisAudio(s.binaryBody,this.privRequestSession.sessionId),a=!0;break;case"audio.end":case"translation.synthesis.end":const f=t.TranslationSynthesisEnd.fromJSON(s.textBody);switch(f.SynthesisStatus){case t.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){const g=new e.TranslationSynthesisResult(e.ResultReason.Canceled,void 0),m=new e.TranslationSynthesisEventArgs(g,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,m)}catch{}}if(this.privTranslationRecognizer.canceled){const g=new e.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,e.CancellationReason.Error,f.FailureReason,e.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,g)}catch{}}break;case t.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break}a=!0;break}return a}cancelRecognition(s,o,a,l,u){const p=new e.PropertyCollection;if(p.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[l]),this.privTranslationRecognizer.canceled){const f=new e.TranslationRecognitionCanceledEventArgs(s,a,u,l,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,f)}catch{}}if(this.privSuccessCallback){const f=new e.TranslationRecognitionResult(void 0,o,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,u,void 0,p);try{this.privSuccessCallback(f),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(s,o,a){try{const l=new e.TranslationRecognitionEventArgs(e.TranslationRecognitionResult.fromSpeechRecognitionResult(s),o,a);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,l)}catch{}}handleRecognizedCallback(s,o,a){try{const l=new e.TranslationRecognitionEventArgs(e.TranslationRecognitionResult.fromSpeechRecognitionResult(s),o,a);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,l)}catch{}}fireEventForResult(s,o){let a;if(s.Translation.Translations!==void 0){a=new e.Translations;for(const m of s.Translation.Translations)a.set(m.Language,m.Text||m.DisplayText)}let l,u;s instanceof t.TranslationPhrase?(s.Translation&&s.Translation.TranslationStatus===n.TranslationStatus.Success?l=e.ResultReason.TranslatedSpeech:l=e.ResultReason.RecognizedSpeech,u=s.Confidence):l=e.ResultReason.TranslatingSpeech;const p=s.Language,f=new e.TranslationRecognitionResult(a,this.privRequestSession.requestId,l,s.Text,s.Duration,s.Offset,p,u,s.Translation.FailureReason,s.asJson(),o);return new e.TranslationRecognitionEventArgs(f,s.Offset,this.privRequestSession.sessionId)}sendSynthesisAudio(s,o){const a=s===void 0?e.ResultReason.SynthesizingAudioCompleted:e.ResultReason.SynthesizingAudio,l=new e.TranslationSynthesisResult(a,s),u=new e.TranslationSynthesisEventArgs(l,o);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,u)}catch{}}};return Wg.TranslationServiceRecognizer=r,Wg}var qg={},uM;function g3(){if(uM)return qg;uM=1,Object.defineProperty(qg,"__esModule",{value:!0}),qg.SpeechDetected=void 0;let n=class gO{constructor(t,r){this.privSpeechStartDetected=JSON.parse(t),this.privSpeechStartDetected.Offset+=r}static fromJSON(t,r){return new gO(t,r)}get Offset(){return this.privSpeechStartDetected.Offset}};return qg.SpeechDetected=n,qg}var Vg={},dM;function v3(){if(dM)return Vg;dM=1,Object.defineProperty(Vg,"__esModule",{value:!0}),Vg.SpeechHypothesis=void 0;let n=class vO{constructor(t,r){this.privSpeechHypothesis=JSON.parse(t),this.updateOffset(r)}static fromJSON(t,r){return new vO(t,r)}updateOffset(t){this.privSpeechHypothesis.Offset+=t}asJson(){return JSON.stringify(this.privSpeechHypothesis)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};return Vg.SpeechHypothesis=n,Vg}var Gg={},hM;function m3(){if(hM)return Gg;hM=1,Object.defineProperty(Gg,"__esModule",{value:!0}),Gg.SpeechKeyword=void 0;let n=class mO{constructor(t,r){this.privSpeechKeyword=JSON.parse(t),this.privSpeechKeyword.Offset+=r}static fromJSON(t,r){return new mO(t,r)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}asJson(){return JSON.stringify(this.privSpeechKeyword)}};return Gg.SpeechKeyword=n,Gg}var Kg={},pM;function y3(){if(pM)return Kg;pM=1,Object.defineProperty(Kg,"__esModule",{value:!0}),Kg.SpeechServiceRecognizer=void 0;const n=me(),e=ke();let t=class extends e.ServiceRecognizerBase{constructor(i,s,o,a,l){super(i,s,o,a,l),this.privSpeechRecognizer=l}async processTypeSpecificMessages(i){let s;const o=new n.PropertyCollection;let a=!1;switch(i.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const l=e.SpeechHypothesis.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);o.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,l.asJson()),s=new n.SpeechRecognitionResult(this.privRequestSession.requestId,n.ResultReason.RecognizingSpeech,l.Text,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,void 0,void 0,l.asJson(),o),this.privRequestSession.onHypothesis(l.Offset);const u=new n.SpeechRecognitionEventArgs(s,l.Offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,u)}catch{}a=!0;break;case"speech.phrase":const p=e.SimpleSpeechPhrase.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);o.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,p.asJson());const f=e.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(p.Offset+p.Duration),n.ResultReason.Canceled===f){const g=e.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus),m=e.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus);await this.cancelRecognitionLocal(g,m,e.EnumTranslation.implTranslateErrorDetails(m))}else{if(p.RecognitionStatus===e.RecognitionStatus.EndOfDictation)break;if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===n.OutputFormat[n.OutputFormat.Simple])s=new n.SpeechRecognitionResult(this.privRequestSession.requestId,f,p.DisplayText,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,void 0,void 0,p.asJson(),o);else{const m=e.DetailedSpeechPhrase.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);o.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,m.asJson()),s=new n.SpeechRecognitionResult(this.privRequestSession.requestId,f,m.RecognitionStatus===e.RecognitionStatus.Success?m.NBest[0].Display:"",m.Duration,m.Offset,m.Language,m.LanguageDetectionConfidence,void 0,void 0,m.asJson(),o)}const g=new n.SpeechRecognitionEventArgs(s,s.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,g)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(s)}catch(m){this.privErrorCallback&&this.privErrorCallback(m)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}a=!0;break}return a}cancelRecognition(i,s,o,a,l){const u=new n.PropertyCollection;if(u.setProperty(e.CancellationErrorCodePropertyName,n.CancellationErrorCode[a]),this.privSpeechRecognizer.canceled){const p=new n.SpeechRecognitionCanceledEventArgs(o,l,a,void 0,i);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,p)}catch{}}if(this.privSuccessCallback){const p=new n.SpeechRecognitionResult(s,n.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,l,void 0,u);try{this.privSuccessCallback(p),this.privSuccessCallback=void 0}catch{}}}};return Kg.SpeechServiceRecognizer=t,Kg}var $g={},WA={},fM;function S3(){return fM||(fM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.IdentityProvider=n.SpeakerDiarizationMode=void 0,(function(e){e.None="None",e.Identity="Identity",e.Anonymous="Anonymous"})(n.SpeakerDiarizationMode||(n.SpeakerDiarizationMode={})),(function(e){e.CallCenter="CallCenter"})(n.IdentityProvider||(n.IdentityProvider={}))})(WA)),WA}var gM;function C3(){if(gM)return $g;gM=1,Object.defineProperty($g,"__esModule",{value:!0}),$g.ConversationTranscriptionServiceRecognizer=void 0;const n=me(),e=ke(),t=S3(),r=rs();let i=class extends e.ServiceRecognizerBase{constructor(o,a,l,u,p){super(o,a,l,u,p),this.privConversationTranscriber=p,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const o=this.privSpeechContext.getContext().phraseDetection||{};o.mode=r.RecognitionMode.Conversation;const a={};a.mode=t.SpeakerDiarizationMode.Anonymous,a.audioSessionId=this.privDiarizationSessionId,a.audioOffsetMs=0,a.diarizeIntermediates=this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceResponse_DiarizeIntermediateResults,"false")==="true",o.speakerDiarization=a,this.privSpeechContext.getContext().phraseDetection=o}}async processTypeSpecificMessages(o){let a;const l=new n.PropertyCollection;l.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,o.textBody);let u=!1;switch(o.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const p=e.SpeechHypothesis.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);a=new n.ConversationTranscriptionResult(this.privRequestSession.requestId,n.ResultReason.RecognizingSpeech,p.Text,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,p.SpeakerId,void 0,p.asJson(),l),this.privRequestSession.onHypothesis(p.Offset);const f=new n.ConversationTranscriptionEventArgs(a,p.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,f)}catch{}u=!0;break;case"speech.phrase":const g=e.SimpleSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset),m=e.EnumTranslation.implTranslateRecognitionResult(g.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(g.Offset+g.Duration),n.ResultReason.Canceled===m){const C=e.EnumTranslation.implTranslateCancelResult(g.RecognitionStatus),S=e.EnumTranslation.implTranslateCancelErrorCode(g.RecognitionStatus);await this.cancelRecognitionLocal(C,S,e.EnumTranslation.implTranslateErrorDetails(S))}else if(!(this.privRequestSession.isSpeechEnded&&m===n.ResultReason.NoMatch&&g.RecognitionStatus!==e.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===n.OutputFormat[n.OutputFormat.Simple])a=new n.ConversationTranscriptionResult(this.privRequestSession.requestId,m,g.DisplayText,g.Duration,g.Offset,g.Language,g.LanguageDetectionConfidence,g.SpeakerId,void 0,g.asJson(),l);else{const S=e.DetailedSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);a=new n.ConversationTranscriptionResult(this.privRequestSession.requestId,m,S.RecognitionStatus===e.RecognitionStatus.Success?S.NBest[0].Display:void 0,S.Duration,S.Offset,S.Language,S.LanguageDetectionConfidence,g.SpeakerId,void 0,S.asJson(),l)}const C=new n.ConversationTranscriptionEventArgs(a,a.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,C)}catch{}}u=!0;break}return u}cancelRecognition(o,a,l,u,p){if(new n.PropertyCollection().setProperty(e.CancellationErrorCodePropertyName,n.CancellationErrorCode[u]),this.privConversationTranscriber.canceled){const g=new n.ConversationTranscriptionCanceledEventArgs(l,p,u,void 0,o);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,g)}catch{}}}};return $g.ConversationTranscriptionServiceRecognizer=i,$g}var Jg={},vM;function b3(){if(vM)return Jg;vM=1,Object.defineProperty(Jg,"__esModule",{value:!0}),Jg.TranscriptionServiceRecognizer=void 0;const n=Oe(),e=me(),t=ke(),r=U0();let i=class extends t.ConversationServiceRecognizer{constructor(o,a,l,u,p){super(o,a,l,u,p),this.privTranscriberRecognizer=p,this.sendPrePayloadJSONOverride=f=>this.sendTranscriptionStartJSON(f),this.privRecognizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(o,a){if(this.privRequestSession.isRecognizing){const l=await this.fetchConnection();await this.sendSpeechEvent(l,this.createSpeechEventPayload(o,a))}}async sendMeetingSpeechEventAsync(o,a){if(this.privRequestSession.isRecognizing){const l=await this.fetchConnection();await this.sendSpeechEvent(l,this.createMeetingSpeechEventPayload(o,a))}}processTypeSpecificMessages(o){return this.processSpeechMessages(o)}handleRecognizedCallback(o,a,l){try{const u=new e.SpeechRecognitionEventArgs(o,a,l);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,u),this.privSuccessCallback){try{this.privSuccessCallback(o)}catch(p){this.privErrorCallback&&this.privErrorCallback(p)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(o,a,l){try{const u=new e.SpeechRecognitionEventArgs(o,a,l);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,u)}catch{}}cancelRecognition(o,a,l,u,p){const f=new e.PropertyCollection;if(f.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[u]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const g=new e.MeetingTranscriptionCanceledEventArgs(l,p,u,void 0,o);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,g)}catch{}}}else if(this.privTranscriberRecognizer.canceled){const g=new e.ConversationTranscriptionCanceledEventArgs(l,p,u,void 0,o);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,g)}catch{}}if(this.privSuccessCallback){const g=new e.SpeechRecognitionResult(a,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,p,void 0,f);try{this.privSuccessCallback(g),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(o){if(await this.sendSpeechContext(o,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const a=this.privTranscriberRecognizer.getMeetingInfo(),l=this.createMeetingSpeechEventPayload(a,"start");await this.sendSpeechEvent(o,l)}else{const a=this.privTranscriberRecognizer.getConversationInfo(),l=this.createSpeechEventPayload(a,"start");await this.sendSpeechEvent(o,l)}await this.sendWaveHeader(o)}sendSpeechEvent(o,a){const l=JSON.stringify(a);if(l)return o.send(new r.SpeechConnectionMessage(n.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",l))}createSpeechEventPayload(o,a){const l={id:"meeting",name:a,meeting:o.conversationProperties};return l.meeting.id=o.id,l.meeting.attendees=o.participants,l}createMeetingSpeechEventPayload(o,a){const l={id:"meeting",name:a,meeting:o.meetingProperties};return l.meeting.id=o.id,l.meeting.attendees=o.participants,l}};return Jg.TranscriptionServiceRecognizer=i,Jg}var Xg={},mM;function w3(){if(mM)return Xg;mM=1,Object.defineProperty(Xg,"__esModule",{value:!0}),Xg.DetailedSpeechPhrase=void 0;const n=ke();let e=class yO{constructor(r,i){this.privDetailedSpeechPhrase=JSON.parse(r),this.privDetailedSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privDetailedSpeechPhrase.RecognitionStatus),this.updateOffsets(i)}static fromJSON(r,i){return new yO(r,i)}updateOffsets(r){if(this.privDetailedSpeechPhrase.Offset+=r,this.privDetailedSpeechPhrase.NBest)for(const i of this.privDetailedSpeechPhrase.NBest){if(i.Words)for(const s of i.Words)s.Offset+=r;if(i.DisplayWords)for(const s of i.DisplayWords)s.Offset+=r}}asJson(){const r={...this.privDetailedSpeechPhrase};return JSON.stringify({...r,RecognitionStatus:n.RecognitionStatus[r.RecognitionStatus]})}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}mapRecognitionStatus(r){if(typeof r=="string")return n.RecognitionStatus[r];if(typeof r=="number")return r}};return Xg.DetailedSpeechPhrase=e,Xg}var Yg={},yM;function A3(){if(yM)return Yg;yM=1,Object.defineProperty(Yg,"__esModule",{value:!0}),Yg.SimpleSpeechPhrase=void 0;const n=ke();let e=class SO{constructor(r,i=0){this.privSimpleSpeechPhrase=JSON.parse(r),this.privSimpleSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privSimpleSpeechPhrase.RecognitionStatus),this.updateOffset(i)}static fromJSON(r,i){return new SO(r,i)}updateOffset(r){this.privSimpleSpeechPhrase.Offset+=r}asJson(){const r={...this.privSimpleSpeechPhrase};return JSON.stringify({...r,RecognitionStatus:n.RecognitionStatus[r.RecognitionStatus]})}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}mapRecognitionStatus(r){if(typeof r=="string")return n.RecognitionStatus[r];if(typeof r=="number")return r}};return Yg.SimpleSpeechPhrase=e,Yg}var Qg={},Zg={},SM;function E3(){if(SM)return Zg;SM=1,Object.defineProperty(Zg,"__esModule",{value:!0}),Zg.ServiceTelemetryListener=void 0;const n=Oe(),e=rP();class t{constructor(i,s,o){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=i,this.privAudioSourceId=s,this.privAudioNodeId=o,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(i){i>0&&this.privPhraseLatencies.push(Date.now()-i)}hypothesisReceived(i){i>0&&this.privHypothesisLatencies.push(Date.now()-i)}onEvent(i){this.privIsDisposed||(i instanceof e.RecognitionTriggeredEvent&&i.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:i.eventTime,Name:"ListeningTrigger",Start:i.eventTime}),i instanceof n.AudioStreamNodeAttachingEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof n.AudioStreamNodeAttachedEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof n.AudioSourceErrorEvent&&i.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof n.AudioStreamNodeErrorEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof n.AudioStreamNodeDetachedEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Name:"Microphone",Start:this.privMicStartTime})),i instanceof e.ConnectingToServiceEvent&&i.requestId===this.privRequestId&&(this.privConnectionId=i.sessionId),i instanceof n.ConnectionStartEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionStartTime=i.eventTime),i instanceof n.ConnectionEstablishedEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof n.ConnectionEstablishErrorEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Error:this.getConnectionError(i.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof n.ConnectionMessageReceivedEvent&&i.connectionId===this.privConnectionId&&i.message&&i.message.headers&&i.message.headers.path&&(this.privReceivedMessages[i.message.headers.path]||(this.privReceivedMessages[i.message.headers.path]=new Array),this.privReceivedMessages[i.message.headers.path].length<50&&this.privReceivedMessages[i.message.headers.path].push(i.networkReceivedTime)))}getTelemetry(){const i=new Array;this.privListeningTriggerMetric&&i.push(this.privListeningTriggerMetric),this.privMicMetric&&i.push(this.privMicMetric),this.privConnectionEstablishMetric&&i.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&i.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&i.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const s={Metrics:i,ReceivedMessages:this.privReceivedMessages},o=JSON.stringify(s);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],o}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(i){switch(i){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+i.toString()}}}return Zg.ServiceTelemetryListener=t,Zg}var CM;function R3(){if(CM)return Qg;CM=1,Object.defineProperty(Qg,"__esModule",{value:!0}),Qg.RequestSession=void 0;const n=Oe(),e=rP(),t=E3();let r=class{constructor(s){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=s,this.privRequestId=(0,n.createNoDashGuid)(),this.privAudioNodeId=(0,n.createNoDashGuid)(),this.privTurnDeferral=new n.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(s){this.privServiceTelemetryListener&&this.privDetachables.push(s.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new t.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new e.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(s,o){this.privAudioNode=s,this.privIsAudioNodeDetached=!1,o?await this.onComplete():this.onEvent(new e.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(s,o){this.privAuthFetchEventId=s,this.privSessionId=o,this.onEvent(new e.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(s){s&&await this.onComplete()}async onConnectionEstablishCompleted(s,o){if(s===200){this.onEvent(new e.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else s===403&&await this.onComplete()}async onServiceTurnEndResponse(s){this.privTurnDeferral.resolve(),!s||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=(0,n.createNoDashGuid)()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new n.Deferred}onHypothesis(s){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(s)))}onPhraseRecognized(s){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(s)),this.onServiceRecognized(s)}onServiceRecognized(s){this.privLastRecoOffset=s,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(s),this.privConnectionAttempts=0}onAudioSent(s){this.privBytesSent+=s,this.privRecognitionBytesSent+=s}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const s of this.privDetachables)await s.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(s){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(s),n.Events.instance.onEvent(s)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}};return Qg.RequestSession=r,Qg}var ev={},qA={},bM;function P3(){return bM||(bM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.TentativePhraseResultsOption=n.OutputFormat=n.PhraseExtension=n.PhraseOption=void 0,(function(e){e.WordTimings="WordTimings",e.SNR="SNR",e.Pronunciation="Pronunciation",e.WordPronunciation="WordPronunciation",e.WordConfidence="WordConfidence",e.Words="Words",e.Sentiment="Sentiment",e.PronunciationAssessment="PronunciationAssessment",e.ContentAssessment="ContentAssessment",e.PhraseAMScore="PhraseAMScore",e.PhraseLMScore="PhraseLMScore",e.WordAMScore="WordAMScore",e.WordLMScore="WordLMScore",e.RuleTree="RuleTree",e.NBestTimings="NBestTimings",e.DecoderDiagnostics="DecoderDiagnostics",e.DisplayWordTimings="DisplayWordTimings",e.DisplayWords="DisplayWords"})(n.PhraseOption||(n.PhraseOption={})),(function(e){e.Graph="Graph",e.Corrections="Corrections",e.Sentiment="Sentiment"})(n.PhraseExtension||(n.PhraseExtension={})),(function(e){e.Simple="Simple",e.Detailed="Detailed"})(n.OutputFormat||(n.OutputFormat={})),(function(e){e.None="None",e.Always="Always"})(n.TentativePhraseResultsOption||(n.TentativePhraseResultsOption={}))})(qA)),qA}var wM;function T3(){if(wM)return ev;wM=1,Object.defineProperty(ev,"__esModule",{value:!0}),ev.SpeechContext=void 0;const n=rs(),e=P3();let t=class{constructor(i){this.privContext={},this.privDynamicGrammar=i}getContext(){return this.privContext}setPronunciationAssessmentParams(i,s=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(i)||{},s&&(this.privContext.phraseDetection.mode=n.RecognitionMode.Conversation),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push(e.PhraseOption.PronunciationAssessment),this.privContext.phraseOutput.detailed.options.indexOf(e.PhraseOption.SNR)===-1&&this.privContext.phraseOutput.detailed.options.push(e.PhraseOption.SNR)}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=e.OutputFormat.Detailed}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=e.OutputFormat.Detailed,this.privContext.phraseOutput.detailed.options.indexOf(e.PhraseOption.WordTimings)===-1&&this.privContext.phraseOutput.detailed.options.push(e.PhraseOption.WordTimings)}setSpeakerDiarizationAudioOffsetMs(i){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=i}toJSON(){const i=this.privDynamicGrammar.generateGrammarObject();return this.privContext.dgi=i,JSON.stringify(this.privContext)}};return ev.SpeechContext=t,ev}var tv={},VA={},AM;function x3(){return AM||(AM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SubstringMatchType=n.GroupType=void 0,(function(e){e.IntentText="IntentText",e.IntentEntity="IntentEntity",e.Generic="Generic",e.People="People",e.Place="Place",e.DynamicEntity="DynamicEntity"})(n.GroupType||(n.GroupType={})),(function(e){e.None="None",e.LeftRooted="LeftRooted",e.PartialName="PartialName",e.MiddleOfSentence="MiddleOfSentence"})(n.SubstringMatchType||(n.SubstringMatchType={}))})(VA)),VA}var EM;function I3(){if(EM)return tv;EM=1,Object.defineProperty(tv,"__esModule",{value:!0}),tv.DynamicGrammarBuilder=void 0;const n=x3();let e=class{constructor(){this.privWeight=1}addPhrase(r){this.privPhrases||(this.privPhrases=[]),r instanceof Array?this.privPhrases=this.privPhrases.concat(r):this.privPhrases.push(r)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(r){this.privGrammars||(this.privGrammars=[]),r instanceof Array?this.privGrammars=this.privGrammars.concat(r):this.privGrammars.push(r)}clearGrammars(){this.privGrammars=void 0}setWeight(r){this.privWeight=r}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const r={};if(r.referenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const i=[];this.privPhrases.forEach(s=>{i.push({text:s})}),r.groups=[{type:n.GroupType.Generic,items:i}],r.bias=this.privWeight}return r}};return tv.DynamicGrammarBuilder=e,tv}var nv={},rv={},iv={},GA={},RM;function CO(){return RM||(RM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.MessageDataStreamType=n.ActivityPayloadResponse=void 0;class e{constructor(r){this.privActivityResponse=JSON.parse(r)}static fromJSON(r){return new e(r)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}n.ActivityPayloadResponse=e,(function(t){t[t.None=0]="None",t[t.TextToSpeechAudio=1]="TextToSpeechAudio"})(n.MessageDataStreamType||(n.MessageDataStreamType={}))})(GA)),GA}var PM;function _3(){if(PM)return iv;PM=1,Object.defineProperty(iv,"__esModule",{value:!0}),iv.DialogServiceTurnState=void 0;const n=Gy(),e=Vh(),t=CO();let r=class{constructor(s,o){this.privRequestId=o,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=s,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(s,o){return s.messageDataStreamType===t.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=e.AudioOutputStream.createPullStream(),this.privAudioStream.format=o!==void 0?o:n.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};return iv.DialogServiceTurnState=r,iv}var TM;function k3(){if(TM)return rv;TM=1,Object.defineProperty(rv,"__esModule",{value:!0}),rv.DialogServiceTurnStateManager=void 0;const n=Ws(),e=_3();let t=class{constructor(){this.privTurnMap=new Map}StartTurn(i){if(this.privTurnMap.has(i))throw new n.InvalidOperationError("Service error: There is already a turn with id:"+i);const s=new e.DialogServiceTurnState(this,i);return this.privTurnMap.set(i,s),this.privTurnMap.get(i)}GetTurn(i){return this.privTurnMap.get(i)}CompleteTurn(i){if(!this.privTurnMap.has(i))throw new n.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+i);const s=this.privTurnMap.get(i);return s.complete(),this.privTurnMap.delete(i),s}};return rv.DialogServiceTurnStateManager=t,rv}var KA={},xM;function M3(){return xM||(xM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.InvocationSource=void 0,(function(e){e.None="None",e.VoiceActivationWithKeyword="VoiceActivationWithKeyword"})(n.InvocationSource||(n.InvocationSource={}))})(KA)),KA}var $A={},IM;function D3(){return IM||(IM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnRejectAction=n.KeywordDetectionType=void 0,(function(e){e.StartTrigger="StartTrigger"})(n.KeywordDetectionType||(n.KeywordDetectionType={})),(function(e){e.EndOfTurn="EndOfTurn",e.Continue="Continue"})(n.OnRejectAction||(n.OnRejectAction={}))})($A)),$A}var _M;function N3(){if(_M)return nv;_M=1,Object.defineProperty(nv,"__esModule",{value:!0}),nv.DialogServiceAdapter=void 0;const n=Pr(),e=kN(),t=Oe(),r=Gy(),i=me(),s=k3(),o=ke(),a=CO(),l=M3(),u=D3(),p=U0();let f=class extends o.ServiceRecognizerBase{constructor(m,C,S,w,b){super(m,C,S,w,b),this.privEvents=new t.EventSource,this.privDialogServiceConnector=b,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new s.DialogServiceTurnStateManager,this.recognizeOverride=(R,P,I)=>this.listenOnce(R,P,I),this.postConnectImplOverride=R=>this.dialogConnectImpl(R),this.configConnectionOverride=R=>this.configConnection(R),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=S,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(R=>{R.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(m){const C=(0,t.createGuid)(),S=(0,t.createNoDashGuid)(),w={context:{interactionId:C},messagePayload:JSON.parse(m),version:.5},b=JSON.stringify(w);await(await this.fetchConnection()).send(new p.SpeechConnectionMessage(t.MessageType.Text,"agent",S,"application/json",b))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(m){const C=new i.PropertyCollection;m.messageType===t.MessageType.Text&&C.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,m.textBody);let S,w;switch(m.path.toLowerCase()){case"speech.phrase":const R=o.SimpleSpeechPhrase.fromJSON(m.textBody,this.privRequestSession.currentTurnAudioOffset);if(this.privRequestSession.onPhraseRecognized(R.Offset+R.Duration),R.RecognitionStatus!==o.RecognitionStatus.TooManyRequests&&R.RecognitionStatus!==o.RecognitionStatus.Error){const O=this.fireEventForResult(R,C);if(this.privLastResult=O.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,O)}catch{}}w=!0;break;case"speech.hypothesis":const P=o.SpeechHypothesis.fromJSON(m.textBody,this.privRequestSession.currentTurnAudioOffset);S=new i.SpeechRecognitionResult(this.privRequestSession.requestId,i.ResultReason.RecognizingSpeech,P.Text,P.Duration,P.Offset,P.Language,P.LanguageDetectionConfidence,void 0,void 0,P.asJson(),C),this.privRequestSession.onHypothesis(P.Offset);const I=new i.SpeechRecognitionEventArgs(S,P.Offset,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,I)}catch{}w=!0;break;case"speech.keyword":const M=o.SpeechKeyword.fromJSON(m.textBody,this.privRequestSession.currentTurnAudioOffset);S=new i.SpeechRecognitionResult(this.privRequestSession.requestId,M.Status==="Accepted"?i.ResultReason.RecognizedKeyword:i.ResultReason.NoMatch,M.Text,M.Duration,M.Offset,void 0,void 0,void 0,void 0,M.asJson(),C),M.Status!=="Accepted"&&(this.privLastResult=S);const k=new i.SpeechRecognitionEventArgs(S,S.duration,S.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,k)}catch{}w=!0;break;case"audio":{const O=m.requestId.toUpperCase(),L=this.privTurnStateManager.GetTurn(O);try{m.binaryBody?L.audioStream.write(m.binaryBody):L.endAudioStream()}catch{}}w=!0;break;case"response":this.handleResponseMessage(m),w=!0;break}const b=new t.Deferred;return b.resolve(w),b.promise}async cancelRecognition(m,C,S,w,b){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const R=new i.PropertyCollection;R.setProperty(o.CancellationErrorCodePropertyName,i.CancellationErrorCode[w]);const P=new i.SpeechRecognitionCanceledEventArgs(S,b,w,void 0,m);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,P)}catch{}if(this.privSuccessCallback){const I=new i.SpeechRecognitionResult(void 0,i.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,b,void 0,R);try{this.privSuccessCallback(I),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(m,C,S){this.privRecognizerConfig.recognitionMode=m,this.privSuccessCallback=C,this.privErrorCallback=S,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(i.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const w=this.connectImpl(),b=this.sendPreAudioMessages(),R=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),P=await this.privDialogAudioSource.format,I=await this.privDialogAudioSource.deviceInfo,M=new n.ReplayableAudioNode(R,P.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(M,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:I};try{await w,await b}catch(L){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,L),Promise.resolve()}const k=new i.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,k),this.sendAudio(M).then(()=>{},async L=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,L)})}dialogConnectImpl(m){return this.privConnectionLoop=this.startMessageLoop(),m}receiveDialogMessageOverride(){const m=new t.Deferred,C=async()=>{try{const S=this.isDisposed(),w=!this.isDisposed()&&this.terminateMessageLoop;if(S||w){m.resolve(void 0);return}const R=await(await this.fetchConnection()).read();if(!R)return C();const P=p.SpeechConnectionMessage.fromConnectionMessage(R);switch(P.path.toLowerCase()){case"turn.start":{const H=P.requestId.toUpperCase(),V=this.privRequestSession.requestId.toUpperCase();H!==V?this.privTurnStateManager.StartTurn(H):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const M=o.SpeechDetected.fromJSON(P.textBody,this.privRequestSession.currentTurnAudioOffset),k=new i.RecognitionEventArgs(M.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,k);break;case"speech.enddetected":let O;P.textBody.length>0?O=P.textBody:O="{ Offset: 0 }";const L=o.SpeechDetected.fromJSON(O,this.privRequestSession.currentTurnAudioOffset);this.privRequestSession.onServiceRecognized(L.Offset);const F=new i.RecognitionEventArgs(L.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,F);break;case"turn.end":{const H=P.requestId.toUpperCase(),V=this.privRequestSession.requestId.toUpperCase();if(H!==V)this.privTurnStateManager.CompleteTurn(H);else{const ie=new i.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,ie),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(J){this.privErrorCallback&&this.privErrorCallback(J)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(P)||this.serviceEvents&&this.serviceEvents.onEvent(new t.ServiceEvent(P.path.toLowerCase(),P.textBody))}catch{}}return C()}catch{this.terminateMessageLoop=!0,m.resolve()}};return C().catch(S=>{t.Events.instance.onEvent(new t.BackgroundEvent(S))}),m.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(m){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,m)}return Promise.resolve()}async configConnection(m){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(m,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(m),m)}async sendPreAudioMessages(){const m=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(m,!0),await this.sendAgentContext(m),await this.sendWaveHeader(m)}sendAgentConfig(m){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Conversation_DialogType)===i.DialogServiceConfig.DialogTypes.CustomCommands){const S=this.agentConfig.get();S.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(S)}this.onEvent(new e.SendingAgentContextMessageEvent(this.agentConfig));const C=this.agentConfig.toJsonString();return this.agentConfigSent=!0,m.send(new p.SpeechConnectionMessage(t.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",C))}}sendAgentContext(m){const C=(0,t.createGuid)(),S=this.privDialogServiceConnector.properties.getProperty(i.PropertyId.Conversation_Speech_Activity_Template),b=JSON.stringify({channelData:"",context:{interactionId:C},messagePayload:typeof S===void 0?void 0:S,version:.5});return m.send(new p.SpeechConnectionMessage(t.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",b))}fireEventForResult(m,C){const S=o.EnumTranslation.implTranslateRecognitionResult(m.RecognitionStatus),w=new i.SpeechRecognitionResult(this.privRequestSession.requestId,S,m.DisplayText,m.Duration,m.Offset,m.Language,m.LanguageDetectionConfidence,void 0,void 0,m.asJson(),C);return new i.SpeechRecognitionEventArgs(w,m.Offset,this.privRequestSession.sessionId)}handleResponseMessage(m){const C=JSON.parse(m.textBody);switch(C.messageType.toLowerCase()){case"message":const S=m.requestId.toUpperCase(),w=a.ActivityPayloadResponse.fromJSON(m.textBody),b=this.privTurnStateManager.GetTurn(S);if(w.conversationId){const I=this.agentConfig.get();I.botInfo.conversationId=w.conversationId,this.agentConfig.set(I)}const R=b.processActivityPayload(w,r.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),P=new i.ActivityReceivedEventArgs(w.messagePayload,R);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,P)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new i.TurnStatusReceivedEventArgs(m.textBody))}catch{}break;default:t.Events.instance.onEvent(new t.BackgroundEvent(`Unexpected response of type ${C.messageType}. Ignoring.`));break}}onEvent(m){this.privEvents.onEvent(m),t.Events.instance.onEvent(m)}addKeywordContextData(){const m=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(m===void 0)return;const C=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),S=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),w=m.split(";"),b=C===void 0?[]:C.split(";"),R=S===void 0?[]:S.split(";"),P=[];for(let I=0;I<w.length;I++){const M={text:w[I]};I<b.length&&(M.startOffset=Number(b[I])),I<R.length&&(M.duration=Number(R[I])),P.push(M)}this.speechContext.getContext().invocationSource=l.InvocationSource.VoiceActivationWithKeyword,this.speechContext.getContext().keywordDetection=[{clientDetectedKeywords:P,onReject:{action:u.OnRejectAction.EndOfTurn},type:u.KeywordDetectionType.StartTrigger}]}};return nv.DialogServiceAdapter=f,nv}var sv={},kM;function O3(){if(kM)return sv;kM=1,Object.defineProperty(sv,"__esModule",{value:!0}),sv.AgentConfig=void 0;let n=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(t){this.iPrivConfig=t}};return sv.AgentConfig=n,sv}var JA={},ov={},av={},MM;function cP(){if(MM)return av;MM=1,Object.defineProperty(av,"__esModule",{value:!0}),av.ConversationConnectionConfig=void 0;const n=pO();let e=class Aa extends n.RestConfigBase{static get host(){return Aa.privHost}static get apiVersion(){return Aa.privApiVersion}static get clientAppId(){return Aa.privClientAppId}static get defaultLanguageCode(){return Aa.privDefaultLanguageCode}static get restPath(){return Aa.privRestPath}static get webSocketPath(){return Aa.privWebSocketPath}static get transcriptionEventKeys(){return Aa.privTranscriptionEventKeys}};return av.ConversationConnectionConfig=e,e.privHost="dev.microsofttranslator.com",e.privRestPath="/capito/room",e.privApiVersion="2.0",e.privDefaultLanguageCode="en-US",e.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",e.privWebSocketPath="/capito/translate",e.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"],av}var DM;function L3(){if(DM)return ov;DM=1,Object.defineProperty(ov,"__esModule",{value:!0}),ov.ConversationManager=void 0;const n=Pr(),e=et(),t=me(),r=cP();let i=class{constructor(){this.privRequestParams=r.ConversationConnectionConfig.configParams,this.privErrors=r.ConversationConnectionConfig.restErrors,this.privHost=r.ConversationConnectionConfig.host,this.privApiVersion=r.ConversationConnectionConfig.apiVersion,this.privRestPath=r.ConversationConnectionConfig.restPath,this.privRestAdapter=new n.RestMessageAdapter({})}createOrJoin(o,a,l,u){try{e.Contracts.throwIfNullOrUndefined(o,"args");const p=o.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,r.ConversationConnectionConfig.defaultLanguageCode),f=o.getProperty(t.PropertyId.ConversationTranslator_Name,"conversation_host"),g=o.getProperty(t.PropertyId.ConversationTranslator_Host,this.privHost),m=o.getProperty(t.PropertyId.ConversationTranslator_CorrelationId),C=o.getProperty(t.PropertyId.SpeechServiceConnection_Key),S=o.getProperty(t.PropertyId.SpeechServiceConnection_Region),w=o.getProperty(t.PropertyId.SpeechServiceAuthorization_Token);e.Contracts.throwIfNullOrWhitespace(p,"languageCode"),e.Contracts.throwIfNullOrWhitespace(f,"nickname"),e.Contracts.throwIfNullOrWhitespace(g,"endpointHost");const b={};b[this.privRequestParams.apiVersion]=this.privApiVersion,b[this.privRequestParams.languageCode]=p,b[this.privRequestParams.nickname]=f;const R={};m&&(R[this.privRequestParams.correlationId]=m),R[this.privRequestParams.clientAppId]=r.ConversationConnectionConfig.clientAppId,a!==void 0?b[this.privRequestParams.roomId]=a:(e.Contracts.throwIfNullOrUndefined(S,this.privErrors.authInvalidSubscriptionRegion),R[this.privRequestParams.subscriptionRegion]=S,C?R[this.privRequestParams.subscriptionKey]=C:w?R[this.privRequestParams.authorization]=`Bearer ${w}`:e.Contracts.throwIfNullOrUndefined(C,this.privErrors.authInvalidSubscriptionKey));const P={};P.headers=R,this.privRestAdapter.options=P;const I=`https://${g}${this.privRestPath}`;this.privRestAdapter.request(n.RestRequestType.Post,I,b,null).then(M=>{const k=n.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,M.headers);if(!M.ok){if(u){let L=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",M.status.toString()),F;try{F=JSON.parse(M.data),L+=` [${F.error.code}: ${F.error.message}]`}catch{L+=` [${M.data}]`}k&&(L+=` ${k}`),u(L)}return}const O=JSON.parse(M.data);if(O&&(O.requestId=k),l){try{l(O)}catch(L){u&&u(L)}l=void 0}}).catch(()=>{})}catch(p){if(u)if(p instanceof Error){const f=p;u(f.name+": "+f.message)}else u(p)}}leave(o,a){return new Promise((l,u)=>{try{e.Contracts.throwIfNullOrUndefined(o,this.privErrors.invalidArgs.replace("{arg}","config")),e.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","token"));const p=o.getProperty(t.PropertyId.ConversationTranslator_Host,this.privHost),f=o.getProperty(t.PropertyId.ConversationTranslator_CorrelationId),g={};g[this.privRequestParams.apiVersion]=this.privApiVersion,g[this.privRequestParams.sessionToken]=a;const m={};f&&(m[this.privRequestParams.correlationId]=f);const C={};C.headers=m,this.privRestAdapter.options=C;const S=`https://${p}${this.privRestPath}`;this.privRestAdapter.request(n.RestRequestType.Delete,S,g,null).then(w=>{w.ok,l()}).catch(()=>{})}catch(p){if(p instanceof Error){const f=p;u(f.name+": "+f.message)}else u(p)}})}};return ov.ConversationManager=i,ov}var Yc={},cv={},lv={},uv={},NM;function bO(){if(NM)return uv;NM=1,Object.defineProperty(uv,"__esModule",{value:!0}),uv.ConversationConnectionMessage=void 0;const n=Oe();let e=class extends n.ConnectionMessage{constructor(r,i,s,o){super(r,i,s,o);const a=JSON.parse(this.textBody);a.type!==void 0&&(this.privConversationMessageType=a.type)}get conversationMessageType(){return this.privConversationMessageType}};return uv.ConversationConnectionMessage=e,uv}var OM;function j3(){if(OM)return lv;OM=1,Object.defineProperty(lv,"__esModule",{value:!0}),lv.ConversationWebsocketMessageFormatter=void 0;const n=Oe(),e=bO();let t=class{toConnectionMessage(i){const s=new n.Deferred;try{if(i.messageType===n.MessageType.Text){const o=new e.ConversationConnectionMessage(i.messageType,i.textContent,{},i.id);s.resolve(o)}else i.messageType===n.MessageType.Binary&&s.resolve(new e.ConversationConnectionMessage(i.messageType,i.binaryContent,void 0,i.id))}catch(o){s.reject(`Error formatting the message. Error: ${o}`)}return s.promise}fromConnectionMessage(i){const s=new n.Deferred;try{if(i.messageType===n.MessageType.Text){const o=`${i.textBody?i.textBody:""}`;s.resolve(new n.RawWebsocketMessage(n.MessageType.Text,o,i.id))}}catch(o){s.reject(`Error formatting the message. ${o}`)}return s.promise}};return lv.ConversationWebsocketMessageFormatter=t,lv}var LM;function z3(){if(LM)return cv;LM=1,Object.defineProperty(cv,"__esModule",{value:!0}),cv.ConversationConnectionFactory=void 0;const n=Pr(),e=Oe(),t=et(),r=me(),i=Xo(),s=cP(),o=j3();let a=class extends i.ConnectionFactoryBase{create(u,p,f){const g=u.parameters.getProperty(r.PropertyId.ConversationTranslator_Host,s.ConversationConnectionConfig.host),m=u.parameters.getProperty(r.PropertyId.ConversationTranslator_CorrelationId,(0,e.createGuid)()),C=`wss://${g}${s.ConversationConnectionConfig.webSocketPath}`,S=u.parameters.getProperty(r.PropertyId.ConversationTranslator_Token,void 0);t.Contracts.throwIfNullOrUndefined(S,"token");const w={};w[s.ConversationConnectionConfig.configParams.apiVersion]=s.ConversationConnectionConfig.apiVersion,w[s.ConversationConnectionConfig.configParams.token]=S,w[s.ConversationConnectionConfig.configParams.correlationId]=m;const b=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new n.WebsocketConnection(C,w,{},new o.ConversationWebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(u),b,f))}};return cv.ConversationConnectionFactory=a,cv}var dv={},hv={},jM;function F3(){if(jM)return hv;jM=1,Object.defineProperty(hv,"__esModule",{value:!0}),hv.ConversationRequestSession=void 0;const n=Oe();let e=class{constructor(r){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=r,this.privRequestId=(0,n.createNoDashGuid)(),this.privRequestCompletionDeferral=new n.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(r,i){this.privSessionId=i}onAuthCompleted(r){r&&this.onComplete()}onConnectionEstablishCompleted(r){r!==200&&r===403&&this.onComplete()}onServiceTurnEndResponse(r){r?this.privRequestId=(0,n.createNoDashGuid)():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const r of this.privDetachables)await r.detach()}}onComplete(){}};return hv.ConversationRequestSession=e,hv}var tr={},zM;function wO(){if(zM)return tr;zM=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.ConversationReceivedTranslationEventArgs=tr.ParticipantsListEventArgs=tr.ParticipantAttributeEventArgs=tr.ParticipantEventArgs=tr.LockRoomEventArgs=tr.MuteAllEventArgs=void 0;const n=me();class e extends n.SessionEventArgs{constructor(l,u){super(u),this.privIsMuted=l}get isMuted(){return this.privIsMuted}}tr.MuteAllEventArgs=e;class t extends n.SessionEventArgs{constructor(l,u){super(u),this.privIsLocked=l}get isMuted(){return this.privIsLocked}}tr.LockRoomEventArgs=t;class r extends n.SessionEventArgs{constructor(l,u){super(u),this.privParticipant=l}get participant(){return this.privParticipant}}tr.ParticipantEventArgs=r;class i extends n.SessionEventArgs{constructor(l,u,p,f){super(f),this.privKey=u,this.privValue=p,this.privParticipantId=l}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}tr.ParticipantAttributeEventArgs=i;class s extends n.SessionEventArgs{constructor(l,u,p,f,g,m,C,S,w){super(w),this.privRoomId=l,this.privSessionToken=u,this.privTranslateTo=p,this.privProfanityFilter=f,this.privRoomProfanityFilter=g,this.privIsRoomLocked=m,this.privIsRoomLocked=C,this.privParticipants=S}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}tr.ParticipantsListEventArgs=s;class o{constructor(l,u,p){this.privPayload=u,this.privCommand=l,this.privSessionId=p}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}return tr.ConversationReceivedTranslationEventArgs=o,tr}var no={},FM;function AO(){if(FM)return no;FM=1,Object.defineProperty(no,"__esModule",{value:!0}),no.ConversationTranslatorCommandTypes=no.ConversationTranslatorMessageTypes=no.InternalParticipants=void 0;class n{constructor(t=[],r){this.participants=t,this.meId=r}addOrUpdateParticipant(t){if(t===void 0)return;const r=this.getParticipantIndex(t.id);return r>-1?this.participants.splice(r,1,t):this.participants.push(t),this.getParticipant(t.id)}getParticipantIndex(t){return this.participants.findIndex(r=>r.id===t)}getParticipant(t){return this.participants.find(r=>r.id===t)}deleteParticipant(t){this.participants=this.participants.filter(r=>r.id!==t)}get host(){return this.participants.find(t=>t.isHost===!0)}get me(){return this.getParticipant(this.meId)}}return no.InternalParticipants=n,no.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},no.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"},no}var XA={},pv={},BM;function B3(){if(BM)return pv;BM=1,Object.defineProperty(pv,"__esModule",{value:!0}),pv.CommandResponsePayload=void 0;const n=t=>JSON.parse(t);let e=class EO{constructor(r){this.privCommandResponse=n(r)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(r){return new EO(r)}};return pv.CommandResponsePayload=e,pv}var Qc={},UM;function U3(){if(UM)return Qc;UM=1,Object.defineProperty(Qc,"__esModule",{value:!0}),Qc.ParticipantPayloadResponse=Qc.ParticipantsListPayloadResponse=void 0;const n=i=>JSON.parse(i),e=i=>JSON.parse(i);class t{constructor(s){this.privParticipantsPayloadResponse=n(s)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(s){return new t(s)}}Qc.ParticipantsListPayloadResponse=t;class r{constructor(s){this.privParticipantPayloadResponse=e(s)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(s){return new r(s)}}return Qc.ParticipantPayloadResponse=r,Qc}var Zc={},HM;function H3(){if(HM)return Zc;HM=1,Object.defineProperty(Zc,"__esModule",{value:!0}),Zc.TextResponsePayload=Zc.SpeechResponsePayload=void 0;const n=i=>JSON.parse(i),e=i=>JSON.parse(i);class t{constructor(s){this.privSpeechResponse=n(s)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(s){return new t(s)}}Zc.SpeechResponsePayload=t;class r{constructor(s){this.privTextResponse=e(s)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(s){return new r(s)}}return Zc.TextResponsePayload=r,Zc}var WM;function W3(){return WM||(WM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.TextResponsePayload=n.SpeechResponsePayload=n.ParticipantPayloadResponse=n.ParticipantsListPayloadResponse=n.CommandResponsePayload=void 0;var e=B3();Object.defineProperty(n,"CommandResponsePayload",{enumerable:!0,get:function(){return e.CommandResponsePayload}});var t=U3();Object.defineProperty(n,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return t.ParticipantsListPayloadResponse}}),Object.defineProperty(n,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return t.ParticipantPayloadResponse}});var r=H3();Object.defineProperty(n,"SpeechResponsePayload",{enumerable:!0,get:function(){return r.SpeechResponsePayload}}),Object.defineProperty(n,"TextResponsePayload",{enumerable:!0,get:function(){return r.TextResponsePayload}})})(XA)),XA}var qM;function q3(){if(qM)return dv;qM=1,Object.defineProperty(dv,"__esModule",{value:!0}),dv.ConversationServiceAdapter=void 0;const n=Oe(),e=me(),t=ke(),r=bO(),i=F3(),s=wO(),o=AO(),a=W3();let l=class extends t.ServiceRecognizerBase{constructor(p,f,g,m,C){super(p,f,g,m,C),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=C,this.privConversationAuthentication=p,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=S=>this.conversationConnectImpl(S),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new i.ConversationRequestSession((0,n.createNoDashGuid)()),this.privConversationConnectionFactory=f,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(p){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(p),await super.dispose(p)}async sendMessage(p){return(await this.fetchConnection()).send(new r.ConversationConnectionMessage(n.MessageType.Text,p))}async sendMessageAsync(p){await(await this.fetchConnection()).send(new r.ConversationConnectionMessage(n.MessageType.Text,p))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,e.CancellationReason.Error,e.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(p,f,g,m,C){this.terminateMessageLoop=!0;const S=new e.ConversationTranslationCanceledEventArgs(g,C,m,void 0,p);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,S)}catch{}}async conversationConnectImpl(p){return this.privConnectionLoop=this.startMessageLoop(),p}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const p=new n.Deferred;try{const g=await(await this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return p.resolve(),Promise.resolve();if(!g)return this.receiveConversationMessageOverride();const m=this.privConversationRequestSession.sessionId,C=g.conversationMessageType.toLowerCase();let S=!1;try{switch(C){case"info":case"participant_command":case"command":const w=a.CommandResponsePayload.fromJSON(g.textBody);switch(w.command.toLowerCase()){case"participantlist":const k=a.ParticipantsListPayloadResponse.fromJSON(g.textBody),O=k.participants.map(J=>({avatar:J.avatar,displayName:J.nickname,id:J.participantId,isHost:J.ishost,isMuted:J.ismuted,isUsingTts:J.usetts,preferredLanguage:J.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new s.ParticipantsListEventArgs(k.roomid,k.token,k.translateTo,k.profanityFilter,k.roomProfanityFilter,k.roomLocked,k.muteAll,O,m));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(w.participantId,o.ConversationTranslatorCommandTypes.setTranslateToLanguages,w.value,m));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(w.participantId,o.ConversationTranslatorCommandTypes.setProfanityFiltering,w.value,m));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(w.participantId,o.ConversationTranslatorCommandTypes.setMute,w.value,m));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new s.MuteAllEventArgs(w.value,m));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new e.ConversationExpirationEventArgs(w.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(w.participantId,o.ConversationTranslatorCommandTypes.setUseTTS,w.value,m));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new s.LockRoomEventArgs(w.value,m));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(w.participantId,o.ConversationTranslatorCommandTypes.changeNickname,w.value,m));break;case"joinsession":const L=a.ParticipantPayloadResponse.fromJSON(g.textBody),F={avatar:L.avatar,displayName:L.nickname,id:L.participantId,isHost:L.ishost,isMuted:L.ismuted,isUsingTts:L.usetts,preferredLanguage:L.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new s.ParticipantEventArgs(F,m));break;case"leavesession":const H={id:w.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new s.ParticipantEventArgs(H,m));break;case"disconnectsession":const V={id:w.participantId};break;case"token":const ie=new t.CognitiveTokenAuthentication(()=>{const J=w.token;return Promise.resolve(J)},()=>{const J=w.token;return Promise.resolve(J)});this.authentication=ie,this.privConversationServiceConnector.onToken(ie);break;default:break}break;case"partial":case"final":const b=a.SpeechResponsePayload.fromJSON(g.textBody),R=C==="final"?e.ResultReason.TranslatedParticipantSpeech:e.ResultReason.TranslatingParticipantSpeech,P=new e.ConversationTranslationResult(b.participantId,this.getTranslations(b.translations),b.language,b.id,R,b.recognition,void 0,void 0,g.textBody,void 0);b.isFinal?((P.text!==void 0&&P.text.length>0||b.id===this.privLastPartialUtteranceId)&&(S=!0),S&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(o.ConversationTranslatorMessageTypes.final,P,m))):P.text!==void 0&&(this.privLastPartialUtteranceId=b.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(o.ConversationTranslatorMessageTypes.partial,P,m)));break;case"translated_message":const I=a.TextResponsePayload.fromJSON(g.textBody),M=new e.ConversationTranslationResult(I.participantId,this.getTranslations(I.translations),I.language,void 0,void 0,I.originalText,void 0,void 0,void 0,g.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(o.ConversationTranslatorMessageTypes.instantMessage,M,m));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return p.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const p=this.receiveConversationMessageOverride();try{return await p}catch(f){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",e.CancellationReason.Error,e.CancellationErrorCode.RuntimeError,f),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(p=>p.state()===n.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(p=>p),this.privConnectionConfigPromise)}getTranslations(p){let f;if(p!==void 0){f=new e.Translations;for(const g of p)f.set(g.lang,g.translation)}return f}};return dv.ConversationServiceAdapter=l,dv}var VM;function V3(){if(VM)return Yc;VM=1,Object.defineProperty(Yc,"__esModule",{value:!0}),Yc.ConversationTranslatorRecognizer=Yc.ConversationRecognizerFactory=void 0;const n=ke(),e=Oe(),t=et(),r=me(),i=z3(),s=q3();class o{static fromConfig(u,p,f){return new a(u,p,f)}}Yc.ConversationRecognizerFactory=o;let a=class extends r.Recognizer{constructor(u,p,f){const g=p;t.Contracts.throwIfNull(g,"speechConfig");const m=u;t.Contracts.throwIfNull(m,"conversationImpl"),super(f,g.properties,new i.ConversationConnectionFactory),this.privConversation=m,this.privIsDisposed=!1,this.privProperties=g.properties.clone(),this.privConnection=r.Connection.fromRecognizer(this),this.privProperties.getProperty(r.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=e.Timeout.setTimeout,this.privClearTimeout=e.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(u){this.privConnection.connected=u}set disconnected(u){this.privConnection.disconnected=u}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(u,p,f){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfNullOrWhitespace(u,"token"),this.privReco.conversationTranslatorToken=u,this.resetConversationTimeout(),this.privReco.connectAsync(p,f)}catch(g){if(f)if(g instanceof Error){const m=g;f(m.name+": "+m.message)}else f(g)}}disconnect(u,p){try{t.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{u&&u()},f=>{p&&p(f)})}catch(f){if(p)if(f instanceof Error){const g=f;p(g.name+": "+g.message)}else p(f);this.dispose(!0).catch(g=>{e.Events.instance.onEvent(new e.BackgroundEvent(g))})}}sendRequest(u,p,f){try{t.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(u,p,f)}catch(g){if(f)if(g instanceof Error){const m=g;f(m.name+": "+m.message)}else f(g);this.dispose(!0).catch(m=>{e.Events.instance.onEvent(new e.BackgroundEvent(m))})}}onToken(u){this.privConversation.onToken(u)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(u){this.privIsDisposed||u&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(u))}createRecognizerConfig(u){return new n.RecognizerConfig(u,this.privProperties)}createServiceRecognizer(u,p,f,g){const m=f;return new s.ConversationServiceAdapter(u,p,m,g,this)}sendMessage(u,p,f){const g=this.privReco;((C,S,w)=>{C!==void 0?C.then(()=>{try{S&&S()}catch(b){w&&w(`'Unhandled error on promise callback: ${b}'`)}},b=>{try{w&&w(b)}catch{}}):w&&w("Null promise")})(g.sendMessageAsync(u),p,f),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};return Yc.ConversationTranslatorRecognizer=a,Yc}var fv={},GM;function G3(){if(GM)return fv;GM=1,Object.defineProperty(fv,"__esModule",{value:!0}),fv.TranscriberRecognizer=void 0;const n=Oe(),e=et(),t=me(),r=ke(),i=rs();let s=class extends t.Recognizer{constructor(a,l){const u=a;e.Contracts.throwIfNull(u,"speechTranslationConfig");const p=l;e.Contracts.throwIfNull(p,"audioConfigImpl"),e.Contracts.throwIfNullOrWhitespace(u.speechRecognitionLanguage,t.PropertyId[t.PropertyId.SpeechServiceConnection_RecoLanguage]),super(l,u.properties,new r.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return e.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(t.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){e.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,a)}set conversation(a){e.Contracts.throwIfNullOrUndefined(a,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=a}getConversationInfo(){return e.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(a){e.Contracts.throwIfNullOrUndefined(a,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=a}getMeetingInfo(){return e.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(a,l){(0,n.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(i.RecognitionMode.Conversation),a,l)}stopContinuousRecognitionAsync(a,l){(0,n.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),a,l)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(a,l){const u=this.privReco;e.Contracts.throwIfNullOrUndefined(u,"serviceRecognizer"),await u.sendSpeechEventAsync(a,l)}async pushMeetingEvent(a,l){const u=this.privReco;e.Contracts.throwIfNullOrUndefined(u,"serviceRecognizer"),await u.sendMeetingSpeechEventAsync(a,l)}async enforceAudioGating(){const u=(await this.audioConfig.format).channels;if(u===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(u!==8)throw new Error(`Unsupported audio configuration: Detected ${u}-channel audio`)}connectMeetingCallbacks(a){this.isMeetingRecognizer=!0,this.canceled=(l,u)=>{a.canceled&&a.canceled(a,u)},this.recognizing=(l,u)=>{a.transcribing&&a.transcribing(a,u)},this.recognized=(l,u)=>{a.transcribed&&a.transcribed(a,u)},this.sessionStarted=(l,u)=>{a.sessionStarted&&a.sessionStarted(a,u)},this.sessionStopped=(l,u)=>{a.sessionStopped&&a.sessionStopped(a,u)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new r.RecognizerConfig(a,this.properties)}createServiceRecognizer(a,l,u,p){const f=u;return new r.TranscriptionServiceRecognizer(a,l,f,p,this)}};return fv.TranscriberRecognizer=s,fv}var KM;function K3(){return KM||(KM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.InternalParticipants=n.ConversationTranslatorMessageTypes=n.ConversationTranslatorCommandTypes=n.ParticipantsListEventArgs=n.ParticipantEventArgs=n.ParticipantAttributeEventArgs=n.MuteAllEventArgs=n.LockRoomEventArgs=n.ConversationReceivedTranslationEventArgs=n.TranscriberRecognizer=n.ConversationRecognizerFactory=n.ConversationConnectionConfig=n.ConversationManager=void 0;var e=L3();Object.defineProperty(n,"ConversationManager",{enumerable:!0,get:function(){return e.ConversationManager}});var t=cP();Object.defineProperty(n,"ConversationConnectionConfig",{enumerable:!0,get:function(){return t.ConversationConnectionConfig}});var r=V3();Object.defineProperty(n,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return r.ConversationRecognizerFactory}});var i=G3();Object.defineProperty(n,"TranscriberRecognizer",{enumerable:!0,get:function(){return i.TranscriberRecognizer}});var s=wO();Object.defineProperty(n,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return s.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(n,"LockRoomEventArgs",{enumerable:!0,get:function(){return s.LockRoomEventArgs}}),Object.defineProperty(n,"MuteAllEventArgs",{enumerable:!0,get:function(){return s.MuteAllEventArgs}}),Object.defineProperty(n,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return s.ParticipantAttributeEventArgs}}),Object.defineProperty(n,"ParticipantEventArgs",{enumerable:!0,get:function(){return s.ParticipantEventArgs}}),Object.defineProperty(n,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return s.ParticipantsListEventArgs}});var o=AO();Object.defineProperty(n,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return o.ConversationTranslatorCommandTypes}}),Object.defineProperty(n,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return o.ConversationTranslatorMessageTypes}}),Object.defineProperty(n,"InternalParticipants",{enumerable:!0,get:function(){return o.InternalParticipants}})})(JA)),JA}var YA={},$M;function RO(){return $M||($M=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SynthesisAudioMetadata=n.MetadataType=void 0,(function(t){t.WordBoundary="WordBoundary",t.Bookmark="Bookmark",t.Viseme="Viseme",t.SentenceBoundary="SentenceBoundary",t.SessionEnd="SessionEnd",t.AvatarSignal="TalkingAvatarSignal"})(n.MetadataType||(n.MetadataType={}));class e{constructor(r){this.privSynthesisAudioMetadata=JSON.parse(r)}static fromJSON(r){return new e(r)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}n.SynthesisAudioMetadata=e})(YA)),YA}var gv={},Bi={},JM;function $3(){if(JM)return Bi;JM=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.SynthesisStartedEvent=Bi.ConnectingToSynthesisServiceEvent=Bi.SynthesisTriggeredEvent=Bi.SpeechSynthesisEvent=void 0;const n=Oe();class e extends n.PlatformEvent{constructor(o,a,l=n.EventType.Info){super(o,l),this.privRequestId=a}get requestId(){return this.privRequestId}}Bi.SpeechSynthesisEvent=e;class t extends e{constructor(o,a,l){super("SynthesisTriggeredEvent",o),this.privSessionAudioDestinationId=a,this.privTurnAudioDestinationId=l}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}Bi.SynthesisTriggeredEvent=t;class r extends e{constructor(o,a){super("ConnectingToSynthesisServiceEvent",o),this.privAuthFetchEventId=a}get authFetchEventId(){return this.privAuthFetchEventId}}Bi.ConnectingToSynthesisServiceEvent=r;class i extends e{constructor(o,a){super("SynthesisStartedEvent",o),this.privAuthFetchEventId=a}get authFetchEventId(){return this.privAuthFetchEventId}}return Bi.SynthesisStartedEvent=i,Bi}var XM;function J3(){if(XM)return gv;XM=1,Object.defineProperty(gv,"__esModule",{value:!0}),gv.SynthesisTurn=void 0;const n=Oe(),e=Vh(),t=me(),r=RO(),i=$3();let s=class CE{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=(0,n.createNoDashGuid)(),this.privTurnDeferral=new n.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(a){this.privStreamId=a}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(a){this.privAudioOutputFormat=a}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const a=new t.PropertyCollection;return a.setProperty(t.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),a}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const a=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(a),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()}startNewSynthesis(a,l,u,p){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=a,this.privRawText=l,this.privIsSSML=u,this.privAudioOutputStream=new e.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",p!==void 0&&(this.privTurnAudioDestination=p,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new i.SynthesisTriggeredEvent(this.requestId,void 0,p===void 0?void 0:p.id()))}onPreConnectionStart(a){this.privAuthFetchEventId=a,this.onEvent(new i.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(a){a&&this.onComplete()}onConnectionEstablishCompleted(a){if(a===200){this.onEvent(new i.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else a===403&&this.onComplete()}onServiceResponseMessage(a){const l=JSON.parse(a);this.streamId=l.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(a){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new n.Deferred;const l=JSON.parse(a);l.webrtc&&(this.privWebRTCSDP=l.webrtc.connectionString)}onAudioChunkReceived(a){this.isSynthesizing&&(this.privAudioOutputStream.write(a),this.privBytesReceived+=a.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(a))}onTextBoundaryEvent(a){this.updateTextOffset(a.Data.text.Text,a.Type)}onVisemeMetadataReceived(a){a.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=a.Data.AnimationChunk)}onSessionEnd(a){this.privAudioDuration=a.Data.Offset}async constructSynthesisResult(){const a=await this.getAllReceivedAudioWithHeader();return new t.SpeechSynthesisResult(this.requestId,t.ResultReason.SynthesizingAudioCompleted,a,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const a=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",a}onEvent(a){n.Events.instance.onEvent(a)}static isXmlTag(a){return a.length>=2&&a[0]==="<"&&a[a.length-1]===">"}updateTextOffset(a,l){l===r.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(a,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+a.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!CE.isXmlTag(a)&&this.updateTextOffset(a,l))):(this.privSentenceOffset=this.privRawText.indexOf(a,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+a.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!CE.isXmlTag(a)&&this.updateTextOffset(a,l)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(a){return this.privRawText.indexOf("<",a+1)>this.privRawText.indexOf(">",a+1)}};return gv.SynthesisTurn=s,gv}var vv={},YM;function X3(){if(YM)return vv;YM=1,Object.defineProperty(vv,"__esModule",{value:!0}),vv.SynthesisAdapterBase=void 0;const n=Oe(),e=me(),t=ke(),r=U0();let i=class{constructor(o,a,l,u){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!o)throw new n.ArgumentNullError("authentication");if(!a)throw new n.ArgumentNullError("connectionFactory");if(!l)throw new n.ArgumentNullError("synthesizerConfig");this.privAuthentication=o,this.privConnectionFactory=a,this.privSynthesizerConfig=l,this.privIsDisposed=!1,this.privSessionAudioDestination=u,this.privSynthesisTurn=new t.SynthesisTurn,this.privConnectionEvents=new n.EventSource,this.privServiceEvents=new n.EventSource,this.privSynthesisContext=new t.SynthesisContext,this.privAgentConfig=new t.AgentConfig,this.connectionEvents.attach(p=>{if(p.name==="ConnectionClosedEvent"){const f=p;f.statusCode!==1e3&&this.cancelSynthesisLocal(e.CancellationReason.Error,f.statusCode===1007?e.CancellationErrorCode.BadRequestParameters:e.CancellationErrorCode.ConnectionFailure,`${f.reason} websocket error code: ${f.statusCode}`)}})}get synthesizerConfig(){return this.privSynthesizerConfig}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(o){this.privActivityTemplate=o}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(o){this.privAudioOutputFormat=o,this.privSynthesisTurn.audioOutputFormat=o,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=o),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=o)}isDisposed(){return this.privIsDisposed}async dispose(o){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(o)}async connect(){await this.connectImpl()}async sendNetworkMessage(o,a){const l=typeof a=="string"?n.MessageType.Text:n.MessageType.Binary,u=typeof a=="string"?"application/json":"";return(await this.fetchConnection()).send(new r.SpeechConnectionMessage(l,o,this.privSynthesisTurn.requestId,u,a))}async Speak(o,a,l,u,p,f){let g;if(a?g=o:g=this.privSynthesizer.buildSsml(o),this.speakOverride!==void 0)return this.speakOverride(g,l,u,p);this.privSuccessCallback=u,this.privErrorCallback=p,this.privSynthesisTurn.startNewSynthesis(l,o,a,f);try{await this.connectImpl();const m=await this.fetchConnection();await this.sendSynthesisContext(m),await this.sendSsmlMessage(m,g,l),this.onSynthesisStarted(l),this.receiveMessage()}catch(m){return this.cancelSynthesisLocal(e.CancellationReason.Error,e.CancellationErrorCode.ConnectionFailure,m),Promise.reject(m)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new r.SpeechConnectionMessage(n.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(o,a,l,u){const p=new e.PropertyCollection;p.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[l]);const f=new e.SpeechSynthesisResult(o,e.ResultReason.Canceled,void 0,u,p);if(this.onSynthesisCancelled(f),this.privSuccessCallback)try{this.privSuccessCallback(f)}catch{}}cancelSynthesisLocal(o,a,l){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,o,a,l))}processTypeSpecificMessages(o){return!0}async receiveMessage(){try{const a=await(await this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!a)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const l=r.SpeechConnectionMessage.fromConnectionMessage(a);if(l.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(l.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(l.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(l.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===l.streamId.toLowerCase()&&l.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(l.binaryBody),this.onSynthesizing(l.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(l.binaryBody));break;case"audio.metadata":const u=t.SynthesisAudioMetadata.fromJSON(l.textBody).Metadata;for(const f of u)switch(f.Type){case t.MetadataType.WordBoundary:case t.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(f);const g=new e.SpeechSynthesisWordBoundaryEventArgs(f.Data.Offset,f.Data.Duration,f.Data.text.Text,f.Data.text.Length,f.Type===t.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,f.Data.text.BoundaryType);this.onWordBoundary(g);break;case t.MetadataType.Bookmark:const m=new e.SpeechSynthesisBookmarkEventArgs(f.Data.Offset,f.Data.Bookmark);this.onBookmarkReached(m);break;case t.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(f),f.Data.IsLastAnimation){const C=new e.SpeechSynthesisVisemeEventArgs(f.Data.Offset,f.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(C)}break;case t.MetadataType.AvatarSignal:this.onAvatarEvent(f);break;case t.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(f);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let p;try{p=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(p)}catch(f){this.privErrorCallback&&this.privErrorCallback(f)}this.onSynthesisCompleted(p);break;default:this.processTypeSpecificMessages(l)||this.privServiceEvents&&this.serviceEvents.onEvent(new n.ServiceEvent(l.path.toLowerCase(),l.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(o){this.setSynthesisContextSynthesisSection();const a=this.synthesisContext.toJSON();if(a)return o.send(new r.SpeechConnectionMessage(n.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",a))}setSpeechConfigSynthesisSection(){}connectImpl(o=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(l=>l.state()===n.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=(0,n.createNoDashGuid)(),this.privConnectionId=(0,n.createNoDashGuid)(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const a=o?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=a.then(async l=>{this.privSynthesisTurn.onAuthCompleted(!1);const u=await this.privConnectionFactory.create(this.privSynthesizerConfig,l,this.privConnectionId);u.events.attach(f=>{this.connectionEvents.onEvent(f)});const p=await u.open();return p.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(p.statusCode),Promise.resolve(u)):p.statusCode===403&&!o?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(p.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${p.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Url)} Reason: ${p.reason}`))},l=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(l)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(o,a){if(a)return o.send(new r.SpeechConnectionMessage(n.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",a))}sendSsmlMessage(o,a,l){return o.send(new r.SpeechConnectionMessage(n.MessageType.Text,"ssml",l,"application/ssml+xml",a))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(o=>o.state()===n.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){const o=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(o):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(o,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),o)}onAvatarEvent(o){}onSynthesisStarted(o){}onSynthesizing(o){}onSynthesisCancelled(o){}onSynthesisCompleted(o){}onWordBoundary(o){}onVisemeReceived(o){}onBookmarkReached(o){}};return vv.SynthesisAdapterBase=i,i.telemetryDataEnabled=!0,vv}var mv={},QM;function Y3(){if(QM)return mv;QM=1,Object.defineProperty(mv,"__esModule",{value:!0}),mv.AvatarSynthesisAdapter=void 0;const n=me(),e=ke();let t=class extends e.SynthesisAdapterBase{constructor(i,s,o,a,l){super(i,s,o,void 0),this.privAvatarSynthesizer=a,this.privSynthesizer=a,this.privAvatarConfig=l}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){var i,s,o,a,l,u,p,f,g,m,C,S,w,b,R,P,I;this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:(i=this.privAvatarConfig.videoFormat)==null?void 0:i.bitrate,codec:(s=this.privAvatarConfig.videoFormat)==null?void 0:s.codec,crop:{bottomRight:{x:(l=(a=(o=this.privAvatarConfig.videoFormat)==null?void 0:o.cropRange)==null?void 0:a.bottomRight)==null?void 0:l.x,y:(f=(p=(u=this.privAvatarConfig.videoFormat)==null?void 0:u.cropRange)==null?void 0:p.bottomRight)==null?void 0:f.y},topLeft:{x:(C=(m=(g=this.privAvatarConfig.videoFormat)==null?void 0:g.cropRange)==null?void 0:m.topLeft)==null?void 0:C.x,y:(b=(w=(S=this.privAvatarConfig.videoFormat)==null?void 0:S.cropRange)==null?void 0:w.topLeft)==null?void 0:b.y}},resolution:{height:(R=this.privAvatarConfig.videoFormat)==null?void 0:R.height,width:(P=this.privAvatarConfig.videoFormat)==null?void 0:P.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(n.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:(I=this.privAvatarConfig.backgroundImage)==null?void 0:I.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,photoAvatarBaseModel:this.privAvatarConfig.photoAvatarBaseModel,style:this.privAvatarConfig.style,useBuiltInVoice:this.privAvatarConfig.useBuiltInVoice}}}onAvatarEvent(i){if(this.privAvatarSynthesizer.avatarEventReceived){const s=new n.AvatarEventArgs(i.Data.Offset,i.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,s)}catch{}}}};return mv.AvatarSynthesisAdapter=t,mv}var yv={},ZM;function Q3(){if(ZM)return yv;ZM=1,Object.defineProperty(yv,"__esModule",{value:!0}),yv.SpeechSynthesisAdapter=void 0;const n=me(),e=ke();let t=class extends e.SynthesisAdapterBase{constructor(i,s,o,a,l){super(i,s,o,l),this.privSpeechSynthesizer=a,this.privSynthesizer=a}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(i){const s=new n.SpeechSynthesisEventArgs(new n.SpeechSynthesisResult(i,n.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,s)}onSynthesizing(i){if(this.privSpeechSynthesizer.synthesizing)try{const s=this.privSynthesisTurn.audioOutputFormat.addHeader(i),o=new n.SpeechSynthesisEventArgs(new n.SpeechSynthesisResult(this.privSynthesisTurn.requestId,n.ResultReason.SynthesizingAudio,s));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,o)}catch{}}onSynthesisCancelled(i){if(this.privSpeechSynthesizer.SynthesisCanceled){const s=new n.SpeechSynthesisEventArgs(i);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,s)}catch{}}}onSynthesisCompleted(i){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new n.SpeechSynthesisEventArgs(i))}catch{}}onWordBoundary(i){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,i)}catch{}}onVisemeReceived(i){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,i)}catch{}}onBookmarkReached(i){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,i)}catch{}}};return yv.SpeechSynthesisAdapter=t,yv}var Sv={},eD;function Z3(){if(eD)return Sv;eD=1,Object.defineProperty(Sv,"__esModule",{value:!0}),Sv.SynthesisRestAdapter=void 0;const n=Pr(),e=me(),t=Xo(),r=si();let i=class{constructor(o,a){let l=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!l){const p=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,"westus"),f=t.ConnectionFactoryBase.getHostSuffix(p);l=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,`https://${p}.tts.speech${f}`)}this.privUri=`${l}/cognitiveservices/voices/list`;const u=n.RestConfigBase.requestOptions;this.privRestAdapter=new n.RestMessageAdapter(u),this.privAuthentication=a}getVoicesList(o){return this.privRestAdapter.setHeaders(r.HeaderNames.ConnectionId,o),this.privAuthentication.fetch(o).then(a=>(this.privRestAdapter.setHeaders(a.headerName,a.token),this.privRestAdapter.request(n.RestRequestType.Get,this.privUri)))}};return Sv.SynthesisRestAdapter=i,Sv}var QA={},tD;function e5(){return tD||(tD=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SynthesizerConfig=n.SynthesisServiceType=void 0;const e=ke();var t;(function(i){i[i.Standard=0]="Standard",i[i.Custom=1]="Custom"})(t=n.SynthesisServiceType||(n.SynthesisServiceType={}));class r{constructor(s,o){this.privSynthesisServiceType=t.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=s||new e.SpeechServiceConfig(new e.Context(null)),this.privParameters=o}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(s){this.privSynthesisServiceType=s}set synthesisVideoSection(s){this.privSpeechServiceConfig.Context.synthesis={video:s}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}setContextFromJson(s){const o=JSON.parse(s);o.system&&(this.privSpeechServiceConfig.Context.system=o.system),o.os&&(this.privSpeechServiceConfig.Context.os=o.os),o.audio&&(this.privSpeechServiceConfig.Context.audio=o.audio),o.synthesis&&(this.privSpeechServiceConfig.Context.synthesis=o.synthesis)}}n.SynthesizerConfig=r})(QA)),QA}var Cv={},nD;function t5(){if(nD)return Cv;nD=1,Object.defineProperty(Cv,"__esModule",{value:!0}),Cv.SynthesisContext=void 0;const n=me();let e=class{constructor(){this.privContext={}}setSection(r,i){this.privContext[r]=i}set audioOutputFormat(r){this.privAudioOutputFormat=r}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(r){const i=this.buildSynthesisContext(r);this.setSection("synthesis",i)}buildSynthesisContext(r){return{audio:{metadataOptions:{bookmarkEnabled:!!(r!=null&&r.bookmarkReached),punctuationBoundaryEnabled:r==null?void 0:r.properties.getProperty(n.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!(r!=null&&r.wordBoundary)),sentenceBoundaryEnabled:r==null?void 0:r.properties.getProperty(n.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!(r!=null&&r.visemeReceived),wordBoundaryEnabled:r==null?void 0:r.properties.getProperty(n.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!(r!=null&&r.wordBoundary))},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:r==null?void 0:r.autoDetectSourceLanguage}}}};return Cv.SynthesisContext=e,Cv}var ZA={},rD;function n5(){return rD||(rD=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.type=n.connectivity=n.Device=n.OS=n.System=n.Context=n.SpeechServiceConfig=void 0;class e{constructor(a){this.context=a}serialize(){return JSON.stringify(this,(a,l)=>{if(l&&typeof l=="object"&&!Array.isArray(l)){const u={};for(const p in l)Object.hasOwnProperty.call(l,p)&&(u[p&&p.charAt(0).toLowerCase()+p.substring(1)]=l[p]);return u}return l})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(a){this.recognition=a.toLowerCase()}}n.SpeechServiceConfig=e;class t{constructor(a){this.system=new r,this.os=a}}n.Context=t;class r{constructor(){const a="1.47.0";this.name="SpeechSDK",this.version=a,this.build="JavaScript",this.lang="JavaScript"}}n.System=r;class i{constructor(a,l,u){this.platform=a,this.name=l,this.version=u}}n.OS=i;class s{constructor(a,l,u){this.manufacturer=a,this.model=l,this.version=u}}n.Device=s,(function(o){o.Bluetooth="Bluetooth",o.Wired="Wired",o.WiFi="WiFi",o.Cellular="Cellular",o.InBuilt="InBuilt",o.Unknown="Unknown"})(n.connectivity||(n.connectivity={})),(function(o){o.Phone="Phone",o.Speaker="Speaker",o.Car="Car",o.Headset="Headset",o.Thermostat="Thermostat",o.Microphones="Microphones",o.Deskphone="Deskphone",o.RemoteControl="RemoteControl",o.Unknown="Unknown",o.File="File",o.Stream="Stream"})(n.type||(n.type={}))})(ZA)),ZA}var iD;function ke(){return iD||(iD=1,(function(n){var e=jc&&jc.__createBinding||(Object.create?(function(s,o,a,l){l===void 0&&(l=a),Object.defineProperty(s,l,{enumerable:!0,get:function(){return o[a]}})}):(function(s,o,a,l){l===void 0&&(l=a),s[l]=o[a]})),t=jc&&jc.__exportStar||function(s,o){for(var a in s)a!=="default"&&!Object.prototype.hasOwnProperty.call(o,a)&&e(o,s,a)};Object.defineProperty(n,"__esModule",{value:!0}),n.AutoDetectSourceLanguagesOpenRangeOptionName=n.ForceDictationPropertyName=n.ServicePropertiesPropertyName=n.CancellationErrorCodePropertyName=n.OutputFormatPropertyName=n.SpeechSynthesisAdapter=n.AvatarSynthesisAdapter=void 0,t(eB(),n),t(tB(),n),t(nP(),n),t(nB(),n),t(rB(),n),t(rP(),n),t(e3(),n),t(t3(),n),t(n3(),n),t(r3(),n),t(i3(),n),t(s3(),n),t(o3(),n),t(a3(),n),t(c3(),n),t(dO(),n),t(l3(),n),t(u3(),n),t(d3(),n),t(h3(),n),t(p3(),n),t(f3(),n),t(g3(),n),t(v3(),n),t(m3(),n),t(y3(),n),t(C3(),n),t(b3(),n),t(w3(),n),t(A3(),n),t(R3(),n),t(T3(),n),t(I3(),n),t(N3(),n),t(O3(),n),t(K3(),n),t(RO(),n),t(J3(),n),t(X3(),n);var r=Y3();Object.defineProperty(n,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return r.AvatarSynthesisAdapter}});var i=Q3();Object.defineProperty(n,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return i.SpeechSynthesisAdapter}}),t(Z3(),n),t(e5(),n),t(t5(),n),t(n5(),n),n.OutputFormatPropertyName="OutputFormat",n.CancellationErrorCodePropertyName="CancellationErrorCode",n.ServicePropertiesPropertyName="ServiceProperties",n.ForceDictationPropertyName="ForceDictation",n.AutoDetectSourceLanguagesOpenRangeOptionName="UND"})(jc)),jc}var sD;function r5(){return sD||(sD=1,(function(n){var e=Lc&&Lc.__createBinding||(Object.create?(function(i,s,o,a){a===void 0&&(a=o),Object.defineProperty(i,a,{enumerable:!0,get:function(){return s[o]}})}):(function(i,s,o,a){a===void 0&&(a=o),i[a]=s[o]})),t=Lc&&Lc.__exportStar||function(i,s){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,i,o)};Object.defineProperty(n,"__esModule",{value:!0});const r=ke();new r.AgentConfig,t(me(),n)})(Lc)),Lc}var Ti=r5();function i5(n){const[e,t]=W.useState("idle"),[r,i]=W.useState(""),[s,o]=W.useState([]),[a,l]=W.useState(-1),[u,p]=W.useState(null),f=W.useRef(null),g=W.useRef(null),m=W.useRef([]),C=W.useRef(0),S=W.useRef(null),w=W.useRef(!1),b=W.useRef([]),R=W.useRef(!1),P=W.useRef(!1),I=W.useRef(!1),M=W.useRef(""),k=W.useRef(null),O=W.useCallback(()=>{f.current&&f.current.close(),console.log("Initializing synthesizer with voice:",n.selectedVoice);const J=Ti.SpeechConfig.fromSubscription(n.apiKey,n.region);J.speechSynthesisVoiceName=n.selectedVoice,J.speechSynthesisOutputFormat=Ti.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3;const ee=new Ti.SpeakerAudioDestination;g.current=ee;const se=Ti.AudioConfig.fromSpeakerOutput(ee),ne=new Ti.SpeechSynthesizer(J,se);return f.current=ne,ne},[n]),L=W.useCallback(()=>{if(!w.current){console.log("Stopped tracking - not playing");return}let J=Date.now()-C.current;if(g.current&&g.current.currentTime)try{const se=g.current.currentTime;se>0&&(J=se*1e3)}catch{}let ee=-1;for(let se=0;se<b.current.length&&b.current[se].audioOffset<=J+300;se++)ee=se;if(ee!==-1&&l(ee),Math.floor(J/500)!==Math.floor((J-16)/500)){const se=ee>=0?b.current[ee]:null;console.log(` ${J.toFixed(0)}ms | Word [${ee}]: "${se==null?void 0:se.text}" @ ${se==null?void 0:se.audioOffset}ms | Total: ${b.current.length} | Complete: ${P.current}`)}w.current&&(S.current=requestAnimationFrame(L))},[]),F=W.useCallback(J=>{if(!J.trim()){i("Please enter some text to synthesize");return}t("synthesizing"),i(""),o([]),l(-1),m.current=[],b.current=[],w.current=!1,R.current=!1,P.current=!1,I.current=!1,M.current=J;const ee=O(),se=setTimeout(()=>{b.current.length===0&&(console.log(" No word boundary received within 1 second - will start playback when audio arrives"),I.current=!0)},1e3);ee.wordBoundary=(ne,Q)=>{const K={text:Q.text,offset:Q.textOffset,length:Q.wordLength,audioOffset:Q.audioOffset/1e4};if(b.current.push(K),o([...b.current]),console.log(` Word boundary: "${K.text}" at ${K.audioOffset}ms (text offset: ${K.offset})`),b.current.length===1){clearTimeout(se),I.current=!1;const oe=Date.now(),B=oe-K.audioOffset;C.current=B,console.log(" FIRST word boundary - starting playback. Word:",K.text,"offset:",K.audioOffset,"ms. Playback start:",B,"Current time:",oe),w.current?(console.log(" Switching from fallback mode to word boundary mode - restarting tracking"),L()):(w.current=!0,t("playing"),L())}},ee.synthesizing=(ne,Q)=>{Q.result.audioData&&(m.current.push(new Uint8Array(Q.result.audioData)),I.current&&!w.current&&m.current.length===1&&(console.log(" First audio chunk received (fallback mode) - starting playback"),C.current=Date.now(),w.current=!0,t("playing")))},ee.synthesisStarted=()=>{t("synthesizing"),console.log("Synthesis started")},ee.synthesisCompleted=(ne,Q)=>{const K=m.current.reduce((ge,ye)=>ge+ye.length,0),oe=new Uint8Array(K);let B=0;for(const ge of m.current)oe.set(ge,B),B+=ge.length;p(oe.buffer),P.current=!0,console.log(" Synthesis completed - now have all",b.current.length,"word boundaries");const j=K*8/48e3*1e3,$=Date.now()-C.current,pe=Math.max(100,j-$+300);console.log(` Estimated audio duration: ${j}ms, current playback: ${$}ms, will stop in: ${pe}ms`),w.current||(C.current=Date.now(),w.current=!0,t("playing")),k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{console.log(" Audio playback ended (duration timeout)"),w.current=!1,S.current&&(cancelAnimationFrame(S.current),S.current=null),t("idle"),l(-1),k.current=null},pe)},ee.SynthesisCanceled=(ne,Q)=>{console.error("Synthesis canceled:",Q.errorDetails),i(Q.errorDetails||"Synthesis was canceled"),t("error"),l(-1),w.current=!1,S.current&&cancelAnimationFrame(S.current)},ee.speakTextAsync(J,ne=>{ne.reason===Ti.ResultReason.SynthesizingAudioCompleted?console.log("Synthesis completed successfully"):(console.error("Synthesis failed:",ne.errorDetails),i(ne.errorDetails||"Synthesis failed"),t("error"))},ne=>{console.error("Synthesis error:",ne),i(ne),t("error")})},[O,L]),H=W.useCallback(()=>{g.current&&e==="playing"&&(g.current.pause(),t("paused"),w.current=!1,S.current&&(cancelAnimationFrame(S.current),S.current=null))},[e]),V=W.useCallback(()=>{g.current&&e==="paused"&&(g.current.resume(),t("playing"),w.current=!0,L())},[e,L]),ie=W.useCallback(()=>{console.log(" Stop called - cleaning up"),w.current=!1,S.current&&(cancelAnimationFrame(S.current),S.current=null),g.current&&g.current.pause(),f.current&&(f.current.close(),f.current=null),t("idle"),l(-1)},[]);return{state:e,error:r,wordBoundaries:s,currentWordIndex:a,audioData:u,synthesize:F,pause:H,resume:V,stop:ie}}async function PO(n,e){try{const t=n.length>8?`${n.substring(0,4)}...${n.substring(n.length-4)}`:"****";console.log("=== FETCHING VOICES ==="),console.log("Region:",e),console.log("API Key:",t),console.log("=======================");const r=`https://${e}.tts.speech.microsoft.com/cognitiveservices/voices/list`,i=await fetch(r,{headers:{"Ocp-Apim-Subscription-Key":n}});if(!i.ok)throw new Error(`Failed to fetch voices: ${i.status} ${i.statusText}`);const s=await i.json();console.log("Fetched voices - total count:",s.length),console.log("First voice full structure:",JSON.stringify(s[0],null,2));const o=[...new Set(s.map(l=>l.VoiceType))];console.log("Available VoiceType values:",o),o.forEach(l=>{const u=s.find(p=>p.VoiceType===l);u&&console.log(`Sample ${l} voice:`,u.ShortName,u)});const a=s.map(l=>{var g,m;const u=((g=l.ShortName)==null?void 0:g.includes("HD"))||((m=l.Name)==null?void 0:m.includes("HD")),p=l.WordsPerMinute||l.SecondaryLocaleList||[];let f="Female";return typeof l.Gender=="number"?f=l.Gender===1?"Female":"Male":typeof l.Gender=="string"&&(f=l.Gender),{name:l.ShortName||l.Name||"Unknown",locale:String(l.Locale||"en-US"),gender:f,description:`${l.LocalName||l.DisplayName||l.Name||"Unknown"} (${l.Locale||"Unknown"})`,styleList:l.StyleList||[],isFeatured:u,voiceType:l.VoiceType,isNeuralHD:u,keywords:Array.isArray(p)?p:[],wordsPer:l.WordsPerMinute,voiceTag:l.VoiceTag||{}}});return(e.toLowerCase()==="eastus"||e==="East US")&&(console.log("Adding hardcoded MAI voices for East US region"),a.unshift({name:"en-us-phoebe:MAI-Voice-1",locale:"en-US",gender:"Female",description:"Phoebe MAI Voice (en-US)",styleList:[],isFeatured:!0,voiceType:"Neural",isNeuralHD:!0,keywords:["MAI"],wordsPer:void 0},{name:"en-us-benjamin:MAI-Voice-1",locale:"en-US",gender:"Male",description:"Benjamin MAI Voice (en-US)",styleList:[],isFeatured:!0,voiceType:"Neural",isNeuralHD:!0,keywords:["MAI"],wordsPer:void 0})),a.sort((l,u)=>l.isFeatured&&!u.isFeatured?-1:!l.isFeatured&&u.isFeatured?1:l.name.localeCompare(u.name)),console.log("Successfully processed voices:",a.length),a}catch(t){throw console.error("Failed to fetch voices:",t),t}}function s5({apiKey:n,region:e,selectedVoice:t,onVoiceChange:r}){const[i,s]=W.useState([]),[o,a]=W.useState(!1),[l,u]=W.useState(""),[p,f]=W.useState(""),[g,m]=W.useState("");W.useEffect(()=>{n&&e&&(a(!0),u(""),PO(n,e).then(S=>{s(S);const w=S.filter(R=>R.name.toLowerCase().includes("openai")),b=S.filter(R=>R.name.toLowerCase().includes("mai-voice")||R.name.toLowerCase().includes(":mai-"));console.log(`Found ${w.length} OpenAI voices:`,w.map(R=>R.name)),console.log(`Found ${b.length} MAI voices:`,b.map(R=>R.name)),a(!1)}).catch(S=>{console.error("Failed to fetch voices:",S),u("Failed to load voices from Azure."),s([]),a(!1)}))},[n,e]);const C=i.filter(S=>{var R,P,I,M;if(S.name.toLowerCase().includes("multitalker"))return!1;if(g)switch(g){case"MAI":const k=S.name.toLowerCase().includes("mai-voice")||S.name.toLowerCase().includes(":mai-"),O=Array.isArray((R=S.voiceTag)==null?void 0:R.Source)&&S.voiceTag.Source.some(H=>H.toLowerCase()==="mai");if(!k&&!O)return!1;break;case"HD":if(!S.isNeuralHD)return!1;break;case"NonHD":if(S.isNeuralHD)return!1;break;case"OpenAI":const L=S.name.toLowerCase().includes("openai"),F=Array.isArray((P=S.voiceTag)==null?void 0:P.Source)&&S.voiceTag.Source.some(H=>H.toLowerCase()==="openai");if(!L&&!F)return!1;break}if(!p)return!0;const w=p.toLowerCase().trim(),b=k=>k.toLowerCase().split(/\s+/).some(L=>L===w);return S.name.toLowerCase().includes(w)||S.description.toLowerCase().includes(w)||b(S.locale)||S.gender&&b(S.gender)||((I=S.styleList)==null?void 0:I.some(k=>b(k)))||((M=S.keywords)==null?void 0:M.some(k=>b(String(k))))});return W.useEffect(()=>{if(C.length>0){const S=C[0],w=C.some(b=>b.name===t);(p||g)&&!w&&(console.log("Auto-selecting top voice from filtered list:",S.name),r(S.name))}},[p,C.length,g]),A.jsxs("div",{className:"h-full flex flex-col space-y-2",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Voice"}),l&&A.jsx("div",{className:"text-sm text-yellow-600 bg-yellow-50 p-2 rounded",children:l}),A.jsxs("div",{className:"flex gap-2 flex-wrap",children:[A.jsx("button",{onClick:()=>m(""),className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${g===""?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"All"}),A.jsx("button",{onClick:()=>m(g==="HD"?"":"HD"),className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${g==="HD"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"HD"}),A.jsx("button",{onClick:()=>m(g==="MAI"?"":"MAI"),className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${g==="MAI"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"MAI"}),A.jsx("button",{onClick:()=>m(g==="OpenAI"?"":"OpenAI"),className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${g==="OpenAI"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"OpenAI"}),A.jsx("button",{onClick:()=>m(g==="NonHD"?"":"NonHD"),className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${g==="NonHD"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Non-HD"})]}),A.jsx("input",{type:"text",placeholder:"Search voices...",value:p,onChange:S=>{console.log("Search term changed to:",S.target.value),f(S.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),t&&A.jsxs("div",{className:"p-2 bg-blue-50 border border-blue-200 rounded-md flex-shrink-0",children:[A.jsx("div",{className:"text-xs text-blue-600 font-medium",children:"Selected:"}),A.jsx("div",{className:"text-sm text-blue-800 truncate",children:t})]}),A.jsxs("div",{className:"flex-1 overflow-y-auto border border-gray-200 rounded-md min-h-0",children:[o&&A.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"Loading voices..."}),!o&&C.length===0&&A.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No voices found"}),!o&&C.map(S=>{var R,P;const w=[];(R=S.voiceTag)!=null&&R.ContentCategories&&w.push(...S.voiceTag.ContentCategories),(P=S.voiceTag)!=null&&P.VoicePersonalities&&w.push(...S.voiceTag.VoicePersonalities);const b=w.length>0?` [${w.join(", ")}]`:"";return A.jsxs("button",{onClick:()=>{console.log("Voice changed to:",S.name),console.log("=== VOICE ATTRIBUTES ==="),console.log("Full Voice Object:",S),console.table({name:S.name,locale:S.locale,gender:S.gender,description:S.description,voiceType:S.voiceType,isNeuralHD:S.isNeuralHD,isFeatured:S.isFeatured,wordsPer:S.wordsPer}),console.log("Style List:",S.styleList),console.log("Keywords:",S.keywords),console.log("Voice Tag:",S.voiceTag),console.log("========================"),r(S.name)},className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${t===S.name?"bg-blue-50 border-l-4 border-l-blue-600":"hover:bg-gray-50"}`,children:[A.jsxs("div",{className:"font-medium text-gray-800 text-sm",children:[S.isFeatured?" ":"",S.name]}),b&&A.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:b})]},S.name)})]}),A.jsxs("div",{className:"text-xs text-gray-500 flex-shrink-0 pt-2",children:[C.length," voice",C.length!==1?"s":""," available",p&&` (filtered from ${i.length})`]})]})}const oD={"en-GB":"Welcome to our programme exploring the fascinating world of marine biology. From the depths of the ocean to coastal waters, we'll discover the wonders of underwater life.","en-AU":"G'day and welcome to our show about the amazing world of marine biology. From the deep blue ocean to our beautiful coastlines, we'll explore the incredible underwater world.","en-CA":"Welcome to our podcast about the wonderful world of marine biology. From the depths of the ocean to our coastal waters, we'll explore the amazing underwater ecosystems.","en-IN":"Welcome to our programme on marine biology. We will explore the fascinating world beneath the oceans, from the deepest waters to coastal regions.","hi-IN":"                ,           ","es-ES":"Bienvenidos a nuestro programa sobre el fascinante mundo de la biologa marina. Desde las profundidades del ocano hasta las costas, exploraremos las maravillas del mundo submarino.","es-MX":"Bienvenidos a nuestro podcast sobre el fascinante mundo de la biologa marina. Desde las profundidades del mar hasta nuestras costas, exploraremos las maravillas del mundo submarino.","ja-JP":"","fr-FR":"Bienvenue dans notre mission sur le monde fascinant de la biologie marine. Des profondeurs ocaniques aux ctes, nous explorerons les merveilles du monde sous-marin.","fr-CA":"Bienvenue  notre mission sur le merveilleux monde de la biologie marine. Des profondeurs de l'ocan jusqu'aux ctes, nous explorerons les merveilles du monde sous-marin.","pt-BR":"Bem-vindos ao nosso podcast sobre o fascinante mundo da biologia marinha. Das profundezas do oceano at as costas, vamos explorar as maravilhas do mundo submarino.","pt-PT":"Bem-vindos ao nosso programa sobre o fascinante mundo da biologia marinha. Desde as profundezas do oceano at s costas, iremos explorar as maravilhas do mundo submarino.","it-IT":"Benvenuti al nostro programma sul affascinante mondo della biologia marina. Dalle profondit dell'oceano alle coste, esploreremo le meraviglie del mondo sottomarino.","zh-TW":",","ko-KR":"      .   ,          .","nl-NL":"Welkom bij ons programma over de fascinerende wereld van de mariene biologie. Van de diepten van de oceaan tot de kustlijnen, we verkennen de wonderen van de onderwaterwereld.","sv-SE":"Vlkommen till vrt program om den fascinerande vrlden av marinbiologi. Frn havets djup till kusterna kommer vi att utforska undervattensvrldens under.","pl-PL":"Witamy w naszym programie o fascynujcym wiecie biologii morskiej. Od gbin oceanu po wybrzea, bdziemy odkrywa cuda podwodnego wiata.","nb-NO":"Velkommen til vrt program om den fascinerende verden av marinbiologi. Fra havets dyp til kystene vil vi utforske undervannens underverker.","da-DK":"Velkommen til vores program om den fascinerende verden af marinbiologi. Fra havets dybder til kysterne vil vi udforske undervandensverdenens vidundere.","fi-FI":"Tervetuloa ohjelmaammme meribiologian kiehtovasta maailmasta. Valtameren syvyyksist rannikoille tutkimme vedenalaisen maailman ihmeit.","ru-RU":"         .           .","ca-ES":"Benvinguts al nostre programa sobre el fascinant mn de la biologia marina. Des de les profunditats de l'oce fins a les costes, explorarem les meravelles del mn submar.","tr-TR":"Deniz biyolojisinin byleyici dnyas hakkndaki programmza ho geldiniz. Okyanusun derinliklerinden kylara kadar, su alt dnyasnn harikalarn kefedeceiz.","ar-SA":"        .          .","ar-EG":"        .           .","th-TH":"  ","he-IL":"         .    ,      -.","cs-CZ":"Vtejte v naem poadu o fascinujcm svt mosk biologie. Od hlubin ocenu a po pobe budeme zkoumat zzraky podmoskho svta.","hu-HU":"dvzljk msorunkban a tengeri biolgia lenygz vilgrl. Az cen mlytl a partokig felfedezzk a vz alatti vilg csodit.","uk-UA":"         .          .","cy-GB":"Croeso i'n rhaglen am fyd hynod ddiddorol bioleg forol. O ddyfnderoedd y cefnfor i'r arfordiroedd, byddwn yn archwilio rhyfeddodau'r byd tanddwr.","vi-VN":"Cho mng n vi chng trnh ca chng ti v th gii hp dn ca sinh hc bin. T  su ca i dng n b bin, chng ta s khm ph nhng k quan ca th gii di nc.","sl-SI":"Dobrodoli v naem programu o fascinantnem svetu morske biologije. Od globin oceana do obal bomo raziskovali udee podvodnega sveta.","id-ID":"Selamat datang di program kami tentang dunia biologi laut yang menarik. Dari kedalaman samudra hingga garis pantai, kami akan menjelajahi keajaiban dunia bawah laut.","el-GR":"           .        ,       .","sk-SK":"Vitajte v naom programe o fascinujcom svete morskej biolgie. Od hlbn ocenu a po pobreia budeme skma zzraky podmorskho sveta.","hr-HR":"Dobrodoli u na program o fascinantnom svijetu morske biologije. Od dubina oceana do obala, istrait emo uda podvodnog svijeta.","ro-RO":"Bun venit la programul nostru despre lumea fascinant a biologiei marine. De la adncurile oceanului pn la coaste, vom explora minunile lumii subacvatice.","lt-LT":"Sveiki atvyk  ms program apie av jr biologijos pasaul. Nuo vandenyno gelmi iki krant tyrinsime povandeninio pasaulio stebuklus.","bg-BG":"      fascinating world   .            .","lv-LV":"Laipni ldzam msu programm par aizraujoo jras bioloijas pasauli. No okena dziumiem ldz krastiem ms izptsim zemdens pasaules brnumus.","et-EE":"Tere tulemast meie saatesse pnevast merebioloogia maailmast. Ookeani sgavustest kuni rannikualadeni uurime veealuse maailma imesid.","sr-RS":"Dobrodoli u na program o fascinantnom svetu morske biologije. Od dubina okeana do obala, istraiemo uda podvodnog sveta."},eE={"en-US":{podcast:"Welcome to One Fish, Two Fish, the podcast that aims to make you laugh as you learn about the fascinating world of marine biology. From the depths of the deep blue to the shores of our coastlines, we'll explore the wonders of the underwater world and the creatures that call it home.",education:"Welcome to today's online math lesson! In this session, we'll delve into the fascinating world of algebra. We'll start by exploring the basics, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardized checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed on her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named 'Perseverance,' touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, beautiful people! Welcome back to my channel. Today, we're about to spill all the tea on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh boy, here we go. You know, I walked into this improv show, and I thought, 'Hey, this could be fun. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you folks.",enthusiastic:"Oh my gosh, that's AMAZING news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a mix of both? Tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, uh, I was thinkingno, I mean, I was wondering if, um, if you might want to go to the, uh, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite.",callcenter:"Thank you for calling customer support. My name is Sarah, and I'll be happy to assist you today. I understand you're experiencing an issue with your account. Let me pull up your information and see how I can help resolve this for you right away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their color. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"zh-CN":{podcast:",",education:"",instructions:"",story:"",ads:"iPhoneiPhone",news:"NASA",promotional:"",vlog:"",business:"Winnebago IndustriesWGO",standup:"",enthusiastic:"",casual:"",hesitant:"",callcenter:"",explainer:""},"de-DE":{podcast:"Willkommen zu unserem Podcast ber die faszinierende Welt der Meeresbiologie. Von den Tiefen des Ozeans bis zu den Ksten werden wir die Wunder der Unterwasserwelt und die erstaunlichen Kreaturen erkunden.",education:"Willkommen zur heutigen Online-Mathematikstunde! In dieser Sitzung werden wir in die faszinierende Welt der Algebra eintauchen. Wir beginnen mit den Grundlagen, vom Lsen einfacher Gleichungen bis zum Verstndnis von Variablen.",instructions:"Machen Sie bei der Durchfhrung der Inspektion klare und umfassende Notizen. Verwenden Sie unsere standardisierte Checkliste als Leitfaden und notieren Sie Abweichungen oder Problembereiche.",story:"Eine sanfte Melancholie lag auf ihrem Herzen, gewebt aus Erinnerungen an eine Zeit, als Lachen durch diese Wiesen hallte. Sie strich ber die zarten Bltenbltter eines vergessenen Gnseblmchens.",ads:"Wir prsentieren das brandneue iPhone, das den Standard fr neu definierte Innovation setzt. Mit elegantem Design und modernsten Funktionen definiert dieses iPhone den Gipfel der Technologie neu.",news:"In den internationalen Nachrichten hat die erfolgreiche Mission der NASA, einen Rover zum Mars zu schicken, weltweite Aufmerksamkeit erregt. Der Rover namens Perseverance landete diese Woche auf der Marsoberflche.",promotional:"Meine Damen, es ist Zeit fr etwas Selbstverwhnung! Gnnen Sie sich einen Moment der Glckseligkeit mit unserem exklusiven Winter-Spa-Paket.",vlog:"Hallo, ihr Lieben! Willkommen zurck auf meinem Kanal. Heute werden wir ber die neuesten Make-up-Must-haves sprechen.",business:"Winnebago Industries ist ein Unternehmen, das Wohnmobile, Reiseanhnger und andere Freizeitfahrzeuge herstellt. Das Brsenkrzel lautet WGO und wird an der New Yorker Brse gehandelt.",standup:"Oh je, jetzt geht's los. Wissen Sie, ich kam zu dieser Improv-Show und dachte: 'Hey, das knnte lustig werden.' Die berraschung war, dass ich hier Stand-up fr Sie machen muss.",enthusiastic:"Oh mein Gott, das sind ja fantastische Neuigkeiten! Herzlichen Glckwunsch! Wie fhlen Sie sich dabei? Aufgeregt, nervs oder beides?",casual:"Oh nein, das wollte ich nicht! Wie wre es damit: Wenn Sie etwas Skurriles mit viel Lachen wollen, nehmen Sie die Blue Man Group. Fr etwas Magisches ist Cirque du Soleil die beste Wahl.",hesitant:"Also, h, ich habe gedachtnein, ich meine, ich habe mich gefragt, ob, hm, ob Sie vielleicht Freitag in das, h, neue italienische Restaurant gehen mchten?",callcenter:"Vielen Dank fr Ihren Anruf beim Kundendienst. Mein Name ist Anna, und ich helfe Ihnen gerne weiter. Ich verstehe, dass Sie ein Problem mit Ihrem Konto haben. Lassen Sie mich Ihre Informationen abrufen und schauen, wie ich Ihnen umgehend helfen kann.",explainer:"Lassen Sie mich erklren, wie Photosynthese funktioniert. Pflanzen nutzen Sonnenlicht, Wasser und Kohlendioxid, um Energie zu erzeugen. Der Prozess findet in den Chloroplasten statt, die Chlorophyll enthalten  das grne Pigment, das Pflanzen ihre Farbe verleiht. Wenn Sonnenlicht auf die Bltter trifft, lst es eine chemische Reaktion aus, die diese Bestandteile in Glukose und Sauerstoff umwandelt."},"en-GB":{podcast:"Welcome to our programme exploring the fascinating world of marine biology. From the depths of the ocean to coastal waters, we'll discover the wonders of underwater life and the remarkable creatures that inhabit these environments.",education:"Welcome to today's online maths lesson! In this session, we'll explore the fascinating world of algebra. We'll begin with the fundamentals, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardised checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed upon her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, lovely people! Welcome back to my channel. Today, we're going to share all the details on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh blimey, here we go. You know, I walked into this improv show, and I thought, 'Right, this could be fun. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you lot.",enthusiastic:"Oh my goodness, that's brilliant news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a mix of both? Tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, um, I was thinkingno, I mean, I was wondering if, er, if you might want to go to the, um, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite.",callcenter:"Thank you for calling customer support. My name is Emily, and I'll be pleased to assist you today. I understand you're experiencing an issue with your account. Let me pull up your information and see how I can help resolve this for you straight away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"en-AU":{podcast:"G'day and welcome to our show about the amazing world of marine biology. From the deep blue ocean to our beautiful coastlines, we'll explore the incredible underwater world and the fascinating creatures that call it home.",education:"Welcome to today's online maths lesson! In this session, we'll dive into the fascinating world of algebra. We'll start with the basics, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardised checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed on her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, beautiful people! Welcome back to my channel. Today, we're going to spill all the tea on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh crikey, here we go. You know, I rocked up to this improv show, and I thought, 'Yeah, this could be a laugh. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you mob.",enthusiastic:"Oh my gosh, that's bloody amazing news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a bit of both? Tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with heaps of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, um, I was thinkingno, I mean, I was wondering if, er, if you might want to go to the, um, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite.",callcenter:"Thanks for calling customer support. My name is Jessica, and I'll be happy to help you out today. I understand you're having an issue with your account. Let me pull up your details and see how I can sort this out for you right away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"en-CA":{podcast:"Welcome to our podcast about the wonderful world of marine biology. From the depths of the ocean to our coastal waters, we'll explore the amazing underwater ecosystems and the remarkable creatures that inhabit them.",education:"Welcome to today's online math lesson! In this session, we'll delve into the fascinating world of algebra. We'll start by exploring the basics, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardized checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed on her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, beautiful people! Welcome back to my channel. Today, we're about to share all the details on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh boy, here we go. You know, eh, I walked into this improv show, and I thought, 'Hey, this could be fun. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you folks.",enthusiastic:"Oh my gosh, that's amazing news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a mix of both? Tell me everything, eh!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, uh, I was thinkingno, I mean, I was wondering if, um, if you might want to go to the, uh, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite, eh?",callcenter:"Thank you for calling customer support. My name is Laura, and I'll be happy to assist you today. I understand you're experiencing an issue with your account. Let me pull up your information and see how I can help resolve this for you right away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"en-IN":{podcast:"Welcome to our programme on marine biology. We will explore the fascinating world beneath the oceans, from the deepest waters to coastal regions, and learn about the wonderful creatures that inhabit these environments.",education:"Welcome to today's online mathematics lesson! In this session, we shall delve into the fascinating world of algebra. We will begin with the fundamentals, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, kindly take clear and comprehensive notes. Use our standardised checklist as a guide, noting any deviations or areas of concern. If possible, please take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed upon her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hello, beautiful people! Welcome back to my channel. Today, we are going to share all the details on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to enhance your beauty routine, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh my, here we go. You know, I walked into this improv show, and I thought, 'This could be interesting. Perhaps they'll have a surprise for me.' Well, what happened? The surprise was that I got roped into doing standup for you all.",enthusiastic:"Oh my goodness, that's wonderful news! Congratulations! How are you feeling about it all? Any excitement, nervousness, or perhaps a combination of both? Please tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughter, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil would be your best option.",hesitant:"So, um, I was thinkingno, I mean, I was wondering if, er, if you might want to go to the, um, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordah yes, exquisite.",callcenter:"Thank you for calling customer support. My name is Priya, and I shall be pleased to assist you today. I understand you are experiencing an issue with your account. Kindly allow me to access your information and see how I can help resolve this matter for you immediately.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"hi-IN":{podcast:"                ,                 ",education:"        !   ,              ,  2x  5  11      ,     ",instructions:"   ,               ,             ,      -           ",story:"       ,                              ,    ,          ",ads:"  iPhone  ,                     ,  iPhone         ",news:"     ,                                    ",promotional:",          !                                  ",vlog:",  !       ,                             ,     ",business:"Winnebago Industries      ,               WGO           ",standup:" ,       ,       ,   , ',             ' ,   ?                 ",enthusiastic:" ,    !  !           ?  , ,    ?    !",casual:" ,      !   :             ,                ,  Cirque du Soleil     ",hesitant:", ,    ,   ,     , ,    , ,       ?         ,  ",callcenter:"            ,                                     ",explainer:"                 ,              ,     -                 ,                   "},"es-ES":{podcast:"Bienvenidos a nuestro programa sobre el fascinante mundo de la biologa marina. Desde las profundidades del ocano hasta las costas, exploraremos las maravillas del mundo submarino y las criaturas asombrosas que lo habitan.",education:"Bienvenidos a la clase de matemticas en lnea de hoy! En esta sesin, nos adentraremos en el fascinante mundo del lgebra. Empezaremos explorando los fundamentos, desde resolver ecuaciones simples como 2x ms 5 igual a 11, hasta comprender variables y coeficientes.",instructions:"Al completar la inspeccin, tome notas claras y completas. Utilice nuestra lista de verificacin estandarizada como gua, anotando cualquier desviacin o rea de preocupacin. Si es posible, tome fotografas para documentar visualmente cualquier peligro o problema de incumplimiento.",story:"Una suave melancola pesaba sobre su corazn, tejida de recuerdos de un tiempo cuando las risas resonaban por estos mismos prados. Acarici los delicados ptalos de una margarita olvidada, perdida en sus pensamientos hasta que una voz suave rompi el silencio.",ads:"Presentamos el nuevo iPhone, que establece el estndar de Innovacin Redefinida. Con un diseo elegante y funciones de vanguardia, este iPhone redefine la cspide de la tecnologa.",news:"En las noticias internacionales, la reciente misin exitosa de la NASA para enviar un rover a explorar Marte ha captado la atencin del mundo. El rover, llamado Perseverance, aterriz en la superficie marciana a principios de esta semana.",promotional:"Seoras, es hora de mimarse! Reglese un momento de felicidad con nuestro exclusivo Paquete de Spa de Invierno. Disfrute de un da de spa rejuvenecedor como nunca antes y deje que sus preocupaciones se derritan.",vlog:"Hola, gente hermosa! Bienvenidos de nuevo a mi canal. Hoy, vamos a compartir todos los detalles sobre los ltimos imprescindibles de maquillaje. Ya sea que seas un entusiasta del maquillaje o simplemente quieras mejorar tu juego de glamour, ests en el lugar correcto.",business:"Winnebago Industries es una empresa que fabrica autocaravanas, remolques de viaje y otros vehculos recreativos. Su smbolo de cotizacin burstil es WGO y se cotiza en la Bolsa de Nueva York.",standup:"Oh vaya, aqu vamos. Sabis, entr en este espectculo de improvisacin y pens: 'Oye, esto podra ser divertido. Quizs tengan una sorpresa para m.' Pues, adivinis qu? La sorpresa fue que me obligaron a hacer monlogos para vosotros.",enthusiastic:"Oh Dios mo, esas son noticias increbles! Enhorabuena! Cmo te sientes al respecto? Emocionado, nervioso, o una mezcla de ambos? Cuntamelo todo!",casual:"Oh no, no quise decepcionarte! Qu te parece esto? Si quieres algo peculiar y divertido con muchas risas, ve a ver Blue Man Group. Si buscas algo impresionante y mgico, Cirque du Soleil es tu mejor opcin.",hesitant:"Entonces, eh, estaba pensandono, quiero decir, me preguntaba si, um, si tal vez quisieras ir al, eh, el nuevo restaurante italiano el viernes. He odo que es realmentecul es la palabra?oh, exquisito.",callcenter:"Gracias por llamar al servicio de atencin al cliente. Mi nombre es Carmen, y estar encantada de ayudarle hoy. Entiendo que est experimentando un problema con su cuenta. Permtame consultar su informacin y ver cmo puedo resolver esto para usted de inmediato.",explainer:"Permtanme explicar cmo funciona la fotosntesis. Las plantas utilizan la luz solar, el agua y el dixido de carbono para crear energa. El proceso ocurre en los cloroplastos, que contienen clorofila, el pigmento verde que da a las plantas su color. Cuando la luz solar llega a las hojas, desencadena una reaccin qumica que convierte estos ingredientes en glucosa y oxgeno."},"es-MX":{podcast:"Bienvenidos a nuestro podcast sobre el fascinante mundo de la biologa marina. Desde las profundidades del mar hasta nuestras costas, exploraremos las maravillas del mundo submarino y las criaturas asombrosas que lo habitan.",education:"Bienvenidos a la clase de matemticas en lnea de hoy! En esta sesin, nos adentraremos en el fascinante mundo del lgebra. Comenzaremos explorando los fundamentos, desde resolver ecuaciones simples como 2x ms 5 igual a 11, hasta comprender variables y coeficientes.",instructions:"Al completar la inspeccin, tome notas claras y completas. Utilice nuestra lista de verificacin estandarizada como gua, anotando cualquier desviacin o rea de preocupacin. Si es posible, tome fotografas para documentar visualmente cualquier peligro o problema de incumplimiento.",story:"Una suave melancola pesaba sobre su corazn, tejida de recuerdos de un tiempo cuando las risas resonaban por estos mismos prados. Acarici los delicados ptalos de una margarita olvidada, perdida en sus pensamientos hasta que una voz suave rompi el silencio.",ads:"Presentamos el nuevo iPhone, que establece el estndar de Innovacin Redefinida. Con un diseo elegante y funciones de vanguardia, este iPhone redefine la cspide de la tecnologa.",news:"En las noticias internacionales, la reciente misin exitosa de la NASA para enviar un rover a explorar Marte ha captado la atencin del mundo. El rover, llamado Perseverance, aterriz en la superficie marciana a principios de esta semana.",promotional:"Seoras, es hora de consentirse! Reglense un momento de felicidad con nuestro exclusivo Paquete de Spa de Invierno. Disfruten de un da de spa rejuvenecedor como nunca antes y dejen que sus preocupaciones se derritan.",vlog:"Hola, gente linda! Bienvenidos de nuevo a mi canal. Hoy, vamos a compartir todos los detalles sobre los ltimos imprescindibles de maquillaje. Ya sea que sean entusiastas del maquillaje o simplemente quieran mejorar su juego de glamour, estn en el lugar correcto.",business:"Winnebago Industries es una compaa que fabrica casas rodantes, trileres de viaje y otros vehculos recreativos. Su smbolo de cotizacin burstil es WGO y se cotiza en la Bolsa de Nueva York.",standup:"Ay gey, aqu vamos. Saben, entr a este show de improvisacin y pens: 'rale, esto podra ser divertido. A lo mejor tienen una sorpresa para m.' Pues, adivinen qu? La sorpresa fue que me obligaron a hacer stand-up para ustedes.",enthusiastic:"Ay, qu padre! Esas son noticias increbles! Felicidades! Cmo te sientes al respecto? Emocionado, nervioso, o una mezcla de ambos? Cuntamelo todo!",casual:"Ay no, no quise decepcionarte! Qu te parece esto? Si quieres algo peculiar y divertido con muchas risas, ve a ver Blue Man Group. Si buscas algo impresionante y mgico, Cirque du Soleil es tu mejor opcin.",hesitant:"Entonces, eh, estaba pensandono, o sea, me preguntaba si, este, si tal vez quisieras ir al, eh, el nuevo restaurante italiano el viernes. He odo que es realmentecul es la palabra?ah s, exquisito.",callcenter:"Gracias por llamar a servicio al cliente. Mi nombre es Mara, y con gusto le atender el da de hoy. Entiendo que est teniendo un problema con su cuenta. Permtame consultar su informacin y ver cmo puedo ayudarle a resolver esto de inmediato.",explainer:"Permtanme explicar cmo funciona la fotosntesis. Las plantas utilizan la luz solar, el agua y el dixido de carbono para crear energa. El proceso ocurre en los cloroplastos, que contienen clorofila, el pigmento verde que da a las plantas su color. Cuando la luz solar llega a las hojas, desencadena una reaccin qumica que convierte estos ingredientes en glucosa y oxgeno."},"ja-JP":{podcast:"",education:"2x + 5 = 11",instructions:"",story:"",ads:"iPhoneiPhone",news:"NASA",promotional:"",vlog:"",business:"Winnebago IndustriesWGO",standup:"",enthusiastic:"",casual:"",hesitant:"",callcenter:"",explainer:""},"fr-FR":{podcast:"Bienvenue dans notre mission sur le monde fascinant de la biologie marine. Des profondeurs ocaniques aux ctes, nous explorerons les merveilles du monde sous-marin et les cratures extraordinaires qui l'habitent.",education:"Bienvenue au cours de mathmatiques en ligne d'aujourd'hui ! Dans cette session, nous plongerons dans le monde fascinant de l'algbre. Nous commencerons par explorer les bases, de la rsolution d'quations simples comme 2x plus 5 gale 11,  la comprhension des variables et des coefficients.",instructions:"En effectuant l'inspection, prenez des notes claires et compltes. Utilisez notre liste de contrle standardise comme guide, en notant tout cart ou domaine proccupant. Si possible, prenez des photographies pour documenter visuellement tout danger ou problme de non-conformit.",story:"Une douce mlancolie pesait sur son cur, tisse de souvenirs d'un temps o le rire rsonnait dans ces mmes prairies. Elle caressa les ptales dlicats d'une marguerite oublie, perdue dans ses penses jusqu' ce qu'une voix douce rompe le silence.",ads:"Prsentation du tout nouvel iPhone, tablissant la norme de l'Innovation Redfinie. Arborant un design lgant et des fonctionnalits de pointe, cet iPhone redfinit le summum de la technologie.",news:"En tournant vers les nouvelles internationales, la rcente mission russie de la NASA pour envoyer un rover explorer Mars a capt l'attention du monde. Le rover, nomm Perseverance, s'est pos sur la surface martienne plus tt cette semaine.",promotional:"Mesdames, il est temps de vous faire plaisir ! Offrez-vous un moment de bonheur avec notre forfait spa d'hiver exclusif. Profitez d'une journe spa rajeunissante comme jamais auparavant et laissez vos soucis s'envoler.",vlog:"Salut, les gens magnifiques ! Bienvenue sur ma chane. Aujourd'hui, nous allons partager tous les dtails sur les derniers incontournables du maquillage. Que vous soyez passionn de maquillage ou que vous cherchiez simplement  amliorer votre jeu glamour, vous tes au bon endroit.",business:"Winnebago Industries est une entreprise qui fabrique des camping-cars, des caravanes et d'autres vhicules rcratifs. Son symbole boursier est WGO et elle est cote  la Bourse de New York.",standup:"Oh l l, c'est parti. Vous savez, je suis entr dans ce spectacle d'improvisation, et je me suis dit : 'H, a pourrait tre amusant. Peut-tre qu'ils auront une surprise pour moi.' Eh bien, devinez quoi ? La surprise, c'est qu'on m'a oblig  faire du stand-up pour vous.",enthusiastic:"Oh mon Dieu, c'est une nouvelle incroyable ! Flicitations ! Comment vous sentez-vous  ce sujet ? Excit, nerveux, ou un mlange des deux ? Racontez-moi tout !",casual:"Oh non, je ne voulais pas vous dcevoir ! Que diriez-vous de ceci : Si vous voulez quelque chose d'original et amusant avec beaucoup de rires, optez pour Blue Man Group. Si vous cherchez quelque chose d'impressionnant et magique, Cirque du Soleil est votre meilleur choix.",hesitant:"Alors, euh, je pensaisnon, je veux dire, je me demandais si, euh, si vous aimeriez aller au, euh, nouveau restaurant italien vendredi ? J'ai entendu dire que c'est vraimentquel est le motoh, exquis.",callcenter:"Merci d'avoir appel le service client. Je m'appelle Sophie, et je serai ravie de vous aider aujourd'hui. Je comprends que vous rencontrez un problme avec votre compte. Permettez-moi de consulter vos informations et voir comment je peux rsoudre cela pour vous immdiatement.",explainer:"Permettez-moi d'expliquer comment fonctionne la photosynthse. Les plantes utilisent la lumire du soleil, l'eau et le dioxyde de carbone pour crer de l'nergie. Le processus se droule dans les chloroplastes, qui contiennent de la chlorophylle - le pigment vert qui donne leur couleur aux plantes. Lorsque la lumire du soleil frappe les feuilles, elle dclenche une raction chimique qui convertit ces ingrdients en glucose et en oxygne."},"fr-CA":{podcast:"Bienvenue  notre mission sur le merveilleux monde de la biologie marine. Des profondeurs de l'ocan jusqu'aux ctes, nous explorerons les merveilles du monde sous-marin et les cratures remarquables qui l'habitent.",education:"Bienvenue au cours de mathmatiques en ligne d'aujourd'hui ! Dans cette session, nous plongerons dans le monde fascinant de l'algbre. Nous commencerons par explorer les bases, de la rsolution d'quations simples comme 2x plus 5 gale 11,  la comprhension des variables et des coefficients.",instructions:"En effectuant l'inspection, prenez des notes claires et compltes. Utilisez notre liste de contrle standardise comme guide, en notant tout cart ou domaine proccupant. Si possible, prenez des photos pour documenter visuellement tout danger ou problme de non-conformit.",story:"Une douce mlancolie pesait sur son cur, tisse de souvenirs d'un temps o le rire rsonnait dans ces mmes prairies. Elle caressa les ptales dlicats d'une marguerite oublie, perdue dans ses penses jusqu' ce qu'une voix douce rompe le silence.",ads:"Prsentation du tout nouvel iPhone, tablissant la norme de l'Innovation Redfinie. Arborant un design lgant et des fonctionnalits de pointe, cet iPhone redfinit le summum de la technologie.",news:"En tournant vers les nouvelles internationales, la rcente mission russie de la NASA pour envoyer un rover explorer Mars a capt l'attention du monde. Le rover, nomm Perseverance, s'est pos sur la surface martienne plus tt cette semaine.",promotional:"Mesdames, c'est le temps de vous gter ! Offrez-vous un moment de bonheur avec notre forfait spa d'hiver exclusif. Profitez d'une journe spa rajeunissante comme jamais auparavant et laissez vos soucis s'envoler.",vlog:"Salut, les gens magnifiques ! Bienvenue sur ma chane. Aujourd'hui, on va partager tous les dtails sur les derniers incontournables du maquillage. Que vous soyez passionn de maquillage ou que vous cherchiez simplement  amliorer votre jeu glamour, vous tes  la bonne place.",business:"Winnebago Industries est une entreprise qui fabrique des vhicules rcratifs, des roulottes et d'autres vhicules de loisir. Son symbole boursier est WGO et elle est cote  la Bourse de New York.",standup:"Oh l l, a commence. Vous savez, je suis entr dans ce spectacle d'improvisation, pis je me suis dit : 'H, a pourrait tre le fun. Peut-tre qu'ils auront une surprise pour moi.' Ben, devinez quoi ? La surprise, c'est qu'on m'a oblig  faire du stand-up pour vous autres.",enthusiastic:"Oh mon Dieu, c'est une nouvelle incroyable ! Flicitations ! Comment tu te sens par rapport  a ? Excit, nerveux, ou un mlange des deux ? Raconte-moi tout !",casual:"Oh non, je voulais pas te dcevoir ! Que dirais-tu de a : Si tu veux quelque chose d'original pis amusant avec ben des rires, va voir Blue Man Group. Si tu cherches quelque chose d'impressionnant pis magique, Cirque du Soleil est ton meilleur choix.",hesitant:"Alors, euh, je pensaisnon, je veux dire, je me demandais si, euh, si tu aimerais aller au, euh, nouveau restaurant italien vendredi ? J'ai entendu dire que c'est vraimentquel est le motoh, exquis.",callcenter:"Merci d'avoir appel le service  la clientle. Je m'appelle Isabelle, et je serai heureuse de vous aider aujourd'hui. Je comprends que vous prouvez un problme avec votre compte. Permettez-moi de consulter vos informations et voir comment je peux rgler a pour vous tout de suite.",explainer:"Permettez-moi d'expliquer comment fonctionne la photosynthse. Les plantes utilisent la lumire du soleil, l'eau et le dioxyde de carbone pour crer de l'nergie. Le processus se droule dans les chloroplastes, qui contiennent de la chlorophylle - le pigment vert qui donne leur couleur aux plantes. Lorsque la lumire du soleil frappe les feuilles, elle dclenche une raction chimique qui convertit ces ingrdients en glucose et en oxygne."},"pt-BR":{podcast:"Bem-vindos ao nosso podcast sobre o fascinante mundo da biologia marinha. Das profundezas do oceano at as costas, vamos explorar as maravilhas do mundo submarino e as criaturas incrveis que o habitam.",education:"Bem-vindos  aula de matemtica online de hoje! Nesta sesso, vamos mergulhar no fascinante mundo da lgebra. Comearemos explorando os fundamentos, desde resolver equaes simples como 2x mais 5 igual a 11, at entender variveis e coeficientes.",instructions:"Ao completar a inspeo, faa anotaes claras e abrangentes. Use nossa lista de verificao padronizada como guia, anotando quaisquer desvios ou reas de preocupao. Se possvel, tire fotografias para documentar visualmente quaisquer perigos ou problemas de no conformidade.",story:"Uma melancolia suave pesava em seu corao, tecida de memrias de um tempo quando risadas ecoavam por estes mesmos prados. Ela acariciou as delicadas ptalas de uma margarida esquecida, perdida em pensamentos at que uma voz suave quebrou o silncio.",ads:"Apresentando o novssimo iPhone, estabelecendo o padro para Inovao Redefinida. Com um design elegante e recursos de ponta, este iPhone redefine o pice da tecnologia.",news:"Nas notcias internacionais, a recente misso bem-sucedida da NASA para enviar um rover para explorar Marte capturou a ateno do mundo. O rover, chamado Perseverance, pousou na superfcie marciana no incio desta semana.",promotional:"Senhoras,  hora de se mimarem! Presenteiem-se com um momento de felicidade com nosso exclusivo Pacote de Spa de Inverno. Deliciem-se com um dia de spa rejuvenescedor como nunca antes e deixem suas preocupaes derreterem.",vlog:"E a, gente linda! Bem-vindos de volta ao meu canal. Hoje, vamos compartilhar todos os detalhes sobre os ltimos itens indispensveis de maquiagem. Seja voc um entusiasta de maquiagem ou apenas procurando melhorar seu jogo de glamour, voc est no lugar certo.",business:"Winnebago Industries  uma empresa que fabrica trailers, reboques de viagem e outros veculos recreativos. Seu smbolo de aes  WGO e  negociado na Bolsa de Valores de Nova York.",standup:"Ah cara, l vamos ns. Sabe, eu entrei nesse show de improviso e pensei: 'Ei, isso pode ser divertido. Talvez eles tenham uma surpresa para mim.' Bem, adivinha o qu? A surpresa foi que me obrigaram a fazer stand-up para vocs.",enthusiastic:"Meu Deus, essa  uma notcia incrvel! Parabns! Como voc est se sentindo sobre isso tudo? Empolgado, nervoso, ou uma mistura dos dois? Me conta tudo!",casual:"Ah no, no quis decepcionar! Que tal isso: Se voc quer algo peculiar e divertido com muitas risadas, v de Blue Man Group. Se voc est procurando algo impressionante e mgico, Cirque du Soleil  sua melhor aposta.",hesitant:"Ento, , eu estava pensandono, quero dizer, eu estava me perguntando se, hum, se voc talvez quisesse ir ao, , o novo restaurante italiano na sexta-feira? Eu ouvi que  realmentequal  a palavraah, requintado.",callcenter:"Obrigada por ligar para o suporte ao cliente. Meu nome  Juliana, e terei o prazer de ajud-lo hoje. Entendo que voc est enfrentando um problema com sua conta. Deixe-me consultar suas informaes e ver como posso resolver isso para voc imediatamente.",explainer:"Deixe-me explicar como funciona a fotossntese. As plantas usam luz solar, gua e dixido de carbono para criar energia. O processo acontece nos cloroplastos, que contm clorofila - o pigmento verde que d s plantas sua cor. Quando a luz solar atinge as folhas, ela desencadeia uma reao qumica que converte esses ingredientes em glicose e oxignio."},"pt-PT":{podcast:"Bem-vindos ao nosso programa sobre o fascinante mundo da biologia marinha. Desde as profundezas do oceano at s costas, iremos explorar as maravilhas do mundo submarino e as criaturas extraordinrias que o habitam.",education:"Bem-vindos  aula de matemtica online de hoje! Nesta sesso, vamos mergulhar no fascinante mundo da lgebra. Comearemos por explorar os fundamentos, desde resolver equaes simples como 2x mais 5 igual a 11, at compreender variveis e coeficientes.",instructions:"Ao completar a inspeo, faa anotaes claras e abrangentes. Use a nossa lista de verificao padronizada como guia, anotando quaisquer desvios ou reas de preocupao. Se possvel, tire fotografias para documentar visualmente quaisquer perigos ou problemas de no conformidade.",story:"Uma melancolia suave pesava no seu corao, tecida de memrias de um tempo quando risadas ecoavam por estes mesmos prados. Ela acariciou as delicadas ptalas de uma margarida esquecida, perdida em pensamentos at que uma voz suave quebrou o silncio.",ads:"Apresentamos o novssimo iPhone, estabelecendo o padro para Inovao Redefinida. Com um design elegante e funcionalidades de ponta, este iPhone redefine o auge da tecnologia.",news:"Nas notcias internacionais, a recente misso bem-sucedida da NASA para enviar um rover para explorar Marte capturou a ateno do mundo. O rover, chamado Perseverance, aterrou na superfcie marciana no incio desta semana.",promotional:"Senhoras,  hora de se mimarem! Presenteiem-se com um momento de felicidade com o nosso exclusivo Pacote de Spa de Inverno. Deliciem-se com um dia de spa rejuvenescedor como nunca antes e deixem as vossas preocupaes derreterem.",vlog:"Ol, gente linda! Bem-vindos de volta ao meu canal. Hoje, vamos partilhar todos os detalhes sobre os ltimos indispensveis de maquilhagem. Quer sejam entusiastas de maquilhagem ou apenas procurem melhorar o vosso jogo de glamour, esto no stio certo.",business:"Winnebago Industries  uma empresa que fabrica autocaravanas, reboques de viagem e outros veculos recreativos. O seu smbolo de cotao  WGO e  negociado na Bolsa de Valores de Nova Iorque.",standup:"Oh cus, c vamos ns. Sabem, entrei neste espetculo de improviso e pensei: 'Eh p, isto pode ser divertido. Talvez tenham uma surpresa para mim.' Bem, adivinhem? A surpresa foi que me obrigaram a fazer stand-up para vocs.",enthusiastic:"Meu Deus, essa  uma notcia fantstica! Parabns! Como se est a sentir em relao a isto tudo? Entusiasmado, nervoso, ou uma mistura dos dois? Conta-me tudo!",casual:"Oh no, no quis desiludir! Que tal isto: Se querem algo peculiar e divertido com muitas risadas, vo ao Blue Man Group. Se procuram algo impressionante e mgico, o Cirque du Soleil  a vossa melhor aposta.",hesitant:"Ento, , eu estava a pensarno, quer dizer, estava a perguntar-me se, hum, se talvez quisesses ir ao, , o novo restaurante italiano na sexta-feira? Ouvi dizer que  realmentequal  a palavraah, requintado.",callcenter:"Obrigada por contactar o apoio ao cliente. O meu nome  Sofia, e terei todo o gosto em ajud-lo hoje. Compreendo que est a ter um problema com a sua conta. Permita-me consultar as suas informaes e ver como posso resolver isto para si de imediato.",explainer:"Permitam-me explicar como funciona a fotossntese. As plantas usam luz solar, gua e dixido de carbono para criar energia. O processo acontece nos cloroplastos, que contm clorofila - o pigmento verde que d s plantas a sua cor. Quando a luz solar atinge as folhas, desencadeia uma reao qumica que converte estes ingredientes em glucose e oxignio."},"it-IT":{podcast:"Benvenuti al nostro programma sul affascinante mondo della biologia marina. Dalle profondit dell'oceano alle coste, esploreremo le meraviglie del mondo sottomarino e le creature straordinarie che lo abitano.",education:"Benvenuti alla lezione di matematica online di oggi! In questa sessione, ci immergeremo nel affascinante mondo dell'algebra. Inizieremo esplorando i fondamenti, dalla risoluzione di equazioni semplici come 2x pi 5 uguale 11, alla comprensione di variabili e coefficienti.",instructions:"Mentre completi l'ispezione, prendi note chiare e complete. Usa la nostra lista di controllo standardizzata come guida, annotando eventuali deviazioni o aree di preoccupazione. Se possibile, scatta fotografie per documentare visivamente eventuali pericoli o problemi di non conformit.",story:"Una dolce malinconia pesava sul suo cuore, tessuta da ricordi di un tempo quando le risate risuonavano in questi stessi prati. Accarezz i delicati petali di una margherita dimenticata, persa nei pensieri finch una voce dolce ruppe il silenzio.",ads:"Vi presentiamo il nuovissimo iPhone, che stabilisce lo standard per l'Innovazione Ridefinita. Con un design elegante e funzionalit all'avanguardia, questo iPhone ridefinisce l'apice della tecnologia.",news:"Passando alle notizie internazionali, la recente missione di successo della NASA per inviare un rover ad esplorare Marte ha catturato l'attenzione del mondo. Il rover, chiamato Perseverance,  atterrato sulla superficie marziana all'inizio di questa settimana.",promotional:"Signore,  ora di coccolarsi! Regalatevi un momento di felicit con il nostro esclusivo Pacchetto Spa Invernale. Concedetevi una giornata termale rigenerante come mai prima d'ora e lasciate che le vostre preoccupazioni si sciolgano.",vlog:"Ciao, belle persone! Bentornati sul mio canale. Oggi condivideremo tutti i dettagli sugli ultimi must-have del trucco. Che siate appassionati di trucco o semplicemente vogliate migliorare il vostro gioco glamour, siete nel posto giusto.",business:"Winnebago Industries  un'azienda che produce camper, roulotte e altri veicoli ricr eativi. Il suo simbolo azionario  WGO ed  quotata alla Borsa di New York.",standup:"Oh cavolo, eccoci qui. Sapete, sono entrato in questo spettacolo di improvvisazione e ho pensato: 'Ehi, questo potrebbe essere divertente. Forse avranno una sorpresa per me.' Beh, indovinate un po'? La sorpresa  stata che mi hanno costretto a fare stand-up per voi.",enthusiastic:"Oh mio Dio, questa  una notizia fantastica! Congratulazioni! Come ti senti riguardo a tutto questo? Eccitato, nervoso, o un mix di entrambi? Dimmi tutto!",casual:"Oh no, non volevo deluderti! Che ne dici di questo: Se vuoi qualcosa di stravagante e divertente con tante risate, scegli Blue Man Group. Se cerchi qualcosa di impressionante e magico, Cirque du Soleil  la tua scelta migliore.",hesitant:"Allora, ehm, stavo pensandono, voglio dire, mi chiedevo se, ehm, se forse vorresti andare al, ehm, nuovo ristorante italiano venerd? Ho sentito che  davveroqual  la parolaoh, squisito.",callcenter:"Grazie per aver chiamato l'assistenza clienti. Mi chiamo Francesca, e sar lieta di aiutarla oggi. Capisco che sta riscontrando un problema con il suo account. Mi permetta di consultare le sue informazioni e vedere come posso risolvere questo per lei immediatamente.",explainer:"Permettetemi di spiegare come funziona la fotosintesi. Le piante usano la luce solare, l'acqua e l'anidride carbonica per creare energia. Il processo avviene nei cloroplasti, che contengono la clorofilla - il pigmento verde che d alle piante il loro colore. Quando la luce solare colpisce le foglie, innesca una reazione chimica che converte questi ingredienti in glucosio e ossigeno."}};function o5(n){const e=n.match(/^([a-z]{2}-[A-Z]{2})/i);if(e){const t=e[1].split("-");return`${t[0].toLowerCase()}-${t[1].toUpperCase()}`}return"en-US"}function a5(n){if(eE[n])return eE[n];if(oD[n]){const e=oD[n];return{podcast:e,education:e,instructions:e,story:e,ads:e,news:e,promotional:e,vlog:e,business:e,standup:e,enthusiastic:e,casual:e,hesitant:e,callcenter:e,explainer:e}}return eE["en-US"]}function c5({text:n,onTextChange:e,wordBoundaries:t,currentWordIndex:r,selectedVoice:i,state:s}){const o=W.useRef(null),a=W.useRef(null),[l,u]=W.useState(!1),[p,f]=W.useState(""),g=n.trim()?n.trim().split(/\s+/).length:0,m=n.length,C=o5(i),w=a5(p||C),b=k=>{const O=w[k];O&&(e(O),u(!1))},R=s==="synthesizing"||s==="playing";W.useEffect(()=>{if(r>=0&&r<t.length){const k=t[r];if(o.current){const O=o.current,V=(n.substring(0,k.offset).split(`
`).length-1)*24;O.scrollTop=Math.max(0,V-O.clientHeight/2)}}},[r,t,n]);const P=()=>{if(r<0||r>=t.length)return n;const k=t[r],O=n.substring(0,k.offset),L=n.substring(k.offset,k.offset+k.length),F=n.substring(k.offset+k.length);return A.jsxs(A.Fragment,{children:[O,A.jsx("span",{className:"bg-yellow-300 font-semibold",children:L}),F]})},M=l?`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="en-US">
  <voice name="${i}">
    ${n}
  </voice>
</speak>`:n;return A.jsxs("div",{className:"h-full flex flex-col",children:[A.jsxs("div",{className:"flex items-center justify-between mb-4",children:[A.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Text to Synthesize"}),A.jsxs("div",{className:"flex gap-4 text-sm text-gray-600",children:[A.jsxs("span",{children:[g," word",g!==1?"s":""]}),A.jsxs("span",{children:[m," char",m!==1?"s":""]})]})]}),A.jsxs("div",{className:"mb-3 grid grid-cols-[200px_1fr] gap-3",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preset Language"}),A.jsxs("select",{value:p,onChange:k=>f(k.target.value),disabled:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[A.jsxs("option",{value:"",children:["Voice Language (",C,")"]}),A.jsx("option",{value:"ar-EG",children:"Arabic (Egypt)"}),A.jsx("option",{value:"ar-SA",children:"Arabic (Saudi Arabia)"}),A.jsx("option",{value:"bg-BG",children:"Bulgarian"}),A.jsx("option",{value:"ca-ES",children:"Catalan"}),A.jsx("option",{value:"cs-CZ",children:"Czech"}),A.jsx("option",{value:"cy-GB",children:"Welsh"}),A.jsx("option",{value:"da-DK",children:"Danish"}),A.jsx("option",{value:"de-DE",children:"German"}),A.jsx("option",{value:"el-GR",children:"Greek"}),A.jsx("option",{value:"en-AU",children:"English (Australia)"}),A.jsx("option",{value:"en-CA",children:"English (Canada)"}),A.jsx("option",{value:"en-GB",children:"English (UK)"}),A.jsx("option",{value:"en-IN",children:"English (India)"}),A.jsx("option",{value:"en-US",children:"English (US)"}),A.jsx("option",{value:"es-ES",children:"Spanish (Spain)"}),A.jsx("option",{value:"es-MX",children:"Spanish (Mexico)"}),A.jsx("option",{value:"et-EE",children:"Estonian"}),A.jsx("option",{value:"fi-FI",children:"Finnish"}),A.jsx("option",{value:"fr-CA",children:"French (Canada)"}),A.jsx("option",{value:"fr-FR",children:"French (France)"}),A.jsx("option",{value:"he-IL",children:"Hebrew"}),A.jsx("option",{value:"hi-IN",children:"Hindi"}),A.jsx("option",{value:"hr-HR",children:"Croatian"}),A.jsx("option",{value:"hu-HU",children:"Hungarian"}),A.jsx("option",{value:"id-ID",children:"Indonesian"}),A.jsx("option",{value:"it-IT",children:"Italian"}),A.jsx("option",{value:"ja-JP",children:"Japanese"}),A.jsx("option",{value:"ko-KR",children:"Korean"}),A.jsx("option",{value:"lt-LT",children:"Lithuanian"}),A.jsx("option",{value:"lv-LV",children:"Latvian"}),A.jsx("option",{value:"nb-NO",children:"Norwegian"}),A.jsx("option",{value:"nl-NL",children:"Dutch"}),A.jsx("option",{value:"pl-PL",children:"Polish"}),A.jsx("option",{value:"pt-BR",children:"Portuguese (Brazil)"}),A.jsx("option",{value:"pt-PT",children:"Portuguese (Portugal)"}),A.jsx("option",{value:"ro-RO",children:"Romanian"}),A.jsx("option",{value:"ru-RU",children:"Russian"}),A.jsx("option",{value:"sk-SK",children:"Slovak"}),A.jsx("option",{value:"sl-SI",children:"Slovenian"}),A.jsx("option",{value:"sr-RS",children:"Serbian"}),A.jsx("option",{value:"sv-SE",children:"Swedish"}),A.jsx("option",{value:"th-TH",children:"Thai"}),A.jsx("option",{value:"tr-TR",children:"Turkish"}),A.jsx("option",{value:"uk-UA",children:"Ukrainian"}),A.jsx("option",{value:"vi-VN",children:"Vietnamese"}),A.jsx("option",{value:"zh-CN",children:"Chinese (Mandarin)"}),A.jsx("option",{value:"zh-TW",children:"Chinese (Taiwan)"})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Load Preset Text"}),A.jsxs("select",{onChange:k=>b(k.target.value),disabled:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",defaultValue:"",children:[A.jsx("option",{value:"",children:"-- Select a preset --"}),A.jsx("option",{value:"podcast",children:"Podcast"}),A.jsx("option",{value:"education",children:"Education/Learning"}),A.jsx("option",{value:"instructions",children:"Instructions/Guidance"}),A.jsx("option",{value:"story",children:"Story/Narrative"}),A.jsx("option",{value:"ads",children:"Advertisement"}),A.jsx("option",{value:"news",children:"News Report"}),A.jsx("option",{value:"promotional",children:"Promotional/Marketing"}),A.jsx("option",{value:"vlog",children:"Vlog/Social Media"}),A.jsx("option",{value:"business",children:"Business/Professional"}),A.jsx("option",{value:"callcenter",children:"Call Center/Customer Care"}),A.jsx("option",{value:"standup",children:"Stand-up Comedy"}),A.jsx("option",{value:"enthusiastic",children:"Enthusiastic/Excited"}),A.jsx("option",{value:"casual",children:"Casual Conversation"}),A.jsx("option",{value:"hesitant",children:"Hesitant/Uncertain"}),A.jsx("option",{value:"explainer",children:"Explainer Video"})]})]})]}),A.jsxs("div",{className:"flex-1 relative",children:[r>=0&&A.jsx("div",{ref:a,className:"absolute inset-0 px-3 py-2 pointer-events-none overflow-hidden whitespace-pre-wrap break-words font-mono text-base leading-6 text-transparent",style:{zIndex:1},children:P()}),A.jsx("textarea",{ref:o,value:M,onChange:k=>!l&&e(k.target.value),placeholder:"Enter text here to convert to speech...",readOnly:l,className:"w-full h-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none font-mono text-base leading-6",style:{position:"relative",zIndex:2,background:l?"#f9fafb":"transparent"}})]}),A.jsxs("div",{className:"mt-4 flex gap-2",children:[A.jsx("button",{onClick:()=>u(!l),disabled:!n,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Show Plain Text":"Show SSML"}),A.jsx("button",{onClick:()=>e(""),disabled:!n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Clear Text"})]})]})}function TO({state:n,error:e,audioData:t,hasText:r,isConfigured:i,onPlay:s,onPause:o,onResume:a,onStop:l}){const[u,p]=W.useState(!1),f=r&&i&&n==="idle",g=n==="playing",m=n==="paused",C=n==="playing"||n==="paused"||n==="synthesizing",S=()=>{switch(n){case"idle":return"Ready";case"synthesizing":return"Synthesizing...";case"playing":return"Playing";case"paused":return"Paused";case"error":return"Error";default:return"Unknown"}},w=()=>{switch(n){case"idle":return"text-gray-600";case"synthesizing":return"text-blue-600";case"playing":return"text-green-600";case"paused":return"text-yellow-600";case"error":return"text-red-600";default:return"text-gray-600"}};return A.jsxs("div",{className:"space-y-4",children:[A.jsx("div",{className:"flex items-center justify-between",children:A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status:"}),A.jsx("span",{className:`text-sm font-semibold ${w()}`,children:S()}),n==="synthesizing"&&A.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full"})]})}),e&&A.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:[A.jsx("p",{className:"text-sm text-red-700 font-medium",children:"Error:"}),A.jsx("p",{className:"text-xs text-red-600 mt-1",children:e})]}),!i&&A.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:A.jsx("p",{className:"text-sm text-yellow-700",children:"Please configure your API key and region in the settings panel."})}),A.jsxs("div",{className:"flex gap-2 flex-wrap",children:[A.jsx("button",{onClick:s,disabled:!f,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-600",title:r?i?"Play":"Configure settings first":"Enter text first",children:" Play"}),m?A.jsx("button",{onClick:a,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:" Resume"}):A.jsx("button",{onClick:o,disabled:!g,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-yellow-600 rounded-md hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-yellow-600",children:" Pause"}),A.jsx("button",{onClick:l,disabled:!C,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-red-600",children:" Stop"}),A.jsx("button",{onClick:()=>p(!u),className:"px-3 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",title:"Help",children:A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})})]}),u&&A.jsxs("div",{className:"text-xs text-gray-500 space-y-1 pt-2 mt-2 border-t border-gray-200",children:[A.jsx("p",{children:" Click Play to start synthesis and playback"}),A.jsx("p",{children:" Word highlighting shows the current word being spoken"}),A.jsx("p",{children:" Save audio from history panel below"})]})]})}function xO({text:n,selectedVoice:e,region:t,audioData:r}){const i=async()=>{try{const s=`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="en-US">
  <voice name="${e}">
    ${n}
  </voice>
</speak>`,o=`
Voice: ${e}
Region: ${t}

SSML:
${s}

Text:
${n}

${r?"Please find the audio file attached (downloaded separately).":"[No audio generated yet]"}
      `.trim(),a=encodeURIComponent(`Azure Voice Playground Feedback - ${e}`),l=encodeURIComponent(o),u=`mailto:ttsvoicefeedback@microsoft.com?subject=${a}&body=${l}`;if(r){const p=new Blob([r],{type:"audio/mpeg"}),f=URL.createObjectURL(p),g=document.createElement("a");g.href=f,g.download=`feedback-${e}-${Date.now()}.mp3`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(f)}navigator.clipboard&&await navigator.clipboard.writeText(s),window.open(u,"_blank"),r&&alert("Audio file downloaded! Please attach it to your email before sending.")}catch(s){console.error("Error sending feedback:",s),alert("Error preparing feedback. Please try again.")}};return A.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200 text-sm font-medium",title:"Send feedback with SSML and audio",children:[A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[A.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),A.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),"Send Feedback"]})}function IO(n,e){const t=new Blob([n],{type:"audio/mpeg"}),r=URL.createObjectURL(t),i=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5),s=e||`tts-output-${i}.mp3`,o=document.createElement("a");o.href=r,o.download=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(()=>URL.revokeObjectURL(r),100)}function lP(n){return new Promise((e,t)=>{const r=new Blob([n],{type:"audio/mpeg"}),i=URL.createObjectURL(r),s=new Audio(i);s.addEventListener("loadedmetadata",()=>{e(s.duration),URL.revokeObjectURL(i)}),s.addEventListener("error",()=>{t(new Error("Failed to load audio metadata")),URL.revokeObjectURL(i)})})}function _O(n){const e=Math.floor(n/60),t=Math.floor(n%60);return`${e}:${t.toString().padStart(2,"0")}`}function l5({entry:n,onDelete:e}){const[t,r]=W.useState(!1),i=W.useRef(null),s=W.useRef(null);W.useEffect(()=>{const f=new Blob([n.audioData],{type:"audio/mpeg"}),g=URL.createObjectURL(f);return s.current=g,()=>{s.current&&URL.revokeObjectURL(s.current)}},[n.audioData]);const o=()=>{i.current||(i.current=new Audio(s.current||""),i.current.addEventListener("ended",()=>{r(!1)})),t?(i.current.pause(),r(!1)):(i.current.play(),r(!0))},a=()=>{const f=new Date(n.timestamp).toISOString().replace(/[:.]/g,"-").slice(0,-5),g=n.voice.replace(/[^a-zA-Z0-9-]/g,"_"),C=`azurevoice-${n.region.replace(/[^a-zA-Z0-9-]/g,"_")}-${g}-${f}.mp3`;IO(n.audioData,C)},l=()=>{e&&(i.current&&(i.current.pause(),i.current=null),e(n.id))},u=n.text.length>100?n.text.substring(0,100)+"...":n.text,p=new Date(n.timestamp).toLocaleTimeString();return A.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border border-gray-200 rounded-md hover:bg-gray-50",children:[A.jsxs("div",{className:"flex-1 min-w-0",children:[A.jsx("p",{className:"text-sm text-gray-800 truncate mb-1",children:u}),A.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[A.jsx("span",{children:p}),A.jsx("span",{children:""}),A.jsx("span",{className:"truncate max-w-[200px]",children:n.voice}),A.jsx("span",{children:""}),A.jsx("span",{children:n.region}),A.jsx("span",{children:""}),A.jsx("span",{children:_O(n.duration)})]})]}),A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("button",{onClick:o,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md transition-colors",title:t?"Pause":"Play",children:t?A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),A.jsx("button",{onClick:a,className:"p-2 text-green-600 hover:bg-green-50 rounded-md transition-colors",title:"Save as MP3",children:A.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:[A.jsx("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),A.jsx("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})]})}),e&&A.jsx("button",{onClick:l,className:"p-2 text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{fillRule:"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z",clipRule:"evenodd"})})})]})]})}function u5({history:n,onClearHistory:e,onDeleteEntry:t}){const[r,i]=W.useState(!1),s=()=>{i(!r)};return A.jsxs("div",{className:"border-t border-gray-200 bg-gray-50",children:[A.jsxs("div",{className:"flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-gray-100",onClick:s,children:[A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Synthesis History"}),n.length>0&&A.jsx("span",{className:"px-2 py-1 text-xs font-medium text-white bg-blue-600 rounded-full",children:n.length})]}),A.jsxs("div",{className:"flex items-center gap-2",children:[n.length>0&&A.jsx("button",{onClick:o=>{o.stopPropagation(),window.confirm("Clear all history?")&&e()},className:"px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors",children:"Clear All"}),A.jsx("button",{className:"p-1 text-gray-600",children:A.jsx("svg",{className:`w-5 h-5 transform transition-transform ${r?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),r&&A.jsx("div",{className:"px-4 pb-4 max-h-60 overflow-y-auto",children:n.length===0?A.jsxs("div",{className:"py-8 text-center text-gray-500",children:[A.jsx("p",{children:"No synthesis history yet"}),A.jsx("p",{className:"text-sm mt-1",children:"Synthesized audio will appear here"})]}):A.jsx("div",{className:"space-y-2",children:[...n].reverse().map(o=>A.jsx(l5,{entry:o,onDelete:t},o.id))})})]})}function d5({settings:n,onSettingsChange:e,isConfigured:t,history:r,addToHistory:i,removeFromHistory:s,clearHistory:o}){const[a,l]=W.useState("Welcome to Azure Voice Playground. Select a voice and choose a preset text to get started, or type your own text."),u=W.useRef(null),{state:p,error:f,wordBoundaries:g,currentWordIndex:m,audioData:C,synthesize:S,pause:w,resume:b,stop:R}=i5(n);W.useEffect(()=>{C&&C!==u.current&&(u.current=C,lP(C).then(I=>{i({timestamp:Date.now(),text:a,voice:n.selectedVoice,region:n.region,audioData:C,duration:I})}).catch(I=>{console.error("Failed to get audio duration:",I);const M=C.byteLength*8/48e3;i({timestamp:Date.now(),text:a,voice:n.selectedVoice,region:n.region,audioData:C,duration:M})}))},[C,a,n.selectedVoice,n.region,i]);const P=()=>{S(a)};return A.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[A.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[A.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 shadow-md",children:[A.jsx("h1",{className:"text-3xl font-bold",children:"Text to Speech"}),A.jsx("p",{className:"text-blue-100 mt-1",children:"Realtime text-to-Speech voices from Microsoft Foundry Voice Gallery"})]}),A.jsxs("div",{className:"flex-1 grid grid-rows-[1fr_auto] gap-6 p-6 overflow-hidden",children:[A.jsx("div",{className:"overflow-hidden",children:A.jsx(c5,{text:a,onTextChange:l,wordBoundaries:g,currentWordIndex:m,selectedVoice:n.selectedVoice,state:p})}),A.jsx("div",{className:"border-t border-gray-200 pt-6",children:A.jsx(TO,{state:p,error:f,audioData:C,hasText:a.trim().length>0,isConfigured:t,onPlay:P,onPause:w,onResume:b,onStop:R})})]}),A.jsx(u5,{history:r,onClearHistory:o,onDeleteEntry:s}),A.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsx("p",{className:"text-xs text-gray-600",children:"Built with React, TypeScript, and Azure Cognitive Services Speech SDK"}),A.jsx(xO,{text:a,selectedVoice:n.selectedVoice,region:n.region,audioData:C})]})})]}),A.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-hidden",children:[A.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Voice Selection"}),A.jsx("div",{className:"flex-1 min-h-0",children:A.jsx(s5,{apiKey:n.apiKey,region:n.region,selectedVoice:n.selectedVoice,onVoiceChange:I=>{console.log("TTSPlayground: Voice changed to:",I),e({selectedVoice:I})}})})]})]})}const kO=[{name:"en-US-AmandaMultilingualNeural",displayName:"Amanda",gender:"Female"},{name:"en-US-AvaMultilingualNeural",displayName:"Ava",gender:"Female"},{name:"en-US-CoraMultilingualNeural",displayName:"Cora",gender:"Female"},{name:"en-US-EmmaMultilingualNeural",displayName:"Emma",gender:"Female"},{name:"en-US-EvelynMultilingualNeural",displayName:"Evelyn",gender:"Female"},{name:"en-US-JennyMultilingualNeural",displayName:"Jenny",gender:"Female"},{name:"en-US-LolaMultilingualNeural",displayName:"Lola",gender:"Female"},{name:"en-US-NancyMultilingualNeural",displayName:"Nancy",gender:"Female"},{name:"en-US-NovaTurboMultilingualNeural",displayName:"Nova (Turbo)",gender:"Female"},{name:"en-US-PhoebeMultilingualNeural",displayName:"Phoebe",gender:"Female"},{name:"en-US-SerenaMultilingualNeural",displayName:"Serena",gender:"Female"},{name:"en-US-ShimmerTurboMultilingualNeural",displayName:"Shimmer (Turbo)",gender:"Female"},{name:"en-US-AdamMultilingualNeural",displayName:"Adam",gender:"Male"},{name:"en-US-AlloyTurboMultilingualNeural",displayName:"Alloy (Turbo)",gender:"Male"},{name:"en-US-AndrewMultilingualNeural",displayName:"Andrew",gender:"Male"},{name:"en-US-BrandonMultilingualNeural",displayName:"Brandon",gender:"Male"},{name:"en-US-BrianMultilingualNeural",displayName:"Brian",gender:"Male"},{name:"en-US-ChristopherMultilingualNeural",displayName:"Christopher",gender:"Male"},{name:"en-US-DavisMultilingualNeural",displayName:"Davis",gender:"Male"},{name:"en-US-DerekMultilingualNeural",displayName:"Derek",gender:"Male"},{name:"en-US-DustinMultilingualNeural",displayName:"Dustin",gender:"Male"},{name:"en-US-EchoTurboMultilingualNeural",displayName:"Echo (Turbo)",gender:"Male"},{name:"en-US-LewisMultilingualNeural",displayName:"Lewis",gender:"Male"},{name:"en-US-OnyxTurboMultilingualNeural",displayName:"Onyx (Turbo)",gender:"Male"},{name:"en-US-RyanMultilingualNeural",displayName:"Ryan",gender:"Male"},{name:"en-US-SamuelMultilingualNeural",displayName:"Samuel",gender:"Male"},{name:"en-US-SteffanMultilingualNeural",displayName:"Steffan",gender:"Male"},{name:"en-US-FableTurboMultilingualNeural",displayName:"Fable (Turbo)",gender:"Neutral"}];async function h5(n,e){const t=e.accountName.trim(),r=e.containerName.trim(),i=e.sasToken.trim(),s=Date.now(),o=n.name.replace(/[^a-zA-Z0-9.-]/g,"_"),a=`voice-conversion/${s}-${o}`,l=i.startsWith("?")?i:`?${i}`,u=`https://${t}.blob.core.windows.net/${r}/${a}${l}`;console.log("Uploading to blob URL:",u.split("?")[0]);const p=await n.arrayBuffer();let f;try{f=await fetch(u,{method:"PUT",headers:{"x-ms-blob-type":"BlockBlob","Content-Type":n.type||"application/octet-stream"},body:p})}catch(m){throw console.error("Blob upload fetch error:",m),new Error(`Failed to upload to blob storage. This is likely a CORS issue. Please enable CORS on your Azure Storage Account "${t}": Go to Azure Portal  Storage Account  Settings  Resource sharing (CORS)  Add rule with Allowed origins: *, Methods: GET,PUT,OPTIONS, Headers: *`)}if(!f.ok){const m=await f.text();throw new Error(`Failed to upload to blob storage: ${f.status} ${f.statusText}. ${m}`)}const g=`https://${t}.blob.core.windows.net/${r}/${a}${l}`;return console.log("Blob uploaded successfully:",g.split("?")[0]),g}function p5(n){return n.accountName.trim()?n.containerName.trim()?n.sasToken.trim()?null:"SAS Token is required":"Container Name is required":"Storage Account Name is required"}function f5(){try{const n=localStorage.getItem("azure-voice-blob-config");if(n)return JSON.parse(n)}catch(n){console.error("Failed to load blob config:",n)}return{accountName:"",containerName:"",sasToken:""}}function g5(n){try{localStorage.setItem("azure-voice-blob-config",JSON.stringify(n))}catch(e){console.error("Failed to save blob config:",e)}}function v5({apiKey:n,region:e}){const[t,r]=W.useState("idle"),[i,s]=W.useState(""),[o,a]=W.useState(null),l=W.useCallback(()=>{r("idle"),s(""),a(null)},[]),u=W.useCallback(async(p,f,g)=>{if(!n){s("Azure API Key is required"),r("error");return}if(!e){s("Azure Region is required"),r("error");return}const m=p5(g);if(m){s(m),r("error");return}const C=100*1024*1024;if(p.size>C){s("File size must be less than 100 MB"),r("error");return}try{r("uploading"),s(""),console.log("Uploading audio to blob storage...");const S=await h5(p,g);console.log("Audio uploaded, URL:",S.split("?")[0]),r("converting"),console.log("Starting voice conversion...");const w=S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),b=`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="en-US"><voice name="${f.name}"><mstts:voiceconversion url="${w}"/></voice></speak>`;console.log("SSML:",b);const R=`https://${e}.tts.speech.microsoft.com/cognitiveservices/v1`,P=await fetch(R,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":n,"Content-Type":"application/ssml+xml","X-Microsoft-OutputFormat":"audio-24khz-48kbitrate-mono-mp3","User-Agent":"AzureVoicePlayground"},body:b});if(!P.ok){const M=await P.text();throw new Error(`Voice conversion failed: ${P.status} ${P.statusText}. ${M}`)}const I=await P.arrayBuffer();console.log("Voice conversion completed, audio size:",I.byteLength),a(I),r("idle")}catch(S){console.error("Voice conversion error:",S),s(S instanceof Error?S.message:"Voice conversion failed"),r("error")}},[n,e]);return{state:t,error:i,resultAudioData:o,convert:u,reset:l}}function m5({selectedVoice:n,onVoiceChange:e}){const[t,r]=W.useState(""),[i,s]=W.useState("All"),o=W.useMemo(()=>kO.filter(l=>{if(i!=="All"&&l.gender!==i)return!1;if(t){const u=t.toLowerCase();return l.displayName.toLowerCase().includes(u)||l.name.toLowerCase().includes(u)}return!0}),[t,i]),a=["All","Female","Male"];return A.jsxs("div",{className:"space-y-4",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Target Voice"}),A.jsx("div",{className:"flex gap-2 flex-wrap",children:a.map(l=>A.jsx("button",{onClick:()=>s(l),className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${i===l?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:l},l))}),A.jsx("input",{type:"text",placeholder:"Search voices...",value:t,onChange:l=>r(l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),n&&A.jsxs("div",{className:"p-2 bg-blue-50 border border-blue-200 rounded-md",children:[A.jsx("div",{className:"text-xs text-blue-600 font-medium",children:"Selected:"}),A.jsx("div",{className:"text-sm text-blue-800 truncate",children:n.displayName})]}),A.jsx("div",{className:"max-h-96 overflow-y-auto border border-gray-200 rounded-md",children:o.length===0?A.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No voices found"}):o.map(l=>A.jsxs("button",{onClick:()=>e(l),className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${(n==null?void 0:n.name)===l.name?"bg-blue-50 border-l-4 border-l-blue-600":"hover:bg-gray-50"}`,children:[A.jsx("div",{className:"font-medium text-gray-800",children:l.displayName}),A.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[A.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs ${l.gender==="Female"?"bg-pink-100 text-pink-700":l.gender==="Male"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:l.gender}),A.jsx("span",{className:"text-gray-400",children:"en-US"})]})]},l.name))}),A.jsxs("div",{className:"text-xs text-gray-500",children:[o.length," voice",o.length!==1?"s":""," available"]})]})}const y5=["audio/wav","audio/wave","audio/x-wav","audio/mp3","audio/mpeg","audio/ogg","audio/flac","audio/x-flac","audio/webm"],S5=100*1024*1024;function C5({file:n,onFileChange:e,disabled:t}){const r=W.useRef(null),i=W.useRef(null),s=W.useRef(null),[o,a]=W.useState(!1),[l,u]=W.useState(""),[p,f]=W.useState(!1);W.useEffect(()=>(n?(s.current&&URL.revokeObjectURL(s.current),s.current=URL.createObjectURL(n)):(s.current&&(URL.revokeObjectURL(s.current),s.current=null),i.current&&(i.current.pause(),i.current=null),f(!1)),()=>{s.current&&URL.revokeObjectURL(s.current)}),[n]);const g=W.useCallback(k=>{k.stopPropagation(),s.current&&(i.current||(i.current=new Audio(s.current),i.current.addEventListener("ended",()=>{f(!1)})),p?(i.current.pause(),f(!1)):(i.current.play(),f(!0)))},[p]),m=W.useCallback(k=>!y5.includes(k.type)&&!k.name.match(/\.(wav|mp3|ogg|flac|webm)$/i)?"Unsupported file format. Please use WAV, MP3, OGG, FLAC, or WebM.":k.size>S5?`File size must be less than 100 MB. Your file is ${(k.size/(1024*1024)).toFixed(1)} MB.`:null,[]),C=W.useCallback(k=>{const O=m(k);if(O){u(O),e(null);return}u(""),e(k)},[m,e]),S=W.useCallback(k=>{k.preventDefault(),k.stopPropagation(),a(!0)},[]),w=W.useCallback(k=>{k.preventDefault(),k.stopPropagation(),a(!1)},[]),b=W.useCallback(k=>{if(k.preventDefault(),k.stopPropagation(),a(!1),t)return;const O=k.dataTransfer.files;O.length>0&&C(O[0])},[t,C]),R=W.useCallback(k=>{const O=k.target.files;O&&O.length>0&&C(O[0])},[C]),P=W.useCallback(()=>{var k;(k=r.current)==null||k.click()},[]),I=W.useCallback(()=>{e(null),u(""),r.current&&(r.current.value="")},[e]),M=k=>k<1024?`${k} B`:k<1024*1024?`${(k/1024).toFixed(1)} KB`:`${(k/(1024*1024)).toFixed(1)} MB`;return A.jsxs("div",{className:"space-y-3",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Source Audio"}),A.jsx("input",{ref:r,type:"file",accept:".wav,.mp3,.ogg,.flac,.webm,audio/*",onChange:R,className:"hidden",disabled:t}),A.jsx("div",{onDragOver:S,onDragLeave:w,onDrop:b,className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${t?"border-gray-200 bg-gray-50 cursor-not-allowed":o?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400 cursor-pointer"}`,onClick:t?void 0:P,children:n?A.jsxs("div",{className:"flex items-center justify-center gap-3",children:[A.jsx("svg",{className:"w-8 h-8 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})}),A.jsxs("div",{className:"text-left flex-1 min-w-0",children:[A.jsx("p",{className:"font-medium text-gray-800 truncate",children:n.name}),A.jsx("p",{className:"text-sm text-gray-500",children:M(n.size)})]}),A.jsx("button",{onClick:g,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-full transition-colors flex-shrink-0",title:p?"Pause":"Play source audio",children:p?A.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):A.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),A.jsx("button",{onClick:k=>{k.stopPropagation(),I()},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors flex-shrink-0",title:"Remove file",children:A.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):A.jsxs("div",{children:[A.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),A.jsxs("p",{className:"text-gray-600 mb-1",children:[A.jsx("span",{className:"font-medium text-blue-600",children:"Click to browse"})," or drag and drop"]}),A.jsx("p",{className:"text-sm text-gray-500",children:"WAV, MP3, OGG, FLAC, WebM (max 100 MB)"})]})}),l&&A.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded-md",children:l})]})}function b5({history:n,onClearHistory:e,onDeleteEntry:t}){const[r,i]=W.useState(!1),s=()=>{i(!r)};return A.jsxs("div",{className:"border-t border-gray-200 bg-gray-50",children:[A.jsxs("div",{className:"flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-gray-100",onClick:s,children:[A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Conversion History"}),n.length>0&&A.jsx("span",{className:"px-2 py-1 text-xs font-medium text-white bg-purple-600 rounded-full",children:n.length})]}),A.jsxs("div",{className:"flex items-center gap-2",children:[n.length>0&&A.jsx("button",{onClick:o=>{o.stopPropagation(),window.confirm("Clear all conversion history?")&&e()},className:"px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors",children:"Clear All"}),A.jsx("button",{className:"p-1 text-gray-600",children:A.jsx("svg",{className:`w-5 h-5 transform transition-transform ${r?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),r&&A.jsx("div",{className:"px-4 pb-4 max-h-60 overflow-y-auto",children:n.length===0?A.jsxs("div",{className:"py-8 text-center text-gray-500",children:[A.jsx("p",{children:"No conversion history yet"}),A.jsx("p",{className:"text-sm mt-1",children:"Converted audio will appear here"})]}):A.jsx("div",{className:"space-y-2",children:[...n].reverse().map(o=>A.jsx(w5,{entry:o,onDelete:t},o.id))})})]})}function w5({entry:n,onDelete:e}){const[t,r]=W.useState(!1),i=W.useRef(null),s=W.useRef(null);W.useEffect(()=>{const f=new Blob([n.resultAudioData],{type:"audio/mpeg"}),g=URL.createObjectURL(f);return s.current=g,()=>{s.current&&URL.revokeObjectURL(s.current)}},[n.resultAudioData]);const o=()=>{i.current||(i.current=new Audio(s.current||""),i.current.addEventListener("ended",()=>{r(!1)})),t?(i.current.pause(),r(!1)):(i.current.play(),r(!0))},a=()=>{const f=new Date(n.timestamp).toISOString().replace(/[:.]/g,"-").slice(0,-5),g=n.targetVoice.replace(/[^a-zA-Z0-9-]/g,"_"),C=`voiceconversion-${n.sourceFileName.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9-]/g,"_")}-to-${g}-${f}.mp3`;IO(n.resultAudioData,C)},l=()=>{i.current&&(i.current.pause(),i.current=null),e(n.id)},u=new Date(n.timestamp).toLocaleTimeString(),p=n.targetVoice.replace("en-US-","").replace("MultilingualNeural","").replace("Turbo"," (Turbo)");return A.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border border-gray-200 rounded-md hover:bg-gray-50",children:[A.jsxs("div",{className:"flex-1 min-w-0",children:[A.jsxs("p",{className:"text-sm text-gray-800 truncate mb-1",children:[A.jsx("span",{className:"font-medium",children:n.sourceFileName}),A.jsx("span",{className:"text-gray-400 mx-2",children:""}),A.jsx("span",{className:"text-purple-600",children:p})]}),A.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[A.jsx("span",{children:u}),A.jsx("span",{children:""}),A.jsx("span",{children:n.region}),A.jsx("span",{children:""}),A.jsx("span",{children:_O(n.duration)})]})]}),A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("button",{onClick:o,className:"p-2 text-purple-600 hover:bg-purple-50 rounded-md transition-colors",title:t?"Pause":"Play",children:t?A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),A.jsx("button",{onClick:a,className:"p-2 text-green-600 hover:bg-green-50 rounded-md transition-colors",title:"Save as MP3",children:A.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:[A.jsx("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),A.jsx("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})]})}),A.jsx("button",{onClick:l,className:"p-2 text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{fillRule:"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z",clipRule:"evenodd"})})})]})]})}function A5({sourceFileName:n,targetVoice:e,region:t,audioData:r}){const i=async()=>{try{const s=`
Source File: ${n||"[No file selected]"}
Target Voice: ${e||"[No voice selected]"}
Region: ${t}

${r?"Please find the converted audio file attached (downloaded separately).":"[No conversion completed yet]"}
      `.trim(),o=encodeURIComponent(`Azure Voice Conversion Feedback - ${e||"No voice"}`),a=encodeURIComponent(s),l=`mailto:ttsvoicefeedback@microsoft.com?subject=${o}&body=${a}`;if(r){const u=new Blob([r],{type:"audio/mpeg"}),p=URL.createObjectURL(u),f=document.createElement("a");f.href=p,f.download=`conversion-${e||"output"}-${Date.now()}.mp3`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(p)}window.open(l,"_blank"),r&&alert("Audio file downloaded! Please attach it to your email before sending.")}catch(s){console.error("Error sending feedback:",s),alert("Error preparing feedback. Please try again.")}};return A.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200 text-sm font-medium",title:"Send feedback about voice conversion",children:[A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[A.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),A.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),"Send Feedback"]})}function E5({settings:n,onSettingsChange:e,isConfigured:t,history:r,addToHistory:i,removeFromHistory:s,clearHistory:o}){const[a,l]=W.useState(f5),[u,p]=W.useState(!1),[f,g]=W.useState(null),[m,C]=W.useState(kO[0]),[S,w]=W.useState(!1),b=W.useRef(null),R=W.useRef(null),P=W.useRef(null),{state:I,error:M,resultAudioData:k,convert:O,reset:L}=v5({apiKey:n.apiKey,region:n.region});W.useEffect(()=>{g5(a)},[a]),W.useEffect(()=>{k&&f&&m&&k!==P.current&&(P.current=k,lP(k).then(J=>{i({timestamp:Date.now(),sourceFileName:f.name,targetVoice:m.name,region:n.region,resultAudioData:k,duration:J})}).catch(J=>{console.error("Failed to get audio duration:",J);const ee=k.byteLength*8/48e3;i({timestamp:Date.now(),sourceFileName:f.name,targetVoice:m.name,region:n.region,resultAudioData:k,duration:ee})}))},[k,f,m,n.region,i]),W.useEffect(()=>{if(k){R.current&&URL.revokeObjectURL(R.current);const J=new Blob([k],{type:"audio/mpeg"});R.current=URL.createObjectURL(J)}return()=>{R.current&&URL.revokeObjectURL(R.current)}},[k]);const F=W.useCallback(()=>{!f||!m||O(f,m,a)},[f,m,a,O]),H=W.useCallback(()=>{R.current&&(b.current||(b.current=new Audio(R.current),b.current.addEventListener("ended",()=>{w(!1)})),S?(b.current.pause(),w(!1)):(b.current.play(),w(!0)))},[S]),V=a.accountName&&a.containerName&&a.sasToken,ie=t&&V&&f&&m&&(I==="idle"||I==="error");return A.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[A.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[A.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 shadow-md",children:[A.jsx("h1",{className:"text-3xl font-bold",children:"Voice Changer"}),A.jsx("p",{className:"text-purple-100 mt-1",children:"Transform your voice using Azure Voice Conversion (Preview)"})]}),A.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[A.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[A.jsxs("button",{onClick:()=>p(!u),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",children:[A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})}),A.jsx("span",{className:"font-medium text-gray-800",children:"Azure Blob Storage Configuration"}),V&&A.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded-full",children:"Configured"})]}),A.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${u?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),u&&A.jsxs("div",{className:"p-4 space-y-4 border-t border-gray-200",children:[A.jsxs("p",{className:"text-sm text-gray-600",children:["Voice conversion requires uploading audio to Azure Blob Storage.",A.jsx("a",{href:"https://portal.azure.com/#create/Microsoft.StorageAccount",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline ml-1",children:"Create a storage account"})]}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Storage Account Name"}),A.jsx("input",{type:"text",value:a.accountName,onChange:J=>l(ee=>({...ee,accountName:J.target.value})),placeholder:"mystorageaccount",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Container Name"}),A.jsx("input",{type:"text",value:a.containerName,onChange:J=>l(ee=>({...ee,containerName:J.target.value})),placeholder:"audio-files",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SAS Token"}),A.jsx("input",{type:"password",value:a.sasToken,onChange:J=>l(ee=>({...ee,sasToken:J.target.value})),placeholder:"?sv=2022-11-02&ss=b...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})]}),A.jsx("p",{className:"text-xs text-gray-500",children:"SAS token needs read and write permissions. Credentials are stored locally in your browser."}),A.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-md",children:[A.jsx("p",{className:"text-xs font-medium text-amber-800 mb-1",children:"CORS Configuration Required"}),A.jsx("p",{className:"text-xs text-amber-700",children:"In Azure Portal, go to your Storage Account  Resource sharing (CORS) and add a rule:"}),A.jsxs("ul",{className:"text-xs text-amber-700 mt-1 ml-4 list-disc",children:[A.jsxs("li",{children:["Allowed origins: ",A.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"*"})]}),A.jsxs("li",{children:["Allowed methods: ",A.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"GET, PUT, OPTIONS"})]}),A.jsxs("li",{children:["Allowed headers: ",A.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"*"})]})]})]})]})]}),A.jsx(C5,{file:f,onFileChange:g,disabled:I!=="idle"}),A.jsxs("div",{className:"flex items-center gap-4",children:[A.jsx("button",{onClick:F,disabled:!ie,className:`px-6 py-3 rounded-lg font-medium transition-colors ${ie?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:I==="uploading"?"Uploading...":I==="converting"?"Converting...":"Convert Voice"}),!t&&A.jsx("p",{className:"text-sm text-amber-600",children:"Please configure Azure API key and region in the sidebar."}),t&&!V&&A.jsx("p",{className:"text-sm text-amber-600",children:"Please configure Blob Storage above."})]}),M&&A.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:[A.jsx("p",{className:"font-medium",children:"Error"}),A.jsx("p",{className:"text-sm",children:M})]}),k&&A.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("div",{children:[A.jsx("p",{className:"font-medium text-green-800",children:"Conversion Complete"}),A.jsxs("p",{className:"text-sm text-green-600",children:[f==null?void 0:f.name,"  ",m==null?void 0:m.displayName]})]}),A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("button",{onClick:H,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:S?A.jsxs(A.Fragment,{children:[A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}),"Pause"]}):A.jsxs(A.Fragment,{children:[A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})}),"Play Result"]})}),A.jsx("button",{onClick:L,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"New Conversion"})]})]})})]}),A.jsx(b5,{history:r,onClearHistory:o,onDeleteEntry:s}),A.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsx("p",{className:"text-xs text-gray-600",children:"Voice Conversion is a preview feature. Only en-US voices are supported. Zeroshot is also supported, contact us."}),A.jsx(A5,{sourceFileName:(f==null?void 0:f.name)||null,targetVoice:(m==null?void 0:m.displayName)||null,region:n.region,audioData:k})]})})]}),A.jsx("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 overflow-y-auto",children:A.jsx(m5,{selectedVoice:m,onVoiceChange:C})})]})}function R5(n){const e=n.match(/multitalker-([^:]+)/i);return e?e[1].split("-").filter(r=>r.length>0):[]}function P5(n){const e=n.match(/^([a-z]{2}-[a-z]{2})/i);if(e){const t=e[1].split("-");return`${t[0].toLowerCase()}-${t[1].toUpperCase()}`}return"en-US"}function T5(n){if(!n.name.toLowerCase().includes("multitalker"))return null;const e=R5(n.name);if(e.length===0)return null;const t=P5(n.name),i=`${e.map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" & ")} (${t})`;return{name:n.name,displayName:i,locale:t,speakers:e}}function aD(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function MO(n,e,t,r){const i=r.map(a=>a.toLowerCase()),o=n.split(`
`).filter(a=>a.trim()).map(a=>{const l=a.indexOf(":");if(l>0){const p=a.substring(0,l).trim().toLowerCase(),f=a.substring(l+1).trim();if(i.indexOf(p)>=0&&f)return`<mstts:turn speaker="${p}">${aD(f)}</mstts:turn>`}return a.trim()?`<mstts:turn speaker="${r[0].toLowerCase()}">${aD(a.trim())}</mstts:turn>`:""}).filter(a=>a).join(`
`);return`<speak xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" version="1.0" xml:lang="${t}">
<voice name="${e}">
<lang xml:lang="${t}">
<mstts:dialog>
${o}
</mstts:dialog>
</lang>
</voice>
</speak>`}function x5({apiKey:n,region:e}){const[t,r]=W.useState("idle"),[i,s]=W.useState(""),[o,a]=W.useState(null),[l,u]=W.useState(""),p=W.useRef(null),f=W.useRef(null),g=W.useRef([]),m=W.useRef(0),C=W.useRef(!1),S=W.useRef(null),w=W.useCallback(M=>{p.current&&p.current.close(),console.log("Initializing multi-talker synthesizer with voice:",M);const k=Ti.SpeechConfig.fromSubscription(n,e);k.speechSynthesisOutputFormat=Ti.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3;const O=new Ti.SpeakerAudioDestination;f.current=O;const L=Ti.AudioConfig.fromSpeakerOutput(O),F=new Ti.SpeechSynthesizer(k,L);return p.current=F,F},[n,e]),b=W.useCallback((M,k,O,L)=>{if(!M.trim()){s("Please enter some text to synthesize");return}if(!k){s("Please select a multi-talker voice");return}if(L.length===0){s("No speakers found in voice name");return}const F=MO(M,k,O,L);u(F),console.log("Generated SSML:",F),r("synthesizing"),s(""),g.current=[],C.current=!1;const H=w(k);H.synthesizing=(V,ie)=>{ie.result.audioData&&(g.current.push(new Uint8Array(ie.result.audioData)),!C.current&&g.current.length===1&&(console.log("First audio chunk received - starting playback"),m.current=Date.now(),C.current=!0,r("playing")))},H.synthesisStarted=()=>{r("synthesizing"),console.log("Multi-talker synthesis started")},H.synthesisCompleted=(V,ie)=>{const J=g.current.reduce((oe,B)=>oe+B.length,0),ee=new Uint8Array(J);let se=0;for(const oe of g.current)ee.set(oe,se),se+=oe.length;a(ee.buffer),console.log("Multi-talker synthesis completed - audio size:",J,"bytes");const ne=J*8/48e3*1e3,Q=Date.now()-m.current,K=Math.max(100,ne-Q+300);console.log(`Estimated audio duration: ${ne}ms, will stop in: ${K}ms`),C.current||(m.current=Date.now(),C.current=!0,r("playing")),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{console.log("Audio playback ended"),C.current=!1,r("idle"),S.current=null},K)},H.SynthesisCanceled=(V,ie)=>{console.error("Multi-talker synthesis canceled:",ie.errorDetails),s(ie.errorDetails||"Synthesis was canceled"),r("error"),C.current=!1},H.speakSsmlAsync(F,V=>{V.reason===Ti.ResultReason.SynthesizingAudioCompleted?console.log("Multi-talker synthesis completed successfully"):(console.error("Multi-talker synthesis failed:",V.errorDetails),s(V.errorDetails||"Synthesis failed"),r("error"))},V=>{console.error("Multi-talker synthesis error:",V),s(V),r("error")})},[w]),R=W.useCallback(()=>{f.current&&t==="playing"&&(f.current.pause(),r("paused"),C.current=!1)},[t]),P=W.useCallback(()=>{f.current&&t==="paused"&&(f.current.resume(),r("playing"),C.current=!0)},[t]),I=W.useCallback(()=>{console.log("Stop called - cleaning up"),C.current=!1,S.current&&(clearTimeout(S.current),S.current=null),f.current&&f.current.pause(),p.current&&(p.current.close(),p.current=null),r("idle")},[]);return{state:t,error:i,audioData:o,generatedSSML:l,synthesize:b,pause:R,resume:P,stop:I}}function I5({apiKey:n,region:e,selectedVoice:t,onVoiceChange:r}){const[i,s]=W.useState([]),[o,a]=W.useState(!1),[l,u]=W.useState(""),[p,f]=W.useState("");W.useEffect(()=>{n&&e&&(a(!0),u(""),PO(n,e).then(C=>{s(C),a(!1)}).catch(C=>{console.error("Failed to fetch voices:",C),u("Failed to load voices from Azure."),s([]),a(!1)}))},[n,e]);const g=W.useMemo(()=>i.filter(C=>C.name.toLowerCase().includes("multitalker")).map(C=>T5(C)).filter(C=>C!==null),[i]),m=W.useMemo(()=>{if(!p)return g;const C=p.toLowerCase().trim();return g.filter(S=>S.displayName.toLowerCase().includes(C)||S.name.toLowerCase().includes(C)||S.speakers.some(w=>w.toLowerCase().includes(C))||S.locale.toLowerCase().includes(C))},[g,p]);return W.useEffect(()=>{!t&&m.length>0&&r(m[0])},[m,t,r]),A.jsxs("div",{className:"h-full flex flex-col space-y-2",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Multi-Talker Voice"}),l&&A.jsx("div",{className:"text-sm text-yellow-600 bg-yellow-50 p-2 rounded",children:l}),A.jsx("input",{type:"text",placeholder:"Search voices...",value:p,onChange:C=>f(C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),t&&A.jsxs("div",{className:"p-2 bg-purple-50 border border-purple-200 rounded-md flex-shrink-0",children:[A.jsx("div",{className:"text-xs text-purple-600 font-medium",children:"Selected:"}),A.jsx("div",{className:"text-sm text-purple-800 truncate",children:t.displayName}),A.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:["Speakers: ",t.speakers.join(", ")]})]}),A.jsxs("div",{className:"flex-1 overflow-y-auto border border-gray-200 rounded-md min-h-0",children:[o&&A.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"Loading voices..."}),!o&&m.length===0&&A.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:g.length===0?"No multi-talker voices available in this region":"No voices found"}),!o&&m.map(C=>A.jsxs("button",{onClick:()=>r(C),className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${(t==null?void 0:t.name)===C.name?"bg-purple-50 border-l-4 border-l-purple-600":"hover:bg-gray-50"}`,children:[A.jsx("div",{className:"font-medium text-gray-800 text-sm",children:C.displayName}),A.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[A.jsx("span",{className:"inline-block px-1.5 py-0.5 bg-purple-100 text-purple-700 rounded mr-2",children:C.locale}),C.speakers.map((S,w)=>A.jsx("span",{className:"inline-block px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded mr-1",children:S},S))]})]},C.name))]}),A.jsxs("div",{className:"text-xs text-gray-500 flex-shrink-0 pt-2",children:[m.length," multi-talker voice",m.length!==1?"s":""," available"]})]})}const tE=[{locale:"zh-CN",language:"Chinese (Simplified)",speakers:["xiaochen","yunhan"],script:`xiaochen: !,
yunhan: !?
xiaochen: ,
yunhan: !?
xiaochen: ,
yunhan: ,?
xiaochen: !
yunhan: !!
xiaochen: !!
yunhan: !`},{locale:"en-US",language:"English (US)",speakers:["speaker1","speaker2"],script:`speaker1: Welcome to Tech Talk! I'm your host, and today we're diving into artificial intelligence.
speaker2: Thanks for having me! AI is such a fascinating topic these days.
speaker1: Absolutely! Can you explain what makes modern AI so powerful?
speaker2: Of course! The key is deep learning, which allows computers to learn patterns from massive amounts of data.
speaker1: That sounds incredible. What are some practical applications?
speaker2: We see AI everywhere now - voice assistants, recommendation systems, autonomous vehicles, and more.
speaker1: Amazing! What do you think the future holds for AI?
speaker2: I believe we'll see even more integration into daily life, making technology more intuitive and helpful.
speaker1: Thank you for sharing your insights!
speaker2: My pleasure! Thanks for having me on the show.`},{locale:"ja-JP",language:"Japanese",speakers:["speaker1","speaker2"],script:`speaker1: !
speaker2: !AI
speaker1: !AI?
speaker2: !
speaker1: ?
speaker2: AI
speaker1: !AI?
speaker2: 
speaker1: !
speaker2: `},{locale:"de-DE",language:"German",speakers:["speaker1","speaker2"],script:`speaker1: Willkommen bei Tech Talk! Heute sprechen wir ber knstliche Intelligenz.
speaker2: Danke fr die Einladung! KI ist wirklich ein faszinierendes Thema.
speaker1: Absolut! Knnen Sie erklren, was moderne KI so leistungsfhig macht?
speaker2: Natrlich! Der Schlssel ist Deep Learning, das es Computern ermglicht, Muster aus riesigen Datenmengen zu lernen.
speaker1: Das klingt unglaublich. Welche praktischen Anwendungen gibt es?
speaker2: Wir sehen KI berall - Sprachassistenten, Empfehlungssysteme, autonome Fahrzeuge und mehr.
speaker1: Erstaunlich! Was denken Sie, wie die Zukunft der KI aussieht?
speaker2: Ich glaube, wir werden noch mehr Integration in den Alltag sehen.
speaker1: Vielen Dank fr Ihre Einblicke!
speaker2: Gern geschehen! Danke fr die Einladung zur Sendung.`},{locale:"fr-FR",language:"French",speakers:["speaker1","speaker2"],script:`speaker1: Bienvenue sur Tech Talk! Aujourd'hui, nous parlons d'intelligence artificielle.
speaker2: Merci de m'avoir invit! L'IA est un sujet vraiment fascinant.
speaker1: Absolument! Pouvez-vous expliquer ce qui rend l'IA moderne si puissante?
speaker2: Bien sr! La cl est l'apprentissage profond, qui permet aux ordinateurs d'apprendre des modles  partir de grandes quantits de donnes.
speaker1: C'est incroyable. Quelles sont les applications pratiques?
speaker2: L'IA est partout maintenant - assistants vocaux, systmes de recommandation, vhicules autonomes et plus encore.
speaker1: Incroyable! Que pensez-vous de l'avenir de l'IA?
speaker2: Je pense que nous verrons encore plus d'intgration dans la vie quotidienne.
speaker1: Merci pour vos perspectives!
speaker2: Avec plaisir! Merci de m'avoir reu dans l'mission.`},{locale:"es-ES",language:"Spanish",speakers:["speaker1","speaker2"],script:`speaker1: Bienvenidos a Tech Talk! Hoy hablamos sobre inteligencia artificial.
speaker2: Gracias por invitarme! La IA es un tema realmente fascinante.
speaker1: Absolutamente! Puede explicar qu hace que la IA moderna sea tan poderosa?
speaker2: Por supuesto! La clave es el aprendizaje profundo, que permite a las computadoras aprender patrones de grandes cantidades de datos.
speaker1: Eso suena increble. Cules son las aplicaciones prcticas?
speaker2: La IA est en todas partes ahora: asistentes de voz, sistemas de recomendacin, vehculos autnomos y ms.
speaker1: Increble! Qu piensa sobre el futuro de la IA?
speaker2: Creo que veremos an ms integracin en la vida diaria.
speaker1: Gracias por compartir sus conocimientos!
speaker2: Con mucho gusto! Gracias por invitarme al programa.`},{locale:"pt-BR",language:"Portuguese (Brazil)",speakers:["speaker1","speaker2"],script:`speaker1: Bem-vindos ao Tech Talk! Hoje vamos falar sobre inteligncia artificial.
speaker2: Obrigado pelo convite! IA  um tema realmente fascinante.
speaker1: Com certeza! Voc pode explicar o que torna a IA moderna to poderosa?
speaker2: Claro! A chave  o aprendizado profundo, que permite aos computadores aprender padres de grandes quantidades de dados.
speaker1: Isso parece incrvel. Quais so as aplicaes prticas?
speaker2: A IA est em toda parte agora - assistentes de voz, sistemas de recomendao, veculos autnomos e muito mais.
speaker1: Incrvel! O que voc acha sobre o futuro da IA?
speaker2: Acredito que veremos ainda mais integrao na vida cotidiana.
speaker1: Obrigado por compartilhar seus conhecimentos!
speaker2: Foi um prazer! Obrigado por me receber no programa.`},{locale:"it-IT",language:"Italian",speakers:["speaker1","speaker2"],script:`speaker1: Benvenuti a Tech Talk! Oggi parliamo di intelligenza artificiale.
speaker2: Grazie per l'invito! L'IA  un argomento davvero affascinante.
speaker1: Assolutamente! Pu spiegare cosa rende l'IA moderna cos potente?
speaker2: Certo! La chiave  il deep learning, che permette ai computer di imparare modelli da grandi quantit di dati.
speaker1: Sembra incredibile. Quali sono le applicazioni pratiche?
speaker2: L'IA  ovunque ora - assistenti vocali, sistemi di raccomandazione, veicoli autonomi e altro ancora.
speaker1: Fantastico! Cosa pensa del futuro dell'IA?
speaker2: Credo che vedremo ancora pi integrazione nella vita quotidiana.
speaker1: Grazie per aver condiviso le sue intuizioni!
speaker2:  stato un piacere! Grazie per avermi invitato al programma.`},{locale:"ko-KR",language:"Korean",speakers:["speaker1","speaker2"],script:`speaker1:     !     .
speaker2:   ! AI   .
speaker1: !  AI     ?
speaker2: !  .         .
speaker1:  .      ?
speaker2: AI   .  ,  ,    .
speaker1: ! AI    ?
speaker2:         .
speaker1:    !
speaker2:  !    .`}];function cD(n,e){let t=n.script;return n.speakers.forEach((r,i)=>{if(i<e.length){const s=new RegExp(`^${r}:`,"gmi");t=t.replace(s,`${e[i]}:`)}}),t}var _5={34:((n,e,t)=>{var r=t(4901);n.exports=function(i){return typeof i=="object"?i!==null:r(i)}}),81:((n,e,t)=>{var r=t(9565),i=t(9306),s=t(8551),o=t(6823),a=t(851),l=TypeError;n.exports=function(u,p){var f=arguments.length<2?a(u):p;if(i(f))return s(r(f,u));throw new l(o(u)+" is not iterable")}}),116:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),u=t(9539),p=t(4549),f=p("find",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:f},{find:function(m){a(this);try{o(m)}catch(w){u(this,"throw",w)}if(f)return i(f,this,m);var C=l(this),S=0;return s(C,function(w,b){if(m(w,S++))return b(w)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})}),283:((n,e,t)=>{var r=t(9504),i=t(9039),s=t(4901),o=t(9297),a=t(3724),l=t(350).CONFIGURABLE,u=t(3706),p=t(1181),f=p.enforce,g=p.get,m=String,C=Object.defineProperty,S=r("".slice),w=r("".replace),b=r([].join),R=a&&!i(function(){return C(function(){},"length",{value:8}).length!==8}),P=String(String).split("String"),I=n.exports=function(M,k,O){S(m(k),0,7)==="Symbol("&&(k="["+w(m(k),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),O&&O.getter&&(k="get "+k),O&&O.setter&&(k="set "+k),(!o(M,"name")||l&&M.name!==k)&&(a?C(M,"name",{value:k,configurable:!0}):M.name=k),R&&O&&o(O,"arity")&&M.length!==O.arity&&C(M,"length",{value:O.arity});try{O&&o(O,"constructor")&&O.constructor?a&&C(M,"prototype",{writable:!1}):M.prototype&&(M.prototype=void 0)}catch{}var L=f(M);return o(L,"source")||(L.source=b(P,typeof k=="string"?k:"")),M};Function.prototype.toString=I(function(){return s(this)&&g(this).source||u(this)},"toString")}),350:((n,e,t)=>{var r=t(3724),i=t(9297),s=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,a=i(s,"name"),l=a&&(function(){}).name==="something",u=a&&(!r||r&&o(s,"name").configurable);n.exports={EXISTS:a,PROPER:l,CONFIGURABLE:u}}),397:((n,e,t)=>{var r=t(7751);n.exports=r("document","documentElement")}),421:(n=>{n.exports={}}),456:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(9504),o=t(4154),a=t(5169),l=s(1.1.toString),u=i.Uint8Array,p=!u||!u.prototype.toHex||!(function(){try{var f=new u([255,255,255,255,255,255,255,255]);return f.toHex()==="ffffffffffffffff"}catch{return!1}})();u&&r({target:"Uint8Array",proto:!0,forced:p},{toHex:function(){o(this),a(this.buffer);for(var g="",m=0,C=this.length;m<C;m++){var S=l(this[m],16);g+=S.length===1?"0"+S:S}return g}})}),507:((n,e,t)=>{var r=t(9565);n.exports=function(i,s,o){for(var a=o?i:i.iterator,l=i.next,u,p;!(u=r(l,a)).done;)if(p=s(u.value),p!==void 0)return p}}),531:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(9306),o=t(8551),a=t(1767),l=t(8646),u=t(9462),p=t(9539),f=t(6395),g=t(684),m=t(4549),C=!f&&!g("flatMap",function(){}),S=!f&&!C&&m("flatMap",TypeError),w=f||C||S,b=u(function(){for(var R=this.iterator,P=this.mapper,I,M;;){if(M=this.inner)try{if(I=o(i(M.next,M.iterator)),!I.done)return I.value;this.inner=null}catch(k){p(R,"throw",k)}if(I=o(i(this.next,R)),this.done=!!I.done)return;try{this.inner=l(P(I.value,this.counter++),!1)}catch(k){p(R,"throw",k)}}});r({target:"Iterator",proto:!0,real:!0,forced:w},{flatMap:function(P){o(this);try{s(P)}catch(I){p(this,"throw",I)}return S?i(S,this,P):new b(a(this),{mapper:P,inner:null})}})}),616:((n,e,t)=>{var r=t(9039);n.exports=!r(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")})}),655:((n,e,t)=>{var r=t(6955),i=String;n.exports=function(s){if(r(s)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return i(s)}}),679:((n,e,t)=>{var r=t(1625),i=TypeError;n.exports=function(s,o){if(r(o,s))return s;throw new i("Incorrect invocation")}}),684:(n=>{n.exports=function(e,t){var r=typeof Iterator=="function"&&Iterator.prototype[e];if(r)try{r.call({next:null},t).next()}catch{return!0}}}),741:(n=>{var e=Math.ceil,t=Math.floor;n.exports=Math.trunc||function(i){var s=+i;return(s>0?t:e)(s)}}),757:((n,e,t)=>{var r=t(7751),i=t(4901),s=t(1625),o=t(7040),a=Object;n.exports=o?function(l){return typeof l=="symbol"}:function(l){var u=r("Symbol");return i(u)&&s(u.prototype,a(l))}}),851:((n,e,t)=>{var r=t(6955),i=t(5966),s=t(4117),o=t(6269),a=t(8227),l=a("iterator");n.exports=function(u){if(!s(u))return i(u,l)||i(u,"@@iterator")||o[r(u)]}}),944:(n=>{var e=TypeError;n.exports=function(t){var r=t&&t.alphabet;if(r===void 0||r==="base64"||r==="base64url")return r||"base64";throw new e("Incorrect `alphabet` option")}}),1072:((n,e,t)=>{var r=t(1828),i=t(8727);n.exports=Object.keys||function(o){return r(o,i)}}),1103:(n=>{n.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}}),1108:((n,e,t)=>{var r=t(6955);n.exports=function(i){var s=r(i);return s==="BigInt64Array"||s==="BigUint64Array"}}),1148:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),u=t(9539),p=t(4549),f=p("every",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:f},{every:function(m){a(this);try{o(m)}catch(w){u(this,"throw",w)}if(f)return i(f,this,m);var C=l(this),S=0;return!s(C,function(w,b){if(!m(w,S++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),1181:((n,e,t)=>{var r=t(8622),i=t(4576),s=t(34),o=t(6699),a=t(9297),l=t(7629),u=t(6119),p=t(421),f="Object already initialized",g=i.TypeError,m=i.WeakMap,C,S,w,b=function(M){return w(M)?S(M):C(M,{})},R=function(M){return function(k){var O;if(!s(k)||(O=S(k)).type!==M)throw new g("Incompatible receiver, "+M+" required");return O}};if(r||l.state){var P=l.state||(l.state=new m);P.get=P.get,P.has=P.has,P.set=P.set,C=function(M,k){if(P.has(M))throw new g(f);return k.facade=M,P.set(M,k),k},S=function(M){return P.get(M)||{}},w=function(M){return P.has(M)}}else{var I=u("state");p[I]=!0,C=function(M,k){if(a(M,I))throw new g(f);return k.facade=M,o(M,I,k),k},S=function(M){return a(M,I)?M[I]:{}},w=function(M){return a(M,I)}}n.exports={set:C,get:S,has:w,enforce:b,getterFor:R}}),1291:((n,e,t)=>{var r=t(741);n.exports=function(i){var s=+i;return s!==s||s===0?0:r(s)}}),1385:((n,e,t)=>{var r=t(9539);n.exports=function(i,s,o){for(var a=i.length-1;a>=0;a--)if(i[a]!==void 0)try{o=r(i[a].iterator,s,o)}catch(l){s="throw",o=l}if(s==="throw")throw o;return o}}),1548:((n,e,t)=>{var r=t(4576),i=t(9039),s=t(9519),o=t(4215),a=r.structuredClone;n.exports=!!a&&!i(function(){if(o==="DENO"&&s>92||o==="NODE"&&s>94||o==="BROWSER"&&s>97)return!1;var l=new ArrayBuffer(8),u=a(l,{transfer:[l]});return l.byteLength!==0||u.byteLength!==8})}),1549:((n,e,t)=>{t(6632)}),1625:((n,e,t)=>{var r=t(9504);n.exports=r({}.isPrototypeOf)}),1689:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(8745),o=t(7680),a=t(6043),l=t(9306),u=t(1103),p=i.Promise,f=!1,g=!p||!p.try||u(function(){p.try(function(m){f=m===8},8)}).error||!f;r({target:"Promise",stat:!0,forced:g},{try:function(m){var C=arguments.length>1?o(arguments,1):[],S=a.f(this),w=u(function(){return s(l(m),void 0,C)});return(w.error?S.reject:S.resolve)(w.value),S.promise}})}),1698:((n,e,t)=>{var r=t(6518),i=t(4204),s=t(9835),o=t(4916),a=!o("union")||!s("union");r({target:"Set",proto:!0,real:!0,forced:a},{union:i})}),1701:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(9306),o=t(8551),a=t(1767),l=t(9462),u=t(6319),p=t(9539),f=t(684),g=t(4549),m=t(6395),C=!m&&!f("map",function(){}),S=!m&&!C&&g("map",TypeError),w=m||C||S,b=l(function(){var R=this.iterator,P=o(i(this.next,R)),I=this.done=!!P.done;if(!I)return u(R,this.mapper,[P.value,this.counter++],!0)});r({target:"Iterator",proto:!0,real:!0,forced:w},{map:function(P){o(this);try{s(P)}catch(I){p(this,"throw",I)}return S?i(S,this,P):new b(a(this),{mapper:P})}})}),1767:(n=>{n.exports=function(e){return{iterator:e,next:e.next,done:!1}}}),1828:((n,e,t)=>{var r=t(9504),i=t(9297),s=t(5397),o=t(9617).indexOf,a=t(421),l=r([].push);n.exports=function(u,p){var f=s(u),g=0,m=[],C;for(C in f)!i(a,C)&&i(f,C)&&l(m,C);for(;p.length>g;)i(f,C=p[g++])&&(~o(m,C)||l(m,C));return m}}),2106:((n,e,t)=>{var r=t(283),i=t(4913);n.exports=function(s,o,a){return a.get&&r(a.get,o,{getter:!0}),a.set&&r(a.set,o,{setter:!0}),i.f(s,o,a)}}),2140:((n,e,t)=>{var r=t(8227),i=r("toStringTag"),s={};s[i]="z",n.exports=String(s)==="[object z]"}),2195:((n,e,t)=>{var r=t(9504),i=r({}.toString),s=r("".slice);n.exports=function(o){return s(i(o),8,-1)}}),2211:((n,e,t)=>{var r=t(9039);n.exports=!r(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})}),2303:((n,e,t)=>{var r=t(4576),i=t(9504),s=r.Uint8Array,o=r.SyntaxError,a=r.parseInt,l=Math.min,u=/[^\da-f]/i,p=i(u.exec),f=i("".slice);n.exports=function(g,m){var C=g.length;if(C%2!==0)throw new o("String should be an even number of characters");for(var S=m?l(m.length,C/2):C/2,w=m||new s(S),b=0,R=0;R<S;){var P=f(g,b,b+=2);if(p(u,P))throw new o("String should only contain hex characters");w[R++]=a(P,16)}return{bytes:w,read:b}}}),2360:((n,e,t)=>{var r=t(8551),i=t(6801),s=t(8727),o=t(421),a=t(397),l=t(4055),u=t(6119),p=">",f="<",g="prototype",m="script",C=u("IE_PROTO"),S=function(){},w=function(M){return f+m+p+M+f+"/"+m+p},b=function(M){M.write(w("")),M.close();var k=M.parentWindow.Object;return M=null,k},R=function(){var M=l("iframe"),k="java"+m+":",O;return M.style.display="none",a.appendChild(M),M.src=String(k),O=M.contentWindow.document,O.open(),O.write(w("document.F=Object")),O.close(),O.F},P,I=function(){try{P=new ActiveXObject("htmlfile")}catch{}I=typeof document<"u"?document.domain&&P?b(P):R():b(P);for(var M=s.length;M--;)delete I[g][s[M]];return I()};o[C]=!0,n.exports=Object.create||function(k,O){var L;return k!==null?(S[g]=r(k),L=new S,S[g]=null,L[C]=k):L=I(),O===void 0?L:i.f(L,O)}}),2475:((n,e,t)=>{var r=t(6518),i=t(8527),s=t(4916),o=!s("isSupersetOf",function(a){return!a});r({target:"Set",proto:!0,real:!0,forced:o},{isSupersetOf:i})}),2489:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(9306),o=t(8551),a=t(1767),l=t(9462),u=t(6319),p=t(6395),f=t(9539),g=t(684),m=t(4549),C=!p&&!g("filter",function(){}),S=!p&&!C&&m("filter",TypeError),w=p||C||S,b=l(function(){for(var R=this.iterator,P=this.predicate,I=this.next,M,k,O;;){if(M=o(i(I,R)),k=this.done=!!M.done,k)return;if(O=M.value,u(R,P,[O,this.counter++],!0))return O}});r({target:"Iterator",proto:!0,real:!0,forced:w},{filter:function(P){o(this);try{s(P)}catch(I){f(this,"throw",I)}return S?i(S,this,P):new b(a(this),{predicate:P})}})}),2529:(n=>{n.exports=function(e,t){return{value:e,done:t}}}),2603:((n,e,t)=>{var r=t(655);n.exports=function(i,s){return i===void 0?arguments.length<2?"":s:r(i)}}),2652:((n,e,t)=>{var r=t(6080),i=t(9565),s=t(8551),o=t(6823),a=t(4209),l=t(6198),u=t(1625),p=t(81),f=t(851),g=t(9539),m=TypeError,C=function(w,b){this.stopped=w,this.result=b},S=C.prototype;n.exports=function(w,b,R){var P=R&&R.that,I=!!(R&&R.AS_ENTRIES),M=!!(R&&R.IS_RECORD),k=!!(R&&R.IS_ITERATOR),O=!!(R&&R.INTERRUPTED),L=r(b,P),F,H,V,ie,J,ee,se,ne=function(K){return F&&g(F,"normal"),new C(!0,K)},Q=function(K){return I?(s(K),O?L(K[0],K[1],ne):L(K[0],K[1])):O?L(K,ne):L(K)};if(M)F=w.iterator;else if(k)F=w;else{if(H=f(w),!H)throw new m(o(w)+" is not iterable");if(a(H)){for(V=0,ie=l(w);ie>V;V++)if(J=Q(w[V]),J&&u(S,J))return J;return new C(!1)}F=p(w,H)}for(ee=M?w.next:F.next;!(se=i(ee,F)).done;){try{J=Q(se.value)}catch(K){g(F,"throw",K)}if(typeof J=="object"&&J&&u(S,J))return J}return new C(!1)}}),2777:((n,e,t)=>{var r=t(9565),i=t(34),s=t(757),o=t(5966),a=t(4270),l=t(8227),u=TypeError,p=l("toPrimitive");n.exports=function(f,g){if(!i(f)||s(f))return f;var m=o(f,p),C;if(m){if(g===void 0&&(g="default"),C=r(m,f,g),!i(C)||s(C))return C;throw new u("Can't convert object to primitive value")}return g===void 0&&(g="number"),a(f,g)}}),2787:((n,e,t)=>{var r=t(9297),i=t(4901),s=t(8981),o=t(6119),a=t(2211),l=o("IE_PROTO"),u=Object,p=u.prototype;n.exports=a?u.getPrototypeOf:function(f){var g=s(f);if(r(g,l))return g[l];var m=g.constructor;return i(m)&&g instanceof m?m.prototype:g instanceof u?p:null}}),2796:((n,e,t)=>{var r=t(9039),i=t(4901),s=/#|\.prototype\./,o=function(f,g){var m=l[a(f)];return m===p?!0:m===u?!1:i(g)?r(g):!!g},a=o.normalize=function(f){return String(f).replace(s,".").toLowerCase()},l=o.data={},u=o.NATIVE="N",p=o.POLYFILL="P";n.exports=o}),2804:(n=>{var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=e+"+/",r=e+"-_",i=function(s){for(var o={},a=0;a<64;a++)o[s.charAt(a)]=a;return o};n.exports={i2c:t,c2i:i(t),i2cUrl:r,c2iUrl:i(r)}}),2812:(n=>{var e=TypeError;n.exports=function(t,r){if(t<r)throw new e("Not enough arguments");return t}}),2839:((n,e,t)=>{var r=t(4576),i=r.navigator,s=i&&i.userAgent;n.exports=s?String(s):""}),2967:((n,e,t)=>{var r=t(6706),i=t(34),s=t(7750),o=t(3506);n.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var a=!1,l={},u;try{u=r(Object.prototype,"__proto__","set"),u(l,[]),a=l instanceof Array}catch{}return function(f,g){return s(f),o(g),i(f)&&(a?u(f,g):f.__proto__=g),f}})():void 0)}),3068:((n,e,t)=>{var r=t(6518),i=t(9504),s=t(2652),o=RangeError,a=TypeError,l=1/0,u=NaN,p=Math.abs,f=Math.pow,g=i([].push),m=f(2,1023),C=f(2,53)-1,S=Number.MAX_VALUE,w=f(2,971),b={},R={},P={},I={},M={},k=function(O,L){var F=O+L,H=L-(F-O);return{hi:F,lo:H}};r({target:"Math",stat:!0},{sumPrecise:function(L){var F=[],H=0,V=I;switch(s(L,function(re){if(++H>=C)throw new o("Maximum allowed index exceeded");if(typeof re!="number")throw new a("Value is not a number");V!==b&&(re!==re?V=b:re===l?V=V===R?b:P:re===-l?V=V===P?b:R:(re!==0||1/re===l)&&(V===I||V===M)&&(V=M,g(F,re)))}),V){case b:return u;case R:return-l;case P:return l;case I:return-0}for(var ie=[],J=0,ee,se,ne,Q,K,oe,B=0;B<F.length;B++){ee=F[B];for(var j=0,$=0;$<ie.length;$++){if(se=ie[$],p(ee)<p(se)&&(oe=ee,ee=se,se=oe),ne=k(ee,se),Q=ne.hi,K=ne.lo,p(Q)===l){var pe=Q===l?1:-1;J+=pe,ee=ee-pe*m-pe*m,p(ee)<p(se)&&(oe=ee,ee=se,se=oe),ne=k(ee,se),Q=ne.hi,K=ne.lo}K!==0&&(ie[j++]=K),ee=Q}ie.length=j,ee!==0&&g(ie,ee)}var ge=ie.length-1;if(Q=0,K=0,J!==0){var ye=ge>=0?ie[ge]:0;if(ge--,p(J)>1||J>0&&ye>0||J<0&&ye<0)return J>0?l:-l;if(ne=k(J*m,ye/2),Q=ne.hi,K=ne.lo,K*=2,p(2*Q)===l)return Q>0?Q===m&&K===-(w/2)&&ge>=0&&ie[ge]<0?S:l:Q===-m&&K===w/2&&ge>=0&&ie[ge]>0?-S:-l;K!==0&&(ie[++ge]=K,K=0),Q*=2}for(;ge>=0&&(ne=k(Q,ie[ge--]),Q=ne.hi,K=ne.lo,K===0););return ge>=0&&(K<0&&ie[ge]<0||K>0&&ie[ge]>0)&&(se=K*2,ee=Q+se,se===ee-Q&&(Q=ee)),Q}})}),3167:((n,e,t)=>{var r=t(4901),i=t(34),s=t(2967);n.exports=function(o,a,l){var u,p;return s&&r(u=a.constructor)&&u!==l&&i(p=u.prototype)&&p!==l.prototype&&s(o,p),o}}),3238:((n,e,t)=>{var r=t(4576),i=t(7811),s=t(7394),o=r.DataView;n.exports=function(a){if(!i||s(a)!==0)return!1;try{return new o(a),!1}catch{return!0}}}),3392:((n,e,t)=>{var r=t(9504),i=0,s=Math.random(),o=r(1.1.toString);n.exports=function(a){return"Symbol("+(a===void 0?"":a)+")_"+o(++i+s,36)}}),3440:((n,e,t)=>{var r=t(7080),i=t(4402),s=t(9286),o=t(5170),a=t(3789),l=t(8469),u=t(507),p=i.has,f=i.remove;n.exports=function(m){var C=r(this),S=a(m),w=s(C);return o(C)<=S.size?l(C,function(b){S.includes(b)&&f(w,b)}):u(S.getIterator(),function(b){p(w,b)&&f(w,b)}),w}}),3463:(n=>{var e=TypeError;n.exports=function(t){if(typeof t=="string")return t;throw new e("Argument is not a string")}}),3506:((n,e,t)=>{var r=t(3925),i=String,s=TypeError;n.exports=function(o){if(r(o))return o;throw new s("Can't set "+i(o)+" as a prototype")}}),3579:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),u=t(9539),p=t(4549),f=p("some",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:f},{some:function(m){a(this);try{o(m)}catch(w){u(this,"throw",w)}if(f)return i(f,this,m);var C=l(this),S=0;return s(C,function(w,b){if(m(w,S++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),3650:((n,e,t)=>{var r=t(7080),i=t(4402),s=t(9286),o=t(3789),a=t(507),l=i.add,u=i.has,p=i.remove;n.exports=function(g){var m=r(this),C=o(g).getIterator(),S=s(m);return a(C,function(w){u(m,w)?p(S,w):l(S,w)}),S}}),3706:((n,e,t)=>{var r=t(9504),i=t(4901),s=t(7629),o=r(Function.toString);i(s.inspectSource)||(s.inspectSource=function(a){return o(a)}),n.exports=s.inspectSource}),3717:((n,e)=>{e.f=Object.getOwnPropertySymbols}),3724:((n,e,t)=>{var r=t(9039);n.exports=!r(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})}),3789:((n,e,t)=>{var r=t(9306),i=t(8551),s=t(9565),o=t(1291),a=t(1767),l="Invalid size",u=RangeError,p=TypeError,f=Math.max,g=function(m,C){this.set=m,this.size=f(C,0),this.has=r(m.has),this.keys=r(m.keys)};g.prototype={getIterator:function(){return a(i(s(this.keys,this.set)))},includes:function(m){return s(this.has,this.set,m)}},n.exports=function(m){i(m);var C=+m.size;if(C!==C)throw new p(l);var S=o(C);if(S<0)throw new u(l);return new g(m,S)}}),3838:((n,e,t)=>{var r=t(7080),i=t(5170),s=t(8469),o=t(3789);n.exports=function(l){var u=r(this),p=o(l);return i(u)>p.size?!1:s(u,function(f){if(!p.includes(f))return!1},!0)!==!1}}),3853:((n,e,t)=>{var r=t(6518),i=t(4449),s=t(4916),o=!s("isDisjointFrom",function(a){return!a});r({target:"Set",proto:!0,real:!0,forced:o},{isDisjointFrom:i})}),3925:((n,e,t)=>{var r=t(34);n.exports=function(i){return r(i)||i===null}}),3972:((n,e,t)=>{var r=t(34),i=String,s=TypeError;n.exports=function(o){if(o===void 0||r(o))return o;throw new s(i(o)+" is not an object or undefined")}}),4055:((n,e,t)=>{var r=t(4576),i=t(34),s=r.document,o=i(s)&&i(s.createElement);n.exports=function(a){return o?s.createElement(a):{}}}),4114:((n,e,t)=>{var r=t(6518),i=t(8981),s=t(6198),o=t(4527),a=t(6837),l=t(9039),u=l(function(){return[].push.call({length:4294967296},1)!==4294967297}),p=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(g){return g instanceof TypeError}},f=u||!p();r({target:"Array",proto:!0,arity:1,forced:f},{push:function(m){var C=i(this),S=s(C),w=arguments.length;a(S+w);for(var b=0;b<w;b++)C[S]=arguments[b],S++;return o(C,S),S}})}),4117:(n=>{n.exports=function(e){return e==null}}),4149:(n=>{var e=RangeError;n.exports=function(t){if(t===t)return t;throw new e("NaN is not allowed")}}),4154:((n,e,t)=>{var r=t(6955),i=TypeError;n.exports=function(s){if(r(s)==="Uint8Array")return s;throw new i("Argument is not an Uint8Array")}}),4204:((n,e,t)=>{var r=t(7080),i=t(4402).add,s=t(9286),o=t(3789),a=t(507);n.exports=function(u){var p=r(this),f=o(u).getIterator(),g=s(p);return a(f,function(m){i(g,m)}),g}}),4209:((n,e,t)=>{var r=t(8227),i=t(6269),s=r("iterator"),o=Array.prototype;n.exports=function(a){return a!==void 0&&(i.Array===a||o[s]===a)}}),4215:((n,e,t)=>{var r=t(4576),i=t(2839),s=t(2195),o=function(a){return i.slice(0,a.length)===a};n.exports=(function(){return o("Bun/")?"BUN":o("Cloudflare-Workers")?"CLOUDFLARE":o("Deno/")?"DENO":o("Node.js/")?"NODE":r.Bun&&typeof Bun.version=="string"?"BUN":r.Deno&&typeof Deno.version=="object"?"DENO":s(r.process)==="process"?"NODE":r.window&&r.document?"BROWSER":"REST"})()}),4226:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(3463),o=t(4154),a=t(5169),l=t(2303);i.Uint8Array&&r({target:"Uint8Array",proto:!0},{setFromHex:function(p){o(this),s(p),a(this.buffer);var f=l(p,this).read;return{read:f,written:f/2}}})}),4235:((n,e,t)=>{t(3068)}),4270:((n,e,t)=>{var r=t(9565),i=t(4901),s=t(34),o=TypeError;n.exports=function(a,l){var u,p;if(l==="string"&&i(u=a.toString)&&!s(p=r(u,a))||i(u=a.valueOf)&&!s(p=r(u,a))||l!=="string"&&i(u=a.toString)&&!s(p=r(u,a)))return p;throw new o("Can't convert object to primitive value")}}),4376:((n,e,t)=>{var r=t(2195);n.exports=Array.isArray||function(s){return r(s)==="Array"}}),4402:((n,e,t)=>{var r=t(9504),i=Set.prototype;n.exports={Set,add:r(i.add),has:r(i.has),remove:r(i.delete),proto:i}}),4449:((n,e,t)=>{var r=t(7080),i=t(4402).has,s=t(5170),o=t(3789),a=t(8469),l=t(507),u=t(9539);n.exports=function(f){var g=r(this),m=o(f);if(s(g)<=m.size)return a(g,function(S){if(m.includes(S))return!1},!0)!==!1;var C=m.getIterator();return l(C,function(S){if(i(g,S))return u(C,"normal",!1)})!==!1}}),4483:((n,e,t)=>{var r=t(4576),i=t(9429),s=t(1548),o=r.structuredClone,a=r.ArrayBuffer,l=r.MessageChannel,u=!1,p,f,g,m;if(s)u=function(C){o(C,{transfer:[C]})};else if(a)try{l||(p=i("worker_threads"),p&&(l=p.MessageChannel)),l&&(f=new l,g=new a(2),m=function(C){f.port1.postMessage(null,[C])},g.byteLength===2&&(m(g),g.byteLength===0&&(u=m)))}catch{}n.exports=u}),4495:((n,e,t)=>{var r=t(9519),i=t(9039),s=t(4576),o=s.String;n.exports=!!Object.getOwnPropertySymbols&&!i(function(){var a=Symbol("symbol detection");return!o(a)||!(Object(a)instanceof Symbol)||!Symbol.sham&&r&&r<41})}),4527:((n,e,t)=>{var r=t(3724),i=t(4376),s=TypeError,o=Object.getOwnPropertyDescriptor,a=r&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(l){return l instanceof TypeError}})();n.exports=a?function(l,u){if(i(l)&&!o(l,"length").writable)throw new s("Cannot set read only .length");return l.length=u}:function(l,u){return l.length=u}}),4549:((n,e,t)=>{var r=t(4576);n.exports=function(i,s){var o=r.Iterator,a=o&&o.prototype,l=a&&a[i],u=!1;if(l)try{l.call({next:function(){return{done:!0}},return:function(){u=!0}},-1)}catch(p){p instanceof s||(u=!1)}if(!u)return l}}),4576:(function(n){var e=function(t){return t&&t.Math===Math&&t};n.exports=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof global=="object"&&global)||e(typeof this=="object"&&this)||(function(){return this})()||Function("return this")()}),4603:((n,e,t)=>{var r=t(6840),i=t(9504),s=t(655),o=t(2812),a=URLSearchParams,l=a.prototype,u=i(l.append),p=i(l.delete),f=i(l.forEach),g=i([].push),m=new a("a=1&a=2&b=3");m.delete("a",1),m.delete("b",void 0),m+""!="a=2"&&r(l,"delete",function(C){var S=arguments.length,w=S<2?void 0:arguments[1];if(S&&w===void 0)return p(this,C);var b=[];f(this,function(F,H){g(b,{key:H,value:F})}),o(S,1);for(var R=s(C),P=s(w),I=0,M=0,k=!1,O=b.length,L;I<O;)L=b[I++],k||L.key===R?(k=!0,p(this,L.key)):M++;for(;M<O;)L=b[M++],L.key===R&&L.value===P||u(this,L.key,L.value)},{enumerable:!0,unsafe:!0})}),4628:((n,e,t)=>{var r=t(6518),i=t(6043);r({target:"Promise",stat:!0},{withResolvers:function(){var o=i.f(this);return{promise:o.promise,resolve:o.resolve,reject:o.reject}}})}),4644:((n,e,t)=>{var r=t(7811),i=t(3724),s=t(4576),o=t(4901),a=t(34),l=t(9297),u=t(6955),p=t(6823),f=t(6699),g=t(6840),m=t(2106),C=t(1625),S=t(2787),w=t(2967),b=t(8227),R=t(3392),P=t(1181),I=P.enforce,M=P.get,k=s.Int8Array,O=k&&k.prototype,L=s.Uint8ClampedArray,F=L&&L.prototype,H=k&&S(k),V=O&&S(O),ie=Object.prototype,J=s.TypeError,ee=b("toStringTag"),se=R("TYPED_ARRAY_TAG"),ne="TypedArrayConstructor",Q=r&&!!w&&u(s.opera)!=="Opera",K=!1,oe,B,j,$={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},pe={BigInt64Array:8,BigUint64Array:8},ge=function(Ke){if(!a(Ke))return!1;var he=u(Ke);return he==="DataView"||l($,he)||l(pe,he)},ye=function(Ce){var Ke=S(Ce);if(a(Ke)){var he=M(Ke);return he&&l(he,ne)?he[ne]:ye(Ke)}},re=function(Ce){if(!a(Ce))return!1;var Ke=u(Ce);return l($,Ke)||l(pe,Ke)},te=function(Ce){if(re(Ce))return Ce;throw new J("Target is not a typed array")},ae=function(Ce){if(o(Ce)&&(!w||C(H,Ce)))return Ce;throw new J(p(Ce)+" is not a typed array constructor")},ve=function(Ce,Ke,he,$e){if(i){if(he)for(var Ge in $){var Ve=s[Ge];if(Ve&&l(Ve.prototype,Ce))try{delete Ve.prototype[Ce]}catch{try{Ve.prototype[Ce]=Ke}catch{}}}(!V[Ce]||he)&&g(V,Ce,he?Ke:Q&&O[Ce]||Ke,$e)}},_e=function(Ce,Ke,he){var $e,Ge;if(i){if(w){if(he){for($e in $)if(Ge=s[$e],Ge&&l(Ge,Ce))try{delete Ge[Ce]}catch{}}if(!H[Ce]||he)try{return g(H,Ce,he?Ke:Q&&H[Ce]||Ke)}catch{}else return}for($e in $)Ge=s[$e],Ge&&(!Ge[Ce]||he)&&g(Ge,Ce,Ke)}};for(oe in $)B=s[oe],j=B&&B.prototype,j?I(j)[ne]=B:Q=!1;for(oe in pe)B=s[oe],j=B&&B.prototype,j&&(I(j)[ne]=B);if((!Q||!o(H)||H===Function.prototype)&&(H=function(){throw new J("Incorrect invocation")},Q))for(oe in $)s[oe]&&w(s[oe],H);if((!Q||!V||V===ie)&&(V=H.prototype,Q))for(oe in $)s[oe]&&w(s[oe].prototype,V);if(Q&&S(F)!==V&&w(F,V),i&&!l(V,ee)){K=!0,m(V,ee,{configurable:!0,get:function(){return a(this)?this[se]:void 0}});for(oe in $)s[oe]&&f(s[oe],se,oe)}n.exports={NATIVE_ARRAY_BUFFER_VIEWS:Q,TYPED_ARRAY_TAG:K&&se,aTypedArray:te,aTypedArrayConstructor:ae,exportTypedArrayMethod:ve,exportTypedArrayStaticMethod:_e,getTypedArrayConstructor:ye,isView:ge,isTypedArray:re,TypedArray:H,TypedArrayPrototype:V}}),4659:((n,e,t)=>{var r=t(3724),i=t(4913),s=t(6980);n.exports=function(o,a,l){r?i.f(o,a,s(0,l)):o[a]=l}}),4901:(n=>{var e=typeof document=="object"&&document.all;n.exports=typeof e>"u"&&e!==void 0?function(t){return typeof t=="function"||t===e}:function(t){return typeof t=="function"}}),4913:((n,e,t)=>{var r=t(3724),i=t(5917),s=t(8686),o=t(8551),a=t(6969),l=TypeError,u=Object.defineProperty,p=Object.getOwnPropertyDescriptor,f="enumerable",g="configurable",m="writable";e.f=r?s?function(S,w,b){if(o(S),w=a(w),o(b),typeof S=="function"&&w==="prototype"&&"value"in b&&m in b&&!b[m]){var R=p(S,w);R&&R[m]&&(S[w]=b.value,b={configurable:g in b?b[g]:R[g],enumerable:f in b?b[f]:R[f],writable:!1})}return u(S,w,b)}:u:function(S,w,b){if(o(S),w=a(w),o(b),i)try{return u(S,w,b)}catch{}if("get"in b||"set"in b)throw new l("Accessors not supported");return"value"in b&&(S[w]=b.value),S}}),4916:((n,e,t)=>{var r=t(7751),i=function(o){return{size:o,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},s=function(o){return{size:o,has:function(){return!0},keys:function(){throw new Error("e")}}};n.exports=function(o,a){var l=r("Set");try{new l()[o](i(0));try{return new l()[o](i(-1)),!1}catch{if(!a)return!0;try{return new l()[o](s(-1/0)),!1}catch{var u=new l([1,2]);return a(u[o](s(1/0)))}}}catch{return!1}}}),4972:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(8551),o=t(1767),a=t(4149),l=t(9590),u=t(9462),p=t(9539),f=t(4549),g=t(6395),m=!g&&f("take",RangeError),C=u(function(){var S=this.iterator;if(!this.remaining--)return this.done=!0,p(S,"normal",void 0);var w=s(i(this.next,S)),b=this.done=!!w.done;if(!b)return w.value});r({target:"Iterator",proto:!0,real:!0,forced:g||m},{take:function(w){s(this);var b;try{b=l(a(+w))}catch(R){p(this,"throw",R)}return m?i(m,this,b):new C(o(this),{remaining:b})}})}),4979:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(7751),o=t(6980),a=t(4913).f,l=t(9297),u=t(679),p=t(3167),f=t(2603),g=t(5002),m=t(8574),C=t(3724),S=t(6395),w="DOMException",b=s("Error"),R=s(w),P=function(){u(this,I);var ne=arguments.length,Q=f(ne<1?void 0:arguments[0]),K=f(ne<2?void 0:arguments[1],"Error"),oe=new R(Q,K),B=new b(Q);return B.name=w,a(oe,"stack",o(1,m(B.stack,1))),p(oe,this,P),oe},I=P.prototype=R.prototype,M="stack"in new b(w),k="stack"in new R(1,2),O=R&&C&&Object.getOwnPropertyDescriptor(i,w),L=!!O&&!(O.writable&&O.configurable),F=M&&!L&&!k;r({global:!0,constructor:!0,forced:S||F},{DOMException:F?P:R});var H=s(w),V=H.prototype;if(V.constructor!==H){S||a(V,"constructor",o(1,H));for(var ie in g)if(l(g,ie)){var J=g[ie],ee=J.s;l(H,ee)||a(H,ee,o(6,J.c))}}}),5002:(n=>{n.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}}),5024:((n,e,t)=>{var r=t(6518),i=t(3650),s=t(9835),o=t(4916),a=!o("symmetricDifference")||!s("symmetricDifference");r({target:"Set",proto:!0,real:!0,forced:a},{symmetricDifference:i})}),5031:((n,e,t)=>{var r=t(7751),i=t(9504),s=t(8480),o=t(3717),a=t(8551),l=i([].concat);n.exports=r("Reflect","ownKeys")||function(p){var f=s.f(a(p)),g=o.f;return g?l(f,g(p)):f}}),5169:((n,e,t)=>{var r=t(3238),i=TypeError;n.exports=function(s){if(r(s))throw new i("ArrayBuffer is detached");return s}}),5170:((n,e,t)=>{var r=t(6706),i=t(4402);n.exports=r(i.proto,"size","get")||function(s){return s.size}}),5213:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(5370),o=t(9143),a=i.Uint8Array,l=!a||!a.fromBase64||!(function(){try{a.fromBase64("a");return}catch{}try{a.fromBase64("",null)}catch{return!0}})();a&&r({target:"Uint8Array",stat:!0,forced:l},{fromBase64:function(p){var f=o(p,arguments.length>1?arguments[1]:void 0,null,9007199254740991);return s(a,f.bytes)}})}),5370:((n,e,t)=>{var r=t(6198);n.exports=function(i,s,o){for(var a=0,l=arguments.length>2?o:r(s),u=new i(l);l>a;)u[a]=s[a++];return u}}),5397:((n,e,t)=>{var r=t(7055),i=t(7750);n.exports=function(s){return r(i(s))}}),5610:((n,e,t)=>{var r=t(1291),i=Math.max,s=Math.min;n.exports=function(o,a){var l=r(o);return l<0?i(l+a,0):s(l,a)}}),5623:((n,e,t)=>{t(456)}),5636:((n,e,t)=>{var r=t(4576),i=t(9504),s=t(6706),o=t(7696),a=t(5169),l=t(7394),u=t(4483),p=t(1548),f=r.structuredClone,g=r.ArrayBuffer,m=r.DataView,C=Math.min,S=g.prototype,w=m.prototype,b=i(S.slice),R=s(S,"resizable","get"),P=s(S,"maxByteLength","get"),I=i(w.getInt8),M=i(w.setInt8);n.exports=(p||u)&&function(k,O,L){var F=l(k),H=O===void 0?F:o(O),V=!R||!R(k),ie;if(a(k),p&&(k=f(k,{transfer:[k]}),F===H&&(L||V)))return k;if(F>=H&&(!L||V))ie=b(k,0,H);else{var J=L&&!V&&P?{maxByteLength:P(k)}:void 0;ie=new g(H,J);for(var ee=new m(k),se=new m(ie),ne=C(H,F),Q=0;Q<ne;Q++)M(se,Q,I(ee,Q))}return p||u(k),ie}}),5745:((n,e,t)=>{var r=t(7629);n.exports=function(i,s){return r[i]||(r[i]=s||{})}}),5781:((n,e,t)=>{var r=t(6518),i=t(7751),s=t(2812),o=t(655),a=t(7416),l=i("URL");r({target:"URL",stat:!0,forced:!a},{parse:function(p){var f=s(arguments.length,1),g=o(p),m=f<2||arguments[1]===void 0?void 0:o(arguments[1]);try{return new l(g,m)}catch{return null}}})}),5854:((n,e,t)=>{var r=t(2777),i=TypeError;n.exports=function(s){var o=r(s,"number");if(typeof o=="number")throw new i("Can't convert number to bigint");return BigInt(o)}}),5876:((n,e,t)=>{var r=t(6518),i=t(3838),s=t(4916),o=!s("isSubsetOf",function(a){return a});r({target:"Set",proto:!0,real:!0,forced:o},{isSubsetOf:i})}),5917:((n,e,t)=>{var r=t(3724),i=t(9039),s=t(4055);n.exports=!r&&!i(function(){return Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a!==7})}),5966:((n,e,t)=>{var r=t(9306),i=t(4117);n.exports=function(s,o){var a=s[o];return i(a)?void 0:r(a)}}),6043:((n,e,t)=>{var r=t(9306),i=TypeError,s=function(o){var a,l;this.promise=new o(function(u,p){if(a!==void 0||l!==void 0)throw new i("Bad Promise constructor");a=u,l=p}),this.resolve=r(a),this.reject=r(l)};n.exports.f=function(o){return new s(o)}}),6080:((n,e,t)=>{var r=t(7476),i=t(9306),s=t(616),o=r(r.bind);n.exports=function(a,l){return i(a),l===void 0?a:s?o(a,l):function(){return a.apply(l,arguments)}}}),6119:((n,e,t)=>{var r=t(5745),i=t(3392),s=r("keys");n.exports=function(o){return s[o]||(s[o]=i(o))}}),6193:((n,e,t)=>{var r=t(4215);n.exports=r==="NODE"}),6198:((n,e,t)=>{var r=t(8014);n.exports=function(i){return r(i.length)}}),6269:(n=>{n.exports={}}),6279:((n,e,t)=>{var r=t(6840);n.exports=function(i,s,o){for(var a in s)r(i,a,s[a],o);return i}}),6319:((n,e,t)=>{var r=t(8551),i=t(9539);n.exports=function(s,o,a,l){try{return l?o(r(a)[0],a[1]):o(a)}catch(u){i(s,"throw",u)}}}),6395:(n=>{n.exports=!1}),6518:((n,e,t)=>{var r=t(4576),i=t(7347).f,s=t(6699),o=t(6840),a=t(9433),l=t(7740),u=t(2796);n.exports=function(p,f){var g=p.target,m=p.global,C=p.stat,S,w,b,R,P,I;if(m?w=r:C?w=r[g]||a(g,{}):w=r[g]&&r[g].prototype,w)for(b in f){if(P=f[b],p.dontCallGetSet?(I=i(w,b),R=I&&I.value):R=w[b],S=u(m?b:g+(C?".":"#")+b,p.forced),!S&&R!==void 0){if(typeof P==typeof R)continue;l(P,R)}(p.sham||R&&R.sham)&&s(P,"sham",!0),o(w,b,P,p)}}}),6573:((n,e,t)=>{var r=t(3724),i=t(2106),s=t(3238),o=ArrayBuffer.prototype;r&&!("detached"in o)&&i(o,"detached",{configurable:!0,get:function(){return s(this)}})}),6632:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(9143),o=t(4154),a=i.Uint8Array,l=!a||!a.prototype.setFromBase64||!(function(){var u=new a([255,255,255,255,255]);try{u.setFromBase64("",null);return}catch{}try{u.setFromBase64("a");return}catch{}try{u.setFromBase64("MjYyZg===")}catch{return u[0]===50&&u[1]===54&&u[2]===50&&u[3]===255&&u[4]===255}})();a&&r({target:"Uint8Array",proto:!0,forced:l},{setFromBase64:function(p){o(this);var f=s(p,arguments.length>1?arguments[1]:void 0,this,this.length);return{read:f.read,written:f.written}}})}),6699:((n,e,t)=>{var r=t(3724),i=t(4913),s=t(6980);n.exports=r?function(o,a,l){return i.f(o,a,s(1,l))}:function(o,a,l){return o[a]=l,o}}),6706:((n,e,t)=>{var r=t(9504),i=t(9306);n.exports=function(s,o,a){try{return r(i(Object.getOwnPropertyDescriptor(s,o)[a]))}catch{}}}),6801:((n,e,t)=>{var r=t(3724),i=t(8686),s=t(4913),o=t(8551),a=t(5397),l=t(1072);e.f=r&&!i?Object.defineProperties:function(p,f){o(p);for(var g=a(f),m=l(f),C=m.length,S=0,w;C>S;)s.f(p,w=m[S++],g[w]);return p}}),6823:(n=>{var e=String;n.exports=function(t){try{return e(t)}catch{return"Object"}}}),6837:(n=>{var e=TypeError,t=9007199254740991;n.exports=function(r){if(r>t)throw e("Maximum allowed index exceeded");return r}}),6840:((n,e,t)=>{var r=t(4901),i=t(4913),s=t(283),o=t(9433);n.exports=function(a,l,u,p){p||(p={});var f=p.enumerable,g=p.name!==void 0?p.name:l;if(r(u)&&s(u,g,p),p.global)f?a[l]=u:o(l,u);else{try{p.unsafe?a[l]&&(f=!0):delete a[l]}catch{}f?a[l]=u:i.f(a,l,{value:u,enumerable:!1,configurable:!p.nonConfigurable,writable:!p.nonWritable})}return a}}),6955:((n,e,t)=>{var r=t(2140),i=t(4901),s=t(2195),o=t(8227),a=o("toStringTag"),l=Object,u=s((function(){return arguments})())==="Arguments",p=function(f,g){try{return f[g]}catch{}};n.exports=r?s:function(f){var g,m,C;return f===void 0?"Undefined":f===null?"Null":typeof(m=p(g=l(f),a))=="string"?m:u?s(g):(C=s(g))==="Object"&&i(g.callee)?"Arguments":C}}),6969:((n,e,t)=>{var r=t(2777),i=t(757);n.exports=function(s){var o=r(s,"string");return i(o)?o:o+""}}),6980:(n=>{n.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}}),7040:((n,e,t)=>{var r=t(4495);n.exports=r&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}),7055:((n,e,t)=>{var r=t(9504),i=t(9039),s=t(2195),o=Object,a=r("".split);n.exports=i(function(){return!o("z").propertyIsEnumerable(0)})?function(l){return s(l)==="String"?a(l,""):o(l)}:o}),7080:((n,e,t)=>{var r=t(4402).has;n.exports=function(i){return r(i),i}}),7347:((n,e,t)=>{var r=t(3724),i=t(9565),s=t(8773),o=t(6980),a=t(5397),l=t(6969),u=t(9297),p=t(5917),f=Object.getOwnPropertyDescriptor;e.f=r?f:function(m,C){if(m=a(m),C=l(C),p)try{return f(m,C)}catch{}if(u(m,C))return o(!i(s.f,m,C),m[C])}}),7394:((n,e,t)=>{var r=t(4576),i=t(6706),s=t(2195),o=r.ArrayBuffer,a=r.TypeError;n.exports=o&&i(o.prototype,"byteLength","get")||function(l){if(s(l)!=="ArrayBuffer")throw new a("ArrayBuffer expected");return l.byteLength}}),7416:((n,e,t)=>{var r=t(9039),i=t(8227),s=t(3724),o=t(6395),a=i("iterator");n.exports=!r(function(){var l=new URL("b?a=1&b=2&c=3","https://a"),u=l.searchParams,p=new URLSearchParams("a=1&a=2&b=3"),f="";return l.pathname="c%20d",u.forEach(function(g,m){u.delete("b"),f+=m+g}),p.delete("a",2),p.delete("b",void 0),o&&(!l.toJSON||!p.has("a",1)||p.has("a",2)||!p.has("a",void 0)||p.has("b"))||!u.size&&(o||!s)||!u.sort||l.href!=="https://a/c%20d?a=1&c=3"||u.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!u[a]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://").host!=="xn--e1aybc"||new URL("https://a#").hash!=="#%D0%B1"||f!=="a1c3"||new URL("https://x",void 0).host!=="x"})}),7476:((n,e,t)=>{var r=t(2195),i=t(9504);n.exports=function(s){if(r(s)==="Function")return i(s)}}),7566:((n,e,t)=>{var r=t(6840),i=t(9504),s=t(655),o=t(2812),a=URLSearchParams,l=a.prototype,u=i(l.getAll),p=i(l.has),f=new a("a=1");(f.has("a",2)||!f.has("a",void 0))&&r(l,"has",function(m){var C=arguments.length,S=C<2?void 0:arguments[1];if(C&&S===void 0)return p(this,m);var w=u(this,m);o(C,1);for(var b=s(S),R=0;R<w.length;)if(w[R++]===b)return!0;return!1},{enumerable:!0,unsafe:!0})}),7588:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),u=t(9539),p=t(4549),f=p("forEach",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:f},{forEach:function(m){a(this);try{o(m)}catch(w){u(this,"throw",w)}if(f)return i(f,this,m);var C=l(this),S=0;s(C,function(w){m(w,S++)},{IS_RECORD:!0})}})}),7629:((n,e,t)=>{var r=t(6395),i=t(4576),s=t(9433),o="__core-js_shared__",a=n.exports=i[o]||s(o,{});(a.versions||(a.versions=[])).push({version:"3.47.0",mode:r?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),7642:((n,e,t)=>{var r=t(6518),i=t(3440),s=t(9039),o=t(4916),a=!o("difference",function(u){return u.size===0}),l=a||s(function(){var u={size:1,has:function(){return!0},keys:function(){var f=0;return{next:function(){var g=f++>1;return p.has(1)&&p.clear(),{done:g,value:2}}}}},p=new Set([1,2,3,4]);return p.difference(u).size!==3});r({target:"Set",proto:!0,real:!0,forced:l},{difference:i})}),7657:((n,e,t)=>{var r=t(9039),i=t(4901),s=t(34),o=t(2360),a=t(2787),l=t(6840),u=t(8227),p=t(6395),f=u("iterator"),g=!1,m,C,S;[].keys&&(S=[].keys(),"next"in S?(C=a(a(S)),C!==Object.prototype&&(m=C)):g=!0);var w=!s(m)||r(function(){var b={};return m[f].call(b)!==b});w?m={}:p&&(m=o(m)),i(m[f])||l(m,f,function(){return this}),n.exports={IteratorPrototype:m,BUGGY_SAFARI_ITERATORS:g}}),7680:((n,e,t)=>{var r=t(9504);n.exports=r([].slice)}),7696:((n,e,t)=>{var r=t(1291),i=t(8014),s=RangeError;n.exports=function(o){if(o===void 0)return 0;var a=r(o),l=i(a);if(a!==l)throw new s("Wrong length or index");return l}}),7740:((n,e,t)=>{var r=t(9297),i=t(5031),s=t(7347),o=t(4913);n.exports=function(a,l,u){for(var p=i(l),f=o.f,g=s.f,m=0;m<p.length;m++){var C=p[m];!r(a,C)&&!(u&&r(u,C))&&f(a,C,g(l,C))}}}),7750:((n,e,t)=>{var r=t(4117),i=TypeError;n.exports=function(s){if(r(s))throw new i("Can't call method on "+s);return s}}),7751:((n,e,t)=>{var r=t(4576),i=t(4901),s=function(o){return i(o)?o:void 0};n.exports=function(o,a){return arguments.length<2?s(r[o]):r[o]&&r[o][a]}}),7811:(n=>{n.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"}),7936:((n,e,t)=>{var r=t(6518),i=t(5636);i&&r({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return i(this,arguments.length?arguments[0]:void 0,!1)}})}),8004:((n,e,t)=>{var r=t(6518),i=t(9039),s=t(8750),o=t(4916),a=!o("intersection",function(l){return l.size===2&&l.has(1)&&l.has(2)})||i(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});r({target:"Set",proto:!0,real:!0,forced:a},{intersection:s})}),8014:((n,e,t)=>{var r=t(1291),i=Math.min;n.exports=function(s){var o=r(s);return o>0?i(o,9007199254740991):0}}),8100:((n,e,t)=>{var r=t(6518),i=t(5636);i&&r({target:"ArrayBuffer",proto:!0},{transfer:function(){return i(this,arguments.length?arguments[0]:void 0,!0)}})}),8111:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(679),o=t(8551),a=t(4901),l=t(2787),u=t(2106),p=t(4659),f=t(9039),g=t(9297),m=t(8227),C=t(7657).IteratorPrototype,S=t(3724),w=t(6395),b="constructor",R="Iterator",P=m("toStringTag"),I=TypeError,M=i[R],k=w||!a(M)||M.prototype!==C||!f(function(){M({})}),O=function(){if(s(this,C),l(this)===C)throw new I("Abstract class Iterator not directly constructable")},L=function(F,H){S?u(C,F,{configurable:!0,get:function(){return H},set:function(V){if(o(this),this===C)throw new I("You can't redefine this property");g(this,F)?this[F]=V:p(this,F,V)}}):C[F]=H};g(C,P)||L(P,R),(k||!g(C,b)||C[b]===Object)&&L(b,O),O.prototype=C,r({global:!0,constructor:!0,forced:k},{Iterator:O})}),8227:((n,e,t)=>{var r=t(4576),i=t(5745),s=t(9297),o=t(3392),a=t(4495),l=t(7040),u=r.Symbol,p=i("wks"),f=l?u.for||u:u&&u.withoutSetter||o;n.exports=function(g){return s(p,g)||(p[g]=a&&s(u,g)?u[g]:f("Symbol."+g)),p[g]}}),8235:((n,e,t)=>{var r=t(9504),i=t(9297),s=SyntaxError,o=parseInt,a=String.fromCharCode,l=r("".charAt),u=r("".slice),p=r(/./.exec),f={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},g=/^[\da-f]{4}$/i,m=/^[\u0000-\u001F]$/;n.exports=function(C,S){for(var w=!0,b="";S<C.length;){var R=l(C,S);if(R==="\\"){var P=u(C,S,S+2);if(i(f,P))b+=f[P],S+=2;else if(P==="\\u"){S+=2;var I=u(C,S,S+4);if(!p(g,I))throw new s("Bad Unicode escape at: "+S);b+=a(o(I,16)),S+=4}else throw new s('Unknown escape sequence: "'+P+'"')}else if(R==='"'){w=!1,S++;break}else{if(p(m,R))throw new s("Bad control character in string literal at: "+S);b+=R,S++}}if(w)throw new s("Unterminated string at: "+S);return{value:b,end:S}}}),8237:((n,e,t)=>{var r=t(6518),i=t(2652),s=t(9306),o=t(8551),a=t(1767),l=t(9539),u=t(4549),p=t(8745),f=t(9039),g=TypeError,m=f(function(){[].keys().reduce(function(){},void 0)}),C=!m&&u("reduce",g);r({target:"Iterator",proto:!0,real:!0,forced:m||C},{reduce:function(w){o(this);try{s(w)}catch(M){l(this,"throw",M)}var b=arguments.length<2,R=b?void 0:arguments[1];if(C)return p(C,this,b?[w]:[w,R]);var P=a(this),I=0;if(i(P,function(M){b?(b=!1,R=M):R=w(R,M,I),I++},{IS_RECORD:!0}),b)throw new g("Reduce of empty iterator with no initial value");return R}})}),8335:((n,e,t)=>{t(9112)}),8469:((n,e,t)=>{var r=t(9504),i=t(507),s=t(4402),o=s.Set,a=s.proto,l=r(a.forEach),u=r(a.keys),p=u(new o).next;n.exports=function(f,g,m){return m?i({iterator:u(f),next:p},g):l(f,g)}}),8480:((n,e,t)=>{var r=t(1828),i=t(8727),s=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(a){return r(a,s)}}),8527:((n,e,t)=>{var r=t(7080),i=t(4402).has,s=t(5170),o=t(3789),a=t(507),l=t(9539);n.exports=function(p){var f=r(this),g=o(p);if(s(f)<g.size)return!1;var m=g.getIterator();return a(m,function(C){if(!i(f,C))return l(m,"normal",!1)})!==!1}}),8551:((n,e,t)=>{var r=t(34),i=String,s=TypeError;n.exports=function(o){if(r(o))return o;throw new s(i(o)+" is not an object")}}),8574:((n,e,t)=>{var r=t(9504),i=Error,s=r("".replace),o=(function(u){return String(new i(u).stack)})("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,l=a.test(o);n.exports=function(u,p){if(l&&typeof u=="string"&&!i.prepareStackTrace)for(;p--;)u=s(u,a,"");return u}}),8622:((n,e,t)=>{var r=t(4576),i=t(4901),s=r.WeakMap;n.exports=i(s)&&/native code/.test(String(s))}),8646:((n,e,t)=>{var r=t(9565),i=t(8551),s=t(1767),o=t(851);n.exports=function(a,l){(!l||typeof a!="string")&&i(a);var u=o(a);return s(i(u!==void 0?r(u,a):a))}}),8686:((n,e,t)=>{var r=t(3724),i=t(9039);n.exports=r&&i(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})}),8721:((n,e,t)=>{var r=t(3724),i=t(9504),s=t(2106),o=URLSearchParams.prototype,a=i(o.forEach);r&&!("size"in o)&&s(o,"size",{get:function(){var u=0;return a(this,function(){u++}),u},configurable:!0,enumerable:!0})}),8727:(n=>{n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}),8745:((n,e,t)=>{var r=t(616),i=Function.prototype,s=i.apply,o=i.call;n.exports=typeof Reflect=="object"&&Reflect.apply||(r?o.bind(s):function(){return o.apply(s,arguments)})}),8750:((n,e,t)=>{var r=t(7080),i=t(4402),s=t(5170),o=t(3789),a=t(8469),l=t(507),u=i.Set,p=i.add,f=i.has;n.exports=function(m){var C=r(this),S=o(m),w=new u;return s(C)>S.size?l(S.getIterator(),function(b){f(C,b)&&p(w,b)}):a(C,function(b){S.includes(b)&&p(w,b)}),w}}),8773:((n,e)=>{var t={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!t.call({1:2},1);e.f=i?function(o){var a=r(this,o);return!!a&&a.enumerable}:t}),8981:((n,e,t)=>{var r=t(7750),i=Object;n.exports=function(s){return i(r(s))}}),9039:(n=>{n.exports=function(e){try{return!!e()}catch{return!0}}}),9112:((n,e,t)=>{var r=t(6518),i=t(3724),s=t(4576),o=t(7751),a=t(9504),l=t(9565),u=t(4901),p=t(34),f=t(4376),g=t(9297),m=t(655),C=t(6198),S=t(4659),w=t(9039),b=t(8235),R=t(4495),P=s.JSON,I=s.Number,M=s.SyntaxError,k=P&&P.parse,O=o("Object","keys"),L=Object.getOwnPropertyDescriptor,F=a("".charAt),H=a("".slice),V=a(/./.exec),ie=a([].push),J=/^\d$/,ee=/^[1-9]$/,se=/^[\d-]$/,ne=/^[\t\n\r ]$/,Q=0,K=1,oe=function(re,te){re=m(re);var ae=new pe(re,0),ve=ae.parse(),_e=ve.value,Ce=ae.skip(ne,ve.end);if(Ce<re.length)throw new M('Unexpected extra character: "'+F(re,Ce)+'" after the parsed data at: '+Ce);return u(te)?B({"":_e},"",te,ve):_e},B=function(re,te,ae,ve){var _e=re[te],Ce=ve&&_e===ve.value,Ke=Ce&&typeof ve.source=="string"?{source:ve.source}:{},he,$e,Ge,Ve,st;if(p(_e)){var xn=f(_e),Yn=Ce?ve.nodes:xn?[]:{};if(xn)for(he=Yn.length,Ge=C(_e),Ve=0;Ve<Ge;Ve++)j(_e,Ve,B(_e,""+Ve,ae,Ve<he?Yn[Ve]:void 0));else for($e=O(_e),Ge=C($e),Ve=0;Ve<Ge;Ve++)st=$e[Ve],j(_e,st,B(_e,st,ae,g(Yn,st)?Yn[st]:void 0))}return l(ae,re,te,_e,Ke)},j=function(re,te,ae){if(i){var ve=L(re,te);if(ve&&!ve.configurable)return}ae===void 0?delete re[te]:S(re,te,ae)},$=function(re,te,ae,ve){this.value=re,this.end=te,this.source=ae,this.nodes=ve},pe=function(re,te){this.source=re,this.index=te};pe.prototype={fork:function(re){return new pe(this.source,re)},parse:function(){var re=this.source,te=this.skip(ne,this.index),ae=this.fork(te),ve=F(re,te);if(V(se,ve))return ae.number();switch(ve){case"{":return ae.object();case"[":return ae.array();case'"':return ae.string();case"t":return ae.keyword(!0);case"f":return ae.keyword(!1);case"n":return ae.keyword(null)}throw new M('Unexpected character: "'+ve+'" at: '+te)},node:function(re,te,ae,ve,_e){return new $(te,ve,re?null:H(this.source,ae,ve),_e)},object:function(){for(var re=this.source,te=this.index+1,ae=!1,ve={},_e={};te<re.length;){if(te=this.until(['"',"}"],te),F(re,te)==="}"&&!ae){te++;break}var Ce=this.fork(te).string(),Ke=Ce.value;te=Ce.end,te=this.until([":"],te)+1,te=this.skip(ne,te),Ce=this.fork(te).parse(),S(_e,Ke,Ce),S(ve,Ke,Ce.value),te=this.until([",","}"],Ce.end);var he=F(re,te);if(he===",")ae=!0,te++;else if(he==="}"){te++;break}}return this.node(K,ve,this.index,te,_e)},array:function(){for(var re=this.source,te=this.index+1,ae=!1,ve=[],_e=[];te<re.length;){if(te=this.skip(ne,te),F(re,te)==="]"&&!ae){te++;break}var Ce=this.fork(te).parse();if(ie(_e,Ce),ie(ve,Ce.value),te=this.until([",","]"],Ce.end),F(re,te)===",")ae=!0,te++;else if(F(re,te)==="]"){te++;break}}return this.node(K,ve,this.index,te,_e)},string:function(){var re=this.index,te=b(this.source,this.index+1);return this.node(Q,te.value,re,te.end)},number:function(){var re=this.source,te=this.index,ae=te;if(F(re,ae)==="-"&&ae++,F(re,ae)==="0")ae++;else if(V(ee,F(re,ae)))ae=this.skip(J,ae+1);else throw new M("Failed to parse number at: "+ae);if(F(re,ae)==="."&&(ae=this.skip(J,ae+1)),F(re,ae)==="e"||F(re,ae)==="E"){ae++,(F(re,ae)==="+"||F(re,ae)==="-")&&ae++;var ve=ae;if(ae=this.skip(J,ae),ve===ae)throw new M("Failed to parse number's exponent value at: "+ae)}return this.node(Q,I(H(re,te,ae)),te,ae)},keyword:function(re){var te=""+re,ae=this.index,ve=ae+te.length;if(H(this.source,ae,ve)!==te)throw new M("Failed to parse value at: "+ae);return this.node(Q,re,ae,ve)},skip:function(re,te){for(var ae=this.source;te<ae.length&&V(re,F(ae,te));te++);return te},until:function(re,te){te=this.skip(ne,te);for(var ae=F(this.source,te),ve=0;ve<re.length;ve++)if(re[ve]===ae)return te;throw new M('Unexpected character: "'+ae+'" at: '+te)}};var ge=w(function(){var re="9007199254740993",te;return k(re,function(ae,ve,_e){te=_e.source}),te!==re}),ye=R&&!w(function(){return 1/k("-0 	")!==-1/0});r({target:"JSON",stat:!0,forced:ge},{parse:function(te,ae){return ye&&!u(ae)?k(te):oe(te,ae)}})}),9143:((n,e,t)=>{var r=t(4576),i=t(9504),s=t(3972),o=t(3463),a=t(9297),l=t(2804),u=t(944),p=t(5169),f=l.c2i,g=l.c2iUrl,m=r.SyntaxError,C=r.TypeError,S=i("".charAt),w=function(P,I){for(var M=P.length;I<M;I++){var k=S(P,I);if(k!==" "&&k!=="	"&&k!==`
`&&k!=="\f"&&k!=="\r")break}return I},b=function(P,I,M){var k=P.length;k<4&&(P+=k===2?"AA":"A");var O=(I[S(P,0)]<<18)+(I[S(P,1)]<<12)+(I[S(P,2)]<<6)+I[S(P,3)],L=[O>>16&255,O>>8&255,O&255];if(k===2){if(M&&L[1]!==0)throw new m("Extra bits");return[L[0]]}if(k===3){if(M&&L[2]!==0)throw new m("Extra bits");return[L[0],L[1]]}return L},R=function(P,I,M){for(var k=I.length,O=0;O<k;O++)P[M+O]=I[O];return M+k};n.exports=function(P,I,M,k){o(P),s(I);var O=u(I)==="base64"?f:g,L=I?I.lastChunkHandling:void 0;if(L===void 0&&(L="loose"),L!=="loose"&&L!=="strict"&&L!=="stop-before-partial")throw new C("Incorrect `lastChunkHandling` option");M&&p(M.buffer);var F=P.length,H=M||[],V=0,ie=0,J="",ee=0;if(k)for(;;){if(ee=w(P,ee),ee===F){if(J.length>0){if(L==="stop-before-partial")break;if(L==="loose"){if(J.length===1)throw new m("Malformed padding: exactly one additional character");V=R(H,b(J,O,!1),V)}else throw new m("Missing padding")}ie=F;break}var se=S(P,ee);if(++ee,se==="="){if(J.length<2)throw new m("Padding is too early");if(ee=w(P,ee),J.length===2){if(ee===F){if(L==="stop-before-partial")break;throw new m("Malformed padding: only one =")}S(P,ee)==="="&&(++ee,ee=w(P,ee))}if(ee<F)throw new m("Unexpected character after padding");V=R(H,b(J,O,L==="strict"),V),ie=F;break}if(!a(O,se))throw new m("Unexpected character");var ne=k-V;if(ne===1&&J.length===2||ne===2&&J.length===3||(J+=se,J.length===4&&(V=R(H,b(J,O,!1),V),J="",ie=ee,V===k)))break}return{bytes:H,read:ie,written:V}}}),9286:((n,e,t)=>{var r=t(4402),i=t(8469),s=r.Set,o=r.add;n.exports=function(a){var l=new s;return i(a,function(u){o(l,u)}),l}}),9297:((n,e,t)=>{var r=t(9504),i=t(8981),s=r({}.hasOwnProperty);n.exports=Object.hasOwn||function(a,l){return s(i(a),l)}}),9306:((n,e,t)=>{var r=t(4901),i=t(6823),s=TypeError;n.exports=function(o){if(r(o))return o;throw new s(i(o)+" is not a function")}}),9314:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(8551),o=t(1767),a=t(4149),l=t(9590),u=t(9539),p=t(9462),f=t(684),g=t(4549),m=t(6395),C=!m&&!f("drop",0),S=!m&&!C&&g("drop",RangeError),w=m||C||S,b=p(function(){for(var R=this.iterator,P=this.next,I,M;this.remaining;)if(this.remaining--,I=s(i(P,R)),M=this.done=!!I.done,M)return;if(I=s(i(P,R)),M=this.done=!!I.done,!M)return I.value});r({target:"Iterator",proto:!0,real:!0,forced:w},{drop:function(P){s(this);var I;try{I=l(a(+P))}catch(M){u(this,"throw",M)}return S?i(S,this,I):new b(o(this),{remaining:I})}})}),9429:((n,e,t)=>{var r=t(4576),i=t(6193);n.exports=function(s){if(i){try{return r.process.getBuiltinModule(s)}catch{}try{return Function('return require("'+s+'")')()}catch{}}}}),9432:((n,e,t)=>{t(5213)}),9433:((n,e,t)=>{var r=t(4576),i=Object.defineProperty;n.exports=function(s,o){try{i(r,s,{value:o,configurable:!0,writable:!0})}catch{r[s]=o}return o}}),9462:((n,e,t)=>{var r=t(9565),i=t(2360),s=t(6699),o=t(6279),a=t(8227),l=t(1181),u=t(5966),p=t(7657).IteratorPrototype,f=t(2529),g=t(9539),m=t(1385),C=a("toStringTag"),S="IteratorHelper",w="WrapForValidIterator",b="normal",R="throw",P=l.set,I=function(O){var L=l.getterFor(O?w:S);return o(i(p),{next:function(){var H=L(this);if(O)return H.nextHandler();if(H.done)return f(void 0,!0);try{var V=H.nextHandler();return H.returnHandlerResult?V:f(V,H.done)}catch(ie){throw H.done=!0,ie}},return:function(){var F=L(this),H=F.iterator;if(F.done=!0,O){var V=u(H,"return");return V?r(V,H):f(void 0,!0)}if(F.inner)try{g(F.inner.iterator,b)}catch(ie){return g(H,R,ie)}if(F.openIters)try{m(F.openIters,b)}catch(ie){return g(H,R,ie)}return H&&g(H,b),f(void 0,!0)}})},M=I(!0),k=I(!1);s(k,C,"Iterator Helper"),n.exports=function(O,L,F){var H=function(ie,J){J?(J.iterator=ie.iterator,J.next=ie.next):J=ie,J.type=L?w:S,J.returnHandlerResult=!!F,J.nextHandler=O,J.counter=0,J.done=!1,P(this,J)};return H.prototype=L?M:k,H}}),9486:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(9504),o=t(3972),a=t(4154),l=t(5169),u=t(2804),p=t(944),f=u.i2c,g=u.i2cUrl,m=s("".charAt),C=i.Uint8Array,S=!C||!C.prototype.toBase64||!(function(){try{var w=new C;w.toBase64(null)}catch{return!0}})();C&&r({target:"Uint8Array",proto:!0,forced:S},{toBase64:function(){var b=a(this),R=arguments.length?o(arguments[0]):void 0,P=p(R)==="base64"?f:g,I=!!R&&!!R.omitPadding;l(this.buffer);for(var M="",k=0,O=b.length,L,F=function(H){return m(P,L>>6*H&63)};k+2<O;k+=3)L=(b[k]<<16)+(b[k+1]<<8)+b[k+2],M+=F(3)+F(2)+F(1)+F(0);return k+2===O?(L=(b[k]<<16)+(b[k+1]<<8),M+=F(3)+F(2)+F(1)+(I?"":"=")):k+1===O&&(L=b[k]<<16,M+=F(3)+F(2)+(I?"":"==")),M}})}),9504:((n,e,t)=>{var r=t(616),i=Function.prototype,s=i.call,o=r&&i.bind.bind(s,s);n.exports=r?o:function(a){return function(){return s.apply(a,arguments)}}}),9519:((n,e,t)=>{var r=t(4576),i=t(2839),s=r.process,o=r.Deno,a=s&&s.versions||o&&o.version,l=a&&a.v8,u,p;l&&(u=l.split("."),p=u[0]>0&&u[0]<4?1:+(u[0]+u[1])),!p&&i&&(u=i.match(/Edge\/(\d+)/),(!u||u[1]>=74)&&(u=i.match(/Chrome\/(\d+)/),u&&(p=+u[1]))),n.exports=p}),9539:((n,e,t)=>{var r=t(9565),i=t(8551),s=t(5966);n.exports=function(o,a,l){var u,p;i(o);try{if(u=s(o,"return"),!u){if(a==="throw")throw l;return l}u=r(u,o)}catch(f){p=!0,u=f}if(a==="throw")throw l;if(p)throw u;return i(u),l}}),9565:((n,e,t)=>{var r=t(616),i=Function.prototype.call;n.exports=r?i.bind(i):function(){return i.apply(i,arguments)}}),9577:((n,e,t)=>{var r=t(9928),i=t(4644),s=t(1108),o=t(1291),a=t(5854),l=i.aTypedArray,u=i.getTypedArrayConstructor,p=i.exportTypedArrayMethod,f=(function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(m){return m===8}})(),g=f&&(function(){try{new Int8Array(1).with(-.5,1)}catch{return!0}})();p("with",function(m,C){var S=l(this),w=o(m),b=s(S)?a(C):+C;return r(S,u(S),w,b)},!f||g)}),9590:((n,e,t)=>{var r=t(1291),i=RangeError;n.exports=function(s){var o=r(s);if(o<0)throw new i("The argument can't be less than 0");return o}}),9617:((n,e,t)=>{var r=t(5397),i=t(5610),s=t(6198),o=function(a){return function(l,u,p){var f=r(l),g=s(f);if(g===0)return!a&&-1;var m=i(p,g),C;if(a&&u!==u){for(;g>m;)if(C=f[m++],C!==C)return!0}else for(;g>m;m++)if((a||m in f)&&f[m]===u)return a||m||0;return!a&&-1}};n.exports={includes:o(!0),indexOf:o(!1)}}),9631:((n,e,t)=>{t(9486)}),9797:((n,e,t)=>{t(4226)}),9835:(n=>{n.exports=function(e){try{var t=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return t.clear(),t.add(4),function(){return{done:!0}}}})}},i=t[e](r);return i.size===1&&i.values().next().value===4}catch{return!1}}}),9928:((n,e,t)=>{var r=t(6198),i=t(1291),s=RangeError;n.exports=function(o,a,l,u){var p=r(o),f=i(l),g=f<0?p+f:f;if(g>=p||g<0)throw new s("Incorrect index");for(var m=new a(p),C=0;C<p;C++)m[C]=C===g?u:o[C];return m}})},lD={};function He(n){var e=lD[n];if(e!==void 0)return e.exports;var t=lD[n]={exports:{}};return _5[n].call(t.exports,t,t.exports,He),t.exports}He.d=(n,e)=>{for(var t in e)He.o(e,t)&&!He.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};He.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);He(4114);He(6573);He(8100);He(7936);He(8111);He(8237);He(1689);He(9577);He(4235);He(9432);He(1549);He(9797);He(9631);He(5623);He(4979);He(5781);const ar=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),bE=[.001,0,0,.001,0,0],nE=1.35,ti={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ra={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Jv="pdfjs_internal_editor_",Be={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},nt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},k5={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},wE={TRIANGLES:1,LATTICE:2},hn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},PC={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},on={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},rd={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},H0={ERRORS:0,WARNINGS:1,INFOS:5},Xv={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},bv={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},M5={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let W0=H0.WARNINGS;function D5(n){Number.isInteger(n)&&(W0=n)}function N5(){return W0}function q0(n){W0>=H0.INFOS&&console.info(`Info: ${n}`)}function Le(n){W0>=H0.WARNINGS&&console.warn(`Warning: ${n}`)}function Pt(n){throw new Error(n)}function rt(n,e){n||Pt(e)}function O5(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function DO(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=B5(n)}catch{}}const r=e?URL.parse(n,e):URL.parse(n);return O5(r)?r:null}function NO(n,e,t=!1){const r=URL.parse(n);return r?(r.hash=e,r.href):t&&DO(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function ze(n,e,t,r=!1){return Object.defineProperty(n,e,{value:t,enumerable:!r,configurable:!0,writable:!1}),t}const xu=(function(){function e(t,r){this.message=t,this.name=r}return e.prototype=new Error,e.constructor=e,e})();class uD extends xu{constructor(e,t){super(e,"PasswordException"),this.code=t}}class rE extends xu{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class AE extends xu{constructor(e){super(e,"InvalidPDFException")}}class o0 extends xu{constructor(e,t,r){super(e,"ResponseException"),this.status=t,this.missing=r}}class L5 extends xu{constructor(e){super(e,"FormatError")}}class vc extends xu{constructor(e){super(e,"AbortException")}}function OO(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Pt("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const r=[];for(let i=0;i<e;i+=t){const s=Math.min(i+t,e),o=n.subarray(i,s);r.push(String.fromCharCode.apply(null,o))}return r.join("")}function $y(n){typeof n!="string"&&Pt("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let r=0;r<e;++r)t[r]=n.charCodeAt(r)&255;return t}function j5(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function z5(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function F5(){try{return new Function(""),!0}catch{return!1}}class mn{static get isLittleEndian(){return ze(this,"isLittleEndian",z5())}static get isEvalSupported(){return ze(this,"isEvalSupported",F5())}static get isOffscreenCanvasSupported(){return ze(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ze(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return ze(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return ze(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return ze(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return ze(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const iE=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Vo,TC,EE;class be{static makeHexColor(e,t,r){return`#${iE[e]}${iE[t]}${iE[r]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let r;e[0]?(e[0]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[3],t[3]*=e[3]):(r=t[0],t[0]=t[1],t[1]=r,r=t[2],t[2]=t[3],t[3]=r,e[1]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,r=0){const i=e[r],s=e[r+1];e[r]=i*t[0]+s*t[2]+t[4],e[r+1]=i*t[1]+s*t[3]+t[5]}static applyTransformToBezier(e,t,r=0){const i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],u=t[5];for(let p=0;p<6;p+=2){const f=e[r+p],g=e[r+p+1];e[r+p]=f*i+g*o+l,e[r+p+1]=f*s+g*a+u}}static applyInverseTransform(e,t){const r=e[0],i=e[1],s=t[0]*t[3]-t[1]*t[2];e[0]=(r*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/s,e[1]=(-r*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/s}static axialAlignedBoundingBox(e,t,r){const i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],u=t[5],p=e[0],f=e[1],g=e[2],m=e[3];let C=i*p+l,S=C,w=i*g+l,b=w,R=a*f+u,P=R,I=a*m+u,M=I;if(s!==0||o!==0){const k=s*p,O=s*g,L=o*f,F=o*m;C+=L,b+=L,w+=F,S+=F,R+=k,M+=k,I+=O,P+=O}r[0]=Math.min(r[0],C,w,S,b),r[1]=Math.min(r[1],R,I,P,M),r[2]=Math.max(r[2],C,w,S,b),r[3]=Math.max(r[3],R,I,P,M)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const r=e[0],i=e[1],s=e[2],o=e[3],a=r**2+i**2,l=r*s+i*o,u=s**2+o**2,p=(a+u)/2,f=Math.sqrt(p**2-(a*u-l**2));t[0]=Math.sqrt(p+f||1),t[1]=Math.sqrt(p-f||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const r=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(r>i)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>o?null:[r,s,i,o]}static pointBoundingBox(e,t,r){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],t),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],t)}static rectBoundingBox(e,t,r,i,s){s[0]=Math.min(s[0],e,r),s[1]=Math.min(s[1],t,i),s[2]=Math.max(s[2],e,r),s[3]=Math.max(s[3],t,i)}static bezierBoundingBox(e,t,r,i,s,o,a,l,u){u[0]=Math.min(u[0],e,a),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,a),u[3]=Math.max(u[3],t,l),D(this,Vo,EE).call(this,e,r,s,a,t,i,o,l,3*(-e+3*(r-s)+a),6*(e-2*r+s),3*(r-e),u),D(this,Vo,EE).call(this,e,r,s,a,t,i,o,l,3*(-t+3*(i-o)+l),6*(t-2*i+o),3*(i-t),u)}}Vo=new WeakSet,TC=function(e,t,r,i,s,o,a,l,u,p){if(u<=0||u>=1)return;const f=1-u,g=u*u,m=g*u,C=f*(f*(f*e+3*u*t)+3*g*r)+m*i,S=f*(f*(f*s+3*u*o)+3*g*a)+m*l;p[0]=Math.min(p[0],C),p[1]=Math.min(p[1],S),p[2]=Math.max(p[2],C),p[3]=Math.max(p[3],S)},EE=function(e,t,r,i,s,o,a,l,u,p,f,g){if(Math.abs(u)<1e-12){Math.abs(p)>=1e-12&&D(this,Vo,TC).call(this,e,t,r,i,s,o,a,l,-f/p,g);return}const m=p**2-4*f*u;if(m<0)return;const C=Math.sqrt(m),S=2*u;D(this,Vo,TC).call(this,e,t,r,i,s,o,a,l,(-p+C)/S,g),D(this,Vo,TC).call(this,e,t,r,i,s,o,a,l,(-p-C)/S,g)},_(be,Vo);function B5(n){return decodeURIComponent(escape(n))}let sE=null,dD=null;function U5(n){return sE||(sE=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,dD=new Map([["","t"]])),n.replaceAll(sE,(e,t,r)=>t?t.normalize("NFKC"):dD.get(r))}function LO(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),OO(n)}const hd="pdfjs_internal_id_";function H5(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[r,i,...s]=t;if(!n(r)&&!Number.isInteger(r)||!e(i))return!1;const o=s.length;let a=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;a=!1;break;default:return!1}for(const l of s)if(!(typeof l=="number"||a&&l===null))return!1;return!0}function cr(n,e,t){return Math.min(Math.max(n,e),t)}function jO(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(OO(n))}function W5(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):$y(atob(n))}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});typeof AbortSignal.any!="function"&&(AbortSignal.any=function(n){const e=new AbortController,{signal:t}=e;for(const r of n)if(r.aborted)return e.abort(r.reason),t;for(const r of n)r.addEventListener("abort",()=>{e.abort(r.reason)},{signal:t});return t});He(1701);He(4603);He(7566);He(8721);class Yv{static textContent(e){const t=[],r={items:t,styles:Object.create(null)};function i(s){var l;if(!s)return;let o=null;const a=s.name;if(a==="#text")o=s.value;else if(Yv.shouldBuildText(a))(l=s==null?void 0:s.attributes)!=null&&l.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&t.push({str:o}),!!s.children)for(const u of s.children)i(u)}return i(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class zO{static setupStorage(e,t,r,i,s){const o=i.getValue(t,{value:null});switch(r.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),s==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(o.value===r.attributes.xfaOn?e.setAttribute("checked",!0):o.value===r.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",a=>{i.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),s==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of r.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const l=a.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:r=null,intent:i,linkService:s}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[l,u]of Object.entries(o))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}a&&s.addLinkAttributes(e,o.href,o.newWindow),r&&o.dataId&&this.setupStorage(e,o.dataId,t,r)}static render(e){var f,g;const t=e.annotationStorage,r=e.linkService,i=e.xfaHtml,s=e.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:s,linkService:r});const a=s!=="richText",l=e.div;if(l.append(o),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=m}a&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const m=document.createTextNode(i.value);o.append(m),a&&Yv.shouldBuildText(i.name)&&u.push(m)}return{textDivs:u}}const p=[[i,-1,o]];for(;p.length>0;){const[m,C,S]=p.at(-1);if(C+1===m.children.length){p.pop();continue}const w=m.children[++p.at(-1)[1]];if(w===null)continue;const{name:b}=w;if(b==="#text"){const P=document.createTextNode(w.value);u.push(P),S.append(P);continue}const R=(f=w==null?void 0:w.attributes)!=null&&f.xmlns?document.createElementNS(w.attributes.xmlns,b):document.createElement(b);if(S.append(R),w.attributes&&this.setAttributes({html:R,element:w,storage:t,intent:s,linkService:r}),((g=w.children)==null?void 0:g.length)>0)p.push([w,-1,R]);else if(w.value){const P=document.createTextNode(w.value);a&&Yv.shouldBuildText(b)&&u.push(P),R.append(P)}}for(const m of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const ro="http://www.w3.org/2000/svg",sl=class sl{};G(sl,"CSS",96),G(sl,"PDF",72),G(sl,"PDF_TO_CSS_UNITS",sl.CSS/sl.PDF);let mc=sl;async function Jy(n,e="text"){if(xv(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,r)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}r(new Error(i.statusText))}},i.send(null)})}class Xy{constructor({viewBox:e,userUnit:t,scale:r,rotation:i,offsetX:s=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=r,this.rotation=i,this.offsetX=s,this.offsetY=o,r*=t;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let p,f,g,m;switch(i%=360,i<0&&(i+=360),i){case 180:p=-1,f=0,g=0,m=1;break;case 90:p=0,f=1,g=1,m=0;break;case 270:p=0,f=-1,g=-1,m=0;break;case 0:p=1,f=0,g=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(g=-g,m=-m);let C,S,w,b;p===0?(C=Math.abs(u-e[1])*r+s,S=Math.abs(l-e[0])*r+o,w=(e[3]-e[1])*r,b=(e[2]-e[0])*r):(C=Math.abs(l-e[0])*r+s,S=Math.abs(u-e[1])*r+o,w=(e[2]-e[0])*r,b=(e[3]-e[1])*r),this.transform=[p*r,f*r,g*r,m*r,C-p*r*l-g*r*u,S-f*r*l-m*r*u],this.width=w,this.height=b}get rawDims(){const e=this.viewBox;return ze(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new Xy({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}convertToViewportPoint(e,t){const r=[e,t];return be.applyTransform(r,this.transform),r}convertToViewportRectangle(e){const t=[e[0],e[1]];be.applyTransform(t,this.transform);const r=[e[2],e[3]];return be.applyTransform(r,this.transform),[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){const r=[e,t];return be.applyInverseTransform(r,this.transform),r}}class uP extends xu{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function V0(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function dP(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function q5(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function V5(n,e="document.pdf"){if(typeof n!="string")return e;if(V0(n))return Le('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const r=(a=>{try{return new URL(a)}catch{try{return new URL(decodeURIComponent(a))}catch{try{return new URL(a,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(a),"https://foo.bar")}catch{return null}}}}})(n);if(!r)return e;const i=a=>{try{let l=decodeURIComponent(a);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:a):l}catch{return a}},s=/\.pdf$/i,o=r.pathname.split("/").at(-1);if(s.test(o))return i(o);if(r.searchParams.size>0){const a=Array.from(r.searchParams.values()).reverse();for(const u of a)if(s.test(u))return i(u);const l=Array.from(r.searchParams.keys()).reverse();for(const u of l)if(s.test(u))return i(u)}if(r.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(r.hash);if(l)return i(l[0])}return e}class hD{constructor(){G(this,"started",Object.create(null));G(this,"times",[])}time(e){e in this.started&&Le(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Le(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:r}of this.times)t=Math.max(r.length,t);for(const{name:r,start:i,end:s}of this.times)e.push(`${r.padEnd(t)} ${s-i}ms
`);return e.join("")}}function xv(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function _i(n){n.preventDefault()}function Qt(n){n.preventDefault(),n.stopPropagation()}function G5(n){console.log("Deprecated API usage: "+n)}var tm;class a0{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;h(this,tm)||T(this,tm,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=h(this,tm).exec(e);if(!t)return null;const r=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,u==="-"?(o+=p,a+=f):u==="+"&&(o-=p,a-=f),new Date(Date.UTC(r,i,s,o,a,l))}}tm=new WeakMap,_(a0,tm);function K5(n,{scale:e=1,rotation:t=0}){const{width:r,height:i}=n.attributes.style,s=[0,0,parseInt(r),parseInt(i)];return new Xy({viewBox:s,userUnit:1,scale:e,rotation:t})}function Yy(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Le(`Not a valid color format: "${n}"`),[0,0,0])}function $5(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const r=window.getComputedStyle(e).color;n.set(t,Yy(r))}e.remove()}function Wt(n){const{a:e,b:t,c:r,d:i,e:s,f:o}=n.getTransform();return[e,t,r,i,s,o]}function gs(n){const{a:e,b:t,c:r,d:i,e:s,f:o}=n.getTransform().invertSelf();return[e,t,r,i,s,o]}function Au(n,e,t=!1,r=!0){if(e instanceof Xy){const{pageWidth:i,pageHeight:s}=e.rawDims,{style:o}=n,a=mn.isCSSRoundSupported,l=`var(--total-scale-factor) * ${i}px`,u=`var(--total-scale-factor) * ${s}px`,p=a?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,f=a?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(o.width=p,o.height=f):(o.width=f,o.height=p)}r&&n.setAttribute("data-main-rotation",e.rotation)}class Us{constructor(){const{pixelRatio:e}=Us;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,r,i,s=-1){let o=1/0,a=1/0,l=1/0;r=Us.capPixels(r,s),r>0&&(o=Math.sqrt(r/(e*t))),i!==-1&&(a=i/e,l=i/t);const u=Math.min(o,a,l);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const r=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,r):r}return e}}const RE=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class J5{static get isDarkMode(){var e;return ze(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class X5{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:r}=window.getComputedStyle(e);return e.remove(),ze(this,"commentForegroundColor",Yy(r))}}function Y5(n,e,t,r){r=Math.min(Math.max(r??1,0),1);const i=255*(1-r);return n=Math.round(n*r+i),e=Math.round(e*r+i),t=Math.round(t*r+i),[n,e,t]}function pD(n,e){const t=n[0]/255,r=n[1]/255,i=n[2]/255,s=Math.max(t,r,i),o=Math.min(t,r,i),a=(s+o)/2;if(s===o)e[0]=e[1]=0;else{const l=s-o;switch(e[1]=a<.5?l/(s+o):l/(2-s-o),s){case t:e[0]=((r-i)/l+(r<i?6:0))*60;break;case r:e[0]=((i-t)/l+2)*60;break;case i:e[0]=((t-r)/l+4)*60;break}}e[2]=a}function PE(n,e){const t=n[0],r=n[1],i=n[2],s=(1-Math.abs(2*i-1))*r,o=s*(1-Math.abs(t/60%2-1)),a=i-s/2;switch(Math.floor(t/60)){case 0:e[0]=s+a,e[1]=o+a,e[2]=a;break;case 1:e[0]=o+a,e[1]=s+a,e[2]=a;break;case 2:e[0]=a,e[1]=s+a,e[2]=o+a;break;case 3:e[0]=a,e[1]=o+a,e[2]=s+a;break;case 4:e[0]=o+a,e[1]=a,e[2]=s+a;break;case 5:case 6:e[0]=s+a,e[1]=a,e[2]=o+a;break}}function fD(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function gD(n,e,t){PE(n,t),t.map(fD);const r=.2126*t[0]+.7152*t[1]+.0722*t[2];PE(e,t),t.map(fD);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return r>i?(r+.05)/(i+.05):(i+.05)/(r+.05)}const vD=new Map;function Q5(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let r=vD.get(t);if(r)return r;const i=new Float32Array(9),s=i.subarray(0,3),o=i.subarray(3,6);pD(n,o);const a=i.subarray(6,9);pD(e,a);const l=a[2]<.5,u=l?12:4.5;if(o[2]=l?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),gD(o,a,s)<u){let p,f;l?(p=o[2],f=1):(p=0,f=o[2]);const g=.005;for(;f-p>g;){const m=o[2]=(p+f)/2;l===gD(o,a,s)<u?p=m:f=m}o[2]=l?f:p}return PE(o,s),r=be.makeHexColor(Math.round(s[0]*255),Math.round(s[1]*255),Math.round(s[2]*255)),vD.set(t,r),r}function FO({html:n,dir:e,className:t},r){const i=document.createDocumentFragment();if(typeof n=="string"){const s=document.createElement("p");s.dir=e||"auto";const o=n.split(/(?:\r\n?|\n)/);for(let a=0,l=o.length;a<l;++a){const u=o[a];s.append(document.createTextNode(u)),a<l-1&&s.append(document.createElement("br"))}i.append(s)}else zO.render({xfaHtml:n,div:i,intent:"richText"});i.firstElementChild.classList.add("richText",t),r.append(i)}function BO(n){const e=new Path2D;if(!n)return e;for(let t=0,r=n.length;t<r;)switch(n[t++]){case bv.moveTo:e.moveTo(n[t++],n[t++]);break;case bv.lineTo:e.lineTo(n[t++],n[t++]);break;case bv.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case bv.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case bv.closePath:e.closePath();break;default:Le(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}He(4972);He(4628);He(7642);He(8004);He(3853);He(5876);He(2475);He(5024);He(1698);He(9314);He(1148);He(3579);He(8335);var Pa,Ta,gi,vi,nm,xa,Sd,Cd,rm,C0,UO,Fn,HO,WO,id,Iv;const oo=class oo{constructor(e){_(this,Fn);_(this,Pa,null);_(this,Ta,null);_(this,gi);_(this,vi,null);_(this,nm,null);_(this,xa,null);_(this,Sd,null);_(this,Cd,null);T(this,gi,e),h(oo,rm)||T(oo,rm,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=T(this,Pa,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=h(this,gi)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",_i,{signal:t}),e.addEventListener("pointerdown",D(oo,C0,UO),{signal:t}));const r=T(this,vi,document.createElement("div"));r.className="buttons",e.append(r);const i=h(this,gi).toolbarPosition;if(i){const{style:s}=e,o=h(this,gi)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return h(this,Pa)}hide(){var e;h(this,Pa).classList.add("hidden"),(e=h(this,Ta))==null||e.hideDropdown()}show(){var e,t;h(this,Pa).classList.remove("hidden"),(e=h(this,nm))==null||e.shown(),(t=h(this,xa))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=h(this,gi),r=document.createElement("button");r.classList.add("basic","deleteButton"),r.tabIndex=0,r.setAttribute("data-l10n-id",h(oo,rm)[e]),D(this,Fn,id).call(this,r)&&r.addEventListener("click",i=>{t.delete()},{signal:t._signal}),h(this,vi).append(r)}async addAltText(e){const t=await e.render();D(this,Fn,id).call(this,t),h(this,vi).append(t,h(this,Fn,Iv)),T(this,nm,e)}addComment(e,t=null){if(h(this,xa))return;const r=e.renderForToolbar();if(!r)return;D(this,Fn,id).call(this,r);const i=T(this,Sd,h(this,Fn,Iv));t?(h(this,vi).insertBefore(r,t),h(this,vi).insertBefore(i,t)):h(this,vi).append(r,i),T(this,xa,e),e.toolbar=this}addColorPicker(e){if(h(this,Ta))return;T(this,Ta,e);const t=e.renderButton();D(this,Fn,id).call(this,t),h(this,vi).append(t,h(this,Fn,Iv))}async addEditSignatureButton(e){const t=T(this,Cd,await e.renderEditButton(h(this,gi)));D(this,Fn,id).call(this,t),h(this,vi).append(t,h(this,Fn,Iv))}removeButton(e){var t,r;switch(e){case"comment":(t=h(this,xa))==null||t.removeToolbarCommentButton(),T(this,xa,null),(r=h(this,Sd))==null||r.remove(),T(this,Sd,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,r){if(!t&&e==="comment")return;const i=h(this,vi).querySelector(r);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){h(this,Cd)&&(h(this,Cd).title=e)}remove(){var e;h(this,Pa).remove(),(e=h(this,Ta))==null||e.destroy(),T(this,Ta,null)}};Pa=new WeakMap,Ta=new WeakMap,gi=new WeakMap,vi=new WeakMap,nm=new WeakMap,xa=new WeakMap,Sd=new WeakMap,Cd=new WeakMap,rm=new WeakMap,C0=new WeakSet,UO=function(e){e.stopPropagation()},Fn=new WeakSet,HO=function(e){h(this,gi)._focusEventsAllowed=!1,Qt(e)},WO=function(e){h(this,gi)._focusEventsAllowed=!0,Qt(e)},id=function(e){const t=h(this,gi)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",D(this,Fn,HO).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",D(this,Fn,WO).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",_i,{signal:t}),!0)},Iv=function(){const e=document.createElement("div");return e.className="divider",e},_(oo,C0),_(oo,rm,null);let TE=oo;var im,cl,lo,$o,qO,VO,xE;class Z5{constructor(e){_(this,$o);_(this,im,null);_(this,cl,null);_(this,lo);T(this,lo,e)}show(e,t,r){const[i,s]=D(this,$o,VO).call(this,t,r),{style:o}=h(this,cl)||T(this,cl,D(this,$o,qO).call(this));e.append(h(this,cl)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){h(this,cl).remove()}}im=new WeakMap,cl=new WeakMap,lo=new WeakMap,$o=new WeakSet,qO=function(){const e=T(this,cl,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=h(this,lo)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",_i,{signal:t});const r=T(this,im,document.createElement("div"));return r.className="buttons",e.append(r),h(this,lo).hasCommentManager()&&D(this,$o,xE).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{h(this,lo).commentSelection("floating_button")}),D(this,$o,xE).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{h(this,lo).highlightSelection("floating_button")}),e},VO=function(e,t){let r=0,i=0;for(const s of e){const o=s.y+s.height;if(o<r)continue;const a=s.x+(t?s.width:0);if(o>r){i=a,r=o;continue}t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,r]},xE=function(e,t,r,i){const s=document.createElement("button");s.classList.add("basic",e),s.tabIndex=0,s.setAttribute("data-l10n-id",t);const o=document.createElement("span");s.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",r);const a=h(this,lo)._signal;a instanceof AbortSignal&&!a.aborted&&(s.addEventListener("contextmenu",_i,{signal:a}),s.addEventListener("click",i,{signal:a})),h(this,im).append(s)};function GO(n,e,t){for(const r of t)e.addEventListener(r,n[r].bind(n))}var ll,ul,bd,dl;const mt=class mt{static initializeAndAddPointerId(e){(h(mt,ul)||T(mt,ul,new Set)).add(e)}static setPointer(e,t){h(mt,ll)||T(mt,ll,t),h(mt,dl)??T(mt,dl,e)}static setTimeStamp(e){T(mt,bd,e)}static isSamePointerId(e){return h(mt,ll)===e}static isSamePointerIdOrRemove(e){var t;return h(mt,ll)===e?!0:((t=h(mt,ul))==null||t.delete(e),!1)}static isSamePointerType(e){return h(mt,dl)===e}static isInitializedAndDifferentPointerType(e){return h(mt,dl)!==null&&!mt.isSamePointerType(e)}static isSameTimeStamp(e){return h(mt,bd)===e}static isUsingMultiplePointers(){var e;return((e=h(mt,ul))==null?void 0:e.size)>=1}static clearPointerType(){T(mt,dl,null)}static clearPointerIds(){T(mt,ll,NaN),T(mt,ul,null)}static clearTimeStamp(){T(mt,bd,NaN)}};ll=new WeakMap,ul=new WeakMap,bd=new WeakMap,dl=new WeakMap,_(mt,ll,NaN),_(mt,ul,null),_(mt,bd,NaN),_(mt,dl,null);let Vn=mt;var b0;class e6{constructor(){_(this,b0,0)}get id(){return`${Jv}${dn(this,b0)._++}`}}b0=new WeakMap;var wd,sm,Gn,Ad,xC;const wP=class wP{constructor(){_(this,Ad);_(this,wd,LO());_(this,sm,0);_(this,Gn,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const s=i.decode().then(()=>(r.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return ze(this,"_isSVGFittingCanvas",s)}async getFromFile(e){const{lastModified:t,name:r,size:i,type:s}=e;return D(this,Ad,xC).call(this,`${t}_${r}_${i}_${s}`,e)}async getFromUrl(e){return D(this,Ad,xC).call(this,e,e)}async getFromBlob(e,t){const r=await t;return D(this,Ad,xC).call(this,e,r)}async getFromId(e){h(this,Gn)||T(this,Gn,new Map);const t=h(this,Gn).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:r}=t;return delete t.blobPromise,this.getFromBlob(t.id,r)}return this.getFromUrl(t.url)}getFromCanvas(e,t){h(this,Gn)||T(this,Gn,new Map);let r=h(this,Gn).get(e);if(r!=null&&r.bitmap)return r.refCounter+=1,r;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),r={bitmap:i.transferToImageBitmap(),id:`image_${h(this,wd)}_${dn(this,sm)._++}`,refCounter:1,isSvg:!1},h(this,Gn).set(e,r),h(this,Gn).set(r.id,r),r}getSvgUrl(e){const t=h(this,Gn).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;h(this,Gn)||T(this,Gn,new Map);const t=h(this,Gn).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:r}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(r.width,r.height);s.getContext("bitmaprenderer").transferFromImageBitmap(r),t.blobPromise=s.convertToBlob()}(i=r.close)==null||i.call(r),t.bitmap=null}isValidId(e){return e.startsWith(`image_${h(this,wd)}_`)}};wd=new WeakMap,sm=new WeakMap,Gn=new WeakMap,Ad=new WeakSet,xC=async function(e,t){h(this,Gn)||T(this,Gn,new Map);let r=h(this,Gn).get(e);if(r===null)return null;if(r!=null&&r.bitmap)return r.refCounter+=1,r;try{r||(r={bitmap:null,id:`image_${h(this,wd)}_${dn(this,sm)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(r.url=t,i=await Jy(t,"blob")):t instanceof File?i=r.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const s=wP._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((u,p)=>{a.onload=()=>{r.bitmap=a,r.isSvg=!0,u()},o.onload=async()=>{const f=r.svgUrl=o.result;a.src=await s?`${f}#svgView(preserveAspectRatio(none))`:f},a.onerror=o.onerror=p});o.readAsDataURL(i),await l}else r.bitmap=await createImageBitmap(i);r.refCounter=1}catch(i){Le(i),r=null}return h(this,Gn).set(e,r),r&&h(this,Gn).set(r.id,r),r};let IE=wP;var tn,Ia,om,Ht;class t6{constructor(e=128){_(this,tn,[]);_(this,Ia,!1);_(this,om);_(this,Ht,-1);T(this,om,e)}add({cmd:e,undo:t,post:r,mustExec:i,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(i&&e(),h(this,Ia))return;const l={cmd:e,undo:t,post:r,type:s};if(h(this,Ht)===-1){h(this,tn).length>0&&(h(this,tn).length=0),T(this,Ht,0),h(this,tn).push(l);return}if(o&&h(this,tn)[h(this,Ht)].type===s){a&&(l.undo=h(this,tn)[h(this,Ht)].undo),h(this,tn)[h(this,Ht)]=l;return}const u=h(this,Ht)+1;u===h(this,om)?h(this,tn).splice(0,1):(T(this,Ht,u),u<h(this,tn).length&&h(this,tn).splice(u)),h(this,tn).push(l)}undo(){if(h(this,Ht)===-1)return;T(this,Ia,!0);const{undo:e,post:t}=h(this,tn)[h(this,Ht)];e(),t==null||t(),T(this,Ia,!1),T(this,Ht,h(this,Ht)-1)}redo(){if(h(this,Ht)<h(this,tn).length-1){T(this,Ht,h(this,Ht)+1),T(this,Ia,!0);const{cmd:e,post:t}=h(this,tn)[h(this,Ht)];e(),t==null||t(),T(this,Ia,!1)}}hasSomethingToUndo(){return h(this,Ht)!==-1}hasSomethingToRedo(){return h(this,Ht)<h(this,tn).length-1}cleanType(e){if(h(this,Ht)!==-1){for(let t=h(this,Ht);t>=0;t--)if(h(this,tn)[t].type!==e){h(this,tn).splice(t+1,h(this,Ht)-t),T(this,Ht,t);return}h(this,tn).length=0,T(this,Ht,-1)}}destroy(){T(this,tn,null)}}tn=new WeakMap,Ia=new WeakMap,om=new WeakMap,Ht=new WeakMap;var w0,KO;class Qy{constructor(e){_(this,w0);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=mn.platform;for(const[r,i,s={}]of e)for(const o of r){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const r=this.callbacks.get(D(this,w0,KO).call(this,t));if(!r)return;const{callback:i,options:{bubbles:s=!1,args:o=[],checker:a=null}}=r;a&&!a(e,t)||(i.bind(e,...o,t)(),s||Qt(t))}}w0=new WeakSet,KO=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const A0=class A0{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return $5(e),ze(this,"_colors",e)}convert(e){const t=Yy(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[r,i]of this._colors)if(i.every((s,o)=>s===t[o]))return A0._colorsMapping.get(r);return t}getHexCode(e){const t=this._colors.get(e);return t?be.makeHexColor(...t):e}};G(A0,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let _E=A0;var Ed,Lr,Rd,Gt,fn,Pd,mi,Td,yi,Kn,_a,ka,xd,Ma,ys,Si,hl,am,cm,Id,lm,Ss,Da,_d,Na,Cs,E0,Oa,kd,um,La,pl,Md,ja,dm,an,pt,uo,za,Fa,hm,Dd,pm,Ba,bs,ho,fm,gm,Ci,Se,IC,kE,$O,JO,_v,XO,YO,QO,ME,ZO,e2,t2,n2,nr,io,r2,i2,DE,s2,kv,NE;const fd=class fd{constructor(e,t,r,i,s,o,a,l,u,p,f,g,m,C,S,w){_(this,Se);_(this,Ed,new AbortController);_(this,Lr,null);_(this,Rd,null);_(this,Gt,new Map);_(this,fn,new Map);_(this,Pd,null);_(this,mi,null);_(this,Td,null);_(this,yi,new t6);_(this,Kn,null);_(this,_a,null);_(this,ka,null);_(this,xd,0);_(this,Ma,new Set);_(this,ys,null);_(this,Si,null);_(this,hl,new Set);G(this,"_editorUndoBar",null);_(this,am,!1);_(this,cm,!1);_(this,Id,!1);_(this,lm,null);_(this,Ss,null);_(this,Da,null);_(this,_d,null);_(this,Na,!1);_(this,Cs,null);_(this,E0,new e6);_(this,Oa,!1);_(this,kd,!1);_(this,um,!1);_(this,La,null);_(this,pl,null);_(this,Md,null);_(this,ja,null);_(this,dm,null);_(this,an,Be.NONE);_(this,pt,new Set);_(this,uo,null);_(this,za,null);_(this,Fa,null);_(this,hm,null);_(this,Dd,null);_(this,pm,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});_(this,Ba,[0,0]);_(this,bs,null);_(this,ho,null);_(this,fm,null);_(this,gm,null);_(this,Ci,null);const b=this._signal=h(this,Ed).signal;T(this,ho,e),T(this,fm,t),T(this,gm,r),T(this,Pd,i),T(this,Kn,s),T(this,za,o),T(this,Dd,l),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:b}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),a._on("setpreference",this.onSetPreference.bind(this),{signal:b}),a._on("switchannotationeditorparams",R=>this.updateParams(R.type,R.value),{signal:b}),window.addEventListener("pointerdown",()=>{T(this,kd,!0)},{capture:!0,signal:b}),window.addEventListener("pointerup",()=>{T(this,kd,!1)},{capture:!0,signal:b}),D(this,Se,XO).call(this),D(this,Se,n2).call(this),D(this,Se,ME).call(this),T(this,mi,l.annotationStorage),T(this,lm,l.filterFactory),T(this,Fa,u),T(this,_d,p||null),T(this,am,f),T(this,cm,g),T(this,Id,m),T(this,dm,C||null),this.viewParameters={realScale:mc.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=w!==!1,s==null||s.setSidebarUiManager(this)}static get _keyboardManager(){const e=fd.prototype,t=o=>h(o,ho).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),r=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return ze(this,"_keyboardManager",new Qy([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],e.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:r}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&h(o,ho).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&h(o,ho).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}destroy(){var e,t,r,i,s,o,a,l,u;(e=h(this,Ci))==null||e.resolve(),T(this,Ci,null),(t=h(this,Ed))==null||t.abort(),T(this,Ed,null),this._signal=null;for(const p of h(this,fn).values())p.destroy();h(this,fn).clear(),h(this,Gt).clear(),h(this,hl).clear(),(r=h(this,ja))==null||r.clear(),T(this,Lr,null),h(this,pt).clear(),h(this,yi).destroy(),(i=h(this,Pd))==null||i.destroy(),(s=h(this,Kn))==null||s.destroy(),(o=h(this,za))==null||o.destroy(),(a=h(this,Cs))==null||a.hide(),T(this,Cs,null),(l=h(this,Md))==null||l.destroy(),T(this,Md,null),T(this,Rd,null),h(this,Ss)&&(clearTimeout(h(this,Ss)),T(this,Ss,null)),h(this,bs)&&(clearTimeout(h(this,bs)),T(this,bs,null)),(u=this._editorUndoBar)==null||u.destroy(),T(this,Dd,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return h(this,dm)}get useNewAltTextFlow(){return h(this,cm)}get useNewAltTextWhenAddingImage(){return h(this,Id)}get hcmFilter(){return ze(this,"hcmFilter",h(this,Fa)?h(this,lm).addHCMFilter(h(this,Fa).foreground,h(this,Fa).background):"none")}get direction(){return ze(this,"direction",getComputedStyle(h(this,ho)).direction)}get _highlightColors(){return ze(this,"_highlightColors",h(this,_d)?new Map(h(this,_d).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return ze(this,"highlightColors",null);const t=new Map,r=!!h(this,Fa);for(const[i,s]of e){const o=i.endsWith("_HCM");if(r&&o){t.set(i.replace("_HCM",""),s);continue}!r&&!o&&t.set(i,s)}return ze(this,"highlightColors",t)}get highlightColorNames(){return ze(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),T(this,ka,e)}setMainHighlightColorPicker(e){T(this,Md,e)}editAltText(e,t=!1){var r;(r=h(this,Pd))==null||r.editAltText(this,e,t)}hasCommentManager(){return!!h(this,Kn)}editComment(e,t,r,i){var s;(s=h(this,Kn))==null||s.showDialog(this,e,t,r,i)}selectComment(e,t){const r=h(this,fn).get(e),i=r==null?void 0:r.getEditorByUID(t);i==null||i.toggleComment(!0,!0)}updateComment(e){var t;(t=h(this,Kn))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=h(this,Kn))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=h(this,Kn))==null||t.removeComments([e.uid])}toggleComment(e,t,r=void 0){var i;(i=h(this,Kn))==null||i.toggleCommentPopup(e,t,r)}makeCommentColor(e,t){var r;return e&&((r=h(this,Kn))==null?void 0:r.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=h(this,Kn))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(h(this,fn).has(e-1))return;const{resolve:t,promise:r}=Promise.withResolvers(),i=s=>{s.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await r}getSignature(e){var t;(t=h(this,za))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return h(this,za)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":T(this,Id,t);break}}onPageChanging({pageNumber:e}){T(this,xd,e-1)}focusMainContainer(){h(this,ho).focus()}findParent(e,t){for(const r of h(this,fn).values()){const{x:i,y:s,width:o,height:a}=r.div.getBoundingClientRect();if(e>=i&&e<=i+o&&t>=s&&t<=s+a)return r}return null}disableUserSelect(e=!1){h(this,fm).classList.toggle("noUserSelect",e)}addShouldRescale(e){h(this,hl).add(e)}removeShouldRescale(e){h(this,hl).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*mc.PDF_TO_CSS_UNITS;for(const r of h(this,hl))r.onScaleChanging();(t=h(this,ka))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const r=document.getSelection();if(!r||r.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:o,focusOffset:a}=r,l=r.toString(),p=D(this,Se,IC).call(this,r).closest(".textLayer"),f=this.getSelectionBoxes(p);if(!f)return;r.empty();const g=D(this,Se,kE).call(this,p),m=h(this,an)===Be.NONE,C=()=>{const S=g==null?void 0:g.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:f,anchorNode:i,anchorOffset:s,focusNode:o,focusOffset:a,text:l});m&&this.showAllEditors("highlight",!0,!0),t&&(S==null||S.editComment())};if(m){this.switchToMode(Be.HIGHLIGHT,C);return}C()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!h(this,mi))return null;const t=`${Jv}${e}`,r=h(this,mi).getRawValue(t);return r&&h(this,mi).remove(t),r}addToAnnotationStorage(e){!e.isEmpty()&&h(this,mi)&&!h(this,mi).has(e.id)&&h(this,mi).setValue(e.id,e)}a11yAlert(e,t=null){const r=h(this,gm);r&&(r.setAttribute("data-l10n-id",e),t?r.setAttribute("data-l10n-args",JSON.stringify(t)):r.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,h(this,Na)&&(T(this,Na,!1),D(this,Se,_v).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of h(this,pt))if(t.div.contains(e)){T(this,pl,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!h(this,pl))return;const[e,t]=h(this,pl);T(this,pl,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){D(this,Se,ME).call(this),this.setEditingState(!0)}removeEditListeners(){D(this,Se,ZO).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const r of h(this,Si))if(r.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const r of h(this,Si))if(r.isHandlingMimeForPasting(t.type)){r.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var r;if(e.preventDefault(),(r=h(this,Lr))==null||r.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of h(this,pt)){const s=i.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const o of h(this,Si))if(o.isHandlingMimeForPasting(s.type)){o.paste(s,this.currentLayer);return}let r=t.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(s){Le(`paste: "${s.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const l of r){const u=await i.deserialize(l);if(!u)return;s.push(u)}const o=()=>{for(const l of s)D(this,Se,DE).call(this,l);D(this,Se,NE).call(this,s)},a=()=>{for(const l of s)l.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(s){Le(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),h(this,an)!==Be.NONE&&!this.isEditorHandlingKeyboard&&fd._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,h(this,Na)&&(T(this,Na,!1),D(this,Se,_v).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(D(this,Se,YO).call(this),D(this,Se,e2).call(this),D(this,Se,nr).call(this,{isEditing:h(this,an)!==Be.NONE,isEmpty:D(this,Se,kv).call(this),hasSomethingToUndo:h(this,yi).hasSomethingToUndo(),hasSomethingToRedo:h(this,yi).hasSomethingToRedo(),hasSelectedEditor:!1})):(D(this,Se,QO).call(this),D(this,Se,t2).call(this),D(this,Se,nr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!h(this,Si)){T(this,Si,e);for(const t of h(this,Si))D(this,Se,io).call(this,t.defaultPropertiesToUpdate)}}getId(){return h(this,E0).id}get currentLayer(){return h(this,fn).get(h(this,xd))}getLayer(e){return h(this,fn).get(e)}get currentPageIndex(){return h(this,xd)}addLayer(e){h(this,fn).set(e.pageIndex,e),h(this,Oa)?e.enable():e.disable()}removeLayer(e){h(this,fn).delete(e.pageIndex)}async updateMode(e,t=null,r=!1,i=!1,s=!1,o=!1){var a,l,u,p,f,g;if(h(this,an)!==e&&!(h(this,Ci)&&(await h(this,Ci).promise,!h(this,Ci)))){if(T(this,Ci,Promise.withResolvers()),(a=h(this,ka))==null||a.commitOrRemove(),h(this,an)===Be.POPUP&&((l=h(this,Kn))==null||l.hideSidebar()),(u=h(this,Kn))==null||u.destroyPopup(),T(this,an,e),e===Be.NONE){this.setEditingState(!1),D(this,Se,i2).call(this);for(const m of h(this,Gt).values())m.hideStandaloneCommentButton();(p=this._editorUndoBar)==null||p.hide(),this.toggleComment(null),h(this,Ci).resolve();return}for(const m of h(this,Gt).values())m.addStandaloneCommentButton();e===Be.SIGNATURE&&await((f=h(this,za))==null?void 0:f.loadSignatures()),r&&Vn.clearPointerType(),this.setEditingState(!0),await D(this,Se,r2).call(this),this.unselectAll();for(const m of h(this,fn).values())m.updateMode(e);if(e===Be.POPUP){h(this,Rd)||T(this,Rd,await h(this,Dd).getAnnotationsByType(new Set(h(this,Si).map(S=>S._editorType))));const m=new Set,C=[];for(const S of h(this,Gt).values()){const{annotationElementId:w,hasComment:b,deleted:R}=S;w&&m.add(w),b&&!R&&C.push(S.getData())}for(const S of h(this,Rd)){const{id:w,popupRef:b,contentsObj:R}=S;b&&(R!=null&&R.str)&&!m.has(w)&&!h(this,Ma).has(w)&&C.push(S)}(g=h(this,Kn))==null||g.showSidebar(C)}if(!t){i&&this.addNewEditorFromKeyboard(),h(this,Ci).resolve();return}for(const m of h(this,Gt).values())m.uid===t?(this.setSelected(m),o?m.editComment():s?m.enterInEditMode():m.focus()):m.unselect();h(this,Ci).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==h(this,an)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(h(this,Si)){switch(e){case nt.CREATE:this.currentLayer.addNewEditor(t);return;case nt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(h(this,hm)||T(this,hm,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const r of h(this,pt))r.updateParams(e,t);else for(const r of h(this,Si))r.updateDefaultParams(e,t)}}showAllEditors(e,t,r=!1){var s;for(const o of h(this,Gt).values())o.editorType===e&&o.show(t);(((s=h(this,hm))==null?void 0:s.get(nt.HIGHLIGHT_SHOW_ALL))??!0)!==t&&D(this,Se,io).call(this,[[nt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(h(this,um)!==e){T(this,um,e);for(const t of h(this,fn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of h(this,Gt).values())t.pageIndex===e&&(yield t)}getEditor(e){return h(this,Gt).get(e)}addEditor(e){h(this,Gt).set(e.id,e)}removeEditor(e){var t,r;e.div.contains(document.activeElement)&&(h(this,Ss)&&clearTimeout(h(this,Ss)),T(this,Ss,setTimeout(()=>{this.focusMainContainer(),T(this,Ss,null)},0))),h(this,Gt).delete(e.id),e.annotationElementId&&((t=h(this,ja))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!h(this,Ma).has(e.annotationElementId))&&((r=h(this,mi))==null||r.remove(e.id))}addDeletedAnnotationElement(e){h(this,Ma).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return h(this,Ma).has(e)}removeDeletedAnnotationElement(e){h(this,Ma).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){h(this,Lr)!==e&&(T(this,Lr,e),e&&D(this,Se,io).call(this,e.propertiesToUpdate))}updateUI(e){h(this,Se,s2)===e&&D(this,Se,io).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){D(this,Se,io).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(h(this,pt).has(e)){h(this,pt).delete(e),e.unselect(),D(this,Se,nr).call(this,{hasSelectedEditor:this.hasSelection});return}h(this,pt).add(e),e.select(),D(this,Se,io).call(this,e.propertiesToUpdate),D(this,Se,nr).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=h(this,ka))==null||t.commitOrRemove();for(const r of h(this,pt))r!==e&&r.unselect();h(this,pt).clear(),h(this,pt).add(e),e.select(),D(this,Se,io).call(this,e.propertiesToUpdate),D(this,Se,nr).call(this,{hasSelectedEditor:!0})}isSelected(e){return h(this,pt).has(e)}get firstSelectedEditor(){return h(this,pt).values().next().value}unselect(e){e.unselect(),h(this,pt).delete(e),D(this,Se,nr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return h(this,pt).size!==0}get isEnterHandled(){return h(this,pt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;h(this,yi).undo(),D(this,Se,nr).call(this,{hasSomethingToUndo:h(this,yi).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:D(this,Se,kv).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){h(this,yi).redo(),D(this,Se,nr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:h(this,yi).hasSomethingToRedo(),isEmpty:D(this,Se,kv).call(this)})}addCommands(e){h(this,yi).add(e),D(this,Se,nr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:D(this,Se,kv).call(this)})}cleanUndoStack(e){h(this,yi).cleanType(e)}delete(){var s;this.commitOrRemove();const e=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...h(this,pt)],r=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},i=()=>{for(const o of t)D(this,Se,DE).call(this,o)};this.addCommands({cmd:r,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=h(this,Lr))==null||e.commitOrRemove()}hasSomethingToControl(){return h(this,Lr)||this.hasSelection}selectAll(){for(const e of h(this,pt))e.commit();D(this,Se,NE).call(this,h(this,Gt).values())}unselectAll(){var e;if(!(h(this,Lr)&&(h(this,Lr).commitOrRemove(),h(this,an)!==Be.NONE))&&!((e=h(this,ka))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of h(this,pt))t.unselect();h(this,pt).clear(),D(this,Se,nr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;h(this,Ba)[0]+=e,h(this,Ba)[1]+=t;const[i,s]=h(this,Ba),o=[...h(this,pt)],a=1e3;h(this,bs)&&clearTimeout(h(this,bs)),T(this,bs,setTimeout(()=>{T(this,bs,null),h(this,Ba)[0]=h(this,Ba)[1]=0,this.addCommands({cmd:()=>{for(const l of o)h(this,Gt).has(l.id)&&(l.translateInPage(i,s),l.translationDone())},undo:()=>{for(const l of o)h(this,Gt).has(l.id)&&(l.translateInPage(-i,-s),l.translationDone())},mustExec:!1})},a));for(const l of o)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),T(this,ys,new Map);for(const e of h(this,pt))h(this,ys).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!h(this,ys))return!1;this.disableUserSelect(!1);const e=h(this,ys);T(this,ys,null);let t=!1;for(const[{x:i,y:s,pageIndex:o},a]of e)a.newX=i,a.newY=s,a.newPageIndex=o,t||(t=i!==a.savedX||s!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const r=(i,s,o,a)=>{if(h(this,Gt).has(i.id)){const l=h(this,fn).get(a);l?i._setParentAndPosition(l,s,o):(i.pageIndex=a,i.x=s,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:o,newPageIndex:a}]of e)r(i,s,o,a)},undo:()=>{for(const[i,{savedX:s,savedY:o,savedPageIndex:a}]of e)r(i,s,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(h(this,ys))for(const r of h(this,ys).keys())r.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||h(this,pt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return h(this,Lr)===e}getActive(){return h(this,Lr)}getMode(){return h(this,an)}isEditingMode(){return h(this,an)!==Be.NONE}get imageManager(){return ze(this,"imageManager",new IE)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,p=t.rangeCount;u<p;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:r,y:i,width:s,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(u,p,f,g)=>({x:(p-i)/o,y:1-(u+f-r)/s,width:g/o,height:f/s});break;case"180":a=(u,p,f,g)=>({x:1-(u+f-r)/s,y:1-(p+g-i)/o,width:f/s,height:g/o});break;case"270":a=(u,p,f,g)=>({x:1-(p+g-i)/o,y:(u-r)/s,width:g/o,height:f/s});break;default:a=(u,p,f,g)=>({x:(u-r)/s,y:(p-i)/o,width:f/s,height:g/o});break}const l=[];for(let u=0,p=t.rangeCount;u<p;u++){const f=t.getRangeAt(u);if(!f.collapsed)for(const{x:g,y:m,width:C,height:S}of f.getClientRects())C===0||S===0||l.push(a(g,m,C,S))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(h(this,Td)||T(this,Td,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=h(this,Td))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=h(this,Td))==null?void 0:i.get(e.data.id);if(!t)return;const r=h(this,mi).getRawValue(t);r&&(h(this,an)===Be.NONE&&!r.hasBeenModified||r.renderAnnotationElement(e))}setMissingCanvas(e,t,r){var s;const i=(s=h(this,ja))==null?void 0:s.get(e);i&&(i.setCanvas(t,r),h(this,ja).delete(e))}addMissingCanvas(e,t){(h(this,ja)||T(this,ja,new Map)).set(e,t)}};Ed=new WeakMap,Lr=new WeakMap,Rd=new WeakMap,Gt=new WeakMap,fn=new WeakMap,Pd=new WeakMap,mi=new WeakMap,Td=new WeakMap,yi=new WeakMap,Kn=new WeakMap,_a=new WeakMap,ka=new WeakMap,xd=new WeakMap,Ma=new WeakMap,ys=new WeakMap,Si=new WeakMap,hl=new WeakMap,am=new WeakMap,cm=new WeakMap,Id=new WeakMap,lm=new WeakMap,Ss=new WeakMap,Da=new WeakMap,_d=new WeakMap,Na=new WeakMap,Cs=new WeakMap,E0=new WeakMap,Oa=new WeakMap,kd=new WeakMap,um=new WeakMap,La=new WeakMap,pl=new WeakMap,Md=new WeakMap,ja=new WeakMap,dm=new WeakMap,an=new WeakMap,pt=new WeakMap,uo=new WeakMap,za=new WeakMap,Fa=new WeakMap,hm=new WeakMap,Dd=new WeakMap,pm=new WeakMap,Ba=new WeakMap,bs=new WeakMap,ho=new WeakMap,fm=new WeakMap,gm=new WeakMap,Ci=new WeakMap,Se=new WeakSet,IC=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},kE=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const r of h(this,fn).values())if(r.hasTextLayer(e))return r;return null},$O=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const r=D(this,Se,IC).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(r);i&&(h(this,Cs)||T(this,Cs,new Z5(this)),h(this,Cs).show(r,i,this.direction==="ltr"))},JO=function(){var s,o,a;const e=document.getSelection();if(!e||e.isCollapsed){h(this,uo)&&((s=h(this,Cs))==null||s.hide(),T(this,uo,null),D(this,Se,nr).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===h(this,uo))return;const i=D(this,Se,IC).call(this,e).closest(".textLayer");if(!i){h(this,uo)&&((o=h(this,Cs))==null||o.hide(),T(this,uo,null),D(this,Se,nr).call(this,{hasSelectedText:!1}));return}if((a=h(this,Cs))==null||a.hide(),T(this,uo,t),D(this,Se,nr).call(this,{hasSelectedText:!0}),!(h(this,an)!==Be.HIGHLIGHT&&h(this,an)!==Be.NONE)&&(h(this,an)===Be.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),T(this,Na,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=h(this,an)===Be.HIGHLIGHT?D(this,Se,kE).call(this,i):null;if(l==null||l.toggleDrawing(),h(this,kd)){const u=new AbortController,p=this.combinedSignal(u),f=g=>{g.type==="pointerup"&&g.button!==0||(u.abort(),l==null||l.toggleDrawing(!0),g.type==="pointerup"&&D(this,Se,_v).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:p}),window.addEventListener("blur",f,{signal:p})}else l==null||l.toggleDrawing(!0),D(this,Se,_v).call(this,"main_toolbar")}},_v=function(e=""){h(this,an)===Be.HIGHLIGHT?this.highlightSelection(e):h(this,am)&&D(this,Se,$O).call(this)},XO=function(){document.addEventListener("selectionchange",D(this,Se,JO).bind(this),{signal:this._signal})},YO=function(){if(h(this,Da))return;T(this,Da,new AbortController);const e=this.combinedSignal(h(this,Da));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},QO=function(){var e;(e=h(this,Da))==null||e.abort(),T(this,Da,null)},ME=function(){if(h(this,La))return;T(this,La,new AbortController);const e=this.combinedSignal(h(this,La));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},ZO=function(){var e;(e=h(this,La))==null||e.abort(),T(this,La,null)},e2=function(){if(h(this,_a))return;T(this,_a,new AbortController);const e=this.combinedSignal(h(this,_a));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},t2=function(){var e;(e=h(this,_a))==null||e.abort(),T(this,_a,null)},n2=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},nr=function(e){Object.entries(e).some(([r,i])=>h(this,pm)[r]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(h(this,pm),e)}),h(this,an)===Be.HIGHLIGHT&&e.hasSelectedEditor===!1&&D(this,Se,io).call(this,[[nt.HIGHLIGHT_FREE,!0]]))},io=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},r2=async function(){if(!h(this,Oa)){T(this,Oa,!0);const e=[];for(const t of h(this,fn).values())e.push(t.enable());await Promise.all(e);for(const t of h(this,Gt).values())t.enable()}},i2=function(){if(this.unselectAll(),h(this,Oa)){T(this,Oa,!1);for(const e of h(this,fn).values())e.disable();for(const e of h(this,Gt).values())e.disable()}},DE=function(e){const t=h(this,fn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},s2=function(){let e=null;for(e of h(this,pt));return e},kv=function(){if(h(this,Gt).size===0)return!0;if(h(this,Gt).size===1)for(const e of h(this,Gt).values())return e.isEmpty();return!1},NE=function(e){for(const t of h(this,pt))t.unselect();h(this,pt).clear();for(const t of e)t.isEmpty()||(h(this,pt).add(t),t.select());D(this,Se,nr).call(this,{hasSelectedEditor:this.hasSelection})},G(fd,"TRANSLATE_SMALL",1),G(fd,"TRANSLATE_BIG",10);let Eu=fd;var bn,ws,Wi,Nd,As,jr,Od,Es,Sr,po,fl,Rs,Ua,ts,Mv,_C;const rr=class rr{constructor(e){_(this,ts);_(this,bn,null);_(this,ws,!1);_(this,Wi,null);_(this,Nd,null);_(this,As,null);_(this,jr,null);_(this,Od,!1);_(this,Es,null);_(this,Sr,null);_(this,po,null);_(this,fl,null);_(this,Rs,!1);T(this,Sr,e),T(this,Rs,e._uiManager.useNewAltTextFlow),h(rr,Ua)||T(rr,Ua,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){rr._l10n??(rr._l10n=e)}async render(){const e=T(this,Wi,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=T(this,Nd,document.createElement("span"));e.append(t),h(this,Rs)?(e.classList.add("new"),e.setAttribute("data-l10n-id",h(rr,Ua).missing),t.setAttribute("data-l10n-id",h(rr,Ua)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=h(this,Sr)._uiManager._signal;e.addEventListener("contextmenu",_i,{signal:r}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),h(this,Sr)._uiManager.editAltText(h(this,Sr)),h(this,Rs)&&h(this,Sr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:h(this,ts,Mv)}})};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(T(this,Od,!0),i(s))},{signal:r}),await D(this,ts,_C).call(this),e}finish(){h(this,Wi)&&(h(this,Wi).focus({focusVisible:h(this,Od)}),T(this,Od,!1))}isEmpty(){return h(this,Rs)?h(this,bn)===null:!h(this,bn)&&!h(this,ws)}hasData(){return h(this,Rs)?h(this,bn)!==null||!!h(this,po):this.isEmpty()}get guessedText(){return h(this,po)}async setGuessedText(e){h(this,bn)===null&&(T(this,po,e),T(this,fl,await rr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),D(this,ts,_C).call(this))}toggleAltTextBadge(e=!1){var t;if(!h(this,Rs)||h(this,bn)){(t=h(this,Es))==null||t.remove(),T(this,Es,null);return}if(!h(this,Es)){const r=T(this,Es,document.createElement("div"));r.className="noAltTextBadge",h(this,Sr).div.append(r)}h(this,Es).classList.toggle("hidden",!e)}serialize(e){let t=h(this,bn);return!e&&h(this,po)===t&&(t=h(this,fl)),{altText:t,decorative:h(this,ws),guessedText:h(this,po),textWithDisclaimer:h(this,fl)}}get data(){return{altText:h(this,bn),decorative:h(this,ws)}}set data({altText:e,decorative:t,guessedText:r,textWithDisclaimer:i,cancel:s=!1}){r&&(T(this,po,r),T(this,fl,i)),!(h(this,bn)===e&&h(this,ws)===t)&&(s||(T(this,bn,e),T(this,ws,t)),D(this,ts,_C).call(this))}toggle(e=!1){h(this,Wi)&&(!e&&h(this,jr)&&(clearTimeout(h(this,jr)),T(this,jr,null)),h(this,Wi).disabled=!e)}shown(){h(this,Sr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:h(this,ts,Mv)}})}destroy(){var e,t;(e=h(this,Wi))==null||e.remove(),T(this,Wi,null),T(this,Nd,null),T(this,As,null),(t=h(this,Es))==null||t.remove(),T(this,Es,null)}};bn=new WeakMap,ws=new WeakMap,Wi=new WeakMap,Nd=new WeakMap,As=new WeakMap,jr=new WeakMap,Od=new WeakMap,Es=new WeakMap,Sr=new WeakMap,po=new WeakMap,fl=new WeakMap,Rs=new WeakMap,Ua=new WeakMap,ts=new WeakSet,Mv=function(){return h(this,bn)&&"added"||h(this,bn)===null&&this.guessedText&&"review"||"missing"},_C=async function(){var i,s,o;const e=h(this,Wi);if(!e)return;if(h(this,Rs)){if(e.classList.toggle("done",!!h(this,bn)),e.setAttribute("data-l10n-id",h(rr,Ua)[h(this,ts,Mv)]),(i=h(this,Nd))==null||i.setAttribute("data-l10n-id",h(rr,Ua)[`${h(this,ts,Mv)}-label`]),!h(this,bn)){(s=h(this,As))==null||s.remove();return}}else{if(!h(this,bn)&&!h(this,ws)){e.classList.remove("done"),(o=h(this,As))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=h(this,As);if(!t){T(this,As,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${h(this,Sr).id}`;const a=100,l=h(this,Sr)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(h(this,jr)),T(this,jr,null)},{once:!0}),e.addEventListener("mouseenter",()=>{T(this,jr,setTimeout(()=>{T(this,jr,null),h(this,As).classList.add("show"),h(this,Sr)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:l}),e.addEventListener("mouseleave",()=>{var u;h(this,jr)&&(clearTimeout(h(this,jr)),T(this,jr,null)),(u=h(this,As))==null||u.classList.remove("show")},{signal:l})}h(this,ws)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=h(this,bn)),t.parentNode||e.append(t);const r=h(this,Sr).getElementForAltText();r==null||r.setAttribute("aria-describedby",t.id)},_(rr,Ua,null),G(rr,"_l10n",null);let c0=rr;var Mn,bi,gl,It,vm,vl,qi,ml,yl,Sl,mm,OE;class fC{constructor(e){_(this,mm);_(this,Mn,null);_(this,bi,null);_(this,gl,!1);_(this,It,null);_(this,vm,null);_(this,vl,null);_(this,qi,null);_(this,ml,null);_(this,yl,!1);_(this,Sl,null);T(this,It,e)}renderForToolbar(){const e=T(this,bi,document.createElement("button"));return e.className="comment",D(this,mm,OE).call(this,e,!1)}renderForStandalone(){const e=T(this,Mn,document.createElement("button"));e.className="annotationCommentButton";const t=h(this,It).commentButtonPosition;if(t){const{style:r}=e;r.insetInlineEnd=`calc(${100*(h(this,It)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,r.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=h(this,It).commentButtonColor;i&&(r.backgroundColor=i)}return D(this,mm,OE).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=h(this,Mn)??h(this,bi))==null||e.focus()},0)}onUpdatedColor(){if(!h(this,Mn))return;const e=h(this,It).commentButtonColor;e&&(h(this,Mn).style.backgroundColor=e),h(this,It)._uiManager.updatePopupColor(h(this,It))}get commentButtonWidth(){var e;return(((e=h(this,Mn))==null?void 0:e.getBoundingClientRect().width)??0)/h(this,It).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(h(this,Sl))return h(this,Sl);if(!h(this,Mn))return null;const{x:e,y:t,height:r}=h(this,Mn).getBoundingClientRect(),{x:i,y:s,width:o,height:a}=h(this,It).parent.boundingClientRect;return[(e-i)/o,(t+r-s)/a]}set commentPopupPositionInLayer(e){T(this,Sl,e)}hasDefaultPopupPosition(){return h(this,Sl)===null}removeStandaloneCommentButton(){var e;(e=h(this,Mn))==null||e.remove(),T(this,Mn,null)}removeToolbarCommentButton(){var e;(e=h(this,bi))==null||e.remove(),T(this,bi,null)}setCommentButtonStates({selected:e,hasPopup:t}){h(this,Mn)&&(h(this,Mn).classList.toggle("selected",e),h(this,Mn).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let r,i;if(t)[r,i]=t;else{[r,i]=h(this,It).commentButtonPosition;const{width:p,height:f,x:g,y:m}=h(this,It);r=g+r*p,i=m+i*f}const s=h(this,It).parent.boundingClientRect,{x:o,y:a,width:l,height:u}=s;h(this,It)._uiManager.editComment(h(this,It),o+r*l,a+i*u,{...e,parentDimensions:s})}finish(){h(this,bi)&&(h(this,bi).focus({focusVisible:h(this,gl)}),T(this,gl,!1))}isDeleted(){return h(this,yl)||h(this,qi)===""}isEmpty(){return h(this,qi)===null}hasBeenEdited(){return this.isDeleted()||h(this,qi)!==h(this,vm)}serialize(){return this.data}get data(){return{text:h(this,qi),richText:h(this,vl),date:h(this,ml),deleted:this.isDeleted()}}set data(e){if(e!==h(this,qi)&&T(this,vl,null),e===null){T(this,qi,""),T(this,yl,!0);return}T(this,qi,e),T(this,ml,new Date),T(this,yl,!1)}setInitialText(e,t=null){T(this,vm,e),this.data=e,T(this,ml,null),T(this,vl,t)}shown(){}destroy(){var e,t;(e=h(this,bi))==null||e.remove(),T(this,bi,null),(t=h(this,Mn))==null||t.remove(),T(this,Mn,null),T(this,qi,""),T(this,vl,null),T(this,ml,null),T(this,It,null),T(this,gl,!1),T(this,yl,!1)}}Mn=new WeakMap,bi=new WeakMap,gl=new WeakMap,It=new WeakMap,vm=new WeakMap,vl=new WeakMap,qi=new WeakMap,ml=new WeakMap,yl=new WeakMap,Sl=new WeakMap,mm=new WeakSet,OE=function(e,t){if(!h(this,It)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[h(this,It)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const r=h(this,It)._uiManager._signal;if(!(r instanceof AbortSignal)||r.aborted)return e;e.addEventListener("contextmenu",_i,{signal:r}),t&&(e.addEventListener("focusin",s=>{h(this,It)._focusEventsAllowed=!1,Qt(s)},{capture:!0,signal:r}),e.addEventListener("focusout",s=>{h(this,It)._focusEventsAllowed=!0,Qt(s)},{capture:!0,signal:r})),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),e===h(this,bi)?this.edit():h(this,It).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(T(this,gl,!0),i(s))},{signal:r}),e.addEventListener("pointerenter",()=>{h(this,It).toggleComment(!1,!0)},{signal:r}),e.addEventListener("pointerleave",()=>{h(this,It).toggleComment(!1,!1)},{signal:r}),e};var Ld,Cl,ym,Sm,Cm,bm,wm,fo,bl,go,wl,vo,yc,o2,a2,c2;const AP=class AP{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:r=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:o=null,signal:a}){_(this,yc);_(this,Ld);_(this,Cl,!1);_(this,ym,null);_(this,Sm);_(this,Cm);_(this,bm);_(this,wm);_(this,fo,null);_(this,bl);_(this,go,null);_(this,wl);_(this,vo,null);T(this,Ld,e),T(this,ym,r),T(this,Sm,t),T(this,Cm,i),T(this,bm,s),T(this,wm,o),T(this,wl,new AbortController),T(this,bl,AbortSignal.any([a,h(this,wl).signal])),e.addEventListener("touchstart",D(this,yc,o2).bind(this),{passive:!1,signal:h(this,bl)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Us.pixelRatio}destroy(){var e,t;(e=h(this,wl))==null||e.abort(),T(this,wl,null),(t=h(this,fo))==null||t.abort(),T(this,fo,null)}};Ld=new WeakMap,Cl=new WeakMap,ym=new WeakMap,Sm=new WeakMap,Cm=new WeakMap,bm=new WeakMap,wm=new WeakMap,fo=new WeakMap,bl=new WeakMap,go=new WeakMap,wl=new WeakMap,vo=new WeakMap,yc=new WeakSet,o2=function(e){var i,s,o;if((i=h(this,Sm))!=null&&i.call(this))return;if(e.touches.length===1){if(h(this,fo))return;const a=T(this,fo,new AbortController),l=AbortSignal.any([h(this,bl),a.signal]),u=h(this,Ld),p={capture:!0,signal:l,passive:!1},f=g=>{var m;g.pointerType==="touch"&&((m=h(this,fo))==null||m.abort(),T(this,fo,null))};u.addEventListener("pointerdown",g=>{g.pointerType==="touch"&&(Qt(g),f(g))},p),u.addEventListener("pointerup",f,p),u.addEventListener("pointercancel",f,p);return}if(!h(this,vo)){T(this,vo,new AbortController);const a=AbortSignal.any([h(this,bl),h(this,vo).signal]),l=h(this,Ld),u={signal:a,capture:!1,passive:!1};l.addEventListener("touchmove",D(this,yc,a2).bind(this),u);const p=D(this,yc,c2).bind(this);l.addEventListener("touchend",p,u),l.addEventListener("touchcancel",p,u),u.capture=!0,l.addEventListener("pointerdown",Qt,u),l.addEventListener("pointermove",Qt,u),l.addEventListener("pointercancel",Qt,u),l.addEventListener("pointerup",Qt,u),(s=h(this,Cm))==null||s.call(this)}if(Qt(e),e.touches.length!==2||(o=h(this,ym))!=null&&o.call(this)){T(this,go,null);return}let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]),T(this,go,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:r.screenX,touch1Y:r.screenY})},a2=function(e){var I;if(!h(this,go)||e.touches.length!==2)return;Qt(e);let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]);const{screenX:i,screenY:s}=t,{screenX:o,screenY:a}=r,l=h(this,go),{touch0X:u,touch0Y:p,touch1X:f,touch1Y:g}=l,m=f-u,C=g-p,S=o-i,w=a-s,b=Math.hypot(S,w)||1,R=Math.hypot(m,C)||1;if(!h(this,Cl)&&Math.abs(R-b)<=AP.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=i,l.touch0Y=s,l.touch1X=o,l.touch1Y=a,!h(this,Cl)){T(this,Cl,!0);return}const P=[(i+o)/2,(s+a)/2];(I=h(this,bm))==null||I.call(this,P,R,b)},c2=function(e){var t;e.touches.length>=2||(h(this,vo)&&(h(this,vo).abort(),T(this,vo,null),(t=h(this,wm))==null||t.call(this)),h(this,go)&&(Qt(e),T(this,go,null),T(this,Cl,!1)))};let l0=AP;var Al,Vi,Lt,At,mo,jd,Ha,Am,Dn,El,yo,wi,Wa,Em,Rl,zr,Rm,Pl,So,Ps,zd,Fd,Ai,Tl,Pm,R0,Ne,LE,Tm,jE,kC,l2,u2,zE,MC,FE,d2,h2,p2,BE,f2,UE,g2,v2,m2,HE,Dv;const Fe=class Fe{constructor(e){_(this,Ne);_(this,Al,null);_(this,Vi,null);_(this,Lt,null);_(this,At,null);_(this,mo,null);_(this,jd,!1);_(this,Ha,null);_(this,Am,"");_(this,Dn,null);_(this,El,null);_(this,yo,null);_(this,wi,null);_(this,Wa,null);_(this,Em,"");_(this,Rl,!1);_(this,zr,null);_(this,Rm,!1);_(this,Pl,!1);_(this,So,!1);_(this,Ps,null);_(this,zd,0);_(this,Fd,0);_(this,Ai,null);_(this,Tl,null);G(this,"isSelected",!1);G(this,"_isCopy",!1);G(this,"_editToolbar",null);G(this,"_initialOptions",Object.create(null));G(this,"_initialData",null);G(this,"_isVisible",!0);G(this,"_uiManager",null);G(this,"_focusEventsAllowed",!0);_(this,Pm,!1);_(this,R0,Fe._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,i],this.pageTranslation=[s,o];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Fe.prototype._resizeWithKeyboard,t=Eu.TRANSLATE_SMALL,r=Eu.TRANSLATE_BIG;return ze(this,"_resizerKeyboardManager",new Qy([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],Fe.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ze(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new n6({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Fe._l10n??(Fe._l10n=e),Fe._l10nResizer||(Fe._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Fe._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);Fe._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Pt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return h(this,Pm)}set _isDraggable(e){var t;T(this,Pm,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=h(this,R0)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(D(this,Ne,Dv).call(this),(t=h(this,wi))==null||t.remove(),T(this,wi,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(h(this,Rl)?T(this,Rl,!1):this.parent.setSelected(this))}focusout(e){var r;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,r,i){const[s,o]=this.parentDimensions;[r,i]=this.screenToPageTranslation(r,i),this.x=(e+r)/s,this.y=(t+i)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[r,i]=this.parentDimensions;this.setAt(e*r,t*i,this.width*r,this.height*i),this._onTranslated()}translate(e,t){D(this,Ne,LE).call(this,this.parentDimensions,e,t)}translateInPage(e,t){h(this,zr)||T(this,zr,[this.x,this.y,this.width,this.height]),D(this,Ne,LE).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){h(this,zr)||T(this,zr,[this.x,this.y,this.width,this.height]);const{div:r,parentDimensions:[i,s]}=this;if(this.x+=e/i,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:g}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,g)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[l,u]=this.getBaseTranslation();o+=l,a+=u;const{style:p}=r;p.left=`${(100*o).toFixed(2)}%`,p.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),r.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!h(this,zr)&&(h(this,zr)[0]!==this.x||h(this,zr)[1]!==this.y)}get _hasBeenResized(){return!!h(this,zr)&&(h(this,zr)[2]!==this.width||h(this,zr)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:r}=Fe,i=r/e,s=r/t;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[r,i]}=this;let{x:s,y:o,width:a,height:l}=this;if(a*=r,l*=i,s*=r,o*=i,this._mustFixPosition)switch(e){case 0:s=cr(s,0,r-a),o=cr(o,0,i-l);break;case 90:s=cr(s,0,r-l),o=cr(o,a,i);break;case 180:s=cr(s,a,r),o=cr(o,l,i);break;case 270:s=cr(s,l,r),o=cr(o,0,i-a);break}this.x=s/=r,this.y=o/=i;const[u,p]=this.getBaseTranslation();s+=u,o+=p,t.left=`${(100*s).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var r;return D(r=Fe,Tm,jE).call(r,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var r;return D(r=Fe,Tm,jE).call(r,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,r]}=this;return[t*e,r*e]}setDims(){const{div:{style:e},width:t,height:r}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*r).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=h(this,Lt))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||h(this,Pl))return this._editToolbar;this._editToolbar=new TE(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,r]of e)await this._editToolbar.addButton(t,r);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=h(this,Lt))==null||t.destroy()}addContainer(e){var r;const t=(r=this._editToolbar)==null?void 0:r.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return h(this,Lt)||(c0.initialize(Fe._l10n),T(this,Lt,new c0(this)),h(this,Al)&&(h(this,Lt).data=h(this,Al),T(this,Al,null))),h(this,Lt)}get altTextData(){var e;return(e=h(this,Lt))==null?void 0:e.data}set altTextData(e){h(this,Lt)&&(h(this,Lt).data=e)}get guessedAltText(){var e;return(e=h(this,Lt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=h(this,Lt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=h(this,Lt))==null?void 0:t.serialize(e)}hasAltText(){return!!h(this,Lt)&&!h(this,Lt).isEmpty()}hasAltTextData(){var e;return((e=h(this,Lt))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=h(this,At))==null||e.focusButton()}addCommentButton(){return this.canAddComment?h(this,At)||T(this,At,new fC(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(h(this,mo)){this._uiManager.isEditingMode()&&h(this,mo).classList.remove("hidden");return}this.hasComment&&(T(this,mo,h(this,At).renderForStandalone()),this.div.append(h(this,mo)))}}removeStandaloneCommentButton(){h(this,At).removeStandaloneCommentButton(),T(this,mo,null)}hideStandaloneCommentButton(){var e;(e=h(this,mo))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:r,deleted:i}}=h(this,At);return{text:t,richText:e,date:r,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){h(this,At)||T(this,At,new fC(this)),h(this,At).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:r}){if(!t||(h(this,At)||T(this,At,new fC(this)),h(this,At).setInitialText(e,r),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return(e=h(this,At))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=h(this,At))==null?void 0:e.isDeleted()}get hasComment(){return!!h(this,At)&&!h(this,At).isEmpty()&&!h(this,At).isDeleted()}async editComment(e){h(this,At)||T(this,At,new fC(this)),h(this,At).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){h(this,At).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[s]=this.pageDimensions,[o]=this.pageTranslation,a=o+s+1,l=i-100,u=a+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[a,l,u,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){h(this,At).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var o;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=h(this,jd)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),D(this,Ne,UE).call(this);const[t,r]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*r/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/r).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),GO(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(h(this,Tl)||T(this,Tl,new l0({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:D(this,Ne,d2).bind(this),onPinching:D(this,Ne,h2).bind(this),onPinchEnd:D(this,Ne,p2).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(o=this._uiManager._editorUndoBar)==null||o.hide(),e}pointerdown(e){const{isMac:t}=mn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(T(this,Rl,!0),this._isDraggable){D(this,Ne,f2).call(this,e);return}D(this,Ne,BE).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){h(this,Ps)&&clearTimeout(h(this,Ps)),T(this,Ps,setTimeout(()=>{var e;T(this,Ps,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,r){e.changeParent(this),this.x=t,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,r=this.rotation){const i=this.parentScale,[s,o]=this.pageDimensions,[a,l]=this.pageTranslation,u=e/i,p=t/i,f=this.x*s,g=this.y*o,m=this.width*s,C=this.height*o;switch(r){case 0:return[f+u+a,o-g-p-C+l,f+u+m+a,o-g-p+l];case 90:return[f+p+a,o-g+u+l,f+p+C+a,o-g+u+m+l];case 180:return[f-u-m+a,o-g+p+l,f-u+a,o-g+p+C+l];case 270:return[f-p-C+a,o-g-u-m+l,f-p+a,o-g-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[r,i,s,o]=e,a=s-r,l=o-i;switch(this.rotation){case 0:return[r,t-o,a,l];case 90:return[r,t-i,l,a];case 180:return[s,t-i,a,l];case 270:return[s,t-o,l,a];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Fe._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=h(this,At))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:r,opacity:i,deleted:s,richText:o},uid:a,pageIndex:l,creationDate:u,modificationDate:p}=this;return{id:a,pageIndex:l,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:u,modificationDate:r||p,popupRef:!s,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),T(this,Pl,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),T(this,Pl,!1),!0):!1}isInEditMode(){return h(this,Pl)}shouldGetKeyboardEvents(){return h(this,So)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:r,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:o}=window;return t<o&&i>0&&e<s&&r>0}rebuild(){D(this,Ne,UE).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var r;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((r=this._initialData)==null?void 0:r.popupRef)||""}}static async deserialize(e,t,r){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:r,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,T(i,Al,e.accessibilityData),i._isCopy=e.isCopy||!1;const[s,o]=i.pageDimensions,[a,l,u,p]=i.getRectInCurrentCoords(e.rect,o);return i.x=a/s,i.y=l/o,i.width=u/s,i.height=p/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,r;if((e=h(this,Wa))==null||e.abort(),T(this,Wa,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),h(this,Ps)&&(clearTimeout(h(this,Ps)),T(this,Ps,null)),D(this,Ne,Dv).call(this),this.removeEditToolbar(),h(this,Ai)){for(const i of h(this,Ai).values())clearTimeout(i);T(this,Ai,null)}this.parent=null,(t=h(this,Tl))==null||t.destroy(),T(this,Tl,null),(r=h(this,wi))==null||r.remove(),T(this,wi,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(D(this,Ne,l2).call(this),h(this,Dn).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[r,i,s,o]=this.getPDFRect();return[Fe._round(r+(s-r)*e),Fe._round(i+(o-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return h(this,At).commentPopupPositionInLayer}set commentPopupPosition(e){h(this,At).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return h(this,At).hasDefaultPopupPosition()}get commentButtonWidth(){return h(this,At).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=h(this,At))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),T(this,yo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=h(this,Dn).children;if(!h(this,Vi)){T(this,Vi,Array.from(t));const o=D(this,Ne,g2).bind(this),a=D(this,Ne,v2).bind(this),l=this._uiManager._signal;for(const u of h(this,Vi)){const p=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:l}),u.addEventListener("blur",a,{signal:l}),u.addEventListener("focus",D(this,Ne,m2).bind(this,p),{signal:l}),u.setAttribute("data-l10n-id",Fe._l10nResizer[p])}}const r=h(this,Vi)[0];let i=0;for(const o of t){if(o===r)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(h(this,Vi).length/4);if(s!==i){if(s<i)for(let a=0;a<i-s;a++)h(this,Dn).append(h(this,Dn).firstElementChild);else if(s>i)for(let a=0;a<s-i;a++)h(this,Dn).firstElementChild.before(h(this,Dn).lastElementChild);let o=0;for(const a of t){const u=h(this,Vi)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",Fe._l10nResizer[u])}}D(this,Ne,HE).call(this,0),T(this,So,!0),h(this,Dn).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){h(this,So)&&D(this,Ne,FE).call(this,h(this,Em),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){D(this,Ne,Dv).call(this),this.div.focus()}select(){var e,t,r;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(t=this._editToolbar)==null||t.show(),(r=h(this,Lt))==null||r.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,r,i,s;this.isSelected&&(this.isSelected=!1,(e=h(this,Dn))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(r=this.div)!=null&&r.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(s=h(this,Lt))==null||s.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return h(this,Rm)}set isEditing(e){T(this,Rm,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){h(this,Ai)||T(this,Ai,new Map);const{action:r}=e;let i=h(this,Ai).get(r);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),h(this,Ai).delete(r),h(this,Ai).size===0&&T(this,Ai,null)},Fe._telemetryTimeout),h(this,Ai).set(r,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),T(this,jd,!1)}disable(){this.div&&(this.div.tabIndex=-1),T(this,jd,!0)}updateFakeAnnotationElement(e){if(!h(this,wi)&&!this.deleted){T(this,wi,e.addFakeAnnotation(this));return}if(this.deleted){h(this,wi).remove(),T(this,wi,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&h(this,wi).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const r=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),r.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Al=new WeakMap,Vi=new WeakMap,Lt=new WeakMap,At=new WeakMap,mo=new WeakMap,jd=new WeakMap,Ha=new WeakMap,Am=new WeakMap,Dn=new WeakMap,El=new WeakMap,yo=new WeakMap,wi=new WeakMap,Wa=new WeakMap,Em=new WeakMap,Rl=new WeakMap,zr=new WeakMap,Rm=new WeakMap,Pl=new WeakMap,So=new WeakMap,Ps=new WeakMap,zd=new WeakMap,Fd=new WeakMap,Ai=new WeakMap,Tl=new WeakMap,Pm=new WeakMap,R0=new WeakMap,Ne=new WeakSet,LE=function([e,t],r,i){[r,i]=this.screenToPageTranslation(r,i),this.x+=r/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Tm=new WeakSet,jE=function(e,t,r){switch(r){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},kC=function(e){switch(e){case 90:{const[t,r]=this.pageDimensions;return[0,-t/r,r/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,r]=this.pageDimensions;return[0,t/r,-r/t,0]}default:return[1,0,0,1]}},l2=function(){if(h(this,Dn))return;T(this,Dn,document.createElement("div")),h(this,Dn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const r of e){const i=document.createElement("div");h(this,Dn).append(i),i.classList.add("resizer",r),i.setAttribute("data-resizer-name",r),i.addEventListener("pointerdown",D(this,Ne,u2).bind(this,r),{signal:t}),i.addEventListener("contextmenu",_i,{signal:t}),i.tabIndex=-1}this.div.prepend(h(this,Dn))},u2=function(e,t){var p;t.preventDefault();const{isMac:r}=mn.platform;if(t.button!==0||t.ctrlKey&&r)return;(p=h(this,Lt))==null||p.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,T(this,El,[t.screenX,t.screenY]);const s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",D(this,Ne,FE).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Qt,{passive:!1,signal:o}),window.addEventListener("contextmenu",_i,{signal:o}),T(this,yo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var f;s.abort(),this.parent.togglePointerEvents(!0),(f=h(this,Lt))==null||f.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=a,this.div.style.cursor=l,D(this,Ne,MC).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},zE=function(e,t,r,i){this.width=r,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},MC=function(){if(!h(this,yo))return;const{savedX:e,savedY:t,savedWidth:r,savedHeight:i}=h(this,yo);T(this,yo,null);const s=this.x,o=this.y,a=this.width,l=this.height;s===e&&o===t&&a===r&&l===i||this.addCommands({cmd:D(this,Ne,zE).bind(this,s,o,a,l),undo:D(this,Ne,zE).bind(this,e,t,r,i),mustExec:!0})},FE=function(e,t){const[r,i]=this.parentDimensions,s=this.x,o=this.y,a=this.width,l=this.height,u=Fe.MIN_SIZE/r,p=Fe.MIN_SIZE/i,f=D(this,Ne,kC).call(this,this.rotation),g=(ne,Q)=>[f[0]*ne+f[2]*Q,f[1]*ne+f[3]*Q],m=D(this,Ne,kC).call(this,360-this.rotation),C=(ne,Q)=>[m[0]*ne+m[2]*Q,m[1]*ne+m[3]*Q];let S,w,b=!1,R=!1;switch(e){case"topLeft":b=!0,S=(ne,Q)=>[0,0],w=(ne,Q)=>[ne,Q];break;case"topMiddle":S=(ne,Q)=>[ne/2,0],w=(ne,Q)=>[ne/2,Q];break;case"topRight":b=!0,S=(ne,Q)=>[ne,0],w=(ne,Q)=>[0,Q];break;case"middleRight":R=!0,S=(ne,Q)=>[ne,Q/2],w=(ne,Q)=>[0,Q/2];break;case"bottomRight":b=!0,S=(ne,Q)=>[ne,Q],w=(ne,Q)=>[0,0];break;case"bottomMiddle":S=(ne,Q)=>[ne/2,Q],w=(ne,Q)=>[ne/2,0];break;case"bottomLeft":b=!0,S=(ne,Q)=>[0,Q],w=(ne,Q)=>[ne,0];break;case"middleLeft":R=!0,S=(ne,Q)=>[0,Q/2],w=(ne,Q)=>[ne,Q/2];break}const P=S(a,l),I=w(a,l);let M=g(...I);const k=Fe._round(s+M[0]),O=Fe._round(o+M[1]);let L=1,F=1,H,V;if(t.fromKeyboard)({deltaX:H,deltaY:V}=t);else{const{screenX:ne,screenY:Q}=t,[K,oe]=h(this,El);[H,V]=this.screenToPageTranslation(ne-K,Q-oe),h(this,El)[0]=ne,h(this,El)[1]=Q}if([H,V]=C(H/r,V/i),b){const ne=Math.hypot(a,l);L=F=Math.max(Math.min(Math.hypot(I[0]-P[0]-H,I[1]-P[1]-V)/ne,1/a,1/l),u/a,p/l)}else R?L=cr(Math.abs(I[0]-P[0]-H),u,1)/a:F=cr(Math.abs(I[1]-P[1]-V),p,1)/l;const ie=Fe._round(a*L),J=Fe._round(l*F);M=g(...w(ie,J));const ee=k-M[0],se=O-M[1];h(this,zr)||T(this,zr,[this.x,this.y,this.width,this.height]),this.width=ie,this.height=J,this.x=ee,this.y=se,this.setDims(),this.fixAndSetPosition(),this._onResizing()},d2=function(){var e;T(this,yo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=h(this,Lt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},h2=function(e,t,r){let s=.7*(r/t)+1-.7;if(s===1)return;const o=D(this,Ne,kC).call(this,this.rotation),a=(k,O)=>[o[0]*k+o[2]*O,o[1]*k+o[3]*O],[l,u]=this.parentDimensions,p=this.x,f=this.y,g=this.width,m=this.height,C=Fe.MIN_SIZE/l,S=Fe.MIN_SIZE/u;s=Math.max(Math.min(s,1/g,1/m),C/g,S/m);const w=Fe._round(g*s),b=Fe._round(m*s);if(w===g&&b===m)return;h(this,zr)||T(this,zr,[p,f,g,m]);const R=a(g/2,m/2),P=Fe._round(p+R[0]),I=Fe._round(f+R[1]),M=a(w/2,b/2);this.x=P-M[0],this.y=I-M[1],this.width=w,this.height=b,this.setDims(),this.fixAndSetPosition(),this._onResizing()},p2=function(){var e;(e=h(this,Lt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),D(this,Ne,MC).call(this)},BE=function(e){const{isMac:t}=mn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},f2=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let r=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:s},a=u=>{i.abort(),T(this,Ha,null),T(this,Rl,!1),this._uiManager.endDragSession()||D(this,Ne,BE).call(this,u),r&&this._onStopDragging()};t&&(T(this,zd,e.clientX),T(this,Fd,e.clientY),T(this,Ha,e.pointerId),T(this,Am,e.pointerType),window.addEventListener("pointermove",u=>{r||(r=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:f,pointerId:g}=u;if(g!==h(this,Ha)){Qt(u);return}const[m,C]=this.screenToPageTranslation(p-h(this,zd),f-h(this,Fd));T(this,zd,p),T(this,Fd,f),this._uiManager.dragSelectedEditors(m,C)},o),window.addEventListener("touchmove",Qt,o),window.addEventListener("pointerdown",u=>{u.pointerType===h(this,Am)&&(h(this,Tl)||u.isPrimary)&&a(u),Qt(u)},o));const l=u=>{if(!h(this,Ha)||h(this,Ha)===u.pointerId){a(u);return}Qt(u)};window.addEventListener("pointerup",l,{signal:s}),window.addEventListener("blur",l,{signal:s})},UE=function(){if(h(this,Wa)||!this.div)return;T(this,Wa,new AbortController);const e=this._uiManager.combinedSignal(h(this,Wa));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},g2=function(e){Fe._resizerKeyboardManager.exec(this,e)},v2=function(e){var t;h(this,So)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==h(this,Dn)&&D(this,Ne,Dv).call(this)},m2=function(e){T(this,Em,h(this,So)?e:"")},HE=function(e){if(h(this,Vi))for(const t of h(this,Vi))t.tabIndex=e},Dv=function(){T(this,So,!1),D(this,Ne,HE).call(this,-1),D(this,Ne,MC).call(this)},_(Fe,Tm),G(Fe,"_l10n",null),G(Fe,"_l10nResizer",null),G(Fe,"_borderLineWidth",-1),G(Fe,"_colorManager",new _E),G(Fe,"_zIndex",1),G(Fe,"_telemetryTimeout",1e3);let _t=Fe;class n6 extends _t{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const mD=3285377520,pi=4294901760,vs=65535;class y2{constructor(e){this.h1=e?e&4294967295:mD,this.h2=e?e&4294967295:mD}update(e){let t,r;if(typeof e=="string"){t=new Uint8Array(e.length*2),r=0;for(let S=0,w=e.length;S<w;S++){const b=e.charCodeAt(S);b<=255?t[r++]=b:(t[r++]=b>>>8,t[r++]=b&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),r=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=r>>2,s=r-i*4,o=new Uint32Array(t.buffer,0,i);let a=0,l=0,u=this.h1,p=this.h2;const f=3432918353,g=461845907,m=f&vs,C=g&vs;for(let S=0;S<i;S++)S&1?(a=o[S],a=a*f&pi|a*m&vs,a=a<<15|a>>>17,a=a*g&pi|a*C&vs,u^=a,u=u<<13|u>>>19,u=u*5+3864292196):(l=o[S],l=l*f&pi|l*m&vs,l=l<<15|l>>>17,l=l*g&pi|l*C&vs,p^=l,p=p<<13|p>>>19,p=p*5+3864292196);switch(a=0,s){case 3:a^=t[i*4+2]<<16;case 2:a^=t[i*4+1]<<8;case 1:a^=t[i*4],a=a*f&pi|a*m&vs,a=a<<15|a>>>17,a=a*g&pi|a*C&vs,i&1?u^=a:p^=a}this.h1=u,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&pi|e*36045&vs,t=t*4283543511&pi|((t<<16|e>>>16)*2950163797&pi)>>>16,e^=t>>>1,e=e*444984403&pi|e*60499&vs,t=t*3301882366&pi|((t<<16|e>>>16)*3120437893&pi)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const WE=Object.freeze({map:null,hash:"",transfer:void 0});var xl,Il,Co,Nn,P0,S2;class hP{constructor(){_(this,P0);_(this,xl,!1);_(this,Il,null);_(this,Co,null);_(this,Nn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const r=h(this,Nn).get(e);return r===void 0?t:Object.assign(t,r)}getRawValue(e){return h(this,Nn).get(e)}remove(e){const t=h(this,Nn).get(e);if(t!==void 0&&(t instanceof _t&&h(this,Co).delete(t.annotationElementId),h(this,Nn).delete(e),h(this,Nn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const r of h(this,Nn).values())if(r instanceof _t)return;this.onAnnotationEditor(null)}}setValue(e,t){const r=h(this,Nn).get(e);let i=!1;if(r!==void 0)for(const[s,o]of Object.entries(t))r[s]!==o&&(i=!0,r[s]=o);else i=!0,h(this,Nn).set(e,t);i&&D(this,P0,S2).call(this),t instanceof _t&&((h(this,Co)||T(this,Co,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return h(this,Nn).has(e)}get size(){return h(this,Nn).size}resetModified(){h(this,xl)&&(T(this,xl,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new C2(this)}get serializable(){if(h(this,Nn).size===0)return WE;const e=new Map,t=new y2,r=[],i=Object.create(null);let s=!1;for(const[o,a]of h(this,Nn)){const l=a instanceof _t?a.serialize(!1,i):a;l&&(e.set(o,l),t.update(`${o}:${JSON.stringify(l)}`),s||(s=!!l.bitmap))}if(s)for(const o of e.values())o.bitmap&&r.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:r}:WE}get editorStats(){let e=null;const t=new Map;let r=0,i=0;for(const s of h(this,Nn).values()){if(!(s instanceof _t)){s.popup&&(s.popup.deleted?i+=1:r+=1);continue}s.isCommentDeleted?i+=1:s.hasEditedComment&&(r+=1);const o=s.telemetryFinalData;if(!o)continue;const{type:a}=o;t.has(a)||t.set(a,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const l=e[a]||(e[a]=new Map);for(const[u,p]of Object.entries(o)){if(u==="type")continue;let f=l.get(u);f||(f=new Map,l.set(u,f));const g=f.get(p)??0;f.set(p,g+1)}}if((i>0||r>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:r}),!e)return null;for(const[s,o]of t)e[s]=o.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){T(this,Il,null)}updateEditor(e,t){var i;const r=(i=h(this,Co))==null?void 0:i.get(e);return r?(r.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=h(this,Co))==null?void 0:t.get(e))||null}get modifiedIds(){if(h(this,Il))return h(this,Il);const e=[];if(h(this,Co))for(const t of h(this,Co).values())t.serialize()&&e.push(t.annotationElementId);return T(this,Il,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return h(this,Nn).entries()}}xl=new WeakMap,Il=new WeakMap,Co=new WeakMap,Nn=new WeakMap,P0=new WeakSet,S2=function(){h(this,xl)||(T(this,xl,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var xm;class C2 extends hP{constructor(t){super();_(this,xm);const{map:r,hash:i,transfer:s}=t.serializable,o=structuredClone(r,s?{transfer:s}:null);T(this,xm,{map:o,hash:i,transfer:s})}get print(){Pt("Should not call PrintAnnotationStorage.print")}get serializable(){return h(this,xm)}get modifiedIds(){return ze(this,"modifiedIds",{ids:new Set,hash:""})}}xm=new WeakMap;var Bd;class r6{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){_(this,Bd,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),h(this,Bd).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:r}){if(!(!e||h(this,Bd).has(e.loadedName))){if(rt(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:o}=e,a=new FontFace(i,s,o);this.addNativeFontFace(a);try{await a.load(),h(this,Bd).add(i),r==null||r(e)}catch{Le(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Pt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw Le(`Failed to load font '${r.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const i=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ze(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return ze(this,"isSyncFontLoadingSupported",ar||mn.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(rt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.length>0&&r[0].done;){const s=r.shift();setTimeout(s.callback,0)}}const{loadingRequests:r}=this,i={done:!1,complete:t,callback:e};return r.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ze(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function r(I,M){return I.charCodeAt(M)<<24|I.charCodeAt(M+1)<<16|I.charCodeAt(M+2)<<8|I.charCodeAt(M+3)&255}function i(I,M,k,O){const L=I.substring(0,M),F=I.substring(M+k);return L+O+F}let s,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let u=0;function p(I,M){if(++u>30){Le("Load test font never loaded."),M();return}if(l.font="30px "+I,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){M();return}setTimeout(p.bind(null,I,M))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let g=this._loadTestFont;g=i(g,976,f.length,f);const C=16,S=1482184792;let w=r(g,C);for(s=0,o=f.length-3;s<o;s+=4)w=w-S+r(f,s)|0;s<f.length&&(w=w-S+r(f+"XXX",s)|0),g=i(g,C,4,j5(w));const b=`url(data:font/opentype;base64,${btoa(g)});`,R=`@font-face {font-family:"${f}";src:${b}}`;this.insertRule(R);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const I of[e.loadedName,f]){const M=this._document.createElement("span");M.textContent="Hi",M.style.fontFamily=I,P.append(M)}this._document.body.append(P),p(f,()=>{P.remove(),t.complete()})}}Bd=new WeakMap;var yt;class i6{constructor(e,t=null,r,i){_(this,yt);this.compiledGlyphs=Object.create(null),T(this,yt,e),this._inspectFont=t,r&&Object.assign(this,r),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var r;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${jO(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(r=this._inspectFont)==null||r.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const r=this.loadedName+"_path_"+t;let i;try{i=e.get(r)}catch(o){Le(`getPathGenerator - ignoring character: "${o}".`)}const s=BO(i==null?void 0:i.path);return this.fontExtraProperties||e.delete(r),this.compiledGlyphs[t]=s}get black(){return h(this,yt).black}get bold(){return h(this,yt).bold}get disableFontFace(){return h(this,yt).disableFontFace??!1}set disableFontFace(e){ze(this,"disableFontFace",!!e)}get fontExtraProperties(){return h(this,yt).fontExtraProperties??!1}get isInvalidPDFjsFont(){return h(this,yt).isInvalidPDFjsFont}get isType3Font(){return h(this,yt).isType3Font}get italic(){return h(this,yt).italic}get missingFile(){return h(this,yt).missingFile}get remeasure(){return h(this,yt).remeasure}get vertical(){return h(this,yt).vertical}get ascent(){return h(this,yt).ascent}get defaultWidth(){return h(this,yt).defaultWidth}get descent(){return h(this,yt).descent}get bbox(){return h(this,yt).bbox}set bbox(e){ze(this,"bbox",e)}get fontMatrix(){return h(this,yt).fontMatrix}get fallbackName(){return h(this,yt).fallbackName}get loadedName(){return h(this,yt).loadedName}get mimetype(){return h(this,yt).mimetype}get name(){return h(this,yt).name}get data(){return h(this,yt).data}clearData(){h(this,yt).clearData()}get cssFontInfo(){return h(this,yt).cssFontInfo}get systemFontInfo(){return h(this,yt).systemFontInfo}get defaultVMetrics(){return h(this,yt).defaultVMetrics}}yt=new WeakMap;var Ud,Hd,Im,Wd,DC;const gd=class gd{constructor(e){_(this,Wd);_(this,Ud);_(this,Hd);_(this,Im);T(this,Ud,e),T(this,Hd,new DataView(h(this,Ud))),T(this,Im,new TextDecoder)}static write(e){const t=new TextEncoder,r={};let i=0;for(const u of gd.strings){const p=t.encode(e[u]);r[u]=p,i+=4+p.length}const s=new ArrayBuffer(i),o=new Uint8Array(s),a=new DataView(s);let l=0;for(const u of gd.strings){const p=r[u],f=p.length;a.setUint32(l,f),o.set(p,l+4),l+=4+f}return rt(l===s.byteLength,"CssFontInfo.write: Buffer overflow"),s}get fontFamily(){return D(this,Wd,DC).call(this,0)}get fontWeight(){return D(this,Wd,DC).call(this,1)}get italicAngle(){return D(this,Wd,DC).call(this,2)}};Ud=new WeakMap,Hd=new WeakMap,Im=new WeakMap,Wd=new WeakSet,DC=function(e){rt(e<gd.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=h(this,Hd).getUint32(t)+4;const r=h(this,Hd).getUint32(t);return h(this,Im).decode(new Uint8Array(h(this,Ud),t+4,r))},G(gd,"strings",["fontFamily","fontWeight","italicAngle"]);let u0=gd;var qa,Ts,_l,kl,Nv;const vd=class vd{constructor(e){_(this,kl);_(this,qa);_(this,Ts);_(this,_l);T(this,qa,e),T(this,Ts,new DataView(h(this,qa))),T(this,_l,new TextDecoder)}static write(e){const t=new TextEncoder,r={};let i=0;for(const g of vd.strings){const m=t.encode(e[g]);r[g]=m,i+=4+m.length}i+=4;let s,o,a=1+i;e.style&&(s=t.encode(e.style.style),o=t.encode(e.style.weight),a+=4+s.length+4+o.length);const l=new ArrayBuffer(a),u=new Uint8Array(l),p=new DataView(l);let f=0;p.setUint8(f++,e.guessFallback?1:0),p.setUint32(f,0),f+=4,i=0;for(const g of vd.strings){const m=r[g],C=m.length;i+=4+C,p.setUint32(f,C),u.set(m,f+4),f+=4+C}return p.setUint32(f-i-4,i),e.style&&(p.setUint32(f,s.length),u.set(s,f+4),f+=4+s.length,p.setUint32(f,o.length),u.set(o,f+4),f+=4+o.length),rt(f<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(f)}get guessFallback(){return h(this,Ts).getUint8(0)!==0}get css(){return D(this,kl,Nv).call(this,0)}get loadedName(){return D(this,kl,Nv).call(this,1)}get baseFontName(){return D(this,kl,Nv).call(this,2)}get src(){return D(this,kl,Nv).call(this,3)}get style(){let e=1;e+=4+h(this,Ts).getUint32(e);const t=h(this,Ts).getUint32(e),r=h(this,_l).decode(new Uint8Array(h(this,qa),e+4,t));e+=4+t;const i=h(this,Ts).getUint32(e),s=h(this,_l).decode(new Uint8Array(h(this,qa),e+4,i));return{style:r,weight:s}}};qa=new WeakMap,Ts=new WeakMap,_l=new WeakMap,kl=new WeakSet,Nv=function(e){rt(e<vd.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=h(this,Ts).getUint32(t)+4;const r=h(this,Ts).getUint32(t);return h(this,_l).decode(new Uint8Array(h(this,qa),t+4,r))},G(vd,"strings",["css","loadedName","baseFontName","src"]);let d0=vd;var qd,Vd,Gd,Kd,Fr,xs,_m,St,Yt,Ui,NC,Ov;const Ue=class Ue{constructor({data:e,extra:t}){_(this,Yt);_(this,xs);_(this,_m);_(this,St);T(this,xs,e),T(this,_m,new TextDecoder),T(this,St,new DataView(h(this,xs))),t&&Object.assign(this,t)}get black(){return D(this,Yt,Ui).call(this,0)}get bold(){return D(this,Yt,Ui).call(this,1)}get disableFontFace(){return D(this,Yt,Ui).call(this,2)}get fontExtraProperties(){return D(this,Yt,Ui).call(this,3)}get isInvalidPDFjsFont(){return D(this,Yt,Ui).call(this,4)}get isType3Font(){return D(this,Yt,Ui).call(this,5)}get italic(){return D(this,Yt,Ui).call(this,6)}get missingFile(){return D(this,Yt,Ui).call(this,7)}get remeasure(){return D(this,Yt,Ui).call(this,8)}get vertical(){return D(this,Yt,Ui).call(this,9)}get ascent(){return D(this,Yt,NC).call(this,0)}get defaultWidth(){return D(this,Yt,NC).call(this,1)}get descent(){return D(this,Yt,NC).call(this,2)}get bbox(){let e=h(Ue,Vd);if(h(this,St).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<4;i++)r.push(h(this,St).getInt16(e,!0)),e+=2;return r}get fontMatrix(){let e=h(Ue,Gd);if(h(this,St).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<6;i++)r.push(h(this,St).getFloat64(e,!0)),e+=8;return r}get defaultVMetrics(){let e=h(Ue,Kd);if(h(this,St).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<3;i++)r.push(h(this,St).getInt16(e,!0)),e+=2;return r}get fallbackName(){return D(this,Yt,Ov).call(this,0)}get loadedName(){return D(this,Yt,Ov).call(this,1)}get mimetype(){return D(this,Yt,Ov).call(this,2)}get name(){return D(this,Yt,Ov).call(this,3)}get data(){let e=h(Ue,Fr);const t=h(this,St).getUint32(e);e+=4+t;const r=h(this,St).getUint32(e);e+=4+r;const i=h(this,St).getUint32(e);e+=4+i;const s=h(this,St).getUint32(e);if(s!==0)return new Uint8Array(h(this,xs),e+4,s)}clearData(){let e=h(Ue,Fr);const t=h(this,St).getUint32(e);e+=4+t;const r=h(this,St).getUint32(e);e+=4+r;const i=h(this,St).getUint32(e);e+=4+i;const s=h(this,St).getUint32(e);new Uint8Array(h(this,xs),e+4,s).fill(0),h(this,St).setUint32(e,0)}get cssFontInfo(){let e=h(Ue,Fr);const t=h(this,St).getUint32(e);e+=4+t;const r=h(this,St).getUint32(e);e+=4+r;const i=h(this,St).getUint32(e);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(h(this,xs),e+4,i)),new u0(s.buffer)}get systemFontInfo(){let e=h(Ue,Fr);const t=h(this,St).getUint32(e);e+=4+t;const r=h(this,St).getUint32(e);if(r===0)return null;const i=new Uint8Array(r);return i.set(new Uint8Array(h(this,xs),e+4,r)),new d0(i.buffer)}static write(e){const t=e.systemFontInfo?d0.write(e.systemFontInfo):null,r=e.cssFontInfo?u0.write(e.cssFontInfo):null,i=new TextEncoder,s={};let o=0;for(const S of Ue.strings)s[S]=i.encode(e[S]),o+=4+s[S].length;const a=h(Ue,Fr)+4+o+4+(t?t.byteLength:0)+4+(r?r.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(a),u=new Uint8Array(l),p=new DataView(l);let f=0;const g=Ue.bools.length;let m=0,C=0;for(let S=0;S<g;S++){const w=e[Ue.bools[S]];m|=(w===void 0?0:w?2:1)<<C,C+=2,(C===8||S===g-1)&&(p.setUint8(f++,m),m=0,C=0)}rt(f===h(Ue,qd),"FontInfo.write: Boolean properties offset mismatch");for(const S of Ue.numbers)p.setFloat64(f,e[S]),f+=8;if(rt(f===h(Ue,Vd),"FontInfo.write: Number properties offset mismatch"),e.bbox){p.setUint8(f++,4);for(const S of e.bbox)p.setInt16(f,S,!0),f+=2}else p.setUint8(f++,0),f+=8;if(rt(f===h(Ue,Gd),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){p.setUint8(f++,6);for(const S of e.fontMatrix)p.setFloat64(f,S,!0),f+=8}else p.setUint8(f++,0),f+=48;if(rt(f===h(Ue,Kd),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){p.setUint8(f++,1);for(const S of e.defaultVMetrics)p.setInt16(f,S,!0),f+=2}else p.setUint8(f++,0),f+=6;rt(f===h(Ue,Fr),"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(h(Ue,Fr),0),f+=4;for(const S of Ue.strings){const w=s[S],b=w.length;p.setUint32(f,b),u.set(w,f+4),f+=4+b}if(p.setUint32(h(Ue,Fr),f-h(Ue,Fr)-4),!t)p.setUint32(f,0),f+=4;else{const S=t.byteLength;p.setUint32(f,S),rt(f+4+S<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(t),f+4),f+=4+S}if(!r)p.setUint32(f,0),f+=4;else{const S=r.byteLength;p.setUint32(f,S),rt(f+4+S<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(r),f+4),f+=4+S}return e.data===void 0?(p.setUint32(f,0),f+=4):(p.setUint32(f,e.data.length),u.set(e.data,f+4),f+=4+e.data.length),rt(f<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(f)}};qd=new WeakMap,Vd=new WeakMap,Gd=new WeakMap,Kd=new WeakMap,Fr=new WeakMap,xs=new WeakMap,_m=new WeakMap,St=new WeakMap,Yt=new WeakSet,Ui=function(e){rt(e<Ue.bools.length,"Invalid boolean index");const t=Math.floor(e/4),r=e*2%8,i=h(this,St).getUint8(t)>>r&3;return i===0?void 0:i===2},NC=function(e){return rt(e<Ue.numbers.length,"Invalid number index"),h(this,St).getFloat64(h(Ue,qd)+e*8)},Ov=function(e){rt(e<Ue.strings.length,"Invalid string index");let t=h(Ue,Fr)+4;for(let s=0;s<e;s++)t+=h(this,St).getUint32(t)+4;const r=h(this,St).getUint32(t),i=new Uint8Array(r);return i.set(new Uint8Array(h(this,xs),t+4,r)),h(this,_m).decode(i)},G(Ue,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),G(Ue,"numbers",["ascent","defaultWidth","descent"]),G(Ue,"strings",["fallbackName","loadedName","mimetype","name"]),_(Ue,qd,Math.ceil(Ue.bools.length*2/8)),_(Ue,Vd,h(Ue,qd)+Ue.numbers.length*8),_(Ue,Gd,h(Ue,Vd)+1+8),_(Ue,Kd,h(Ue,Gd)+1+48),_(Ue,Fr,h(Ue,Kd)+1+6);let qE=Ue;var km,Mm,Dm,Nm,Om,Lm,jm,zm;const xt=class xt{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,r=null,i=[],s=[],o=[],a=[],l=null,u=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,r=e[2],o=e[3],t===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,l=e[1],i=e[2],s=e[3],a=e[4]||[],r=e[6],u=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const p=Math.floor(i.length/2),f=Math.floor(s.length/3),g=o.length,m=a.length;let C=0;for(const M of a)C+=1,C=Math.ceil(C/4)*4,C+=4+M.coords.length*4,C+=4+M.colors.length*4,M.verticesPerRow!==void 0&&(C+=4);const S=20+p*8+f*3+g*8+(r?16:0)+(u?3:0)+C,w=new ArrayBuffer(S),b=new DataView(w),R=new Uint8Array(w);b.setUint8(h(xt,km),t),b.setUint8(h(xt,Mm),r?1:0),b.setUint8(h(xt,Dm),u?1:0),b.setUint8(h(xt,Nm),l),b.setUint32(h(xt,Om),p,!0),b.setUint32(h(xt,Lm),f,!0),b.setUint32(h(xt,jm),g,!0),b.setUint32(h(xt,zm),m,!0);let P=20;new Float32Array(w,P,p*2).set(i),P+=p*8,R.set(s,P),P+=f*3;for(const[M,k]of o)b.setFloat32(P,M,!0),P+=4,b.setUint32(P,parseInt(k.slice(1),16),!0),P+=4;if(r)for(const M of r)b.setFloat32(P,M,!0),P+=4;u&&(R.set(u,P),P+=3);for(let M=0;M<a.length;M++){const k=a[M];b.setUint8(P,k.type),P+=1,P=Math.ceil(P/4)*4,b.setUint32(P,k.coords.length,!0),P+=4,new Int32Array(w,P,k.coords.length).set(k.coords),P+=k.coords.length*4,b.setUint32(P,k.colors.length,!0),P+=4,new Int32Array(w,P,k.colors.length).set(k.colors),P+=k.colors.length*4,k.verticesPerRow!==void 0&&(b.setUint32(P,k.verticesPerRow,!0),P+=4)}return w}getIR(){const e=this.view,t=this.data[h(xt,km)],r=!!this.data[h(xt,Mm)],i=!!this.data[h(xt,Dm)],s=e.getUint32(h(xt,Om),!0),o=e.getUint32(h(xt,Lm),!0),a=e.getUint32(h(xt,jm),!0),l=e.getUint32(h(xt,zm),!0);let u=20;const p=new Float32Array(this.buffer,u,s*2);u+=s*8;const f=new Uint8Array(this.buffer,u,o*3);u+=o*3;const g=[];for(let w=0;w<a;++w){const b=e.getFloat32(u,!0);u+=4;const R=e.getUint32(u,!0);u+=4,g.push([b,`#${R.toString(16).padStart(6,"0")}`])}let m=null;if(r){m=[];for(let w=0;w<4;++w)m.push(e.getFloat32(u,!0)),u+=4}let C=null;i&&(C=new Uint8Array(this.buffer,u,3),u+=3);const S=[];for(let w=0;w<l;++w){const b=e.getUint8(u);u+=1,u=Math.ceil(u/4)*4;const R=e.getUint32(u,!0);u+=4;const P=new Int32Array(this.buffer,u,R);u+=R*4;const I=e.getUint32(u,!0);u+=4;const M=new Int32Array(this.buffer,u,I);u+=I*4;const k={type:b,coords:P,colors:M};b===wE.LATTICE&&(k.verticesPerRow=e.getUint32(u,!0),u+=4),S.push(k)}if(t===1)return["RadialAxial","axial",m,g,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",m,g,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(t===3){const w=this.data[h(xt,Nm)];let b=null;if(p.length>0){let R=p[0],P=p[0],I=p[1],M=p[1];for(let k=0;k<p.length;k+=2){const O=p[k],L=p[k+1];R=R>O?O:R,I=I>L?L:I,P=P<O?O:P,M=M<L?L:M}b=[R,I,P,M]}return["Mesh",w,p,f,S,b,m,C]}throw new Error(`Unsupported pattern kind: ${t}`)}};km=new WeakMap,Mm=new WeakMap,Dm=new WeakMap,Nm=new WeakMap,Om=new WeakMap,Lm=new WeakMap,jm=new WeakMap,zm=new WeakMap,_(xt,km,0),_(xt,Mm,1),_(xt,Dm,2),_(xt,Nm,3),_(xt,Om,4),_(xt,Lm,8),_(xt,jm,12),_(xt,zm,16);let VE=xt;var $d;class s6{constructor(e){_(this,$d);T(this,$d,e)}static write(e){let t,r;return mn.isFloat16ArraySupported?(r=new ArrayBuffer(e.length*2),t=new Float16Array(r)):(r=new ArrayBuffer(e.length*4),t=new Float32Array(r)),t.set(e),r}get path(){return mn.isFloat16ArraySupported?new Float16Array(h(this,$d)):new Float32Array(h(this,$d))}}$d=new WeakMap;function o6(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(ar)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function a6(n){if(ar&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return $y(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function gC(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const GE=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,c6=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",l6=H5.bind(null,GE,c6);var bo,T0;class u6{constructor(){_(this,bo,new Map);_(this,T0,Promise.resolve())}postMessage(e,t){const r={data:structuredClone(e,t?{transfer:t}:null)};h(this,T0).then(()=>{for(const[i]of h(this,bo))i.call(this,r)})}addEventListener(e,t,r=null){let i=null;if((r==null?void 0:r.signal)instanceof AbortSignal){const{signal:s}=r;if(s.aborted){Le("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);i=()=>s.removeEventListener("abort",o),s.addEventListener("abort",o)}h(this,bo).set(t,i)}removeEventListener(e,t){const r=h(this,bo).get(t);r==null||r(),h(this,bo).delete(t)}terminate(){for(const[,e]of h(this,bo))e==null||e();h(this,bo).clear()}}bo=new WeakMap,T0=new WeakMap;const vC={DATA:1,ERROR:2},sn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function yD(){}function mr(n){if(n instanceof vc||n instanceof AE||n instanceof uD||n instanceof o0||n instanceof rE)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Pt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new vc(n.message);case"InvalidPDFException":return new AE(n.message);case"PasswordException":return new uD(n.message,n.code);case"ResponseException":return new o0(n.message,n.status,n.missing);case"UnknownErrorException":return new rE(n.message,n.details)}return new rE(n.message,n.toString())}var Jd,Ii,b2,w2,A2,OC;class Lv{constructor(e,t,r){_(this,Ii);_(this,Jd,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",D(this,Ii,b2).bind(this),{signal:h(this,Jd).signal})}on(e,t){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},r)}catch(o){s.reject(o)}return s.promise}sendWithStream(e,t,r,i){const s=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const p=Promise.withResolvers();return this.streamControllers[s]={controller:u,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:e,streamId:s,data:t,desiredSize:u.desiredSize},i),p.promise},pull:u=>{const p=Promise.withResolvers();return this.streamControllers[s].pullCall=p,l.postMessage({sourceName:o,targetName:a,stream:sn.PULL,streamId:s,desiredSize:u.desiredSize}),p.promise},cancel:u=>{rt(u instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[s].cancelCall=p,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:sn.CANCEL,streamId:s,reason:mr(u)}),p.promise}},r)}destroy(){var e;(e=h(this,Jd))==null||e.abort(),T(this,Jd,null)}}Jd=new WeakMap,Ii=new WeakSet,b2=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){D(this,Ii,A2).call(this,e);return}if(e.callback){const r=e.callbackId,i=this.callbackCapabilities[r];if(!i)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===vC.DATA)i.resolve(e.data);else if(e.callback===vC.ERROR)i.reject(mr(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const r=this.sourceName,i=e.sourceName,s=this.comObj;Promise.try(t,e.data).then(function(o){s.postMessage({sourceName:r,targetName:i,callback:vC.DATA,callbackId:e.callbackId,data:o})},function(o){s.postMessage({sourceName:r,targetName:i,callback:vC.ERROR,callbackId:e.callbackId,reason:mr(o)})});return}if(e.streamId){D(this,Ii,w2).call(this,e);return}t(e.data)},w2=function(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,o=this,a=this.actionHandler[e.action],l={enqueue(u,p=1,f){if(this.isCancelled)return;const g=this.desiredSize;this.desiredSize-=p,g>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:i,stream:sn.ENQUEUE,streamId:t,chunk:u},f)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:sn.CLOSE,streamId:t}),delete o.streamSinks[t])},error(u){rt(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:sn.ERROR,streamId:t,reason:mr(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(a,e.data,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:sn.START_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:sn.START_COMPLETE,streamId:t,reason:mr(u)})})},A2=function(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case sn.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(mr(e.reason));break;case sn.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(mr(e.reason));break;case sn.PULL:if(!a){s.postMessage({sourceName:r,targetName:i,stream:sn.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||yD).then(function(){s.postMessage({sourceName:r,targetName:i,stream:sn.PULL_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:sn.PULL_COMPLETE,streamId:t,reason:mr(u)})});break;case sn.ENQUEUE:if(rt(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case sn.CLOSE:if(rt(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),D(this,Ii,OC).call(this,o,t);break;case sn.ERROR:rt(o,"error should have stream controller"),o.controller.error(mr(e.reason)),D(this,Ii,OC).call(this,o,t);break;case sn.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(mr(e.reason)),D(this,Ii,OC).call(this,o,t);break;case sn.CANCEL:if(!a)break;const l=mr(e.reason);Promise.try(a.onCancel||yD,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:sn.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:sn.CANCEL_COMPLETE,streamId:t,reason:mr(u)})}),a.sinkCapability.reject(l),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},OC=async function(e,t){var r,i,s;await Promise.allSettled([(r=e.startCall)==null?void 0:r.promise,(i=e.pullCall)==null?void 0:i.promise,(s=e.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[t]};var Fm;class E2{constructor({enableHWA:e=!1}){_(this,Fm,!1);T(this,Fm,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(e,t);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!h(this,Fm)})}}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Pt("Abstract method `_createCanvas` called.")}}Fm=new WeakMap;class d6 extends E2{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const r=this._document.createElement("canvas");return r.width=e,r.height=t,r}}class R2{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Pt("Abstract method `_fetch` called.")}}class SD extends R2{async _fetch(e){const t=await Jy(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):$y(t)}}He(2489);class P2{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,r,i,s){return"none"}destroy(e=!1){}}var Ml,Xd,wo,Ao,$n,Dl,Nl,Ae,qn,jv,sd,LC,od,T2,KE,ad,zv,Fv,$E,Bv;class h6 extends P2{constructor({docId:t,ownerDocument:r=globalThis.document}){super();_(this,Ae);_(this,Ml);_(this,Xd);_(this,wo);_(this,Ao);_(this,$n);_(this,Dl);_(this,Nl,0);T(this,Ao,t),T(this,$n,r)}addFilter(t){if(!t)return"none";let r=h(this,Ae,qn).get(t);if(r)return r;const[i,s,o]=D(this,Ae,LC).call(this,t),a=t.length===1?i:`${i}${s}${o}`;if(r=h(this,Ae,qn).get(a),r)return h(this,Ae,qn).set(t,r),r;const l=`g_${h(this,Ao)}_transfer_map_${dn(this,Nl)._++}`,u=D(this,Ae,od).call(this,l);h(this,Ae,qn).set(t,u),h(this,Ae,qn).set(a,u);const p=D(this,Ae,ad).call(this,l);return D(this,Ae,Fv).call(this,i,s,o,p),u}addHCMFilter(t,r){var C;const i=`${t}-${r}`,s="base";let o=h(this,Ae,jv).get(s);if((o==null?void 0:o.key)===i||(o?((C=o.filter)==null||C.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},h(this,Ae,jv).set(s,o)),!t||!r))return o.url;const a=D(this,Ae,Bv).call(this,t);t=be.makeHexColor(...a);const l=D(this,Ae,Bv).call(this,r);if(r=be.makeHexColor(...l),h(this,Ae,sd).style.color="",t==="#000000"&&r==="#ffffff"||t===r)return o.url;const u=new Array(256);for(let S=0;S<=255;S++){const w=S/255;u[S]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const p=u.join(","),f=`g_${h(this,Ao)}_hcm_filter`,g=o.filter=D(this,Ae,ad).call(this,f);D(this,Ae,Fv).call(this,p,p,p,g),D(this,Ae,KE).call(this,g);const m=(S,w)=>{const b=a[S]/255,R=l[S]/255,P=new Array(w+1);for(let I=0;I<=w;I++)P[I]=b+I/w*(R-b);return P.join(",")};return D(this,Ae,Fv).call(this,m(0,5),m(1,5),m(2,5),g),o.url=D(this,Ae,od).call(this,f),o.url}addAlphaFilter(t){let r=h(this,Ae,qn).get(t);if(r)return r;const[i]=D(this,Ae,LC).call(this,[t]),s=`alpha_${i}`;if(r=h(this,Ae,qn).get(s),r)return h(this,Ae,qn).set(t,r),r;const o=`g_${h(this,Ao)}_alpha_map_${dn(this,Nl)._++}`,a=D(this,Ae,od).call(this,o);h(this,Ae,qn).set(t,a),h(this,Ae,qn).set(s,a);const l=D(this,Ae,ad).call(this,o);return D(this,Ae,$E).call(this,i,l),a}addLuminosityFilter(t){let r=h(this,Ae,qn).get(t||"luminosity");if(r)return r;let i,s;if(t?([i]=D(this,Ae,LC).call(this,[t]),s=`luminosity_${i}`):s="luminosity",r=h(this,Ae,qn).get(s),r)return h(this,Ae,qn).set(t,r),r;const o=`g_${h(this,Ao)}_luminosity_map_${dn(this,Nl)._++}`,a=D(this,Ae,od).call(this,o);h(this,Ae,qn).set(t,a),h(this,Ae,qn).set(s,a);const l=D(this,Ae,ad).call(this,o);return D(this,Ae,T2).call(this,l),t&&D(this,Ae,$E).call(this,i,l),a}addHighlightHCMFilter(t,r,i,s,o){var R;const a=`${r}-${i}-${s}-${o}`;let l=h(this,Ae,jv).get(t);if((l==null?void 0:l.key)===a||(l?((R=l.filter)==null||R.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},h(this,Ae,jv).set(t,l)),!r||!i))return l.url;const[u,p]=[r,i].map(D(this,Ae,Bv).bind(this));let f=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),g=Math.round(.2126*p[0]+.7152*p[1]+.0722*p[2]),[m,C]=[s,o].map(D(this,Ae,Bv).bind(this));g<f&&([f,g,m,C]=[g,f,C,m]),h(this,Ae,sd).style.color="";const S=(P,I,M)=>{const k=new Array(256),O=(g-f)/M,L=P/255,F=(I-P)/(255*M);let H=0;for(let V=0;V<=M;V++){const ie=Math.round(f+V*O),J=L+V*F;for(let ee=H;ee<=ie;ee++)k[ee]=J;H=ie+1}for(let V=H;V<256;V++)k[V]=k[H-1];return k.join(",")},w=`g_${h(this,Ao)}_hcm_${t}_filter`,b=l.filter=D(this,Ae,ad).call(this,w);return D(this,Ae,KE).call(this,b),D(this,Ae,Fv).call(this,S(m[0],C[0],5),S(m[1],C[1],5),S(m[2],C[2],5),b),l.url=D(this,Ae,od).call(this,w),l.url}destroy(t=!1){var r,i,s,o;t&&((r=h(this,Dl))!=null&&r.size)||((i=h(this,wo))==null||i.parentNode.parentNode.remove(),T(this,wo,null),(s=h(this,Xd))==null||s.clear(),T(this,Xd,null),(o=h(this,Dl))==null||o.clear(),T(this,Dl,null),T(this,Nl,0))}}Ml=new WeakMap,Xd=new WeakMap,wo=new WeakMap,Ao=new WeakMap,$n=new WeakMap,Dl=new WeakMap,Nl=new WeakMap,Ae=new WeakSet,qn=function(){return h(this,Xd)||T(this,Xd,new Map)},jv=function(){return h(this,Dl)||T(this,Dl,new Map)},sd=function(){if(!h(this,wo)){const t=h(this,$n).createElement("div"),{style:r}=t;r.visibility="hidden",r.contain="strict",r.width=r.height=0,r.position="absolute",r.top=r.left=0,r.zIndex=-1;const i=h(this,$n).createElementNS(ro,"svg");i.setAttribute("width",0),i.setAttribute("height",0),T(this,wo,h(this,$n).createElementNS(ro,"defs")),t.append(i),i.append(h(this,wo)),h(this,$n).body.append(t)}return h(this,wo)},LC=function(t){if(t.length===1){const u=t[0],p=new Array(256);for(let g=0;g<256;g++)p[g]=u[g]/255;const f=p.join(",");return[f,f,f]}const[r,i,s]=t,o=new Array(256),a=new Array(256),l=new Array(256);for(let u=0;u<256;u++)o[u]=r[u]/255,a[u]=i[u]/255,l[u]=s[u]/255;return[o.join(","),a.join(","),l.join(",")]},od=function(t){if(h(this,Ml)===void 0){T(this,Ml,"");const r=h(this,$n).URL;r!==h(this,$n).baseURI&&(V0(r)?Le('#createUrl: ignore "data:"-URL for performance reasons.'):T(this,Ml,NO(r,"")))}return`url(${h(this,Ml)}#${t})`},T2=function(t){const r=h(this,$n).createElementNS(ro,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(r)},KE=function(t){const r=h(this,$n).createElementNS(ro,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(r)},ad=function(t){const r=h(this,$n).createElementNS(ro,"filter");return r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("id",t),h(this,Ae,sd).append(r),r},zv=function(t,r,i){const s=h(this,$n).createElementNS(ro,r);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),t.append(s)},Fv=function(t,r,i,s){const o=h(this,$n).createElementNS(ro,"feComponentTransfer");s.append(o),D(this,Ae,zv).call(this,o,"feFuncR",t),D(this,Ae,zv).call(this,o,"feFuncG",r),D(this,Ae,zv).call(this,o,"feFuncB",i)},$E=function(t,r){const i=h(this,$n).createElementNS(ro,"feComponentTransfer");r.append(i),D(this,Ae,zv).call(this,i,"feFuncA",t)},Bv=function(t){return h(this,Ae,sd).style.color=t,Yy(getComputedStyle(h(this,Ae,sd)).getPropertyValue("color"))};class x2{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Pt("Abstract method `_fetch` called.")}}class CD extends x2{async _fetch(e){const t=await Jy(e,"arraybuffer");return new Uint8Array(t)}}class I2{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Pt("Abstract method `_fetch` called.")}}class bD extends I2{async _fetch(e){const t=await Jy(e,"arraybuffer");return new Uint8Array(t)}}var AN;if(ar){let n;try{const e=process.getBuiltinModule("module").createRequire(import.meta.url);try{n=e("@napi-rs/canvas")}catch(t){Le(`Cannot load "@napi-rs/canvas" package: "${t}".`)}}catch(e){Le(`Cannot access the \`require\` function: "${e}".`)}globalThis.DOMMatrix||(n!=null&&n.DOMMatrix?globalThis.DOMMatrix=n.DOMMatrix:Le("Cannot polyfill `DOMMatrix`, rendering may be broken.")),globalThis.ImageData||(n!=null&&n.ImageData?globalThis.ImageData=n.ImageData:Le("Cannot polyfill `ImageData`, rendering may be broken.")),globalThis.Path2D||(n!=null&&n.Path2D?globalThis.Path2D=n.Path2D:Le("Cannot polyfill `Path2D`, rendering may be broken.")),(AN=globalThis.navigator)!=null&&AN.language||(globalThis.navigator={language:"en-US",platform:"",userAgent:""})}async function pP(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class p6 extends P2{}class f6 extends E2{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class g6 extends R2{async _fetch(e){return pP(e)}}class v6 extends x2{async _fetch(e){return pP(e)}}class m6 extends I2{async _fetch(e){return pP(e)}}He(7588);const td="__forcedDependency",{floor:wD,ceil:AD}=Math;function mC(n,e,t,r,i,s){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],r),n[e*4+2]=Math.max(n[e*4+2],i),n[e*4+3]=Math.max(n[e*4+3],s)}const JE=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Yd,Va;class y6{constructor(e,t){_(this,Yd);_(this,Va);T(this,Yd,e),T(this,Va,t)}get length(){return h(this,Yd).length}isEmpty(e){return h(this,Yd)[e]===JE}minX(e){return h(this,Va)[e*4+0]/256}minY(e){return h(this,Va)[e*4+1]/256}maxX(e){return(h(this,Va)[e*4+2]+1)/256}maxY(e){return(h(this,Va)[e*4+3]+1)/256}}Yd=new WeakMap,Va=new WeakMap;const yC=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var Cr,br,Ol,Gi,Ll,Eo,ft,Ct,Ro,wr,Bm,Qd,jl,zl,Po,Jn,Is,Um,XE;class S6{constructor(e,t,r=!1){_(this,Um);_(this,Cr,{__proto__:null});_(this,br,{__proto__:null,transform:[],moveText:[],sameLineText:[],[td]:[]});_(this,Ol,new Map);_(this,Gi,[]);_(this,Ll,[]);_(this,Eo,[[1,0,0,1,0,0]]);_(this,ft,[-1/0,-1/0,1/0,1/0]);_(this,Ct,new Float64Array([1/0,1/0,-1/0,-1/0]));_(this,Ro,-1);_(this,wr,new Set);_(this,Bm,new Map);_(this,Qd,new Map);_(this,jl);_(this,zl);_(this,Po);_(this,Jn);_(this,Is);T(this,jl,e.width),T(this,zl,e.height),D(this,Um,XE).call(this,t),r&&T(this,Is,new Map)}growOperationsCount(e){e>=h(this,Jn).length&&D(this,Um,XE).call(this,e,h(this,Jn))}save(e){return T(this,Cr,{__proto__:h(this,Cr)}),T(this,br,{__proto__:h(this,br),transform:{__proto__:h(this,br).transform},moveText:{__proto__:h(this,br).moveText},sameLineText:{__proto__:h(this,br).sameLineText},[td]:{__proto__:h(this,br)[td]}}),T(this,ft,{__proto__:h(this,ft)}),h(this,Gi).push(e),this}restore(e){var i;const t=Object.getPrototypeOf(h(this,Cr));if(t===null)return this;T(this,Cr,t),T(this,br,Object.getPrototypeOf(h(this,br))),T(this,ft,Object.getPrototypeOf(h(this,ft)));const r=h(this,Gi).pop();return r!==void 0&&((i=yC(h(this,Is),e))==null||i.dependencies.add(r),h(this,Jn)[e]=h(this,Jn)[r]),this}recordOpenMarker(e){return h(this,Gi).push(e),this}getOpenMarker(){return h(this,Gi).length===0?null:h(this,Gi).at(-1)}recordCloseMarker(e){var r;const t=h(this,Gi).pop();return t!==void 0&&((r=yC(h(this,Is),e))==null||r.dependencies.add(t),h(this,Jn)[e]=h(this,Jn)[t]),this}beginMarkedContent(e){return h(this,Ll).push(e),this}endMarkedContent(e){var r;const t=h(this,Ll).pop();return t!==void 0&&((r=yC(h(this,Is),e))==null||r.dependencies.add(t),h(this,Jn)[e]=h(this,Jn)[t]),this}pushBaseTransform(e){return h(this,Eo).push(be.multiplyByDOMMatrix(h(this,Eo).at(-1),e.getTransform())),this}popBaseTransform(){return h(this,Eo).length>1&&h(this,Eo).pop(),this}recordSimpleData(e,t){return h(this,Cr)[e]=t,this}recordIncrementalData(e,t){return h(this,br)[e].push(t),this}resetIncrementalData(e,t){return h(this,br)[e].length=0,this}recordNamedData(e,t){return h(this,Ol).set(e,t),this}recordSimpleDataFromNamed(e,t,r){h(this,Cr)[e]=h(this,Ol).get(t)??r}recordFutureForcedDependency(e,t){return this.recordIncrementalData(td,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in h(this,Cr)&&this.recordFutureForcedDependency(t,h(this,Cr)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of h(this,wr))this.recordFutureForcedDependency(td,e);return this}resetBBox(e){return h(this,Ro)!==e&&(T(this,Ro,e),h(this,Ct)[0]=1/0,h(this,Ct)[1]=1/0,h(this,Ct)[2]=-1/0,h(this,Ct)[3]=-1/0),this}recordClipBox(e,t,r,i,s,o){const a=be.multiplyByDOMMatrix(h(this,Eo).at(-1),t.getTransform()),l=[1/0,1/0,-1/0,-1/0];be.axialAlignedBoundingBox([r,s,i,o],a,l);const u=be.intersect(h(this,ft),l);return u?(h(this,ft)[0]=u[0],h(this,ft)[1]=u[1],h(this,ft)[2]=u[2],h(this,ft)[3]=u[3]):(h(this,ft)[0]=h(this,ft)[1]=1/0,h(this,ft)[2]=h(this,ft)[3]=-1/0),this}recordBBox(e,t,r,i,s,o){const a=h(this,ft);if(a[0]===1/0)return this;const l=be.multiplyByDOMMatrix(h(this,Eo).at(-1),t.getTransform());if(a[0]===-1/0)return be.axialAlignedBoundingBox([r,s,i,o],l,h(this,Ct)),this;const u=[1/0,1/0,-1/0,-1/0];return be.axialAlignedBoundingBox([r,s,i,o],l,u),h(this,Ct)[0]=Math.min(h(this,Ct)[0],Math.max(u[0],a[0])),h(this,Ct)[1]=Math.min(h(this,Ct)[1],Math.max(u[1],a[1])),h(this,Ct)[2]=Math.max(h(this,Ct)[2],Math.min(u[2],a[2])),h(this,Ct)[3]=Math.max(h(this,Ct)[3],Math.min(u[3],a[3])),this}recordCharacterBBox(e,t,r,i=1,s=0,o=0,a){const l=r.bbox;let u,p;if(l&&(u=l[2]!==l[0]&&l[3]!==l[1]&&h(this,Qd).get(r),u!==!1&&(p=[0,0,0,0],be.axialAlignedBoundingBox(l,r.fontMatrix,p),(i!==1||s!==0||o!==0)&&be.scaleMinMax([i,0,0,-i,s,o],p),u)))return this.recordBBox(e,t,p[0],p[2],p[1],p[3]);if(!a)return this.recordFullPageBBox(e);const f=a();return l&&p&&u===void 0&&(u=p[0]<=s-f.actualBoundingBoxLeft&&p[2]>=s+f.actualBoundingBoxRight&&p[1]<=o-f.actualBoundingBoxAscent&&p[3]>=o+f.actualBoundingBoxDescent,h(this,Qd).set(r,u),u)?this.recordBBox(e,t,p[0],p[2],p[1],p[3]):this.recordBBox(e,t,s-f.actualBoundingBoxLeft,s+f.actualBoundingBoxRight,o-f.actualBoundingBoxAscent,o+f.actualBoundingBoxDescent)}recordFullPageBBox(e){return h(this,Ct)[0]=Math.max(0,h(this,ft)[0]),h(this,Ct)[1]=Math.max(0,h(this,ft)[1]),h(this,Ct)[2]=Math.min(h(this,jl),h(this,ft)[2]),h(this,Ct)[3]=Math.min(h(this,zl),h(this,ft)[3]),this}getSimpleIndex(e){return h(this,Cr)[e]}recordDependencies(e,t){const r=h(this,wr),i=h(this,Cr),s=h(this,br);for(const o of t)o in h(this,Cr)?r.add(i[o]):o in s&&s[o].forEach(r.add,r);return this}recordNamedDependency(e,t){return h(this,Ol).has(t)&&h(this,wr).add(h(this,Ol).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[td]),h(this,Is)){const r=yC(h(this,Is),e),{dependencies:i}=r;h(this,wr).forEach(i.add,i),h(this,Gi).forEach(i.add,i),h(this,Ll).forEach(i.add,i),i.delete(e),r.isRenderingOperation=!0}if(h(this,Ro)===e){const r=wD(h(this,Ct)[0]*256/h(this,jl)),i=wD(h(this,Ct)[1]*256/h(this,zl)),s=AD(h(this,Ct)[2]*256/h(this,jl)),o=AD(h(this,Ct)[3]*256/h(this,zl));mC(h(this,Po),e,r,i,s,o);for(const a of h(this,wr))a!==e&&mC(h(this,Po),a,r,i,s,o);for(const a of h(this,Gi))a!==e&&mC(h(this,Po),a,r,i,s,o);for(const a of h(this,Ll))a!==e&&mC(h(this,Po),a,r,i,s,o);t||(h(this,wr).clear(),T(this,Ro,-1))}return this}recordShowTextOperation(e,t=!1){const r=Array.from(h(this,wr));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of r)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return h(this,Ro)===e&&(T(this,Ro,-1),h(this,ft)[0]=Math.max(h(this,ft)[0],h(this,Ct)[0]),h(this,ft)[1]=Math.max(h(this,ft)[1],h(this,Ct)[1]),h(this,ft)[2]=Math.min(h(this,ft)[2],h(this,Ct)[2]),h(this,ft)[3]=Math.min(h(this,ft)[3],h(this,Ct)[3]),t||h(this,wr).clear()),this}_takePendingDependencies(){const e=h(this,wr);return T(this,wr,new Set),e}_extractOperation(e){const t=h(this,Bm).get(e);return h(this,Bm).delete(e),t}_pushPendingDependencies(e){for(const t of e)h(this,wr).add(t)}take(){return h(this,Qd).clear(),new y6(h(this,Jn),h(this,Po))}takeDebugMetadata(){return h(this,Is)}}Cr=new WeakMap,br=new WeakMap,Ol=new WeakMap,Gi=new WeakMap,Ll=new WeakMap,Eo=new WeakMap,ft=new WeakMap,Ct=new WeakMap,Ro=new WeakMap,wr=new WeakMap,Bm=new WeakMap,Qd=new WeakMap,jl=new WeakMap,zl=new WeakMap,Po=new WeakMap,Jn=new WeakMap,Is=new WeakMap,Um=new WeakSet,XE=function(e,t){const r=new ArrayBuffer(e*4);T(this,Po,new Uint8ClampedArray(r)),T(this,Jn,new Uint32Array(r)),t&&t.length>0?(h(this,Jn).set(t),h(this,Jn).fill(JE,t.length)):h(this,Jn).fill(JE)};var Et,Kt,Ki,Zd,eh;const EP=class EP{constructor(e,t,r){_(this,Et);_(this,Kt);_(this,Ki);_(this,Zd,0);_(this,eh,0);if(e instanceof EP&&h(e,Ki)===!!r)return e;T(this,Et,e),T(this,Kt,t),T(this,Ki,!!r)}growOperationsCount(){throw new Error("Unreachable")}save(e){return dn(this,eh)._++,h(this,Et).save(h(this,Kt)),this}restore(e){return h(this,eh)>0&&(h(this,Et).restore(h(this,Kt)),dn(this,eh)._--),this}recordOpenMarker(e){return dn(this,Zd)._++,this}getOpenMarker(){return h(this,Zd)>0?h(this,Kt):h(this,Et).getOpenMarker()}recordCloseMarker(e){return dn(this,Zd)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return h(this,Et).pushBaseTransform(e),this}popBaseTransform(){return h(this,Et).popBaseTransform(),this}recordSimpleData(e,t){return h(this,Et).recordSimpleData(e,h(this,Kt)),this}recordIncrementalData(e,t){return h(this,Et).recordIncrementalData(e,h(this,Kt)),this}resetIncrementalData(e,t){return h(this,Et).resetIncrementalData(e,h(this,Kt)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,r){return h(this,Et).recordSimpleDataFromNamed(e,t,h(this,Kt)),this}recordFutureForcedDependency(e,t){return h(this,Et).recordFutureForcedDependency(e,h(this,Kt)),this}inheritSimpleDataAsFutureForcedDependencies(e){return h(this,Et).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return h(this,Et).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return h(this,Ki)||h(this,Et).resetBBox(h(this,Kt)),this}recordClipBox(e,t,r,i,s,o){return h(this,Ki)||h(this,Et).recordClipBox(h(this,Kt),t,r,i,s,o),this}recordBBox(e,t,r,i,s,o){return h(this,Ki)||h(this,Et).recordBBox(h(this,Kt),t,r,i,s,o),this}recordCharacterBBox(e,t,r,i,s,o,a){return h(this,Ki)||h(this,Et).recordCharacterBBox(h(this,Kt),t,r,i,s,o,a),this}recordFullPageBBox(e){return h(this,Ki)||h(this,Et).recordFullPageBBox(h(this,Kt)),this}getSimpleIndex(e){return h(this,Et).getSimpleIndex(e)}recordDependencies(e,t){return h(this,Et).recordDependencies(h(this,Kt),t),this}recordNamedDependency(e,t){return h(this,Et).recordNamedDependency(h(this,Kt),t),this}recordOperation(e){return h(this,Et).recordOperation(h(this,Kt),!0),this}recordShowTextOperation(e){return h(this,Et).recordShowTextOperation(h(this,Kt),!0),this}bboxToClipBoxDropOperation(e){return h(this,Ki)||h(this,Et).bboxToClipBoxDropOperation(h(this,Kt),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};Et=new WeakMap,Kt=new WeakMap,Ki=new WeakMap,Zd=new WeakMap,eh=new WeakMap;let h0=EP;const fi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},jn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function YE(n,e){if(!e)return;const t=e[2]-e[0],r=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,r),n.clip(i)}class fP{isModifyingCurrentTransform(){return!1}getPattern(){Pt("Abstract method `getPattern` called.")}}class C6 extends fP{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let r,i=this._p0,s=this._p1;if(t&&(i=i.slice(),s=s.slice(),be.applyTransform(i,t),be.applyTransform(s,t)),this._type==="axial")r=e.createLinearGradient(i[0],i[1],s[0],s[1]);else if(this._type==="radial"){let o=this._r0,a=this._r1;if(t){const l=new Float32Array(2);be.singularValueDecompose2dScale(t,l),o*=l[0],a*=l[0]}r=e.createRadialGradient(i[0],i[1],o,s[0],s[1],a)}for(const o of this._colorStops)r.addColorStop(o[0],o[1]);return r}getPattern(e,t,r,i){let s;if(i===jn.STROKE||i===jn.FILL){if(this.isOriginBased()){let g=be.transform(r,t.baseTransform);this.matrix&&(g=be.transform(g,this.matrix));const m=.001,C=Math.hypot(g[0],g[1]),S=Math.hypot(g[2],g[3]),w=(g[0]*g[2]+g[1]*g[3])/(C*S);if(Math.abs(w)<m)if(this.isRadial()){if(Math.abs(C-S)<m)return this._createGradient(e,g)}else return this._createGradient(e,g)}const o=t.current.getClippedPathBoundingBox(i,Wt(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,u=t.cachedCanvases.getCanvas("pattern",a,l),p=u.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-o[0],-o[1]),r=be.transform(r,[1,0,0,1,o[0],o[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),YE(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),s=e.createPattern(u.canvas,"no-repeat");const f=new DOMMatrix(r);s.setTransform(f)}else YE(e,this._bbox),s=this._createGradient(e);return s}}function oE(n,e,t,r,i,s,o,a){const l=e.coords,u=e.colors,p=n.data,f=n.width*4;let g;l[t+1]>l[r+1]&&(g=t,t=r,r=g,g=s,s=o,o=g),l[r+1]>l[i+1]&&(g=r,r=i,i=g,g=o,o=a,a=g),l[t+1]>l[r+1]&&(g=t,t=r,r=g,g=s,s=o,o=g);const m=(l[t]+e.offsetX)*e.scaleX,C=(l[t+1]+e.offsetY)*e.scaleY,S=(l[r]+e.offsetX)*e.scaleX,w=(l[r+1]+e.offsetY)*e.scaleY,b=(l[i]+e.offsetX)*e.scaleX,R=(l[i+1]+e.offsetY)*e.scaleY;if(C>=R)return;const P=u[s],I=u[s+1],M=u[s+2],k=u[o],O=u[o+1],L=u[o+2],F=u[a],H=u[a+1],V=u[a+2],ie=Math.round(C),J=Math.round(R);let ee,se,ne,Q,K,oe,B,j;for(let $=ie;$<=J;$++){if($<w){const te=$<C?0:(C-$)/(C-w);ee=m-(m-S)*te,se=P-(P-k)*te,ne=I-(I-O)*te,Q=M-(M-L)*te}else{let te;$>R?te=1:w===R?te=0:te=(w-$)/(w-R),ee=S-(S-b)*te,se=k-(k-F)*te,ne=O-(O-H)*te,Q=L-(L-V)*te}let pe;$<C?pe=0:$>R?pe=1:pe=(C-$)/(C-R),K=m-(m-b)*pe,oe=P-(P-F)*pe,B=I-(I-H)*pe,j=M-(M-V)*pe;const ge=Math.round(Math.min(ee,K)),ye=Math.round(Math.max(ee,K));let re=f*$+ge*4;for(let te=ge;te<=ye;te++)pe=(ee-te)/(ee-K),pe<0?pe=0:pe>1&&(pe=1),p[re++]=se-(se-oe)*pe|0,p[re++]=ne-(ne-B)*pe|0,p[re++]=Q-(Q-j)*pe|0,p[re++]=255}}function b6(n,e,t){const r=e.coords,i=e.colors;let s,o;switch(e.type){case wE.LATTICE:const a=e.verticesPerRow,l=Math.floor(r.length/a)-1,u=a-1;for(s=0;s<l;s++){let p=s*a;for(let f=0;f<u;f++,p++)oE(n,t,r[p],r[p+1],r[p+a],i[p],i[p+1],i[p+a]),oE(n,t,r[p+a+1],r[p+1],r[p+a],i[p+a+1],i[p+1],i[p+a])}break;case wE.TRIANGLES:for(s=0,o=r.length;s<o;s+=3)oE(n,t,r[s],r[s+1],r[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class w6 extends fP{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,r){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-a,p=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),g=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),m=u/f,C=p/g,S={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/m,scaleY:1/C},w=f+4,b=g+4,R=r.getCanvas("mesh",w,b),P=R.context,I=P.createImageData(f,g);if(t){const k=I.data;for(let O=0,L=k.length;O<L;O+=4)k[O]=t[0],k[O+1]=t[1],k[O+2]=t[2],k[O+3]=255}for(const k of this._figures)b6(I,k,S);return P.putImageData(I,2,2),{canvas:R.canvas,offsetX:a-2*m,offsetY:l-2*C,scaleX:m,scaleY:C}}isModifyingCurrentTransform(){return!0}getPattern(e,t,r,i){YE(e,this._bbox);const s=new Float32Array(2);if(i===jn.SHADING)be.singularValueDecompose2dScale(Wt(e),s);else if(this.matrix){be.singularValueDecompose2dScale(this.matrix,s);const[a,l]=s;be.singularValueDecompose2dScale(t.baseTransform,s),s[0]*=a,s[1]*=l}else be.singularValueDecompose2dScale(t.baseTransform,s);const o=this._createMeshCanvas(s,i===jn.SHADING?null:this._background,t.cachedCanvases);return i!==jn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class A6 extends fP{getPattern(){return"hotpink"}}function E6(n){switch(n[0]){case"RadialAxial":return new C6(n);case"Mesh":return new w6(n);case"Dummy":return new A6}throw new Error(`Unknown IR type: ${n[0]}`)}const ED={COLORED:1,UNCOLORED:2},x0=class x0{constructor(e,t,r,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=r,this.baseTransform=i}createPatternCanvas(e,t){var oe,B;const{bbox:r,operatorList:i,paintType:s,tilingType:o,color:a,canvasGraphicsFactory:l}=this;let{xstep:u,ystep:p}=this;u=Math.abs(u),p=Math.abs(p),q0("TilingType: "+o);const f=r[0],g=r[1],m=r[2],C=r[3],S=m-f,w=C-g,b=new Float32Array(2);be.singularValueDecompose2dScale(this.matrix,b);const[R,P]=b;be.singularValueDecompose2dScale(this.baseTransform,b);const I=R*b[0],M=P*b[1];let k=S,O=w,L=!1,F=!1;const H=Math.ceil(u*I),V=Math.ceil(p*M),ie=Math.ceil(S*I),J=Math.ceil(w*M);H>=ie?k=u:L=!0,V>=J?O=p:F=!0;const ee=this.getSizeAndScale(k,this.ctx.canvas.width,I),se=this.getSizeAndScale(O,this.ctx.canvas.height,M),ne=e.cachedCanvases.getCanvas("pattern",ee.size,se.size),Q=ne.context,K=l.createCanvasGraphics(Q,t);if(K.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(K,s,a),Q.translate(-ee.scale*f,-se.scale*g),K.transform(0,ee.scale,0,0,se.scale,0,0),Q.save(),(oe=K.dependencyTracker)==null||oe.save(),this.clipBbox(K,f,g,m,C),K.baseTransform=Wt(K.ctx),K.executeOperatorList(i),K.endDrawing(),(B=K.dependencyTracker)==null||B.restore(),Q.restore(),L||F){const j=ne.canvas;L&&(k=u),F&&(O=p);const $=this.getSizeAndScale(k,this.ctx.canvas.width,I),pe=this.getSizeAndScale(O,this.ctx.canvas.height,M),ge=$.size,ye=pe.size,re=e.cachedCanvases.getCanvas("pattern-workaround",ge,ye),te=re.context,ae=L?Math.floor(S/u):0,ve=F?Math.floor(w/p):0;for(let _e=0;_e<=ae;_e++)for(let Ce=0;Ce<=ve;Ce++)te.drawImage(j,ge*_e,ye*Ce,ge,ye,0,0,ge,ye);return{canvas:re.canvas,scaleX:$.scale,scaleY:pe.scale,offsetX:f,offsetY:g}}return{canvas:ne.canvas,scaleX:ee.scale,scaleY:se.scale,offsetX:f,offsetY:g}}getSizeAndScale(e,t,r){const i=Math.max(x0.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*r);return s>=i?s=i:r=s/e,{scale:r,size:s}}clipBbox(e,t,r,i,s){const o=i-t,a=s-r;e.ctx.rect(t,r,o,a),be.axialAlignedBoundingBox([t,r,i,s],Wt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,r){const i=e.ctx,s=e.current;switch(t){case ED.COLORED:const{fillStyle:o,strokeStyle:a}=this.ctx;i.fillStyle=s.fillColor=o,i.strokeStyle=s.strokeColor=a;break;case ED.UNCOLORED:i.fillStyle=i.strokeStyle=r,s.fillColor=s.strokeColor=r;break;default:throw new L5(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,r,i,s){let o=r;i!==jn.SHADING&&(o=be.transform(o,t.baseTransform),this.matrix&&(o=be.transform(o,this.matrix)));const a=this.createPatternCanvas(t,s);let l=new DOMMatrix(o);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);const u=e.createPattern(a.canvas,"repeat");return u.setTransform(l),u}};G(x0,"MAX_PATTERN_SIZE",3e3);let QE=x0;function R6({src:n,srcPos:e=0,dest:t,width:r,height:i,nonBlackColor:s=4294967295,inverseDecode:o=!1}){const a=mn.isLittleEndian?4278190080:255,[l,u]=o?[s,a]:[a,s],p=r>>3,f=r&7,g=n.length;t=new Uint32Array(t.buffer);let m=0;for(let C=0;C<i;C++){for(const w=e+p;e<w;e++){const b=e<g?n[e]:255;t[m++]=b&128?u:l,t[m++]=b&64?u:l,t[m++]=b&32?u:l,t[m++]=b&16?u:l,t[m++]=b&8?u:l,t[m++]=b&4?u:l,t[m++]=b&2?u:l,t[m++]=b&1?u:l}if(f===0)continue;const S=e<g?n[e++]:255;for(let w=0;w<f;w++)t[m++]=S&1<<7-w?u:l}return{srcPos:e,destPos:m}}const RD=16,PD=100,P6=15,TD=10,Rr=16,aE=new DOMMatrix,ni=new Float32Array(2),pd=new Float32Array([1/0,1/0,-1/0,-1/0]);function T6(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,r){e.translate(t,r),this.__originalTranslate(t,r)},n.scale=function(t,r){e.scale(t,r),this.__originalScale(t,r)},n.transform=function(t,r,i,s,o,a){e.transform(t,r,i,s,o,a),this.__originalTransform(t,r,i,s,o,a)},n.setTransform=function(t,r,i,s,o,a){e.setTransform(t,r,i,s,o,a),this.__originalSetTransform(t,r,i,s,o,a)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,r){e.moveTo(t,r),this.__originalMoveTo(t,r)},n.lineTo=function(t,r){e.lineTo(t,r),this.__originalLineTo(t,r)},n.bezierCurveTo=function(t,r,i,s,o,a){e.bezierCurveTo(t,r,i,s,o,a),this.__originalBezierCurveTo(t,r,i,s,o,a)},n.rect=function(t,r,i,s){e.rect(t,r,i,s),this.__originalRect(t,r,i,s)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class x6{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,r){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,r)):(i=this.canvasFactory.create(t,r),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function SC(n,e,t,r,i,s,o,a,l,u){const[p,f,g,m,C,S]=Wt(n);if(f===0&&g===0){const R=o*p+C,P=Math.round(R),I=a*m+S,M=Math.round(I),k=(o+l)*p+C,O=Math.abs(Math.round(k)-P)||1,L=(a+u)*m+S,F=Math.abs(Math.round(L)-M)||1;return n.setTransform(Math.sign(p),0,0,Math.sign(m),P,M),n.drawImage(e,t,r,i,s,0,0,O,F),n.setTransform(p,f,g,m,C,S),[O,F]}if(p===0&&m===0){const R=a*g+C,P=Math.round(R),I=o*f+S,M=Math.round(I),k=(a+u)*g+C,O=Math.abs(Math.round(k)-P)||1,L=(o+l)*f+S,F=Math.abs(Math.round(L)-M)||1;return n.setTransform(0,Math.sign(f),Math.sign(g),0,P,M),n.drawImage(e,t,r,i,s,0,0,F,O),n.setTransform(p,f,g,m,C,S),[F,O]}n.drawImage(e,t,r,i,s,o,a,l,u);const w=Math.hypot(p,f),b=Math.hypot(g,m);return[w*l,b*u]}class xD{constructor(e,t,r){G(this,"alphaIsShape",!1);G(this,"fontSize",0);G(this,"fontSizeScale",1);G(this,"textMatrix",null);G(this,"textMatrixScale",1);G(this,"fontMatrix",bE);G(this,"leading",0);G(this,"x",0);G(this,"y",0);G(this,"lineX",0);G(this,"lineY",0);G(this,"charSpacing",0);G(this,"wordSpacing",0);G(this,"textHScale",1);G(this,"textRenderingMode",hn.FILL);G(this,"textRise",0);G(this,"fillColor","#000000");G(this,"strokeColor","#000000");G(this,"patternFill",!1);G(this,"patternStroke",!1);G(this,"fillAlpha",1);G(this,"strokeAlpha",1);G(this,"lineWidth",1);G(this,"activeSMask",null);G(this,"transferMaps","none");r==null||r(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=pd.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=jn.FILL,t=null){const r=this.minMax.slice();if(e===jn.STROKE){t||Pt("Stroke bounding box must include transform."),be.singularValueDecompose2dScale(t,ni);const i=ni[0]*this.lineWidth/2,s=ni[1]*this.lineWidth/2;r[0]-=i,r[1]-=s,r[2]+=i,r[3]+=s}return r}updateClipFromPath(){const e=be.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(pd,0)}getClippedPathBoundingBox(e=jn.FILL,t=null){return be.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function ID(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,r=e.width,i=t%Rr,s=(t-i)/Rr,o=i===0?s:s+1,a=n.createImageData(r,Rr);let l=0,u;const p=e.data,f=a.data;let g,m,C,S;if(e.kind===PC.GRAYSCALE_1BPP){const w=p.byteLength,b=new Uint32Array(f.buffer,0,f.byteLength>>2),R=b.length,P=r+7>>3,I=4294967295,M=mn.isLittleEndian?4278190080:255;for(g=0;g<o;g++){for(C=g<s?Rr:i,u=0,m=0;m<C;m++){const k=w-l;let O=0;const L=k>P?r:k*8-7,F=L&-8;let H=0,V=0;for(;O<F;O+=8)V=p[l++],b[u++]=V&128?I:M,b[u++]=V&64?I:M,b[u++]=V&32?I:M,b[u++]=V&16?I:M,b[u++]=V&8?I:M,b[u++]=V&4?I:M,b[u++]=V&2?I:M,b[u++]=V&1?I:M;for(;O<L;O++)H===0&&(V=p[l++],H=128),b[u++]=V&H?I:M,H>>=1}for(;u<R;)b[u++]=0;n.putImageData(a,0,g*Rr)}}else if(e.kind===PC.RGBA_32BPP){for(m=0,S=r*Rr*4,g=0;g<s;g++)f.set(p.subarray(l,l+S)),l+=S,n.putImageData(a,0,m),m+=Rr;g<o&&(S=r*i*4,f.set(p.subarray(l,l+S)),n.putImageData(a,0,m))}else if(e.kind===PC.RGB_24BPP)for(C=Rr,S=r*C,g=0;g<o;g++){for(g>=s&&(C=i,S=r*C),u=0,m=S;m--;)f[u++]=p[l++],f[u++]=p[l++],f[u++]=p[l++],f[u++]=255;n.putImageData(a,0,g*Rr)}else throw new Error(`bad image kind: ${e.kind}`)}function _D(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,r=e.width,i=t%Rr,s=(t-i)/Rr,o=i===0?s:s+1,a=n.createImageData(r,Rr);let l=0;const u=e.data,p=a.data;for(let f=0;f<o;f++){const g=f<s?Rr:i;({srcPos:l}=R6({src:u,srcPos:l,dest:p,width:r,height:g,nonBlackColor:0})),n.putImageData(a,0,f*Rr)}}function wv(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of t)n[r]!==void 0&&(e[r]=n[r]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function CC(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function kD(n,e){if(e)return!0;be.singularValueDecompose2dScale(n,ni);const t=Math.fround(Us.pixelRatio*mc.PDF_TO_CSS_UNITS);return ni[0]<=t&&ni[1]<=t}const I6=["butt","round","square"],_6=["miter","round","bevel"],k6={},MD={};var ns,ZE,eR,tR;const RP=class RP{constructor(e,t,r,i,s,{optionalContentConfig:o,markedContentStack:a=null},l,u,p){_(this,ns);this.ctx=e,this.current=new xD(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new x6(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(e,t,r=null){var i;return typeof t=="string"?((i=this.dependencyTracker)==null||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):r}beginDrawing({transform:e,viewport:t,transparency:r=!1,background:i=null}){const s=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=a,r){const l=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Wt(this.compositeCtx))}this.ctx.save(),CC(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Wt(this.ctx)}executeOperatorList(e,t,r,i,s){var b;const o=e.argsArray,a=e.fnArray;let l=t||0;const u=o.length;if(u===l)return l;const p=u-l>TD&&typeof r=="function",f=p?Date.now()+P6:0;let g=0;const m=this.commonObjs,C=this.objs;let S,w;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,r),l;if(!s||s(l))if(S=a[l],w=o[l]??null,S!==Xv.dependency)w===null?this[S](l):this[S](l,...w);else for(const R of w){(b=this.dependencyTracker)==null||b.recordNamedData(R,l);const P=R.startsWith("g_")?m:C;if(!P.has(R))return P.get(R,r),l}if(l++,l===u)return l;if(p&&++g>TD){if(Date.now()>f)return r(),l;g=0}}}endDrawing(){D(this,ns,ZE).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),D(this,ns,eR).call(this)}_scaleImage(e,t){const r=e.width??e.displayWidth,i=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=r,l=i,u="prescale1",p,f;for(;s>2&&a>1||o>2&&l>1;){let g=a,m=l;s>2&&a>1&&(g=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),s/=a/g),o>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/m),p=this.cachedCanvases.getCanvas(u,g,m),f=p.context,f.clearRect(0,0,g,m),f.drawImage(e,0,0,a,l,0,0,g,m),e=p.canvas,a=g,l=m,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e,t){var H,V;const r=this.ctx,{width:i,height:s}=t,o=this.current.fillColor,a=this.current.patternFill,l=Wt(r);let u,p,f,g;if((t.bitmap||t.data)&&t.count>1){const ie=t.bitmap||t.data.buffer;p=JSON.stringify(a?l:[l.slice(0,4),o]),u=this._cachedBitmapsMap.get(ie),u||(u=new Map,this._cachedBitmapsMap.set(ie,u));const J=u.get(p);if(J&&!a){const ee=Math.round(Math.min(l[0],l[2])+l[4]),se=Math.round(Math.min(l[1],l[3])+l[5]);return(H=this.dependencyTracker)==null||H.recordDependencies(e,fi.transformAndFill),{canvas:J,offsetX:ee,offsetY:se}}f=J}f||(g=this.cachedCanvases.getCanvas("maskCanvas",i,s),_D(g.context,t));let m=be.transform(l,[1/i,0,0,-1/s,0,0]);m=be.transform(m,[1,0,0,1,0,-s]);const C=pd.slice();be.axialAlignedBoundingBox([0,0,i,s],m,C);const[S,w,b,R]=C,P=Math.round(b-S)||1,I=Math.round(R-w)||1,M=this.cachedCanvases.getCanvas("fillCanvas",P,I),k=M.context,O=S,L=w;k.translate(-O,-L),k.transform(...m),f||(f=this._scaleImage(g.canvas,gs(k)),f=f.img,u&&a&&u.set(p,f)),k.imageSmoothingEnabled=kD(Wt(k),t.interpolate),SC(k,f,0,0,f.width,f.height,0,0,i,s),k.globalCompositeOperation="source-in";const F=be.transform(gs(k),[1,0,0,1,-O,-L]);return k.fillStyle=a?o.getPattern(r,this,F,jn.FILL,e):o,k.fillRect(0,0,i,s),u&&!a&&(this.cachedCanvases.delete("fillCanvas"),u.set(p,M.canvas)),(V=this.dependencyTracker)==null||V.recordDependencies(e,fi.transformAndFill),{canvas:M.canvas,offsetX:Math.round(O),offsetY:Math.round(L)}}setLineWidth(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineCap",e),this.ctx.lineCap=I6[t]}setLineJoin(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineJoin",e),this.ctx.lineJoin=_6[t]}setMiterLimit(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,r){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=r)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var r,i,s,o,a;for(const[l,u]of t)switch(l){case"LW":this.setLineWidth(e,u);break;case"LC":this.setLineCap(e,u);break;case"LJ":this.setLineJoin(e,u);break;case"ML":this.setMiterLimit(e,u);break;case"D":this.setDash(e,u[0],u[1]);break;case"RI":this.setRenderingIntent(e,u);break;case"FL":this.setFlatness(e,u);break;case"Font":this.setFont(e,u[0],u[1]);break;case"CA":(r=this.dependencyTracker)==null||r.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=u;break;case"ca":(i=this.dependencyTracker)==null||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(s=this.dependencyTracker)==null||s.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=u;break;case"SMask":(o=this.dependencyTracker)==null||o.recordSimpleData("SMask",e),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(a=this.dependencyTracker)==null||a.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,r=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,r);this.suspendedCtx=this.ctx;const o=this.ctx=s.context;o.setTransform(this.suspendedCtx.getTransform()),wv(this.suspendedCtx,o),T6(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),wv(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,r,i){const s=i[0],o=i[1],a=i[2]-s,l=i[3]-o;a===0||l===0||(this.genericComposeSMask(t.context,r,a,l,t.subtype,t.backdrop,t.transferMap,s,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,t,r,i,s,o,a,l,u,p,f){let g=e.canvas,m=l-p,C=u-f;if(o)if(m<0||C<0||m+r>g.width||C+i>g.height){const w=this.cachedCanvases.getCanvas("maskExtension",r,i),b=w.context;b.drawImage(g,-m,-C),b.globalCompositeOperation="destination-atop",b.fillStyle=o,b.fillRect(0,0,r,i),b.globalCompositeOperation="source-over",g=w.canvas,m=C=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const w=new Path2D;w.rect(m,C,r,i),e.clip(w),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(m,C,r,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const S=new Path2D;S.rect(l,u,r,i),t.clip(S),t.globalCompositeOperation="destination-in",t.drawImage(g,m,C,r,i,l,u,r,i),t.restore()}save(e){var r;this.inSMaskMode&&wv(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(r=this.dependencyTracker)==null||r.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&wv(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,r,i,s,o,a){var l;(l=this.dependencyTracker)==null||l.recordIncrementalData("transform",e),this.ctx.transform(t,r,i,s,o,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,r,i){let[s]=r;if(!i){s||(s=r[0]=new Path2D),this[t](e,s);return}if(this.dependencyTracker!==null){const o=t===Xv.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-o,i[2]+o,i[1]-o,i[3]+o).recordDependencies(e,["transform"])}s instanceof Path2D||(s=r[0]=BO(s)),be.axialAlignedBoundingBox(i,Wt(this.ctx),this.current.minMax),this[t](e,s),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,r=!0){var o;const i=this.ctx,s=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const a=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=s.getPattern(i,this,gs(i),jn.STROKE,e),a){const l=new Path2D;l.addPath(t,i.getTransform().invertSelf().multiplySelf(a)),t=l}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);(o=this.dependencyTracker)==null||o.recordDependencies(e,fi.stroke),r&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(jn.STROKE,Wt(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,r=!0){var u,p,f;const i=this.ctx,s=this.current.fillColor,o=this.current.patternFill;let a=!1;if(o){const g=s.isModifyingCurrentTransform()?i.getTransform():null;if((u=this.dependencyTracker)==null||u.save(e),i.save(),i.fillStyle=s.getPattern(i,this,gs(i),jn.FILL,e),g){const m=new Path2D;m.addPath(t,i.getTransform().invertSelf().multiplySelf(g)),t=m}a=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),(p=this.dependencyTracker)==null||p.recordDependencies(e,fi.fill),a&&(i.restore(),(f=this.dependencyTracker)==null||f.restore(e)),r&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var r;this.ctx.fill(t),(r=this.dependencyTracker)==null||r.recordDependencies(e,fi.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=k6}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=MD}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,r=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,s=r.getTransform().invertSelf();for(const{transform:o,x:a,y:l,fontSize:u,path:p}of t)p&&i.addPath(p,new DOMMatrix(o).preMultiplySelf(s).translate(a,l).scale(u,-u));r.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,r){var f,g;(f=this.dependencyTracker)==null||f.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=i.fontMatrix||bE,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Le("Invalid font matrix for font "+t),r<0?(r=-r,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=r,i.isType3Font)return;const o=i.loadedName||"sans-serif",a=((g=i.systemFontInfo)==null?void 0:g.css)||`"${o}", ${i.fallbackName}`;let l="normal";i.black?l="900":i.bold&&(l="bold");const u=i.italic?"italic":"normal";let p=r;r<RD?p=RD:r>PD&&(p=PD),this.current.fontSizeScale=r/p,this.ctx.font=`${u} ${l} ${p}px ${a}`}setTextRenderingMode(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,r){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=r}setLeadingMoveText(e,t,r){this.setLeading(e,-r),this.moveText(e,t,r)}setTextMatrix(e,t){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:r}=this;r.textMatrix=t,r.textMatrixScale=Math.hypot(t[0],t[1]),r.x=r.lineX=0,r.y=r.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,r,i,s,o){var b,R,P,I;const a=this.ctx,l=this.current,u=l.font,p=l.textRenderingMode,f=l.fontSize/l.fontSizeScale,g=p&hn.FILL_STROKE_MASK,m=!!(p&hn.ADD_TO_PATH_FLAG),C=l.patternFill&&!u.missingFile,S=l.patternStroke&&!u.missingFile;let w;if((u.disableFontFace||m||C||S)&&!u.missingFile&&(w=u.getPathGenerator(this.commonObjs,t)),w&&(u.disableFontFace||C||S)){a.save(),a.translate(r,i),a.scale(f,-f),(b=this.dependencyTracker)==null||b.recordCharacterBBox(e,a,u);let M;if(g===hn.FILL||g===hn.FILL_STROKE)if(s){M=a.getTransform(),a.setTransform(...s);const k=D(this,ns,tR).call(this,w,M,s);a.fill(k)}else a.fill(w);if(g===hn.STROKE||g===hn.FILL_STROKE)if(o){M||(M=a.getTransform()),a.setTransform(...o);const{a:k,b:O,c:L,d:F}=M,H=be.inverseTransform(o),V=be.transform([k,O,L,F,0,0],H);be.singularValueDecompose2dScale(V,ni),a.lineWidth*=Math.max(ni[0],ni[1])/f,a.stroke(D(this,ns,tR).call(this,w,M,o))}else a.lineWidth/=f,a.stroke(w);a.restore()}else(g===hn.FILL||g===hn.FILL_STROKE)&&(a.fillText(t,r,i),(R=this.dependencyTracker)==null||R.recordCharacterBBox(e,a,u,f,r,i,()=>a.measureText(t))),(g===hn.STROKE||g===hn.FILL_STROKE)&&(this.dependencyTracker&&((P=this.dependencyTracker)==null||P.recordCharacterBBox(e,a,u,f,r,i,()=>a.measureText(t)).recordDependencies(e,fi.stroke)),a.strokeText(t,r,i));m&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Wt(a),x:r,y:i,fontSize:f,path:w}),(I=this.dependencyTracker)==null||I.recordCharacterBBox(e,a,u,f,r,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let r=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){r=!0;break}return ze(this,"isFontSubpixelAAEnabled",r)}showText(e,t){var V,ie,J,ee;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,fi.showText).resetBBox(e),this.current.textRenderingMode&hn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const r=this.current,i=r.font;if(i.isType3Font){this.showType3Text(e,t),(V=this.dependencyTracker)==null||V.recordShowTextOperation(e);return}const s=r.fontSize;if(s===0){(ie=this.dependencyTracker)==null||ie.recordOperation(e);return}const o=this.ctx,a=r.fontSizeScale,l=r.charSpacing,u=r.wordSpacing,p=r.fontDirection,f=r.textHScale*p,g=t.length,m=i.vertical,C=m?1:-1,S=i.defaultVMetrics,w=s*r.fontMatrix[0],b=r.textRenderingMode===hn.FILL&&!i.disableFontFace&&!r.patternFill;o.save(),r.textMatrix&&o.transform(...r.textMatrix),o.translate(r.x,r.y+r.textRise),p>0?o.scale(f,-1):o.scale(f,1);let R,P;const I=r.textRenderingMode&hn.FILL_STROKE_MASK,M=I===hn.FILL||I===hn.FILL_STROKE,k=I===hn.STROKE||I===hn.FILL_STROKE;if(M&&r.patternFill){o.save();const se=r.fillColor.getPattern(o,this,gs(o),jn.FILL,e);R=Wt(o),o.restore(),o.fillStyle=se}if(k&&r.patternStroke){o.save();const se=r.strokeColor.getPattern(o,this,gs(o),jn.STROKE,e);P=Wt(o),o.restore(),o.strokeStyle=se}let O=r.lineWidth;const L=r.textMatrixScale;if(L===0||O===0?k&&(O=this.getSinglePixelWidth()):O/=L,a!==1&&(o.scale(a,a),O/=a),o.lineWidth=O,i.isInvalidPDFjsFont){const se=[];let ne=0;for(const K of t)se.push(K.unicode),ne+=K.width;const Q=se.join("");if(o.fillText(Q,0,0),this.dependencyTracker!==null){const K=o.measureText(Q);this.dependencyTracker.recordBBox(e,this.ctx,-K.actualBoundingBoxLeft,K.actualBoundingBoxRight,-K.actualBoundingBoxAscent,K.actualBoundingBoxDescent).recordShowTextOperation(e)}r.x+=ne*w*f,o.restore(),this.compose();return}let F=0,H;for(H=0;H<g;++H){const se=t[H];if(typeof se=="number"){F+=C*se*s/1e3;continue}let ne=!1;const Q=(se.isSpace?u:0)+l,K=se.fontChar,oe=se.accent;let B,j,$=se.width;if(m){const ye=se.vmetric||S,re=-(se.vmetric?ye[1]:$*.5)*w,te=ye[2]*w;$=ye?-ye[0]:$,B=re/a,j=(F+te)/a}else B=F/a,j=0;let pe;if(i.remeasure&&$>0){pe=o.measureText(K);const ye=pe.width*1e3/s*a;if($<ye&&this.isFontSubpixelAAEnabled){const re=$/ye;ne=!0,o.save(),o.scale(re,1),B/=re}else $!==ye&&(B+=($-ye)/2e3*s/a)}if(this.contentVisible&&(se.isInFont||i.missingFile)){if(b&&!oe)o.fillText(K,B,j),(J=this.dependencyTracker)==null||J.recordCharacterBBox(e,o,pe?{bbox:null}:i,s/a,B,j,()=>pe??o.measureText(K));else if(this.paintChar(e,K,B,j,R,P),oe){const ye=B+s*oe.offset.x/a,re=j-s*oe.offset.y/a;this.paintChar(e,oe.fontChar,ye,re,R,P)}}const ge=m?$*w-Q*p:$*w+Q*p;F+=ge,ne&&o.restore()}m?r.y-=F:r.x+=F*f,o.restore(),this.compose(),(ee=this.dependencyTracker)==null||ee.recordShowTextOperation(e)}showType3Text(e,t){const r=this.ctx,i=this.current,s=i.font,o=i.fontSize,a=i.fontDirection,l=s.vertical?1:-1,u=i.charSpacing,p=i.wordSpacing,f=i.textHScale*a,g=i.fontMatrix||bE,m=t.length,C=i.textRenderingMode===hn.INVISIBLE;let S,w,b,R;if(C||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,r.save(),i.textMatrix&&r.transform(...i.textMatrix),r.translate(i.x,i.y+i.textRise),r.scale(f,a);const P=this.dependencyTracker;for(this.dependencyTracker=P?new h0(P,e):null,S=0;S<m;++S){if(w=t[S],typeof w=="number"){R=l*w*o/1e3,this.ctx.translate(R,0),i.x+=R*f;continue}const I=(w.isSpace?p:0)+u,M=s.charProcOperatorList[w.operatorListId];M?this.contentVisible&&(this.save(),r.scale(o,o),r.transform(...g),this.executeOperatorList(M),this.restore()):Le(`Type3 character "${w.operatorListId}" is not available.`);const k=[w.width,0];be.applyTransform(k,g),b=k[0]*o+I,r.translate(b,0),i.x+=b*f}r.restore(),P&&(this.dependencyTracker=P)}setCharWidth(e,t,r){}setCharWidthAndBounds(e,t,r,i,s,o,a){var u;const l=new Path2D;l.rect(i,s,o-i,a-s),this.ctx.clip(l),(u=this.dependencyTracker)==null||u.recordBBox(e,this.ctx,i,o,s,a).recordClipBox(e,this.ctx,i,o,s,a),this.endPath(e)}getColorN_Pattern(e,t){let r;if(t[0]==="TilingPattern"){const i=this.baseTransform||Wt(this.ctx),s={createCanvasGraphics:(o,a)=>new RP(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new h0(this.dependencyTracker,a,!0):null)};r=new QE(t,this.ctx,s,i)}else r=this._getPattern(e,t[1],t[2]);return r}setStrokeColorN(e,...t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,r=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=E6(this.getObject(e,t)),this.cachedPatterns.set(t,i)),r&&(i.matrix=r),i}shadingFill(e,t){var o;if(!this.contentVisible)return;const r=this.ctx;this.save(e);const i=this._getPattern(e,t);r.fillStyle=i.getPattern(r,this,gs(r),jn.SHADING,e);const s=gs(r);if(s){const{width:a,height:l}=r.canvas,u=pd.slice();be.axialAlignedBoundingBox([0,0,a,l],s,u);const[p,f,g,m]=u;this.ctx.fillRect(p,f,g-p,m-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(o=this.dependencyTracker)==null||o.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,fi.transform).recordDependencies(e,fi.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Pt("Should not call beginInlineImage")}beginImageData(){Pt("Should not call beginImageData")}paintFormXObjectBegin(e,t,r){var i;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Wt(this.ctx),r)){be.axialAlignedBoundingBox(r,this.baseTransform,this.current.minMax);const[s,o,a,l]=r,u=new Path2D;u.rect(s,o,a-s,l-o),this.ctx.clip(u),(i=this.dependencyTracker)==null||i.recordClipBox(e,this.ctx,s,a,o,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var P;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;t.isolated||q0("TODO: Support non-isolated groups."),t.knockout&&Le("Knockout groups not supported.");const i=Wt(r);if(t.matrix&&r.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=pd.slice();be.axialAlignedBoundingBox(t.bbox,Wt(r),s);const o=[0,0,r.canvas.width,r.canvas.height];s=be.intersect(s,o)||[0,0,0,0];const a=Math.floor(s[0]),l=Math.floor(s[1]),u=Math.max(Math.ceil(s[2])-a,1),p=Math.max(Math.ceil(s[3])-l,1);this.current.startNewPathAndClipBox([0,0,u,p]);let f="groupAt"+this.groupLevel;t.smask&&(f+="_smask_"+this.smaskCounter++%2);const g=this.cachedCanvases.getCanvas(f,u,p),m=g.context;m.translate(-a,-l),m.transform(...i);let C=new Path2D;const[S,w,b,R]=t.bbox;if(C.rect(S,w,b-S,R-w),t.matrix){const I=new Path2D;I.addPath(C,new DOMMatrix(t.matrix)),C=I}m.clip(C),t.smask&&this.smaskStack.push({canvas:g.canvas,context:m,offsetX:a,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(r.setTransform(1,0,0,1,0,0),r.translate(a,l),r.save()),wv(r,m),this.ctx=m,(P=this.dependencyTracker)==null||P.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(r),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(e,t){var s;if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,(s=this.dependencyTracker)==null||s.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=Wt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const a=pd.slice();be.axialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],o,a),this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,r,i,s,o){if(D(this,ns,ZE).call(this),CC(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),r){const a=r[2]-r[0],l=r[3]-r[1];if(o&&this.annotationCanvasMap){i=i.slice(),i[4]-=r[0],i[5]-=r[1],r=r.slice(),r[0]=r[1]=0,r[2]=a,r[3]=l,be.singularValueDecompose2dScale(Wt(this.ctx),ni);const{viewportScale:u}=this,p=Math.ceil(a*this.outputScaleX*u),f=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(p,f);const{canvas:g,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(t,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(ni[0],0,0,-ni[1],0,l*ni[1]),CC(this.ctx)}else{CC(this.ctx),this.endPath(e);const u=new Path2D;u.rect(r[0],r[1],a,l),this.ctx.clip(u)}}this.current=new xD(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...s)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),D(this,ns,eR).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var a;if(!this.contentVisible)return;const r=t.count;t=this.getObject(e,t.data,t),t.count=r;const i=this.ctx,s=this._createMaskCanvas(e,t),o=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(o,s.offsetX,s.offsetY),(a=this.dependencyTracker)==null||a.resetBBox(e).recordBBox(e,this.ctx,s.offsetX,s.offsetX+o.width,s.offsetY,s.offsetY+o.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,r,i=0,s=0,o,a){var f,g,m;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const l=this.ctx;l.save();const u=Wt(l);l.transform(r,i,s,o,0,0);const p=this._createMaskCanvas(e,t);l.setTransform(1,0,0,1,p.offsetX-u[4],p.offsetY-u[5]),(f=this.dependencyTracker)==null||f.resetBBox(e);for(let C=0,S=a.length;C<S;C+=2){const w=be.transform(u,[r,i,s,o,a[C],a[C+1]]);l.drawImage(p.canvas,w[4],w[5]),(g=this.dependencyTracker)==null||g.recordBBox(e,this.ctx,w[4],w[4]+p.canvas.width,w[5],w[5]+p.canvas.height)}l.restore(),this.compose(),(m=this.dependencyTracker)==null||m.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var o,a,l;if(!this.contentVisible)return;const r=this.ctx,i=this.current.fillColor,s=this.current.patternFill;(o=this.dependencyTracker)==null||o.resetBBox(e).recordDependencies(e,fi.transformAndFill);for(const u of t){const{data:p,width:f,height:g,transform:m}=u,C=this.cachedCanvases.getCanvas("maskCanvas",f,g),S=C.context;S.save();const w=this.getObject(e,p,u);_D(S,w),S.globalCompositeOperation="source-in",S.fillStyle=s?i.getPattern(S,this,gs(r),jn.FILL,e):i,S.fillRect(0,0,f,g),S.restore(),r.save(),r.transform(...m),r.scale(1,-1),SC(r,C.canvas,0,0,f,g,0,-1,1,1),(a=this.dependencyTracker)==null||a.recordBBox(e,r,0,f,0,g),r.restore()}this.compose(),(l=this.dependencyTracker)==null||l.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const r=this.getObject(e,t);if(!r){Le("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,r)}paintImageXObjectRepeat(e,t,r,i,s){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){Le("Dependent image isn't ready yet");return}const a=o.width,l=o.height,u=[];for(let p=0,f=s.length;p<f;p+=2)u.push({transform:[r,0,0,i,s[p],s[p+1]],x:0,y:0,w:a,h:l});this.paintInlineImageXObjectGroup(e,o,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:r,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",r,i),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",s.canvas}paintInlineImageXObject(e,t){var u;if(!this.contentVisible)return;const r=t.width,i=t.height,s=this.ctx;this.save(e);const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none"),s.scale(1/r,-1/i);let a;if(t.bitmap)a=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)a=t;else{const f=this.cachedCanvases.getCanvas("inlineImage",r,i).context;ID(f,t),a=this.applyTransferMapsToCanvas(f)}const l=this._scaleImage(a,gs(s));s.imageSmoothingEnabled=kD(Wt(s),t.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,s,0,r,-i,0).recordDependencies(e,fi.imageXObject).recordOperation(e),SC(s,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,r,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,r){var o,a,l;if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const u=t.width,p=t.height,g=this.cachedCanvases.getCanvas("inlineImage",u,p).context;ID(g,t),s=this.applyTransferMapsToCanvas(g)}(o=this.dependencyTracker)==null||o.resetBBox(e);for(const u of r)i.save(),i.transform(...u.transform),i.scale(1,-1),SC(i,s,u.x,u.y,u.w,u.h,0,-1,1,1),(a=this.dependencyTracker)==null||a.recordBBox(e,i,0,1,-1,0),i.restore();(l=this.dependencyTracker)==null||l.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,fi.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,r){}beginMarkedContent(e,t){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,r){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,r){var o,a;const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(r);const s=this.ctx;this.pendingClip?(i||(this.pendingClip===MD?s.clip(t,"evenodd"):s.clip(t)),this.pendingClip=null,(o=this.dependencyTracker)==null||o.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(a=this.dependencyTracker)==null||a.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Wt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:r,c:i,d:s}=this.ctx.getTransform();let o,a;if(r===0&&i===0){const l=Math.abs(t),u=Math.abs(s);if(l===u)if(e===0)o=a=1/l;else{const p=l*e;o=a=p<1?1/p:1}else if(e===0)o=1/l,a=1/u;else{const p=l*e,f=u*e;o=p<1?1/p:1,a=f<1?1/f:1}}else{const l=Math.abs(t*s-r*i),u=Math.hypot(t,r),p=Math.hypot(i,s);if(e===0)o=p/l,a=u/l;else{const f=e*l;o=p>f?p/f:1,a=u>f?u/f:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:r,current:{lineWidth:i}}=this,[s,o]=this.getScaleForStroking();if(s===o){r.lineWidth=(i||1)*s,r.stroke(e);return}const a=r.getLineDash();t&&r.save(),r.scale(s,o),aE.a=1/s,aE.d=1/o;const l=new Path2D;if(l.addPath(e,aE),a.length>0){const u=Math.max(s,o);r.setLineDash(a.map(p=>p/u)),r.lineDashOffset/=u}r.lineWidth=i||1,r.stroke(l),t&&r.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};ns=new WeakSet,ZE=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},eR=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},tR=function(e,t,r){const i=new Path2D;return i.addPath(e,new DOMMatrix(r).invertSelf().multiplySelf(t)),i};let yd=RP;for(const n in Xv)yd.prototype[n]!==void 0&&(yd.prototype[Xv[n]]=yd.prototype[n]);var Hm,Wm;class Bs{static get workerPort(){return h(this,Hm)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");T(this,Hm,e)}static get workerSrc(){return h(this,Wm)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");T(this,Wm,e)}}Hm=new WeakMap,Wm=new WeakMap,_(Bs,Hm,null),_(Bs,Wm,"");var th,qm;class M6{constructor({parsedData:e,rawData:t}){_(this,th);_(this,qm);T(this,th,e),T(this,qm,t)}getRaw(){return h(this,qm)}get(e){return h(this,th).get(e)??null}[Symbol.iterator](){return h(this,th).entries()}}th=new WeakMap,qm=new WeakMap;const cd=Symbol("INTERNAL");var Vm,Gm,Km,nh;class D6{constructor(e,{name:t,intent:r,usage:i,rbGroups:s}){_(this,Vm,!1);_(this,Gm,!1);_(this,Km,!1);_(this,nh,!0);T(this,Vm,!!(e&ti.DISPLAY)),T(this,Gm,!!(e&ti.PRINT)),this.name=t,this.intent=r,this.usage=i,this.rbGroups=s}get visible(){if(h(this,Km))return h(this,nh);if(!h(this,nh))return!1;const{print:e,view:t}=this.usage;return h(this,Vm)?(t==null?void 0:t.viewState)!=="OFF":h(this,Gm)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,r=!1){e!==cd&&Pt("Internal method `_setVisible` called."),T(this,Km,r),T(this,nh,t)}}Vm=new WeakMap,Gm=new WeakMap,Km=new WeakMap,nh=new WeakMap;var Ga,bt,rh,ih,$m,nR;class N6{constructor(e,t=ti.DISPLAY){_(this,$m);_(this,Ga,null);_(this,bt,new Map);_(this,rh,null);_(this,ih,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,T(this,ih,e.order);for(const r of e.groups)h(this,bt).set(r.id,new D6(t,r));if(e.baseState==="OFF")for(const r of h(this,bt).values())r._setVisible(cd,!1);for(const r of e.on)h(this,bt).get(r)._setVisible(cd,!0);for(const r of e.off)h(this,bt).get(r)._setVisible(cd,!1);T(this,rh,this.getHash())}}isVisible(e){if(h(this,bt).size===0)return!0;if(!e)return q0("Optional content group not defined."),!0;if(e.type==="OCG")return h(this,bt).has(e.id)?h(this,bt).get(e.id).visible:(Le(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return D(this,$m,nR).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!h(this,bt).has(t))return Le(`Optional content group not found: ${t}`),!0;if(h(this,bt).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!h(this,bt).has(t))return Le(`Optional content group not found: ${t}`),!0;if(!h(this,bt).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!h(this,bt).has(t))return Le(`Optional content group not found: ${t}`),!0;if(!h(this,bt).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!h(this,bt).has(t))return Le(`Optional content group not found: ${t}`),!0;if(h(this,bt).get(t).visible)return!1}return!0}return Le(`Unknown optional content policy ${e.policy}.`),!0}return Le(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,r=!0){var s;const i=h(this,bt).get(e);if(!i){Le(`Optional content group not found: ${e}`);return}if(r&&t&&i.rbGroups.length)for(const o of i.rbGroups)for(const a of o)a!==e&&((s=h(this,bt).get(a))==null||s._setVisible(cd,!1,!0));i._setVisible(cd,!!t,!0),T(this,Ga,null)}setOCGState({state:e,preserveRB:t}){let r;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":r=i;continue}const s=h(this,bt).get(i);if(s)switch(r){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!s.visible,t);break}}T(this,Ga,null)}get hasInitialVisibility(){return h(this,rh)===null||this.getHash()===h(this,rh)}getOrder(){return h(this,bt).size?h(this,ih)?h(this,ih).slice():[...h(this,bt).keys()]:null}getGroup(e){return h(this,bt).get(e)||null}getHash(){if(h(this,Ga)!==null)return h(this,Ga);const e=new y2;for(const[t,r]of h(this,bt))e.update(`${t}:${r.visible}`);return T(this,Ga,e.hexdigest())}[Symbol.iterator](){return h(this,bt).entries()}}Ga=new WeakMap,bt=new WeakMap,rh=new WeakMap,ih=new WeakMap,$m=new WeakSet,nR=function(e){const t=e.length;if(t<2)return!0;const r=e[0];for(let i=1;i<t;i++){const s=e[i];let o;if(Array.isArray(s))o=D(this,$m,nR).call(this,s);else if(h(this,bt).has(s))o=h(this,bt).get(s).visible;else return Le(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return r==="And"};class O6{constructor(e,{disableRange:t=!1,disableStream:r=!1}){rt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(s==null?void 0:s.length)>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const r=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(r),!0)});rt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,r,i,s;e.total===void 0?(r=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||r.call(t,{loaded:e.loaded}):(s=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||s.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){rt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new L6(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new j6(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeReaders.slice(0))r.cancel(e);this._pdfDataRangeTransport.abort()}}class L6{constructor(e,t,r=!1,i=null){this._stream=e,this._done=r||!1,this._filename=dP(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class j6{constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function z6(n){let e=!0,t=r("filename\\*","i").exec(n);if(t){t=t[1];let p=a(t);return p=unescape(p),p=l(p),p=u(p),s(p)}if(t=o(n),t){const p=u(t);return s(p)}if(t=r("filename","i").exec(n),t){t=t[1];let p=a(t);return p=u(p),s(p)}function r(p,f){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function i(p,f){if(p){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const g=new TextDecoder(p,{fatal:!0}),m=$y(f);f=g.decode(m),e=!1}catch{}}return f}function s(p){return e&&/[\x80-\xff]/.test(p)&&(p=i("utf-8",p),e&&(p=i("iso-8859-1",p))),p}function o(p){const f=[];let g;const m=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(g=m.exec(p))!==null;){let[,S,w,b]=g;if(S=parseInt(S,10),S in f){if(S===0)break;continue}f[S]=[w,b]}const C=[];for(let S=0;S<f.length&&S in f;++S){let[w,b]=f[S];b=a(b),w&&(b=unescape(b),S===0&&(b=l(b))),C.push(b)}return C.join("")}function a(p){if(p.startsWith('"')){const f=p.slice(1).split('\\"');for(let g=0;g<f.length;++g){const m=f[g].indexOf('"');m!==-1&&(f[g]=f[g].slice(0,m),f.length=g+1),f[g]=f[g].replaceAll(/\\(.)/g,"$1")}p=f.join('"')}return p}function l(p){const f=p.indexOf("'");if(f===-1)return p;const g=p.slice(0,f),C=p.slice(f+1).replace(/^[^']*'/,"");return i(g,C)}function u(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,g,m,C){if(m==="q"||m==="Q")return C=C.replaceAll("_"," "),C=C.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,w){return String.fromCharCode(parseInt(w,16))}),i(g,C);try{C=atob(C)}catch{}return i(g,C)})}return""}function _2(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const r in e){const i=e[r];i!==void 0&&t.append(r,i)}return t}function G0(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function k2({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:r}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*t)||r||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function M2(n){const e=n.get("Content-Disposition");if(e){let t=z6(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(dP(t))return t}return null}function Zy(n,e){return new o0(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function D2(n){return n===200||n===206}function N2(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function O2(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Le(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class F6{constructor(e){G(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=_2(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return rt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new B6(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new U6(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class B6{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const r=new Headers(e.headers),i=t.url;fetch(i,N2(r,this._withCredentials,this._abortController)).then(s=>{if(e._responseOrigin=G0(s.url),!D2(s.status))throw Zy(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const o=s.headers,{allowRangeRequests:a,suggestedLength:l}=k2({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=M2(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new vc("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:O2(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class U6{constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${t}-${r-1}`);const o=i.url;fetch(o,N2(s,this._withCredentials,this._abortController)).then(a=>{const l=G0(a.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!D2(a.status))throw Zy(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:O2(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const cE=200,lE=206;function H6(n){const e=n.response;return typeof e!="string"?e:$y(e).buffer}class W6{constructor({url:e,httpHeaders:t,withCredentials:r}){G(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=_2(this.isHttp,t),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,r=this.currXhrId++,i=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,o]of this.headers)t.setRequestHeader(s,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=lE):i.expectedStatus=cE,t.responseType="arraybuffer",rt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){var i;const r=this.pendingRequests[e];r&&((i=r.onProgress)==null||i.call(r,t))}onStateChange(e,t){const r=this.pendingRequests[e];if(!r)return;const i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){r.onError(i.status);return}const s=i.status||cE;if(!(s===cE&&r.expectedStatus===lE)&&s!==r.expectedStatus){r.onError(i.status);return}const a=H6(i);if(s===lE){const l=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);u?r.onDone({begin:parseInt(u[1],10),chunk:a}):(Le('Missing or invalid "Content-Range" header.'),r.onError(0))}else a?r.onDone({begin:0,chunk:a}):r.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class q6{constructor(e){this._source=e,this._manager=new W6(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return rt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new V6(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const r=new G6(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class V6{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=G0(t.responseURL);const r=t.getAllResponseHeaders(),i=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[l,...u]=a.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:o}=k2({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=M2(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Zy(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class G6{constructor(e,t,r){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=G0((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Zy(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const K6=/^[a-z][a-z0-9\-+.]+:/i;function $6(n){if(K6.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class J6{constructor(e){this.source=e,this.url=$6(e.url),rt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return rt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new X6(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new Y6(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class X6{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=Zy(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new vc("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Y6{constructor(e,t,r){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Av=Symbol("INITIAL_DATA");var Br,Jm,rR;class L2{constructor(){_(this,Jm);_(this,Br,Object.create(null))}get(e,t=null){if(t){const i=D(this,Jm,rR).call(this,e);return i.promise.then(()=>t(i.data)),null}const r=h(this,Br)[e];if(!r||r.data===Av)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const t=h(this,Br)[e];return!!t&&t.data!==Av}delete(e){const t=h(this,Br)[e];return!t||t.data===Av?!1:(delete h(this,Br)[e],!0)}resolve(e,t=null){const r=D(this,Jm,rR).call(this,e);r.data=t,r.resolve()}clear(){var e;for(const t in h(this,Br)){const{data:r}=h(this,Br)[t];(e=r==null?void 0:r.bitmap)==null||e.close()}T(this,Br,Object.create(null))}*[Symbol.iterator](){for(const e in h(this,Br)){const{data:t}=h(this,Br)[e];t!==Av&&(yield[e,t])}}}Br=new WeakMap,Jm=new WeakSet,rR=function(e){var t;return(t=h(this,Br))[e]||(t[e]={...Promise.withResolvers(),data:Av})};const Q6=1e5,DD=30;var EN,Ka,Ur,Xm,Ym,Fl,To,Qm,Zm,Bl,ey,sh,$a,oh,ty,ah,Ul,ny,ry,ch,Hl,iy,lh,uh,Jo,j2,z2,iR,ii,jC,sR,F2,B2;const kn=class kn{constructor({textContentSource:e,container:t,viewport:r}){_(this,Jo);_(this,Ka,Promise.withResolvers());_(this,Ur,null);_(this,Xm,!1);_(this,Ym,!!((EN=globalThis.FontInspector)!=null&&EN.enabled));_(this,Fl,null);_(this,To,null);_(this,Qm,0);_(this,Zm,0);_(this,Bl,null);_(this,ey,null);_(this,sh,0);_(this,$a,0);_(this,oh,Object.create(null));_(this,ty,[]);_(this,ah,null);_(this,Ul,[]);_(this,ny,new WeakMap);_(this,ry,null);var l;if(e instanceof ReadableStream)T(this,ah,e);else if(typeof e=="object")T(this,ah,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');T(this,Ur,T(this,ey,t)),T(this,$a,r.scale*Us.pixelRatio),T(this,sh,r.rotation),T(this,To,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:o,pageY:a}=r.rawDims;T(this,ry,[1,0,0,-1,-o,a+s]),T(this,Zm,i),T(this,Qm,s),D(l=kn,ii,F2).call(l),t.style.setProperty("--min-font-size",h(kn,lh)),Au(t,r),h(this,Ka).promise.finally(()=>{h(kn,uh).delete(this),T(this,To,null),T(this,oh,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=mn.platform;return ze(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{h(this,Bl).read().then(({value:t,done:r})=>{if(r){h(this,Ka).resolve();return}h(this,Fl)??T(this,Fl,t.lang),Object.assign(h(this,oh),t.styles),D(this,Jo,j2).call(this,t.items),e()},h(this,Ka).reject)};return T(this,Bl,h(this,ah).getReader()),h(kn,uh).add(this),e(),h(this,Ka).promise}update({viewport:e,onBefore:t=null}){var s;const r=e.scale*Us.pixelRatio,i=e.rotation;if(i!==h(this,sh)&&(t==null||t(),T(this,sh,i),Au(h(this,ey),{rotation:i})),r!==h(this,$a)){t==null||t(),T(this,$a,r);const o={div:null,properties:null,ctx:D(s=kn,ii,jC).call(s,h(this,Fl))};for(const a of h(this,Ul))o.properties=h(this,ny).get(a),o.div=a,D(this,Jo,iR).call(this,o)}}cancel(){var t;const e=new vc("TextLayer task cancelled.");(t=h(this,Bl))==null||t.cancel(e).catch(()=>{}),T(this,Bl,null),h(this,Ka).reject(e)}get textDivs(){return h(this,Ul)}get textContentItemsStr(){return h(this,ty)}static cleanup(){if(!(h(this,uh).size>0)){h(this,ch).clear();for(const{canvas:e}of h(this,Hl).values())e.remove();h(this,Hl).clear()}}};Ka=new WeakMap,Ur=new WeakMap,Xm=new WeakMap,Ym=new WeakMap,Fl=new WeakMap,To=new WeakMap,Qm=new WeakMap,Zm=new WeakMap,Bl=new WeakMap,ey=new WeakMap,sh=new WeakMap,$a=new WeakMap,oh=new WeakMap,ty=new WeakMap,ah=new WeakMap,Ul=new WeakMap,ny=new WeakMap,ry=new WeakMap,ch=new WeakMap,Hl=new WeakMap,iy=new WeakMap,lh=new WeakMap,uh=new WeakMap,Jo=new WeakSet,j2=function(e){var i,s;if(h(this,Xm))return;(s=h(this,To)).ctx??(s.ctx=D(i=kn,ii,jC).call(i,h(this,Fl)));const t=h(this,Ul),r=h(this,ty);for(const o of e){if(t.length>Q6){Le("Ignoring additional textDivs for performance reasons."),T(this,Xm,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=h(this,Ur);T(this,Ur,document.createElement("span")),h(this,Ur).classList.add("markedContent"),o.id&&h(this,Ur).setAttribute("id",`${o.id}`),a.append(h(this,Ur))}else o.type==="endMarkedContent"&&T(this,Ur,h(this,Ur).parentNode);continue}r.push(o.str),D(this,Jo,z2).call(this,o)}},z2=function(e){var C;const t=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};h(this,Ul).push(t);const i=be.transform(h(this,ry),e.transform);let s=Math.atan2(i[1],i[0]);const o=h(this,oh)[e.fontName];o.vertical&&(s+=Math.PI/2);let a=h(this,Ym)&&o.fontSubstitution||o.fontFamily;a=kn.fontFamilyMap.get(a)||a;const l=Math.hypot(i[2],i[3]),u=l*D(C=kn,ii,B2).call(C,a,o,h(this,Fl));let p,f;s===0?(p=i[4],f=i[5]-u):(p=i[4]+u*Math.sin(s),f=i[5]-u*Math.cos(s));const g=t.style;g.left=`${(100*p/h(this,Zm)).toFixed(2)}%`,g.top=`${(100*f/h(this,Qm)).toFixed(2)}%`,g.setProperty("--font-height",`${l.toFixed(2)}px`),g.fontFamily=a,r.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,h(this,Ym)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),s!==0&&(r.angle=s*(180/Math.PI));let m=!1;if(e.str.length>1)m=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const S=Math.abs(e.transform[0]),w=Math.abs(e.transform[3]);S!==w&&Math.max(S,w)/Math.min(S,w)>1.5&&(m=!0)}if(m&&(r.canvasWidth=o.vertical?e.height:e.width),h(this,ny).set(t,r),h(this,To).div=t,h(this,To).properties=r,D(this,Jo,iR).call(this,h(this,To)),r.hasText&&h(this,Ur).append(t),r.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),h(this,Ur).append(S)}},iR=function(e){var o;const{div:t,properties:r,ctx:i}=e,{style:s}=t;if(r.canvasWidth!==0&&r.hasText){const{fontFamily:a}=s,{canvasWidth:l,fontSize:u}=r;D(o=kn,ii,sR).call(o,i,u*h(this,$a),a);const{width:p}=i.measureText(t.textContent);p>0&&s.setProperty("--scale-x",l*h(this,$a)/p)}r.angle!==0&&s.setProperty("--rotate",`${r.angle}deg`)},ii=new WeakSet,jC=function(e=null){let t=h(this,Hl).get(e||(e=""));if(!t){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),t=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),h(this,Hl).set(e,t),h(this,iy).set(t,{size:0,family:""})}return t},sR=function(e,t,r){const i=h(this,iy).get(e);t===i.size&&r===i.family||(e.font=`${t}px ${r}`,i.size=t,i.family=r)},F2=function(){if(h(this,lh)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),T(this,lh,e.getBoundingClientRect().height),e.remove()},B2=function(e,t,r){const i=h(this,ch).get(e);if(i)return i;const s=D(this,ii,jC).call(this,r);s.canvas.width=s.canvas.height=DD,D(this,ii,sR).call(this,s,DD,e);const o=s.measureText(""),a=o.fontBoundingBoxAscent,l=Math.abs(o.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let u=.8;return a?u=a/(a+l):(mn.platform.isFirefox&&Le("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),h(this,ch).set(e,u),u},_(kn,ii),_(kn,ch,new Map),_(kn,Hl,new Map),_(kn,iy,new WeakMap),_(kn,lh,null),_(kn,uh,new Set);let Qv=kn;const Z6=100;function U2(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new oR,{docId:t}=e,r=n.url?o6(n.url):null,i=n.data?a6(n.data):null,s=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,l=n.range instanceof H2?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let p=n.worker instanceof Zv?n.worker:null;const f=n.verbosity,g=typeof n.docBaseUrl=="string"&&!V0(n.docBaseUrl)?n.docBaseUrl:null,m=gC(n.cMapUrl),C=n.cMapPacked!==!1,S=n.CMapReaderFactory||(ar?g6:SD),w=gC(n.iccUrl),b=gC(n.standardFontDataUrl),R=n.StandardFontDataFactory||(ar?v6:CD),P=gC(n.wasmUrl),I=n.WasmFactory||(ar?m6:bD),M=n.stopAtErrors!==!0,k=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,O=n.isEvalSupported!==!1,L=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!ar,F=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!ar&&(mn.platform.isFirefox||!globalThis.chrome),H=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,V=typeof n.disableFontFace=="boolean"?n.disableFontFace:ar,ie=n.fontExtraProperties===!0,J=n.enableXfa===!0,ee=n.ownerDocument||globalThis.document,se=n.disableRange===!0,ne=n.disableStream===!0,Q=n.disableAutoFetch===!0,K=n.pdfBug===!0,oe=n.CanvasFactory||(ar?f6:d6),B=n.FilterFactory||(ar?p6:h6),j=n.enableHWA===!0,$=n.useWasm!==!1,pe=l?l.length:n.length??NaN,ge=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!ar&&!V,ye=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(S===SD&&R===CD&&I===bD&&m&&b&&P&&xv(m,document.baseURI)&&xv(b,document.baseURI)&&xv(P,document.baseURI)),re=null;D5(f);const te={canvasFactory:new oe({ownerDocument:ee,enableHWA:j}),filterFactory:new B({docId:t,ownerDocument:ee}),cMapReaderFactory:ye?null:new S({baseUrl:m,isCompressed:C}),standardFontDataFactory:ye?null:new R({baseUrl:b}),wasmFactory:ye?null:new I({baseUrl:P})};p||(p=Zv.create({verbosity:f,port:Bs.workerPort}),e._worker=p);const ae={docId:t,apiVersion:"5.4.530",data:i,password:a,disableAutoFetch:Q,rangeChunkSize:u,length:pe,docBaseUrl:g,enableXfa:J,evaluatorOptions:{maxImageSize:k,disableFontFace:V,ignoreErrors:M,isEvalSupported:O,isOffscreenCanvasSupported:L,isImageDecoderSupported:F,canvasMaxAreaInBytes:H,fontExtraProperties:ie,useSystemFonts:ge,useWasm:$,useWorkerFetch:ye,cMapUrl:m,iccUrl:w,standardFontDataUrl:b,wasmUrl:P}},ve={ownerDocument:ee,pdfBug:K,styleElement:re,loadingParams:{disableAutoFetch:Q,enableXfa:J}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const _e=p.messageHandler.sendWithPromise("GetDocRequest",ae,i?[i.buffer]:null);let Ce;if(l)Ce=new O6(l,{disableRange:se,disableStream:ne});else if(!i){if(!r)throw new Error("getDocument - no `url` parameter provided.");const Ke=xv(r)?F6:ar?J6:q6;Ce=new Ke({url:r,length:pe,httpHeaders:s,withCredentials:o,rangeChunkSize:u,disableRange:se,disableStream:ne})}return _e.then(Ke=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const he=new Lv(t,Ke,p.port),$e=new nU(he,e,Ce,ve,te,j);e._transport=$e,he.send("Ready",null)})}).catch(e._capability.reject),e}var I0;const _0=class _0{constructor(){G(this,"_capability",Promise.withResolvers());G(this,"_transport",null);G(this,"_worker",null);G(this,"docId",`d${dn(_0,I0)._++}`);G(this,"destroyed",!1);G(this,"onPassword",null);G(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,r,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(s){throw(r=this._worker)!=null&&r.port&&delete this._worker._pendingDestroy,s}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};I0=new WeakMap,_(_0,I0,0);let oR=_0;var Wl,sy,oy,ay,cy;class H2{constructor(e,t,r=!1,i=null){_(this,Wl,Promise.withResolvers());_(this,sy,[]);_(this,oy,[]);_(this,ay,[]);_(this,cy,[]);this.length=e,this.initialData=t,this.progressiveDone=r,this.contentDispositionFilename=i}addRangeListener(e){h(this,cy).push(e)}addProgressListener(e){h(this,ay).push(e)}addProgressiveReadListener(e){h(this,oy).push(e)}addProgressiveDoneListener(e){h(this,sy).push(e)}onDataRange(e,t){for(const r of h(this,cy))r(e,t)}onDataProgress(e,t){h(this,Wl).promise.then(()=>{for(const r of h(this,ay))r(e,t)})}onDataProgressiveRead(e){h(this,Wl).promise.then(()=>{for(const t of h(this,oy))t(e)})}onDataProgressiveDone(){h(this,Wl).promise.then(()=>{for(const e of h(this,sy))e()})}transportReady(){h(this,Wl).resolve()}requestDataRange(e,t){Pt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Wl=new WeakMap,sy=new WeakMap,oy=new WeakMap,ay=new WeakMap,cy=new WeakMap;class eU{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ze(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var xo,ql,Uv;class tU{constructor(e,t,r,i=!1){_(this,ql);_(this,xo,!1);this._pageIndex=e,this._pageInfo=t,this._transport=r,this._stats=i?new hD:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new L2,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:s=!1}={}){return new Xy({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ze(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:r,intent:i="display",annotationMode:s=Ra.ENABLE,transform:o=null,background:a=null,optionalContentConfigPromise:l=null,annotationCanvasMap:u=null,pageColors:p=null,printAnnotationStorage:f=null,isEditing:g=!1,recordOperations:m=!1,operationsFilter:C=null}){var F,H,V;(F=this._stats)==null||F.time("Overall");const S=this._transport.getRenderingIntent(i,s,f,g),{renderingIntent:w,cacheKey:b}=S;T(this,xo,!1),l||(l=this._transport.getOptionalContentConfig(w));let R=this._intentStates.get(b);R||(R=Object.create(null),this._intentStates.set(b,R)),R.streamReaderCancelTimeout&&(clearTimeout(R.streamReaderCancelTimeout),R.streamReaderCancelTimeout=null);const P=!!(w&ti.PRINT);R.displayReadyCapability||(R.displayReadyCapability=Promise.withResolvers(),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(H=this._stats)==null||H.time("Page Request"),this._pumpOperatorList(S));const I=!!(this._pdfBug&&((V=globalThis.StepperManager)!=null&&V.enabled)),M=!this.recordedBBoxes&&(m||I),k=ie=>{var J,ee;if(R.renderTasks.delete(O),M){const se=(J=O.gfx)==null?void 0:J.dependencyTracker.take();se&&(O.stepper&&O.stepper.setOperatorBBoxes(se,O.gfx.dependencyTracker.takeDebugMetadata()),m&&(this.recordedBBoxes=se))}P&&T(this,xo,!0),D(this,ql,Uv).call(this),ie?(O.capability.reject(ie),this._abortOperatorList({intentState:R,reason:ie instanceof Error?ie:new Error(ie)})):O.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(ee=globalThis.Stats)!=null&&ee.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},O=new aR({callback:k,params:{canvas:t,canvasContext:e,dependencyTracker:M?new S6(t,R.operatorList.length,I):null,viewport:r,transform:o,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:R.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!P,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:C});(R.renderTasks||(R.renderTasks=new Set)).add(O);const L=O.task;return Promise.all([R.displayReadyCapability.promise,l]).then(([ie,J])=>{var ee;if(this.destroyed){k();return}if((ee=this._stats)==null||ee.time("Rendering"),!(J.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");O.initializeGraphics({transparency:ie,optionalContentConfig:J}),O.operatorListChanged()}).catch(k),L}getOperatorList({intent:e="display",annotationMode:t=Ra.ENABLE,printAnnotationStorage:r=null,isEditing:i=!1}={}){var u;function s(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const o=this._transport.getRenderingIntent(e,t,r,i,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>Yv.textContent(r));const t=this.streamTextContent(e);return new Promise(function(r,i){function s(){o.read().then(function({value:l,done:u}){if(u){r(a);return}a.lang??(a.lang=l.lang),Object.assign(a.styles,l.styles),a.items.push(...l.items),s()},i)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const r of t.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),T(this,xo,!1),Promise.all(e)}cleanup(e=!1){T(this,xo,!0);const t=D(this,ql,Uv).call(this);return e&&t&&this._stats&&(this._stats=new hD),t}_startRenderPage(e,t){var i,s;const r=this._intentStates.get(t);r&&((i=this._stats)==null||i.timeEnd("Page Request"),(s=r.displayReadyCapability)==null||s.resolve(e))}_renderPageChunk(e,t){for(let r=0,i=e.length;r<i;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const r of t.renderTasks)r.operatorListChanged();e.lastChunk&&D(this,ql,Uv).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:r,modifiedIds:i}){const{map:s,transfer:o}=r,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:i},o).getReader(),u=this._intentStates.get(t);u.streamReader=l;const p=()=>{l.read().then(({value:f,done:g})=>{if(g){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,u),p())},f=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const g of u.renderTasks)g.operatorListChanged();D(this,ql,Uv).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(f);else if(u.opListReadCapability)u.opListReadCapability.reject(f);else throw f}})};p()}_abortOperatorList({intentState:e,reason:t,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(t instanceof uP){let i=Z6;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new vc(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}xo=new WeakMap,ql=new WeakSet,Uv=function(){if(!h(this,xo)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),T(this,xo,!1),!0};var Ja,$i,Io,Vl,k0,Gl,Kl,lr,zC,W2,q2,Hv,dh,FC;const Ot=class Ot{constructor({name:e=null,port:t=null,verbosity:r=N5()}={}){_(this,lr);_(this,Ja,Promise.withResolvers());_(this,$i,null);_(this,Io,null);_(this,Vl,null);if(this.name=e,this.destroyed=!1,this.verbosity=r,t){if(h(Ot,Kl).has(t))throw new Error("Cannot use more than one PDFWorker per port.");h(Ot,Kl).set(t,this),D(this,lr,W2).call(this,t)}else D(this,lr,q2).call(this)}get promise(){return h(this,Ja).promise}get port(){return h(this,Io)}get messageHandler(){return h(this,$i)}destroy(){var e,t;this.destroyed=!0,(e=h(this,Vl))==null||e.terminate(),T(this,Vl,null),h(Ot,Kl).delete(h(this,Io)),T(this,Io,null),(t=h(this,$i))==null||t.destroy(),T(this,$i,null)}static create(e){const t=h(this,Kl).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ot(e)}static get workerSrc(){if(Bs.workerSrc)return Bs.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ze(this,"_setupFakeWorkerGlobal",(async()=>h(this,dh,FC)?h(this,dh,FC):(await import(this.workerSrc)).WorkerMessageHandler)())}};Ja=new WeakMap,$i=new WeakMap,Io=new WeakMap,Vl=new WeakMap,k0=new WeakMap,Gl=new WeakMap,Kl=new WeakMap,lr=new WeakSet,zC=function(){h(this,Ja).resolve(),h(this,$i).send("configure",{verbosity:this.verbosity})},W2=function(e){T(this,Io,e),T(this,$i,new Lv("main","worker",e)),h(this,$i).on("ready",()=>{}),D(this,lr,zC).call(this)},q2=function(){if(h(Ot,Gl)||h(Ot,dh,FC)){D(this,lr,Hv).call(this);return}let{workerSrc:e}=Ot;try{Ot._isSameOrigin(window.location,e)||(e=Ot._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),r=new Lv("main","worker",t),i=()=>{s.abort(),r.destroy(),t.terminate(),this.destroyed?h(this,Ja).reject(new Error("Worker was destroyed")):D(this,lr,Hv).call(this)},s=new AbortController;t.addEventListener("error",()=>{h(this,Vl)||i()},{signal:s.signal}),r.on("test",a=>{if(s.abort(),this.destroyed||!a){i();return}T(this,$i,r),T(this,Io,t),T(this,Vl,t),D(this,lr,zC).call(this)}),r.on("ready",a=>{if(s.abort(),this.destroyed){i();return}try{o()}catch{D(this,lr,Hv).call(this)}});const o=()=>{const a=new Uint8Array;r.send("test",a,[a.buffer])};o();return}catch{q0("The worker has been disabled.")}D(this,lr,Hv).call(this)},Hv=function(){h(Ot,Gl)||(Le("Setting up fake worker."),T(Ot,Gl,!0)),Ot._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){h(this,Ja).reject(new Error("Worker was destroyed"));return}const t=new u6;T(this,Io,t);const r=`fake${dn(Ot,k0)._++}`,i=new Lv(r+"_worker",r,t);e.setup(i,t),T(this,$i,new Lv(r,r+"_worker",t)),D(this,lr,zC).call(this)}).catch(e=>{h(this,Ja).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},dh=new WeakSet,FC=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},_(Ot,dh),_(Ot,k0,0),_(Ot,Gl,!1),_(Ot,Kl,new WeakMap),ar&&(T(Ot,Gl,!0),Bs.workerSrc||(Bs.workerSrc="./pdf.worker.mjs")),Ot._isSameOrigin=(e,t)=>{const r=URL.parse(e);if(!(r!=null&&r.origin)||r.origin==="null")return!1;const i=new URL(t,r);return r.origin===i.origin},Ot._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Ot.fromPort=e=>{if(G5("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Ot.create(e)};let Zv=Ot;var _o,_s,hh,ph,ko,$l,Wv;class nU{constructor(e,t,r,i,s,o){_(this,$l);_(this,_o,new Map);_(this,_s,new Map);_(this,hh,new Map);_(this,ph,new Map);_(this,ko,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new L2,this.fontLoader=new r6({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}get annotationStorage(){return ze(this,"annotationStorage",new hP)}getRenderingIntent(e,t=Ra.ENABLE,r=null,i=!1,s=!1){let o=ti.DISPLAY,a=WE;switch(e){case"any":o=ti.ANY;break;case"display":break;case"print":o=ti.PRINT;break;default:Le(`getRenderingIntent - invalid intent: ${e}`)}const l=o&ti.PRINT&&r instanceof C2?r:this.annotationStorage;switch(t){case Ra.DISABLE:o+=ti.ANNOTATIONS_DISABLE;break;case Ra.ENABLE:break;case Ra.ENABLE_FORMS:o+=ti.ANNOTATIONS_FORMS;break;case Ra.ENABLE_STORAGE:o+=ti.ANNOTATIONS_STORAGE,a=l.serializable;break;default:Le(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(o+=ti.IS_EDITING),s&&(o+=ti.OPLIST);const{ids:u,hash:p}=l.modifiedIds,f=[o,a.hash,p];return{renderingIntent:o,cacheKey:f.join("_"),annotationStorageSerializable:a,modifiedIds:u}}destroy(){var r;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(r=h(this,ko))==null||r.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of h(this,_s).values())e.push(i._destroy());h(this,_s).clear(),h(this,hh).clear(),h(this,ph).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,s;this.commonObjs.clear(),this.fontLoader.clear(),h(this,_o).clear(),this.filterFactory.destroy(),Qv.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new vc("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(r,i)=>{rt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){i.close();return}rt(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async r=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:o}=this._fullReader;return(!i||!s)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:o}}),e.on("GetRangeReader",(r,i)=>{rt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:o,done:a}){if(a){i.close();return}rt(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{s.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,t._capability.resolve(new eU(r,this))}),e.on("DocException",r=>{t._capability.reject(mr(r))}),e.on("PasswordRequest",r=>{T(this,ko,Promise.withResolvers());try{if(!t.onPassword)throw mr(r);const i=s=>{s instanceof Error?h(this,ko).reject(s):h(this,ko).resolve({password:s})};t.onPassword(i,r.code)}catch(i){h(this,ko).reject(i)}return h(this,ko).promise}),e.on("DataLoaded",r=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;h(this,_s).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,i,s])=>{var o;if(this.destroyed||this.commonObjs.has(r))return null;switch(i){case"Font":if("error"in s){const g=s.error;Le(`Error during font loading: ${g}`),this.commonObjs.resolve(r,g);break}const a=new qE(s),l=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(g,m)=>globalThis.FontInspector.fontAdded(g,m):null,u=new i6(a,l,s.extra,s.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(r,u)});break;case"CopyLocalImage":const{imageRef:p}=s;rt(p,"The imageRef must be defined.");for(const g of h(this,_s).values())for(const[,m]of g.objs)if((m==null?void 0:m.ref)===p)return m.dataLen?(this.commonObjs.resolve(r,structuredClone(m)),m.dataLen):null;break;case"FontPath":this.commonObjs.resolve(r,new s6(s));break;case"Image":this.commonObjs.resolve(r,s);break;case"Pattern":const f=new VE(s);this.commonObjs.resolve(r,f.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([r,i,s,o])=>{var l;if(this.destroyed)return;const a=h(this,_s).get(i);if(!a.objs.has(r)){if(a._intentStates.size===0){(l=o==null?void 0:o.bitmap)==null||l.close();return}switch(s){case"Image":case"Pattern":a.objs.resolve(r,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",r=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:r.loaded,total:r.total})}),e.on("FetchBinaryData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[r.type];if(!i)throw new Error(`${r.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r;this.annotationStorage.size<=0&&Le("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((r=this._fullReader)==null?void 0:r.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,r=h(this,hh).get(t);if(r)return r;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&h(this,ph).set(s.refStr,e);const o=new tU(t,s,this,this._params.pdfBug);return h(this,_s).set(t,o),o});return h(this,hh).set(t,i),i}getPageIndex(e){return GE(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return D(this,$l,Wv).call(this,"GetFieldObjects")}hasJSActions(){return D(this,$l,Wv).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return D(this,$l,Wv).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return D(this,$l,Wv).call(this,"GetOptionalContentConfig").then(t=>new N6(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=h(this,_o).get(e);if(t)return t;const r=this.messageHandler.sendWithPromise(e,null).then(i=>{var s,o;return{info:i[0],metadata:i[1]?new M6(i[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null,hasStructTree:i[2]}});return h(this,_o).set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of h(this,_s).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),h(this,_o).clear(),this.filterFactory.destroy(!0),Qv.cleanup()}}cachedPageNumber(e){if(!GE(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return h(this,ph).get(t)??null}}_o=new WeakMap,_s=new WeakMap,hh=new WeakMap,ph=new WeakMap,ko=new WeakMap,$l=new WeakSet,Wv=function(e,t=null){const r=h(this,_o).get(e);if(r)return r;const i=this.messageHandler.sendWithPromise(e,t);return h(this,_o).set(e,i),i};var Xa;class rU{constructor(e){_(this,Xa,null);G(this,"onContinue",null);G(this,"onError",null);T(this,Xa,e)}get promise(){return h(this,Xa).capability.promise}cancel(e=0){h(this,Xa).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=h(this,Xa).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=h(this,Xa);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Xa=new WeakMap;var Ya,Jl;const ol=class ol{constructor({callback:e,params:t,objs:r,commonObjs:i,annotationCanvasMap:s,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:p=!1,pdfBug:f=!1,pageColors:g=null,enableHWA:m=!1,operationsFilter:C=null}){_(this,Ya,null);this.callback=e,this.params=t,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=f,this.pageColors=g,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new rU(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=m,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=C}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var l,u;if(this.cancelled)return;if(this._canvas){if(h(ol,Jl).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");h(ol,Jl).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:r,transform:i,background:s,dependencyTracker:o}=this.params,a=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new yd(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:i,viewport:r,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null,t=0){var r,i,s;this.running=!1,this.cancelled=!0,(r=this.gfx)==null||r.endDrawing(),h(this,Ya)&&(window.cancelAnimationFrame(h(this,Ya)),T(this,Ya,null)),h(ol,Jl).delete(this._canvas),e||(e=new uP(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(s=(i=this.task).onError)==null||s.call(i,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?T(this,Ya,window.requestAnimationFrame(()=>{T(this,Ya,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),h(ol,Jl).delete(this._canvas),this.callback())))}};Ya=new WeakMap,Jl=new WeakMap,_(ol,Jl,new WeakSet);let aR=ol;const iU="5.4.530",sU="50cc4adac";var Hr,Xl,fh,gn,ly,gh,Mo,uy,Qa,Ji,dy,wt,cR,lR,uR,tl,V2,Ea;const yr=class yr{constructor({editor:e=null,uiManager:t=null}){_(this,wt);_(this,Hr,null);_(this,Xl,null);_(this,fh);_(this,gn,null);_(this,ly,!1);_(this,gh,!1);_(this,Mo,null);_(this,uy);_(this,Qa,null);_(this,Ji,null);var r,i;e?(T(this,gh,!1),T(this,Mo,e)):T(this,gh,!0),T(this,Ji,(e==null?void 0:e._uiManager)||t),T(this,uy,h(this,Ji)._eventBus),T(this,fh,((r=e==null?void 0:e.color)==null?void 0:r.toUpperCase())||((i=h(this,Ji))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),h(yr,dy)||T(yr,dy,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ze(this,"_keyboardManager",new Qy([[["Escape","mac+Escape"],yr.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],yr.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],yr.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],yr.prototype._moveToPrevious],[["Home","mac+Home"],yr.prototype._moveToBeginning],[["End","mac+End"],yr.prototype._moveToEnd]]))}renderButton(){const e=T(this,Hr,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",h(this,Mo)&&(e.ariaControls=`${h(this,Mo).id}_colorpicker_dropdown`);const t=h(this,Ji)._signal;e.addEventListener("click",D(this,wt,tl).bind(this),{signal:t}),e.addEventListener("keydown",D(this,wt,uR).bind(this),{signal:t});const r=T(this,Xl,document.createElement("span"));return r.className="swatch",r.ariaHidden="true",r.style.backgroundColor=h(this,fh),e.append(r),e}renderMainDropdown(){const e=T(this,gn,D(this,wt,cR).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===h(this,Hr)){D(this,wt,tl).call(this,e);return}const t=e.target.getAttribute("data-color");t&&D(this,wt,lR).call(this,t,e)}_moveToNext(e){var t,r;if(!h(this,wt,Ea)){D(this,wt,tl).call(this,e);return}if(e.target===h(this,Hr)){(t=h(this,gn).firstElementChild)==null||t.focus();return}(r=e.target.nextSibling)==null||r.focus()}_moveToPrevious(e){var t,r;if(e.target===((t=h(this,gn))==null?void 0:t.firstElementChild)||e.target===h(this,Hr)){h(this,wt,Ea)&&this._hideDropdownFromKeyboard();return}h(this,wt,Ea)||D(this,wt,tl).call(this,e),(r=e.target.previousSibling)==null||r.focus()}_moveToBeginning(e){var t;if(!h(this,wt,Ea)){D(this,wt,tl).call(this,e);return}(t=h(this,gn).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!h(this,wt,Ea)){D(this,wt,tl).call(this,e);return}(t=h(this,gn).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=h(this,gn))==null||e.classList.add("hidden"),h(this,Hr).ariaExpanded="false",(t=h(this,Qa))==null||t.abort(),T(this,Qa,null)}_hideDropdownFromKeyboard(){var e;if(!h(this,gh)){if(!h(this,wt,Ea)){(e=h(this,Mo))==null||e.unselect();return}this.hideDropdown(),h(this,Hr).focus({preventScroll:!0,focusVisible:h(this,ly)})}}updateColor(e){if(h(this,Xl)&&(h(this,Xl).style.backgroundColor=e),!h(this,gn))return;const t=h(this,Ji).highlightColors.values();for(const r of h(this,gn).children)r.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=h(this,Hr))==null||e.remove(),T(this,Hr,null),T(this,Xl,null),(t=h(this,gn))==null||t.remove(),T(this,gn,null)}};Hr=new WeakMap,Xl=new WeakMap,fh=new WeakMap,gn=new WeakMap,ly=new WeakMap,gh=new WeakMap,Mo=new WeakMap,uy=new WeakMap,Qa=new WeakMap,Ji=new WeakMap,dy=new WeakMap,wt=new WeakSet,cR=function(){const e=document.createElement("div"),t=h(this,Ji)._signal;e.addEventListener("contextmenu",_i,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),h(this,Mo)&&(e.id=`${h(this,Mo).id}_colorpicker_dropdown`);for(const[r,i]of h(this,Ji).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=r,s.setAttribute("data-l10n-id",h(yr,dy)[r]);const o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=i,s.ariaSelected=i===h(this,fh),s.addEventListener("click",D(this,wt,lR).bind(this,i),{signal:t}),e.append(s)}return e.addEventListener("keydown",D(this,wt,uR).bind(this),{signal:t}),e},lR=function(e,t){t.stopPropagation(),h(this,uy).dispatch("switchannotationeditorparams",{source:this,type:nt.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},uR=function(e){yr._keyboardManager.exec(this,e)},tl=function(e){if(h(this,wt,Ea)){this.hideDropdown();return}if(T(this,ly,e.detail===0),h(this,Qa)||(T(this,Qa,new AbortController),window.addEventListener("pointerdown",D(this,wt,V2).bind(this),{signal:h(this,Ji).combinedSignal(h(this,Qa))})),h(this,Hr).ariaExpanded="true",h(this,gn)){h(this,gn).classList.remove("hidden");return}const t=T(this,gn,D(this,wt,cR).call(this));h(this,Hr).append(t)},V2=function(e){var t;(t=h(this,gn))!=null&&t.contains(e.target)||this.hideDropdown()},Ea=function(){return h(this,gn)&&!h(this,gn).classList.contains("hidden")},_(yr,dy,null);let p0=yr;var ks,hy,vh,py;const al=class al{constructor(e){_(this,ks,null);_(this,hy,null);_(this,vh,null);T(this,hy,e),T(this,vh,e._uiManager),h(al,py)||T(al,py,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(h(this,ks))return h(this,ks);const{editorType:e,colorType:t,color:r}=h(this,hy),i=T(this,ks,document.createElement("input"));return i.type="color",i.value=r||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",h(al,py)[e]),i.addEventListener("input",()=>{h(this,vh).updateParams(t,i.value)},{signal:h(this,vh)._signal}),i}update(e){h(this,ks)&&(h(this,ks).value=e)}destroy(){var e;(e=h(this,ks))==null||e.remove(),T(this,ks,null)}hideDropdown(){}};ks=new WeakMap,hy=new WeakMap,vh=new WeakMap,py=new WeakMap,_(al,py,null);let f0=al;He(116);He(531);function ND(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Ev(n){return Math.max(0,Math.min(255,255*n))}class OD{static CMYK_G([e,t,r,i]){return["G",1-Math.min(1,.3*e+.59*r+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Ev(e),[e,e,e]}static G_HTML([e]){const t=ND(e);return`#${t}${t}${t}`}static RGB_G([e,t,r]){return["G",.3*e+.59*t+.11*r]}static RGB_rgb(e){return e.map(Ev)}static RGB_HTML(e){return`#${e.map(ND).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,r,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,r+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,r,i]){return[Ev(1-Math.min(1,e+i)),Ev(1-Math.min(1,r+i)),Ev(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,r]){const i=1-e,s=1-t,o=1-r,a=Math.min(i,s,o);return["CMYK",i,s,o,a]}}class oU{create(e,t,r=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),r||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Pt("Abstract method `_createSVG` called.")}}class g0 extends oU{_createSVG(e){return document.createElementNS(ro,e)}}const aU=9,Ru=new WeakSet,cU=new Date().getTimezoneOffset()*60*1e3;class uE{static create(e){switch(e.data.annotationType){case on.LINK:return new gP(e);case on.TEXT:return new uU(e);case on.WIDGET:switch(e.data.fieldType){case"Tx":return new dU(e);case"Btn":return e.data.radioButton?new $2(e):e.data.checkBox?new pU(e):new fU(e);case"Ch":return new gU(e);case"Sig":return new hU(e)}return new Iu(e);case on.POPUP:return new hR(e);case on.FREETEXT:return new Z2(e);case on.LINE:return new mU(e);case on.SQUARE:return new yU(e);case on.CIRCLE:return new SU(e);case on.POLYLINE:return new eL(e);case on.CARET:return new bU(e);case on.INK:return new vP(e);case on.POLYGON:return new CU(e);case on.HIGHLIGHT:return new tL(e);case on.UNDERLINE:return new wU(e);case on.SQUIGGLY:return new AU(e);case on.STRIKEOUT:return new EU(e);case on.STAMP:return new nL(e);case on.FILEATTACHMENT:return new RU(e);default:return new qt(e)}}}var Yl,mh,Ei,fy,dR;const PP=class PP{constructor(e,{isRenderable:t=!1,ignoreBorder:r=!1,createQuadrilaterals:i=!1}={}){_(this,fy);_(this,Yl,null);_(this,mh,!1);_(this,Ei,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(r)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return PP._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var r;const{data:e}=this,t=(r=this.annotationStorage)==null?void 0:r.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var a;const e=(a=this.annotationStorage)==null?void 0:a.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:r,rect:i}=this.data;let s=-1/0,o=-1/0;if((t==null?void 0:t.length)>=8){for(let l=0;l<t.length;l+=8)t[l+1]>o?(o=t[l+1],s=t[l+2]):t[l+1]===o&&(s=Math.max(s,t[l+2]));return[s,o]}if((r==null?void 0:r.length)>=1){for(const l of r)for(let u=0,p=l.length;u<p;u+=2)l[u+1]>o?(o=l[u+1],s=l[u]):l[u+1]===o&&(s=Math.max(s,l[u]));if(s!==1/0)return[s,o]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-s)/r,e[1]=100*(e[1]-o)/i,e}get commentText(){var t,r,i;const{data:e}=this;return((r=(t=this.annotationStorage.getRawValue(`${Jv}${e.id}`))==null?void 0:t.popup)==null?void 0:r.contents)||((i=e.contentsObj)==null?void 0:i.str)||""}set commentText(e){const{data:t}=this,r={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:r})||this.annotationStorage.setValue(`${Jv}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:r,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=h(this,Ei))==null?void 0:e.popup)||this.popup)==null||t.remove(),T(this,Ei,this.popup=null)}updateEdited(e){var s;if(!this.container)return;e.rect&&(h(this,Yl)||T(this,Yl,{rect:this.data.rect.slice(0)}));const{rect:t,popup:r}=e;t&&D(this,fy,dR).call(this,t);let i=((s=h(this,Ei))==null?void 0:s.popup)||this.popup;!i&&(r!=null&&r.text)&&(this._createPopup(r),i=h(this,Ei).popup),i&&(i.updateEdited(e),r!=null&&r.deleted&&(i.remove(),T(this,Ei,null),this.popup=null))}resetEdited(){var e;h(this,Yl)&&(D(this,fy,dR).call(this,h(this,Yl).rect),(e=h(this,Ei))==null||e.popup.resetEdited(),T(this,Yl,null))}_createContainer(e){const{data:t,parent:{page:r,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),!(this instanceof Iu)&&!(this instanceof gP)&&(s.tabIndex=0);const{style:o}=s;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof hR){const{rotation:S}=t;return!t.hasOwnCanvas&&S!==0&&this.setRotation(S,s),s}const{width:a,height:l}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const S=t.borderStyle.horizontalCornerRadius,w=t.borderStyle.verticalCornerRadius;if(S>0||w>0){const R=`calc(${S}px * var(--total-scale-factor)) / calc(${w}px * var(--total-scale-factor))`;o.borderRadius=R}else if(this instanceof $2){const R=`calc(${a}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;o.borderRadius=R}switch(t.borderStyle.style){case rd.SOLID:o.borderStyle="solid";break;case rd.DASHED:o.borderStyle="dashed";break;case rd.BEVELED:Le("Unimplemented border style: beveled");break;case rd.INSET:Le("Unimplemented border style: inset");break;case rd.UNDERLINE:o.borderBottomStyle="solid";break}const b=t.borderColor||null;b?(T(this,mh,!0),o.borderColor=be.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):o.borderWidth=0}const u=be.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]),{pageWidth:p,pageHeight:f,pageX:g,pageY:m}=i.rawDims;o.left=`${100*(u[0]-g)/p}%`,o.top=`${100*(u[1]-m)/f}%`;const{rotation:C}=t;return t.hasOwnCanvas||C===0?(o.width=`${100*a/p}%`,o.height=`${100*l/f}%`):this.setRotation(C,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:o}=this;e%180!==0&&([s,o]=[o,s]),t.style.width=`${100*s/r}%`,t.style.height=`${100*o/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,r,i)=>{const s=i.detail[t],o=s[0],a=s.slice(1);i.target.style[r]=OD[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[r]:OD[`${o}_rgb`](a)})};return ze(this,"_commonActions",{display:t=>{const{display:r}=t.detail,i=r%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:r===1||r===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:r}=t.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const r=t.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,t){const r=this._commonActions;for(const i of Object.keys(t.detail)){const s=e[i]||r[i];s==null||s(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const r=this._commonActions;for(const[i,s]of Object.entries(t)){const o=r[i];if(o){const a={detail:{[i]:s},target:e};o(a),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,r,i,s]=this.data.rect.map(S=>Math.fround(S));if(e.length===8){const[S,w,b,R]=e.subarray(2,6);if(i===S&&s===w&&t===b&&r===R)return}const{style:o}=this.container;let a;if(h(this,mh)){const{borderColor:S,borderWidth:w}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const l=i-t,u=s-r,{svgFactory:p}=this,f=p.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0),f.role="none";const g=p.createElement("defs");f.append(g);const m=p.createElement("clipPath"),C=`clippath_${this.data.id}`;m.setAttribute("id",C),m.setAttribute("clipPathUnits","objectBoundingBox"),g.append(m);for(let S=2,w=e.length;S<w;S+=8){const b=e[S],R=e[S+1],P=e[S+2],I=e[S+3],M=p.createElement("rect"),k=(P-t)/l,O=(s-R)/u,L=(b-P)/l,F=(R-I)/u;M.setAttribute("x",k),M.setAttribute("y",O),M.setAttribute("width",L),M.setAttribute("height",F),m.append(M),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${O}" width="${L}" height="${F}"/>`)}h(this,mh)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(f),this.container.style.clipPath=`url(#${C})`}_createPopup(e=null){const{data:t}=this;let r,i;e?(r={str:e.text},i=e.date):(r=t.contentsObj,i=t.modificationDate),T(this,Ei,new hR({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:r,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(h(this,Ei)||this.popup||this.data.popupRef)}get extraPopupElement(){return h(this,Ei)}render(){Pt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const r=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:s,id:o,exportValues:a}of i){if(s===-1||o===t)continue;const l=typeof a=="string"?a:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!Ru.has(u)){Le(`_getElementsByName - element not allowed: ${o}`);continue}r.push({id:o,exportValue:l,domElement:u})}return r}for(const i of document.getElementsByName(e)){const{exportValue:s}=i,o=i.getAttribute("data-element-id");o!==t&&Ru.has(i)&&r.push({id:o,exportValue:s,domElement:i})}return r}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var r;(r=this.linkService.eventBus)==null||r.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Yl=new WeakMap,mh=new WeakMap,Ei=new WeakMap,fy=new WeakSet,dR=function(e){const{container:{style:t},data:{rect:r,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:a,pageY:l}}}}=this;r==null||r.splice(0,4,...e),t.left=`${100*(e[0]-a)/s}%`,t.top=`${100*(o-e[3]+l)/o}%`,i===0?(t.width=`${100*(e[2]-e[0])/s}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(i)};let qt=PP;class lU extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var ri,nl,G2,K2;class gP extends qt{constructor(t,r=null){super(t,{isRenderable:!0,ignoreBorder:!!(r!=null&&r.ignoreBorder),createQuadrilaterals:!0});_(this,ri);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:r}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(r.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),s=!0):t.attachment?(D(this,ri,G2).call(this,i,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(D(this,ri,K2).call(this,i,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=i,this.container.append(i)),this.container}_bindLink(t,r,i=""){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&D(this,ri,nl).call(this),i&&(t.title=i)}_bindNamedAction(t,r,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),i&&(t.title=i),D(this,ri,nl).call(this)}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(r.actions)){const o=i.get(s);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:s}}),!1})}r.overlaidText&&(t.title=r.overlaidText),t.onclick||(t.onclick=()=>!1),D(this,ri,nl).call(this)}_bindResetFormAction(t,r){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),D(this,ri,nl).call(this),!this._fieldObjects){Le('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var f;i==null||i();const{fields:s,refs:o,include:a}=r,l=[];if(s.length!==0||o.length!==0){const g=new Set(o);for(const m of s){const C=this._fieldObjects[m]||[];for(const{id:S}of C)g.add(S)}for(const m of Object.values(this._fieldObjects))for(const C of m)g.has(C.id)===a&&l.push(C)}else for(const g of Object.values(this._fieldObjects))l.push(...g);const u=this.annotationStorage,p=[];for(const g of l){const{id:m}=g;switch(p.push(m),g.type){case"text":{const S=g.defaultValue||"";u.setValue(m,{value:S});break}case"checkbox":case"radiobutton":{const S=g.defaultValue===g.exportValues;u.setValue(m,{value:S});break}case"combobox":case"listbox":{const S=g.defaultValue||"";u.setValue(m,{value:S});break}default:continue}const C=document.querySelector(`[data-element-id="${m}"]`);if(C){if(!Ru.has(C)){Le(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;C.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:p,name:"ResetForm"}})),!1}}}ri=new WeakSet,nl=function(){this.container.setAttribute("data-internal-link","")},G2=function(t,r,i="",s=null){t.href=this.linkService.getAnchorUrl(""),r.description?t.title=r.description:i&&(t.title=i),t.onclick=()=>{var o;return(o=this.downloadManager)==null||o.openOrDownloadData(r.content,r.filename,s),!1},D(this,ri,nl).call(this)},K2=function(t,r,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(r),!1),i&&(t.title=i),D(this,ri,nl).call(this)};class uU extends qt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class Iu extends qt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return mn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,r,i,s){r.includes("mouse")?e.addEventListener(r,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(r,o=>{var a;if(r==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(r==="focus"){if(t.focused)return;t.focused=!0}s&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o)}}))})}_setEventListeners(e,t,r,i){var s,o,a;for(const[l,u]of r)(u==="Action"||(s=this.data.actions)!=null&&s[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,u,i),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":be.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||aU,s=e.style;let o;const a=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a),p=Math.round(u/(nE*i))||1,f=u/p;o=Math.min(i,l(f/nE))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(i,l(u/nE))}s.fontSize=`calc(${o}px * var(--total-scale-factor))`,s.color=be.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class dU extends Iu{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,r,i){const s=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=r),s.setValue(o.id,{[i]:r})}render(){var i,s;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let u=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const p={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=u??a,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type=this.data.password?"password":"text",r.setAttribute("value",u??a),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),Ru.add(r),this.contentElement=r,r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=0;const{datetimeFormat:f,datetimeType:g,timeStep:m}=this.data,C=!!g&&this.enableScripting;f&&(r.title=f),this._setRequired(r,this.data.required),l&&(r.maxLength=l),r.addEventListener("input",w=>{e.setValue(t,{value:w.target.value}),this.setPropertyOnSiblings(r,"value",w.target.value,"value"),p.formattedValue=null}),r.addEventListener("resetform",w=>{const b=this.data.defaultFieldValue??"";r.value=p.userValue=b,p.formattedValue=null});let S=w=>{const{formattedValue:b}=p;b!=null&&(w.target.value=b),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",b=>{var P;if(p.focused)return;const{target:R}=b;if(C&&(R.type=g,m&&(R.step=m)),p.userValue){const I=p.userValue;if(C)if(g==="time"){const M=new Date(I),k=[M.getHours(),M.getMinutes(),M.getSeconds()];R.value=k.map(O=>O.toString().padStart(2,"0")).join(":")}else R.value=new Date(I-cU).toISOString().split(g==="date"?"T":".",1)[0];else R.value=I}p.lastCommittedValue=R.value,p.commitKey=1,(P=this.data.actions)!=null&&P.Focus||(p.focused=!0)}),r.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const R={value(P){p.userValue=P.detail.value??"",C||e.setValue(t,{value:p.userValue.toString()}),P.target.value=p.userValue},formattedValue(P){const{formattedValue:I}=P.detail;p.formattedValue=I,I!=null&&P.target!==document.activeElement&&(P.target.value=I);const M={formattedValue:I};C&&(M.value=I),e.setValue(t,M)},selRange(P){P.target.setSelectionRange(...P.detail.selRange)},charLimit:P=>{var O;const{charLimit:I}=P.detail,{target:M}=P;if(I===0){M.removeAttribute("maxLength");return}M.setAttribute("maxLength",I);let k=p.userValue;!k||k.length<=I||(k=k.slice(0,I),M.value=p.userValue=k,e.setValue(t,{value:k}),(O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:1,selStart:M.selectionStart,selEnd:M.selectionEnd}}))}};this._dispatchEventFromSandbox(R,b)}),r.addEventListener("keydown",b=>{var I;p.commitKey=1;let R=-1;if(b.key==="Escape"?R=0:b.key==="Enter"&&!this.data.multiLine?R=2:b.key==="Tab"&&(p.commitKey=3),R===-1)return;const{value:P}=b.target;p.lastCommittedValue!==P&&(p.lastCommittedValue=P,p.userValue=P,(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:P,willCommit:!0,commitKey:R,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const w=S;S=null,r.addEventListener("blur",b=>{var I,M;if(!p.focused||!b.relatedTarget)return;(I=this.data.actions)!=null&&I.Blur||(p.focused=!1);const{target:R}=b;let{value:P}=R;if(C){if(P&&g==="time"){const k=P.split(":").map(O=>parseInt(O,10));P=new Date(2e3,0,1,k[0],k[1],k[2]||0).valueOf(),R.step=""}else P.includes("T")||(P=`${P}T00:00`),P=new Date(P).valueOf();R.type="text"}p.userValue=P,p.lastCommittedValue!==P&&((M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:P,willCommit:!0,commitKey:p.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}})),w(b)}),(s=this.data.actions)!=null&&s.Keystroke&&r.addEventListener("beforeinput",b=>{var F;p.lastCommittedValue=null;const{data:R,target:P}=b,{value:I,selectionStart:M,selectionEnd:k}=P;let O=M,L=k;switch(b.inputType){case"deleteWordBackward":{const H=I.substring(0,M).match(/\w*[^\w]*$/);H&&(O-=H[0].length);break}case"deleteWordForward":{const H=I.substring(M).match(/^[^\w]*\w*/);H&&(L+=H[0].length);break}case"deleteContentBackward":M===k&&(O-=1);break;case"deleteContentForward":M===k&&(L+=1);break}b.preventDefault(),(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:I,change:R||"",willCommit:!1,selStart:O,selEnd:L}})}),this._setEventListeners(r,p,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(S&&r.addEventListener("blur",S),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/l;r.classList.add("comb"),r.style.letterSpacing=`calc(${b}px * var(--total-scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class hU extends Iu{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class pU extends Iu{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(r,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Ru.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=0,s.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const u of this._getElementsByName(a,r)){const p=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=p),e.setValue(u.id,{value:p})}e.setValue(r,{value:l})}),s.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{const a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(r,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class $2 extends Iu{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(r,{value:i})),i)for(const o of this._getElementsByName(t.fieldName,r))e.setValue(o.id,{value:!1});const s=document.createElement("input");if(Ru.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const u of this._getElementsByName(a,r))e.setValue(u.id,{value:!1});e.setValue(r,{value:l})}),s.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;s.addEventListener("updatefromsandbox",a=>{const l={value:u=>{const p=o===u.detail.value;for(const f of this._getElementsByName(u.target.name)){const g=p&&f.id===r;f.domElement&&(f.domElement.checked=g),e.setValue(f.id,{value:g})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class fU extends gP{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}}class gU extends Iu{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,r=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Ru.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",p=>{const f=this.data.defaultFieldValue;for(const g of i.options)g.selected=g.value===f});for(const p of this.data.options){const f=document.createElement("option");f.textContent=p.displayValue,f.value=p.exportValue,r.value.includes(p.exportValue)&&(f.setAttribute("selected",!0),s=!1),i.append(f)}let o=null;if(s){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),i.prepend(p),o=()=>{p.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const a=p=>{const f=p?"value":"textContent",{options:g,multiple:m}=i;return m?Array.prototype.filter.call(g,C=>C.selected).map(C=>C[f]):g.selectedIndex===-1?null:g[g.selectedIndex][f]};let l=a(!1);const u=p=>{const f=p.target.options;return Array.prototype.map.call(f,g=>({displayValue:g.textContent,exportValue:g.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",p=>{const f={value(g){o==null||o();const m=g.detail.value,C=new Set(Array.isArray(m)?m:[m]);for(const S of i.options)S.selected=C.has(S.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(g){i.multiple=!0},remove(g){const m=i.options,C=g.detail.remove;m[C].selected=!1,i.remove(C),m.length>0&&Array.prototype.findIndex.call(m,w=>w.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},clear(g){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(g){const{index:m,displayValue:C,exportValue:S}=g.detail.insert,w=i.children[m],b=document.createElement("option");b.textContent=C,b.value=S,w?w.before(b):i.append(b),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},items(g){const{items:m}=g.detail;for(;i.length!==0;)i.remove(0);for(const C of m){const{displayValue:S,exportValue:w}=C,b=document.createElement("option");b.textContent=S,b.value=w,i.append(b)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},indices(g){const m=new Set(g.detail.indices);for(const C of g.target.options)C.selected=m.has(C.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(g){g.target.disabled=!g.detail.editable}};this._dispatchEventFromSandbox(f,p)}),i.addEventListener("input",p=>{var m;const f=a(!0),g=a(!1);e.setValue(t,{value:f}),p.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:g,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):i.addEventListener("input",function(p){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var gy,pR;class hR extends qt{constructor(t){const{data:r,elements:i,parent:s}=t,o=!!s._commentManager;super(t,{isRenderable:!o&&qt._hasPopupData(r)});_(this,gy);if(this.elements=i,o&&qt._hasPopupData(r)){const a=this.popup=D(this,gy,pR).call(this);for(const l of i)l.popup=a}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const r=this.popup=D(this,gy,pR).call(this),i=[];for(const s of this.elements)s.popup=r,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${hd}${s}`).join(",")),this.container}}gy=new WeakSet,pR=function(){return new vU({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var Wr,Za,M0,D0,yh,Sh,$t,Ms,ec,Ql,Ch,bh,Ds,qr,Do,No,Jt,Oo,tc,vy,Lo,wh,Zl,nc,wn,rc,qe,BC,fR,gR,vR,UC,mR,J2,X2,Y2,Q2,HC,WC,yR;class vU{constructor({container:e,color:t,elements:r,titleObj:i,modificationDate:s,contentsObj:o,richText:a,parent:l,rect:u,parentRect:p,open:f,commentManager:g=null}){_(this,qe);_(this,Wr,null);_(this,Za,D(this,qe,Y2).bind(this));_(this,M0,D(this,qe,yR).bind(this));_(this,D0,D(this,qe,WC).bind(this));_(this,yh,D(this,qe,HC).bind(this));_(this,Sh,null);_(this,$t,null);_(this,Ms,null);_(this,ec,null);_(this,Ql,null);_(this,Ch,null);_(this,bh,null);_(this,Ds,!1);_(this,qr,null);_(this,Do,null);_(this,No,null);_(this,Jt,null);_(this,Oo,null);_(this,tc,null);_(this,vy,null);_(this,Lo,null);_(this,wh,null);_(this,Zl,null);_(this,nc,!1);_(this,wn,null);_(this,rc,null);T(this,$t,e),T(this,wh,i),T(this,Ms,o),T(this,Lo,a),T(this,Ch,l),T(this,Sh,t),T(this,vy,u),T(this,bh,p),T(this,Ql,r),T(this,Wr,g),T(this,wn,r[0]),T(this,ec,a0.toDateObject(s)),this.trigger=r.flatMap(m=>m.getElementsToTriggerPopup()),g||(D(this,qe,BC).call(this),h(this,$t).hidden=!0,f&&D(this,qe,HC).call(this))}renderCommentButton(){if(h(this,Jt)){h(this,Jt).parentNode||h(this,wn).container.after(h(this,Jt));return}if(h(this,Oo)||D(this,qe,fR).call(this),!h(this,Oo))return;const{signal:e}=T(this,Do,new AbortController),t=h(this,wn).hasOwnCommentButton,r=()=>{h(this,Wr).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{h(this,Wr).toggleCommentPopup(this,!1,!0,!t)},s=()=>{h(this,Wr).toggleCommentPopup(this,!1,!1)};if(t){T(this,Jt,h(this,wn).container);for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",h(this,Za),{signal:e}),o.addEventListener("click",r,{signal:e}),o.addEventListener("pointerenter",i,{signal:e}),o.addEventListener("pointerleave",s,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=T(this,Jt,document.createElement("button"));o.className="annotationCommentButton";const a=h(this,wn).container;o.style.zIndex=a.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),D(this,qe,vR).call(this),D(this,qe,gR).call(this),o.addEventListener("keydown",h(this,Za),{signal:e}),o.addEventListener("click",r,{signal:e}),o.addEventListener("pointerenter",i,{signal:e}),o.addEventListener("pointerleave",s,{signal:e}),a.after(o)}}get commentButtonColor(){const{color:e,opacity:t}=h(this,wn).commentData;return e?h(this,Ch)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=h(this,Jt))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:r,creationDate:i,modificationDate:s}=h(this,wn).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:r,creationDate:i,modificationDate:s}}get elementBeforePopup(){return h(this,Jt)}get comment(){return h(this,rc)||T(this,rc,h(this,wn).commentText),h(this,rc)}set comment(e){e!==this.comment&&(h(this,wn).commentText=T(this,rc,e))}focus(){var e;(e=h(this,wn).container)==null||e.focus()}get parentBoundingClientRect(){return h(this,wn).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){h(this,Jt)&&(h(this,Jt).classList.toggle("selected",e),h(this,Jt).ariaExpanded=t)}setSelectedCommentButton(e){h(this,Jt).classList.toggle("selected",e)}get commentPopupPosition(){if(h(this,tc))return h(this,tc);const{x:e,y:t,height:r}=h(this,Jt).getBoundingClientRect(),{x:i,y:s,width:o,height:a}=h(this,wn).layer.getBoundingClientRect();return[(e-i)/o,(t+r-s)/a]}set commentPopupPosition(e){T(this,tc,e)}hasDefaultPopupPosition(){return h(this,tc)===null}get commentButtonPosition(){return h(this,Oo)}get commentButtonWidth(){return h(this,Jt).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,r]=h(this,tc)||this.commentButtonPosition.map(u=>u/100),i=this.parentBoundingClientRect,{x:s,y:o,width:a,height:l}=i;h(this,Wr).showDialog(null,this,s+t*a,o+r*l,{...e,parentDimensions:i})}render(){var r,i;if(h(this,qr))return;const e=T(this,qr,document.createElement("div"));if(e.className="popup",h(this,Sh)){const s=e.style.outlineColor=be.makeHexColor(...h(this,Sh));e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const t=document.createElement("span");if(t.className="header",(r=h(this,wh))!=null&&r.str){const s=document.createElement("span");s.className="title",t.append(s),{dir:s.dir,str:s.textContent}=h(this,wh)}if(e.append(t),h(this,ec)){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:h(this,ec).valueOf()})),s.dateTime=h(this,ec).toISOString(),t.append(s)}FO({html:h(this,qe,UC)||h(this,Ms).str,dir:(i=h(this,Ms))==null?void 0:i.dir,className:"popupContent"},e),h(this,$t).append(e)}updateEdited({rect:e,popup:t,deleted:r}){var i;if(h(this,Wr)){r?(this.remove(),T(this,rc,null)):t&&(t.deleted?this.remove():(D(this,qe,vR).call(this),T(this,rc,t.text))),e&&(T(this,Oo,null),D(this,qe,fR).call(this),D(this,qe,gR).call(this));return}if(r||t!=null&&t.deleted){this.remove();return}D(this,qe,BC).call(this),h(this,Zl)||T(this,Zl,{contentsObj:h(this,Ms),richText:h(this,Lo)}),e&&T(this,No,null),t&&t.text&&(T(this,Lo,D(this,qe,X2).call(this,t.text)),T(this,ec,a0.toDateObject(t.date)),T(this,Ms,null)),(i=h(this,qr))==null||i.remove(),T(this,qr,null)}resetEdited(){var e;h(this,Zl)&&({contentsObj:dn(this,Ms)._,richText:dn(this,Lo)._}=h(this,Zl),T(this,Zl,null),(e=h(this,qr))==null||e.remove(),T(this,qr,null),T(this,No,null))}remove(){var e,t,r;if((e=h(this,Do))==null||e.abort(),T(this,Do,null),(t=h(this,qr))==null||t.remove(),T(this,qr,null),T(this,nc,!1),T(this,Ds,!1),(r=h(this,Jt))==null||r.remove(),T(this,Jt,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){T(this,nc,this.isVisible),h(this,nc)&&(h(this,$t).hidden=!0)}maybeShow(){h(this,Wr)||(D(this,qe,BC).call(this),h(this,nc)&&(h(this,qr)||D(this,qe,WC).call(this),T(this,nc,!1),h(this,$t).hidden=!1))}get isVisible(){return h(this,Wr)?!1:h(this,$t).hidden===!1}}Wr=new WeakMap,Za=new WeakMap,M0=new WeakMap,D0=new WeakMap,yh=new WeakMap,Sh=new WeakMap,$t=new WeakMap,Ms=new WeakMap,ec=new WeakMap,Ql=new WeakMap,Ch=new WeakMap,bh=new WeakMap,Ds=new WeakMap,qr=new WeakMap,Do=new WeakMap,No=new WeakMap,Jt=new WeakMap,Oo=new WeakMap,tc=new WeakMap,vy=new WeakMap,Lo=new WeakMap,wh=new WeakMap,Zl=new WeakMap,nc=new WeakMap,wn=new WeakMap,rc=new WeakMap,qe=new WeakSet,BC=function(){var t;if(h(this,Do))return;T(this,Do,new AbortController);const{signal:e}=h(this,Do);for(const r of this.trigger)r.addEventListener("click",h(this,yh),{signal:e}),r.addEventListener("pointerenter",h(this,D0),{signal:e}),r.addEventListener("pointerleave",h(this,M0),{signal:e}),r.classList.add("popupTriggerArea");for(const r of h(this,Ql))(t=r.container)==null||t.addEventListener("keydown",h(this,Za),{signal:e})},fR=function(){const e=h(this,Ql).find(t=>t.hasCommentButton);e&&T(this,Oo,e._normalizePoint(e.commentButtonPosition))},gR=function(){if(h(this,wn).extraPopupElement&&!h(this,wn).editor)return;h(this,Jt)||this.renderCommentButton();const[e,t]=h(this,Oo),{style:r}=h(this,Jt);r.left=`calc(${e}%)`,r.top=`calc(${t}% - var(--comment-button-dim))`},vR=function(){h(this,wn).extraPopupElement||(h(this,Jt)||this.renderCommentButton(),h(this,Jt).style.backgroundColor=this.commentButtonColor||"")},UC=function(){const e=h(this,Lo),t=h(this,Ms);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&h(this,Lo).html||null},mR=function(){var e,t,r;return((r=(t=(e=h(this,qe,UC))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.fontSize)||0},J2=function(){var e,t,r;return((r=(t=(e=h(this,qe,UC))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.color)||null},X2=function(e){const t=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:h(this,qe,J2),fontSize:h(this,qe,mR)?`calc(${h(this,qe,mR)}px * var(--total-scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:i});return r},Y2=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&h(this,Ds))&&D(this,qe,HC).call(this)},Q2=function(){if(h(this,No)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:r,pageX:i,pageY:s}}}=h(this,Ch);let o=!!h(this,bh),a=o?h(this,bh):h(this,vy);for(const C of h(this,Ql))if(!a||be.intersect(C.data.rect,a)!==null){a=C.data.rect,o=!0;break}const l=be.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),p=o?a[2]-a[0]+5:0,f=l[0]+p,g=l[1];T(this,No,[100*(f-i)/t,100*(g-s)/r]);const{style:m}=h(this,$t);m.left=`${h(this,No)[0]}%`,m.top=`${h(this,No)[1]}%`},HC=function(){if(h(this,Wr)){h(this,Wr).toggleCommentPopup(this,!1);return}T(this,Ds,!h(this,Ds)),h(this,Ds)?(D(this,qe,WC).call(this),h(this,$t).addEventListener("click",h(this,yh)),h(this,$t).addEventListener("keydown",h(this,Za))):(D(this,qe,yR).call(this),h(this,$t).removeEventListener("click",h(this,yh)),h(this,$t).removeEventListener("keydown",h(this,Za)))},WC=function(){h(this,qr)||this.render(),this.isVisible?h(this,Ds)&&h(this,$t).classList.add("focused"):(D(this,qe,Q2).call(this),h(this,$t).hidden=!1,h(this,$t).style.zIndex=parseInt(h(this,$t).style.zIndex)+1e3)},yR=function(){h(this,$t).classList.remove("focused"),!(h(this,Ds)||!this.isVisible)&&(h(this,$t).hidden=!0,h(this,$t).style.zIndex=parseInt(h(this,$t).style.zIndex)-1e3)};class Z2 extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Be.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const r=document.createElement("span");r.textContent=t,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var my;class mU extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});_(this,my,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),o=T(this,my,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return h(this,my)}addHighlightArea(){this.container.classList.add("highlightArea")}}my=new WeakMap;var yy;class yU extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});_(this,yy,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),o=t.borderStyle.width,a=T(this,yy,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",r-o),a.setAttribute("height",i-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return h(this,yy)}addHighlightArea(){this.container.classList.add("highlightArea")}}yy=new WeakMap;var Sy;class SU extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});_(this,Sy,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),o=t.borderStyle.width,a=T(this,Sy,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",r/2),a.setAttribute("cy",i/2),a.setAttribute("rx",r/2-o/2),a.setAttribute("ry",i/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return h(this,Sy)}addHighlightArea(){this.container.classList.add("highlightArea")}}Sy=new WeakMap;var Cy;class eL extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});_(this,Cy,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:r,borderStyle:i,popupRef:s},width:o,height:a}=this;if(!r)return this.container;const l=this.svgFactory.create(o,a,!0);let u=[];for(let f=0,g=r.length;f<g;f+=2){const m=r[f]-t[0],C=t[3]-r[f+1];u.push(`${m},${C}`)}u=u.join(" ");const p=T(this,Cy,this.svgFactory.createElement(this.svgElementName));return p.setAttribute("points",u),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),l.append(p),this.container.append(l),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return h(this,Cy)}addHighlightArea(){this.container.classList.add("highlightArea")}}Cy=new WeakMap;class CU extends eL{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class bU extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var by,eu,wy,SR;class vP extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});_(this,wy);_(this,by,null);_(this,eu,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Be.HIGHLIGHT:Be.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:r,inkLists:i,borderStyle:s,popupRef:o}}=this,{transform:a,width:l,height:u}=D(this,wy,SR).call(this,r,t),p=this.svgFactory.create(l,u,!0),f=T(this,by,this.svgFactory.createElement("svg:g"));p.append(f),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",a);for(let g=0,m=i.length;g<m;g++){const C=this.svgFactory.createElement(this.svgElementName);h(this,eu).push(C),C.setAttribute("points",i[g].join(",")),f.append(C)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(p),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:r,points:i,rect:s}=t,o=h(this,by);if(r>=0&&o.setAttribute("stroke-width",r||1),i)for(let a=0,l=h(this,eu).length;a<l;a++)h(this,eu)[a].setAttribute("points",i[a].join(","));if(s){const{transform:a,width:l,height:u}=D(this,wy,SR).call(this,this.data.rotation,s);o.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return h(this,eu)}addHighlightArea(){this.container.classList.add("highlightArea")}}by=new WeakMap,eu=new WeakMap,wy=new WeakSet,SR=function(t,r){switch(t){case 90:return{transform:`rotate(90) translate(${-r[0]},${r[1]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};case 180:return{transform:`rotate(180) translate(${-r[2]},${r[1]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]};case 270:return{transform:`rotate(270) translate(${-r[2]},${r[3]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};default:return{transform:`translate(${-r[0]},${r[3]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]}}};class tL extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Be.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const r=document.createElement("mark");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class wU extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class AU extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class EU extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const r=document.createElement("s");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class nL extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Be.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Ay,Ey,CR;class RU extends qt{constructor(t){var i;super(t,{isRenderable:!0});_(this,Ey);_(this,Ay,null);const{file:r}=this.data;this.filename=r.filename,this.content=r.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:r}=this;let i;r.hasAppearance||r.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(r.name)?"paperclip":"pushpin"}.svg`,r.fillAlpha&&r.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(r.fillAlpha*100)}%);`)),i.addEventListener("dblclick",D(this,Ey,CR).bind(this)),T(this,Ay,i);const{isMac:s}=mn.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&D(this,Ey,CR).call(this)}),!r.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return h(this,Ay)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ay=new WeakMap,Ey=new WeakSet,CR=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var tu,nu,Ah,ic,Ry,ru,Vr,Py,Go,qC,wR;const TP=class TP{constructor({div:e,accessibilityManager:t,annotationCanvasMap:r,annotationEditorUIManager:i,page:s,viewport:o,structTreeLayer:a,commentManager:l,linkService:u,annotationStorage:p}){_(this,Go);_(this,tu,null);_(this,nu,null);_(this,Ah,null);_(this,ic,new Map);_(this,Ry,null);_(this,ru,null);_(this,Vr,[]);_(this,Py,!1);this.div=e,T(this,tu,t),T(this,nu,r),T(this,Ry,a||null),T(this,ru,u||null),T(this,Ah,p||new hP),this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=l||null}hasEditableAnnotations(){return h(this,ic).size>0}async render(e){var a;const{annotations:t}=e,r=this.div;Au(r,this.viewport);const i=new Map,s=[],o={data:null,layer:r,linkService:h(this,ru),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new g0,annotationStorage:h(this,Ah),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const u=l.annotationType===on.POPUP;if(u){const g=i.get(l.id);if(!g)continue;if(!this._commentManager){s.push(l);continue}o.elements=g}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;o.data=l;const p=uE.create(o);if(!p.isRenderable)continue;if(!u&&(h(this,Vr).push(p),l.popupRef)){const g=i.get(l.popupRef);g?g.push(p):i.set(l.popupRef,[p])}const f=p.render();l.hidden&&(f.style.visibility="hidden"),p._isEditable&&(h(this,ic).set(p.data.id,p),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(p))}await D(this,Go,qC).call(this);for(const l of s){const u=o.elements=i.get(l.id);o.data=l;const p=uE.create(o);if(!p.isRenderable)continue;const f=p.render();p.contentElement.id=`${hd}${l.id}`,l.hidden&&(f.style.visibility="hidden"),u.at(-1).container.after(f)}D(this,Go,wR).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:h(this,ru),svgFactory:new g0,parent:this};for(const r of e){r.borderStyle||(r.borderStyle=TP._defaultBorderStyle),t.data=r;const i=uE.create(t);i.isRenderable&&(i.render(),i.contentElement.id=`${hd}${r.id}`,h(this,Vr).push(i))}await D(this,Go,qC).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Au(t,{rotation:e.rotation}),D(this,Go,wR).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(h(this,ic).values())}getEditableAnnotation(e){return h(this,ic).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:r,rotation:i}=e,s=new lU({data:{id:r,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:h(this,ru),annotationStorage:h(this,Ah)});return s.render(),s.contentElement.id=`${hd}${r}`,s.createOrUpdatePopup(),h(this,Vr).push(s),s}removeAnnotation(e){var i;const t=h(this,Vr).findIndex(s=>s.data.id===e);if(t<0)return;const[r]=h(this,Vr).splice(t,1);(i=h(this,tu))==null||i.removePointerInTextLayer(r.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);D(this,Go,qC).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return ze(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:rd.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};tu=new WeakMap,nu=new WeakMap,Ah=new WeakMap,ic=new WeakMap,Ry=new WeakMap,ru=new WeakMap,Vr=new WeakMap,Py=new WeakMap,Go=new WeakSet,qC=async function(){var r,i,s;if(h(this,Vr).length===0)return;this.div.replaceChildren();const e=[];if(!h(this,Py)){T(this,Py,!0);for(const{contentElement:o,data:{id:a}}of h(this,Vr)){const l=o.id=`${hd}${a}`;e.push((r=h(this,Ry))==null?void 0:r.getAriaAttributes(l).then(u=>{if(u)for(const[p,f]of u)o.setAttribute(p,f)}))}}h(this,Vr).sort(({data:{rect:[o,a,l,u]}},{data:{rect:[p,f,g,m]}})=>{if(o===l&&a===u)return 1;if(p===g&&f===m)return-1;const C=u,S=a,w=(a+u)/2,b=m,R=f,P=(f+m)/2;if(w>=b&&P<=S)return-1;if(P>=C&&w<=R)return 1;const I=(o+l)/2,M=(p+g)/2;return I-M});const t=document.createDocumentFragment();for(const o of h(this,Vr))t.append(o.container),this._commentManager?(s=((i=o.extraPopupElement)==null?void 0:i.popup)||o.popup)==null||s.renderCommentButton():o.extraPopupElement&&t.append(o.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),h(this,tu))for(const o of h(this,Vr))h(this,tu).addPointerInTextLayer(o.contentElement,!1)},wR=function(){var t;if(!h(this,nu))return;const e=this.div;for(const[r,i]of h(this,nu)){const s=e.querySelector(`[data-annotation-id="${r}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:o}=s;o?o.nodeName==="CANVAS"?o.replaceWith(i):o.classList.contains("annotationContent")?o.after(i):o.before(i):s.append(i);const a=h(this,ic).get(r);a&&(a._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(r,s.id,i),a._hasNoCanvas=!1):a.canvas=i)}h(this,nu).clear()};let bR=TP;const bC=/\r\n?|\n/g;var Gr,Ty,iu,Kr,cn,rL,iL,sL,VC,Ko,GC,KC,oL,ER,aL;const Dt=class Dt extends _t{constructor(t){super({...t,name:"freeTextEditor"});_(this,cn);_(this,Gr,"");_(this,Ty,`${this.id}-editor`);_(this,iu,null);_(this,Kr);G(this,"_colorPicker",null);this.color=t.color||Dt._defaultColor||_t._defaultLineColor,T(this,Kr,t.fontSize||Dt._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=Dt.prototype,r=o=>o.isEmpty(),i=Eu.TRANSLATE_SMALL,s=Eu.TRANSLATE_BIG;return ze(this,"_keyboardManager",new Qy([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:r}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:r}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:r}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:r}]]))}static initialize(t,r){_t.initialize(t,r);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,r){switch(t){case nt.FREETEXT_SIZE:Dt._defaultFontSize=r;break;case nt.FREETEXT_COLOR:Dt._defaultColor=r;break}}updateParams(t,r){switch(t){case nt.FREETEXT_SIZE:D(this,cn,rL).call(this,r);break;case nt.FREETEXT_COLOR:D(this,cn,iL).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[nt.FREETEXT_SIZE,Dt._defaultFontSize],[nt.FREETEXT_COLOR,Dt._defaultColor||_t._defaultLineColor]]}get propertiesToUpdate(){return[[nt.FREETEXT_SIZE,h(this,Kr)],[nt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new f0(this)),[["colorPicker",this._colorPicker]]}get colorType(){return nt.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,r){this._uiManager.translateSelectedEditors(t,r,!0)}getInitialTranslation(){const t=this.parentScale;return[-Dt._internalPadding*t,-(Dt._internalPadding+h(this,Kr))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),T(this,iu,new AbortController);const t=this._uiManager.combinedSignal(h(this,iu));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",h(this,Ty)),this._isDraggable=!0,(t=h(this,iu))==null||t.abort(),T(this,iu,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var r;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=h(this,Gr),r=T(this,Gr,D(this,cn,sL).call(this).trimEnd());if(t===r)return;const i=s=>{if(T(this,Gr,s),!s){this.remove();return}D(this,cn,KC).call(this),this._uiManager.rebuild(this),D(this,cn,VC).call(this)};this.addCommands({cmd:()=>{i(r)},undo:()=>{i(t)},mustExec:!1}),D(this,cn,VC).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Dt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,r;(this._isCopy||this.annotationElementId)&&(t=this.x,r=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",h(this,Ty)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${h(this,Kr)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[p,f]=this.pageDimensions,[g,m]=this.pageTranslation;let C,S;switch(this.rotation){case 0:C=t+(a[0]-g)/p,S=r+this.height-(a[1]-m)/f;break;case 90:C=t+(a[0]-g)/p,S=r-(a[1]-m)/f,[l,u]=[u,-l];break;case 180:C=t-this.width+(a[0]-g)/p,S=r-(a[1]-m)/f,[l,u]=[-l,-u];break;case 270:C=t+(a[0]-g-this.height*f)/p,S=r+(a[1]-m-this.width*p)/f,[l,u]=[-u,l];break}this.setAt(C*s,S*o,l,u)}else this._moveAfterPaste(t,r);D(this,cn,KC).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var C,S,w;const r=t.clipboardData||window.clipboardData,{types:i}=r;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const s=D(C=Dt,Ko,ER).call(C,r.getData("text")||"").replaceAll(bC,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!s.includes(`
`)){a.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:l,startOffset:u}=a,p=[],f=[];if(l.nodeType===Node.TEXT_NODE){const b=l.parentElement;if(f.push(l.nodeValue.slice(u).replaceAll(bC,"")),b!==this.editorDiv){let R=p;for(const P of this.editorDiv.childNodes){if(P===b){R=f;continue}R.push(D(S=Dt,Ko,GC).call(S,P))}}p.push(l.nodeValue.slice(0,u).replaceAll(bC,""))}else if(l===this.editorDiv){let b=p,R=0;for(const P of this.editorDiv.childNodes)R++===u&&(b=f),b.push(D(w=Dt,Ko,GC).call(w,P))}T(this,Gr,`${p.join(`
`)}${s}${f.join(`
`)}`),D(this,cn,KC).call(this);const g=new Range;let m=Math.sumPrecise(p.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const R=b.nodeValue.length;if(m<=R){g.setStart(b,m),g.setEnd(b,m);break}m-=R}o.removeAllRanges(),o.addRange(g)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Dt._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,r,i){var a;let s=null;if(t instanceof Z2){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:p,rotation:f,id:g,popupRef:m,richText:C,contentsObj:S,creationDate:w,modificationDate:b},textContent:R,textPosition:P,parent:{page:{pageNumber:I}}}=t;if(!R||R.length===0)return null;s=t={annotationType:Be.FREETEXT,color:Array.from(u),fontSize:l,value:R.join(`
`),position:P,pageIndex:I-1,rect:p.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:m,comment:(S==null?void 0:S.str)||null,richText:C,creationDate:w,modificationDate:b}}const o=await super.deserialize(t,r,i);return T(o,Kr,t.fontSize),o.color=be.makeHexColor(...t.color),T(o,Gr,D(a=Dt,Ko,ER).call(a,t.value)),o._initialData=s,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=_t._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:r,fontSize:h(this,Kr),value:D(this,cn,oL).call(this)});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!D(this,cn,aL).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const r=super.renderAnnotationElement(t);if(!r)return null;const{style:i}=r;i.fontSize=`calc(${h(this,Kr)}px * var(--total-scale-factor))`,i.color=this.color,r.replaceChildren();for(const s of h(this,Gr).split(`
`)){const o=document.createElement("div");o.append(s?document.createTextNode(s):document.createElement("br")),r.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:h(this,Gr)}}),r}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Gr=new WeakMap,Ty=new WeakMap,iu=new WeakMap,Kr=new WeakMap,cn=new WeakSet,rL=function(t){const r=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-h(this,Kr))*this.parentScale),T(this,Kr,s),D(this,cn,VC).call(this)},i=h(this,Kr);this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:nt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},iL=function(t){const r=s=>{this.color=s,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:nt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},sL=function(){var i;const t=[];this.editorDiv.normalize();let r=null;for(const s of this.editorDiv.childNodes)(r==null?void 0:r.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(D(i=Dt,Ko,GC).call(i,s)),r=s);return t.join(`
`)},VC=function(){const[t,r]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,a=o.style.display,l=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/r):(this.width=i.height/t,this.height=i.width/r),this.fixAndSetPosition()},Ko=new WeakSet,GC=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(bC,"")},KC=function(){if(this.editorDiv.replaceChildren(),!!h(this,Gr))for(const t of h(this,Gr).split(`
`)){const r=document.createElement("div");r.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(r)}},oL=function(){return h(this,Gr).replaceAll(""," ")},ER=function(t){return t.replaceAll(" ","")},aL=function(t){const{value:r,fontSize:i,color:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==r||t.fontSize!==i||t.color.some((a,l)=>a!==s[l])||t.pageIndex!==o},_(Dt,Ko),G(Dt,"_freeTextDefaultContent",""),G(Dt,"_internalPadding",0),G(Dt,"_defaultColor",null),G(Dt,"_defaultFontSize",10),G(Dt,"_type","freetext"),G(Dt,"_editorType",Be.FREETEXT);let AR=Dt;class Ee{toSVGPath(){Pt("Abstract method `toSVGPath` must be implemented.")}get box(){Pt("Abstract getter `box` must be implemented.")}serialize(e,t){Pt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,r,i,s,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a]*i,o[a+1]=r+e[a+1]*s;return o}static _rescaleAndSwap(e,t,r,i,s,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a+1]*i,o[a+1]=r+e[a]*s;return o}static _translate(e,t,r,i){i||(i=new Float32Array(e.length));for(let s=0,o=e.length;s<o;s+=2)i[s]=t+e[s],i[s+1]=r+e[s+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,r,i,s){switch(s){case 90:return[1-t/r,e/i];case 180:return[1-e/r,1-t/i];case 270:return[t/r,1-e/i];default:return[e/r,t/i]}}static _normalizePagePoint(e,t,r){switch(r){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,r,i,s,o){return[(e+5*r)/6,(t+5*i)/6,(5*r+s)/6,(5*i+o)/6,(r+s)/2,(i+o)/2]}}G(Ee,"PRECISION",1e-4);var $r,Xi,Eh,Rh,Ns,Xe,su,ou,xy,Iy,Ph,Th,sc,_y,N0,O0,vn,qv,cL,lL,uL,dL,hL,pL;const ao=class ao{constructor({x:e,y:t},r,i,s,o,a=0){_(this,vn);_(this,$r);_(this,Xi,[]);_(this,Eh);_(this,Rh);_(this,Ns,[]);_(this,Xe,new Float32Array(18));_(this,su);_(this,ou);_(this,xy);_(this,Iy);_(this,Ph);_(this,Th);_(this,sc,[]);T(this,$r,r),T(this,Th,s*i),T(this,Rh,o),h(this,Xe).set([NaN,NaN,NaN,NaN,e,t],6),T(this,Eh,a),T(this,Iy,h(ao,_y)*i),T(this,xy,h(ao,O0)*i),T(this,Ph,i),h(this,sc).push(e,t)}isEmpty(){return isNaN(h(this,Xe)[8])}add({x:e,y:t}){var F;T(this,su,e),T(this,ou,t);const[r,i,s,o]=h(this,$r);let[a,l,u,p]=h(this,Xe).subarray(8,12);const f=e-u,g=t-p,m=Math.hypot(f,g);if(m<h(this,xy))return!1;const C=m-h(this,Iy),S=C/m,w=S*f,b=S*g;let R=a,P=l;a=u,l=p,u+=w,p+=b,(F=h(this,sc))==null||F.push(e,t);const I=-b/C,M=w/C,k=I*h(this,Th),O=M*h(this,Th);return h(this,Xe).set(h(this,Xe).subarray(2,8),0),h(this,Xe).set([u+k,p+O],4),h(this,Xe).set(h(this,Xe).subarray(14,18),12),h(this,Xe).set([u-k,p-O],16),isNaN(h(this,Xe)[6])?(h(this,Ns).length===0&&(h(this,Xe).set([a+k,l+O],2),h(this,Ns).push(NaN,NaN,NaN,NaN,(a+k-r)/s,(l+O-i)/o),h(this,Xe).set([a-k,l-O],14),h(this,Xi).push(NaN,NaN,NaN,NaN,(a-k-r)/s,(l-O-i)/o)),h(this,Xe).set([R,P,a,l,u,p],6),!this.isEmpty()):(h(this,Xe).set([R,P,a,l,u,p],6),Math.abs(Math.atan2(P-l,R-a)-Math.atan2(b,w))<Math.PI/2?([a,l,u,p]=h(this,Xe).subarray(2,6),h(this,Ns).push(NaN,NaN,NaN,NaN,((a+u)/2-r)/s,((l+p)/2-i)/o),[a,l,R,P]=h(this,Xe).subarray(14,18),h(this,Xi).push(NaN,NaN,NaN,NaN,((R+a)/2-r)/s,((P+l)/2-i)/o),!0):([R,P,a,l,u,p]=h(this,Xe).subarray(0,6),h(this,Ns).push(((R+5*a)/6-r)/s,((P+5*l)/6-i)/o,((5*a+u)/6-r)/s,((5*l+p)/6-i)/o,((a+u)/2-r)/s,((l+p)/2-i)/o),[u,p,a,l,R,P]=h(this,Xe).subarray(12,18),h(this,Xi).push(((R+5*a)/6-r)/s,((P+5*l)/6-i)/o,((5*a+u)/6-r)/s,((5*l+p)/6-i)/o,((a+u)/2-r)/s,((l+p)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=h(this,Ns),t=h(this,Xi);if(isNaN(h(this,Xe)[6])&&!this.isEmpty())return D(this,vn,cL).call(this);const r=[];r.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?r.push(`L${e[i+4]} ${e[i+5]}`):r.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);D(this,vn,uL).call(this,r);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?r.push(`L${t[i+4]} ${t[i+5]}`):r.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return D(this,vn,lL).call(this,r),r.join(" ")}newFreeDrawOutline(e,t,r,i,s,o){return new fL(e,t,r,i,s,o)}getOutlines(){var f;const e=h(this,Ns),t=h(this,Xi),r=h(this,Xe),[i,s,o,a]=h(this,$r),l=new Float32Array((((f=h(this,sc))==null?void 0:f.length)??0)+2);for(let g=0,m=l.length-2;g<m;g+=2)l[g]=(h(this,sc)[g]-i)/o,l[g+1]=(h(this,sc)[g+1]-s)/a;if(l[l.length-2]=(h(this,su)-i)/o,l[l.length-1]=(h(this,ou)-s)/a,isNaN(r[6])&&!this.isEmpty())return D(this,vn,dL).call(this,l);const u=new Float32Array(h(this,Ns).length+24+h(this,Xi).length);let p=e.length;for(let g=0;g<p;g+=2){if(isNaN(e[g])){u[g]=u[g+1]=NaN;continue}u[g]=e[g],u[g+1]=e[g+1]}p=D(this,vn,pL).call(this,u,p);for(let g=t.length-6;g>=6;g-=6)for(let m=0;m<6;m+=2){if(isNaN(t[g+m])){u[p]=u[p+1]=NaN,p+=2;continue}u[p]=t[g+m],u[p+1]=t[g+m+1],p+=2}return D(this,vn,hL).call(this,u,p),this.newFreeDrawOutline(u,l,h(this,$r),h(this,Ph),h(this,Eh),h(this,Rh))}};$r=new WeakMap,Xi=new WeakMap,Eh=new WeakMap,Rh=new WeakMap,Ns=new WeakMap,Xe=new WeakMap,su=new WeakMap,ou=new WeakMap,xy=new WeakMap,Iy=new WeakMap,Ph=new WeakMap,Th=new WeakMap,sc=new WeakMap,_y=new WeakMap,N0=new WeakMap,O0=new WeakMap,vn=new WeakSet,qv=function(){const e=h(this,Xe).subarray(4,6),t=h(this,Xe).subarray(16,18),[r,i,s,o]=h(this,$r);return[(h(this,su)+(e[0]-t[0])/2-r)/s,(h(this,ou)+(e[1]-t[1])/2-i)/o,(h(this,su)+(t[0]-e[0])/2-r)/s,(h(this,ou)+(t[1]-e[1])/2-i)/o]},cL=function(){const[e,t,r,i]=h(this,$r),[s,o,a,l]=D(this,vn,qv).call(this);return`M${(h(this,Xe)[2]-e)/r} ${(h(this,Xe)[3]-t)/i} L${(h(this,Xe)[4]-e)/r} ${(h(this,Xe)[5]-t)/i} L${s} ${o} L${a} ${l} L${(h(this,Xe)[16]-e)/r} ${(h(this,Xe)[17]-t)/i} L${(h(this,Xe)[14]-e)/r} ${(h(this,Xe)[15]-t)/i} Z`},lL=function(e){const t=h(this,Xi);e.push(`L${t[4]} ${t[5]} Z`)},uL=function(e){const[t,r,i,s]=h(this,$r),o=h(this,Xe).subarray(4,6),a=h(this,Xe).subarray(16,18),[l,u,p,f]=D(this,vn,qv).call(this);e.push(`L${(o[0]-t)/i} ${(o[1]-r)/s} L${l} ${u} L${p} ${f} L${(a[0]-t)/i} ${(a[1]-r)/s}`)},dL=function(e){const t=h(this,Xe),[r,i,s,o]=h(this,$r),[a,l,u,p]=D(this,vn,qv).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-r)/s,(t[3]-i)/o,NaN,NaN,NaN,NaN,(t[4]-r)/s,(t[5]-i)/o,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,u,p,NaN,NaN,NaN,NaN,(t[16]-r)/s,(t[17]-i)/o,NaN,NaN,NaN,NaN,(t[14]-r)/s,(t[15]-i)/o],0),this.newFreeDrawOutline(f,e,h(this,$r),h(this,Ph),h(this,Eh),h(this,Rh))},hL=function(e,t){const r=h(this,Xi);return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],t),t+=6},pL=function(e,t){const r=h(this,Xe).subarray(4,6),i=h(this,Xe).subarray(16,18),[s,o,a,l]=h(this,$r),[u,p,f,g]=D(this,vn,qv).call(this);return e.set([NaN,NaN,NaN,NaN,(r[0]-s)/a,(r[1]-o)/l,NaN,NaN,NaN,NaN,u,p,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(i[0]-s)/a,(i[1]-o)/l],t),t+=24},_(ao,_y,8),_(ao,N0,2),_(ao,O0,h(ao,_y)+h(ao,N0));let v0=ao;var xh,au,jo,ky,Jr,My,nn,L0,gL;class fL extends Ee{constructor(t,r,i,s,o,a){super();_(this,L0);_(this,xh);_(this,au,new Float32Array(4));_(this,jo);_(this,ky);_(this,Jr);_(this,My);_(this,nn);T(this,nn,t),T(this,Jr,r),T(this,xh,i),T(this,My,s),T(this,jo,o),T(this,ky,a),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],D(this,L0,gL).call(this,a);const[l,u,p,f]=h(this,au);for(let g=0,m=t.length;g<m;g+=2)t[g]=(t[g]-l)/p,t[g+1]=(t[g+1]-u)/f;for(let g=0,m=r.length;g<m;g+=2)r[g]=(r[g]-l)/p,r[g+1]=(r[g+1]-u)/f}toSVGPath(){const t=[`M${h(this,nn)[4]} ${h(this,nn)[5]}`];for(let r=6,i=h(this,nn).length;r<i;r+=6){if(isNaN(h(this,nn)[r])){t.push(`L${h(this,nn)[r+4]} ${h(this,nn)[r+5]}`);continue}t.push(`C${h(this,nn)[r]} ${h(this,nn)[r+1]} ${h(this,nn)[r+2]} ${h(this,nn)[r+3]} ${h(this,nn)[r+4]} ${h(this,nn)[r+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,r,i,s],o){const a=i-t,l=s-r;let u,p;switch(o){case 0:u=Ee._rescale(h(this,nn),t,s,a,-l),p=Ee._rescale(h(this,Jr),t,s,a,-l);break;case 90:u=Ee._rescaleAndSwap(h(this,nn),t,r,a,l),p=Ee._rescaleAndSwap(h(this,Jr),t,r,a,l);break;case 180:u=Ee._rescale(h(this,nn),i,r,-a,l),p=Ee._rescale(h(this,Jr),i,r,-a,l);break;case 270:u=Ee._rescaleAndSwap(h(this,nn),i,s,-a,-l),p=Ee._rescaleAndSwap(h(this,Jr),i,s,-a,-l);break}return{outline:Array.from(u),points:[Array.from(p)]}}get box(){return h(this,au)}newOutliner(t,r,i,s,o,a=0){return new v0(t,r,i,s,o,a)}getNewOutline(t,r){const[i,s,o,a]=h(this,au),[l,u,p,f]=h(this,xh),g=o*p,m=a*f,C=i*p+l,S=s*f+u,w=this.newOutliner({x:h(this,Jr)[0]*g+C,y:h(this,Jr)[1]*m+S},h(this,xh),h(this,My),t,h(this,ky),r??h(this,jo));for(let b=2;b<h(this,Jr).length;b+=2)w.add({x:h(this,Jr)[b]*g+C,y:h(this,Jr)[b+1]*m+S});return w.getOutlines()}}xh=new WeakMap,au=new WeakMap,jo=new WeakMap,ky=new WeakMap,Jr=new WeakMap,My=new WeakMap,nn=new WeakMap,L0=new WeakSet,gL=function(t){const r=h(this,nn);let i=r[4],s=r[5];const o=[i,s,i,s];let a=i,l=s,u=i,p=s;const f=t?Math.max:Math.min,g=new Float32Array(4);for(let C=6,S=r.length;C<S;C+=6){const w=r[C+4],b=r[C+5];isNaN(r[C])?(be.pointBoundingBox(w,b,o),l>b?(a=w,l=b):l===b&&(a=f(a,w)),p<b?(u=w,p=b):p===b&&(u=f(u,w))):(g[0]=g[1]=1/0,g[2]=g[3]=-1/0,be.bezierBoundingBox(i,s,...r.slice(C,C+6),g),be.rectBoundingBox(g[0],g[1],g[2],g[3],o),l>g[1]?(a=g[0],l=g[1]):l===g[1]&&(a=f(a,g[0])),p<g[3]?(u=g[2],p=g[3]):p===g[3]&&(u=f(u,g[2]))),i=w,s=b}const m=h(this,au);m[0]=o[0]-h(this,jo),m[1]=o[1]-h(this,jo),m[2]=o[2]-o[0]+2*h(this,jo),m[3]=o[3]-o[1]+2*h(this,jo),this.firstPoint=[a,l],this.lastPoint=[u,p]};var Dy,Ny,Oy,oc,Yi,ur,vL,$C,mL,yL,PR;class RR{constructor(e,t=0,r=0,i=!0){_(this,ur);_(this,Dy);_(this,Ny);_(this,Oy);_(this,oc,[]);_(this,Yi,[]);const s=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:S,y:w,width:b,height:R}of e){const P=Math.floor((S-t)/o)*o,I=Math.ceil((S+b+t)/o)*o,M=Math.floor((w-t)/o)*o,k=Math.ceil((w+R+t)/o)*o,O=[P,M,k,!0],L=[I,M,k,!1];h(this,oc).push(O,L),be.rectBoundingBox(P,M,I,k,s)}const a=s[2]-s[0]+2*r,l=s[3]-s[1]+2*r,u=s[0]-r,p=s[1]-r;let f=i?-1/0:1/0,g=1/0;const m=h(this,oc).at(i?-1:-2),C=[m[0],m[2]];for(const S of h(this,oc)){const[w,b,R,P]=S;!P&&i?b<g?(g=b,f=w):b===g&&(f=Math.max(f,w)):P&&!i&&(b<g?(g=b,f=w):b===g&&(f=Math.min(f,w))),S[0]=(w-u)/a,S[1]=(b-p)/l,S[2]=(R-p)/l}T(this,Dy,new Float32Array([u,p,a,l])),T(this,Ny,[f,g]),T(this,Oy,C)}getOutlines(){h(this,oc).sort((t,r)=>t[0]-r[0]||t[1]-r[1]||t[2]-r[2]);const e=[];for(const t of h(this,oc))t[3]?(e.push(...D(this,ur,PR).call(this,t)),D(this,ur,mL).call(this,t)):(D(this,ur,yL).call(this,t),e.push(...D(this,ur,PR).call(this,t)));return D(this,ur,vL).call(this,e)}}Dy=new WeakMap,Ny=new WeakMap,Oy=new WeakMap,oc=new WeakMap,Yi=new WeakMap,ur=new WeakSet,vL=function(e){const t=[],r=new Set;for(const o of e){const[a,l,u]=o;t.push([a,l,o],[a,u,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const l=t[o][2],u=t[o+1][2];l.push(u),u.push(l),r.add(l),r.add(u)}const i=[];let s;for(;r.size>0;){const o=r.values().next().value;let[a,l,u,p,f]=o;r.delete(o);let g=a,m=l;for(s=[a,u],i.push(s);;){let C;if(r.has(p))C=p;else if(r.has(f))C=f;else break;r.delete(C),[a,l,u,p,f]=C,g!==a&&(s.push(g,m,a,m===l?l:u),g=a),m=m===l?u:l}s.push(g,m)}return new PU(i,h(this,Dy),h(this,Ny),h(this,Oy))},$C=function(e){const t=h(this,Yi);let r=0,i=t.length-1;for(;r<=i;){const s=r+i>>1,o=t[s][0];if(o===e)return s;o<e?r=s+1:i=s-1}return i+1},mL=function([,e,t]){const r=D(this,ur,$C).call(this,e);h(this,Yi).splice(r,0,[e,t])},yL=function([,e,t]){const r=D(this,ur,$C).call(this,e);for(let i=r;i<h(this,Yi).length;i++){const[s,o]=h(this,Yi)[i];if(s!==e)break;if(s===e&&o===t){h(this,Yi).splice(i,1);return}}for(let i=r-1;i>=0;i--){const[s,o]=h(this,Yi)[i];if(s!==e)break;if(s===e&&o===t){h(this,Yi).splice(i,1);return}}},PR=function(e){const[t,r,i]=e,s=[[t,r,i]],o=D(this,ur,$C).call(this,i);for(let a=0;a<o;a++){const[l,u]=h(this,Yi)[a];for(let p=0,f=s.length;p<f;p++){const[,g,m]=s[p];if(!(u<=g||m<=l)){if(g>=l){if(m>u)s[p][1]=u;else{if(f===1)return[];s.splice(p,1),p--,f--}continue}s[p][2]=l,m>u&&s.push([t,u,m])}}}return s};var Ly,Ih;class PU extends Ee{constructor(t,r,i,s){super();_(this,Ly);_(this,Ih);T(this,Ih,t),T(this,Ly,r),this.firstPoint=i,this.lastPoint=s}toSVGPath(){const t=[];for(const r of h(this,Ih)){let[i,s]=r;t.push(`M${i} ${s}`);for(let o=2;o<r.length;o+=2){const a=r[o],l=r[o+1];a===i?(t.push(`V${l}`),s=l):l===s&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,r,i,s],o){const a=[],l=i-t,u=s-r;for(const p of h(this,Ih)){const f=new Array(p.length);for(let g=0;g<p.length;g+=2)f[g]=t+p[g]*l,f[g+1]=s-p[g+1]*u;a.push(f)}return a}get box(){return h(this,Ly)}get classNamesForOutlining(){return["highlightOutline"]}}Ly=new WeakMap,Ih=new WeakMap;class TR extends v0{newFreeDrawOutline(e,t,r,i,s,o){return new TU(e,t,r,i,s,o)}}class TU extends fL{newOutliner(e,t,r,i,s,o=0){return new TR(e,t,r,i,s,o)}}var _h,jy,zo,cu,zy,Ar,Fy,By,lu,Xr,Yr,On,kh,Mh,Xn,Dh,Ri,Uy,We,xR,JC,SL,CL,bL,IR,rl,xi,ld,wL,XC,YC,AL,EL,RL,PL,TL;const ut=class ut extends _t{constructor(t){super({...t,name:"highlightEditor"});_(this,We);_(this,_h,null);_(this,jy,0);_(this,zo);_(this,cu,null);_(this,zy,null);_(this,Ar,null);_(this,Fy,null);_(this,By,0);_(this,lu,null);_(this,Xr,null);_(this,Yr,null);_(this,On,!1);_(this,kh,null);_(this,Mh,null);_(this,Xn,null);_(this,Dh,"");_(this,Ri);_(this,Uy,"");this.color=t.color||ut._defaultColor,T(this,Ri,t.thickness||ut._defaultThickness),this.opacity=t.opacity||ut._defaultOpacity,T(this,zo,t.boxes||null),T(this,Uy,t.methodOfCreation||""),T(this,Dh,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(T(this,On,!0),D(this,We,JC).call(this,t),D(this,We,rl).call(this)):h(this,zo)&&(T(this,_h,t.anchorNode),T(this,jy,t.anchorOffset),T(this,Fy,t.focusNode),T(this,By,t.focusOffset),D(this,We,xR).call(this),D(this,We,rl).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=ut.prototype;return ze(this,"_keyboardManager",new Qy([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:h(this,On)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:h(this,Ri),methodOfCreation:h(this,Uy)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,r){var i;_t.initialize(t,r),ut._defaultColor||(ut._defaultColor=((i=r.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,r){switch(t){case nt.HIGHLIGHT_COLOR:ut._defaultColor=r;break;case nt.HIGHLIGHT_THICKNESS:ut._defaultThickness=r;break}}translateInPage(t,r){}get toolbarPosition(){return h(this,Mh)}get commentButtonPosition(){return h(this,kh)}updateParams(t,r){switch(t){case nt.HIGHLIGHT_COLOR:D(this,We,SL).call(this,r);break;case nt.HIGHLIGHT_THICKNESS:D(this,We,CL).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[nt.HIGHLIGHT_COLOR,ut._defaultColor],[nt.HIGHLIGHT_THICKNESS,ut._defaultThickness]]}get propertiesToUpdate(){return[[nt.HIGHLIGHT_COLOR,this.color||ut._defaultColor],[nt.HIGHLIGHT_THICKNESS,h(this,Ri)||ut._defaultThickness],[nt.HIGHLIGHT_FREE,h(this,On)]]}onUpdatedColor(){var t,r;(t=this.parent)==null||t.drawLayer.updateProperties(h(this,Yr),{root:{fill:this.color,"fill-opacity":this.opacity}}),(r=h(this,zy))==null||r.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",T(this,zy,new p0({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(D(this,We,YC).call(this))}getBaseTranslation(){return[0,0]}getRect(t,r){return super.getRect(t,r,D(this,We,YC).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){D(this,We,IR).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(D(this,We,rl).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let r=!1;this.parent&&!t?D(this,We,IR).call(this):t&&(D(this,We,rl).call(this,t),r=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),r&&this.select()}rotate(t){var s,o,a;const{drawLayer:r}=this.parent;let i;h(this,On)?(t=(t-this.rotation+360)%360,i=D(s=ut,xi,ld).call(s,h(this,Xr).box,t)):i=D(o=ut,xi,ld).call(o,[this.x,this.y,this.width,this.height],t),r.updateProperties(h(this,Yr),{bbox:i,root:{"data-main-rotation":t}}),r.updateProperties(h(this,Xn),{bbox:D(a=ut,xi,ld).call(a,h(this,Ar).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();h(this,Dh)&&(t.setAttribute("aria-label",h(this,Dh)),t.setAttribute("role","mark")),h(this,On)?t.classList.add("free"):this.div.addEventListener("keydown",D(this,We,wL).bind(this),{signal:this._uiManager._signal});const r=T(this,lu,document.createElement("div"));return t.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",r.style.clipPath=h(this,cu),this.setDims(),GO(this,h(this,lu),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(h(this,Xn),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(h(this,Xn),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:D(this,We,XC).call(this,!0);break;case 1:case 3:D(this,We,XC).call(this,!1);break}}select(){var t;super.select(),h(this,Xn)&&((t=this.parent)==null||t.drawLayer.updateProperties(h(this,Xn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),h(this,Xn)&&((t=this.parent)==null||t.drawLayer.updateProperties(h(this,Xn),{rootClass:{selected:!1}}),h(this,On)||D(this,We,XC).call(this,!1))}get _mustFixPosition(){return!h(this,On)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(h(this,Yr),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(h(this,Xn),{rootClass:{hidden:!t}}))}static startHighlighting(t,r,{target:i,x:s,y:o}){const{x:a,y:l,width:u,height:p}=i.getBoundingClientRect(),f=new AbortController,g=t.combinedSignal(f),m=C=>{f.abort(),D(this,xi,PL).call(this,t,C)};window.addEventListener("blur",m,{signal:g}),window.addEventListener("pointerup",m,{signal:g}),window.addEventListener("pointerdown",Qt,{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",_i,{signal:g}),i.addEventListener("pointermove",D(this,xi,RL).bind(this,t),{signal:g}),this._freeHighlight=new TR({x:s,y:o},[a,l,u,p],t.scale,this._defaultThickness/2,r,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,r,i){var S,w,b,R;let s=null;if(t instanceof tL){const{data:{quadPoints:P,rect:I,rotation:M,id:k,color:O,opacity:L,popupRef:F,richText:H,contentsObj:V,creationDate:ie,modificationDate:J},parent:{page:{pageNumber:ee}}}=t;s=t={annotationType:Be.HIGHLIGHT,color:Array.from(O),opacity:L,quadPoints:P,boxes:null,pageIndex:ee-1,rect:I.slice(0),rotation:M,annotationElementId:k,id:k,deleted:!1,popupRef:F,richText:H,comment:(V==null?void 0:V.str)||null,creationDate:ie,modificationDate:J}}else if(t instanceof vP){const{data:{inkLists:P,rect:I,rotation:M,id:k,color:O,borderStyle:{rawWidth:L},popupRef:F,richText:H,contentsObj:V,creationDate:ie,modificationDate:J},parent:{page:{pageNumber:ee}}}=t;s=t={annotationType:Be.HIGHLIGHT,color:Array.from(O),thickness:L,inkLists:P,boxes:null,pageIndex:ee-1,rect:I.slice(0),rotation:M,annotationElementId:k,id:k,deleted:!1,popupRef:F,richText:H,comment:(V==null?void 0:V.str)||null,creationDate:ie,modificationDate:J}}const{color:o,quadPoints:a,inkLists:l,opacity:u}=t,p=await super.deserialize(t,r,i);p.color=be.makeHexColor(...o),p.opacity=u||1,l&&T(p,Ri,t.thickness),p._initialData=s,t.comment&&p.setCommentData(t);const[f,g]=p.pageDimensions,[m,C]=p.pageTranslation;if(a){const P=T(p,zo,[]);for(let I=0;I<a.length;I+=8)P.push({x:(a[I]-m)/f,y:1-(a[I+1]-C)/g,width:(a[I+2]-a[I])/f,height:(a[I+1]-a[I+5])/g});D(S=p,We,xR).call(S),D(w=p,We,rl).call(w),p.rotate(p.rotation)}else if(l){T(p,On,!0);const P=l[0],I={x:P[0]-m,y:g-(P[1]-C)},M=new TR(I,[0,0,f,g],1,h(p,Ri)/2,!0,.001);for(let L=0,F=P.length;L<F;L+=2)I.x=P[L]-m,I.y=g-(P[L+1]-C),M.add(I);const{id:k,clipPathId:O}=r.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:p.color,"fill-opacity":p._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:M.toSVGPath()}},!0,!0);D(b=p,We,JC).call(b,{highlightOutlines:M.getOutlines(),highlightId:k,clipPathId:O}),D(R=p,We,rl).call(R),p.rotate(p.parentRotation)}return p}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const r=_t._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:r,opacity:this.opacity,thickness:h(this,Ri),quadPoints:D(this,We,AL).call(this),outlines:D(this,We,EL).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!D(this,We,TL).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};_h=new WeakMap,jy=new WeakMap,zo=new WeakMap,cu=new WeakMap,zy=new WeakMap,Ar=new WeakMap,Fy=new WeakMap,By=new WeakMap,lu=new WeakMap,Xr=new WeakMap,Yr=new WeakMap,On=new WeakMap,kh=new WeakMap,Mh=new WeakMap,Xn=new WeakMap,Dh=new WeakMap,Ri=new WeakMap,Uy=new WeakMap,We=new WeakSet,xR=function(){const t=new RR(h(this,zo),.001);T(this,Xr,t.getOutlines()),[this.x,this.y,this.width,this.height]=h(this,Xr).box;const r=new RR(h(this,zo),.0025,.001,this._uiManager.direction==="ltr");T(this,Ar,r.getOutlines());const{firstPoint:i}=h(this,Xr);T(this,kh,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:s}=h(this,Ar);T(this,Mh,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},JC=function({highlightOutlines:t,highlightId:r,clipPathId:i}){var g,m;if(T(this,Xr,t),T(this,Ar,t.getNewOutline(h(this,Ri)/2+1.5,.0025)),r>=0)T(this,Yr,r),T(this,cu,i),this.parent.drawLayer.finalizeDraw(r,{bbox:t.box,path:{d:t.toSVGPath()}}),T(this,Xn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:h(this,Ar).box,path:{d:h(this,Ar).toSVGPath()}},!0));else if(this.parent){const C=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(h(this,Yr),{bbox:D(g=ut,xi,ld).call(g,h(this,Xr).box,(C-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(h(this,Xn),{bbox:D(m=ut,xi,ld).call(m,h(this,Ar).box,C),path:{d:h(this,Ar).toSVGPath()}})}const[o,a,l,u]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=l,this.height=u;break;case 90:{const[C,S]=this.parentDimensions;this.x=a,this.y=1-o,this.width=l*S/C,this.height=u*C/S;break}case 180:this.x=1-o,this.y=1-a,this.width=l,this.height=u;break;case 270:{const[C,S]=this.parentDimensions;this.x=1-a,this.y=o,this.width=l*S/C,this.height=u*C/S;break}}const{firstPoint:p}=t;T(this,kh,[(p[0]-o)/l,(p[1]-a)/u]);const{lastPoint:f}=h(this,Ar);T(this,Mh,[(f[0]-o)/l,(f[1]-a)/u])},SL=function(t){const r=(o,a)=>{this.color=o,this.opacity=a,this.onUpdatedColor()},i=this.color,s=this.opacity;this.addCommands({cmd:r.bind(this,t,ut._defaultOpacity),undo:r.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:nt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},CL=function(t){const r=h(this,Ri),i=s=>{T(this,Ri,s),D(this,We,bL).call(this,s)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:nt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},bL=function(t){h(this,On)&&(D(this,We,JC).call(this,{highlightOutlines:h(this,Xr).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},IR=function(){h(this,Yr)===null||!this.parent||(this.parent.drawLayer.remove(h(this,Yr)),T(this,Yr,null),this.parent.drawLayer.remove(h(this,Xn)),T(this,Xn,null))},rl=function(t=this.parent){h(this,Yr)===null&&({id:dn(this,Yr)._,clipPathId:dn(this,cu)._}=t.drawLayer.draw({bbox:h(this,Xr).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:h(this,On)},path:{d:h(this,Xr).toSVGPath()}},!1,!0),T(this,Xn,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:h(this,On)},bbox:h(this,Ar).box,path:{d:h(this,Ar).toSVGPath()}},h(this,On))),h(this,lu)&&(h(this,lu).style.clipPath=h(this,cu)))},xi=new WeakSet,ld=function([t,r,i,s],o){switch(o){case 90:return[1-r-s,t,s,i];case 180:return[1-t-i,1-r-s,i,s];case 270:return[r,1-t-i,s,i]}return[t,r,i,s]},wL=function(t){ut._keyboardManager.exec(this,t)},XC=function(t){if(!h(this,_h))return;const r=window.getSelection();t?r.setPosition(h(this,_h),h(this,jy)):r.setPosition(h(this,Fy),h(this,By))},YC=function(){return h(this,On)?this.rotation:0},AL=function(){if(h(this,On))return null;const[t,r]=this.pageDimensions,[i,s]=this.pageTranslation,o=h(this,zo),a=new Float32Array(o.length*8);let l=0;for(const{x:u,y:p,width:f,height:g}of o){const m=u*t+i,C=(1-p)*r+s;a[l]=a[l+4]=m,a[l+1]=a[l+3]=C,a[l+2]=a[l+6]=m+f*t,a[l+5]=a[l+7]=C-g*r,l+=8}return a},EL=function(t){return h(this,Xr).serialize(t,D(this,We,YC).call(this))},RL=function(t,r){this._freeHighlight.add(r)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},PL=function(t,r){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(r,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},TL=function(t){const{color:r}=this._initialData;return this.hasEditedComment||t.color.some((i,s)=>i!==r[s])},_(ut,xi),G(ut,"_defaultColor",null),G(ut,"_defaultOpacity",1),G(ut,"_defaultThickness",12),G(ut,"_type","highlight"),G(ut,"_editorType",Be.HIGHLIGHT),G(ut,"_freeHighlightId",-1),G(ut,"_freeHighlight",null),G(ut,"_freeHighlightClipId","");let m0=ut;var uu;class xL{constructor(){_(this,uu,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,r]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,r)}updateSVGProperty(e,t){h(this,uu)[e]=t}toSVGProperties(){const e=h(this,uu);return T(this,uu,Object.create(null)),{root:e}}reset(){T(this,uu,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Pt("Not implemented")}}uu=new WeakMap;var Qr,Nh,An,du,hu,at,_R,kR,MR,Vv,IL,QC,Gv,ud;const tt=class tt extends _t{constructor(t){super(t);_(this,at);_(this,Qr,null);_(this,Nh);G(this,"_colorPicker",null);G(this,"_drawId",null);T(this,Nh,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(D(this,at,_R).call(this,t),D(this,at,Vv).call(this))}static _mergeSVGProperties(t,r){const i=new Set(Object.keys(t));for(const[s,o]of Object.entries(r))i.has(s)?Object.assign(t[s],o):t[s]=o;return t}static getDefaultDrawingOptions(t){Pt("Not implemented")}static get typesMap(){Pt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,r){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,r),this._currentParent&&(h(tt,An).updateProperty(i,r),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,r){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,r)}static get defaultPropertiesToUpdate(){const t=[],r=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)t.push([i,r[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:r}=this;for(const[i,s]of this.constructor.typesMap)t.push([i,r[s]]);return t}_updateProperty(t,r,i){const s=this._drawingOptions,o=s[r],a=l=>{var p;s.updateProperty(r,l);const u=h(this,Qr).updateProperty(r,l);u&&D(this,at,Gv).call(this,u),(p=this.parent)==null||p.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,tt._mergeSVGProperties(h(this,Qr).getPathResizingSVGProperties(D(this,at,QC).call(this)),{bbox:D(this,at,ud).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,tt._mergeSVGProperties(h(this,Qr).getPathResizedSVGProperties(D(this,at,QC).call(this)),{bbox:D(this,at,ud).call(this)}))}_onTranslating(t,r){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:D(this,at,ud).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,tt._mergeSVGProperties(h(this,Qr).getPathTranslatedSVGProperties(D(this,at,QC).call(this),this.parentDimensions),{bbox:D(this,at,ud).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,h(this,Nh)&&(T(this,Nh,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){D(this,at,MR).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(D(this,at,Vv).call(this),D(this,at,Gv).call(this,h(this,Qr).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let r=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),D(this,at,MR).call(this)):t&&(this._uiManager.addShouldRescale(this),D(this,at,Vv).call(this,t),r=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),r&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,tt._mergeSVGProperties({bbox:D(this,at,ud).call(this)},h(this,Qr).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&D(this,at,Gv).call(this,h(this,Qr).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,r;this._isCopy&&(t=this.x,r=this.y);const i=super.render();i.classList.add("draw");const s=document.createElement("div");return i.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,r),i}static createDrawerInstance(t,r,i,s,o){Pt("Not implemented")}static startDrawing(t,r,i,s){var w;const{target:o,offsetX:a,offsetY:l,pointerId:u,pointerType:p}=s;if(Vn.isInitializedAndDifferentPointerType(p))return;const{viewport:{rotation:f}}=t,{width:g,height:m}=o.getBoundingClientRect(),C=T(tt,du,new AbortController),S=t.combinedSignal(C);if(Vn.setPointer(p,u),window.addEventListener("pointerup",b=>{Vn.isSamePointerIdOrRemove(b.pointerId)&&this._endDraw(b)},{signal:S}),window.addEventListener("pointercancel",b=>{Vn.isSamePointerIdOrRemove(b.pointerId)&&this._currentParent.endDrawingSession()},{signal:S}),window.addEventListener("pointerdown",b=>{Vn.isSamePointerType(b.pointerType)&&(Vn.initializeAndAddPointerId(b.pointerId),h(tt,An).isCancellable()&&(h(tt,An).removeLastElement(),h(tt,An).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:S}),window.addEventListener("contextmenu",_i,{signal:S}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:S}),o.addEventListener("touchmove",b=>{Vn.isSameTimeStamp(b.timeStamp)&&Qt(b)},{signal:S}),t.toggleDrawing(),(w=r._editorUndoBar)==null||w.hide(),h(tt,An)){t.drawLayer.updateProperties(this._currentDrawId,h(tt,An).startNew(a,l,g,m,f));return}r.updateUIForDefaultProperties(this),T(tt,An,this.createDrawerInstance(a,l,g,m,f)),T(tt,hu,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(h(tt,hu).toSVGProperties(),h(tt,An).defaultSVGProperties),!0,!1)}static _drawMove(t){if(Vn.isSameTimeStamp(t.timeStamp),!h(tt,An))return;const{offsetX:r,offsetY:i,pointerId:s}=t;if(Vn.isSamePointerId(s)){if(Vn.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,h(tt,An).add(r,i)),Vn.setTimeStamp(t.timeStamp),Qt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,T(tt,An,null),T(tt,hu,null),Vn.clearTimeStamp()),h(tt,du)&&(h(tt,du).abort(),T(tt,du,null),Vn.clearPointerIds())}static _endDraw(t){const r=this._currentParent;if(r){if(r.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===r.div&&r.drawLayer.updateProperties(this._currentDrawId,h(tt,An).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=h(tt,An),s=this._currentDrawId,o=i.getLastElement();r.addCommands({cmd:()=>{r.drawLayer.updateProperties(s,i.setLastElement(o))},undo:()=>{r.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:nt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const r=this._currentParent;if(!r)return null;if(r.toggleDrawing(!0),r.cleanUndoStack(nt.DRAW_STEP),!h(tt,An).isEmpty()){const{pageDimensions:[i,s],scale:o}=r,a=r.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:h(tt,An).getOutlines(i*o,s*o,o,this._INNER_MARGIN),drawingOptions:h(tt,hu),mustBeCommitted:!t});return this._cleanup(!0),a}return r.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,r,i,s,o,a){Pt("Not implemented")}static async deserialize(t,r,i){var f,g;const{rawDims:{pageWidth:s,pageHeight:o,pageX:a,pageY:l}}=r.viewport,u=this.deserializeDraw(a,l,s,o,this._INNER_MARGIN,t),p=await super.deserialize(t,r,i);return p.createDrawingOptions(t),D(f=p,at,_R).call(f,{drawOutlines:u}),D(g=p,at,Vv).call(g),p.onScaleChanging(),p.rotate(),p}serializeDraw(t){const[r,i]=this.pageTranslation,[s,o]=this.pageDimensions;return h(this,Qr).serialize([r,i,s,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};Qr=new WeakMap,Nh=new WeakMap,An=new WeakMap,du=new WeakMap,hu=new WeakMap,at=new WeakSet,_R=function({drawOutlines:t,drawId:r,drawingOptions:i}){T(this,Qr,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),r>=0?(this._drawId=r,this.parent.drawLayer.finalizeDraw(r,t.defaultProperties)):this._drawId=D(this,at,kR).call(this,t,this.parent),D(this,at,Gv).call(this,t.box)},kR=function(t,r){const{id:i}=r.drawLayer.draw(tt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},MR=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Vv=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=D(this,at,kR).call(this,h(this,Qr),t)}},IL=function([t,r,i,s]){const{parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[r,1-t,i*(a/o),s*(o/a)];case 180:return[1-t,1-r,i,s];case 270:return[1-r,t,i*(a/o),s*(o/a)];default:return[t,r,i,s]}},QC=function(){const{x:t,y:r,width:i,height:s,parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[1-r,t,i*(o/a),s*(a/o)];case 180:return[1-t,1-r,i,s];case 270:return[r,1-t,i*(o/a),s*(a/o)];default:return[t,r,i,s]}},Gv=function(t){[this.x,this.y,this.width,this.height]=D(this,at,IL).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},ud=function(){const{x:t,y:r,width:i,height:s,rotation:o,parentRotation:a,parentDimensions:[l,u]}=this;switch((o*4+a)/90){case 1:return[1-r-s,t,s,i];case 2:return[1-t-i,1-r-s,i,s];case 3:return[r,1-t-i,s,i];case 4:return[t,r-i*(l/u),s*(u/l),i*(l/u)];case 5:return[1-r,t,i*(l/u),s*(u/l)];case 6:return[1-t-s*(u/l),1-r,s*(u/l),i*(l/u)];case 7:return[r-i*(l/u),1-t-s*(u/l),i*(l/u),s*(u/l)];case 8:return[t-i,r-s,i,s];case 9:return[1-r,t-i,s,i];case 10:return[1-t,1-r,i,s];case 11:return[r-s,1-t,s,i];case 12:return[t-s*(u/l),r,s*(u/l),i*(l/u)];case 13:return[1-r-i*(l/u),t-s*(u/l),i*(l/u),s*(u/l)];case 14:return[1-t,1-r-i*(l/u),s*(u/l),i*(l/u)];case 15:return[r,1-t,i*(l/u),s*(u/l)];default:return[t,r,i,s]}},G(tt,"_currentDrawId",-1),G(tt,"_currentParent",null),_(tt,An,null),_(tt,du,null),_(tt,hu,null),G(tt,"_INNER_MARGIN",3);let y0=tt;var Os,En,Rn,pu,Oh,ir,Ln,Pi,fu,gu,vu,Lh,ZC;class xU{constructor(e,t,r,i,s,o){_(this,Lh);_(this,Os,new Float64Array(6));_(this,En);_(this,Rn);_(this,pu);_(this,Oh);_(this,ir);_(this,Ln,"");_(this,Pi,0);_(this,fu,new eS);_(this,gu);_(this,vu);T(this,gu,r),T(this,vu,i),T(this,pu,s),T(this,Oh,o),[e,t]=D(this,Lh,ZC).call(this,e,t);const a=T(this,En,[NaN,NaN,NaN,NaN,e,t]);T(this,ir,[e,t]),T(this,Rn,[{line:a,points:h(this,ir)}]),h(this,Os).set(a,0)}updateProperty(e,t){e==="stroke-width"&&T(this,Oh,t)}isEmpty(){return!h(this,Rn)||h(this,Rn).length===0}isCancellable(){return h(this,ir).length<=10}add(e,t){[e,t]=D(this,Lh,ZC).call(this,e,t);const[r,i,s,o]=h(this,Os).subarray(2,6),a=e-s,l=t-o;return Math.hypot(h(this,gu)*a,h(this,vu)*l)<=2?null:(h(this,ir).push(e,t),isNaN(r)?(h(this,Os).set([s,o,e,t],2),h(this,En).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(h(this,Os)[0])&&h(this,En).splice(6,6),h(this,Os).set([r,i,s,o,e,t],0),h(this,En).push(...Ee.createBezierPoints(r,i,s,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const r=this.add(e,t);return r||(h(this,ir).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,r,i,s){T(this,gu,r),T(this,vu,i),T(this,pu,s),[e,t]=D(this,Lh,ZC).call(this,e,t);const o=T(this,En,[NaN,NaN,NaN,NaN,e,t]);T(this,ir,[e,t]);const a=h(this,Rn).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),h(this,Rn).push({line:o,points:h(this,ir)}),h(this,Os).set(o,0),T(this,Pi,0),this.toSVGPath(),null}getLastElement(){return h(this,Rn).at(-1)}setLastElement(e){return h(this,Rn)?(h(this,Rn).push(e),T(this,En,e.line),T(this,ir,e.points),T(this,Pi,0),{path:{d:this.toSVGPath()}}):h(this,fu).setLastElement(e)}removeLastElement(){if(!h(this,Rn))return h(this,fu).removeLastElement();h(this,Rn).pop(),T(this,Ln,"");for(let e=0,t=h(this,Rn).length;e<t;e++){const{line:r,points:i}=h(this,Rn)[e];T(this,En,r),T(this,ir,i),T(this,Pi,0),this.toSVGPath()}return{path:{d:h(this,Ln)}}}toSVGPath(){const e=Ee.svgRound(h(this,En)[4]),t=Ee.svgRound(h(this,En)[5]);if(h(this,ir).length===2)return T(this,Ln,`${h(this,Ln)} M ${e} ${t} Z`),h(this,Ln);if(h(this,ir).length<=6){const i=h(this,Ln).lastIndexOf("M");T(this,Ln,`${h(this,Ln).slice(0,i)} M ${e} ${t}`),T(this,Pi,6)}if(h(this,ir).length===4){const i=Ee.svgRound(h(this,En)[10]),s=Ee.svgRound(h(this,En)[11]);return T(this,Ln,`${h(this,Ln)} L ${i} ${s}`),T(this,Pi,12),h(this,Ln)}const r=[];h(this,Pi)===0&&(r.push(`M ${e} ${t}`),T(this,Pi,6));for(let i=h(this,Pi),s=h(this,En).length;i<s;i+=6){const[o,a,l,u,p,f]=h(this,En).slice(i,i+6).map(Ee.svgRound);r.push(`C${o} ${a} ${l} ${u} ${p} ${f}`)}return T(this,Ln,h(this,Ln)+r.join(" ")),T(this,Pi,h(this,En).length),h(this,Ln)}getOutlines(e,t,r,i){const s=h(this,Rn).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),h(this,fu).build(h(this,Rn),e,t,r,h(this,pu),h(this,Oh),i),T(this,Os,null),T(this,En,null),T(this,Rn,null),T(this,Ln,null),h(this,fu)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Os=new WeakMap,En=new WeakMap,Rn=new WeakMap,pu=new WeakMap,Oh=new WeakMap,ir=new WeakMap,Ln=new WeakMap,Pi=new WeakMap,fu=new WeakMap,gu=new WeakMap,vu=new WeakMap,Lh=new WeakSet,ZC=function(e,t){return Ee._normalizePoint(e,t,h(this,gu),h(this,vu),h(this,pu))};var sr,Hy,Wy,Zr,Ls,js,jh,zh,mu,zn,so,_L,kL,ML;class eS extends Ee{constructor(){super(...arguments);_(this,zn);_(this,sr);_(this,Hy,0);_(this,Wy);_(this,Zr);_(this,Ls);_(this,js);_(this,jh);_(this,zh);_(this,mu)}build(t,r,i,s,o,a,l){T(this,Ls,r),T(this,js,i),T(this,jh,s),T(this,zh,o),T(this,mu,a),T(this,Wy,l??0),T(this,Zr,t),D(this,zn,kL).call(this)}get thickness(){return h(this,mu)}setLastElement(t){return h(this,Zr).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return h(this,Zr).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:r}of h(this,Zr)){if(t.push(`M${Ee.svgRound(r[4])} ${Ee.svgRound(r[5])}`),r.length===6){t.push("Z");continue}if(r.length===12&&isNaN(r[6])){t.push(`L${Ee.svgRound(r[10])} ${Ee.svgRound(r[11])}`);continue}for(let i=6,s=r.length;i<s;i+=6){const[o,a,l,u,p,f]=r.subarray(i,i+6).map(Ee.svgRound);t.push(`C${o} ${a} ${l} ${u} ${p} ${f}`)}}return t.join("")}serialize([t,r,i,s],o){const a=[],l=[],[u,p,f,g]=D(this,zn,_L).call(this);let m,C,S,w,b,R,P,I,M;switch(h(this,zh)){case 0:M=Ee._rescale,m=t,C=r+s,S=i,w=-s,b=t+u*i,R=r+(1-p-g)*s,P=t+(u+f)*i,I=r+(1-p)*s;break;case 90:M=Ee._rescaleAndSwap,m=t,C=r,S=i,w=s,b=t+p*i,R=r+u*s,P=t+(p+g)*i,I=r+(u+f)*s;break;case 180:M=Ee._rescale,m=t+i,C=r,S=-i,w=s,b=t+(1-u-f)*i,R=r+p*s,P=t+(1-u)*i,I=r+(p+g)*s;break;case 270:M=Ee._rescaleAndSwap,m=t+i,C=r+s,S=-i,w=-s,b=t+(1-p-g)*i,R=r+(1-u-f)*s,P=t+(1-p)*i,I=r+(1-u)*s;break}for(const{line:k,points:O}of h(this,Zr))a.push(M(k,m,C,S,w,o?new Array(k.length):null)),l.push(M(O,m,C,S,w,o?new Array(O.length):null));return{lines:a,points:l,rect:[b,R,P,I]}}static deserialize(t,r,i,s,o,{paths:{lines:a,points:l},rotation:u,thickness:p}){const f=[];let g,m,C,S,w;switch(u){case 0:w=Ee._rescale,g=-t/i,m=r/s+1,C=1/i,S=-1/s;break;case 90:w=Ee._rescaleAndSwap,g=-r/s,m=-t/i,C=1/s,S=1/i;break;case 180:w=Ee._rescale,g=t/i+1,m=-r/s,C=-1/i,S=1/s;break;case 270:w=Ee._rescaleAndSwap,g=r/s+1,m=t/i+1,C=-1/s,S=-1/i;break}if(!a){a=[];for(const R of l){const P=R.length;if(P===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,R[0],R[1]]));continue}if(P===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,R[0],R[1],NaN,NaN,NaN,NaN,R[2],R[3]]));continue}const I=new Float32Array(3*(P-2));a.push(I);let[M,k,O,L]=R.subarray(0,4);I.set([NaN,NaN,NaN,NaN,M,k],0);for(let F=4;F<P;F+=2){const H=R[F],V=R[F+1];I.set(Ee.createBezierPoints(M,k,O,L,H,V),(F-2)*3),[M,k,O,L]=[O,L,H,V]}}}for(let R=0,P=a.length;R<P;R++)f.push({line:w(a[R].map(I=>I??NaN),g,m,C,S),points:w(l[R].map(I=>I??NaN),g,m,C,S)});const b=new this.prototype.constructor;return b.build(f,i,s,1,u,p,o),b}get box(){return h(this,sr)}updateProperty(t,r){return t==="stroke-width"?D(this,zn,ML).call(this,r):null}updateParentDimensions([t,r],i){const[s,o]=D(this,zn,so).call(this);T(this,Ls,t),T(this,js,r),T(this,jh,i);const[a,l]=D(this,zn,so).call(this),u=a-s,p=l-o,f=h(this,sr);return f[0]-=u,f[1]-=p,f[2]+=2*u,f[3]+=2*p,f}updateRotation(t){return T(this,Hy,t),{path:{transform:this.rotationTransform}}}get viewBox(){return h(this,sr).map(Ee.svgRound).join(" ")}get defaultProperties(){const[t,r]=h(this,sr);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ee.svgRound(t)} ${Ee.svgRound(r)}`}}}get rotationTransform(){const[,,t,r]=h(this,sr);let i=0,s=0,o=0,a=0,l=0,u=0;switch(h(this,Hy)){case 90:s=r/t,o=-t/r,l=t;break;case 180:i=-1,a=-1,l=t,u=r;break;case 270:s=-r/t,o=t/r,u=r;break;default:return""}return`matrix(${i} ${s} ${o} ${a} ${Ee.svgRound(l)} ${Ee.svgRound(u)})`}getPathResizingSVGProperties([t,r,i,s]){const[o,a]=D(this,zn,so).call(this),[l,u,p,f]=h(this,sr);if(Math.abs(p-o)<=Ee.PRECISION||Math.abs(f-a)<=Ee.PRECISION){const w=t+i/2-(l+p/2),b=r+s/2-(u+f/2);return{path:{"transform-origin":`${Ee.svgRound(t)} ${Ee.svgRound(r)}`,transform:`${this.rotationTransform} translate(${w} ${b})`}}}const g=(i-2*o)/(p-2*o),m=(s-2*a)/(f-2*a),C=p/i,S=f/s;return{path:{"transform-origin":`${Ee.svgRound(l)} ${Ee.svgRound(u)}`,transform:`${this.rotationTransform} scale(${C} ${S}) translate(${Ee.svgRound(o)} ${Ee.svgRound(a)}) scale(${g} ${m}) translate(${Ee.svgRound(-o)} ${Ee.svgRound(-a)})`}}}getPathResizedSVGProperties([t,r,i,s]){const[o,a]=D(this,zn,so).call(this),l=h(this,sr),[u,p,f,g]=l;if(l[0]=t,l[1]=r,l[2]=i,l[3]=s,Math.abs(f-o)<=Ee.PRECISION||Math.abs(g-a)<=Ee.PRECISION){const b=t+i/2-(u+f/2),R=r+s/2-(p+g/2);for(const{line:P,points:I}of h(this,Zr))Ee._translate(P,b,R,P),Ee._translate(I,b,R,I);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ee.svgRound(t)} ${Ee.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*o)/(f-2*o),C=(s-2*a)/(g-2*a),S=-m*(u+o)+t+o,w=-C*(p+a)+r+a;if(m!==1||C!==1||S!==0||w!==0)for(const{line:b,points:R}of h(this,Zr))Ee._rescale(b,S,w,m,C,b),Ee._rescale(R,S,w,m,C,R);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ee.svgRound(t)} ${Ee.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,r],i){const[s,o]=i,a=h(this,sr),l=t-a[0],u=r-a[1];if(h(this,Ls)===s&&h(this,js)===o)for(const{line:p,points:f}of h(this,Zr))Ee._translate(p,l,u,p),Ee._translate(f,l,u,f);else{const p=h(this,Ls)/s,f=h(this,js)/o;T(this,Ls,s),T(this,js,o);for(const{line:g,points:m}of h(this,Zr))Ee._rescale(g,l,u,p,f,g),Ee._rescale(m,l,u,p,f,m);a[2]*=p,a[3]*=f}return a[0]=t,a[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Ee.svgRound(t)} ${Ee.svgRound(r)}`}}}get defaultSVGProperties(){const t=h(this,sr);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Ee.svgRound(t[0])} ${Ee.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}sr=new WeakMap,Hy=new WeakMap,Wy=new WeakMap,Zr=new WeakMap,Ls=new WeakMap,js=new WeakMap,jh=new WeakMap,zh=new WeakMap,mu=new WeakMap,zn=new WeakSet,so=function(t=h(this,mu)){const r=h(this,Wy)+t/2*h(this,jh);return h(this,zh)%180===0?[r/h(this,Ls),r/h(this,js)]:[r/h(this,js),r/h(this,Ls)]},_L=function(){const[t,r,i,s]=h(this,sr),[o,a]=D(this,zn,so).call(this,0);return[t+o,r+a,i-2*o,s-2*a]},kL=function(){const t=T(this,sr,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of h(this,Zr)){if(s.length<=12){for(let l=4,u=s.length;l<u;l+=6)be.pointBoundingBox(s[l],s[l+1],t);continue}let o=s[4],a=s[5];for(let l=6,u=s.length;l<u;l+=6){const[p,f,g,m,C,S]=s.subarray(l,l+6);be.bezierBoundingBox(o,a,p,f,g,m,C,S,t),o=C,a=S}}const[r,i]=D(this,zn,so).call(this);t[0]=cr(t[0]-r,0,1),t[1]=cr(t[1]-i,0,1),t[2]=cr(t[2]+r,0,1),t[3]=cr(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},ML=function(t){const[r,i]=D(this,zn,so).call(this);T(this,mu,t);const[s,o]=D(this,zn,so).call(this),[a,l]=[s-r,o-i],u=h(this,sr);return u[0]-=a,u[1]-=l,u[2]+=2*a,u[3]+=2*l,u};class K0 extends xL{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:_t._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new K0(this._viewParameters);return e.updateAll(this),e}}var j0,DL;const md=class md extends y0{constructor(t){super({...t,name:"inkEditor"});_(this,j0);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,r){_t.initialize(t,r),this._defaultDrawingOptions=new K0(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!0}static get typesMap(){return ze(this,"typesMap",new Map([[nt.INK_THICKNESS,"stroke-width"],[nt.INK_COLOR,"stroke"],[nt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,r,i,s,o){return new xU(t,r,i,s,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,r,i,s,o,a){return eS.deserialize(t,r,i,s,o,a)}static async deserialize(t,r,i){let s=null;if(t instanceof vP){const{data:{inkLists:a,rect:l,rotation:u,id:p,color:f,opacity:g,borderStyle:{rawWidth:m},popupRef:C,richText:S,contentsObj:w,creationDate:b,modificationDate:R},parent:{page:{pageNumber:P}}}=t;s=t={annotationType:Be.INK,color:Array.from(f),thickness:m,opacity:g,paths:{points:a},boxes:null,pageIndex:P-1,rect:l.slice(0),rotation:u,annotationElementId:p,id:p,deleted:!1,popupRef:C,richText:S,comment:(w==null?void 0:w.str)||null,creationDate:b,modificationDate:R}}const o=await super.deserialize(t,r,i);return o._initialData=s,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new f0(this)),[["colorPicker",this._colorPicker]]}get colorType(){return nt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:r,parent:i}=this;r.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,r.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:r,opacity:i}){this._drawingOptions=md.getDefaultDrawingOptions({stroke:be.makeHexColor(...t),"stroke-width":r,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:r,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":o,"stroke-width":a}}=this,l=Object.assign(super.serialize(t),{color:_t._colorManager.convert(s),opacity:o,thickness:a,paths:{lines:r,points:i}});return this.addComment(l),t?(l.isCopy=!0,l):this.annotationElementId&&!D(this,j0,DL).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:r,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:r,popup:this.comment}),null}};j0=new WeakSet,DL=function(t){const{color:r,thickness:i,opacity:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((a,l)=>a!==r[l])||t.thickness!==i||t.opacity!==s||t.pageIndex!==o},G(md,"_type","ink"),G(md,"_editorType",Be.INK),G(md,"_defaultDrawingOptions",null);let DR=md;class NR extends eS{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const wC=8,Rv=3;var yu,dt,OR,Qi,NL,OL,LR,e0,LL,jL,zL,jR,zR,FL;class qo{static extractContoursFromText(e,{fontFamily:t,fontStyle:r,fontWeight:i},s,o,a,l){let u=new OffscreenCanvas(1,1),p=u.getContext("2d",{alpha:!1});const f=200,g=p.font=`${r} ${i} ${f}px ${t}`,{actualBoundingBoxLeft:m,actualBoundingBoxRight:C,actualBoundingBoxAscent:S,actualBoundingBoxDescent:w,fontBoundingBoxAscent:b,fontBoundingBoxDescent:R,width:P}=p.measureText(e),I=1.5,M=Math.ceil(Math.max(Math.abs(m)+Math.abs(C)||0,P)*I),k=Math.ceil(Math.max(Math.abs(S)+Math.abs(w)||f,Math.abs(b)+Math.abs(R)||f)*I);u=new OffscreenCanvas(M,k),p=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=g,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,M,k),p.fillStyle="black",p.fillText(e,M*(I-1)/2,k*(3-I)/2);const O=D(this,dt,jR).call(this,p.getImageData(0,0,M,k).data),L=D(this,dt,zL).call(this,O),F=D(this,dt,zR).call(this,L),H=D(this,dt,LR).call(this,O,M,k,F);return this.processDrawnLines({lines:{curves:H,width:M,height:k},pageWidth:s,pageHeight:o,rotation:a,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,r,i,s){const[o,a,l]=D(this,dt,FL).call(this,e),[u,p]=D(this,dt,jL).call(this,o,a,l,Math.hypot(a,l)*h(this,yu).sigmaSFactor,h(this,yu).sigmaR,h(this,yu).kernelSize),f=D(this,dt,zR).call(this,p),g=D(this,dt,LR).call(this,u,a,l,f);return this.processDrawnLines({lines:{curves:g,width:a,height:l},pageWidth:t,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:o,areContours:a}){i%180!==0&&([t,r]=[r,t]);const{curves:l,width:u,height:p}=e,f=e.thickness??0,g=[],m=Math.min(t/u,r/p),C=m/t,S=m/r,w=[];for(const{points:R}of l){const P=o?D(this,dt,LL).call(this,R):R;if(!P)continue;w.push(P);const I=P.length,M=new Float32Array(I),k=new Float32Array(3*(I===2?2:I-2));if(g.push({line:k,points:M}),I===2){M[0]=P[0]*C,M[1]=P[1]*S,k.set([NaN,NaN,NaN,NaN,M[0],M[1]],0);continue}let[O,L,F,H]=P;O*=C,L*=S,F*=C,H*=S,M.set([O,L,F,H],0),k.set([NaN,NaN,NaN,NaN,O,L],0);for(let V=4;V<I;V+=2){const ie=M[V]=P[V]*C,J=M[V+1]=P[V+1]*S;k.set(Ee.createBezierPoints(O,L,F,H,ie,J),(V-2)*3),[O,L,F,H]=[F,H,ie,J]}}if(g.length===0)return null;const b=a?new NR:new eS;return b.build(g,t,r,1,i,a?0:f,s),{outline:b,newCurves:w,areContours:a,thickness:f,width:u,height:p}}static async compressSignature({outlines:e,areContours:t,thickness:r,width:i,height:s}){let o=1/0,a=-1/0,l=0;for(const P of e){l+=P.length;for(let I=2,M=P.length;I<M;I++){const k=P[I]-P[I-2];o=Math.min(o,k),a=Math.max(a,k)}}let u;o>=-128&&a<=127?u=Int8Array:o>=-32768&&a<=32767?u=Int16Array:u=Int32Array;const p=e.length,f=wC+Rv*p,g=new Uint32Array(f);let m=0;g[m++]=f*Uint32Array.BYTES_PER_ELEMENT+(l-2*p)*u.BYTES_PER_ELEMENT,g[m++]=0,g[m++]=i,g[m++]=s,g[m++]=t?0:1,g[m++]=Math.max(0,Math.floor(r??0)),g[m++]=p,g[m++]=u.BYTES_PER_ELEMENT;for(const P of e)g[m++]=P.length-2,g[m++]=P[0],g[m++]=P[1];const C=new CompressionStream("deflate-raw"),S=C.writable.getWriter();await S.ready,S.write(g);const w=u.prototype.constructor;for(const P of e){const I=new w(P.length-2);for(let M=2,k=P.length;M<k;M++)I[M-2]=P[M]-P[M-2];S.write(I)}S.close();const b=await new Response(C.readable).arrayBuffer(),R=new Uint8Array(b);return jO(R)}static async decompressSignature(e){try{const t=W5(e),{readable:r,writable:i}=new DecompressionStream("deflate-raw"),s=i.getWriter();await s.ready,s.write(t).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let o=null,a=0;for await(const P of r)o||(o=new Uint8Array(new Uint32Array(P.buffer,0,4)[0])),o.set(P,a),a+=P.length;const l=new Uint32Array(o.buffer,0,o.length>>2),u=l[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const p=l[2],f=l[3],g=l[4]===0,m=l[5],C=l[6],S=l[7],w=[],b=(wC+Rv*C)*Uint32Array.BYTES_PER_ELEMENT;let R;switch(S){case Int8Array.BYTES_PER_ELEMENT:R=new Int8Array(o.buffer,b);break;case Int16Array.BYTES_PER_ELEMENT:R=new Int16Array(o.buffer,b);break;case Int32Array.BYTES_PER_ELEMENT:R=new Int32Array(o.buffer,b);break}a=0;for(let P=0;P<C;P++){const I=l[Rv*P+wC],M=new Float32Array(I+2);w.push(M);for(let k=0;k<Rv-1;k++)M[k]=l[Rv*P+wC+k+1];for(let k=0;k<I;k++)M[k+2]=M[k]+R[a++]}return{areContours:g,thickness:m,outlines:w,width:p,height:f}}catch(t){return Le(`decompressSignature: ${t}`),null}}}yu=new WeakMap,dt=new WeakSet,OR=function(e,t,r,i){return r-=e,i-=t,r===0?i>0?0:4:r===1?i+6:2-i},Qi=new WeakMap,NL=function(e,t,r,i,s,o,a){const l=D(this,dt,OR).call(this,r,i,s,o);for(let u=0;u<8;u++){const p=(-u+l-a+16)%8,f=h(this,Qi)[2*p],g=h(this,Qi)[2*p+1];if(e[(r+f)*t+(i+g)]!==0)return p}return-1},OL=function(e,t,r,i,s,o,a){const l=D(this,dt,OR).call(this,r,i,s,o);for(let u=0;u<8;u++){const p=(u+l+a+16)%8,f=h(this,Qi)[2*p],g=h(this,Qi)[2*p+1];if(e[(r+f)*t+(i+g)]!==0)return p}return-1},LR=function(e,t,r,i){const s=e.length,o=new Int32Array(s);for(let p=0;p<s;p++)o[p]=e[p]<=i?1:0;for(let p=1;p<r-1;p++)o[p*t]=o[p*t+t-1]=0;for(let p=0;p<t;p++)o[p]=o[t*r-1-p]=0;let a=1,l;const u=[];for(let p=1;p<r-1;p++){l=1;for(let f=1;f<t-1;f++){const g=p*t+f,m=o[g];if(m===0)continue;let C=p,S=f;if(m===1&&o[g-1]===0)a+=1,S-=1;else if(m>=1&&o[g+1]===0)a+=1,S+=1,m>1&&(l=m);else{m!==1&&(l=Math.abs(m));continue}const w=[f,p],b=S===f+1,R={isHole:b,points:w,id:a,parent:0};u.push(R);let P;for(const V of u)if(V.id===l){P=V;break}P?P.isHole?R.parent=b?P.parent:l:R.parent=b?l:P.parent:R.parent=b?l:0;const I=D(this,dt,NL).call(this,o,t,p,f,C,S,0);if(I===-1){o[g]=-a,o[g]!==1&&(l=Math.abs(o[g]));continue}let M=h(this,Qi)[2*I],k=h(this,Qi)[2*I+1];const O=p+M,L=f+k;C=O,S=L;let F=p,H=f;for(;;){const V=D(this,dt,OL).call(this,o,t,F,H,C,S,1);M=h(this,Qi)[2*V],k=h(this,Qi)[2*V+1];const ie=F+M,J=H+k;w.push(J,ie);const ee=F*t+H;if(o[ee+1]===0?o[ee]=-a:o[ee]===1&&(o[ee]=a),ie===p&&J===f&&F===O&&H===L){o[g]!==1&&(l=Math.abs(o[g]));break}else C=F,S=H,F=ie,H=J}}}return u},e0=function(e,t,r,i){if(r-t<=4){for(let O=t;O<r-2;O+=2)i.push(e[O],e[O+1]);return}const s=e[t],o=e[t+1],a=e[r-4]-s,l=e[r-3]-o,u=Math.hypot(a,l),p=a/u,f=l/u,g=p*o-f*s,m=l/a,C=1/u,S=Math.atan(m),w=Math.cos(S),b=Math.sin(S),R=C*(Math.abs(w)+Math.abs(b)),P=C*(1-R+R**2),I=Math.max(Math.atan(Math.abs(b+w)*P),Math.atan(Math.abs(b-w)*P));let M=0,k=t;for(let O=t+2;O<r-2;O+=2){const L=Math.abs(g-p*e[O+1]+f*e[O]);L>M&&(k=O,M=L)}M>(u*I)**2?(D(this,dt,e0).call(this,e,t,k+2,i),D(this,dt,e0).call(this,e,k,r,i)):i.push(s,o)},LL=function(e){const t=[],r=e.length;return D(this,dt,e0).call(this,e,0,r,t),t.push(e[r-2],e[r-1]),t.length<=4?null:t},jL=function(e,t,r,i,s,o){const a=new Float32Array(o**2),l=-2*i**2,u=o>>1;for(let S=0;S<o;S++){const w=(S-u)**2;for(let b=0;b<o;b++)a[S*o+b]=Math.exp((w+(b-u)**2)/l)}const p=new Float32Array(256),f=-2*s**2;for(let S=0;S<256;S++)p[S]=Math.exp(S**2/f);const g=e.length,m=new Uint8Array(g),C=new Uint32Array(256);for(let S=0;S<r;S++)for(let w=0;w<t;w++){const b=S*t+w,R=e[b];let P=0,I=0;for(let k=0;k<o;k++){const O=S+k-u;if(!(O<0||O>=r))for(let L=0;L<o;L++){const F=w+L-u;if(F<0||F>=t)continue;const H=e[O*t+F],V=a[k*o+L]*p[Math.abs(H-R)];P+=H*V,I+=V}}const M=m[b]=Math.round(P/I);C[M]++}return[m,C]},zL=function(e){const t=new Uint32Array(256);for(const r of e)t[r]++;return t},jR=function(e){const t=e.length,r=new Uint8ClampedArray(t>>2);let i=-1/0,s=1/0;for(let a=0,l=r.length;a<l;a++){const u=r[a]=e[a<<2];i=Math.max(i,u),s=Math.min(s,u)}const o=255/(i-s);for(let a=0,l=r.length;a<l;a++)r[a]=(r[a]-s)*o;return r},zR=function(e){let t,r=-1/0,i=-1/0;const s=e.findIndex(l=>l!==0);let o=s,a=s;for(t=s;t<256;t++){const l=e[t];l>r&&(t-o>i&&(i=t-o,a=t-1),r=l,o=t)}for(t=a-1;t>=0&&!(e[t]>e[t+1]);t--);return t},FL=function(e){const t=e,{width:r,height:i}=e,{maxDim:s}=h(this,yu);let o=r,a=i;if(r>s||i>s){let g=r,m=i,C=Math.log2(Math.max(r,i)/s);const S=Math.floor(C);C=C===S?S-1:S;for(let b=0;b<C;b++){o=Math.ceil(g/2),a=Math.ceil(m/2);const R=new OffscreenCanvas(o,a);R.getContext("2d").drawImage(e,0,0,g,m,0,0,o,a),g=o,m=a,e!==t&&e.close(),e=R.transferToImageBitmap()}const w=Math.min(s/o,s/a);o=Math.round(o*w),a=Math.round(a*w)}const u=new OffscreenCanvas(o,a).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,o,a),u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,o,a);const p=u.getImageData(0,0,o,a).data;return[D(this,dt,jR).call(this,p),o,a]},_(qo,dt),_(qo,yu,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),_(qo,Qi,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class mP extends xL{constructor(){super(),super.updateProperties({fill:_t._defaultLineColor,"stroke-width":0})}clone(){const e=new mP;return e.updateAll(this),e}}class yP extends K0{constructor(e){super(e),super.updateProperties({stroke:_t._defaultLineColor,"stroke-width":1})}clone(){const e=new yP(this._viewParameters);return e.updateAll(this),e}}var ac,zs,cc,Su;const Or=class Or extends y0{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});_(this,ac,!1);_(this,zs,null);_(this,cc,null);_(this,Su,null);this._willKeepAspectRatio=!0,T(this,cc,t.signatureData||null),T(this,zs,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,r){_t.initialize(t,r),this._defaultDrawingOptions=new mP,this._defaultDrawnSignatureOptions=new yP(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!1}static get typesMap(){return ze(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!h(this,zs)}}static computeTelemetryFinalData(t){const r=t.get("hasDescription");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,r;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,r=this.y),super.render(),this._drawId===null)if(h(this,cc)){const{lines:s,mustSmooth:o,areContours:a,description:l,uuid:u,heightInPage:p}=h(this,cc),{rawDims:{pageWidth:f,pageHeight:g},rotation:m}=this.parent.viewport,C=qo.processDrawnLines({lines:s,pageWidth:f,pageHeight:g,rotation:m,innerMargin:Or._INNER_MARGIN,mustSmooth:o,areContours:a});this.addSignature(C,p,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:h(this,zs)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,r)),this.div}setUuid(t){T(this,Su,t),this.addEditToolbar()}getUuid(){return h(this,Su)}get description(){return h(this,zs)}set description(t){T(this,zs,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(r=>{r==null||r.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:r,thickness:i,width:s,height:o}=h(this,cc),a=Math.max(s,o),l=qo.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:s,height:o},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:r});return{areContours:r,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,r,i,s){const{x:o,y:a}=this,{outline:l}=T(this,cc,t);T(this,ac,l instanceof NR),this.description=i;let u;h(this,ac)?u=Or.getDefaultDrawingOptions():(u=Or._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[,p]=this.pageDimensions;let f=r/p;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(),this.x=o,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return qo.process(t,r,i,s,Or._INNER_MARGIN)}getFromText(t,r){const{rawDims:{pageWidth:i,pageHeight:s},rotation:o}=this.parent.viewport;return qo.extractContoursFromText(t,r,i,s,o,Or._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return qo.processDrawnLines({lines:t,pageWidth:r,pageHeight:i,rotation:s,innerMargin:Or._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:r}){t?this._drawingOptions=Or.getDefaultDrawingOptions():(this._drawingOptions=Or._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":r}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:r,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:h(this,ac),color:[0,0,0],thickness:h(this,ac)?0:s});return this.addComment(o),t?(o.paths={lines:r,points:i},o.uuid=h(this,Su),o.isCopy=!0):o.lines=r,h(this,zs)&&(o.accessibilityData={type:"Figure",alt:h(this,zs)}),o}static deserializeDraw(t,r,i,s,o,a){return a.areContours?NR.deserialize(t,r,i,s,o,a):eS.deserialize(t,r,i,s,o,a)}static async deserialize(t,r,i){var o;const s=await super.deserialize(t,r,i);return T(s,ac,t.areContours),s.description=((o=t.accessibilityData)==null?void 0:o.alt)||"",T(s,Su,t.uuid),s}};ac=new WeakMap,zs=new WeakMap,cc=new WeakMap,Su=new WeakMap,G(Or,"_type","signature"),G(Or,"_editorType",Be.SIGNATURE),G(Or,"_defaultDrawingOptions",null);let FR=Or;var jt,Pn,lc,Fo,uc,Fh,Bo,Cu,Fs,ei,Bh,ct,Kv,$v,t0,n0,r0,UR,i0,BL;class BR extends _t{constructor(t){super({...t,name:"stampEditor"});_(this,ct);_(this,jt,null);_(this,Pn,null);_(this,lc,null);_(this,Fo,null);_(this,uc,null);_(this,Fh,"");_(this,Bo,null);_(this,Cu,!1);_(this,Fs,null);_(this,ei,!1);_(this,Bh,!1);T(this,Fo,t.bitmapUrl),T(this,uc,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,r){_t.initialize(t,r)}static isHandlingMimeForPasting(t){return RE.includes(t)}static paste(t,r){r.pasteEditor({mode:Be.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const r=t.get("hasAltText");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}async mlGuessAltText(t=null,r=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:s,width:o,height:a,channels:s.length/(o*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),r&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;h(this,Pn)&&(T(this,jt,null),this._uiManager.imageManager.deleteId(h(this,Pn)),(t=h(this,Bo))==null||t.remove(),T(this,Bo,null),h(this,Fs)&&(clearTimeout(h(this,Fs)),T(this,Fs,null))),super.remove()}rebuild(){if(!this.parent){h(this,Pn)&&D(this,ct,t0).call(this);return}super.rebuild(),this.div!==null&&(h(this,Pn)&&h(this,Bo)===null&&D(this,ct,t0).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(h(this,lc)||h(this,jt)||h(this,Fo)||h(this,uc)||h(this,Pn)||h(this,Cu))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,r;return this._isCopy&&(t=this.x,r=this.y),super.render(),this.div.hidden=!0,this.createAltText(),h(this,Cu)||(h(this,jt)?D(this,ct,n0).call(this):D(this,ct,t0).call(this)),this._isCopy&&this._moveAfterPaste(t,r),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,r){const{id:i,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,r);r.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(T(this,Pn,i),s&&T(this,jt,s),T(this,Cu,!1),D(this,ct,n0).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;h(this,Fs)!==null&&clearTimeout(h(this,Fs)),T(this,Fs,setTimeout(()=>{T(this,Fs,null),D(this,ct,UR).call(this)},200))}copyCanvas(t,r,i=!1){t||(t=224);const{width:s,height:o}=h(this,jt),a=new Us;let l=h(this,jt),u=s,p=o,f=null;if(r){if(s>r||o>r){const O=Math.min(r/s,r/o);u=Math.floor(s*O),p=Math.floor(o*O)}f=document.createElement("canvas");const m=f.width=Math.ceil(u*a.sx),C=f.height=Math.ceil(p*a.sy);h(this,ei)||(l=D(this,ct,r0).call(this,m,C));const S=f.getContext("2d");S.filter=this._uiManager.hcmFilter;let w="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":J5.isDarkMode&&(w="#8f8f9d",b="#42414d");const R=15,P=R*a.sx,I=R*a.sy,M=new OffscreenCanvas(P*2,I*2),k=M.getContext("2d");k.fillStyle=w,k.fillRect(0,0,P*2,I*2),k.fillStyle=b,k.fillRect(0,0,P,I),k.fillRect(P,I,P,I),S.fillStyle=S.createPattern(M,"repeat"),S.fillRect(0,0,m,C),S.drawImage(l,0,0,l.width,l.height,0,0,m,C)}let g=null;if(i){let m,C;if(a.symmetric&&l.width<t&&l.height<t)m=l.width,C=l.height;else if(l=h(this,jt),s>t||o>t){const b=Math.min(t/s,t/o);m=Math.floor(s*b),C=Math.floor(o*b),h(this,ei)||(l=D(this,ct,r0).call(this,m,C))}const w=new OffscreenCanvas(m,C).getContext("2d",{willReadFrequently:!0});w.drawImage(l,0,0,l.width,l.height,0,0,m,C),g={width:m,height:C,data:w.getImageData(0,0,m,C).data}}return{canvas:f,width:u,height:p,imageData:g}}static async deserialize(t,r,i){var w;let s=null,o=!1;if(t instanceof nL){const{data:{rect:b,rotation:R,id:P,structParent:I,popupRef:M,richText:k,contentsObj:O,creationDate:L,modificationDate:F},container:H,parent:{page:{pageNumber:V}},canvas:ie}=t;let J,ee;ie?(delete t.canvas,{id:J,bitmap:ee}=i.imageManager.getFromCanvas(H.id,ie),ie.remove()):(o=!0,t._hasNoCanvas=!0);const se=((w=await r._structTree.getAriaAttributes(`${hd}${P}`))==null?void 0:w.get("aria-label"))||"";s=t={annotationType:Be.STAMP,bitmapId:J,bitmap:ee,pageIndex:V-1,rect:b.slice(0),rotation:R,annotationElementId:P,id:P,deleted:!1,accessibilityData:{decorative:!1,altText:se},isSvg:!1,structParent:I,popupRef:M,richText:k,comment:(O==null?void 0:O.str)||null,creationDate:L,modificationDate:F}}const a=await super.deserialize(t,r,i),{rect:l,bitmap:u,bitmapUrl:p,bitmapId:f,isSvg:g,accessibilityData:m}=t;o?(i.addMissingCanvas(t.id,a),T(a,Cu,!0)):f&&i.imageManager.isValidId(f)?(T(a,Pn,f),u&&T(a,jt,u)):T(a,Fo,p),T(a,ei,g);const[C,S]=a.pageDimensions;return a.width=(l[2]-l[0])/C,a.height=(l[3]-l[1])/S,m&&(a.altTextData=m),a._initialData=s,t.comment&&a.setCommentData(t),T(a,Bh,!!s),a}serialize(t=!1,r=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:h(this,Pn),isSvg:h(this,ei)});if(this.addComment(i),t)return i.bitmapUrl=D(this,ct,i0).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const l=D(this,ct,BL).call(this,i);return l.isSame?null:(l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(r===null)return i;r.stamps||(r.stamps=new Map);const a=h(this,ei)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!r.stamps.has(h(this,Pn)))r.stamps.set(h(this,Pn),{area:a,serialized:i}),i.bitmap=D(this,ct,i0).call(this,!1);else if(h(this,ei)){const l=r.stamps.get(h(this,Pn));a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=D(this,ct,i0).call(this,!1))}return i}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}jt=new WeakMap,Pn=new WeakMap,lc=new WeakMap,Fo=new WeakMap,uc=new WeakMap,Fh=new WeakMap,Bo=new WeakMap,Cu=new WeakMap,Fs=new WeakMap,ei=new WeakMap,Bh=new WeakMap,ct=new WeakSet,Kv=function(t,r=!1){if(!t){this.remove();return}T(this,jt,t.bitmap),r||(T(this,Pn,t.id),T(this,ei,t.isSvg)),t.file&&T(this,Fh,t.file.name),D(this,ct,n0).call(this)},$v=function(){if(T(this,lc,null),this._uiManager.enableWaiting(!1),!!h(this,Bo)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&h(this,jt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&h(this,jt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},t0=function(){if(h(this,Pn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(h(this,Pn)).then(i=>D(this,ct,Kv).call(this,i,!0)).finally(()=>D(this,ct,$v).call(this));return}if(h(this,Fo)){const i=h(this,Fo);T(this,Fo,null),this._uiManager.enableWaiting(!0),T(this,lc,this._uiManager.imageManager.getFromUrl(i).then(s=>D(this,ct,Kv).call(this,s)).finally(()=>D(this,ct,$v).call(this)));return}if(h(this,uc)){const i=h(this,uc);T(this,uc,null),this._uiManager.enableWaiting(!0),T(this,lc,this._uiManager.imageManager.getFromFile(i).then(s=>D(this,ct,Kv).call(this,s)).finally(()=>D(this,ct,$v).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=RE.join(",");const r=this._uiManager._signal;T(this,lc,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),D(this,ct,Kv).call(this,s)}i()},{signal:r}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:r})}).finally(()=>D(this,ct,$v).call(this))),t.click()},n0=function(){var u;const{div:t}=this;let{width:r,height:i}=h(this,jt);const[s,o]=this.pageDimensions,a=.75;if(this.width)r=this.width*s,i=this.height*o;else if(r>a*s||i>a*o){const p=Math.min(a*s/r,a*o/i);r*=p,i*=p}this._uiManager.enableWaiting(!1);const l=T(this,Bo,document.createElement("canvas"));l.setAttribute("role","img"),this.addContainer(l),this.width=r/s,this.height=i/o,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),D(this,ct,UR).call(this),h(this,Bh)||(this.parent.addUndoableEditor(this),T(this,Bh,!0)),this._reportTelemetry({action:"inserted_image"}),h(this,Fh)&&this.div.setAttribute("aria-description",h(this,Fh)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},r0=function(t,r){const{width:i,height:s}=h(this,jt);let o=i,a=s,l=h(this,jt);for(;o>2*t||a>2*r;){const u=o,p=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*r&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const f=new OffscreenCanvas(o,a);f.getContext("2d").drawImage(l,0,0,u,p,0,0,o,a),l=f.transferToImageBitmap()}return l},UR=function(){const[t,r]=this.parentDimensions,{width:i,height:s}=this,o=new Us,a=Math.ceil(i*t*o.sx),l=Math.ceil(s*r*o.sy),u=h(this,Bo);if(!u||u.width===a&&u.height===l)return;u.width=a,u.height=l;const p=h(this,ei)?h(this,jt):D(this,ct,r0).call(this,a,l),f=u.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(p,0,0,p.width,p.height,0,0,a,l)},i0=function(t){if(t){if(h(this,ei)){const s=this._uiManager.imageManager.getSvgUrl(h(this,Pn));if(s)return s}const r=document.createElement("canvas");return{width:r.width,height:r.height}=h(this,jt),r.getContext("2d").drawImage(h(this,jt),0,0),r.toDataURL()}if(h(this,ei)){const[r,i]=this.pageDimensions,s=Math.round(this.width*r*mc.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*mc.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(s,o);return a.getContext("2d").drawImage(h(this,jt),0,0,h(this,jt).width,h(this,jt).height,0,0,s,o),a.transferToImageBitmap()}return structuredClone(h(this,jt))},BL=function(t){var a;const{pageIndex:r,accessibilityData:{altText:i}}=this._initialData,s=t.pageIndex===r,o=(((a=t.accessibilityData)==null?void 0:a.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&o,isSameAltText:o}},G(BR,"_type","stamp"),G(BR,"_editorType",Be.STAMP);var bu,Uh,dc,hc,Uo,Er,pc,Hh,Wh,Zi,Ho,Tn,Wo,fc,qh,xe,gc,Rt,WR,UL,ms,qR,VR,s0;const Hi=class Hi{constructor({uiManager:e,pageIndex:t,div:r,structTreeLayer:i,accessibilityManager:s,annotationLayer:o,drawLayer:a,textLayer:l,viewport:u,l10n:p}){_(this,Rt);_(this,bu);_(this,Uh,!1);_(this,dc,null);_(this,hc,null);_(this,Uo,null);_(this,Er,new Map);_(this,pc,!1);_(this,Hh,!1);_(this,Wh,!1);_(this,Zi,null);_(this,Ho,null);_(this,Tn,null);_(this,Wo,null);_(this,fc,null);_(this,qh,-1);_(this,xe);const f=[...h(Hi,gc).values()];if(!Hi._initialized){Hi._initialized=!0;for(const g of f)g.initialize(p,e)}e.registerEditorTypes(f),T(this,xe,e),this.pageIndex=t,this.div=r,T(this,bu,s),T(this,dc,o),this.viewport=u,T(this,Tn,l),this.drawLayer=a,this._structTree=i,h(this,xe).addLayer(this)}get isEmpty(){return h(this,Er).size===0}get isInvisible(){return this.isEmpty&&h(this,xe).getMode()===Be.NONE}updateToolbar(e){h(this,xe).updateToolbar(e)}updateMode(e=h(this,xe).getMode()){switch(D(this,Rt,s0).call(this),e){case Be.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Be.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Be.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Be.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const r of h(Hi,gc).values())t.toggle(`${r._type}Editing`,e===r._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=h(this,Tn))==null?void 0:t.div)}setEditingState(e){h(this,xe).setEditingState(e)}addCommands(e){h(this,xe).addCommands(e)}cleanUndoStack(e){h(this,xe).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=h(this,dc))==null||t.togglePointerEvents(e)}async enable(){var r;T(this,Wh,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(r=h(this,fc))==null||r.abort(),T(this,fc,null);const e=new Set;for(const i of h(this,Rt,WR))i.enableEditing(),i.show(!0),i.annotationElementId&&(h(this,xe).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const t=h(this,dc);if(t)for(const i of t.getEditableAnnotations()){if(i.hide(),h(this,xe).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}T(this,Wh,!1),h(this,xe)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var i;if(T(this,Hh,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),h(this,Tn)&&!h(this,fc)){T(this,fc,new AbortController);const s=h(this,xe).combinedSignal(h(this,fc));h(this,Tn).div.addEventListener("pointerdown",o=>{const{clientX:l,clientY:u,timeStamp:p}=o,f=h(this,qh);if(p-f>500){T(this,qh,p);return}T(this,qh,-1);const{classList:g}=this.div;g.toggle("getElements",!0);const m=document.elementsFromPoint(l,u);if(g.toggle("getElements",!1),!this.div.contains(m[0]))return;let C;const S=new RegExp(`^${Jv}[0-9]+$`);for(const b of m)if(S.test(b.id)){C=b.id;break}if(!C)return;const w=h(this,Er).get(C);(w==null?void 0:w.annotationElementId)===null&&(o.stopPropagation(),o.preventDefault(),w.dblclick(o))},{signal:s,capture:!0})}const e=h(this,dc),t=[];if(e){const s=new Map,o=new Map;for(const l of h(this,Rt,WR)){if(l.disableEditing(),!l.annotationElementId){t.push(l);continue}if(l.serialize()!==null){s.set(l.annotationElementId,l);continue}else o.set(l.annotationElementId,l);(i=this.getEditableAnnotation(l.annotationElementId))==null||i.show(),l.remove()}const a=e.getEditableAnnotations();for(const l of a){const{id:u}=l.data;if(h(this,xe).isDeletedAnnotationElement(u)){l.updateEdited({deleted:!0});continue}let p=o.get(u);if(p){p.resetAnnotationElement(l),p.show(!1),l.show();continue}p=s.get(u),p&&(h(this,xe).addChangedExistingAnnotation(p),p.renderAnnotationElement(l)&&p.show(!1)),l.show()}}D(this,Rt,s0).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const s of h(Hi,gc).values())r.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),T(this,Hh,!1)}getEditableAnnotation(e){var t;return((t=h(this,dc))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){h(this,xe).getActive()!==e&&h(this,xe).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=h(this,Tn))!=null&&e.div&&!h(this,Wo)){T(this,Wo,new AbortController);const t=h(this,xe).combinedSignal(h(this,Wo));h(this,Tn).div.addEventListener("pointerdown",D(this,Rt,UL).bind(this),{signal:t}),h(this,Tn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=h(this,Tn))!=null&&e.div&&h(this,Wo)&&(h(this,Wo).abort(),T(this,Wo,null),h(this,Tn).div.classList.remove("highlighting"))}enableClick(){if(h(this,hc))return;T(this,hc,new AbortController);const e=h(this,xe).combinedSignal(h(this,hc));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=h(this,hc))==null||e.abort(),T(this,hc,null)}attach(e){h(this,Er).set(e.id,e);const{annotationElementId:t}=e;t&&h(this,xe).isDeletedAnnotationElement(t)&&h(this,xe).removeDeletedAnnotationElement(e)}detach(e){var t;h(this,Er).delete(e.id),(t=h(this,bu))==null||t.removePointerInTextLayer(e.contentDiv),!h(this,Hh)&&e.annotationElementId&&h(this,xe).addDeletedAnnotationElement(e)}remove(e){this.detach(e),h(this,xe).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(h(this,xe).addDeletedAnnotationElement(e),_t.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),h(this,xe).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!h(this,Wh)),h(this,xe).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var r;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!h(this,Uo)&&(e._focusEventsAllowed=!1,T(this,Uo,setTimeout(()=>{T(this,Uo,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:h(this,xe)._signal}),t.focus())},0))),e._structTreeParentId=(r=h(this,bu))==null?void 0:r.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),r=()=>{e.remove()};this.addCommands({cmd:t,undo:r,mustExec:!1})}getEditorByUID(e){for(const t of h(this,Er).values())if(t.uid===e)return t;return null}getNextId(){return h(this,xe).getId()}combinedSignal(e){return h(this,xe).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=h(this,Rt,ms))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await h(this,xe).updateMode(e.mode);const{offsetX:r,offsetY:i}=D(this,Rt,VR).call(this),s=this.getNextId(),o=D(this,Rt,qR).call(this,{parent:this,id:s,x:r,y:i,uiManager:h(this,xe),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=h(Hi,gc).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,h(this,xe)))||null}createAndAddNewEditor(e,t,r={}){const i=this.getNextId(),s=D(this,Rt,qR).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:h(this,xe),isCentered:t,...r});return s&&this.add(s),s}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(D(this,Rt,VR).call(this),!0,e)}setSelected(e){h(this,xe).setSelected(e)}toggleSelected(e){h(this,xe).toggleSelected(e)}unselect(e){h(this,xe).unselect(e)}pointerup(e){var i;const{isMac:t}=mn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!h(this,pc)||(T(this,pc,!1),(i=h(this,Rt,ms))!=null&&i.isDrawer&&h(this,Rt,ms).supportMultipleDrawings))return;if(!h(this,Uh)){T(this,Uh,!0);return}const r=h(this,xe).getMode();if(r===Be.STAMP||r===Be.SIGNATURE){h(this,xe).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(h(this,xe).getMode()===Be.HIGHLIGHT&&this.enableTextSelection(),h(this,pc)){T(this,pc,!1);return}const{isMac:t}=mn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(T(this,pc,!0),(i=h(this,Rt,ms))!=null&&i.isDrawer){this.startDrawingSession(e);return}const r=h(this,xe).getActive();T(this,Uh,!r||r.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),h(this,Zi)){h(this,Rt,ms).startDrawing(this,h(this,xe),!1,e);return}h(this,xe).setCurrentDrawingSession(this),T(this,Zi,new AbortController);const t=h(this,xe).combinedSignal(h(this,Zi));this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(T(this,Ho,null),this.commitOrRemove())},{signal:t}),h(this,Rt,ms).startDrawing(this,h(this,xe),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&T(this,Ho,t);return}h(this,Ho)&&setTimeout(()=>{var t;(t=h(this,Ho))==null||t.focus(),T(this,Ho,null)},0)}endDrawingSession(e=!1){return h(this,Zi)?(h(this,xe).setCurrentDrawingSession(null),h(this,Zi).abort(),T(this,Zi,null),T(this,Ho,null),h(this,Rt,ms).endDrawing(e)):null}findNewParent(e,t,r){const i=h(this,xe).findParent(t,r);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return h(this,Zi)?(this.endDrawingSession(),!0):!1}onScaleChanging(){h(this,Zi)&&h(this,Rt,ms).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=h(this,xe).getActive())==null?void 0:e.parent)===this&&(h(this,xe).commitOrRemove(),h(this,xe).setActiveEditor(null)),h(this,Uo)&&(clearTimeout(h(this,Uo)),T(this,Uo,null));for(const r of h(this,Er).values())(t=h(this,bu))==null||t.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,h(this,Er).clear(),h(this,xe).removeLayer(this)}render({viewport:e}){this.viewport=e,Au(this.div,e);for(const t of h(this,xe).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){h(this,xe).commitOrRemove(),D(this,Rt,s0).call(this);const t=this.viewport.rotation,r=e.rotation;if(this.viewport=e,Au(this.div,{rotation:r}),t!==r)for(const i of h(this,Er).values())i.rotate(r)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return h(this,xe).viewParameters.realScale}};bu=new WeakMap,Uh=new WeakMap,dc=new WeakMap,hc=new WeakMap,Uo=new WeakMap,Er=new WeakMap,pc=new WeakMap,Hh=new WeakMap,Wh=new WeakMap,Zi=new WeakMap,Ho=new WeakMap,Tn=new WeakMap,Wo=new WeakMap,fc=new WeakMap,qh=new WeakMap,xe=new WeakMap,gc=new WeakMap,Rt=new WeakSet,WR=function(){return h(this,Er).size!==0?h(this,Er).values():h(this,xe).getEditors(this.pageIndex)},UL=function(e){h(this,xe).unselectAll();const{target:t}=e;if(t===h(this,Tn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&h(this,Tn).div.contains(t)){const{isMac:r}=mn.platform;if(e.button!==0||e.ctrlKey&&r)return;h(this,xe).showAllEditors("highlight",!0,!0),h(this,Tn).div.classList.add("free"),this.toggleDrawing(),m0.startHighlighting(this,h(this,xe).direction==="ltr",{target:h(this,Tn).div,x:e.x,y:e.y}),h(this,Tn).div.addEventListener("pointerup",()=>{h(this,Tn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:h(this,xe)._signal}),e.preventDefault()}},ms=function(){return h(Hi,gc).get(h(this,xe).getMode())},qR=function(e){const t=h(this,Rt,ms);return t?new t.prototype.constructor(e):null},VR=function(){const{x:e,y:t,width:r,height:i}=this.boundingClientRect,s=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+r),l=Math.min(window.innerHeight,t+i),u=(s+a)/2-e,p=(o+l)/2-t,[f,g]=this.viewport.rotation%180===0?[u,p]:[p,u];return{offsetX:f,offsetY:g}},s0=function(){for(const e of h(this,Er).values())e.isEmpty()&&e.remove()},G(Hi,"_initialized",!1),_(Hi,gc,new Map([AR,DR,BR,m0,FR].map(e=>[e._editorType,e])));let HR=Hi;var es,or,wu,qy,z0,HL,Hs,KR,WL,$R;const pn=class pn{constructor({pageIndex:e}){_(this,Hs);_(this,es,null);_(this,or,new Map);_(this,wu,new Map);this.pageIndex=e}setParent(e){if(!h(this,es)){T(this,es,e);return}if(h(this,es)!==e){if(h(this,or).size>0)for(const t of h(this,or).values())t.remove(),e.append(t);T(this,es,e)}}static get _svgFactory(){return ze(this,"_svgFactory",new g0)}draw(e,t=!1,r=!1){const i=dn(pn,qy)._++,s=D(this,Hs,KR).call(this),o=pn._svgFactory.createElement("defs");s.append(o);const a=pn._svgFactory.createElement("path");o.append(a);const l=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t&&h(this,wu).set(i,a);const u=r?D(this,Hs,WL).call(this,o,l):null,p=pn._svgFactory.createElement("use");return s.append(p),p.setAttribute("href",`#${l}`),this.updateProperties(s,e),h(this,or).set(i,s),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const r=dn(pn,qy)._++,i=D(this,Hs,KR).call(this),s=pn._svgFactory.createElement("defs");i.append(s);const o=pn._svgFactory.createElement("path");s.append(o);const a=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const f=pn._svgFactory.createElement("mask");s.append(f),l=`mask_p${this.pageIndex}_${r}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const g=pn._svgFactory.createElement("rect");f.append(g),g.setAttribute("width","1"),g.setAttribute("height","1"),g.setAttribute("fill","white");const m=pn._svgFactory.createElement("use");f.append(m),m.setAttribute("href",`#${a}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const u=pn._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${a}`),l&&u.setAttribute("mask",`url(#${l})`);const p=u.cloneNode();return i.append(p),u.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(i,e),h(this,or).set(r,i),r}finalizeDraw(e,t){h(this,wu).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:r,bbox:i,rootClass:s,path:o}=t,a=typeof e=="number"?h(this,or).get(e):e;if(a){if(r&&D(this,Hs,$R).call(this,a,r),i&&D(l=pn,z0,HL).call(l,a,i),s){const{classList:u}=a;for(const[p,f]of Object.entries(s))u.toggle(p,f)}if(o){const p=a.firstElementChild.firstElementChild;D(this,Hs,$R).call(this,p,o)}}}updateParent(e,t){if(t===this)return;const r=h(this,or).get(e);r&&(h(t,es).append(r),h(this,or).delete(e),h(t,or).set(e,r))}remove(e){h(this,wu).delete(e),h(this,es)!==null&&(h(this,or).get(e).remove(),h(this,or).delete(e))}destroy(){T(this,es,null);for(const e of h(this,or).values())e.remove();h(this,or).clear(),h(this,wu).clear()}};es=new WeakMap,or=new WeakMap,wu=new WeakMap,qy=new WeakMap,z0=new WeakSet,HL=function(e,[t,r,i,s]){const{style:o}=e;o.top=`${100*r}%`,o.left=`${100*t}%`,o.width=`${100*i}%`,o.height=`${100*s}%`},Hs=new WeakSet,KR=function(){const e=pn._svgFactory.create(1,1,!0);return h(this,es).append(e),e.setAttribute("aria-hidden",!0),e},WL=function(e,t){const r=pn._svgFactory.createElement("clipPath");e.append(r);const i=`clip_${t}`;r.setAttribute("id",i),r.setAttribute("clipPathUnits","objectBoundingBox");const s=pn._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),i},$R=function(e,t){for(const[r,i]of Object.entries(t))i===null?e.removeAttribute(r):e.setAttribute(r,i)},_(pn,z0),_(pn,qy,0);let GR=pn;globalThis._pdfjsTestingUtils={HighlightOutliner:RR};globalThis.pdfjsLib={AbortException:vc,AnnotationEditorLayer:HR,AnnotationEditorParamsType:nt,AnnotationEditorType:Be,AnnotationEditorUIManager:Eu,AnnotationLayer:bR,AnnotationMode:Ra,AnnotationType:on,applyOpacity:Y5,build:sU,ColorPicker:p0,createValidAbsoluteUrl:DO,CSSConstants:X5,DOMSVGFactory:g0,DrawLayer:GR,FeatureTest:mn,fetchData:Jy,findContrastColor:Q5,getDocument:U2,getFilenameFromUrl:q5,getPdfFilenameFromUrl:V5,getRGB:Yy,getUuid:LO,getXfaPageViewport:K5,GlobalWorkerOptions:Bs,ImageKind:PC,InvalidPDFException:AE,isDataScheme:V0,isPdfFile:dP,isValidExplicitDest:l6,MathClamp:cr,noContextMenu:_i,normalizeUnicode:U5,OPS:Xv,OutputScale:Us,PasswordResponses:M5,PDFDataRangeTransport:H2,PDFDateString:a0,PDFWorker:Zv,PermissionFlag:k5,PixelsPerInch:mc,RenderingCancelledException:uP,renderRichText:FO,ResponseException:o0,setLayerDimensions:Au,shadow:ze,SignatureExtractor:qo,stopEvent:Qt,SupportedImageMimeTypes:RE,TextLayer:Qv,TouchManager:l0,updateUrlHash:NO,Util:be,VerbosityLevel:H0,version:iU,XfaLayer:zO};function IU(n){return new Worker("/AzureVoicePlayground/assets/pdf.worker-C5jlnIh9.js",{name:n==null?void 0:n.name})}Bs.workerPort=new IU;function _U(n){const e=n.toLowerCase();return e.endsWith(".pdf")||e.includes(".pdf?")}async function kU(n){try{const e=await U2({data:n}).promise;let t="";const r=Math.min(e.numPages,20);console.log("PDF has",e.numPages,"pages, extracting up to",r);for(let i=1;i<=r;i++){const a=(await(await e.getPage(i)).getTextContent()).items.map(l=>l.str).join(" ");t+=a+`
`}return t.replace(/\s+/g," ").trim().substring(0,1e5)}catch(e){throw new Error(`Failed to extract PDF content: ${e instanceof Error?e.message:"Unknown error"}`)}}function MU(n){var s;const t=new DOMParser().parseFromString(n,"text/html");return t.querySelectorAll("script, style, nav, header, footer, aside").forEach(o=>o.remove()),(((s=t.body)==null?void 0:s.textContent)||"").replace(/\s+/g," ").trim().substring(0,1e5)}async function DU(n){let e;try{const t=await fetch(n);if(!t.ok)throw new Error(`Failed to fetch URL: ${t.status}`);const r=t.headers.get("content-type")||"",i=_U(n)||r.includes("application/pdf");if(console.log("=== URL FETCH INFO ==="),console.log("URL:",n),console.log("Content-Type:",r),console.log("Is PDF:",i),i){const s=await t.arrayBuffer();e=await kU(s)}else{const s=await t.text();e=MU(s)}}catch(t){throw new Error(`Failed to fetch URL content: ${t instanceof Error?t.message:"Unknown error"}`)}return console.log("Content length:",e.length,"characters"),console.log("--- Content Preview (first 2000 chars) ---"),console.log(e.substring(0,2e3)),console.log("--- End Preview ---"),e.length>2e3&&console.log("... [truncated, total",e.length,"characters]"),console.log("================================="),e}async function NU(n,e){var S,w,b;const t=await DU(e.url);if(!t||t.length<50)throw new Error("Could not extract enough content from the URL");const r=e.speakers.join(", "),i=e.language||"English",s=e.speakers[0]||"speaker1",o=e.speakers[1]||"speaker2",a=i==="Chinese"?'"", "", "", "", "", "", ""':i==="Japanese"?'"", "", "", "", ""':i==="Korean"?'"", "", "", "", ""':'"yeah", "right", "oh", "mm-hmm", "I see", "exactly", "uh-huh"',l=`You are a podcast script writer. Your task is to create an engaging, natural-sounding podcast dialogue script based on the provided content.

Rules:
1. Write in ${i}
2. Use exactly these speaker names: ${r}
3. Format each line as "speakername: dialog text" (lowercase speaker name, colon, then the text)

Script style guidelines:
- Start with a friendly greeting and introduction to the topic
- Break down the content into conversational exchanges
- ${s} (first speaker) typically leads, asks questions, and drives the conversation
- ${o} (second speaker) provides answers, explanations, and insights
- **Use backchanneling as separate lines** to show active listening and engagement:
  - Use expressions like: ${a}
  - Insert these as **separate lines** by the listener during longer explanations
  - Example format:
    ${s}: So the framework has three main components...
    ${o}: 
    ${s}: First, they use something called LoRA...
    ${o}: 
- Add 3-5 backchanneling turns throughout the conversation to create natural interaction
- End with key takeaways and a friendly goodbye
- Make it sound natural and engaging, like a real podcast conversation
- Keep the script between 15-30 lines total
- Do not include any stage directions, actions, or parenthetical notes - only dialog text`,u=`Create a podcast script discussing the following content:

${t}

Remember:
- Use speakers: ${r}
- Format: speakername: dialog text
- Include 3-5 backchanneling responses (short acknowledgments like ${a}) as separate lines
- Make it conversational and engaging`,p=[{role:"system",content:l},{role:"user",content:u}],f=`${n.endpoint}/openai/deployments/${n.deploymentName}/chat/completions?api-version=2024-02-15-preview`,g=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json","api-key":n.apiKey},body:JSON.stringify({messages:p,max_tokens:2e3,temperature:.7})});if(!g.ok){const R=await g.text();throw new Error(`Azure OpenAI API error: ${g.status} - ${R}`)}const C=(b=(w=(S=(await g.json()).choices)==null?void 0:S[0])==null?void 0:w.message)==null?void 0:b.content;if(!C)throw new Error("No script generated from Azure OpenAI");return C.trim()}const OU=`speaker1: Welcome to Tech Talk! I'm your host, and today we're diving into artificial intelligence.
speaker2: Thanks for having me! AI is such a fascinating topic these days.
speaker1: Absolutely! Can you explain what makes modern AI so powerful?
speaker2: Of course! The key is deep learning, which allows computers to learn patterns from massive amounts of data.
speaker1: That sounds incredible. What are some practical applications?
speaker2: We see AI everywhere now - voice assistants, recommendation systems, autonomous vehicles, and more.`;function LU({settings:n,onSettingsChange:e,isConfigured:t,history:r,addToHistory:i,removeFromHistory:s,clearHistory:o}){const[a,l]=W.useState(OU),[u,p]=W.useState(null),[f,g]=W.useState(!1),[m,C]=W.useState(!1),[S,w]=W.useState("en-US"),[b,R]=W.useState(null),P=W.useRef(null),I=W.useRef(null),[M,k]=W.useState(()=>localStorage.getItem("podcast_url")||""),[O,L]=W.useState(!1),[F,H]=W.useState(""),[V,ie]=W.useState(!1),[J,ee]=W.useState(()=>localStorage.getItem("aoai_endpoint")||""),[se,ne]=W.useState(()=>localStorage.getItem("aoai_apikey")||""),[Q,K]=W.useState(()=>localStorage.getItem("aoai_deployment")||"gpt-5");W.useEffect(()=>{localStorage.setItem("podcast_url",M)},[M]);const{state:oe,error:B,audioData:j,synthesize:$,pause:pe,resume:ge,stop:ye}=x5({apiKey:n.apiKey,region:n.region}),re=he=>{if(w(he),he&&u){const $e=tE.find(Ge=>Ge.locale===he);if($e){const Ge=cD($e,u.speakers);l(Ge)}}};W.useEffect(()=>{if(u&&S){const he=tE.find($e=>$e.locale===S);if(he){const $e=cD(he,u.speakers);l($e)}}},[u,S]),W.useEffect(()=>{j&&j!==P.current&&u&&(P.current=j,lP(j).then(he=>{i({timestamp:Date.now(),text:a,voice:u.displayName,region:n.region,audioData:j,duration:he})}).catch(he=>{console.error("Failed to get audio duration:",he);const $e=j.byteLength*8/48e3;i({timestamp:Date.now(),text:a,voice:u.displayName,region:n.region,audioData:j,duration:$e})}))},[j,a,u,n.region,i]);const te=()=>{u&&$(a,u.name,u.locale,u.speakers)},ae=()=>{localStorage.setItem("aoai_endpoint",J),localStorage.setItem("aoai_apikey",se),localStorage.setItem("aoai_deployment",Q),ie(!1)},ve=async()=>{if(!M.trim()){H("Please enter a URL");return}if(!J||!se){H("Please configure Azure OpenAI settings first"),ie(!0);return}if(!u){H("Please select a voice first");return}L(!0),H("");try{const he={endpoint:J,apiKey:se,deploymentName:Q},Ge=(S||u.locale||"en-US").split("-")[0].toLowerCase(),st={zh:"Chinese",ja:"Japanese",ko:"Korean",de:"German",fr:"French",es:"Spanish",pt:"Portuguese",it:"Italian",en:"English"}[Ge]||"English",xn=await NU(he,{url:M,speakers:u.speakers,language:st});l(xn),w("")}catch(he){H(he instanceof Error?he.message:"Failed to generate script")}finally{L(!1)}},_e=he=>{const $e=new Blob([he.audioData],{type:"audio/mpeg"}),Ge=URL.createObjectURL($e),Ve=document.createElement("a");Ve.href=Ge,Ve.download=`multitalker-${he.voice}-${Date.now()}.mp3`,document.body.appendChild(Ve),Ve.click(),document.body.removeChild(Ve),URL.revokeObjectURL(Ge)},Ce=he=>{if(b===he.id&&I.current){I.current.pause(),I.current=null,R(null);return}I.current&&(I.current.pause(),I.current=null);const $e=new Blob([he.audioData],{type:"audio/mpeg"}),Ge=URL.createObjectURL($e),Ve=new Audio(Ge);I.current=Ve,R(he.id),Ve.play(),Ve.onended=()=>{URL.revokeObjectURL(Ge),R(null),I.current=null},Ve.onerror=()=>{URL.revokeObjectURL(Ge),R(null),I.current=null}},Ke=oe;return A.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[A.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[A.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 shadow-md",children:[A.jsx("h1",{className:"text-3xl font-bold",children:"Podcast Generator"}),A.jsx("p",{className:"text-purple-100 mt-1",children:"Create multi-speaker dialog content with AI-powered voices"})]}),A.jsxs("div",{className:"flex-1 flex flex-col gap-4 p-6 overflow-y-auto",children:[A.jsxs("div",{className:"border border-purple-200 rounded-lg p-4 bg-purple-50",children:[A.jsxs("div",{className:"flex items-center justify-between mb-2",children:[A.jsx("label",{className:"text-sm font-medium text-purple-700",children:"Generate Script from URL"}),A.jsxs("button",{onClick:()=>ie(!V),className:"text-xs text-purple-600 hover:text-purple-800 underline",children:[V?"Hide":"Configure"," Azure OpenAI"]})]}),V&&A.jsxs("div",{className:"mb-3 p-3 bg-white border border-purple-200 rounded-md space-y-2",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Endpoint"}),A.jsx("input",{type:"text",value:J,onChange:he=>ee(he.target.value),placeholder:"https://your-resource.openai.azure.com",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-purple-500"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"API Key"}),A.jsx("input",{type:"password",value:se,onChange:he=>ne(he.target.value),placeholder:"Enter API key",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-purple-500"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Deployment Name"}),A.jsx("input",{type:"text",value:Q,onChange:he=>K(he.target.value),placeholder:"gpt-5",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-purple-500"})]}),A.jsx("button",{onClick:ae,className:"px-3 py-1 text-xs font-medium text-white bg-purple-600 rounded hover:bg-purple-700",children:"Save Config"})]}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx("input",{type:"url",value:M,onChange:he=>k(he.target.value),placeholder:"Enter URL to generate podcast script from...",className:"flex-1 px-3 py-2 border border-purple-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",disabled:O}),A.jsx("button",{onClick:ve,disabled:O||!M.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:O?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Generating..."]}):"Generate Script"})]}),F&&A.jsx("p",{className:"mt-2 text-xs text-red-600",children:F})]}),A.jsxs("div",{className:"flex items-center gap-4",children:[A.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Podcast Script Preset:"}),A.jsxs("select",{value:S,onChange:he=>re(he.target.value),className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",disabled:oe==="synthesizing"||oe==="playing",children:[A.jsx("option",{value:"",children:"-- Select a preset --"}),tE.map(he=>A.jsx("option",{value:he.locale,children:he.language},he.locale))]}),S&&A.jsx("button",{onClick:()=>{w("")},className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear"})]}),A.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[A.jsxs("div",{className:"flex items-center justify-between mb-2",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700",children:f?"SSML Preview":"Dialog Text"}),u&&!f&&A.jsxs("div",{className:"text-xs text-gray-500",children:["Format: ",A.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"speaker: text"})," | Speakers: ",u.speakers.map((he,$e)=>A.jsx("code",{className:"bg-purple-100 text-purple-700 px-1 rounded mx-0.5",children:he},he))]})]}),A.jsx("textarea",{value:f&&u?MO(a,u.name,u.locale,u.speakers):a,onChange:he=>!f&&l(he.target.value),placeholder:`Enter dialog text with speaker prefixes:
speaker1: Hello!
speaker2: Hi there!`,className:`flex-1 w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm resize-none ${f?"bg-gray-900 text-green-400":""}`,disabled:oe==="synthesizing"||oe==="playing",readOnly:f}),A.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[A.jsxs("div",{className:"text-xs text-gray-500",children:[a.split(`
`).filter(he=>he.trim()).length," lines | ",a.length," characters"]}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx("button",{onClick:()=>g(!f),disabled:!u||!a,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Show Plain Text":"Show SSML"}),A.jsx("button",{onClick:()=>l(""),disabled:!a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Clear Text"})]})]})]}),A.jsx("div",{className:"border-t border-gray-200 pt-4",children:A.jsx(TO,{state:Ke,error:B,audioData:j,hasText:a.trim().length>0,isConfigured:t&&u!==null,onPlay:te,onPause:pe,onResume:ge,onStop:ye})})]}),A.jsxs("div",{className:"border-t border-gray-200 bg-gray-50",children:[A.jsxs("div",{className:"flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-gray-100",onClick:()=>C(!m),children:[A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Synthesis History"}),r.length>0&&A.jsx("span",{className:"px-2 py-1 text-xs font-medium text-white bg-purple-600 rounded-full",children:r.length})]}),A.jsxs("div",{className:"flex items-center gap-2",children:[r.length>0&&A.jsx("button",{onClick:he=>{he.stopPropagation(),window.confirm("Clear all history?")&&o()},className:"px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors",children:"Clear All"}),A.jsx("svg",{className:`w-5 h-5 text-gray-600 transform transition-transform ${m?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]}),m&&A.jsx("div",{className:"max-h-64 overflow-y-auto",children:r.length===0?A.jsx("div",{className:"px-4 py-8 text-center text-gray-500 text-sm",children:"No synthesis history yet"}):A.jsx("div",{className:"divide-y divide-gray-200",children:r.map(he=>A.jsxs("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-100",children:[A.jsxs("div",{className:"flex-1 min-w-0",children:[A.jsx("div",{className:"text-sm font-medium text-gray-800 truncate",children:he.voice}),A.jsxs("div",{className:"text-xs text-gray-500",children:[new Date(he.timestamp).toLocaleTimeString()," |"," ",he.duration.toFixed(1),"s |"," ",he.text.substring(0,50),"..."]})]}),A.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[A.jsx("button",{onClick:()=>Ce(he),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md transition-colors",title:b===he.id?"Pause":"Play",children:b===he.id?A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),A.jsx("button",{onClick:()=>_e(he),className:"p-2 text-gray-600 hover:bg-gray-200 rounded-full",title:"Download",children:A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})}),A.jsx("button",{onClick:()=>s(he.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-full",title:"Delete",children:A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:A.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]},he.id))})})]}),A.jsxs("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3 flex items-center justify-between",children:[A.jsx("p",{className:"text-xs text-gray-600",children:"Podcast Generator uses Azure Speech Service with mstts:dialog SSML elements."}),A.jsx(xO,{text:a,selectedVoice:(u==null?void 0:u.displayName)||"",region:n.region,audioData:j})]})]}),A.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-hidden",children:[A.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Voice Selection"}),A.jsx("div",{className:"flex-1 min-h-0",children:A.jsx(I5,{apiKey:n.apiKey,region:n.region,selectedVoice:u,onVoiceChange:p})})]})]})}const LD=[{tier:"pro",id:"gpt-realtime"},{tier:"pro",id:"gpt-4o"},{tier:"pro",id:"gpt-4.1"},{tier:"pro",id:"gpt-5"},{tier:"pro",id:"gpt-5-chat"},{tier:"basic",id:"gpt-realtime-mini"},{tier:"basic",id:"gpt-4o-mini"},{tier:"basic",id:"gpt-4.1-mini"},{tier:"basic",id:"gpt-5-mini"},{tier:"lite",id:"gpt-5-nano"},{tier:"lite",id:"phi4-mm-realtime"},{tier:"lite",id:"phi4-mini"}],jU=[{code:"en",label:"English"},{code:"zh",label:""},{code:"ja",label:""},{code:"ko",label:""},{code:"fr",label:"Franais"},{code:"de",label:"Deutsch"},{code:"es",label:"Espaol"},{code:"it",label:"Italiano"},{code:"pt",label:"Portugus"},{code:"ru",label:""},{code:"ar",label:""},{code:"hi",label:""},{code:"id",label:"Bahasa Indonesia"},{code:"vi",label:"Ting Vit"},{code:"th",label:""},{code:"tr",label:"Trke"},{code:"nl",label:"Nederlands"},{code:"sv",label:"Svenska"},{code:"no",label:"Norsk"},{code:"da",label:"Dansk"},{code:"fi",label:"Suomi"},{code:"pl",label:"Polski"},{code:"cs",label:"etina"},{code:"hu",label:"Magyar"},{code:"ro",label:"Romn"},{code:"el",label:""},{code:"he",label:""}],dE={endpoint:"",apiKey:"",model:"gpt-4.1-mini",targetLanguage:"en",asrModel:"azure-speech",asrLanguages:"",voiceProvider:"azure-standard",voiceName:"en-US-AvaMultilingualNeural",prompt:"",turnDetectionType:"azure_semantic_vad",threshold:.5,prefixPaddingInMs:300,silenceDurationInMs:200,speechDurationInMs:80,removeFillerWords:!1,eouModel:"semantic_detection_v1",eouThresholdLevel:"default",eouTimeoutInMs:1e3};function nd(n){return["You are a simultaneous interpreter.",`Target language: ${n}.`,"","Rules:","1) Translate sentence by sentence (output each sentence as it completes).","2) Keep context consistent across turns (pronouns, terms, tone, references).","3) Preserve meaning faithfully; do not add explanations or extra content.","4) Keep proper nouns, numbers, and code as-is unless a standard translation is obvious.","5) Output translation text only."].join(`
`)}function jD(n){const t=(n.asrModel==="azure-speech"?"azure_semantic_vad":n.turnDetectionType)==="server_vad"?{type:"server_vad",threshold:n.threshold,prefixPaddingInMs:n.prefixPaddingInMs,silenceDurationInMs:n.silenceDurationInMs,createResponse:!0,interruptResponse:!1}:{type:"azure_semantic_vad",threshold:n.threshold,prefixPaddingInMs:n.prefixPaddingInMs,silenceDurationInMs:n.silenceDurationInMs,speechDurationInMs:n.speechDurationInMs,removeFillerWords:n.removeFillerWords,endOfUtteranceDetection:{model:n.eouModel,thresholdLevel:n.eouThresholdLevel,timeoutInMs:n.eouTimeoutInMs},createResponse:!0,interruptResponse:!1},r=n.asrLanguages.split(",").map(i=>i.trim()).filter(Boolean).join(",");return{model:n.model,modalities:["audio","text"],instructions:n.prompt,inputAudioFormat:"pcm16",inputAudioSamplingRate:16e3,outputAudioFormat:"pcm16",turnDetection:t,inputAudioTranscription:n.asrModel==="azure-speech"?{model:"azure-speech",language:r||void 0}:{model:n.asrModel},voice:n.voiceProvider==="openai"?{type:"openai",name:n.voiceName}:{type:"azure-standard",name:n.voiceName}}}function zD(n){if(!n)return 24e3;const e=n.toLowerCase();return e==="pcm16"?24e3:e==="pcm16-16000hz"?16e3:e==="pcm16-8000hz"?8e3:24e3}function zU(n){const e=new Int16Array(n.length);for(let t=0;t<n.length;t++){const r=Math.max(-1,Math.min(1,n[t]??0));e[t]=r<0?r*32768:r*32767}return e}function FU(n){return new Uint8Array(n.buffer)}function BU(n){const e=new DataView(n.buffer,n.byteOffset,n.byteLength),t=Math.floor(n.byteLength/2),r=new Float32Array(t);for(let i=0;i<t;i++){const s=e.getInt16(i*2,!0);r[i]=s/32768}return r}class UU{constructor(e,t){G(this,"mediaStream");G(this,"audioContext");G(this,"processor");G(this,"source");G(this,"config");G(this,"callbacks");this.config=e,this.callbacks=t}async start(){this.callbacks.onState("starting");try{this.mediaStream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=new AudioContext({sampleRate:this.config.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.mediaStream),this.processor=this.audioContext.createScriptProcessor(this.config.bufferSize,1,1),this.processor.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0),r=zU(t),i=FU(r),s=r.length/this.config.sampleRate;this.callbacks.onChunk(i,s)},this.source.connect(this.processor),this.processor.connect(this.audioContext.destination),this.callbacks.onState("started")}catch(e){const t=e instanceof Error?e.message:String(e);this.callbacks.onState("error",t),await this.stop()}}async stop(){var e,t,r,i;this.callbacks.onState("stopping");try{(e=this.processor)==null||e.disconnect(),(t=this.source)==null||t.disconnect(),this.processor=void 0,this.source=void 0,await((r=this.audioContext)==null?void 0:r.close()),this.audioContext=void 0,(i=this.mediaStream)==null||i.getTracks().forEach(s=>s.stop()),this.mediaStream=void 0}finally{this.callbacks.onState("stopped")}}}class qL{constructor(e){G(this,"_key");if(!e)throw new Error("key must be a non-empty string");this._key=e}get key(){return this._key}update(e){this._key=e}}function HU(n,e){switch(e){case"utf-8":return WU(n);case"base64":return VL(n);case"base64url":return qU(n);case"hex":return VU(n)}}function WU(n){return new TextEncoder().encode(n)}function VL(n){return new Uint8Array([...atob(n)].map(e=>e.charCodeAt(0)))}function qU(n){const e=n.replace(/-/g,"+").replace(/_/g,"/");return VL(e)}const FD=new Set("0123456789abcdefABCDEF");function VU(n){const e=new Uint8Array(n.length/2);for(let t=0;t<n.length/2;++t){const r=n[2*t],i=n[2*t+1];if(!FD.has(r)||!FD.has(i))return e.slice(0,t);e[t]=parseInt(`${r}${i}`,16)}return e}function GU(n,e){return HU(n,e)}function KU(n){return{code:n.code,message:n.message,param:n.param,type:n.type,eventId:n.event_id}}function $U(n){return{token:n.token,logprob:n.logprob,bytes:n.bytes.map(e=>e)}}function JU(n){return{type:n.type,event_id:n.eventId}}function XU(n){switch(n.type){case"session.update":return YU(n);case"session.avatar.connect":return X8(n);case"input_audio.turn.start":return Y8(n);case"input_audio.turn.append":return Q8(n);case"input_audio.turn.end":return Z8(n);case"input_audio.turn.cancel":return eH(n);case"input_audio.clear":return tH(n);case"input_audio_buffer.append":return nH(n);case"input_audio_buffer.commit":return rH(n);case"input_audio_buffer.clear":return iH(n);case"conversation.item.create":return sH(n);case"conversation.item.truncate":return SH(n);case"conversation.item.delete":return CH(n);case"response.create":return bH(n);case"response.cancel":return AH(n);case"conversation.item.retrieve":return EH(n);default:return JU(n)}}var co;(function(n){n.SessionUpdate="session.update",n.InputAudioBufferAppend="input_audio_buffer.append",n.InputAudioBufferCommit="input_audio_buffer.commit",n.InputAudioBufferClear="input_audio_buffer.clear",n.InputAudioTurnStart="input_audio.turn.start",n.InputAudioTurnAppend="input_audio.turn.append",n.InputAudioTurnEnd="input_audio.turn.end",n.InputAudioTurnCancel="input_audio.turn.cancel",n.InputAudioClear="input_audio.clear",n.ConversationItemCreate="conversation.item.create",n.ConversationItemRetrieve="conversation.item.retrieve",n.ConversationItemTruncate="conversation.item.truncate",n.ConversationItemDelete="conversation.item.delete",n.ResponseCreate="response.create",n.ResponseCancel="response.cancel",n.SessionAvatarConnect="session.avatar.connect",n.McpApprovalResponse="mcp_approval_response"})(co||(co={}));function YU(n){return{type:n.type,event_id:n.eventId,session:QU(n.session)}}function QU(n){return{model:n.model,modalities:n.modalities?n.modalities.map(e=>e):n.modalities,animation:n.animation?ZU(n.animation):n.animation,voice:n.voice?n.voice:n.voice,instructions:n.instructions,input_audio_sampling_rate:n.inputAudioSamplingRate,input_audio_format:n.inputAudioFormat,output_audio_format:n.outputAudioFormat,turn_detection:n.turnDetection?r8(n.turnDetection):n.turnDetection,input_audio_noise_reduction:n.inputAudioNoiseReduction?b8(n.inputAudioNoiseReduction):n.inputAudioNoiseReduction,input_audio_echo_cancellation:n.inputAudioEchoCancellation?A8(n.inputAudioEchoCancellation):n.inputAudioEchoCancellation,avatar:n.avatar?R8(n.avatar):n.avatar,input_audio_transcription:n.inputAudioTranscription?F8(n.inputAudioTranscription):n.inputAudioTranscription,output_audio_timestamp_types:n.outputAudioTimestampTypes?n.outputAudioTimestampTypes.map(e=>e):n.outputAudioTimestampTypes,tools:n.tools?GL(n.tools):n.tools,tool_choice:n.toolChoice?n.toolChoice:n.toolChoice,temperature:n.temperature,max_response_output_tokens:n.maxResponseOutputTokens?n.maxResponseOutputTokens:n.maxResponseOutputTokens}}var BD;(function(n){n.Text="text",n.Audio="audio",n.Animation="animation",n.Avatar="avatar"})(BD||(BD={}));function ZU(n){return{model_name:n.modelName,outputs:n.outputs?n.outputs.map(e=>e):n.outputs}}function e8(n){return{modelName:n.model_name,outputs:n.outputs?n.outputs.map(e=>e):n.outputs}}var UD;(function(n){n.Blendshapes="blendshapes",n.VisemeId="viseme_id"})(UD||(UD={}));var HD;(function(n){n.Alloy="alloy",n.Ash="ash",n.Ballad="ballad",n.Coral="coral",n.Echo="echo",n.Sage="sage",n.Shimmer="shimmer",n.Verse="verse",n.Marin="marin",n.Cedar="cedar"})(HD||(HD={}));var WD;(function(n){n.AzureCustom="azure-custom",n.AzureStandard="azure-standard",n.AzurePersonal="azure-personal"})(WD||(WD={}));var qD;(function(n){n.DragonLatestNeural="DragonLatestNeural",n.PhoenixLatestNeural="PhoenixLatestNeural",n.PhoenixV2Neural="PhoenixV2Neural"})(qD||(qD={}));var VD;(function(n){n.Pcm16="pcm16",n.G711Ulaw="g711_ulaw",n.G711Alaw="g711_alaw"})(VD||(VD={}));var GD;(function(n){n.Pcm16="pcm16",n.Pcm168000Hz="pcm16-8000hz",n.Pcm1616000Hz="pcm16-16000hz",n.G711Ulaw="g711_ulaw",n.G711Alaw="g711_alaw"})(GD||(GD={}));function t8(n){return{type:n.type}}function n8(n){return{type:n.type}}function r8(n){switch(n.type){case"server_vad":return s8(n);case"azure_semantic_vad":return g8(n);case"azure_semantic_vad_en":return m8(n);case"azure_semantic_vad_multilingual":return S8(n);default:return t8(n)}}function i8(n){switch(n.type){case"server_vad":return o8(n);case"azure_semantic_vad":return v8(n);case"azure_semantic_vad_en":return y8(n);case"azure_semantic_vad_multilingual":return C8(n);default:return n8(n)}}var KD;(function(n){n.ServerVad="server_vad",n.AzureSemanticVad="azure_semantic_vad",n.AzureSemanticVadEn="azure_semantic_vad_en",n.AzureSemanticVadMultilingual="azure_semantic_vad_multilingual"})(KD||(KD={}));function s8(n){return{type:n.type,threshold:n.threshold,prefix_padding_ms:n.prefixPaddingInMs,silence_duration_ms:n.silenceDurationInMs,end_of_utterance_detection:n.endOfUtteranceDetection?$0(n.endOfUtteranceDetection):n.endOfUtteranceDetection,auto_truncate:n.autoTruncate,create_response:n.createResponse,interrupt_response:n.interruptResponse}}function o8(n){return{type:n.type,threshold:n.threshold,prefixPaddingInMs:n.prefix_padding_ms,silenceDurationInMs:n.silence_duration_ms,endOfUtteranceDetection:n.end_of_utterance_detection?J0(n.end_of_utterance_detection):n.end_of_utterance_detection,autoTruncate:n.auto_truncate,createResponse:n.create_response,interruptResponse:n.interrupt_response}}function a8(n){return{model:n.model}}function c8(n){return{model:n.model}}function $0(n){switch(n.model){case"semantic_detection_v1":return l8(n);case"semantic_detection_v1_en":return d8(n);case"semantic_detection_v1_multilingual":return p8(n);default:return a8(n)}}function J0(n){switch(n.model){case"semantic_detection_v1":return u8(n);case"semantic_detection_v1_en":return h8(n);case"semantic_detection_v1_multilingual":return f8(n);default:return c8(n)}}function l8(n){return{model:n.model,threshold_level:n.thresholdLevel,timeout_ms:n.timeoutInMs}}function u8(n){return{model:n.model,thresholdLevel:n.threshold_level,timeoutInMs:n.timeout_ms}}var $D;(function(n){n.Low="low",n.Medium="medium",n.High="high",n.Default="default"})($D||($D={}));function d8(n){return{model:n.model,threshold_level:n.thresholdLevel,timeout_ms:n.timeoutInMs}}function h8(n){return{model:n.model,thresholdLevel:n.threshold_level,timeoutInMs:n.timeout_ms}}function p8(n){return{model:n.model,threshold_level:n.thresholdLevel,timeout_ms:n.timeoutInMs}}function f8(n){return{model:n.model,thresholdLevel:n.threshold_level,timeoutInMs:n.timeout_ms}}function g8(n){return{type:n.type,threshold:n.threshold,prefix_padding_ms:n.prefixPaddingInMs,silence_duration_ms:n.silenceDurationInMs,end_of_utterance_detection:n.endOfUtteranceDetection?$0(n.endOfUtteranceDetection):n.endOfUtteranceDetection,speech_duration_ms:n.speechDurationInMs,remove_filler_words:n.removeFillerWords,languages:n.languages?n.languages.map(e=>e):n.languages,auto_truncate:n.autoTruncate,create_response:n.createResponse,interrupt_response:n.interruptResponse}}function v8(n){return{type:n.type,threshold:n.threshold,prefixPaddingInMs:n.prefix_padding_ms,silenceDurationInMs:n.silence_duration_ms,endOfUtteranceDetection:n.end_of_utterance_detection?J0(n.end_of_utterance_detection):n.end_of_utterance_detection,speechDurationInMs:n.speech_duration_ms,removeFillerWords:n.remove_filler_words,languages:n.languages?n.languages.map(e=>e):n.languages,autoTruncate:n.auto_truncate,createResponse:n.create_response,interruptResponse:n.interrupt_response}}function m8(n){return{type:n.type,threshold:n.threshold,prefix_padding_ms:n.prefixPaddingInMs,silence_duration_ms:n.silenceDurationInMs,end_of_utterance_detection:n.endOfUtteranceDetection?$0(n.endOfUtteranceDetection):n.endOfUtteranceDetection,speech_duration_ms:n.speechDurationInMs,remove_filler_words:n.removeFillerWords,auto_truncate:n.autoTruncate,create_response:n.createResponse,interrupt_response:n.interruptResponse}}function y8(n){return{type:n.type,threshold:n.threshold,prefixPaddingInMs:n.prefix_padding_ms,silenceDurationInMs:n.silence_duration_ms,endOfUtteranceDetection:n.end_of_utterance_detection?J0(n.end_of_utterance_detection):n.end_of_utterance_detection,speechDurationInMs:n.speech_duration_ms,removeFillerWords:n.remove_filler_words,autoTruncate:n.auto_truncate,createResponse:n.create_response,interruptResponse:n.interrupt_response}}function S8(n){return{type:n.type,threshold:n.threshold,prefix_padding_ms:n.prefixPaddingInMs,silence_duration_ms:n.silenceDurationInMs,end_of_utterance_detection:n.endOfUtteranceDetection?$0(n.endOfUtteranceDetection):n.endOfUtteranceDetection,speech_duration_ms:n.speechDurationInMs,remove_filler_words:n.removeFillerWords,languages:n.languages?n.languages.map(e=>e):n.languages,auto_truncate:n.autoTruncate,create_response:n.createResponse,interrupt_response:n.interruptResponse}}function C8(n){return{type:n.type,threshold:n.threshold,prefixPaddingInMs:n.prefix_padding_ms,silenceDurationInMs:n.silence_duration_ms,endOfUtteranceDetection:n.end_of_utterance_detection?J0(n.end_of_utterance_detection):n.end_of_utterance_detection,speechDurationInMs:n.speech_duration_ms,removeFillerWords:n.remove_filler_words,languages:n.languages?n.languages.map(e=>e):n.languages,autoTruncate:n.auto_truncate,createResponse:n.create_response,interruptResponse:n.interrupt_response}}function b8(n){return{type:n.type}}function w8(n){return{type:n.type}}function A8(n){return{type:n.type}}function E8(n){return{type:n.type}}function R8(n){return{type:n.type,ice_servers:n.iceServers?T8(n.iceServers):n.iceServers,character:n.character,style:n.style,model:n.model,customized:n.customized,video:n.video?k8(n.video):n.video,output_protocol:n.outputProtocol}}function P8(n){return{type:n.type,iceServers:n.ice_servers?x8(n.ice_servers):n.ice_servers,character:n.character,style:n.style,model:n.model,customized:n.customized,video:n.video?M8(n.video):n.video,outputProtocol:n.output_protocol}}var JD;(function(n){n.VideoAvatar="video-avatar",n.PhotoAvatar="photo-avatar"})(JD||(JD={}));function T8(n){return n.map(e=>I8(e))}function x8(n){return n.map(e=>_8(e))}function I8(n){return{urls:n.urls.map(e=>e),username:n.username,credential:n.credential}}function _8(n){return{urls:n.urls.map(e=>e),username:n.username,credential:n.credential}}var XD;(function(n){n.Vasa1="vasa-1"})(XD||(XD={}));function k8(n){return{bitrate:n.bitrate,codec:n.codec,crop:n.crop?D8(n.crop):n.crop,resolution:n.resolution?O8(n.resolution):n.resolution,background:n.background?j8(n.background):n.background,gop_size:n.gopSize}}function M8(n){return{bitrate:n.bitrate,codec:n.codec,crop:n.crop?N8(n.crop):n.crop,resolution:n.resolution?L8(n.resolution):n.resolution,background:n.background?z8(n.background):n.background,gopSize:n.gop_size}}function D8(n){return{top_left:n.topLeft.map(e=>e),bottom_right:n.bottomRight.map(e=>e)}}function N8(n){return{topLeft:n.top_left.map(e=>e),bottomRight:n.bottom_right.map(e=>e)}}function O8(n){return{width:n.width,height:n.height}}function L8(n){return{width:n.width,height:n.height}}function j8(n){return{color:n.color,image_url:n.imageUrl}}function z8(n){return{color:n.color,imageUrl:n.image_url}}var YD;(function(n){n.Webrtc="webrtc",n.Websocket="websocket"})(YD||(YD={}));function F8(n){return{model:n.model,language:n.language,custom_speech:n.customSpeech,phrase_list:n.phraseList?n.phraseList.map(e=>e):n.phraseList}}function B8(n){return{model:n.model,language:n.language,customSpeech:n.custom_speech?Object.fromEntries(Object.entries(n.custom_speech).map(([e,t])=>[e,t])):n.custom_speech,phraseList:n.phrase_list?n.phrase_list.map(e=>e):n.phrase_list}}var QD;(function(n){n.Word="word"})(QD||(QD={}));function GL(n){return n.map(e=>q8(e))}function U8(n){return n.map(e=>V8(e))}function H8(n){return{type:n.type}}function W8(n){return{type:n.type}}function q8(n){switch(n.type){case"function":return G8(n);case"mcp":return $8(n);default:return H8(n)}}function V8(n){switch(n.type){case"function":return K8(n);case"mcp":return J8(n);default:return W8(n)}}var ZD;(function(n){n.Function="function",n.Mcp="mcp"})(ZD||(ZD={}));function G8(n){return{type:n.type,name:n.name,description:n.description,parameters:n.parameters}}function K8(n){return{type:n.type,name:n.name,description:n.description,parameters:n.parameters}}function $8(n){return{type:n.type,server_label:n.serverLabel,server_url:n.serverUrl,authorization:n.authorization,headers:n.headers,allowed_tools:n.allowedTools?n.allowedTools.map(e=>e):n.allowedTools,require_approval:n.requireApproval?n.requireApproval:n.requireApproval}}function J8(n){return{type:n.type,serverLabel:n.server_label,serverUrl:n.server_url,authorization:n.authorization,headers:n.headers?Object.fromEntries(Object.entries(n.headers).map(([e,t])=>[e,t])):n.headers,allowedTools:n.allowed_tools?n.allowed_tools.map(e=>e):n.allowed_tools,requireApproval:n.require_approval?n.require_approval:n.require_approval}}var eN;(function(n){n.Never="never",n.Always="always"})(eN||(eN={}));var tN;(function(n){n.Auto="auto",n.None="none",n.Required="required"})(tN||(tN={}));function X8(n){return{type:n.type,event_id:n.eventId,client_sdp:n.clientSdp}}function Y8(n){return{type:n.type,event_id:n.eventId,turn_id:n.turnId}}function Q8(n){return{type:n.type,event_id:n.eventId,turn_id:n.turnId,audio:n.audio}}function Z8(n){return{type:n.type,event_id:n.eventId,turn_id:n.turnId}}function eH(n){return{type:n.type,event_id:n.eventId,turn_id:n.turnId}}function tH(n){return{type:n.type,event_id:n.eventId}}function nH(n){return{type:n.type,event_id:n.eventId,audio:n.audio}}function rH(n){return{type:n.type,event_id:n.eventId}}function iH(n){return{type:n.type,event_id:n.eventId}}function sH(n){return{type:n.type,event_id:n.eventId,previous_item_id:n.previousItemId,item:n.item?KL(n.item):n.item}}function oH(n){return{type:n.type,id:n.id}}function KL(n){switch(n.type){case"message":return cH(n);case"function_call":return vH(n);case"function_call_output":return mH(n);case"mcp_approval_response":return yH(n);default:return oH(n)}}var nN;(function(n){n.Message="message",n.FunctionCall="function_call",n.FunctionCallOutput="function_call_output",n.McpListTools="mcp_list_tools",n.McpCall="mcp_call",n.McpApprovalRequest="mcp_approval_request",n.McpApprovalResponse="mcp_approval_response"})(nN||(nN={}));function aH(n){return{type:n.type,id:n.id,role:n.role,content:X0(n.content),status:n.status}}function cH(n){switch(n.role){case"assistant":return $L(n);case"system":return fH(n);case"user":return gH(n);default:return aH(n)}}var rN;(function(n){n.System="system",n.User="user",n.Assistant="assistant"})(rN||(rN={}));function X0(n){return n.map(e=>uH(e))}function lH(n){return{type:n.type}}function uH(n){switch(n.type){case"input_text":return dH(n);case"input_audio":return hH(n);case"text":return pH(n);default:return lH(n)}}var iN;(function(n){n.InputText="input_text",n.InputAudio="input_audio",n.InputImage="input_image",n.Text="text",n.Audio="audio"})(iN||(iN={}));function dH(n){return{type:n.type,text:n.text}}function hH(n){return{type:n.type,audio:n.audio,transcript:n.transcript}}function pH(n){return{type:n.type,text:n.text}}var sN;(function(n){n.Completed="completed",n.Incomplete="incomplete"})(sN||(sN={}));function $L(n){return{type:n.type,role:n.role,content:X0(n.content),status:n.status,id:n.id}}function fH(n){return{type:n.type,role:n.role,content:X0(n.content),status:n.status,id:n.id}}function gH(n){return{type:n.type,role:n.role,content:X0(n.content),status:n.status,id:n.id}}function vH(n){return{type:n.type,id:n.id,name:n.name,call_id:n.callId,arguments:n.arguments,status:n.status}}function mH(n){return{type:n.type,id:n.id,call_id:n.callId,output:n.output,status:n.status}}function yH(n){return{type:n.type,id:n.id,approval_request_id:n.approvalRequestId,approve:n.approve}}function SH(n){return{type:n.type,event_id:n.eventId,item_id:n.itemId,content_index:n.contentIndex,audio_end_ms:n.audioEndInMs}}function CH(n){return{type:n.type,event_id:n.eventId,item_id:n.itemId}}function bH(n){return{type:n.type,event_id:n.eventId,response:n.response?wH(n.response):n.response,additional_instructions:n.additionalInstructions}}function wH(n){return{commit:n.commit,cancel_previous:n.cancelPrevious,append_input_items:n.appendInputItems?oN(n.appendInputItems):n.appendInputItems,input_items:n.inputItems?oN(n.inputItems):n.inputItems,modalities:n.modalities?n.modalities.map(e=>e):n.modalities,instructions:n.instructions,voice:n.voice?n.voice:n.voice,output_audio_format:n.outputAudioFormat,tools:n.tools?GL(n.tools):n.tools,tool_choice:n.toolChoice,temperature:n.temperature,max_output_tokens:n.maxOutputTokens?n.maxOutputTokens:n.maxOutputTokens,pre_generated_assistant_message:n.preGeneratedAssistantMessage?$L(n.preGeneratedAssistantMessage):n.preGeneratedAssistantMessage}}function oN(n){return n.map(e=>KL(e))}function AH(n){return{type:n.type,event_id:n.eventId,response_id:n.responseId}}function EH(n){return{type:n.type,event_id:n.eventId,item_id:n.itemId}}function JL(n){return{id:n.id,object:n.object,status:n.status,statusDetails:n.status_details?PH(n.status_details):n.status_details,output:n.output?_H(n.output):n.output,usage:n.usage?$H(n.usage):n.usage,conversationId:n.conversation_id,voice:n.voice?n.voice:n.voice,modalities:n.modalities?n.modalities.map(e=>e):n.modalities,outputAudioFormat:n.output_audio_format,temperature:n.temperature,maxOutputTokens:n.max_output_tokens?n.max_output_tokens:n.max_output_tokens}}var aN;(function(n){n.Completed="completed",n.Cancelled="cancelled",n.Failed="failed",n.Incomplete="incomplete",n.InProgress="in_progress"})(aN||(aN={}));function RH(n){return{type:n.type}}function PH(n){switch(n.type){case"cancelled":return TH(n);case"incomplete":return xH(n);case"failed":return IH(n);default:return RH(n)}}function TH(n){return{type:n.type,reason:n.reason}}function xH(n){return{type:n.type,reason:n.reason}}function IH(n){return{type:n.type,error:n.error}}function _H(n){return n.map(e=>tS(e))}function kH(n){return{type:n.type,id:n.id,object:n.object}}function tS(n){switch(n.type){case"message":return MH(n);case"function_call":return BH(n);case"function_call_output":return UH(n);case"mcp_list_tools":return HH(n);case"mcp_call":return VH(n);case"mcp_approval_request":return GH(n);case"mcp_approval_response":return KH(n);default:return kH(n)}}function MH(n){return{type:n.type,id:n.id,object:n.object,role:n.role,content:DH(n.content),status:n.status}}function DH(n){return n.map(e=>SP(e))}function NH(n){return{type:n.type}}function SP(n){switch(n.type){case"input_image":return OH(n);case"input_text":return LH(n);case"input_audio":return jH(n);case"text":return zH(n);case"audio":return FH(n);default:return NH(n)}}function OH(n){return{type:n.type,url:n.url,detail:n.detail}}var cN;(function(n){n.Auto="auto",n.Low="low",n.High="high"})(cN||(cN={}));function LH(n){return{type:n.type,text:n.text}}function jH(n){return{type:n.type,transcript:n.transcript}}function zH(n){return{type:n.type,text:n.text}}function FH(n){return{type:n.type,transcript:n.transcript}}var lN;(function(n){n.InProgress="in_progress",n.Completed="completed",n.Incomplete="incomplete"})(lN||(lN={}));function BH(n){return{type:n.type,id:n.id,object:n.object,name:n.name,callId:n.call_id,arguments:n.arguments,status:n.status}}function UH(n){return{type:n.type,id:n.id,object:n.object,callId:n.call_id,output:n.output}}function HH(n){return{type:n.type,id:n.id,object:n.object,tools:WH(n.tools),serverLabel:n.server_label}}function WH(n){return n.map(e=>qH(e))}function qH(n){return{name:n.name,description:n.description,inputSchema:n.input_schema,annotations:n.annotations}}function VH(n){return{type:n.type,id:n.id,object:n.object,approvalRequestId:n.approval_request_id,arguments:n.arguments,serverLabel:n.server_label,name:n.name,output:n.output,error:n.error}}function GH(n){return{type:n.type,id:n.id,object:n.object,arguments:n.arguments,name:n.name,serverLabel:n.server_label}}function KH(n){return{type:n.type,id:n.id,object:n.object,approvalRequestId:n.approval_request_id,approve:n.approve,reason:n.reason}}function $H(n){return{totalTokens:n.total_tokens,inputTokens:n.input_tokens,outputTokens:n.output_tokens,inputTokenDetails:JH(n.input_token_details),outputTokenDetails:YH(n.output_token_details)}}function JH(n){return{cachedTokens:n.cached_tokens,textTokens:n.text_tokens,audioTokens:n.audio_tokens,imageTokens:n.image_tokens,cachedTokensDetails:XH(n.cached_tokens_details)}}function XH(n){return{textTokens:n.text_tokens,audioTokens:n.audio_tokens,imageTokens:n.image_tokens}}function YH(n){return{textTokens:n.text_tokens,audioTokens:n.audio_tokens}}function QH(n){return{type:n.type,eventId:n.event_id}}function ZH(n){switch(n.type){case"error":return eW(n);case"session.created":return nW(n);case"session.updated":return iW(n);case"session.avatar.connecting":return sW(n);case"input_audio_buffer.committed":return oW(n);case"input_audio_buffer.cleared":return aW(n);case"input_audio_buffer.speech_started":return cW(n);case"input_audio_buffer.speech_stopped":return lW(n);case"conversation.item.created":return uW(n);case"conversation.item.input_audio_transcription.completed":return dW(n);case"conversation.item.input_audio_transcription.failed":return hW(n);case"conversation.item.truncated":return pW(n);case"conversation.item.deleted":return fW(n);case"response.created":return gW(n);case"response.done":return vW(n);case"response.output_item.added":return mW(n);case"response.output_item.done":return yW(n);case"response.content_part.added":return SW(n);case"response.content_part.done":return CW(n);case"response.text.delta":return bW(n);case"response.text.done":return wW(n);case"response.audio_transcript.delta":return AW(n);case"response.audio_transcript.done":return EW(n);case"response.audio.delta":return RW(n);case"response.audio.done":return PW(n);case"response.animation_blendshapes.delta":return TW(n);case"response.animation_blendshapes.done":return xW(n);case"response.audio_timestamp.delta":return IW(n);case"response.audio_timestamp.done":return _W(n);case"response.animation_viseme.delta":return kW(n);case"response.animation_viseme.done":return MW(n);case"conversation.item.input_audio_transcription.delta":return DW(n);case"conversation.item.retrieved":return OW(n);case"response.function_call_arguments.delta":return LW(n);case"response.function_call_arguments.done":return jW(n);case"mcp_list_tools.in_progress":return zW(n);case"mcp_list_tools.completed":return FW(n);case"mcp_list_tools.failed":return BW(n);case"response.mcp_call_arguments.delta":return UW(n);case"response.mcp_call_arguments.done":return HW(n);case"response.mcp_call.in_progress":return WW(n);case"response.mcp_call.completed":return qW(n);case"response.mcp_call.failed":return VW(n);default:return QH(n)}}var em;(function(n){n.Error="error",n.SessionAvatarConnecting="session.avatar.connecting",n.SessionCreated="session.created",n.SessionUpdated="session.updated",n.ConversationItemInputAudioTranscriptionCompleted="conversation.item.input_audio_transcription.completed",n.ConversationItemInputAudioTranscriptionDelta="conversation.item.input_audio_transcription.delta",n.ConversationItemInputAudioTranscriptionFailed="conversation.item.input_audio_transcription.failed",n.ConversationItemCreated="conversation.item.created",n.ConversationItemRetrieved="conversation.item.retrieved",n.ConversationItemTruncated="conversation.item.truncated",n.ConversationItemDeleted="conversation.item.deleted",n.InputAudioBufferCommitted="input_audio_buffer.committed",n.InputAudioBufferCleared="input_audio_buffer.cleared",n.InputAudioBufferSpeechStarted="input_audio_buffer.speech_started",n.InputAudioBufferSpeechStopped="input_audio_buffer.speech_stopped",n.ResponseCreated="response.created",n.ResponseDone="response.done",n.ResponseOutputItemAdded="response.output_item.added",n.ResponseOutputItemDone="response.output_item.done",n.ResponseContentPartAdded="response.content_part.added",n.ResponseContentPartDone="response.content_part.done",n.ResponseTextDelta="response.text.delta",n.ResponseTextDone="response.text.done",n.ResponseAudioTranscriptDelta="response.audio_transcript.delta",n.ResponseAudioTranscriptDone="response.audio_transcript.done",n.ResponseAudioDelta="response.audio.delta",n.ResponseAudioDone="response.audio.done",n.ResponseAnimationBlendshapesDelta="response.animation_blendshapes.delta",n.ResponseAnimationBlendshapesDone="response.animation_blendshapes.done",n.ResponseAudioTimestampDelta="response.audio_timestamp.delta",n.ResponseAudioTimestampDone="response.audio_timestamp.done",n.ResponseAnimationVisemeDelta="response.animation_viseme.delta",n.ResponseAnimationVisemeDone="response.animation_viseme.done",n.ResponseFunctionCallArgumentsDelta="response.function_call_arguments.delta",n.ResponseFunctionCallArgumentsDone="response.function_call_arguments.done",n.McpListToolsInProgress="mcp_list_tools.in_progress",n.McpListToolsCompleted="mcp_list_tools.completed",n.McpListToolsFailed="mcp_list_tools.failed",n.ResponseMcpCallArgumentsDelta="response.mcp_call_arguments.delta",n.ResponseMcpCallArgumentsDone="response.mcp_call_arguments.done",n.McpApprovalRequest="mcp_approval_request",n.McpApprovalResponse="mcp_approval_response",n.ResponseMcpCallInProgress="response.mcp_call.in_progress",n.ResponseMcpCallCompleted="response.mcp_call.completed",n.ResponseMcpCallFailed="response.mcp_call.failed"})(em||(em={}));function eW(n){return{type:n.type,eventId:n.event_id,error:tW(n.error)}}function tW(n){return{type:n.type,code:n.code,message:n.message,param:n.param,eventId:n.event_id}}function nW(n){return{type:n.type,eventId:n.event_id,session:XL(n.session)}}function XL(n){return{model:n.model,modalities:n.modalities?n.modalities.map(e=>e):n.modalities,animation:n.animation?e8(n.animation):n.animation,voice:n.voice?n.voice:n.voice,instructions:n.instructions,inputAudioSamplingRate:n.input_audio_sampling_rate,inputAudioFormat:n.input_audio_format,outputAudioFormat:n.output_audio_format,turnDetection:n.turn_detection?i8(n.turn_detection):n.turn_detection,inputAudioNoiseReduction:n.input_audio_noise_reduction?w8(n.input_audio_noise_reduction):n.input_audio_noise_reduction,inputAudioEchoCancellation:n.input_audio_echo_cancellation?E8(n.input_audio_echo_cancellation):n.input_audio_echo_cancellation,avatar:n.avatar?P8(n.avatar):n.avatar,inputAudioTranscription:n.input_audio_transcription?B8(n.input_audio_transcription):n.input_audio_transcription,outputAudioTimestampTypes:n.output_audio_timestamp_types?n.output_audio_timestamp_types.map(e=>e):n.output_audio_timestamp_types,tools:n.tools?U8(n.tools):n.tools,toolChoice:n.tool_choice?n.tool_choice:n.tool_choice,temperature:n.temperature,maxResponseOutputTokens:n.max_response_output_tokens?n.max_response_output_tokens:n.max_response_output_tokens,agent:n.agent?rW(n.agent):n.agent,id:n.id}}function rW(n){return{type:n.type,name:n.name,description:n.description,agentId:n.agent_id,threadId:n.thread_id}}function iW(n){return{type:n.type,eventId:n.event_id,session:XL(n.session)}}function sW(n){return{type:n.type,eventId:n.event_id,serverSdp:n.server_sdp}}function oW(n){return{type:n.type,eventId:n.event_id,previousItemId:n.previous_item_id,itemId:n.item_id}}function aW(n){return{type:n.type,eventId:n.event_id}}function cW(n){return{type:n.type,eventId:n.event_id,audioStartInMs:n.audio_start_ms,itemId:n.item_id}}function lW(n){return{type:n.type,eventId:n.event_id,audioEndInMs:n.audio_end_ms,itemId:n.item_id}}function uW(n){return{type:n.type,eventId:n.event_id,previousItemId:n.previous_item_id,item:n.item?tS(n.item):n.item}}function dW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,contentIndex:n.content_index,transcript:n.transcript}}function hW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,contentIndex:n.content_index,error:KU(n.error)}}function pW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,contentIndex:n.content_index,audioEndInMs:n.audio_end_ms}}function fW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id}}function gW(n){return{type:n.type,eventId:n.event_id,response:JL(n.response)}}function vW(n){return{type:n.type,eventId:n.event_id,response:JL(n.response)}}function mW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,outputIndex:n.output_index,item:n.item?tS(n.item):n.item}}function yW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,outputIndex:n.output_index,item:n.item?tS(n.item):n.item}}function SW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,part:SP(n.part)}}function CW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,part:SP(n.part)}}function bW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,delta:n.delta}}function wW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,text:n.text}}function AW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,delta:n.delta}}function EW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,transcript:n.transcript}}function RW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,delta:typeof n.delta=="string"?GU(n.delta,"base64"):n.delta}}function PW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index}}function TW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,frames:n.frames,frameIndex:n.frame_index}}function xW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index}}function IW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,audioOffsetInMs:n.audio_offset_ms,audioDurationInMs:n.audio_duration_ms,text:n.text,timestampType:n.timestamp_type}}function _W(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index}}function kW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,audioOffsetInMs:n.audio_offset_ms,visemeId:n.viseme_id}}function MW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index}}function DW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,contentIndex:n.content_index,delta:n.delta,logprobs:n.logprobs?NW(n.logprobs):n.logprobs}}function NW(n){return n.map(e=>$U(e))}function OW(n){return{type:n.type,eventId:n.event_id,item:n.item?tS(n.item):n.item}}function LW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,callId:n.call_id,delta:n.delta}}function jW(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,callId:n.call_id,arguments:n.arguments,name:n.name}}function zW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id}}function FW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id}}function BW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id}}function UW(n){return{type:n.type,eventId:n.event_id,delta:n.delta,itemId:n.item_id,responseId:n.response_id,outputIndex:n.output_index,obfuscation:n.obfuscation}}function HW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,responseId:n.response_id,outputIndex:n.output_index,arguments:n.arguments}}function WW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,outputIndex:n.output_index}}function qW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,outputIndex:n.output_index}}function VW(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,outputIndex:n.output_index}}var gt;(function(n){n.ConnectionFailed="CONNECTION_FAILED",n.ConnectionTimeout="CONNECTION_TIMEOUT",n.ConnectionLost="CONNECTION_LOST",n.AlreadyConnected="ALREADY_CONNECTED",n.NotConnected="NOT_CONNECTED",n.WebSocketError="WEBSOCKET_ERROR",n.AuthenticationFailed="AUTHENTICATION_FAILED",n.InvalidCredentials="INVALID_CREDENTIALS",n.Unauthorized="UNAUTHORIZED",n.Forbidden="FORBIDDEN",n.InvalidMessage="INVALID_MESSAGE",n.MessageTooLarge="MESSAGE_TOO_LARGE",n.ProtocolError="PROTOCOL_ERROR",n.BufferOverflow="BUFFER_OVERFLOW",n.OperationCancelled="OPERATION_CANCELLED",n.InvalidState="INVALID_STATE"})(gt||(gt={}));class it extends Error{constructor(t,r,i="websocket",s=!1,o){super(t);G(this,"code");G(this,"context");G(this,"recoverable");G(this,"cause");G(this,"timestamp");this.name="VoiceLiveConnectionError",this.code=r,this.context=i,this.recoverable=s,this.cause=o,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,it),Object.defineProperty(this,"message",{enumerable:!0}),Object.defineProperty(this,"name",{enumerable:!0}),Object.defineProperty(this,"stack",{enumerable:!0})}}class Pv extends it{constructor(e,t,r){super(e,t,"authentication",!1,r),this.name="VoiceLiveAuthenticationError"}}function GW(n,e){switch(n){case 1e3:return new it("WebSocket connection closed normally",gt.ConnectionLost,"websocket_close",!1);case 1001:case 1006:return new it(`WebSocket connection lost: ${e||"Abnormal closure"}`,gt.ConnectionLost,"websocket_close",!0);case 1008:return new it(`WebSocket policy violation: ${e}`,gt.WebSocketError,"websocket_close",!1);case 1011:return new it(`WebSocket server error: ${e}`,gt.WebSocketError,"websocket_close",!0);default:return new it(`WebSocket closed with code ${n}: ${e}`,gt.ConnectionLost,"websocket_close",!0)}}function uN(n){if(n instanceof it)return n;if(n instanceof Error){if(n.message.includes("timeout"))return new it(`Connection timeout: ${n.message}`,gt.ConnectionTimeout,"connection",!0,n);if(n.message.includes("ECONNREFUSED")||n.message.includes("ENOTFOUND"))return new it(`Connection failed: ${n.message}`,gt.ConnectionFailed,"connection",!0,n)}return new it(`Unknown connection error: ${n instanceof Error?n.message:String(n)}`,gt.ConnectionFailed,"connection",!0,n instanceof Error?n:new Error(String(n)))}function KW(...n){if(n.length>0){const e=String(n[0]);e.includes(":error")?console.error(...n):e.includes(":warning")?console.warn(...n):e.includes(":info")?console.info(...n):e.includes(":verbose")?console.debug(...n):console.debug(...n)}}var dN={};const hN=typeof process<"u"&&dN&&dN.DEBUG||void 0;let YL,JR=[],XR=[];const S0=[];hN&&CP(hN);const dd=Object.assign(n=>QL(n),{enable:CP,enabled:bP,disable:$W,log:KW});function CP(n){YL=n,JR=[],XR=[];const e=n.split(",").map(t=>t.trim());for(const t of e)t.startsWith("-")?XR.push(t.substring(1)):JR.push(t);for(const t of S0)t.enabled=bP(t.namespace)}function bP(n){if(n.endsWith("*"))return!0;for(const e of XR)if(pN(n,e))return!1;for(const e of JR)if(pN(n,e))return!0;return!1}function pN(n,e){if(e.indexOf("*")===-1)return n===e;let t=e;if(e.indexOf("**")!==-1){const g=[];let m="";for(const C of e)C==="*"&&m==="*"||(m=C,g.push(C));t=g.join("")}let r=0,i=0;const s=t.length,o=n.length;let a=-1,l=-1;for(;r<o&&i<s;)if(t[i]==="*"){if(a=i,i++,i===s)return!0;for(;n[r]!==t[i];)if(r++,r===o)return!1;l=r,r++,i++;continue}else if(t[i]===n[r])i++,r++;else if(a>=0){if(i=a+1,r=l+1,r===o)return!1;for(;n[r]!==t[i];)if(r++,r===o)return!1;l=r,r++,i++;continue}else return!1;const u=r===n.length,p=i===t.length,f=i===t.length-1&&t[i]==="*";return u&&(p||f)}function $W(){const n=YL||"";return CP(""),n}function QL(n){const e=Object.assign(t,{enabled:bP(n),destroy:JW,log:dd.log,namespace:n,extend:XW});function t(...r){e.enabled&&(r.length>0&&(r[0]=`${n} ${r[0]}`),e.log(...r))}return S0.push(e),e}function JW(){const n=S0.indexOf(this);return n>=0?(S0.splice(n,1),!0):!1}function XW(n){const e=QL(`${this.namespace}:${n}`);return e.log=this.log,e}var fN={};const YR=["verbose","info","warning","error"],gN={verbose:400,info:300,warning:200,error:100};function vN(n,e){e.log=(...t)=>{n.log(...t)}}function mN(n){return YR.includes(n)}function ZL(n){const e=new Set,t=typeof process<"u"&&fN&&fN[n.logLevelEnvVarName]||void 0;let r;const i=dd(n.namespace);i.log=(...p)=>{dd.log(...p)};function s(p){if(p&&!mN(p))throw new Error(`Unknown log level '${p}'. Acceptable values: ${YR.join(",")}`);r=p;const f=[];for(const g of e)o(g)&&f.push(g.namespace);dd.enable(f.join(","))}t&&(mN(t)?s(t):console.error(`${n.logLevelEnvVarName} set to unknown log level '${t}'; logging is not enabled. Acceptable values: ${YR.join(", ")}.`));function o(p){return!!(r&&gN[p.level]<=gN[r])}function a(p,f){const g=Object.assign(p.extend(f),{level:f});if(vN(p,g),o(g)){const m=dd.disable();dd.enable(m+","+g.namespace)}return e.add(g),g}function l(){return r}function u(p){const f=i.extend(p);return vN(i,f),{error:a(f,"error"),warning:a(f,"warning"),info:a(f,"info"),verbose:a(f,"verbose")}}return{setLogLevel:s,getLogLevel:l,createClientLogger:u,logger:i}}ZL({logLevelEnvVarName:"TYPESPEC_RUNTIME_LOG_LEVEL",namespace:"typeSpecRuntime"});const YW=ZL({logLevelEnvVarName:"AZURE_LOG_LEVEL",namespace:"azure"});function QW(n){return YW.createClientLogger(n)}const Ze=QW("ai-voicelive");var Xt;(function(n){n.Disconnected="disconnected",n.Connecting="connecting",n.Connected="connected",n.Disconnecting="disconnecting"})(Xt||(Xt={}));class ZW{constructor(e,t,r={}){G(this,"_websocketFactory");G(this,"_options");G(this,"_eventHandlers");G(this,"_state",Xt.Disconnected);G(this,"_previousState",Xt.Disconnected);G(this,"_websocket");G(this,"_abortController");this._websocketFactory=e,this._options=t,this._eventHandlers=r}async connect(e){if(this._state!==Xt.Connected){if(this._state===Xt.Connecting)throw new it("Connection attempt already in progress",gt.InvalidState);this._setState(Xt.Connecting),this._abortController=new AbortController,e&&(e.aborted?this._abortController.abort():e.addEventListener("abort",()=>{var t;(t=this._abortController)==null||t.abort()}));try{this._websocket=this._websocketFactory(),this._setupWebSocketHandlers(),await this._websocket.connect(this._options.endpoint,this._options.protocols,this._abortController.signal),this._setState(Xt.Connected)}catch(t){throw this._setState(Xt.Disconnected),t instanceof it?t:new it(`Failed to connect: ${t instanceof Error?t.message:"Unknown error"}`,gt.ConnectionFailed,"connection_attempt",!0,t instanceof Error?t:new Error(String(t)))}}}async disconnect(e){var t;if(this._state!==Xt.Disconnected){(t=this._abortController)==null||t.abort(),this._setState(Xt.Disconnecting);try{this._websocket&&await this._websocket.disconnect(1e3,"Client disconnect")}finally{this._setState(Xt.Disconnected)}}}async send(e,t){if(!this._websocket||this._state!==Xt.Connected)throw new it("Cannot send message: WebSocket not connected",gt.NotConnected);return this._websocket.send(e,t)}_setupWebSocketHandlers(){this._websocket&&(Ze.info("Setting up WebSocket event handlers"),this._websocket.onOpen(()=>{Ze.info("WebSocket connection opened")}),this._websocket.onClose((e,t)=>{this._handleConnectionLost(e,t)}),this._websocket.onError(e=>{this._handleConnectionError(e)}),this._websocket.onMessage(e=>{var t,r;(r=(t=this._eventHandlers).onMessage)==null||r.call(t,e)}))}_handleConnectionLost(e,t){var i,s;if(this._state===Xt.Disconnecting){this._setState(Xt.Disconnected);return}this._setState(Xt.Disconnected);let r;e===1e3?r=new it("WebSocket connection closed unexpectedly",gt.ConnectionLost,"connection_lost"):r=GW(e,t),(s=(i=this._eventHandlers).onError)==null||s.call(i,r)}_handleConnectionError(e){var r,i;const t=new it(`WebSocket error: ${e.message}`,gt.WebSocketError,"websocket_error",!0,e);(i=(r=this._eventHandlers).onError)==null||i.call(r,t)}_setState(e){var t,r;this._state!==e&&(this._previousState=this._state,this._state=e,(r=(t=this._eventHandlers).onStateChange)==null||r.call(t,e,this._previousState))}get state(){return this._state}get isConnected(){return this._state===Xt.Connected}updateEventHandlers(e){Object.assign(this._eventHandlers,e)}}var QR;(function(n){n[n.Connecting=0]="Connecting",n[n.Open=1]="Open",n[n.Closing=2]="Closing",n[n.Closed=3]="Closed"})(QR||(QR={}));class e7{constructor(e={}){G(this,"_ws");G(this,"_url");G(this,"_options");G(this,"_onOpen");G(this,"_onClose");G(this,"_onMessage");G(this,"_onError");this._options={connectionTimeoutInMs:3e4,maxMessageSize:1024*1024,...e}}async connect(e,t,r){if(this._ws&&this._ws.readyState!==WebSocket.CLOSED)throw new it("WebSocket is already connected or connecting",gt.AlreadyConnected);return new Promise((i,s)=>{const o=setTimeout(()=>{s(new it(`WebSocket connection timeout after ${this._options.connectionTimeoutInMs}ms`,gt.ConnectionTimeout))},this._options.connectionTimeoutInMs),a=()=>{clearTimeout(o),this._ws&&this._ws.close(),s(new it("WebSocket connection aborted",gt.OperationCancelled))};if(r){if(r.aborted){a();return}r.addEventListener("abort",a)}try{const l=this._addHeadersToUrl(e,this._options.headers);this._ws=new WebSocket(l,t),this._ws.binaryType="arraybuffer",this._url=e,this._ws.addEventListener("open",()=>{var u;clearTimeout(o),r&&r.removeEventListener("abort",a),(u=this._onOpen)==null||u.call(this),i()}),this._ws.addEventListener("close",u=>{var p;clearTimeout(o),r&&r.removeEventListener("abort",a),(p=this._onClose)==null||p.call(this,u.code,u.reason)}),this._ws.addEventListener("message",u=>{var p,f;if(typeof u.data=="string")(p=this._onMessage)==null||p.call(this,u.data);else if(u.data instanceof ArrayBuffer)(f=this._onMessage)==null||f.call(this,u.data);else if(u.data instanceof Blob){const g=new FileReader;g.onload=()=>{var m;g.result instanceof ArrayBuffer&&((m=this._onMessage)==null||m.call(this,g.result))},g.onerror=()=>{var m;(m=this._onError)==null||m.call(this,new it("Failed to read blob data",gt.WebSocketError,"blob_read"))},g.readAsArrayBuffer(u.data)}}),this._ws.addEventListener("error",()=>{var p;clearTimeout(o),r&&r.removeEventListener("abort",a);const u=new it("WebSocket connection failed",gt.WebSocketError,"websocket_connection",!0);(p=this._onError)==null||p.call(this,u),s(u)})}catch(l){clearTimeout(o),r&&r.removeEventListener("abort",a),s(new it(`Failed to create WebSocket: ${l instanceof Error?l.message:"Unknown error"}`,gt.ConnectionFailed,"websocket_creation",!1,l instanceof Error?l:new Error(String(l))))}})}async disconnect(e=1e3,t){if(!(!this._ws||this._ws.readyState===WebSocket.CLOSED))return new Promise(r=>{const i=()=>{r()};this._ws.readyState===WebSocket.CLOSING?this._ws.addEventListener("close",i,{once:!0}):(this._ws.addEventListener("close",i,{once:!0}),this._ws.close(e,t))})}async send(e,t){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)throw new it("WebSocket is not connected",gt.NotConnected);if(t!=null&&t.aborted)throw new it("Send operation aborted",gt.OperationCancelled);return new Promise((r,i)=>{const s=()=>{i(new it("Send operation aborted",gt.OperationCancelled))};t&&t.addEventListener("abort",s,{once:!0});try{this._ws.send(e),t&&t.removeEventListener("abort",s),r()}catch(o){t&&t.removeEventListener("abort",s),i(new it(`Failed to send WebSocket message: ${o instanceof Error?o.message:"Unknown error"}`,gt.WebSocketError,"message_send",!0,o instanceof Error?o:new Error(String(o))))}})}onOpen(e){this._onOpen=e}onClose(e){this._onClose=e}onMessage(e){this._onMessage=e}onError(e){this._onError=e}get isConnected(){var e;return((e=this._ws)==null?void 0:e.readyState)===WebSocket.OPEN}get readyState(){return this._ws?this._ws.readyState:QR.Closed}get url(){return this._url}_addHeadersToUrl(e,t){if(!t||Object.keys(t).length===0)return e;const r=new URL(e);for(const[i,s]of Object.entries(t)){const o=i.toLowerCase();if(o==="authorization")r.searchParams.set("authorization",s);else if(o==="api-key")r.searchParams.set("api-key",s);else if(o==="x-ms-client-request-id")r.searchParams.set("client-request-id",s);else{if(o==="user-agent")continue;r.searchParams.set(`h-${o}`,s)}}return r.toString()}}class t7{create(e){return new e7(e)}}class n7{parseIncomingMessage(e){try{let t;e instanceof ArrayBuffer?t=new TextDecoder().decode(e):t=e;const r=JSON.parse(t);return this._isServerEvent(r)?{type:"server",event:ZH(r),raw:e}:this._isClientEvent(r)?{type:"client",event:r,raw:e}:null}catch(t){return Ze.error("Failed to parse incoming message:",t),{type:"server",event:{type:em.Error,error:{type:"error",code:"MessageParsingError",message:"Failed to parse incoming message data. "+(t instanceof Error?t.message:String(t))}},raw:e}}}serializeOutgoingMessage(e){return JSON.stringify(XU(e))}_isServerEvent(e){return e&&typeof e.type=="string"&&this._isValidServerEventType(e.type)}_isClientEvent(e){return e&&typeof e.type=="string"&&this._isValidClientEventType(e.type)}_isValidServerEventType(e){return Object.values(em).includes(e)}_isValidClientEventType(e){return Object.values(co).includes(e)}}function r7(n){return"key"in n&&typeof n.key=="string"}class i7{constructor(e,t){G(this,"_accessToken");G(this,"_scope");G(this,"_tokenRefreshBuffer",300*1e3);G(this,"_credential");G(this,"_isApiKey");this._credential=e,this._isApiKey=r7(e),this._scope=t||"https://cognitiveservices.azure.com/.default",Ze.info("CredentialHandler initialized",{credentialType:this._isApiKey?"KeyCredential":"TokenCredential",scope:this._scope})}async getAccessToken(){if(this._isApiKey){const t=this._credential;return Ze.info("Using API key for authentication"),t.key}const e=this._credential;if(this._accessToken&&this._isTokenValid(this._accessToken))return this._accessToken.token;try{Ze.info("Acquiring new access token",{scope:this._scope});const t=await e.getToken(this._scope);if(!t)throw new Pv("Failed to acquire access token - credential returned null",gt.AuthenticationFailed);return this._accessToken=t,Ze.info("Successfully acquired access token",{expiresAt:new Date(this._accessToken.expiresOnTimestamp)}),this._accessToken.token}catch(t){throw Ze.error("Failed to obtain access token",{error:t,scope:this._scope}),t instanceof Pv?t:new Pv(`Failed to obtain access token: ${t instanceof Error?t.message:"Unknown error"}`,gt.AuthenticationFailed,t instanceof Error?t:new Error(String(t)))}}async getWebSocketUrl(e,t,r){const i=await this.getAccessToken(),s=new URL(e);return s.protocol=s.protocol==="https:"?"wss:":"ws:",s.pathname="/voice-live/realtime",s.searchParams.set("api-version",t),r&&s.searchParams.set("model",r),this._isApiKey&&s.searchParams.set("api-key",i),s.toString()}async getAuthHeaders(){const e=await this.getAccessToken(),t={"X-MS-Client-Request-ID":this._generateRequestId(),"User-Agent":"Azure-Voice-Live-SDK-JS/1.0.0"};return this._isApiKey?t["api-key"]=e:t.Authorization=`Bearer ${e}`,t}get credentialType(){return this._isApiKey?"key":"token"}get isApiKey(){return this._isApiKey}updateApiKey(e){if(!this._isApiKey)throw new Pv("Cannot update API key on TokenCredential",gt.InvalidCredentials);const t=this._credential;if("update"in t&&typeof t.update=="function")t.update(e),Ze.info("API key updated");else throw new Pv("KeyCredential does not support key updates",gt.InvalidCredentials)}_isTokenValid(e){const t=e.expiresOnTimestamp,r=Date.now();return t>r+this._tokenRefreshBuffer}_generateRequestId(){return`${Date.now()}-${Math.random().toString(36).substring(2,11)}`}}class s7{constructor(e,t){G(this,"_isActive",!0);G(this,"_handlers");G(this,"_subscriptionId");this._handlers=e,this._subscriptionId=t}get isActive(){return this._isActive}get subscriptionId(){return this._subscriptionId}async close(){this._isActive&&(this._isActive=!1,Ze.info("VoiceLive subscription closed",{subscriptionId:this._subscriptionId}))}async processConnectionEvent(e,t,r){var i,s,o,a,l,u;if(this._isActive)try{switch(e){case"connected":await((s=(i=this._handlers).onConnected)==null?void 0:s.call(i,t,r));break;case"disconnected":await((a=(o=this._handlers).onDisconnected)==null?void 0:a.call(o,t,r));break;case"error":await((u=(l=this._handlers).onError)==null?void 0:u.call(l,t,r));break}}catch(p){Ze.error(`Error in ${e} handler`,{error:p,subscriptionId:this._subscriptionId})}}async processServerEvent(e,t){var r,i,s,o,a,l,u,p,f,g,m,C,S,w,b,R,P,I,M,k,O,L,F,H,V,ie,J,ee,se,ne,Q,K,oe,B,j,$,pe,ge,ye,re,te,ae,ve,_e,Ce,Ke,he,$e,Ge,Ve,st,xn,Yn,oi,Tr,is,ss,os,as,ce,Ye,vt,Qn,cs,ls,_u,Cc,bc,ku,Yo,Qo,Zo;if(this._isActive)try{switch(await((i=(r=this._handlers).onServerEvent)==null?void 0:i.call(r,e,t)),e.type){case"session.created":await((o=(s=this._handlers).onSessionCreated)==null?void 0:o.call(s,e,t));break;case"session.updated":await((l=(a=this._handlers).onSessionUpdated)==null?void 0:l.call(a,e,t));break;case"session.avatar.connecting":await((p=(u=this._handlers).onSessionAvatarConnecting)==null?void 0:p.call(u,e,t));break;case"input_audio_buffer.committed":await((g=(f=this._handlers).onInputAudioBufferCommitted)==null?void 0:g.call(f,e,t));break;case"input_audio_buffer.cleared":await((C=(m=this._handlers).onInputAudioBufferCleared)==null?void 0:C.call(m,e,t));break;case"input_audio_buffer.speech_started":await((w=(S=this._handlers).onInputAudioBufferSpeechStarted)==null?void 0:w.call(S,e,t));break;case"input_audio_buffer.speech_stopped":await((R=(b=this._handlers).onInputAudioBufferSpeechStopped)==null?void 0:R.call(b,e,t));break;case"conversation.item.created":await((I=(P=this._handlers).onConversationItemCreated)==null?void 0:I.call(P,e,t));break;case"conversation.item.input_audio_transcription.completed":await((k=(M=this._handlers).onConversationItemInputAudioTranscriptionCompleted)==null?void 0:k.call(M,e,t));break;case"conversation.item.input_audio_transcription.failed":await((L=(O=this._handlers).onConversationItemInputAudioTranscriptionFailed)==null?void 0:L.call(O,e,t));break;case"conversation.item.input_audio_transcription.delta":await((H=(F=this._handlers).onConversationItemInputAudioTranscriptionDelta)==null?void 0:H.call(F,e,t));break;case"conversation.item.truncated":await((ie=(V=this._handlers).onConversationItemTruncated)==null?void 0:ie.call(V,e,t));break;case"conversation.item.deleted":await((ee=(J=this._handlers).onConversationItemDeleted)==null?void 0:ee.call(J,e,t));break;case"conversation.item.retrieved":await((ne=(se=this._handlers).onConversationItemRetrieved)==null?void 0:ne.call(se,e,t));break;case"response.created":await((K=(Q=this._handlers).onResponseCreated)==null?void 0:K.call(Q,e,t));break;case"response.done":await((B=(oe=this._handlers).onResponseDone)==null?void 0:B.call(oe,e,t));break;case"response.output_item.added":await(($=(j=this._handlers).onResponseOutputItemAdded)==null?void 0:$.call(j,e,t));break;case"response.output_item.done":await((ge=(pe=this._handlers).onResponseOutputItemDone)==null?void 0:ge.call(pe,e,t));break;case"response.content_part.added":await((re=(ye=this._handlers).onResponseContentPartAdded)==null?void 0:re.call(ye,e,t));break;case"response.content_part.done":await((ae=(te=this._handlers).onResponseContentPartDone)==null?void 0:ae.call(te,e,t));break;case"response.text.delta":await((_e=(ve=this._handlers).onResponseTextDelta)==null?void 0:_e.call(ve,e,t));break;case"response.text.done":await((Ke=(Ce=this._handlers).onResponseTextDone)==null?void 0:Ke.call(Ce,e,t));break;case"response.audio.delta":await(($e=(he=this._handlers).onResponseAudioDelta)==null?void 0:$e.call(he,e,t));break;case"response.audio.done":await((Ve=(Ge=this._handlers).onResponseAudioDone)==null?void 0:Ve.call(Ge,e,t));break;case"response.audio_transcript.delta":await((xn=(st=this._handlers).onResponseAudioTranscriptDelta)==null?void 0:xn.call(st,e,t));break;case"response.audio_transcript.done":await((oi=(Yn=this._handlers).onResponseAudioTranscriptDone)==null?void 0:oi.call(Yn,e,t));break;case"response.animation_blendshapes.delta":await((is=(Tr=this._handlers).onResponseAnimationBlendshapeDelta)==null?void 0:is.call(Tr,e,t));break;case"response.animation_blendshapes.done":await((os=(ss=this._handlers).onResponseAnimationBlendshapeDone)==null?void 0:os.call(ss,e,t));break;case"response.animation_viseme.delta":await((ce=(as=this._handlers).onResponseAnimationVisemeDelta)==null?void 0:ce.call(as,e,t));break;case"response.animation_viseme.done":await((vt=(Ye=this._handlers).onResponseAnimationVisemeDone)==null?void 0:vt.call(Ye,e,t));break;case"response.audio_timestamp.delta":await((cs=(Qn=this._handlers).onResponseAudioTimestampDelta)==null?void 0:cs.call(Qn,e,t));break;case"response.audio_timestamp.done":await((_u=(ls=this._handlers).onResponseAudioTimestampDone)==null?void 0:_u.call(ls,e,t));break;case"response.function_call_arguments.delta":await((bc=(Cc=this._handlers).onResponseFunctionCallArgumentsDelta)==null?void 0:bc.call(Cc,e,t));break;case"response.function_call_arguments.done":await((Yo=(ku=this._handlers).onResponseFunctionCallArgumentsDone)==null?void 0:Yo.call(ku,e,t));break;case"error":await((Zo=(Qo=this._handlers).onServerError)==null?void 0:Zo.call(Qo,e,t));break}}catch(wc){Ze.error(`Error in server event handler for ${e.type}`,{error:wc,eventType:e.type,subscriptionId:this._subscriptionId})}}}class o7{constructor(){G(this,"_subscriptions",new Map);G(this,"_nextSubscriptionId",1)}createSubscription(e){const t=`sub_${this._nextSubscriptionId++}`,r=new s7(e,t);return this._subscriptions.set(t,r),Ze.info("VoiceLive subscription created",{subscriptionId:t}),r}removeSubscription(e){this._subscriptions.delete(e),Ze.info("VoiceLive subscription removed",{subscriptionId:e})}async processConnectionEvent(e,t,r){const i=Array.from(this._subscriptions.values()).filter(s=>s.isActive);await Promise.allSettled(i.map(s=>s.processConnectionEvent(e,t,r)))}async processServerEvent(e,t){const r=Array.from(this._subscriptions.values()).filter(i=>i.isActive);await Promise.allSettled(r.map(i=>i.processServerEvent(e,t)))}async closeAll(){const e=Array.from(this._subscriptions.values());await Promise.allSettled(e.map(t=>t.close())),this._subscriptions.clear()}get activeCount(){return Array.from(this._subscriptions.values()).filter(e=>e.isActive).length}}class a7{constructor(e,t,r,i,s={}){G(this,"_endpoint");G(this,"_credentialHandler");G(this,"_options");G(this,"_messageParser");G(this,"_model");G(this,"_apiVersion");G(this,"_connectionManager");G(this,"_sessionId");G(this,"_activeTurnId");G(this,"_disposed",!1);G(this,"_subscriptionManager");this._endpoint=this._normalizeEndpoint(e),this._credentialHandler=new i7(t),this._options=this._buildDefaultOptions(s),this._messageParser=new n7,this._model=i,this._apiVersion=r,this._subscriptionManager=new o7,Ze.info("VoiceLiveSession created",{endpoint:this._endpoint,model:this._model,apiVersion:r,enableDebugLogging:this._options.enableDebugLogging})}async connect(e={}){if(this._ensureNotDisposed(),this.isConnected){Ze.info("VoiceLiveSession already connected");return}try{Ze.info("Connecting to Voice Live service",{endpoint:this._endpoint,model:this._model});const t=await this._credentialHandler.getWebSocketUrl(this._endpoint,this._apiVersion,this._model),r=await this._credentialHandler.getAuthHeaders(),i=new t7;this._connectionManager=new ZW(()=>i.create({headers:{...r},connectionTimeoutInMs:this._options.connectionTimeoutInMs,compression:!0}),{endpoint:t,connectionTimeout:e.timeoutInMs||this._options.connectionTimeoutInMs}),this._setupConnectionEventHandlers(),await this._connectionManager.connect(e.abortSignal),Ze.info("Successfully connected to Voice Live service")}catch(t){throw Ze.error("Failed to connect to Voice Live service",{error:t}),t instanceof it?t:uN(t)}}async disconnect(){if(this._connectionManager){Ze.info("Disconnecting from Voice Live service");try{await this._connectionManager.disconnect()}catch(e){Ze.error("Error during disconnect",{error:e})}finally{this._connectionManager=void 0,this._sessionId=void 0,this._activeTurnId=void 0,Ze.info("Disconnected from Voice Live service")}}}subscribe(e){return this._ensureNotDisposed(),Ze.info("Creating VoiceLive session subscription"),this._subscriptionManager.createSubscription(e)}async sendEvent(e,t={}){this._ensureConnected(),await this._sendEvent(e,t)}async updateSession(e,t={}){this._ensureConnected();const r={type:co.SessionUpdate,session:e,eventId:this._generateEventId()};await this._sendEvent(r,t)}async sendAudio(e,t={}){this._ensureConnected();const r=this._arrayBufferToBase64(e);if(t.turnId){const i={type:co.InputAudioTurnAppend,audio:r,turnId:t.turnId,eventId:this._generateEventId()};await this._sendEvent(i,t)}else{const i={type:co.InputAudioBufferAppend,audio:r,eventId:this._generateEventId()};await this._sendEvent(i,t)}}async startAudioTurn(e={}){this._ensureConnected();const t=e.turnId||this._generateTurnId();this._activeTurnId=t;const r={type:co.InputAudioTurnStart,turnId:t,eventId:this._generateEventId()};return await this._sendEvent(r,e),t}async endAudioTurn(e,t={}){this._ensureConnected();const r=e||this._activeTurnId;if(!r)throw new it("No active audio turn to end","INVALID_STATE");const i={type:co.InputAudioTurnEnd,turnId:r,eventId:this._generateEventId()};await this._sendEvent(i,t),r===this._activeTurnId&&(this._activeTurnId=void 0)}async addConversationItem(e,t={}){this._ensureConnected();const r={type:co.ConversationItemCreate,item:e,eventId:this._generateEventId()};await this._sendEvent(r,t)}get isConnected(){var e;return((e=this._connectionManager)==null?void 0:e.isConnected)||!1}get connectionState(){var e;return((e=this._connectionManager)==null?void 0:e.state)||Xt.Disconnected}get sessionId(){return this._sessionId}get activeTurnId(){return this._activeTurnId}async dispose(){if(!this._disposed){Ze.info("Disposing VoiceLiveSession");try{await this._subscriptionManager.closeAll(),await this.disconnect()}catch(e){Ze.error("Error during session disposal",{error:e})}finally{this._disposed=!0,Ze.info("VoiceLiveSession disposed")}}}_buildDefaultOptions(e){return{connectionTimeoutInMs:e.connectionTimeoutInMs||3e4,enableDebugLogging:e.enableDebugLogging??!1}}_normalizeEndpoint(e){return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`https://${e}`),e.replace(/\/$/,"")}_setupConnectionEventHandlers(){this._connectionManager&&this._connectionManager.updateEventHandlers({onStateChange:(e,t)=>{Ze.info("Connection state changed",{state:e,previousState:t}),e===Xt.Connected&&t===Xt.Connecting?this._notifyConnectionEvent("connected",{connectionId:`conn_${Date.now()}`,timestamp:new Date}):e===Xt.Disconnected&&t===Xt.Connected&&(this._notifyConnectionEvent("disconnected",{code:1006,reason:"Connection lost during session",wasClean:!1,timestamp:new Date}),this._markSessionAsDead("Connection lost during session - session is permanently unusable"))},onMessage:e=>{this._handleIncomingMessage(e)},onError:e=>{Ze.error("Connection error - marking session as dead",{error:e}),this._notifyConnectionEvent("error",{error:e,context:"WebSocket connection error",recoverable:!1,timestamp:new Date}),this._markSessionAsDead(`Connection error: ${e.message}`)}})}_markSessionAsDead(e){this._disposed||(Ze.error("Session marked as permanently dead",{reason:e}),this._disposed=!0,this._connectionManager=void 0,this._sessionId=void 0,this._activeTurnId=void 0)}_handleIncomingMessage(e){try{Ze.info("Message received",{type:typeof e,size:typeof e=="string"?e.length:e.byteLength});const t=this._messageParser.parseIncomingMessage(e);t&&t.type==="server"&&this._handleServerEvent(t.event)}catch(t){Ze.error("Error handling incoming message",{error:t})}}_handleServerEvent(e){var t;e.type===em.SessionCreated&&((t=e.session)!=null&&t.id)&&(this._sessionId=e.session.id,Ze.info("Session created",{sessionId:this._sessionId})),this._notifyServerEvent(e)}_notifyConnectionEvent(e,t){const r={endpoint:this._endpoint,sessionId:this._sessionId,timestamp:new Date,model:this._model};this._subscriptionManager.processConnectionEvent(e,t,r).catch(i=>{Ze.error("Error processing connection event in handlers",{eventType:e,error:i})})}_notifyServerEvent(e){if(!this._sessionId)return;const t={endpoint:this._endpoint,sessionId:this._sessionId,timestamp:new Date,model:this._model,conversationId:void 0};this._subscriptionManager.processServerEvent(e,t).catch(r=>{Ze.error("Error processing server event in handlers",{eventType:e.type,error:r})})}async _sendEvent(e,t){var r;if(!((r=this._connectionManager)!=null&&r.isConnected))throw new it("Not connected to Voice Live service","NOT_CONNECTED");try{const i=this._messageParser.serializeOutgoingMessage(e);await this._connectionManager.send(i,t.abortSignal),Ze.info("Sent event",{type:e.type,eventId:e.eventId})}catch(i){throw i instanceof it?i:uN(i)}}_ensureConnected(){if(this._ensureNotDisposed(),!this.isConnected)throw new it("Must be connected to Voice Live service","NOT_CONNECTED")}_ensureNotDisposed(){if(this._disposed)throw new it("Session is permanently dead and cannot be used. Create a new session to continue.","SESSION_DEAD")}_generateEventId(){return`evt_${Date.now()}_${Math.random().toString(36).substring(2,11)}`}_generateTurnId(){return`turn_${Date.now()}_${Math.random().toString(36).substring(2,11)}`}_arrayBufferToBase64(e){const t=e instanceof ArrayBuffer?new Uint8Array(e):e;let r="";for(let i=0;i<t.byteLength;i++)r+=String.fromCharCode(t[i]);return btoa(r)}}class ej{constructor(e,t,r={}){G(this,"_endpoint");G(this,"_credential");G(this,"_options");this._endpoint=this._normalizeEndpoint(e),this._credential=t,this._options=this._buildDefaultOptions(r),Ze.info("VoiceLiveClient created",{endpoint:this._endpoint,apiVersion:this._options.apiVersion})}createSession(e,t){const r=typeof e=="string"?e:e.model;if(!r)throw new Error("Model name is required. Provide either a model string or RequestSession with model property.");const i={...this._options.defaultSessionOptions,...t},s=new a7(this._endpoint,this._credential,this._options.apiVersion,r,i);return typeof e!="string"&&(s._initialSessionConfig=e),Ze.info("VoiceLiveSession created",{model:r}),s}async startSession(e,t){const r=this.createSession(e,t);return await r.connect(),typeof e!="string"&&await r.updateSession(e),r}get endpoint(){return this._endpoint}get apiVersion(){return this._options.apiVersion}_buildDefaultOptions(e){return{apiVersion:e.apiVersion||"2025-10-01",defaultSessionOptions:e.defaultSessionOptions||{}}}_normalizeEndpoint(e){return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`https://${e}`),e.replace(/\/$/,"")}}class tj{constructor(){G(this,"audioContext");G(this,"nextStartTime",0);G(this,"sources",[]);this.audioContext=new AudioContext}async resume(){this.audioContext.state!=="running"&&await this.audioContext.resume()}enqueuePcm16(e,t=16e3){const r=BU(e),i=this.audioContext.createBuffer(1,r.length,t);i.getChannelData(0).set(r);const s=this.audioContext.createBufferSource();s.buffer=i,s.connect(this.audioContext.destination);const o=this.audioContext.currentTime;this.nextStartTime<o&&(this.nextStartTime=o);const a=this.nextStartTime;this.nextStartTime+=i.duration,s.onended=()=>{this.sources=this.sources.filter(l=>l!==s)},this.sources.push(s),s.start(a)}stop(){for(const e of this.sources)try{e.stop()}catch{}this.sources=[],this.nextStartTime=0}}const c7={turns:0,sessionStartMs:0,inputAudioSeconds:0,cachedAudioSeconds:0,outputAudioSeconds:0,inputTextTokens:0,cachedTextTokens:0,outputTextTokens:0,inputAudioTokens:0,cachedAudioTokens:0,outputAudioTokens:0,startLatencies:[],endLatencies:[]};function l7(n,e){const t=n.inputAudioTokens+e.inputTokenDetails.audioTokens,r=n.outputAudioTokens+e.outputTokenDetails.audioTokens;return{...n,inputTextTokens:n.inputTextTokens+e.inputTokenDetails.textTokens,inputAudioTokens:t,inputAudioSeconds:t/10,cachedTextTokens:n.cachedTextTokens+e.inputTokenDetails.cachedTokensDetails.textTokens,cachedAudioTokens:n.cachedAudioTokens+e.inputTokenDetails.cachedTokensDetails.audioTokens,outputTextTokens:n.outputTextTokens+e.outputTokenDetails.textTokens,outputAudioTokens:r,outputAudioSeconds:r/20}}function u7(n,e){if(n.length===0)return 0;const t=[...n].sort((i,s)=>i-s),r=Math.ceil(e/100*t.length)-1;return t[Math.max(0,r)]}function yN(n){return n.length===0?0:n.reduce((e,t)=>e+t,0)/n.length}const d7={pro:{text:{inputText:5.5,cachedText:2.75,outputText:22,inputAudio:17,cachedAudio:2.75,outputAudio:38},"azure-standard":{inputText:5.5,cachedText:2.75,outputText:22,inputAudio:17,cachedAudio:2.75,outputAudio:38},"native-audio":{inputText:5.5,cachedText:2.75,outputText:22,inputAudio:44,cachedAudio:2.75,outputAudio:88}},standard:{text:{inputText:.66,cachedText:.33,outputText:2.64,inputAudio:15,cachedAudio:.33,outputAudio:33},"azure-standard":{inputText:.66,cachedText:.33,outputText:2.64,inputAudio:15,cachedAudio:.33,outputAudio:33},"native-audio":{inputText:.66,cachedText:.33,outputText:2.64,inputAudio:11,cachedAudio:.33,outputAudio:22}},lite:{text:{inputText:.11,cachedText:.04,outputText:.44,inputAudio:15,cachedAudio:.04,outputAudio:33},"azure-standard":{inputText:.11,cachedText:.04,outputText:.44,inputAudio:15,cachedAudio:.04,outputAudio:33},"native-audio":{inputText:.11,cachedText:.04,outputText:.44,inputAudio:4,cachedAudio:.04,outputAudio:8}}};function h7(n,e="standard",t="azure-standard"){const r=t==="openai"?"native-audio":"azure-standard",i=d7[e][r],s=n.inputTextTokens/1e6*i.inputText,o=n.cachedTextTokens/1e6*i.cachedText,a=n.outputTextTokens/1e6*i.outputText,l=n.inputAudioTokens/1e6*i.inputAudio,u=n.cachedAudioTokens/1e6*i.cachedAudio,p=n.outputAudioTokens/1e6*i.outputAudio;return s+o+a+l+u+p}class p7{constructor(e){G(this,"client");G(this,"session");G(this,"subscription");G(this,"state",{isConnected:!1,isMicOn:!1,logs:[],turns:[],totals:c7});G(this,"turnMap",new Map);G(this,"pcmPlayer",new tj);G(this,"outputSampleRateHz",24e3);G(this,"currentSpeechStartMs",0);G(this,"currentSpeechStopMs",0);G(this,"events");this.events=e}get snapshot(){return this.state}setState(e){this.state={...this.state,...e},this.events.onState(this.state)}log(e,t){const r={id:`${Date.now()}_${Math.random().toString(16).slice(2)}`,ts:Date.now(),level:e,text:t},i=[...this.state.logs,r].slice(-2e3);this.setState({logs:i})}async connect(e){if(this.state.isConnected)return;if(!e.endpoint.trim())throw new Error("Missing endpoint");if(!e.apiKey.trim())throw new Error("Missing API key");this.log("info","Connecting"),this.client=new ej(e.endpoint.trim(),new qL(e.apiKey.trim()),{apiVersion:"2025-10-01",defaultSessionOptions:{enableDebugLogging:!1}});const t=jD(e);this.outputSampleRateHz=zD(t.outputAudioFormat),this.session=await this.client.startSession(t,{connectionTimeoutInMs:3e4}),await this.pcmPlayer.resume();const r={onConnected:async(i,s)=>{console.log("[VoiceLive Event] onConnected",{args:i,context:s}),this.log("info",`Connected (sessionId=${s.sessionId??"n/a"})`)},onDisconnected:async i=>{console.log("[VoiceLive Event] onDisconnected",i),this.log("info",`Disconnected (code=${i.code} reason=${i.reason})`)},onServerError:async i=>{console.log("[VoiceLive Event] onServerError",i),this.log("error",`Server error: ${i.error.message}`)},onConversationItemInputAudioTranscriptionDelta:async i=>{console.log("[VoiceLive Event] onConversationItemInputAudioTranscriptionDelta",i),i.delta&&this.log("input",i.delta)},onConversationItemInputAudioTranscriptionCompleted:async i=>{console.log("[VoiceLive Event] onConversationItemInputAudioTranscriptionCompleted",i),this.log("input",` ${i.transcript}`)},onInputAudioBufferSpeechStarted:async()=>{console.log("[VoiceLive Event] onInputAudioBufferSpeechStarted"),this.currentSpeechStartMs=Date.now(),this.log("info","Speech detected")},onInputAudioBufferSpeechStopped:async()=>{console.log("[VoiceLive Event] onInputAudioBufferSpeechStopped"),this.currentSpeechStopMs=Date.now(),this.log("info","Speech stopped")},onResponseCreated:async i=>{console.log("[VoiceLive Event] onResponseCreated",i);const s=i.response.id??`resp_${Date.now()}`,o={responseId:s,startedAtMs:Date.now(),speechStartedAtMs:this.currentSpeechStartMs,speechStoppedAtMs:this.currentSpeechStopMs};this.turnMap.set(s,{metrics:o,textBuffer:""}),this.log("info",`Response created (${s})`)},onResponseTextDelta:async i=>{console.log("[VoiceLive Event] onResponseTextDelta",i);const s=this.turnMap.get(i.responseId);s&&(s.metrics.firstTextDeltaAtMs||(s.metrics.firstTextDeltaAtMs=Date.now(),s.metrics.firstTokenLatencyMs=s.metrics.firstTextDeltaAtMs-s.metrics.startedAtMs),s.textBuffer+=i.delta,this.turnMap.set(i.responseId,s),this.events.onState(this.state))},onResponseTextDone:async i=>{console.log("[VoiceLive Event] onResponseTextDone",i);const s=i.responseId,o=this.turnMap.get(s),a=(i.text??"").trim();a&&(o&&(o.textBuffer=a,o.ttsLogged=!0,this.turnMap.set(s,o)),this.log("output",` ${a}`))},onResponseAudioDelta:async i=>{console.log("[VoiceLive Event] onResponseAudioDelta",{...i,delta:i.delta instanceof Uint8Array?`Uint8Array(${i.delta.length})`:i.delta});const s=i.delta;if(s instanceof Uint8Array){const o=this.turnMap.get(i.responseId);if(o&&!o.metrics.firstAudioDeltaAtMs){const a=Date.now();o.metrics.firstAudioDeltaAtMs=a,o.metrics.speechStartedAtMs&&(o.metrics.startLatencyMs=a-o.metrics.speechStartedAtMs),o.metrics.speechStoppedAtMs&&(o.metrics.endLatencyMs=a-o.metrics.speechStoppedAtMs),this.turnMap.set(i.responseId,o)}this.pcmPlayer.enqueuePcm16(s,this.outputSampleRateHz)}},onResponseDone:async i=>{console.log("[VoiceLive Event] onResponseDone",i);const s=i.response.id??"unknown",o=this.turnMap.get(s),a=Date.now();if(o){o.metrics.finishedAtMs=a,o.metrics.latencyMs=a-o.metrics.startedAtMs,o.metrics.assistantText=o.textBuffer.trim(),o.metrics.usage=i.response.usage;const l=[...this.state.turns,o.metrics];let u={...this.state.totals};if(u.turns=u.turns+1,o.metrics.startLatencyMs&&(u.startLatencies=[...u.startLatencies,o.metrics.startLatencyMs]),o.metrics.endLatencyMs&&(u.endLatencies=[...u.endLatencies,o.metrics.endLatencyMs]),i.response.usage&&(u=l7(u,i.response.usage),u.cachedAudioSeconds=u.cachedAudioTokens/10),this.setState({turns:l,totals:u}),this.log("info",`Turn latency: ${o.metrics.latencyMs??0}ms; first-token: ${o.metrics.firstTokenLatencyMs??0}ms`),!o.ttsLogged){let p="(no text)";if(i.response.output&&i.response.output.length>0){const f=i.response.output[0];if(f!=null&&f.content&&Array.isArray(f.content)){const g=f.content.find(m=>m.type==="audio"&&m.transcript);g!=null&&g.transcript&&(p=g.transcript)}}this.log("output",` ${p}`)}i.response.usage&&this.log("info",`Usage: in=${i.response.usage.inputTokens} out=${i.response.usage.outputTokens} total=${i.response.usage.totalTokens}`)}else this.log("info",`Response done (${s})`);this.turnMap.delete(s)},onError:async i=>{console.log("[VoiceLive Event] onError",i),this.log("error",`${i.context}: ${i.error.message}`)}};this.subscription=this.session.subscribe(r),await this.session.updateSession(t),this.setState({isConnected:!0,totals:{...this.state.totals,sessionStartMs:Date.now()}}),this.log("info",`Session configured (model=${e.model})`)}async disconnect(){var e,t;this.setState({isMicOn:!1});try{this.pcmPlayer.stop(),await((e=this.subscription)==null?void 0:e.close()),this.subscription=void 0,await((t=this.session)==null?void 0:t.dispose()),this.session=void 0,this.client=void 0}finally{this.turnMap.clear(),this.setState({isConnected:!1}),this.log("info","Disconnected")}}async applyConfig(e){if(!this.session)throw new Error("Not connected");const t=jD(e);this.outputSampleRateHz=zD(t.outputAudioFormat),await this.session.updateSession(t),this.log("info","Session updated")}async sendText(e){if(!this.session)throw new Error("Not connected");const t=e.trim();t&&(this.log("user",t),await this.session.addConversationItem({type:"message",role:"user",content:[{type:"input_text",text:t}]}),await this.session.sendEvent({type:"response.create",response:{modalities:["text","audio"]}}))}async sendMicPcmChunk(e){this.session&&await this.session.sendAudio(e)}}function SN(n){return Number.isFinite(n)?n<1e3?`${n.toFixed(0)}ms`:`${(n/1e3).toFixed(2)}s`:"-"}function f7({endpoint:n,apiKey:e}){var ss,os,as;const[t,r]=W.useState(()=>{var Ye;const ce=localStorage.getItem("voicelive.translator.config");if(!ce){const vt={...dE};return vt.prompt=nd(vt.targetLanguage),vt}try{const vt=JSON.parse(ce),Qn={...dE,...vt};return Qn.prompt=(Ye=Qn.prompt)!=null&&Ye.trim()?Qn.prompt:nd(Qn.targetLanguage),Qn}catch{const vt={...dE};return vt.prompt=nd(vt.targetLanguage),vt}}),[i,s]=W.useState(""),[o,a]=W.useState(!1),[l,u]=W.useState(!1),[p,f]=W.useState([]),[g,m]=W.useState(!1),[C,S]=W.useState(!1),[w,b]=W.useState(()=>0),[R,P]=W.useState(()=>0),[I,M]=W.useState(()=>0),[k,O]=W.useState(()=>0),[L,F]=W.useState(()=>0),[H,V]=W.useState(()=>0),[ie,J]=W.useState(()=>0),[ee,se]=W.useState(()=>0),[ne,Q]=W.useState(()=>0),[K,oe]=W.useState(()=>0),[B,j]=W.useState(()=>0),[$,pe]=W.useState(()=>[]),[ge,ye]=W.useState(()=>[]),re=W.useRef(null),te=W.useRef(null),ae=W.useRef(null),ve=W.useRef(t.targetLanguage);re.current||(re.current=new p7({onState:ce=>{a(ce.isConnected),f(ce.logs),b(ce.totals.turns),P(ce.totals.sessionStartMs),M(ce.totals.inputAudioSeconds),O(ce.totals.inputAudioTokens),F(ce.totals.cachedAudioSeconds),V(ce.totals.cachedAudioTokens),J(ce.totals.outputAudioSeconds),se(ce.totals.outputAudioTokens),Q(ce.totals.inputTextTokens),oe(ce.totals.cachedTextTokens),j(ce.totals.outputTextTokens),pe(ce.totals.startLatencies),ye(ce.totals.endLatencies)}}));const _e=re.current;W.useEffect(()=>{localStorage.setItem("voicelive.translator.config",JSON.stringify(t))},[t]),W.useEffect(()=>()=>{const ce=re.current;ce!=null&&ce.snapshot.isConnected&&(console.log("[VoiceLive Translator] Disconnecting on unmount"),ce.disconnect().catch(console.error))},[]),W.useEffect(()=>{const ce=ve.current;if(ce===t.targetLanguage)return;const Ye=nd(ce);t.prompt.trim()===Ye.trim()&&r(vt=>({...vt,prompt:nd(vt.targetLanguage)})),ve.current=t.targetLanguage},[t.targetLanguage,t.prompt]),W.useEffect(()=>{const ce=ae.current;ce&&(ce.scrollTop=ce.scrollHeight)},[p.length]);const Ce=R>0?(Date.now()-R)/1e3:0,Ke=$.length>0?yN($):0,he=$.length>0?u7($,90):0;ge.length>0&&yN(ge);const $e=W.useMemo(()=>{const ce=LD.find(Ye=>Ye.id===t.model);return!ce||ce.tier==="basic"?"standard":ce.tier},[t.model]),Ge=h7({inputAudioTokens:k,cachedAudioTokens:H,outputAudioTokens:ee,inputTextTokens:ne,cachedTextTokens:K,outputTextTokens:B},$e,t.voiceProvider),Ve=Ce>0?Ge/Ce:0,st=W.useMemo(()=>g?p:p.filter(ce=>ce.level!=="info"),[p,g]),xn=W.useMemo(()=>{var Ye;const ce={};for(const vt of LD)ce[Ye=vt.tier]??(ce[Ye]=[]),ce[vt.tier].push(vt.id);return ce},[]);async function Yn(){s("Connecting");try{await _e.connect({...t,endpoint:n,apiKey:e}),s("Connected"),await Tr()}catch(ce){s(ce instanceof Error?ce.message:String(ce))}}async function oi(){s("Disconnecting");try{await is(),await _e.disconnect(),s("Disconnected")}catch(ce){s(ce instanceof Error?ce.message:String(ce))}}async function Tr(){if(!l){if(!_e.snapshot.isConnected){s("Connect first");return}te.current=new UU({sampleRate:16e3,bufferSize:4096},{onChunk:ce=>{_e.sendMicPcmChunk(ce)},onState:(ce,Ye)=>{ce==="started"&&u(!0),ce==="stopped"&&u(!1),ce==="error"&&s(Ye??"Mic error")}}),await te.current.start()}}async function is(){if(!te.current){u(!1);return}await te.current.stop(),te.current=null,u(!1)}return A.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[A.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[A.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 shadow-md",children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("div",{children:[A.jsx("h1",{className:"text-3xl font-bold",children:"Voice Live Translator"}),A.jsx("p",{className:"text-blue-100 mt-1",children:"Real-time voice translation powered by Azure Voice Live"})]}),A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${o?"bg-green-500/20 text-green-100":"bg-white/20 text-white/80"}`,children:[A.jsx("span",{className:`w-2 h-2 rounded-full ${o?"bg-green-400":"bg-white/60"}`}),o?"Connected":"Disconnected"]}),l&&A.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium bg-red-500/20 text-red-100",children:[A.jsx("span",{className:"w-2 h-2 rounded-full bg-red-400 animate-pulse"}),"Recording"]})]})]})}),A.jsx("div",{className:"bg-white border-b border-gray-200 p-4",children:A.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3",children:[A.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[A.jsx("p",{className:"text-xs text-gray-500",children:"Turns"}),A.jsx("p",{className:"text-sm font-semibold text-gray-900",children:w})]}),A.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[A.jsx("p",{className:"text-xs text-gray-500",children:"Session"}),A.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[Ce.toFixed(1),"s"]})]}),A.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[A.jsx("p",{className:"text-xs text-gray-500",children:"Cost"}),A.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["$",Ge.toFixed(4)]})]}),A.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[A.jsx("p",{className:"text-xs text-gray-500",children:"Cost/sec"}),A.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["$",Ve.toFixed(5)]})]}),A.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[A.jsx("p",{className:"text-xs text-gray-500",children:"Avg Latency"}),A.jsx("p",{className:"text-sm font-semibold text-gray-900",children:SN(Ke)})]}),A.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[A.jsx("p",{className:"text-xs text-gray-500",children:"P90 Latency"}),A.jsx("p",{className:"text-sm font-semibold text-gray-900",children:SN(he)})]}),A.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[A.jsx("p",{className:"text-xs text-gray-500",children:"Input Audio"}),A.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[I.toFixed(1),"s"]})]}),A.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[A.jsx("p",{className:"text-xs text-gray-500",children:"Output Audio"}),A.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[ie.toFixed(1),"s"]})]})]})}),A.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden p-4",children:[A.jsxs("div",{className:"flex items-center justify-between mb-2",children:[A.jsx("h2",{className:"font-medium text-gray-900",children:"Conversation Log"}),A.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[A.jsx("input",{type:"checkbox",checked:g,onChange:ce=>m(ce.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Show INFO"]})]}),A.jsxs("div",{ref:ae,className:"flex-1 overflow-y-auto bg-gray-900 rounded-lg p-4 font-mono text-sm",children:[st.map(ce=>A.jsxs("div",{className:"flex gap-2 py-0.5",children:[A.jsx("span",{className:"text-gray-500 shrink-0",children:new Date(ce.ts).toLocaleTimeString()}),A.jsx("span",{className:`shrink-0 w-14 ${ce.level==="error"?"text-red-400":ce.level==="input"?"text-blue-400":ce.level==="output"?"text-green-400":ce.level==="user"?"text-yellow-400":"text-gray-400"}`,children:ce.level.toUpperCase()}),A.jsx("span",{className:"text-gray-100 break-all",children:ce.text})]},ce.id)),st.length===0&&A.jsx("p",{className:"text-gray-500 text-center py-8",children:"No logs yet. Click Start to begin translation."})]})]}),A.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:A.jsx("div",{className:"flex items-center justify-between",children:A.jsx("p",{className:"text-xs text-gray-600",children:i||"Ready to translate"})})})]}),A.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-y-auto",children:[A.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuration"}),A.jsxs("div",{className:"space-y-4 flex-1",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model"}),A.jsxs("select",{value:t.model,onChange:ce=>r(Ye=>({...Ye,model:ce.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[A.jsx("optgroup",{label:"Voice Live Pro",children:(ss=xn.pro)==null?void 0:ss.map(ce=>A.jsx("option",{value:ce,children:ce},ce))}),A.jsx("optgroup",{label:"Voice Live Basic",children:(os=xn.basic)==null?void 0:os.map(ce=>A.jsx("option",{value:ce,children:ce},ce))}),A.jsx("optgroup",{label:"Voice Live Lite",children:(as=xn.lite)==null?void 0:as.map(ce=>A.jsx("option",{value:ce,children:ce},ce))})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Language"}),A.jsx("select",{value:t.targetLanguage,onChange:ce=>r(Ye=>({...Ye,targetLanguage:ce.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:jU.map(ce=>A.jsxs("option",{value:ce.code,children:[ce.label," (",ce.code,")"]},ce.code))})]}),A.jsx("div",{className:"pt-2",children:o?A.jsxs("button",{onClick:oi,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{d:"M6 6h12v12H6z"})}),"Stop"]}):A.jsxs("button",{onClick:Yn,disabled:!n||!e,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Translation"]})}),o&&A.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-md ${l?"bg-green-50 border border-green-200":"bg-gray-100 border border-gray-200"}`,children:[A.jsx("svg",{className:`w-5 h-5 ${l?"text-green-600":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),A.jsx("span",{className:`text-sm font-medium ${l?"text-green-700":"text-gray-500"}`,children:l?"Microphone active":"Microphone off"})]}),A.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[A.jsxs("button",{onClick:()=>S(!C),className:"flex items-center justify-between w-full text-sm font-medium text-gray-700",children:[A.jsx("span",{children:"Advanced Settings"}),A.jsx("svg",{className:`w-5 h-5 transition-transform ${C?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),C&&A.jsxs("div",{className:"mt-4 space-y-4",children:[A.jsxs("div",{children:[A.jsxs("div",{className:"flex items-center justify-between mb-1",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prompt"}),A.jsx("button",{onClick:()=>r(ce=>({...ce,prompt:nd(ce.targetLanguage)})),className:"text-xs text-blue-600 hover:text-blue-800",children:"Reset"})]}),A.jsx("textarea",{value:t.prompt,onChange:ce=>r(Ye=>({...Ye,prompt:ce.target.value})),rows:6,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ASR Model"}),A.jsxs("select",{value:t.asrModel,onChange:ce=>r(Ye=>({...Ye,asrModel:ce.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[A.jsx("option",{value:"azure-speech",children:"azure-speech"}),A.jsx("option",{value:"gpt-4o-mini-transcribe",children:"gpt-4o-mini-transcribe"}),A.jsx("option",{value:"gpt-4o-transcribe",children:"gpt-4o-transcribe"}),A.jsx("option",{value:"whisper-1",children:"whisper-1"})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ASR Languages"}),A.jsx("input",{type:"text",value:t.asrLanguages,onChange:ce=>r(Ye=>({...Ye,asrLanguages:ce.target.value})),placeholder:"en,zh or en-US,zh-CN",disabled:t.asrModel!=="azure-speech",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Voice Provider"}),A.jsxs("select",{value:t.voiceProvider,onChange:ce=>{const Ye=ce.target.value;r(vt=>({...vt,voiceProvider:Ye,voiceName:Ye==="openai"?"alloy":"en-US-AvaMultilingualNeural"}))},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[A.jsx("option",{value:"openai",children:"OpenAI"}),A.jsx("option",{value:"azure-standard",children:"Azure Neural"})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Voice"}),A.jsx("select",{value:t.voiceName,onChange:ce=>r(Ye=>({...Ye,voiceName:ce.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:t.voiceProvider==="openai"?A.jsxs(A.Fragment,{children:[A.jsx("option",{value:"alloy",children:"Alloy (OpenAI)"}),A.jsx("option",{value:"echo",children:"Echo (OpenAI)"}),A.jsx("option",{value:"fable",children:"Fable (OpenAI)"}),A.jsx("option",{value:"nova",children:"Nova (OpenAI)"}),A.jsx("option",{value:"shimmer",children:"Shimmer (OpenAI)"})]}):A.jsxs(A.Fragment,{children:[A.jsx("option",{value:"en-US-AvaMultilingualNeural",children:"Ava (Female, conversational)"}),A.jsx("option",{value:"en-US-Ava:DragonHDLatestNeural",children:"Ava HD (Female, friendly)"}),A.jsx("option",{value:"en-US-AndrewMultilingualNeural",children:"Andrew (Male, conversational)"}),A.jsx("option",{value:"en-US-GuyMultilingualNeural",children:"Guy (Male, professional)"}),A.jsx("option",{value:"zh-CN-XiaochenMultilingualNeural",children:"Xiaochen (Female, assistant)"})]})})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Turn Detection"}),A.jsxs("select",{value:t.turnDetectionType,onChange:ce=>r(Ye=>({...Ye,turnDetectionType:ce.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[A.jsx("option",{value:"server_vad",children:"server_vad"}),A.jsx("option",{value:"azure_semantic_vad",children:"azure_semantic_vad"})]})]})]})]})]})]})]})}const g7={enabled:!1,type:"video",character:"lisa",style:"casual-sitting",customized:!1},hE={endpoint:"",apiKey:"",model:"gpt-4o-realtime-preview",instructions:"You are a helpful and friendly AI assistant. Be concise and natural in your responses.",voice:"en-US-AvaMultilingualNeural",voiceType:"standard",recognitionLanguage:"auto",turnDetectionType:"server_vad",removeFillerWords:!1,useNoiseSuppression:!1,useEchoCancellation:!1,temperature:.9,avatar:{...g7}},v7=[{id:"gpt-4o-realtime-preview",name:"GPT-4o Realtime Preview"},{id:"gpt-4o-mini-realtime-preview",name:"GPT-4o Mini Realtime Preview"}],m7=[{code:"auto",name:"Auto Detect"},{code:"en-US",name:"English (US)"},{code:"en-GB",name:"English (UK)"},{code:"zh-CN",name:"Chinese (Simplified)"},{code:"zh-TW",name:"Chinese (Traditional)"},{code:"ja-JP",name:"Japanese"},{code:"ko-KR",name:"Korean"},{code:"de-DE",name:"German"},{code:"fr-FR",name:"French"},{code:"es-ES",name:"Spanish (Spain)"},{code:"es-MX",name:"Spanish (Mexico)"},{code:"it-IT",name:"Italian"},{code:"pt-BR",name:"Portuguese (Brazil)"},{code:"hi-IN",name:"Hindi"}],CN={standard:[{id:"en-us-ava:DragonHDLatestNeural",name:"Ava (DragonHD)"},{id:"en-us-andrew:DragonHDLatestNeural",name:"Andrew (DragonHD)"},{id:"en-us-emma:DragonHDLatestNeural",name:"Emma (DragonHD)"},{id:"en-us-steffan:DragonHDLatestNeural",name:"Steffan (DragonHD)"},{id:"en-US-AvaMultilingualNeural",name:"Ava Multilingual"},{id:"en-US-AndrewMultilingualNeural",name:"Andrew Multilingual"},{id:"en-US-EmmaMultilingualNeural",name:"Emma Multilingual"},{id:"en-US-BrianMultilingualNeural",name:"Brian Multilingual"},{id:"zh-CN-XiaoxiaoMultilingualNeural",name:"Xiaoxiao Multilingual"},{id:"zh-cn-xiaochen:DragonHDLatestNeural",name:"Xiaochen (DragonHD)"},{id:"ja-jp-masaru:DragonHDLatestNeural",name:"Masaru (DragonHD)"},{id:"de-DE-Seraphina:DragonHDLatestNeural",name:"Seraphina (DragonHD)"}],openai:[{id:"alloy",name:"Alloy"},{id:"ash",name:"Ash"},{id:"ballad",name:"Ballad"},{id:"coral",name:"Coral"},{id:"echo",name:"Echo"},{id:"sage",name:"Sage"},{id:"shimmer",name:"Shimmer"},{id:"verse",name:"Verse"}]},AC=[{id:"lisa-casual-sitting",name:"Lisa (Casual Sitting)",character:"lisa",style:"casual-sitting"},{id:"harry-business",name:"Harry (Business)",character:"harry",style:"business"},{id:"harry-casual",name:"Harry (Casual)",character:"harry",style:"casual"},{id:"harry-youthful",name:"Harry (Youthful)",character:"harry",style:"youthful"},{id:"jeff-business",name:"Jeff (Business)",character:"jeff",style:"business"},{id:"jeff-formal",name:"Jeff (Formal)",character:"jeff",style:"formal"},{id:"lori-casual",name:"Lori (Casual)",character:"lori",style:"casual"},{id:"lori-formal",name:"Lori (Formal)",character:"lori",style:"formal"},{id:"lori-graceful",name:"Lori (Graceful)",character:"lori",style:"graceful"},{id:"max-business",name:"Max (Business)",character:"max",style:"business"},{id:"max-casual",name:"Max (Casual)",character:"max",style:"casual"},{id:"max-formal",name:"Max (Formal)",character:"max",style:"formal"},{id:"meg-business",name:"Meg (Business)",character:"meg",style:"business"},{id:"meg-casual",name:"Meg (Casual)",character:"meg",style:"casual"},{id:"meg-formal",name:"Meg (Formal)",character:"meg",style:"formal"}],bN=[{id:"adrian",name:"Adrian"},{id:"amara",name:"Amara"},{id:"amira",name:"Amira"},{id:"anika",name:"Anika"},{id:"bianca",name:"Bianca"},{id:"camila",name:"Camila"},{id:"carlos",name:"Carlos"},{id:"clara",name:"Clara"},{id:"darius",name:"Darius"},{id:"diego",name:"Diego"},{id:"elise",name:"Elise"},{id:"farhan",name:"Farhan"},{id:"faris",name:"Faris"},{id:"gabrielle",name:"Gabrielle"},{id:"hyejin",name:"Hyejin"},{id:"imran",name:"Imran"},{id:"isabella",name:"Isabella"},{id:"layla",name:"Layla"},{id:"ling",name:"Ling"},{id:"liwei",name:"Liwei"},{id:"marcus",name:"Marcus"},{id:"matteo",name:"Matteo"},{id:"rahul",name:"Rahul"},{id:"rana",name:"Rana"},{id:"ren",name:"Ren"},{id:"riya",name:"Riya"},{id:"sakura",name:"Sakura"},{id:"simone",name:"Simone"},{id:"zayd",name:"Zayd"},{id:"zoe",name:"Zoe"}];function wN(){return`${Date.now()}_${Math.random().toString(16).slice(2)}`}class y7{constructor(e){G(this,"client");G(this,"session");G(this,"subscription");G(this,"pcmPlayer",new tj);G(this,"peerConnection");G(this,"avatarConfig");G(this,"state",{isConnected:!1,isRecording:!1,isSpeaking:!1,isAvatarConnected:!1,messages:[],statusText:""});G(this,"currentResponseText","");G(this,"currentResponseId","");G(this,"events");this.events=e}get snapshot(){return this.state}setState(e){this.state={...this.state,...e},this.events.onState(this.state)}addMessage(e,t){const r={id:wN(),type:e,content:t,timestamp:Date.now()};this.setState({messages:[...this.state.messages,r]})}buildAvatarConfig(e){if(!e.enabled||e.type==="none")return;const t={codec:"h264"};return e.customized&&e.customAvatarName?e.type==="photo"?{type:"photo-avatar",model:"vasa-1",character:e.customAvatarName,customized:!0,video:t}:{type:"video-avatar",character:e.customAvatarName,customized:!0,video:t}:e.type==="photo"?{type:"photo-avatar",model:"vasa-1",character:e.character,customized:!1,video:t}:{type:"video-avatar",character:e.character,style:e.style,customized:!1,video:t}}buildSessionConfig(e){const t=e.voiceType==="openai"||!e.voice.includes("-"),r=this.buildAvatarConfig(e.avatar),i=["text","audio"];return r&&i.push("avatar"),{modalities:i,model:e.model,instructions:e.instructions,voice:t?e.voice:{name:e.voice,type:"azure-standard"},inputAudioFormat:"pcm16",outputAudioFormat:"pcm16",inputAudioTranscription:{model:e.model.includes("gpt")&&e.model.includes("realtime")?"whisper-1":"azure-speech",language:e.recognitionLanguage==="auto"?void 0:e.recognitionLanguage},turnDetection:{type:e.turnDetectionType,removeFillerWords:e.removeFillerWords},temperature:e.temperature,inputAudioNoiseReduction:e.useNoiseSuppression?{type:"azure_deep_noise_suppression"}:void 0,inputAudioEchoCancellation:e.useEchoCancellation?{type:"server_echo_cancellation"}:void 0,avatar:r}}async setupPeerConnection(e){var i;console.log("[VoiceLive Chat] Setting up WebRTC peer connection"),this.peerConnection=new RTCPeerConnection,this.peerConnection.ontrack=s=>{console.log("[VoiceLive Chat] Received track:",s.track.kind),this.events.onAvatarTrack&&this.events.onAvatarTrack(s)},this.peerConnection.oniceconnectionstatechange=()=>{var s,o,a,l;console.log("[VoiceLive Chat] ICE state:",(s=this.peerConnection)==null?void 0:s.iceConnectionState),((o=this.peerConnection)==null?void 0:o.iceConnectionState)==="connected"?this.setState({isAvatarConnected:!0,statusText:"Avatar connected"}):(((a=this.peerConnection)==null?void 0:a.iceConnectionState)==="disconnected"||((l=this.peerConnection)==null?void 0:l.iceConnectionState)==="failed")&&this.setState({isAvatarConnected:!1})},this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"}),await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t),await new Promise(s=>{var o;((o=this.peerConnection)==null?void 0:o.iceGatheringState)==="complete"?s():(this.peerConnection.onicegatheringstatechange=()=>{var a;((a=this.peerConnection)==null?void 0:a.iceGatheringState)==="complete"&&s()},setTimeout(s,5e3))});const r=(i=this.peerConnection.localDescription)==null?void 0:i.sdp;if(r&&this.session){console.log("[VoiceLive Chat] Sending client SDP");const s={type:"session.avatar.connect",clientSdp:r};await this.session.sendEvent(s),console.log("[VoiceLive Chat] Client SDP sent successfully")}}closePeerConnection(){this.peerConnection&&(this.peerConnection.close(),this.peerConnection=void 0,this.setState({isAvatarConnected:!1}))}async connect(e){if(this.state.isConnected)return;if(!e.endpoint.trim())throw new Error("Missing endpoint");if(!e.apiKey.trim())throw new Error("Missing API key");this.avatarConfig=e.avatar,this.setState({statusText:"Connecting..."}),this.client=new ej(e.endpoint.trim(),new qL(e.apiKey.trim()),{apiVersion:"2025-05-01-preview",defaultSessionOptions:{enableDebugLogging:!1}});const t=this.buildSessionConfig(e);console.log("[VoiceLive Chat] Session config:",JSON.stringify(t,null,2)),this.session=this.client.createSession(t,{connectionTimeoutInMs:3e4});const r={onConnected:async(i,s)=>{console.log("[VoiceLive Chat] Connected",{sessionId:s.sessionId}),this.setState({statusText:"Connected"})},onDisconnected:async i=>{console.log("[VoiceLive Chat] Disconnected",i),this.closePeerConnection(),this.setState({statusText:`Disconnected: ${i.reason}`})},onServerError:async i=>{console.log("[VoiceLive Chat] Server error",i.error),this.addMessage("error",i.error.message)},onSessionCreated:async i=>{console.log("[VoiceLive Chat] Session created",i.session),i.session.avatar&&console.log("[VoiceLive Chat] Avatar in created session:",i.session.avatar)},onSessionUpdated:async i=>{console.log("[VoiceLive Chat] Session updated",i.session),i.session.avatar&&console.log("[VoiceLive Chat] Avatar configured in session:",i.session.avatar)},onSessionAvatarConnecting:async i=>{var s;console.log("[VoiceLive Chat] Avatar connecting, received server SDP"),console.log("[VoiceLive Chat] Server SDP length:",(s=i.serverSdp)==null?void 0:s.length);try{await this.setupPeerConnection(i.serverSdp)}catch(o){console.error("[VoiceLive Chat] Failed to setup avatar:",o),this.addMessage("error",`Avatar connection failed: ${o}`)}},onConversationItemInputAudioTranscriptionDelta:async i=>{console.log("[VoiceLive Chat] Transcription delta",i.delta)},onConversationItemInputAudioTranscriptionCompleted:async i=>{var s;console.log("[VoiceLive Chat] Transcription completed",i.transcript),(s=i.transcript)!=null&&s.trim()&&this.addMessage("user",i.transcript)},onInputAudioBufferSpeechStarted:async()=>{console.log("[VoiceLive Chat] Speech started"),this.setState({isSpeaking:!0})},onInputAudioBufferSpeechStopped:async()=>{console.log("[VoiceLive Chat] Speech stopped"),this.setState({isSpeaking:!1})},onResponseCreated:async i=>{console.log("[VoiceLive Chat] Response created",i),this.currentResponseId=i.response.id??wN(),this.currentResponseText=""},onResponseTextDelta:async i=>{this.currentResponseText+=i.delta},onResponseTextDone:async i=>{console.log("[VoiceLive Chat] Response text done",i)},onResponseAudioDelta:async i=>{var s;if(!((s=this.avatarConfig)!=null&&s.enabled)){const o=i.delta;o instanceof Uint8Array&&this.pcmPlayer.enqueuePcm16(o,24e3)}},onResponseDone:async i=>{console.log("[VoiceLive Chat] Response done",i);let s=this.currentResponseText.trim();if(!s&&i.response.output&&i.response.output.length>0){const o=i.response.output[0];if(o!=null&&o.content&&Array.isArray(o.content)){const a=o.content.find(l=>l.type==="audio"&&l.transcript||l.type==="text");a!=null&&a.transcript?s=a.transcript:a!=null&&a.text&&(s=a.text)}}s&&this.addMessage("assistant",s),this.currentResponseText="",this.currentResponseId=""},onError:async i=>{console.log("[VoiceLive Chat] Error",i),this.addMessage("error",`${i.context}: ${i.error.message}`)}};this.subscription=this.session.subscribe(r),console.log("[VoiceLive Chat] Handlers subscribed, connecting...");try{await this.session.connect(),console.log("[VoiceLive Chat] WebSocket connected, sending session config..."),await this.session.updateSession(t),console.log("[VoiceLive Chat] Session config sent successfully")}catch(i){throw console.error("[VoiceLive Chat] Failed to connect or configure:",i),i}e.avatar.enabled||await this.pcmPlayer.resume(),this.setState({isConnected:!0,statusText:e.avatar.enabled?"Connecting avatar...":"Ready"})}async disconnect(){var e,t;this.setState({isRecording:!1,isSpeaking:!1});try{this.closePeerConnection(),this.pcmPlayer.stop(),await((e=this.subscription)==null?void 0:e.close()),this.subscription=void 0,await((t=this.session)==null?void 0:t.dispose()),this.session=void 0,this.client=void 0}finally{this.setState({isConnected:!1,isAvatarConnected:!1,statusText:"Disconnected"})}}async sendText(e){if(!this.session)throw new Error("Not connected");const t=e.trim();t&&(this.addMessage("user",t),await this.session.addConversationItem({type:"message",role:"user",content:[{type:"input_text",text:t}]}),await this.session.sendEvent({type:"response.create",response:{modalities:["text","audio"]}}))}async sendAudio(e){!this.session||!this.session.isConnected||await this.session.sendAudio(e)}clearMessages(){this.setState({messages:[]})}}class S7{constructor(){G(this,"context");G(this,"workletNode",null);G(this,"stream",null);G(this,"source",null);G(this,"sampleRate",24e3);G(this,"nextPlayTime",0);G(this,"isPlaying",!1);G(this,"playbackQueue",[]);G(this,"analysisNode",null);G(this,"dataArray",null);G(this,"animationFrameId",null);G(this,"circleElement",null);this.context=new AudioContext({sampleRate:this.sampleRate})}async initialize(){await this.context.audioWorklet.addModule("/AzureVoicePlayground/audio-processor.js"),this.analysisNode=this.context.createAnalyser(),this.analysisNode.fftSize=2048,this.analysisNode.smoothingTimeConstant=.85,this.dataArray=new Uint8Array(this.analysisNode.frequencyBinCount)}getSampleRate(){return this.sampleRate}setCircleElement(e){this.circleElement=e}async startRecording(e){try{this.workletNode||await this.initialize(),this.stream=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:this.sampleRate,echoCancellation:!0,noiseSuppression:!0}}),await this.context.resume(),this.source=this.context.createMediaStreamSource(this.stream),this.workletNode=new AudioWorkletNode(this.context,"audio-recorder-processor"),this.workletNode.port.onmessage=t=>{if(t.data.eventType==="audio"){const r=t.data.audioData,i=new Int16Array(r.length);for(let o=0;o<r.length;o++){const a=Math.max(-1,Math.min(1,r[o]));i[o]=a<0?a*32768:a*32767}const s=new Uint8Array(i.buffer);e(s)}},this.source.connect(this.workletNode),this.analysisNode&&this.circleElement&&(this.source.connect(this.analysisNode),this.startAnimation("record")),this.workletNode.connect(this.context.destination),this.workletNode.port.postMessage({command:"START_RECORDING"})}catch(t){throw console.error("Error starting recording:",t),t}}stopRecording(){!this.workletNode||!this.source||!this.stream||(this.workletNode.port.postMessage({command:"STOP_RECORDING"}),this.workletNode.disconnect(),this.source.disconnect(),this.stream.getTracks().forEach(e=>e.stop()),this.workletNode=null,this.source=null,this.stream=null,this.stopAnimation())}startStreamingPlayback(){this.isPlaying=!0,this.nextPlayTime=this.context.currentTime}stopStreamingPlayback(){this.isPlaying=!1,this.playbackQueue.forEach(e=>e.stop()),this.playbackQueue=[]}playChunk(e,t){if(!this.isPlaying)return;const r=new Int16Array(e.buffer),i=new Float32Array(r.length);for(let l=0;l<r.length;l++)i[l]=r[l]/(r[l]<0?32768:32767);const s=this.context.createBuffer(1,i.length,this.sampleRate);s.getChannelData(0).set(i);const o=this.context.createBufferSource();o.buffer=s,o.connect(this.context.destination),this.analysisNode&&this.circleElement&&(o.connect(this.analysisNode),this.startAnimation("play"));const a=s.length/this.sampleRate;this.nextPlayTime<this.context.currentTime&&(this.nextPlayTime=this.context.currentTime),o.start(this.nextPlayTime),this.playbackQueue.push(o),o.onended=()=>{t==null||t();const l=this.playbackQueue.indexOf(o);l>-1&&this.playbackQueue.splice(l,1),this.playbackQueue.length===0&&this.stream&&this.circleElement&&this.startAnimation("record")},this.nextPlayTime+=a}startAnimation(e){this.stopAnimation();const t=()=>{if(!this.analysisNode||!this.dataArray||!this.circleElement)return;this.analysisNode.getByteFrequencyData(this.dataArray);const r=Array.from(this.dataArray).reduce((i,s)=>i+s,0)/this.dataArray.length;this.updateCircle(r,e),this.animationFrameId=requestAnimationFrame(t)};t()}stopAnimation(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}updateCircle(e,t){if(!this.circleElement)return;const i=120+e*.8;this.circleElement.style.backgroundColor=t==="record"?"#e5e7eb":"#bfdbfe",this.circleElement.style.width=`${i}px`,this.circleElement.style.height=`${i}px`}async close(){this.stopAnimation(),this.stopRecording(),this.stopStreamingPlayback(),await this.context.close()}}function C7({endpoint:n,apiKey:e,showAvatarFeature:t=!1}){const[r,i]=W.useState(()=>{const B=localStorage.getItem("voicelive.chat.config");if(!B)return{...hE};try{const j=JSON.parse(B);return{...hE,...j}}catch{return{...hE}}}),[s,o]=W.useState(!1),[a,l]=W.useState(!1),[u,p]=W.useState(!1),[f,g]=W.useState(!1),[m,C]=W.useState([]),[S,w]=W.useState(""),[b,R]=W.useState(""),[P,I]=W.useState(!1),M=W.useRef(null),k=W.useRef(null),O=W.useRef(null),L=W.useRef(null),F=W.useRef(null),H=W.useCallback(B=>{if(console.log("[Playground] Received avatar track:",B.track.kind),!F.current)return;F.current.innerHTML="";const j=document.createElement(B.track.kind==="video"?"video":"audio");j.srcObject=B.streams[0],j.autoplay=!0,B.track.kind==="video"&&(j.playsInline=!0,j.style.width="100%",j.style.height="100%",j.style.objectFit="cover"),F.current.appendChild(j)},[]);M.current||(M.current=new y7({onState:B=>{o(B.isConnected),l(B.isRecording),p(B.isSpeaking),g(B.isAvatarConnected),C(B.messages),w(B.statusText)},onAvatarTrack:H}));const V=M.current;W.useEffect(()=>{localStorage.setItem("voicelive.chat.config",JSON.stringify(r))},[r]),W.useEffect(()=>()=>{const B=M.current,j=k.current;B!=null&&B.snapshot.isConnected&&(console.log("[VoiceLive Chat] Disconnecting on unmount"),B.disconnect().catch(console.error)),j&&j.close().catch(console.error)},[]),W.useEffect(()=>{var B;(B=O.current)==null||B.scrollIntoView({behavior:"smooth"})},[m.length]),W.useEffect(()=>{k.current&&L.current&&k.current.setCircleElement(L.current)},[]);const ie=W.useMemo(()=>r.voiceType==="openai"?CN.openai:CN.standard,[r.voiceType]);async function J(){if(!s){w("Connecting...");try{await V.connect({...r,endpoint:n,apiKey:e}),w("Connected"),await se()}catch(B){w(B instanceof Error?B.message:String(B))}}}async function ee(){w("Disconnecting...");try{await ne(),await V.disconnect(),w("Disconnected")}catch(B){w(B instanceof Error?B.message:String(B))}}async function se(){if(!a){if(!V.snapshot.isConnected){w("Connect first");return}k.current||(k.current=new S7,L.current&&k.current.setCircleElement(L.current));try{await k.current.startRecording(B=>{V.sendAudio(B)}),l(!0)}catch(B){w(B instanceof Error?B.message:String(B))}}}async function ne(){if(k.current)try{k.current.stopRecording(),l(!1)}catch(B){console.error("Error stopping recording:",B)}}async function Q(){if(b.trim()){if(!s){w("Connect first");return}try{await V.sendText(b),R("")}catch(B){w(B instanceof Error?B.message:String(B))}}}function K(){V.clearMessages(),C([])}function oe(B){switch(B){case"user":return"bg-blue-100 text-blue-900 ml-auto";case"assistant":return"bg-gray-100 text-gray-900 mr-auto";case"status":return"bg-yellow-100 text-yellow-800 mx-auto";case"error":return"bg-red-100 text-red-800 mx-auto";default:return"bg-gray-100 text-gray-900"}}return A.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[A.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[A.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 shadow-md",children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("div",{children:[A.jsx("h1",{className:"text-3xl font-bold",children:"Voice Live Chat"}),A.jsx("p",{className:"text-blue-100 mt-1",children:"Real-time voice conversation with AI"})]}),A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${s?"bg-green-500/20 text-green-100":"bg-white/20 text-white/80"}`,children:[A.jsx("span",{className:`w-2 h-2 rounded-full ${s?"bg-green-400":"bg-white/60"}`}),s?"Connected":"Disconnected"]}),a&&A.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium bg-red-500/20 text-red-100",children:[A.jsx("span",{className:"w-2 h-2 rounded-full bg-red-400 animate-pulse"}),"Recording"]})]})]})}),A.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-white",children:[t&&r.avatar.enabled&&A.jsxs("div",{className:"flex flex-col items-center mb-4",children:[A.jsx("div",{ref:F,className:"rounded-lg overflow-hidden bg-gray-900 flex items-center justify-center",style:{width:"400px",height:"400px"},children:!f&&A.jsxs("div",{className:"text-gray-400 text-center",children:[A.jsx("svg",{className:"w-16 h-16 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),A.jsx("p",{children:s?"Connecting avatar...":"Avatar will appear here"})]})}),f&&A.jsxs("span",{className:"mt-2 inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:[A.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),"Avatar Connected"]})]}),m.length===0&&!(t&&r.avatar.enabled)?A.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[A.jsx("div",{ref:L,className:"rounded-full transition-all duration-150 ease-out flex items-center justify-center mb-6",style:{width:"120px",height:"120px",backgroundColor:"#e5e7eb"},children:A.jsx("svg",{className:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),A.jsx("p",{className:"text-lg",children:"Click Start to begin conversation"}),A.jsx("p",{className:"text-sm mt-2",children:"Speak naturally and the AI will respond"})]}):m.length>0?A.jsxs(A.Fragment,{children:[m.map(B=>A.jsxs("div",{className:`max-w-[80%] px-4 py-2 rounded-lg ${oe(B.type)}`,children:[A.jsx("p",{className:"whitespace-pre-wrap",children:B.content}),A.jsx("p",{className:"text-xs opacity-60 mt-1",children:new Date(B.timestamp).toLocaleTimeString()})]},B.id)),A.jsx("div",{ref:O})]}):null]}),A.jsxs("div",{className:"bg-gray-50 border-t border-gray-200 p-4",children:[A.jsxs("div",{className:"flex gap-2 mb-2",children:[A.jsx("input",{type:"text",value:b,onChange:B=>R(B.target.value),onKeyDown:B=>{B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),Q())},placeholder:"Type a message (or just speak)...",disabled:!s,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed"}),A.jsx("button",{onClick:Q,disabled:!s||!b.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:A.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})}),A.jsx("button",{onClick:K,disabled:m.length===0,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Clear chat",children:A.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),A.jsx("p",{className:"text-xs text-gray-500",children:S||"Ready"})]})]}),A.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-y-auto",children:[A.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuration"}),A.jsxs("div",{className:"space-y-4 flex-1",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model"}),A.jsx("select",{value:r.model,onChange:B=>i(j=>({...j,model:B.target.value})),disabled:s,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:v7.map(B=>A.jsx("option",{value:B.id,children:B.name},B.id))})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Voice Type"}),A.jsxs("select",{value:r.voiceType,onChange:B=>{const j=B.target.value,$=j==="openai"?"alloy":"en-US-AvaMultilingualNeural";i(pe=>({...pe,voiceType:j,voice:$}))},disabled:s,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[A.jsx("option",{value:"standard",children:"Azure Neural"}),A.jsx("option",{value:"openai",children:"OpenAI"})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Voice"}),A.jsx("select",{value:r.voice,onChange:B=>i(j=>({...j,voice:B.target.value})),disabled:s,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:ie.map(B=>A.jsx("option",{value:B.id,children:B.name},B.id))})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recognition Language"}),A.jsx("select",{value:r.recognitionLanguage,onChange:B=>i(j=>({...j,recognitionLanguage:B.target.value})),disabled:s,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:m7.map(B=>A.jsx("option",{value:B.code,children:B.name},B.code))})]}),t&&A.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[A.jsxs("label",{className:"flex items-center gap-2 mb-3",children:[A.jsx("input",{type:"checkbox",checked:r.avatar.enabled,onChange:B=>i(j=>({...j,avatar:{...j.avatar,enabled:B.target.checked}})),disabled:s,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),A.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Avatar"})]}),r.avatar.enabled&&A.jsxs("div",{className:"space-y-3 pl-1",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Avatar Type"}),A.jsxs("select",{value:r.avatar.type,onChange:B=>i(j=>({...j,avatar:{...j.avatar,type:B.target.value,character:B.target.value==="photo"?bN[0].id:AC[0].character,style:B.target.value==="video"?AC[0].style:void 0}})),disabled:s,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[A.jsx("option",{value:"video",children:"Video Avatar"}),A.jsx("option",{value:"photo",children:"Photo Avatar (VASA-1)"})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:r.avatar.type==="photo"?"Photo Avatar":"Video Avatar"}),A.jsx("select",{value:r.avatar.type==="photo"?r.avatar.character:`${r.avatar.character}-${r.avatar.style}`,onChange:B=>{if(r.avatar.type==="photo")i(j=>({...j,avatar:{...j.avatar,character:B.target.value,style:void 0}}));else{const j=AC.find($=>$.id===B.target.value);j&&i($=>({...$,avatar:{...$.avatar,character:j.character,style:j.style}}))}},disabled:s,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:r.avatar.type==="photo"?bN.map(B=>A.jsx("option",{value:B.id,children:B.name},B.id)):AC.map(B=>A.jsx("option",{value:B.id,children:B.name},B.id))})]})]})]}),A.jsx("div",{className:"pt-2",children:s?A.jsxs("button",{onClick:ee,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{d:"M6 6h12v12H6z"})}),"Stop"]}):A.jsxs("button",{onClick:J,disabled:!n||!e,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[A.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Conversation"]})}),s&&A.jsx("div",{className:"pt-2",children:A.jsxs("button",{onClick:a?ne:se,className:`w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-md transition-colors ${a?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[A.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),a?"Mute Microphone":"Unmute Microphone"]})}),s&&u&&A.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-md",children:[A.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),A.jsx("span",{className:"text-sm text-blue-700",children:"Speaking detected..."})]}),A.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[A.jsxs("button",{onClick:()=>I(!P),className:"flex items-center justify-between w-full text-sm font-medium text-gray-700",children:[A.jsx("span",{children:"Advanced Settings"}),A.jsx("svg",{className:`w-5 h-5 transition-transform ${P?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),P&&A.jsxs("div",{className:"mt-4 space-y-4",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"System Instructions"}),A.jsx("textarea",{value:r.instructions,onChange:B=>i(j=>({...j,instructions:B.target.value})),disabled:s,rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",placeholder:"You are a helpful assistant..."})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Turn Detection"}),A.jsxs("select",{value:r.turnDetectionType,onChange:B=>i(j=>({...j,turnDetectionType:B.target.value})),disabled:s,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[A.jsx("option",{value:"server_vad",children:"Server VAD"}),A.jsx("option",{value:"azure_semantic_vad",children:"Azure Semantic VAD"})]})]}),A.jsxs("div",{children:[A.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Temperature: ",r.temperature.toFixed(1)]}),A.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:r.temperature,onChange:B=>i(j=>({...j,temperature:parseFloat(B.target.value)})),disabled:s,className:"w-full"})]}),A.jsxs("div",{className:"space-y-2",children:[A.jsxs("label",{className:"flex items-center gap-2",children:[A.jsx("input",{type:"checkbox",checked:r.removeFillerWords,onChange:B=>i(j=>({...j,removeFillerWords:B.target.checked})),disabled:s||r.turnDetectionType!=="azure_semantic_vad",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),A.jsx("span",{className:"text-sm text-gray-700",children:"Remove filler words"})]}),A.jsxs("label",{className:"flex items-center gap-2",children:[A.jsx("input",{type:"checkbox",checked:r.useNoiseSuppression,onChange:B=>i(j=>({...j,useNoiseSuppression:B.target.checked})),disabled:s,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),A.jsx("span",{className:"text-sm text-gray-700",children:"Noise suppression"})]}),A.jsxs("label",{className:"flex items-center gap-2",children:[A.jsx("input",{type:"checkbox",checked:r.useEchoCancellation,onChange:B=>i(j=>({...j,useEchoCancellation:B.target.checked})),disabled:s,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),A.jsx("span",{className:"text-sm text-gray-700",children:"Echo cancellation"})]})]})]})]})]})]})]})}function b7(){return W.useMemo(()=>{const e=new URLSearchParams(window.location.search).get("avatar");return e==="1"||e==="true"},[])}function w7(){const{settings:n,updateSettings:e,isConfigured:t}=hF(),[r,i]=W.useState("text-to-speech"),s=b7(),o=pF(),a=fF(),l=gF(),u=()=>{switch(r){case"text-to-speech":return A.jsx(d5,{settings:n,onSettingsChange:e,isConfigured:t,history:o.history,addToHistory:o.addToHistory,removeFromHistory:o.removeFromHistory,clearHistory:o.clearHistory});case"voice-changer":return A.jsx(E5,{settings:n,onSettingsChange:e,isConfigured:t,history:a.history,addToHistory:a.addToHistory,removeFromHistory:a.removeFromHistory,clearHistory:a.clearHistory});case"multi-talker":return A.jsx(LU,{settings:n,onSettingsChange:e,isConfigured:t,history:l.history,addToHistory:l.addToHistory,removeFromHistory:l.removeFromHistory,clearHistory:l.clearHistory});case"voice-live-chat":return A.jsx(C7,{endpoint:n.voiceLiveEndpoint||"",apiKey:n.voiceLiveApiKey||"",showAvatarFeature:s});case"voice-live-translator":return A.jsx(f7,{endpoint:n.voiceLiveEndpoint||"",apiKey:n.voiceLiveApiKey||""});default:return null}};return A.jsxs("div",{className:"h-screen flex overflow-hidden bg-white",children:[A.jsx(SF,{activeMode:r,onModeChange:i,settings:n,onSettingsChange:e}),u()]})}lF.createRoot(document.getElementById("root")).render(A.jsx(nF.StrictMode,{children:A.jsx(w7,{})}));
