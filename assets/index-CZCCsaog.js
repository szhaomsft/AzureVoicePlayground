var e3=Object.defineProperty;var OR=r=>{throw TypeError(r)};var t3=(r,e,t)=>e in r?e3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var q=(r,e,t)=>t3(r,typeof e!="symbol"?e+"":e,t),rx=(r,e,t)=>e.has(r)||OR("Cannot "+t);var p=(r,e,t)=>(rx(r,e,"read from private field"),t?t.call(r):e.get(r)),N=(r,e,t)=>e.has(r)?OR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),E=(r,e,t,n)=>(rx(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),_=(r,e,t)=>(rx(r,e,"access private method"),t);var mr=(r,e,t,n)=>({set _(i){E(r,e,i,t)},get _(){return p(r,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function s_(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function r3(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),t}var nx={exports:{}},zp={},ix={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DR;function n3(){if(DR)return Xe;DR=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;function g(W){return W===null||typeof W!="object"?null:(W=m&&W[m]||W["@@iterator"],typeof W=="function"?W:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,A={};function x(W,V,ce){this.props=W,this.context=V,this.refs=A,this.updater=ce||v}x.prototype.isReactComponent={},x.prototype.setState=function(W,V){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,V,"setState")},x.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function b(){}b.prototype=x.prototype;function w(W,V,ce){this.props=W,this.context=V,this.refs=A,this.updater=ce||v}var T=w.prototype=new b;T.constructor=w,y(T,x.prototype),T.isPureReactComponent=!0;var k=Array.isArray,I=Object.prototype.hasOwnProperty,M={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function j(W,V,ce){var ue,ve={},se=null,F=null;if(V!=null)for(ue in V.ref!==void 0&&(F=V.ref),V.key!==void 0&&(se=""+V.key),V)I.call(V,ue)&&!L.hasOwnProperty(ue)&&(ve[ue]=V[ue]);var te=arguments.length-2;if(te===1)ve.children=ce;else if(1<te){for(var ge=Array(te),oe=0;oe<te;oe++)ge[oe]=arguments[oe+2];ve.children=ge}if(W&&W.defaultProps)for(ue in te=W.defaultProps,te)ve[ue]===void 0&&(ve[ue]=te[ue]);return{$$typeof:r,type:W,key:se,ref:F,props:ve,_owner:M.current}}function B(W,V){return{$$typeof:r,type:W.type,key:V,ref:W.ref,props:W.props,_owner:W._owner}}function z(W){return typeof W=="object"&&W!==null&&W.$$typeof===r}function Z(W){var V={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(ce){return V[ce]})}var $=/\/+/g;function U(W,V){return typeof W=="object"&&W!==null&&W.key!=null?Z(""+W.key):V.toString(36)}function Y(W,V,ce,ue,ve){var se=typeof W;(se==="undefined"||se==="boolean")&&(W=null);var F=!1;if(W===null)F=!0;else switch(se){case"string":case"number":F=!0;break;case"object":switch(W.$$typeof){case r:case e:F=!0}}if(F)return F=W,ve=ve(F),W=ue===""?"."+U(F,0):ue,k(ve)?(ce="",W!=null&&(ce=W.replace($,"$&/")+"/"),Y(ve,V,ce,"",function(oe){return oe})):ve!=null&&(z(ve)&&(ve=B(ve,ce+(!ve.key||F&&F.key===ve.key?"":(""+ve.key).replace($,"$&/")+"/")+W)),V.push(ve)),1;if(F=0,ue=ue===""?".":ue+":",k(W))for(var te=0;te<W.length;te++){se=W[te];var ge=ue+U(se,te);F+=Y(se,V,ce,ge,ve)}else if(ge=g(W),typeof ge=="function")for(W=ge.call(W),te=0;!(se=W.next()).done;)se=se.value,ge=ue+U(se,te++),F+=Y(se,V,ce,ge,ve);else if(se==="object")throw V=String(W),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return F}function ee(W,V,ce){if(W==null)return W;var ue=[],ve=0;return Y(W,ue,"","",function(se){return V.call(ce,se,ve++)}),ue}function X(W){if(W._status===-1){var V=W._result;V=V(),V.then(function(ce){(W._status===0||W._status===-1)&&(W._status=1,W._result=ce)},function(ce){(W._status===0||W._status===-1)&&(W._status=2,W._result=ce)}),W._status===-1&&(W._status=0,W._result=V)}if(W._status===1)return W._result.default;throw W._result}var re={current:null},G={transition:null},J={ReactCurrentDispatcher:re,ReactCurrentBatchConfig:G,ReactCurrentOwner:M};function ne(){throw Error("act(...) is not supported in production builds of React.")}return Xe.Children={map:ee,forEach:function(W,V,ce){ee(W,function(){V.apply(this,arguments)},ce)},count:function(W){var V=0;return ee(W,function(){V++}),V},toArray:function(W){return ee(W,function(V){return V})||[]},only:function(W){if(!z(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Xe.Component=x,Xe.Fragment=t,Xe.Profiler=i,Xe.PureComponent=w,Xe.StrictMode=n,Xe.Suspense=l,Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,Xe.act=ne,Xe.cloneElement=function(W,V,ce){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var ue=y({},W.props),ve=W.key,se=W.ref,F=W._owner;if(V!=null){if(V.ref!==void 0&&(se=V.ref,F=M.current),V.key!==void 0&&(ve=""+V.key),W.type&&W.type.defaultProps)var te=W.type.defaultProps;for(ge in V)I.call(V,ge)&&!L.hasOwnProperty(ge)&&(ue[ge]=V[ge]===void 0&&te!==void 0?te[ge]:V[ge])}var ge=arguments.length-2;if(ge===1)ue.children=ce;else if(1<ge){te=Array(ge);for(var oe=0;oe<ge;oe++)te[oe]=arguments[oe+2];ue.children=te}return{$$typeof:r,type:W.type,key:ve,ref:se,props:ue,_owner:F}},Xe.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:s,_context:W},W.Consumer=W},Xe.createElement=j,Xe.createFactory=function(W){var V=j.bind(null,W);return V.type=W,V},Xe.createRef=function(){return{current:null}},Xe.forwardRef=function(W){return{$$typeof:a,render:W}},Xe.isValidElement=z,Xe.lazy=function(W){return{$$typeof:h,_payload:{_status:-1,_result:W},_init:X}},Xe.memo=function(W,V){return{$$typeof:u,type:W,compare:V===void 0?null:V}},Xe.startTransition=function(W){var V=G.transition;G.transition={};try{W()}finally{G.transition=V}},Xe.unstable_act=ne,Xe.useCallback=function(W,V){return re.current.useCallback(W,V)},Xe.useContext=function(W){return re.current.useContext(W)},Xe.useDebugValue=function(){},Xe.useDeferredValue=function(W){return re.current.useDeferredValue(W)},Xe.useEffect=function(W,V){return re.current.useEffect(W,V)},Xe.useId=function(){return re.current.useId()},Xe.useImperativeHandle=function(W,V,ce){return re.current.useImperativeHandle(W,V,ce)},Xe.useInsertionEffect=function(W,V){return re.current.useInsertionEffect(W,V)},Xe.useLayoutEffect=function(W,V){return re.current.useLayoutEffect(W,V)},Xe.useMemo=function(W,V){return re.current.useMemo(W,V)},Xe.useReducer=function(W,V,ce){return re.current.useReducer(W,V,ce)},Xe.useRef=function(W){return re.current.useRef(W)},Xe.useState=function(W){return re.current.useState(W)},Xe.useSyncExternalStore=function(W,V,ce){return re.current.useSyncExternalStore(W,V,ce)},Xe.useTransition=function(){return re.current.useTransition()},Xe.version="18.3.1",Xe}var jR;function TP(){return jR||(jR=1,ix.exports=n3()),ix.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BR;function i3(){if(BR)return zp;BR=1;var r=TP(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,u){var h,m={},g=null,v=null;u!==void 0&&(g=""+u),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(v=l.ref);for(h in l)n.call(l,h)&&!s.hasOwnProperty(h)&&(m[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)m[h]===void 0&&(m[h]=l[h]);return{$$typeof:e,type:a,key:g,ref:v,props:m,_owner:i.current}}return zp.Fragment=t,zp.jsx=o,zp.jsxs=o,zp}var zR;function s3(){return zR||(zR=1,nx.exports=i3()),nx.exports}var f=s3(),O=TP();const o_=s_(O);var T0={},sx={exports:{}},yn={},ox={exports:{}},ax={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FR;function o3(){return FR||(FR=1,(function(r){function e(G,J){var ne=G.length;G.push(J);e:for(;0<ne;){var W=ne-1>>>1,V=G[W];if(0<i(V,J))G[W]=J,G[ne]=V,ne=W;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var J=G[0],ne=G.pop();if(ne!==J){G[0]=ne;e:for(var W=0,V=G.length,ce=V>>>1;W<ce;){var ue=2*(W+1)-1,ve=G[ue],se=ue+1,F=G[se];if(0>i(ve,ne))se<V&&0>i(F,ve)?(G[W]=F,G[se]=ne,W=se):(G[W]=ve,G[ue]=ne,W=ue);else if(se<V&&0>i(F,ne))G[W]=F,G[se]=ne,W=se;else break e}}return J}function i(G,J){var ne=G.sortIndex-J.sortIndex;return ne!==0?ne:G.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();r.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,m=null,g=3,v=!1,y=!1,A=!1,x=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(G){for(var J=t(u);J!==null;){if(J.callback===null)n(u);else if(J.startTime<=G)n(u),J.sortIndex=J.expirationTime,e(l,J);else break;J=t(u)}}function k(G){if(A=!1,T(G),!y)if(t(l)!==null)y=!0,X(I);else{var J=t(u);J!==null&&re(k,J.startTime-G)}}function I(G,J){y=!1,A&&(A=!1,b(j),j=-1),v=!0;var ne=g;try{for(T(J),m=t(l);m!==null&&(!(m.expirationTime>J)||G&&!Z());){var W=m.callback;if(typeof W=="function"){m.callback=null,g=m.priorityLevel;var V=W(m.expirationTime<=J);J=r.unstable_now(),typeof V=="function"?m.callback=V:m===t(l)&&n(l),T(J)}else n(l);m=t(l)}if(m!==null)var ce=!0;else{var ue=t(u);ue!==null&&re(k,ue.startTime-J),ce=!1}return ce}finally{m=null,g=ne,v=!1}}var M=!1,L=null,j=-1,B=5,z=-1;function Z(){return!(r.unstable_now()-z<B)}function $(){if(L!==null){var G=r.unstable_now();z=G;var J=!0;try{J=L(!0,G)}finally{J?U():(M=!1,L=null)}}else M=!1}var U;if(typeof w=="function")U=function(){w($)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,ee=Y.port2;Y.port1.onmessage=$,U=function(){ee.postMessage(null)}}else U=function(){x($,0)};function X(G){L=G,M||(M=!0,U())}function re(G,J){j=x(function(){G(r.unstable_now())},J)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(G){G.callback=null},r.unstable_continueExecution=function(){y||v||(y=!0,X(I))},r.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<G?Math.floor(1e3/G):5},r.unstable_getCurrentPriorityLevel=function(){return g},r.unstable_getFirstCallbackNode=function(){return t(l)},r.unstable_next=function(G){switch(g){case 1:case 2:case 3:var J=3;break;default:J=g}var ne=g;g=J;try{return G()}finally{g=ne}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(G,J){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ne=g;g=G;try{return J()}finally{g=ne}},r.unstable_scheduleCallback=function(G,J,ne){var W=r.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?W+ne:W):ne=W,G){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=ne+V,G={id:h++,callback:J,priorityLevel:G,startTime:ne,expirationTime:V,sortIndex:-1},ne>W?(G.sortIndex=ne,e(u,G),t(l)===null&&G===t(u)&&(A?(b(j),j=-1):A=!0,re(k,ne-W))):(G.sortIndex=V,e(l,G),y||v||(y=!0,X(I))),G},r.unstable_shouldYield=Z,r.unstable_wrapCallback=function(G){var J=g;return function(){var ne=g;g=J;try{return G.apply(this,arguments)}finally{g=ne}}}})(ax)),ax}var WR;function a3(){return WR||(WR=1,ox.exports=o3()),ox.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UR;function l3(){if(UR)return yn;UR=1;var r=TP(),e=a3();function t(c){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+c,S=1;S<arguments.length;S++)d+="&args[]="+encodeURIComponent(arguments[S]);return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function s(c,d){o(c,d),o(c+"Capture",d)}function o(c,d){for(i[c]=d,c=0;c<d.length;c++)n.add(d[c])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},m={};function g(c){return l.call(m,c)?!0:l.call(h,c)?!1:u.test(c)?m[c]=!0:(h[c]=!0,!1)}function v(c,d,S,C){if(S!==null&&S.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return C?!1:S!==null?!S.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function y(c,d,S,C){if(d===null||typeof d>"u"||v(c,d,S,C))return!0;if(C)return!1;if(S!==null)switch(S.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function A(c,d,S,C,P,R,D){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=C,this.attributeNamespace=P,this.mustUseProperty=S,this.propertyName=c,this.type=d,this.sanitizeURL=R,this.removeEmptyString=D}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){x[c]=new A(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var d=c[0];x[d]=new A(d,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){x[c]=new A(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){x[c]=new A(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){x[c]=new A(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){x[c]=new A(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){x[c]=new A(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){x[c]=new A(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){x[c]=new A(c,5,!1,c.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function w(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var d=c.replace(b,w);x[d]=new A(d,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var d=c.replace(b,w);x[d]=new A(d,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var d=c.replace(b,w);x[d]=new A(d,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){x[c]=new A(c,1,!1,c.toLowerCase(),null,!1,!1)}),x.xlinkHref=new A("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){x[c]=new A(c,1,!1,c.toLowerCase(),null,!0,!0)});function T(c,d,S,C){var P=x.hasOwnProperty(d)?x[d]:null;(P!==null?P.type!==0:C||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(y(d,S,P,C)&&(S=null),C||P===null?g(d)&&(S===null?c.removeAttribute(d):c.setAttribute(d,""+S)):P.mustUseProperty?c[P.propertyName]=S===null?P.type===3?!1:"":S:(d=P.attributeName,C=P.attributeNamespace,S===null?c.removeAttribute(d):(P=P.type,S=P===3||P===4&&S===!0?"":""+S,C?c.setAttributeNS(C,d,S):c.setAttribute(d,S))))}var k=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,I=Symbol.for("react.element"),M=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),z=Symbol.for("react.provider"),Z=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),re=Symbol.for("react.offscreen"),G=Symbol.iterator;function J(c){return c===null||typeof c!="object"?null:(c=G&&c[G]||c["@@iterator"],typeof c=="function"?c:null)}var ne=Object.assign,W;function V(c){if(W===void 0)try{throw Error()}catch(S){var d=S.stack.trim().match(/\n( *(at )?)/);W=d&&d[1]||""}return`
`+W+c}var ce=!1;function ue(c,d){if(!c||ce)return"";ce=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(le){var C=le}Reflect.construct(c,[],d)}else{try{d.call()}catch(le){C=le}c.call(d.prototype)}else{try{throw Error()}catch(le){C=le}c()}}catch(le){if(le&&C&&typeof le.stack=="string"){for(var P=le.stack.split(`
`),R=C.stack.split(`
`),D=P.length-1,H=R.length-1;1<=D&&0<=H&&P[D]!==R[H];)H--;for(;1<=D&&0<=H;D--,H--)if(P[D]!==R[H]){if(D!==1||H!==1)do if(D--,H--,0>H||P[D]!==R[H]){var K=`
`+P[D].replace(" at new "," at ");return c.displayName&&K.includes("<anonymous>")&&(K=K.replace("<anonymous>",c.displayName)),K}while(1<=D&&0<=H);break}}}finally{ce=!1,Error.prepareStackTrace=S}return(c=c?c.displayName||c.name:"")?V(c):""}function ve(c){switch(c.tag){case 5:return V(c.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return c=ue(c.type,!1),c;case 11:return c=ue(c.type.render,!1),c;case 1:return c=ue(c.type,!0),c;default:return""}}function se(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case L:return"Fragment";case M:return"Portal";case B:return"Profiler";case j:return"StrictMode";case U:return"Suspense";case Y:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case Z:return(c.displayName||"Context")+".Consumer";case z:return(c._context.displayName||"Context")+".Provider";case $:var d=c.render;return c=c.displayName,c||(c=d.displayName||d.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case ee:return d=c.displayName||null,d!==null?d:se(c.type)||"Memo";case X:d=c._payload,c=c._init;try{return se(c(d))}catch{}}return null}function F(c){var d=c.type;switch(c.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=d.render,c=c.displayName||c.name||"",d.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return se(d);case 8:return d===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function te(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function ge(c){var d=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function oe(c){var d=ge(c)?"checked":"value",S=Object.getOwnPropertyDescriptor(c.constructor.prototype,d),C=""+c[d];if(!c.hasOwnProperty(d)&&typeof S<"u"&&typeof S.get=="function"&&typeof S.set=="function"){var P=S.get,R=S.set;return Object.defineProperty(c,d,{configurable:!0,get:function(){return P.call(this)},set:function(D){C=""+D,R.call(this,D)}}),Object.defineProperty(c,d,{enumerable:S.enumerable}),{getValue:function(){return C},setValue:function(D){C=""+D},stopTracking:function(){c._valueTracker=null,delete c[d]}}}}function pe(c){c._valueTracker||(c._valueTracker=oe(c))}function Be(c){if(!c)return!1;var d=c._valueTracker;if(!d)return!0;var S=d.getValue(),C="";return c&&(C=ge(c)?c.checked?"true":"false":c.value),c=C,c!==S?(d.setValue(c),!0):!1}function Fe(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function ye(c,d){var S=d.checked;return ne({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:S??c._wrapperState.initialChecked})}function _e(c,d){var S=d.defaultValue==null?"":d.defaultValue,C=d.checked!=null?d.checked:d.defaultChecked;S=te(d.value!=null?d.value:S),c._wrapperState={initialChecked:C,initialValue:S,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function de(c,d){d=d.checked,d!=null&&T(c,"checked",d,!1)}function Ae(c,d){de(c,d);var S=te(d.value),C=d.type;if(S!=null)C==="number"?(S===0&&c.value===""||c.value!=S)&&(c.value=""+S):c.value!==""+S&&(c.value=""+S);else if(C==="submit"||C==="reset"){c.removeAttribute("value");return}d.hasOwnProperty("value")?at(c,d.type,S):d.hasOwnProperty("defaultValue")&&at(c,d.type,te(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(c.defaultChecked=!!d.defaultChecked)}function nt(c,d,S){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var C=d.type;if(!(C!=="submit"&&C!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+c._wrapperState.initialValue,S||d===c.value||(c.value=d),c.defaultValue=d}S=c.name,S!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,S!==""&&(c.name=S)}function at(c,d,S){(d!=="number"||Fe(c.ownerDocument)!==c)&&(S==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+S&&(c.defaultValue=""+S))}var be=Array.isArray;function yt(c,d,S,C){if(c=c.options,d){d={};for(var P=0;P<S.length;P++)d["$"+S[P]]=!0;for(S=0;S<c.length;S++)P=d.hasOwnProperty("$"+c[S].value),c[S].selected!==P&&(c[S].selected=P),P&&C&&(c[S].defaultSelected=!0)}else{for(S=""+te(S),d=null,P=0;P<c.length;P++){if(c[P].value===S){c[P].selected=!0,C&&(c[P].defaultSelected=!0);return}d!==null||c[P].disabled||(d=c[P])}d!==null&&(d.selected=!0)}}function li(c,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},d,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function ss(c,d){var S=d.value;if(S==null){if(S=d.children,d=d.defaultValue,S!=null){if(d!=null)throw Error(t(92));if(be(S)){if(1<S.length)throw Error(t(93));S=S[0]}d=S}d==null&&(d=""),S=d}c._wrapperState={initialValue:te(S)}}function os(c,d){var S=te(d.value),C=te(d.defaultValue);S!=null&&(S=""+S,S!==c.value&&(c.value=S),d.defaultValue==null&&c.defaultValue!==S&&(c.defaultValue=S)),C!=null&&(c.defaultValue=""+C)}function as(c){var d=c.textContent;d===c._wrapperState.initialValue&&d!==""&&d!==null&&(c.value=d)}function he(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qe(c,d){return c==null||c==="http://www.w3.org/1999/xhtml"?he(d):c==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var Ct,en=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,S,C,P){MSApp.execUnsafeLocalFunction(function(){return c(d,S,C,P)})}:c})(function(c,d){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=d;else{for(Ct=Ct||document.createElement("div"),Ct.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=Ct.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;d.firstChild;)c.appendChild(d.firstChild)}});function ls(c,d){if(d){var S=c.firstChild;if(S&&S===c.lastChild&&S.nodeType===3){S.nodeValue=d;return}}c.textContent=d}var cs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Du=["Webkit","ms","Moz","O"];Object.keys(cs).forEach(function(c){Du.forEach(function(d){d=d+c.charAt(0).toUpperCase()+c.substring(1),cs[d]=cs[c]})});function Pl(c,d,S){return d==null||typeof d=="boolean"||d===""?"":S||typeof d!="number"||d===0||cs.hasOwnProperty(c)&&cs[c]?(""+d).trim():d+"px"}function El(c,d){c=c.style;for(var S in d)if(d.hasOwnProperty(S)){var C=S.indexOf("--")===0,P=Pl(S,d[S],C);S==="float"&&(S="cssFloat"),C?c.setProperty(S,P):c[S]=P}}var ju=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ta(c,d){if(d){if(ju[c]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function ra(c,d){if(c.indexOf("-")===-1)return typeof d.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var na=null;function Rl(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var rp=null,Vs=null,ia=null;function my(c){if(c=Tp(c)){if(typeof rp!="function")throw Error(t(280));var d=c.stateNode;d&&(d=zy(d),rp(c.stateNode,c.type,d))}}function gy(c){Vs?ia?ia.push(c):ia=[c]:Vs=c}function eE(){if(Vs){var c=Vs,d=ia;if(ia=Vs=null,my(c),d)for(c=0;c<d.length;c++)my(d[c])}}function tE(c,d){return c(d)}function rE(){}var yA=!1;function nE(c,d,S){if(yA)return c(d,S);yA=!0;try{return tE(c,d,S)}finally{yA=!1,(Vs!==null||ia!==null)&&(rE(),eE())}}function np(c,d){var S=c.stateNode;if(S===null)return null;var C=zy(S);if(C===null)return null;S=C[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(C=!C.disabled)||(c=c.type,C=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!C;break e;default:c=!1}if(c)return null;if(S&&typeof S!="function")throw Error(t(231,d,typeof S));return S}var CA=!1;if(a)try{var ip={};Object.defineProperty(ip,"passive",{get:function(){CA=!0}}),window.addEventListener("test",ip,ip),window.removeEventListener("test",ip,ip)}catch{CA=!1}function o4(c,d,S,C,P,R,D,H,K){var le=Array.prototype.slice.call(arguments,3);try{d.apply(S,le)}catch(me){this.onError(me)}}var sp=!1,vy=null,Sy=!1,AA=null,a4={onError:function(c){sp=!0,vy=c}};function l4(c,d,S,C,P,R,D,H,K){sp=!1,vy=null,o4.apply(a4,arguments)}function c4(c,d,S,C,P,R,D,H,K){if(l4.apply(this,arguments),sp){if(sp){var le=vy;sp=!1,vy=null}else throw Error(t(198));Sy||(Sy=!0,AA=le)}}function Il(c){var d=c,S=c;if(c.alternate)for(;d.return;)d=d.return;else{c=d;do d=c,(d.flags&4098)!==0&&(S=d.return),c=d.return;while(c)}return d.tag===3?S:null}function iE(c){if(c.tag===13){var d=c.memoizedState;if(d===null&&(c=c.alternate,c!==null&&(d=c.memoizedState)),d!==null)return d.dehydrated}return null}function sE(c){if(Il(c)!==c)throw Error(t(188))}function u4(c){var d=c.alternate;if(!d){if(d=Il(c),d===null)throw Error(t(188));return d!==c?null:c}for(var S=c,C=d;;){var P=S.return;if(P===null)break;var R=P.alternate;if(R===null){if(C=P.return,C!==null){S=C;continue}break}if(P.child===R.child){for(R=P.child;R;){if(R===S)return sE(P),c;if(R===C)return sE(P),d;R=R.sibling}throw Error(t(188))}if(S.return!==C.return)S=P,C=R;else{for(var D=!1,H=P.child;H;){if(H===S){D=!0,S=P,C=R;break}if(H===C){D=!0,C=P,S=R;break}H=H.sibling}if(!D){for(H=R.child;H;){if(H===S){D=!0,S=R,C=P;break}if(H===C){D=!0,C=R,S=P;break}H=H.sibling}if(!D)throw Error(t(189))}}if(S.alternate!==C)throw Error(t(190))}if(S.tag!==3)throw Error(t(188));return S.stateNode.current===S?c:d}function oE(c){return c=u4(c),c!==null?aE(c):null}function aE(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var d=aE(c);if(d!==null)return d;c=c.sibling}return null}var lE=e.unstable_scheduleCallback,cE=e.unstable_cancelCallback,d4=e.unstable_shouldYield,h4=e.unstable_requestPaint,ir=e.unstable_now,p4=e.unstable_getCurrentPriorityLevel,bA=e.unstable_ImmediatePriority,uE=e.unstable_UserBlockingPriority,yy=e.unstable_NormalPriority,f4=e.unstable_LowPriority,dE=e.unstable_IdlePriority,Cy=null,us=null;function m4(c){if(us&&typeof us.onCommitFiberRoot=="function")try{us.onCommitFiberRoot(Cy,c,void 0,(c.current.flags&128)===128)}catch{}}var Ni=Math.clz32?Math.clz32:S4,g4=Math.log,v4=Math.LN2;function S4(c){return c>>>=0,c===0?32:31-(g4(c)/v4|0)|0}var Ay=64,by=4194304;function op(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function xy(c,d){var S=c.pendingLanes;if(S===0)return 0;var C=0,P=c.suspendedLanes,R=c.pingedLanes,D=S&268435455;if(D!==0){var H=D&~P;H!==0?C=op(H):(R&=D,R!==0&&(C=op(R)))}else D=S&~P,D!==0?C=op(D):R!==0&&(C=op(R));if(C===0)return 0;if(d!==0&&d!==C&&(d&P)===0&&(P=C&-C,R=d&-d,P>=R||P===16&&(R&4194240)!==0))return d;if((C&4)!==0&&(C|=S&16),d=c.entangledLanes,d!==0)for(c=c.entanglements,d&=C;0<d;)S=31-Ni(d),P=1<<S,C|=c[S],d&=~P;return C}function y4(c,d){switch(c){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function C4(c,d){for(var S=c.suspendedLanes,C=c.pingedLanes,P=c.expirationTimes,R=c.pendingLanes;0<R;){var D=31-Ni(R),H=1<<D,K=P[D];K===-1?((H&S)===0||(H&C)!==0)&&(P[D]=y4(H,d)):K<=d&&(c.expiredLanes|=H),R&=~H}}function xA(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function hE(){var c=Ay;return Ay<<=1,(Ay&4194240)===0&&(Ay=64),c}function TA(c){for(var d=[],S=0;31>S;S++)d.push(c);return d}function ap(c,d,S){c.pendingLanes|=d,d!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,d=31-Ni(d),c[d]=S}function A4(c,d){var S=c.pendingLanes&~d;c.pendingLanes=d,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=d,c.mutableReadLanes&=d,c.entangledLanes&=d,d=c.entanglements;var C=c.eventTimes;for(c=c.expirationTimes;0<S;){var P=31-Ni(S),R=1<<P;d[P]=0,C[P]=-1,c[P]=-1,S&=~R}}function wA(c,d){var S=c.entangledLanes|=d;for(c=c.entanglements;S;){var C=31-Ni(S),P=1<<C;P&d|c[C]&d&&(c[C]|=d),S&=~P}}var mt=0;function pE(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var fE,PA,mE,gE,vE,EA=!1,Ty=[],sa=null,oa=null,aa=null,lp=new Map,cp=new Map,la=[],b4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function SE(c,d){switch(c){case"focusin":case"focusout":sa=null;break;case"dragenter":case"dragleave":oa=null;break;case"mouseover":case"mouseout":aa=null;break;case"pointerover":case"pointerout":lp.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":cp.delete(d.pointerId)}}function up(c,d,S,C,P,R){return c===null||c.nativeEvent!==R?(c={blockedOn:d,domEventName:S,eventSystemFlags:C,nativeEvent:R,targetContainers:[P]},d!==null&&(d=Tp(d),d!==null&&PA(d)),c):(c.eventSystemFlags|=C,d=c.targetContainers,P!==null&&d.indexOf(P)===-1&&d.push(P),c)}function x4(c,d,S,C,P){switch(d){case"focusin":return sa=up(sa,c,d,S,C,P),!0;case"dragenter":return oa=up(oa,c,d,S,C,P),!0;case"mouseover":return aa=up(aa,c,d,S,C,P),!0;case"pointerover":var R=P.pointerId;return lp.set(R,up(lp.get(R)||null,c,d,S,C,P)),!0;case"gotpointercapture":return R=P.pointerId,cp.set(R,up(cp.get(R)||null,c,d,S,C,P)),!0}return!1}function yE(c){var d=kl(c.target);if(d!==null){var S=Il(d);if(S!==null){if(d=S.tag,d===13){if(d=iE(S),d!==null){c.blockedOn=d,vE(c.priority,function(){mE(S)});return}}else if(d===3&&S.stateNode.current.memoizedState.isDehydrated){c.blockedOn=S.tag===3?S.stateNode.containerInfo:null;return}}}c.blockedOn=null}function wy(c){if(c.blockedOn!==null)return!1;for(var d=c.targetContainers;0<d.length;){var S=IA(c.domEventName,c.eventSystemFlags,d[0],c.nativeEvent);if(S===null){S=c.nativeEvent;var C=new S.constructor(S.type,S);na=C,S.target.dispatchEvent(C),na=null}else return d=Tp(S),d!==null&&PA(d),c.blockedOn=S,!1;d.shift()}return!0}function CE(c,d,S){wy(c)&&S.delete(d)}function T4(){EA=!1,sa!==null&&wy(sa)&&(sa=null),oa!==null&&wy(oa)&&(oa=null),aa!==null&&wy(aa)&&(aa=null),lp.forEach(CE),cp.forEach(CE)}function dp(c,d){c.blockedOn===d&&(c.blockedOn=null,EA||(EA=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,T4)))}function hp(c){function d(P){return dp(P,c)}if(0<Ty.length){dp(Ty[0],c);for(var S=1;S<Ty.length;S++){var C=Ty[S];C.blockedOn===c&&(C.blockedOn=null)}}for(sa!==null&&dp(sa,c),oa!==null&&dp(oa,c),aa!==null&&dp(aa,c),lp.forEach(d),cp.forEach(d),S=0;S<la.length;S++)C=la[S],C.blockedOn===c&&(C.blockedOn=null);for(;0<la.length&&(S=la[0],S.blockedOn===null);)yE(S),S.blockedOn===null&&la.shift()}var Bu=k.ReactCurrentBatchConfig,Py=!0;function w4(c,d,S,C){var P=mt,R=Bu.transition;Bu.transition=null;try{mt=1,RA(c,d,S,C)}finally{mt=P,Bu.transition=R}}function P4(c,d,S,C){var P=mt,R=Bu.transition;Bu.transition=null;try{mt=4,RA(c,d,S,C)}finally{mt=P,Bu.transition=R}}function RA(c,d,S,C){if(Py){var P=IA(c,d,S,C);if(P===null)VA(c,d,C,Ey,S),SE(c,C);else if(x4(P,c,d,S,C))C.stopPropagation();else if(SE(c,C),d&4&&-1<b4.indexOf(c)){for(;P!==null;){var R=Tp(P);if(R!==null&&fE(R),R=IA(c,d,S,C),R===null&&VA(c,d,C,Ey,S),R===P)break;P=R}P!==null&&C.stopPropagation()}else VA(c,d,C,null,S)}}var Ey=null;function IA(c,d,S,C){if(Ey=null,c=Rl(C),c=kl(c),c!==null)if(d=Il(c),d===null)c=null;else if(S=d.tag,S===13){if(c=iE(d),c!==null)return c;c=null}else if(S===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;c=null}else d!==c&&(c=null);return Ey=c,null}function AE(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(p4()){case bA:return 1;case uE:return 4;case yy:case f4:return 16;case dE:return 536870912;default:return 16}default:return 16}}var ca=null,kA=null,Ry=null;function bE(){if(Ry)return Ry;var c,d=kA,S=d.length,C,P="value"in ca?ca.value:ca.textContent,R=P.length;for(c=0;c<S&&d[c]===P[c];c++);var D=S-c;for(C=1;C<=D&&d[S-C]===P[R-C];C++);return Ry=P.slice(c,1<C?1-C:void 0)}function Iy(c){var d=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&d===13&&(c=13)):c=d,c===10&&(c=13),32<=c||c===13?c:0}function ky(){return!0}function xE(){return!1}function kn(c){function d(S,C,P,R,D){this._reactName=S,this._targetInst=P,this.type=C,this.nativeEvent=R,this.target=D,this.currentTarget=null;for(var H in c)c.hasOwnProperty(H)&&(S=c[H],this[H]=S?S(R):R[H]);return this.isDefaultPrevented=(R.defaultPrevented!=null?R.defaultPrevented:R.returnValue===!1)?ky:xE,this.isPropagationStopped=xE,this}return ne(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var S=this.nativeEvent;S&&(S.preventDefault?S.preventDefault():typeof S.returnValue!="unknown"&&(S.returnValue=!1),this.isDefaultPrevented=ky)},stopPropagation:function(){var S=this.nativeEvent;S&&(S.stopPropagation?S.stopPropagation():typeof S.cancelBubble!="unknown"&&(S.cancelBubble=!0),this.isPropagationStopped=ky)},persist:function(){},isPersistent:ky}),d}var zu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},MA=kn(zu),pp=ne({},zu,{view:0,detail:0}),E4=kn(pp),NA,LA,fp,My=ne({},pp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:OA,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==fp&&(fp&&c.type==="mousemove"?(NA=c.screenX-fp.screenX,LA=c.screenY-fp.screenY):LA=NA=0,fp=c),NA)},movementY:function(c){return"movementY"in c?c.movementY:LA}}),TE=kn(My),R4=ne({},My,{dataTransfer:0}),I4=kn(R4),k4=ne({},pp,{relatedTarget:0}),_A=kn(k4),M4=ne({},zu,{animationName:0,elapsedTime:0,pseudoElement:0}),N4=kn(M4),L4=ne({},zu,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),_4=kn(L4),O4=ne({},zu,{data:0}),wE=kn(O4),D4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},j4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},B4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function z4(c){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(c):(c=B4[c])?!!d[c]:!1}function OA(){return z4}var F4=ne({},pp,{key:function(c){if(c.key){var d=D4[c.key]||c.key;if(d!=="Unidentified")return d}return c.type==="keypress"?(c=Iy(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?j4[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:OA,charCode:function(c){return c.type==="keypress"?Iy(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Iy(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),W4=kn(F4),U4=ne({},My,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),PE=kn(U4),Z4=ne({},pp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:OA}),$4=kn(Z4),H4=ne({},zu,{propertyName:0,elapsedTime:0,pseudoElement:0}),V4=kn(H4),q4=ne({},My,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),G4=kn(q4),K4=[9,13,27,32],DA=a&&"CompositionEvent"in window,mp=null;a&&"documentMode"in document&&(mp=document.documentMode);var Y4=a&&"TextEvent"in window&&!mp,EE=a&&(!DA||mp&&8<mp&&11>=mp),RE=" ",IE=!1;function kE(c,d){switch(c){case"keyup":return K4.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ME(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Fu=!1;function X4(c,d){switch(c){case"compositionend":return ME(d);case"keypress":return d.which!==32?null:(IE=!0,RE);case"textInput":return c=d.data,c===RE&&IE?null:c;default:return null}}function J4(c,d){if(Fu)return c==="compositionend"||!DA&&kE(c,d)?(c=bE(),Ry=kA=ca=null,Fu=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return EE&&d.locale!=="ko"?null:d.data;default:return null}}var Q4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function NE(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d==="input"?!!Q4[c.type]:d==="textarea"}function LE(c,d,S,C){gy(C),d=Dy(d,"onChange"),0<d.length&&(S=new MA("onChange","change",null,S,C),c.push({event:S,listeners:d}))}var gp=null,vp=null;function eB(c){XE(c,0)}function Ny(c){var d=Hu(c);if(Be(d))return c}function tB(c,d){if(c==="change")return d}var _E=!1;if(a){var jA;if(a){var BA="oninput"in document;if(!BA){var OE=document.createElement("div");OE.setAttribute("oninput","return;"),BA=typeof OE.oninput=="function"}jA=BA}else jA=!1;_E=jA&&(!document.documentMode||9<document.documentMode)}function DE(){gp&&(gp.detachEvent("onpropertychange",jE),vp=gp=null)}function jE(c){if(c.propertyName==="value"&&Ny(vp)){var d=[];LE(d,vp,c,Rl(c)),nE(eB,d)}}function rB(c,d,S){c==="focusin"?(DE(),gp=d,vp=S,gp.attachEvent("onpropertychange",jE)):c==="focusout"&&DE()}function nB(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Ny(vp)}function iB(c,d){if(c==="click")return Ny(d)}function sB(c,d){if(c==="input"||c==="change")return Ny(d)}function oB(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var Li=typeof Object.is=="function"?Object.is:oB;function Sp(c,d){if(Li(c,d))return!0;if(typeof c!="object"||c===null||typeof d!="object"||d===null)return!1;var S=Object.keys(c),C=Object.keys(d);if(S.length!==C.length)return!1;for(C=0;C<S.length;C++){var P=S[C];if(!l.call(d,P)||!Li(c[P],d[P]))return!1}return!0}function BE(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function zE(c,d){var S=BE(c);c=0;for(var C;S;){if(S.nodeType===3){if(C=c+S.textContent.length,c<=d&&C>=d)return{node:S,offset:d-c};c=C}e:{for(;S;){if(S.nextSibling){S=S.nextSibling;break e}S=S.parentNode}S=void 0}S=BE(S)}}function FE(c,d){return c&&d?c===d?!0:c&&c.nodeType===3?!1:d&&d.nodeType===3?FE(c,d.parentNode):"contains"in c?c.contains(d):c.compareDocumentPosition?!!(c.compareDocumentPosition(d)&16):!1:!1}function WE(){for(var c=window,d=Fe();d instanceof c.HTMLIFrameElement;){try{var S=typeof d.contentWindow.location.href=="string"}catch{S=!1}if(S)c=d.contentWindow;else break;d=Fe(c.document)}return d}function zA(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d&&(d==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||d==="textarea"||c.contentEditable==="true")}function aB(c){var d=WE(),S=c.focusedElem,C=c.selectionRange;if(d!==S&&S&&S.ownerDocument&&FE(S.ownerDocument.documentElement,S)){if(C!==null&&zA(S)){if(d=C.start,c=C.end,c===void 0&&(c=d),"selectionStart"in S)S.selectionStart=d,S.selectionEnd=Math.min(c,S.value.length);else if(c=(d=S.ownerDocument||document)&&d.defaultView||window,c.getSelection){c=c.getSelection();var P=S.textContent.length,R=Math.min(C.start,P);C=C.end===void 0?R:Math.min(C.end,P),!c.extend&&R>C&&(P=C,C=R,R=P),P=zE(S,R);var D=zE(S,C);P&&D&&(c.rangeCount!==1||c.anchorNode!==P.node||c.anchorOffset!==P.offset||c.focusNode!==D.node||c.focusOffset!==D.offset)&&(d=d.createRange(),d.setStart(P.node,P.offset),c.removeAllRanges(),R>C?(c.addRange(d),c.extend(D.node,D.offset)):(d.setEnd(D.node,D.offset),c.addRange(d)))}}for(d=[],c=S;c=c.parentNode;)c.nodeType===1&&d.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<d.length;S++)c=d[S],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var lB=a&&"documentMode"in document&&11>=document.documentMode,Wu=null,FA=null,yp=null,WA=!1;function UE(c,d,S){var C=S.window===S?S.document:S.nodeType===9?S:S.ownerDocument;WA||Wu==null||Wu!==Fe(C)||(C=Wu,"selectionStart"in C&&zA(C)?C={start:C.selectionStart,end:C.selectionEnd}:(C=(C.ownerDocument&&C.ownerDocument.defaultView||window).getSelection(),C={anchorNode:C.anchorNode,anchorOffset:C.anchorOffset,focusNode:C.focusNode,focusOffset:C.focusOffset}),yp&&Sp(yp,C)||(yp=C,C=Dy(FA,"onSelect"),0<C.length&&(d=new MA("onSelect","select",null,d,S),c.push({event:d,listeners:C}),d.target=Wu)))}function Ly(c,d){var S={};return S[c.toLowerCase()]=d.toLowerCase(),S["Webkit"+c]="webkit"+d,S["Moz"+c]="moz"+d,S}var Uu={animationend:Ly("Animation","AnimationEnd"),animationiteration:Ly("Animation","AnimationIteration"),animationstart:Ly("Animation","AnimationStart"),transitionend:Ly("Transition","TransitionEnd")},UA={},ZE={};a&&(ZE=document.createElement("div").style,"AnimationEvent"in window||(delete Uu.animationend.animation,delete Uu.animationiteration.animation,delete Uu.animationstart.animation),"TransitionEvent"in window||delete Uu.transitionend.transition);function _y(c){if(UA[c])return UA[c];if(!Uu[c])return c;var d=Uu[c],S;for(S in d)if(d.hasOwnProperty(S)&&S in ZE)return UA[c]=d[S];return c}var $E=_y("animationend"),HE=_y("animationiteration"),VE=_y("animationstart"),qE=_y("transitionend"),GE=new Map,KE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ua(c,d){GE.set(c,d),s(d,[c])}for(var ZA=0;ZA<KE.length;ZA++){var $A=KE[ZA],cB=$A.toLowerCase(),uB=$A[0].toUpperCase()+$A.slice(1);ua(cB,"on"+uB)}ua($E,"onAnimationEnd"),ua(HE,"onAnimationIteration"),ua(VE,"onAnimationStart"),ua("dblclick","onDoubleClick"),ua("focusin","onFocus"),ua("focusout","onBlur"),ua(qE,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dB=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cp));function YE(c,d,S){var C=c.type||"unknown-event";c.currentTarget=S,c4(C,d,void 0,c),c.currentTarget=null}function XE(c,d){d=(d&4)!==0;for(var S=0;S<c.length;S++){var C=c[S],P=C.event;C=C.listeners;e:{var R=void 0;if(d)for(var D=C.length-1;0<=D;D--){var H=C[D],K=H.instance,le=H.currentTarget;if(H=H.listener,K!==R&&P.isPropagationStopped())break e;YE(P,H,le),R=K}else for(D=0;D<C.length;D++){if(H=C[D],K=H.instance,le=H.currentTarget,H=H.listener,K!==R&&P.isPropagationStopped())break e;YE(P,H,le),R=K}}}if(Sy)throw c=AA,Sy=!1,AA=null,c}function Dt(c,d){var S=d[JA];S===void 0&&(S=d[JA]=new Set);var C=c+"__bubble";S.has(C)||(JE(d,c,2,!1),S.add(C))}function HA(c,d,S){var C=0;d&&(C|=4),JE(S,c,C,d)}var Oy="_reactListening"+Math.random().toString(36).slice(2);function Ap(c){if(!c[Oy]){c[Oy]=!0,n.forEach(function(S){S!=="selectionchange"&&(dB.has(S)||HA(S,!1,c),HA(S,!0,c))});var d=c.nodeType===9?c:c.ownerDocument;d===null||d[Oy]||(d[Oy]=!0,HA("selectionchange",!1,d))}}function JE(c,d,S,C){switch(AE(d)){case 1:var P=w4;break;case 4:P=P4;break;default:P=RA}S=P.bind(null,d,S,c),P=void 0,!CA||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(P=!0),C?P!==void 0?c.addEventListener(d,S,{capture:!0,passive:P}):c.addEventListener(d,S,!0):P!==void 0?c.addEventListener(d,S,{passive:P}):c.addEventListener(d,S,!1)}function VA(c,d,S,C,P){var R=C;if((d&1)===0&&(d&2)===0&&C!==null)e:for(;;){if(C===null)return;var D=C.tag;if(D===3||D===4){var H=C.stateNode.containerInfo;if(H===P||H.nodeType===8&&H.parentNode===P)break;if(D===4)for(D=C.return;D!==null;){var K=D.tag;if((K===3||K===4)&&(K=D.stateNode.containerInfo,K===P||K.nodeType===8&&K.parentNode===P))return;D=D.return}for(;H!==null;){if(D=kl(H),D===null)return;if(K=D.tag,K===5||K===6){C=R=D;continue e}H=H.parentNode}}C=C.return}nE(function(){var le=R,me=Rl(S),Se=[];e:{var fe=GE.get(c);if(fe!==void 0){var Pe=MA,ke=c;switch(c){case"keypress":if(Iy(S)===0)break e;case"keydown":case"keyup":Pe=W4;break;case"focusin":ke="focus",Pe=_A;break;case"focusout":ke="blur",Pe=_A;break;case"beforeblur":case"afterblur":Pe=_A;break;case"click":if(S.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Pe=TE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Pe=I4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Pe=$4;break;case $E:case HE:case VE:Pe=N4;break;case qE:Pe=V4;break;case"scroll":Pe=E4;break;case"wheel":Pe=G4;break;case"copy":case"cut":case"paste":Pe=_4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Pe=PE}var Me=(d&4)!==0,sr=!Me&&c==="scroll",ie=Me?fe!==null?fe+"Capture":null:fe;Me=[];for(var Q=le,ae;Q!==null;){ae=Q;var Ce=ae.stateNode;if(ae.tag===5&&Ce!==null&&(ae=Ce,ie!==null&&(Ce=np(Q,ie),Ce!=null&&Me.push(bp(Q,Ce,ae)))),sr)break;Q=Q.return}0<Me.length&&(fe=new Pe(fe,ke,null,S,me),Se.push({event:fe,listeners:Me}))}}if((d&7)===0){e:{if(fe=c==="mouseover"||c==="pointerover",Pe=c==="mouseout"||c==="pointerout",fe&&S!==na&&(ke=S.relatedTarget||S.fromElement)&&(kl(ke)||ke[qs]))break e;if((Pe||fe)&&(fe=me.window===me?me:(fe=me.ownerDocument)?fe.defaultView||fe.parentWindow:window,Pe?(ke=S.relatedTarget||S.toElement,Pe=le,ke=ke?kl(ke):null,ke!==null&&(sr=Il(ke),ke!==sr||ke.tag!==5&&ke.tag!==6)&&(ke=null)):(Pe=null,ke=le),Pe!==ke)){if(Me=TE,Ce="onMouseLeave",ie="onMouseEnter",Q="mouse",(c==="pointerout"||c==="pointerover")&&(Me=PE,Ce="onPointerLeave",ie="onPointerEnter",Q="pointer"),sr=Pe==null?fe:Hu(Pe),ae=ke==null?fe:Hu(ke),fe=new Me(Ce,Q+"leave",Pe,S,me),fe.target=sr,fe.relatedTarget=ae,Ce=null,kl(me)===le&&(Me=new Me(ie,Q+"enter",ke,S,me),Me.target=ae,Me.relatedTarget=sr,Ce=Me),sr=Ce,Pe&&ke)t:{for(Me=Pe,ie=ke,Q=0,ae=Me;ae;ae=Zu(ae))Q++;for(ae=0,Ce=ie;Ce;Ce=Zu(Ce))ae++;for(;0<Q-ae;)Me=Zu(Me),Q--;for(;0<ae-Q;)ie=Zu(ie),ae--;for(;Q--;){if(Me===ie||ie!==null&&Me===ie.alternate)break t;Me=Zu(Me),ie=Zu(ie)}Me=null}else Me=null;Pe!==null&&QE(Se,fe,Pe,Me,!1),ke!==null&&sr!==null&&QE(Se,sr,ke,Me,!0)}}e:{if(fe=le?Hu(le):window,Pe=fe.nodeName&&fe.nodeName.toLowerCase(),Pe==="select"||Pe==="input"&&fe.type==="file")var Le=tB;else if(NE(fe))if(_E)Le=sB;else{Le=nB;var De=rB}else(Pe=fe.nodeName)&&Pe.toLowerCase()==="input"&&(fe.type==="checkbox"||fe.type==="radio")&&(Le=iB);if(Le&&(Le=Le(c,le))){LE(Se,Le,S,me);break e}De&&De(c,fe,le),c==="focusout"&&(De=fe._wrapperState)&&De.controlled&&fe.type==="number"&&at(fe,"number",fe.value)}switch(De=le?Hu(le):window,c){case"focusin":(NE(De)||De.contentEditable==="true")&&(Wu=De,FA=le,yp=null);break;case"focusout":yp=FA=Wu=null;break;case"mousedown":WA=!0;break;case"contextmenu":case"mouseup":case"dragend":WA=!1,UE(Se,S,me);break;case"selectionchange":if(lB)break;case"keydown":case"keyup":UE(Se,S,me)}var je;if(DA)e:{switch(c){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else Fu?kE(c,S)&&(Ze="onCompositionEnd"):c==="keydown"&&S.keyCode===229&&(Ze="onCompositionStart");Ze&&(EE&&S.locale!=="ko"&&(Fu||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&Fu&&(je=bE()):(ca=me,kA="value"in ca?ca.value:ca.textContent,Fu=!0)),De=Dy(le,Ze),0<De.length&&(Ze=new wE(Ze,c,null,S,me),Se.push({event:Ze,listeners:De}),je?Ze.data=je:(je=ME(S),je!==null&&(Ze.data=je)))),(je=Y4?X4(c,S):J4(c,S))&&(le=Dy(le,"onBeforeInput"),0<le.length&&(me=new wE("onBeforeInput","beforeinput",null,S,me),Se.push({event:me,listeners:le}),me.data=je))}XE(Se,d)})}function bp(c,d,S){return{instance:c,listener:d,currentTarget:S}}function Dy(c,d){for(var S=d+"Capture",C=[];c!==null;){var P=c,R=P.stateNode;P.tag===5&&R!==null&&(P=R,R=np(c,S),R!=null&&C.unshift(bp(c,R,P)),R=np(c,d),R!=null&&C.push(bp(c,R,P))),c=c.return}return C}function Zu(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function QE(c,d,S,C,P){for(var R=d._reactName,D=[];S!==null&&S!==C;){var H=S,K=H.alternate,le=H.stateNode;if(K!==null&&K===C)break;H.tag===5&&le!==null&&(H=le,P?(K=np(S,R),K!=null&&D.unshift(bp(S,K,H))):P||(K=np(S,R),K!=null&&D.push(bp(S,K,H)))),S=S.return}D.length!==0&&c.push({event:d,listeners:D})}var hB=/\r\n?/g,pB=/\u0000|\uFFFD/g;function e1(c){return(typeof c=="string"?c:""+c).replace(hB,`
`).replace(pB,"")}function jy(c,d,S){if(d=e1(d),e1(c)!==d&&S)throw Error(t(425))}function By(){}var qA=null,GA=null;function KA(c,d){return c==="textarea"||c==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var YA=typeof setTimeout=="function"?setTimeout:void 0,fB=typeof clearTimeout=="function"?clearTimeout:void 0,t1=typeof Promise=="function"?Promise:void 0,mB=typeof queueMicrotask=="function"?queueMicrotask:typeof t1<"u"?function(c){return t1.resolve(null).then(c).catch(gB)}:YA;function gB(c){setTimeout(function(){throw c})}function XA(c,d){var S=d,C=0;do{var P=S.nextSibling;if(c.removeChild(S),P&&P.nodeType===8)if(S=P.data,S==="/$"){if(C===0){c.removeChild(P),hp(d);return}C--}else S!=="$"&&S!=="$?"&&S!=="$!"||C++;S=P}while(S);hp(d)}function da(c){for(;c!=null;c=c.nextSibling){var d=c.nodeType;if(d===1||d===3)break;if(d===8){if(d=c.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return c}function r1(c){c=c.previousSibling;for(var d=0;c;){if(c.nodeType===8){var S=c.data;if(S==="$"||S==="$!"||S==="$?"){if(d===0)return c;d--}else S==="/$"&&d++}c=c.previousSibling}return null}var $u=Math.random().toString(36).slice(2),ds="__reactFiber$"+$u,xp="__reactProps$"+$u,qs="__reactContainer$"+$u,JA="__reactEvents$"+$u,vB="__reactListeners$"+$u,SB="__reactHandles$"+$u;function kl(c){var d=c[ds];if(d)return d;for(var S=c.parentNode;S;){if(d=S[qs]||S[ds]){if(S=d.alternate,d.child!==null||S!==null&&S.child!==null)for(c=r1(c);c!==null;){if(S=c[ds])return S;c=r1(c)}return d}c=S,S=c.parentNode}return null}function Tp(c){return c=c[ds]||c[qs],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function Hu(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function zy(c){return c[xp]||null}var QA=[],Vu=-1;function ha(c){return{current:c}}function jt(c){0>Vu||(c.current=QA[Vu],QA[Vu]=null,Vu--)}function Mt(c,d){Vu++,QA[Vu]=c.current,c.current=d}var pa={},Zr=ha(pa),fn=ha(!1),Ml=pa;function qu(c,d){var S=c.type.contextTypes;if(!S)return pa;var C=c.stateNode;if(C&&C.__reactInternalMemoizedUnmaskedChildContext===d)return C.__reactInternalMemoizedMaskedChildContext;var P={},R;for(R in S)P[R]=d[R];return C&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=d,c.__reactInternalMemoizedMaskedChildContext=P),P}function mn(c){return c=c.childContextTypes,c!=null}function Fy(){jt(fn),jt(Zr)}function n1(c,d,S){if(Zr.current!==pa)throw Error(t(168));Mt(Zr,d),Mt(fn,S)}function i1(c,d,S){var C=c.stateNode;if(d=d.childContextTypes,typeof C.getChildContext!="function")return S;C=C.getChildContext();for(var P in C)if(!(P in d))throw Error(t(108,F(c)||"Unknown",P));return ne({},S,C)}function Wy(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||pa,Ml=Zr.current,Mt(Zr,c),Mt(fn,fn.current),!0}function s1(c,d,S){var C=c.stateNode;if(!C)throw Error(t(169));S?(c=i1(c,d,Ml),C.__reactInternalMemoizedMergedChildContext=c,jt(fn),jt(Zr),Mt(Zr,c)):jt(fn),Mt(fn,S)}var Gs=null,Uy=!1,eb=!1;function o1(c){Gs===null?Gs=[c]:Gs.push(c)}function yB(c){Uy=!0,o1(c)}function fa(){if(!eb&&Gs!==null){eb=!0;var c=0,d=mt;try{var S=Gs;for(mt=1;c<S.length;c++){var C=S[c];do C=C(!0);while(C!==null)}Gs=null,Uy=!1}catch(P){throw Gs!==null&&(Gs=Gs.slice(c+1)),lE(bA,fa),P}finally{mt=d,eb=!1}}return null}var Gu=[],Ku=0,Zy=null,$y=0,ci=[],ui=0,Nl=null,Ks=1,Ys="";function Ll(c,d){Gu[Ku++]=$y,Gu[Ku++]=Zy,Zy=c,$y=d}function a1(c,d,S){ci[ui++]=Ks,ci[ui++]=Ys,ci[ui++]=Nl,Nl=c;var C=Ks;c=Ys;var P=32-Ni(C)-1;C&=~(1<<P),S+=1;var R=32-Ni(d)+P;if(30<R){var D=P-P%5;R=(C&(1<<D)-1).toString(32),C>>=D,P-=D,Ks=1<<32-Ni(d)+P|S<<P|C,Ys=R+c}else Ks=1<<R|S<<P|C,Ys=c}function tb(c){c.return!==null&&(Ll(c,1),a1(c,1,0))}function rb(c){for(;c===Zy;)Zy=Gu[--Ku],Gu[Ku]=null,$y=Gu[--Ku],Gu[Ku]=null;for(;c===Nl;)Nl=ci[--ui],ci[ui]=null,Ys=ci[--ui],ci[ui]=null,Ks=ci[--ui],ci[ui]=null}var Mn=null,Nn=null,zt=!1,_i=null;function l1(c,d){var S=fi(5,null,null,0);S.elementType="DELETED",S.stateNode=d,S.return=c,d=c.deletions,d===null?(c.deletions=[S],c.flags|=16):d.push(S)}function c1(c,d){switch(c.tag){case 5:var S=c.type;return d=d.nodeType!==1||S.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(c.stateNode=d,Mn=c,Nn=da(d.firstChild),!0):!1;case 6:return d=c.pendingProps===""||d.nodeType!==3?null:d,d!==null?(c.stateNode=d,Mn=c,Nn=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(S=Nl!==null?{id:Ks,overflow:Ys}:null,c.memoizedState={dehydrated:d,treeContext:S,retryLane:1073741824},S=fi(18,null,null,0),S.stateNode=d,S.return=c,c.child=S,Mn=c,Nn=null,!0):!1;default:return!1}}function nb(c){return(c.mode&1)!==0&&(c.flags&128)===0}function ib(c){if(zt){var d=Nn;if(d){var S=d;if(!c1(c,d)){if(nb(c))throw Error(t(418));d=da(S.nextSibling);var C=Mn;d&&c1(c,d)?l1(C,S):(c.flags=c.flags&-4097|2,zt=!1,Mn=c)}}else{if(nb(c))throw Error(t(418));c.flags=c.flags&-4097|2,zt=!1,Mn=c}}}function u1(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Mn=c}function Hy(c){if(c!==Mn)return!1;if(!zt)return u1(c),zt=!0,!1;var d;if((d=c.tag!==3)&&!(d=c.tag!==5)&&(d=c.type,d=d!=="head"&&d!=="body"&&!KA(c.type,c.memoizedProps)),d&&(d=Nn)){if(nb(c))throw d1(),Error(t(418));for(;d;)l1(c,d),d=da(d.nextSibling)}if(u1(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,d=0;c;){if(c.nodeType===8){var S=c.data;if(S==="/$"){if(d===0){Nn=da(c.nextSibling);break e}d--}else S!=="$"&&S!=="$!"&&S!=="$?"||d++}c=c.nextSibling}Nn=null}}else Nn=Mn?da(c.stateNode.nextSibling):null;return!0}function d1(){for(var c=Nn;c;)c=da(c.nextSibling)}function Yu(){Nn=Mn=null,zt=!1}function sb(c){_i===null?_i=[c]:_i.push(c)}var CB=k.ReactCurrentBatchConfig;function wp(c,d,S){if(c=S.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(S._owner){if(S=S._owner,S){if(S.tag!==1)throw Error(t(309));var C=S.stateNode}if(!C)throw Error(t(147,c));var P=C,R=""+c;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===R?d.ref:(d=function(D){var H=P.refs;D===null?delete H[R]:H[R]=D},d._stringRef=R,d)}if(typeof c!="string")throw Error(t(284));if(!S._owner)throw Error(t(290,c))}return c}function Vy(c,d){throw c=Object.prototype.toString.call(d),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":c))}function h1(c){var d=c._init;return d(c._payload)}function p1(c){function d(ie,Q){if(c){var ae=ie.deletions;ae===null?(ie.deletions=[Q],ie.flags|=16):ae.push(Q)}}function S(ie,Q){if(!c)return null;for(;Q!==null;)d(ie,Q),Q=Q.sibling;return null}function C(ie,Q){for(ie=new Map;Q!==null;)Q.key!==null?ie.set(Q.key,Q):ie.set(Q.index,Q),Q=Q.sibling;return ie}function P(ie,Q){return ie=ba(ie,Q),ie.index=0,ie.sibling=null,ie}function R(ie,Q,ae){return ie.index=ae,c?(ae=ie.alternate,ae!==null?(ae=ae.index,ae<Q?(ie.flags|=2,Q):ae):(ie.flags|=2,Q)):(ie.flags|=1048576,Q)}function D(ie){return c&&ie.alternate===null&&(ie.flags|=2),ie}function H(ie,Q,ae,Ce){return Q===null||Q.tag!==6?(Q=Yb(ae,ie.mode,Ce),Q.return=ie,Q):(Q=P(Q,ae),Q.return=ie,Q)}function K(ie,Q,ae,Ce){var Le=ae.type;return Le===L?me(ie,Q,ae.props.children,Ce,ae.key):Q!==null&&(Q.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===X&&h1(Le)===Q.type)?(Ce=P(Q,ae.props),Ce.ref=wp(ie,Q,ae),Ce.return=ie,Ce):(Ce=g0(ae.type,ae.key,ae.props,null,ie.mode,Ce),Ce.ref=wp(ie,Q,ae),Ce.return=ie,Ce)}function le(ie,Q,ae,Ce){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==ae.containerInfo||Q.stateNode.implementation!==ae.implementation?(Q=Xb(ae,ie.mode,Ce),Q.return=ie,Q):(Q=P(Q,ae.children||[]),Q.return=ie,Q)}function me(ie,Q,ae,Ce,Le){return Q===null||Q.tag!==7?(Q=Wl(ae,ie.mode,Ce,Le),Q.return=ie,Q):(Q=P(Q,ae),Q.return=ie,Q)}function Se(ie,Q,ae){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=Yb(""+Q,ie.mode,ae),Q.return=ie,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case I:return ae=g0(Q.type,Q.key,Q.props,null,ie.mode,ae),ae.ref=wp(ie,null,Q),ae.return=ie,ae;case M:return Q=Xb(Q,ie.mode,ae),Q.return=ie,Q;case X:var Ce=Q._init;return Se(ie,Ce(Q._payload),ae)}if(be(Q)||J(Q))return Q=Wl(Q,ie.mode,ae,null),Q.return=ie,Q;Vy(ie,Q)}return null}function fe(ie,Q,ae,Ce){var Le=Q!==null?Q.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number")return Le!==null?null:H(ie,Q,""+ae,Ce);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case I:return ae.key===Le?K(ie,Q,ae,Ce):null;case M:return ae.key===Le?le(ie,Q,ae,Ce):null;case X:return Le=ae._init,fe(ie,Q,Le(ae._payload),Ce)}if(be(ae)||J(ae))return Le!==null?null:me(ie,Q,ae,Ce,null);Vy(ie,ae)}return null}function Pe(ie,Q,ae,Ce,Le){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return ie=ie.get(ae)||null,H(Q,ie,""+Ce,Le);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case I:return ie=ie.get(Ce.key===null?ae:Ce.key)||null,K(Q,ie,Ce,Le);case M:return ie=ie.get(Ce.key===null?ae:Ce.key)||null,le(Q,ie,Ce,Le);case X:var De=Ce._init;return Pe(ie,Q,ae,De(Ce._payload),Le)}if(be(Ce)||J(Ce))return ie=ie.get(ae)||null,me(Q,ie,Ce,Le,null);Vy(Q,Ce)}return null}function ke(ie,Q,ae,Ce){for(var Le=null,De=null,je=Q,Ze=Q=0,Tr=null;je!==null&&Ze<ae.length;Ze++){je.index>Ze?(Tr=je,je=null):Tr=je.sibling;var ht=fe(ie,je,ae[Ze],Ce);if(ht===null){je===null&&(je=Tr);break}c&&je&&ht.alternate===null&&d(ie,je),Q=R(ht,Q,Ze),De===null?Le=ht:De.sibling=ht,De=ht,je=Tr}if(Ze===ae.length)return S(ie,je),zt&&Ll(ie,Ze),Le;if(je===null){for(;Ze<ae.length;Ze++)je=Se(ie,ae[Ze],Ce),je!==null&&(Q=R(je,Q,Ze),De===null?Le=je:De.sibling=je,De=je);return zt&&Ll(ie,Ze),Le}for(je=C(ie,je);Ze<ae.length;Ze++)Tr=Pe(je,ie,Ze,ae[Ze],Ce),Tr!==null&&(c&&Tr.alternate!==null&&je.delete(Tr.key===null?Ze:Tr.key),Q=R(Tr,Q,Ze),De===null?Le=Tr:De.sibling=Tr,De=Tr);return c&&je.forEach(function(xa){return d(ie,xa)}),zt&&Ll(ie,Ze),Le}function Me(ie,Q,ae,Ce){var Le=J(ae);if(typeof Le!="function")throw Error(t(150));if(ae=Le.call(ae),ae==null)throw Error(t(151));for(var De=Le=null,je=Q,Ze=Q=0,Tr=null,ht=ae.next();je!==null&&!ht.done;Ze++,ht=ae.next()){je.index>Ze?(Tr=je,je=null):Tr=je.sibling;var xa=fe(ie,je,ht.value,Ce);if(xa===null){je===null&&(je=Tr);break}c&&je&&xa.alternate===null&&d(ie,je),Q=R(xa,Q,Ze),De===null?Le=xa:De.sibling=xa,De=xa,je=Tr}if(ht.done)return S(ie,je),zt&&Ll(ie,Ze),Le;if(je===null){for(;!ht.done;Ze++,ht=ae.next())ht=Se(ie,ht.value,Ce),ht!==null&&(Q=R(ht,Q,Ze),De===null?Le=ht:De.sibling=ht,De=ht);return zt&&Ll(ie,Ze),Le}for(je=C(ie,je);!ht.done;Ze++,ht=ae.next())ht=Pe(je,ie,Ze,ht.value,Ce),ht!==null&&(c&&ht.alternate!==null&&je.delete(ht.key===null?Ze:ht.key),Q=R(ht,Q,Ze),De===null?Le=ht:De.sibling=ht,De=ht);return c&&je.forEach(function(QB){return d(ie,QB)}),zt&&Ll(ie,Ze),Le}function sr(ie,Q,ae,Ce){if(typeof ae=="object"&&ae!==null&&ae.type===L&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case I:e:{for(var Le=ae.key,De=Q;De!==null;){if(De.key===Le){if(Le=ae.type,Le===L){if(De.tag===7){S(ie,De.sibling),Q=P(De,ae.props.children),Q.return=ie,ie=Q;break e}}else if(De.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===X&&h1(Le)===De.type){S(ie,De.sibling),Q=P(De,ae.props),Q.ref=wp(ie,De,ae),Q.return=ie,ie=Q;break e}S(ie,De);break}else d(ie,De);De=De.sibling}ae.type===L?(Q=Wl(ae.props.children,ie.mode,Ce,ae.key),Q.return=ie,ie=Q):(Ce=g0(ae.type,ae.key,ae.props,null,ie.mode,Ce),Ce.ref=wp(ie,Q,ae),Ce.return=ie,ie=Ce)}return D(ie);case M:e:{for(De=ae.key;Q!==null;){if(Q.key===De)if(Q.tag===4&&Q.stateNode.containerInfo===ae.containerInfo&&Q.stateNode.implementation===ae.implementation){S(ie,Q.sibling),Q=P(Q,ae.children||[]),Q.return=ie,ie=Q;break e}else{S(ie,Q);break}else d(ie,Q);Q=Q.sibling}Q=Xb(ae,ie.mode,Ce),Q.return=ie,ie=Q}return D(ie);case X:return De=ae._init,sr(ie,Q,De(ae._payload),Ce)}if(be(ae))return ke(ie,Q,ae,Ce);if(J(ae))return Me(ie,Q,ae,Ce);Vy(ie,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"?(ae=""+ae,Q!==null&&Q.tag===6?(S(ie,Q.sibling),Q=P(Q,ae),Q.return=ie,ie=Q):(S(ie,Q),Q=Yb(ae,ie.mode,Ce),Q.return=ie,ie=Q),D(ie)):S(ie,Q)}return sr}var Xu=p1(!0),f1=p1(!1),qy=ha(null),Gy=null,Ju=null,ob=null;function ab(){ob=Ju=Gy=null}function lb(c){var d=qy.current;jt(qy),c._currentValue=d}function cb(c,d,S){for(;c!==null;){var C=c.alternate;if((c.childLanes&d)!==d?(c.childLanes|=d,C!==null&&(C.childLanes|=d)):C!==null&&(C.childLanes&d)!==d&&(C.childLanes|=d),c===S)break;c=c.return}}function Qu(c,d){Gy=c,ob=Ju=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&d)!==0&&(gn=!0),c.firstContext=null)}function di(c){var d=c._currentValue;if(ob!==c)if(c={context:c,memoizedValue:d,next:null},Ju===null){if(Gy===null)throw Error(t(308));Ju=c,Gy.dependencies={lanes:0,firstContext:c}}else Ju=Ju.next=c;return d}var _l=null;function ub(c){_l===null?_l=[c]:_l.push(c)}function m1(c,d,S,C){var P=d.interleaved;return P===null?(S.next=S,ub(d)):(S.next=P.next,P.next=S),d.interleaved=S,Xs(c,C)}function Xs(c,d){c.lanes|=d;var S=c.alternate;for(S!==null&&(S.lanes|=d),S=c,c=c.return;c!==null;)c.childLanes|=d,S=c.alternate,S!==null&&(S.childLanes|=d),S=c,c=c.return;return S.tag===3?S.stateNode:null}var ma=!1;function db(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function g1(c,d){c=c.updateQueue,d.updateQueue===c&&(d.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function Js(c,d){return{eventTime:c,lane:d,tag:0,payload:null,callback:null,next:null}}function ga(c,d,S){var C=c.updateQueue;if(C===null)return null;if(C=C.shared,(ct&2)!==0){var P=C.pending;return P===null?d.next=d:(d.next=P.next,P.next=d),C.pending=d,Xs(c,S)}return P=C.interleaved,P===null?(d.next=d,ub(C)):(d.next=P.next,P.next=d),C.interleaved=d,Xs(c,S)}function Ky(c,d,S){if(d=d.updateQueue,d!==null&&(d=d.shared,(S&4194240)!==0)){var C=d.lanes;C&=c.pendingLanes,S|=C,d.lanes=S,wA(c,S)}}function v1(c,d){var S=c.updateQueue,C=c.alternate;if(C!==null&&(C=C.updateQueue,S===C)){var P=null,R=null;if(S=S.firstBaseUpdate,S!==null){do{var D={eventTime:S.eventTime,lane:S.lane,tag:S.tag,payload:S.payload,callback:S.callback,next:null};R===null?P=R=D:R=R.next=D,S=S.next}while(S!==null);R===null?P=R=d:R=R.next=d}else P=R=d;S={baseState:C.baseState,firstBaseUpdate:P,lastBaseUpdate:R,shared:C.shared,effects:C.effects},c.updateQueue=S;return}c=S.lastBaseUpdate,c===null?S.firstBaseUpdate=d:c.next=d,S.lastBaseUpdate=d}function Yy(c,d,S,C){var P=c.updateQueue;ma=!1;var R=P.firstBaseUpdate,D=P.lastBaseUpdate,H=P.shared.pending;if(H!==null){P.shared.pending=null;var K=H,le=K.next;K.next=null,D===null?R=le:D.next=le,D=K;var me=c.alternate;me!==null&&(me=me.updateQueue,H=me.lastBaseUpdate,H!==D&&(H===null?me.firstBaseUpdate=le:H.next=le,me.lastBaseUpdate=K))}if(R!==null){var Se=P.baseState;D=0,me=le=K=null,H=R;do{var fe=H.lane,Pe=H.eventTime;if((C&fe)===fe){me!==null&&(me=me.next={eventTime:Pe,lane:0,tag:H.tag,payload:H.payload,callback:H.callback,next:null});e:{var ke=c,Me=H;switch(fe=d,Pe=S,Me.tag){case 1:if(ke=Me.payload,typeof ke=="function"){Se=ke.call(Pe,Se,fe);break e}Se=ke;break e;case 3:ke.flags=ke.flags&-65537|128;case 0:if(ke=Me.payload,fe=typeof ke=="function"?ke.call(Pe,Se,fe):ke,fe==null)break e;Se=ne({},Se,fe);break e;case 2:ma=!0}}H.callback!==null&&H.lane!==0&&(c.flags|=64,fe=P.effects,fe===null?P.effects=[H]:fe.push(H))}else Pe={eventTime:Pe,lane:fe,tag:H.tag,payload:H.payload,callback:H.callback,next:null},me===null?(le=me=Pe,K=Se):me=me.next=Pe,D|=fe;if(H=H.next,H===null){if(H=P.shared.pending,H===null)break;fe=H,H=fe.next,fe.next=null,P.lastBaseUpdate=fe,P.shared.pending=null}}while(!0);if(me===null&&(K=Se),P.baseState=K,P.firstBaseUpdate=le,P.lastBaseUpdate=me,d=P.shared.interleaved,d!==null){P=d;do D|=P.lane,P=P.next;while(P!==d)}else R===null&&(P.shared.lanes=0);jl|=D,c.lanes=D,c.memoizedState=Se}}function S1(c,d,S){if(c=d.effects,d.effects=null,c!==null)for(d=0;d<c.length;d++){var C=c[d],P=C.callback;if(P!==null){if(C.callback=null,C=S,typeof P!="function")throw Error(t(191,P));P.call(C)}}}var Pp={},hs=ha(Pp),Ep=ha(Pp),Rp=ha(Pp);function Ol(c){if(c===Pp)throw Error(t(174));return c}function hb(c,d){switch(Mt(Rp,d),Mt(Ep,c),Mt(hs,Pp),c=d.nodeType,c){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:Qe(null,"");break;default:c=c===8?d.parentNode:d,d=c.namespaceURI||null,c=c.tagName,d=Qe(d,c)}jt(hs),Mt(hs,d)}function ed(){jt(hs),jt(Ep),jt(Rp)}function y1(c){Ol(Rp.current);var d=Ol(hs.current),S=Qe(d,c.type);d!==S&&(Mt(Ep,c),Mt(hs,S))}function pb(c){Ep.current===c&&(jt(hs),jt(Ep))}var Zt=ha(0);function Xy(c){for(var d=c;d!==null;){if(d.tag===13){var S=d.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||S.data==="$?"||S.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var fb=[];function mb(){for(var c=0;c<fb.length;c++)fb[c]._workInProgressVersionPrimary=null;fb.length=0}var Jy=k.ReactCurrentDispatcher,gb=k.ReactCurrentBatchConfig,Dl=0,$t=null,pr=null,br=null,Qy=!1,Ip=!1,kp=0,AB=0;function $r(){throw Error(t(321))}function vb(c,d){if(d===null)return!1;for(var S=0;S<d.length&&S<c.length;S++)if(!Li(c[S],d[S]))return!1;return!0}function Sb(c,d,S,C,P,R){if(Dl=R,$t=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,Jy.current=c===null||c.memoizedState===null?wB:PB,c=S(C,P),Ip){R=0;do{if(Ip=!1,kp=0,25<=R)throw Error(t(301));R+=1,br=pr=null,d.updateQueue=null,Jy.current=EB,c=S(C,P)}while(Ip)}if(Jy.current=r0,d=pr!==null&&pr.next!==null,Dl=0,br=pr=$t=null,Qy=!1,d)throw Error(t(300));return c}function yb(){var c=kp!==0;return kp=0,c}function ps(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return br===null?$t.memoizedState=br=c:br=br.next=c,br}function hi(){if(pr===null){var c=$t.alternate;c=c!==null?c.memoizedState:null}else c=pr.next;var d=br===null?$t.memoizedState:br.next;if(d!==null)br=d,pr=c;else{if(c===null)throw Error(t(310));pr=c,c={memoizedState:pr.memoizedState,baseState:pr.baseState,baseQueue:pr.baseQueue,queue:pr.queue,next:null},br===null?$t.memoizedState=br=c:br=br.next=c}return br}function Mp(c,d){return typeof d=="function"?d(c):d}function Cb(c){var d=hi(),S=d.queue;if(S===null)throw Error(t(311));S.lastRenderedReducer=c;var C=pr,P=C.baseQueue,R=S.pending;if(R!==null){if(P!==null){var D=P.next;P.next=R.next,R.next=D}C.baseQueue=P=R,S.pending=null}if(P!==null){R=P.next,C=C.baseState;var H=D=null,K=null,le=R;do{var me=le.lane;if((Dl&me)===me)K!==null&&(K=K.next={lane:0,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),C=le.hasEagerState?le.eagerState:c(C,le.action);else{var Se={lane:me,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null};K===null?(H=K=Se,D=C):K=K.next=Se,$t.lanes|=me,jl|=me}le=le.next}while(le!==null&&le!==R);K===null?D=C:K.next=H,Li(C,d.memoizedState)||(gn=!0),d.memoizedState=C,d.baseState=D,d.baseQueue=K,S.lastRenderedState=C}if(c=S.interleaved,c!==null){P=c;do R=P.lane,$t.lanes|=R,jl|=R,P=P.next;while(P!==c)}else P===null&&(S.lanes=0);return[d.memoizedState,S.dispatch]}function Ab(c){var d=hi(),S=d.queue;if(S===null)throw Error(t(311));S.lastRenderedReducer=c;var C=S.dispatch,P=S.pending,R=d.memoizedState;if(P!==null){S.pending=null;var D=P=P.next;do R=c(R,D.action),D=D.next;while(D!==P);Li(R,d.memoizedState)||(gn=!0),d.memoizedState=R,d.baseQueue===null&&(d.baseState=R),S.lastRenderedState=R}return[R,C]}function C1(){}function A1(c,d){var S=$t,C=hi(),P=d(),R=!Li(C.memoizedState,P);if(R&&(C.memoizedState=P,gn=!0),C=C.queue,bb(T1.bind(null,S,C,c),[c]),C.getSnapshot!==d||R||br!==null&&br.memoizedState.tag&1){if(S.flags|=2048,Np(9,x1.bind(null,S,C,P,d),void 0,null),xr===null)throw Error(t(349));(Dl&30)!==0||b1(S,d,P)}return P}function b1(c,d,S){c.flags|=16384,c={getSnapshot:d,value:S},d=$t.updateQueue,d===null?(d={lastEffect:null,stores:null},$t.updateQueue=d,d.stores=[c]):(S=d.stores,S===null?d.stores=[c]:S.push(c))}function x1(c,d,S,C){d.value=S,d.getSnapshot=C,w1(d)&&P1(c)}function T1(c,d,S){return S(function(){w1(d)&&P1(c)})}function w1(c){var d=c.getSnapshot;c=c.value;try{var S=d();return!Li(c,S)}catch{return!0}}function P1(c){var d=Xs(c,1);d!==null&&Bi(d,c,1,-1)}function E1(c){var d=ps();return typeof c=="function"&&(c=c()),d.memoizedState=d.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mp,lastRenderedState:c},d.queue=c,c=c.dispatch=TB.bind(null,$t,c),[d.memoizedState,c]}function Np(c,d,S,C){return c={tag:c,create:d,destroy:S,deps:C,next:null},d=$t.updateQueue,d===null?(d={lastEffect:null,stores:null},$t.updateQueue=d,d.lastEffect=c.next=c):(S=d.lastEffect,S===null?d.lastEffect=c.next=c:(C=S.next,S.next=c,c.next=C,d.lastEffect=c)),c}function R1(){return hi().memoizedState}function e0(c,d,S,C){var P=ps();$t.flags|=c,P.memoizedState=Np(1|d,S,void 0,C===void 0?null:C)}function t0(c,d,S,C){var P=hi();C=C===void 0?null:C;var R=void 0;if(pr!==null){var D=pr.memoizedState;if(R=D.destroy,C!==null&&vb(C,D.deps)){P.memoizedState=Np(d,S,R,C);return}}$t.flags|=c,P.memoizedState=Np(1|d,S,R,C)}function I1(c,d){return e0(8390656,8,c,d)}function bb(c,d){return t0(2048,8,c,d)}function k1(c,d){return t0(4,2,c,d)}function M1(c,d){return t0(4,4,c,d)}function N1(c,d){if(typeof d=="function")return c=c(),d(c),function(){d(null)};if(d!=null)return c=c(),d.current=c,function(){d.current=null}}function L1(c,d,S){return S=S!=null?S.concat([c]):null,t0(4,4,N1.bind(null,d,c),S)}function xb(){}function _1(c,d){var S=hi();d=d===void 0?null:d;var C=S.memoizedState;return C!==null&&d!==null&&vb(d,C[1])?C[0]:(S.memoizedState=[c,d],c)}function O1(c,d){var S=hi();d=d===void 0?null:d;var C=S.memoizedState;return C!==null&&d!==null&&vb(d,C[1])?C[0]:(c=c(),S.memoizedState=[c,d],c)}function D1(c,d,S){return(Dl&21)===0?(c.baseState&&(c.baseState=!1,gn=!0),c.memoizedState=S):(Li(S,d)||(S=hE(),$t.lanes|=S,jl|=S,c.baseState=!0),d)}function bB(c,d){var S=mt;mt=S!==0&&4>S?S:4,c(!0);var C=gb.transition;gb.transition={};try{c(!1),d()}finally{mt=S,gb.transition=C}}function j1(){return hi().memoizedState}function xB(c,d,S){var C=Ca(c);if(S={lane:C,action:S,hasEagerState:!1,eagerState:null,next:null},B1(c))z1(d,S);else if(S=m1(c,d,S,C),S!==null){var P=rn();Bi(S,c,C,P),F1(S,d,C)}}function TB(c,d,S){var C=Ca(c),P={lane:C,action:S,hasEagerState:!1,eagerState:null,next:null};if(B1(c))z1(d,P);else{var R=c.alternate;if(c.lanes===0&&(R===null||R.lanes===0)&&(R=d.lastRenderedReducer,R!==null))try{var D=d.lastRenderedState,H=R(D,S);if(P.hasEagerState=!0,P.eagerState=H,Li(H,D)){var K=d.interleaved;K===null?(P.next=P,ub(d)):(P.next=K.next,K.next=P),d.interleaved=P;return}}catch{}finally{}S=m1(c,d,P,C),S!==null&&(P=rn(),Bi(S,c,C,P),F1(S,d,C))}}function B1(c){var d=c.alternate;return c===$t||d!==null&&d===$t}function z1(c,d){Ip=Qy=!0;var S=c.pending;S===null?d.next=d:(d.next=S.next,S.next=d),c.pending=d}function F1(c,d,S){if((S&4194240)!==0){var C=d.lanes;C&=c.pendingLanes,S|=C,d.lanes=S,wA(c,S)}}var r0={readContext:di,useCallback:$r,useContext:$r,useEffect:$r,useImperativeHandle:$r,useInsertionEffect:$r,useLayoutEffect:$r,useMemo:$r,useReducer:$r,useRef:$r,useState:$r,useDebugValue:$r,useDeferredValue:$r,useTransition:$r,useMutableSource:$r,useSyncExternalStore:$r,useId:$r,unstable_isNewReconciler:!1},wB={readContext:di,useCallback:function(c,d){return ps().memoizedState=[c,d===void 0?null:d],c},useContext:di,useEffect:I1,useImperativeHandle:function(c,d,S){return S=S!=null?S.concat([c]):null,e0(4194308,4,N1.bind(null,d,c),S)},useLayoutEffect:function(c,d){return e0(4194308,4,c,d)},useInsertionEffect:function(c,d){return e0(4,2,c,d)},useMemo:function(c,d){var S=ps();return d=d===void 0?null:d,c=c(),S.memoizedState=[c,d],c},useReducer:function(c,d,S){var C=ps();return d=S!==void 0?S(d):d,C.memoizedState=C.baseState=d,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:d},C.queue=c,c=c.dispatch=xB.bind(null,$t,c),[C.memoizedState,c]},useRef:function(c){var d=ps();return c={current:c},d.memoizedState=c},useState:E1,useDebugValue:xb,useDeferredValue:function(c){return ps().memoizedState=c},useTransition:function(){var c=E1(!1),d=c[0];return c=bB.bind(null,c[1]),ps().memoizedState=c,[d,c]},useMutableSource:function(){},useSyncExternalStore:function(c,d,S){var C=$t,P=ps();if(zt){if(S===void 0)throw Error(t(407));S=S()}else{if(S=d(),xr===null)throw Error(t(349));(Dl&30)!==0||b1(C,d,S)}P.memoizedState=S;var R={value:S,getSnapshot:d};return P.queue=R,I1(T1.bind(null,C,R,c),[c]),C.flags|=2048,Np(9,x1.bind(null,C,R,S,d),void 0,null),S},useId:function(){var c=ps(),d=xr.identifierPrefix;if(zt){var S=Ys,C=Ks;S=(C&~(1<<32-Ni(C)-1)).toString(32)+S,d=":"+d+"R"+S,S=kp++,0<S&&(d+="H"+S.toString(32)),d+=":"}else S=AB++,d=":"+d+"r"+S.toString(32)+":";return c.memoizedState=d},unstable_isNewReconciler:!1},PB={readContext:di,useCallback:_1,useContext:di,useEffect:bb,useImperativeHandle:L1,useInsertionEffect:k1,useLayoutEffect:M1,useMemo:O1,useReducer:Cb,useRef:R1,useState:function(){return Cb(Mp)},useDebugValue:xb,useDeferredValue:function(c){var d=hi();return D1(d,pr.memoizedState,c)},useTransition:function(){var c=Cb(Mp)[0],d=hi().memoizedState;return[c,d]},useMutableSource:C1,useSyncExternalStore:A1,useId:j1,unstable_isNewReconciler:!1},EB={readContext:di,useCallback:_1,useContext:di,useEffect:bb,useImperativeHandle:L1,useInsertionEffect:k1,useLayoutEffect:M1,useMemo:O1,useReducer:Ab,useRef:R1,useState:function(){return Ab(Mp)},useDebugValue:xb,useDeferredValue:function(c){var d=hi();return pr===null?d.memoizedState=c:D1(d,pr.memoizedState,c)},useTransition:function(){var c=Ab(Mp)[0],d=hi().memoizedState;return[c,d]},useMutableSource:C1,useSyncExternalStore:A1,useId:j1,unstable_isNewReconciler:!1};function Oi(c,d){if(c&&c.defaultProps){d=ne({},d),c=c.defaultProps;for(var S in c)d[S]===void 0&&(d[S]=c[S]);return d}return d}function Tb(c,d,S,C){d=c.memoizedState,S=S(C,d),S=S==null?d:ne({},d,S),c.memoizedState=S,c.lanes===0&&(c.updateQueue.baseState=S)}var n0={isMounted:function(c){return(c=c._reactInternals)?Il(c)===c:!1},enqueueSetState:function(c,d,S){c=c._reactInternals;var C=rn(),P=Ca(c),R=Js(C,P);R.payload=d,S!=null&&(R.callback=S),d=ga(c,R,P),d!==null&&(Bi(d,c,P,C),Ky(d,c,P))},enqueueReplaceState:function(c,d,S){c=c._reactInternals;var C=rn(),P=Ca(c),R=Js(C,P);R.tag=1,R.payload=d,S!=null&&(R.callback=S),d=ga(c,R,P),d!==null&&(Bi(d,c,P,C),Ky(d,c,P))},enqueueForceUpdate:function(c,d){c=c._reactInternals;var S=rn(),C=Ca(c),P=Js(S,C);P.tag=2,d!=null&&(P.callback=d),d=ga(c,P,C),d!==null&&(Bi(d,c,C,S),Ky(d,c,C))}};function W1(c,d,S,C,P,R,D){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(C,R,D):d.prototype&&d.prototype.isPureReactComponent?!Sp(S,C)||!Sp(P,R):!0}function U1(c,d,S){var C=!1,P=pa,R=d.contextType;return typeof R=="object"&&R!==null?R=di(R):(P=mn(d)?Ml:Zr.current,C=d.contextTypes,R=(C=C!=null)?qu(c,P):pa),d=new d(S,R),c.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=n0,c.stateNode=d,d._reactInternals=c,C&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=P,c.__reactInternalMemoizedMaskedChildContext=R),d}function Z1(c,d,S,C){c=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(S,C),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(S,C),d.state!==c&&n0.enqueueReplaceState(d,d.state,null)}function wb(c,d,S,C){var P=c.stateNode;P.props=S,P.state=c.memoizedState,P.refs={},db(c);var R=d.contextType;typeof R=="object"&&R!==null?P.context=di(R):(R=mn(d)?Ml:Zr.current,P.context=qu(c,R)),P.state=c.memoizedState,R=d.getDerivedStateFromProps,typeof R=="function"&&(Tb(c,d,R,S),P.state=c.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(d=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),d!==P.state&&n0.enqueueReplaceState(P,P.state,null),Yy(c,S,P,C),P.state=c.memoizedState),typeof P.componentDidMount=="function"&&(c.flags|=4194308)}function td(c,d){try{var S="",C=d;do S+=ve(C),C=C.return;while(C);var P=S}catch(R){P=`
Error generating stack: `+R.message+`
`+R.stack}return{value:c,source:d,stack:P,digest:null}}function Pb(c,d,S){return{value:c,source:null,stack:S??null,digest:d??null}}function Eb(c,d){try{console.error(d.value)}catch(S){setTimeout(function(){throw S})}}var RB=typeof WeakMap=="function"?WeakMap:Map;function $1(c,d,S){S=Js(-1,S),S.tag=3,S.payload={element:null};var C=d.value;return S.callback=function(){u0||(u0=!0,Ub=C),Eb(c,d)},S}function H1(c,d,S){S=Js(-1,S),S.tag=3;var C=c.type.getDerivedStateFromError;if(typeof C=="function"){var P=d.value;S.payload=function(){return C(P)},S.callback=function(){Eb(c,d)}}var R=c.stateNode;return R!==null&&typeof R.componentDidCatch=="function"&&(S.callback=function(){Eb(c,d),typeof C!="function"&&(Sa===null?Sa=new Set([this]):Sa.add(this));var D=d.stack;this.componentDidCatch(d.value,{componentStack:D!==null?D:""})}),S}function V1(c,d,S){var C=c.pingCache;if(C===null){C=c.pingCache=new RB;var P=new Set;C.set(d,P)}else P=C.get(d),P===void 0&&(P=new Set,C.set(d,P));P.has(S)||(P.add(S),c=UB.bind(null,c,d,S),d.then(c,c))}function q1(c){do{var d;if((d=c.tag===13)&&(d=c.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return c;c=c.return}while(c!==null);return null}function G1(c,d,S,C,P){return(c.mode&1)===0?(c===d?c.flags|=65536:(c.flags|=128,S.flags|=131072,S.flags&=-52805,S.tag===1&&(S.alternate===null?S.tag=17:(d=Js(-1,1),d.tag=2,ga(S,d,1))),S.lanes|=1),c):(c.flags|=65536,c.lanes=P,c)}var IB=k.ReactCurrentOwner,gn=!1;function tn(c,d,S,C){d.child=c===null?f1(d,null,S,C):Xu(d,c.child,S,C)}function K1(c,d,S,C,P){S=S.render;var R=d.ref;return Qu(d,P),C=Sb(c,d,S,C,R,P),S=yb(),c!==null&&!gn?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~P,Qs(c,d,P)):(zt&&S&&tb(d),d.flags|=1,tn(c,d,C,P),d.child)}function Y1(c,d,S,C,P){if(c===null){var R=S.type;return typeof R=="function"&&!Kb(R)&&R.defaultProps===void 0&&S.compare===null&&S.defaultProps===void 0?(d.tag=15,d.type=R,X1(c,d,R,C,P)):(c=g0(S.type,null,C,d,d.mode,P),c.ref=d.ref,c.return=d,d.child=c)}if(R=c.child,(c.lanes&P)===0){var D=R.memoizedProps;if(S=S.compare,S=S!==null?S:Sp,S(D,C)&&c.ref===d.ref)return Qs(c,d,P)}return d.flags|=1,c=ba(R,C),c.ref=d.ref,c.return=d,d.child=c}function X1(c,d,S,C,P){if(c!==null){var R=c.memoizedProps;if(Sp(R,C)&&c.ref===d.ref)if(gn=!1,d.pendingProps=C=R,(c.lanes&P)!==0)(c.flags&131072)!==0&&(gn=!0);else return d.lanes=c.lanes,Qs(c,d,P)}return Rb(c,d,S,C,P)}function J1(c,d,S){var C=d.pendingProps,P=C.children,R=c!==null?c.memoizedState:null;if(C.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mt(nd,Ln),Ln|=S;else{if((S&1073741824)===0)return c=R!==null?R.baseLanes|S:S,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:c,cachePool:null,transitions:null},d.updateQueue=null,Mt(nd,Ln),Ln|=c,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},C=R!==null?R.baseLanes:S,Mt(nd,Ln),Ln|=C}else R!==null?(C=R.baseLanes|S,d.memoizedState=null):C=S,Mt(nd,Ln),Ln|=C;return tn(c,d,P,S),d.child}function Q1(c,d){var S=d.ref;(c===null&&S!==null||c!==null&&c.ref!==S)&&(d.flags|=512,d.flags|=2097152)}function Rb(c,d,S,C,P){var R=mn(S)?Ml:Zr.current;return R=qu(d,R),Qu(d,P),S=Sb(c,d,S,C,R,P),C=yb(),c!==null&&!gn?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~P,Qs(c,d,P)):(zt&&C&&tb(d),d.flags|=1,tn(c,d,S,P),d.child)}function eR(c,d,S,C,P){if(mn(S)){var R=!0;Wy(d)}else R=!1;if(Qu(d,P),d.stateNode===null)s0(c,d),U1(d,S,C),wb(d,S,C,P),C=!0;else if(c===null){var D=d.stateNode,H=d.memoizedProps;D.props=H;var K=D.context,le=S.contextType;typeof le=="object"&&le!==null?le=di(le):(le=mn(S)?Ml:Zr.current,le=qu(d,le));var me=S.getDerivedStateFromProps,Se=typeof me=="function"||typeof D.getSnapshotBeforeUpdate=="function";Se||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(H!==C||K!==le)&&Z1(d,D,C,le),ma=!1;var fe=d.memoizedState;D.state=fe,Yy(d,C,D,P),K=d.memoizedState,H!==C||fe!==K||fn.current||ma?(typeof me=="function"&&(Tb(d,S,me,C),K=d.memoizedState),(H=ma||W1(d,S,H,C,fe,K,le))?(Se||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(d.flags|=4194308)):(typeof D.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=C,d.memoizedState=K),D.props=C,D.state=K,D.context=le,C=H):(typeof D.componentDidMount=="function"&&(d.flags|=4194308),C=!1)}else{D=d.stateNode,g1(c,d),H=d.memoizedProps,le=d.type===d.elementType?H:Oi(d.type,H),D.props=le,Se=d.pendingProps,fe=D.context,K=S.contextType,typeof K=="object"&&K!==null?K=di(K):(K=mn(S)?Ml:Zr.current,K=qu(d,K));var Pe=S.getDerivedStateFromProps;(me=typeof Pe=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(H!==Se||fe!==K)&&Z1(d,D,C,K),ma=!1,fe=d.memoizedState,D.state=fe,Yy(d,C,D,P);var ke=d.memoizedState;H!==Se||fe!==ke||fn.current||ma?(typeof Pe=="function"&&(Tb(d,S,Pe,C),ke=d.memoizedState),(le=ma||W1(d,S,le,C,fe,ke,K)||!1)?(me||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(C,ke,K),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(C,ke,K)),typeof D.componentDidUpdate=="function"&&(d.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof D.componentDidUpdate!="function"||H===c.memoizedProps&&fe===c.memoizedState||(d.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||H===c.memoizedProps&&fe===c.memoizedState||(d.flags|=1024),d.memoizedProps=C,d.memoizedState=ke),D.props=C,D.state=ke,D.context=K,C=le):(typeof D.componentDidUpdate!="function"||H===c.memoizedProps&&fe===c.memoizedState||(d.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||H===c.memoizedProps&&fe===c.memoizedState||(d.flags|=1024),C=!1)}return Ib(c,d,S,C,R,P)}function Ib(c,d,S,C,P,R){Q1(c,d);var D=(d.flags&128)!==0;if(!C&&!D)return P&&s1(d,S,!1),Qs(c,d,R);C=d.stateNode,IB.current=d;var H=D&&typeof S.getDerivedStateFromError!="function"?null:C.render();return d.flags|=1,c!==null&&D?(d.child=Xu(d,c.child,null,R),d.child=Xu(d,null,H,R)):tn(c,d,H,R),d.memoizedState=C.state,P&&s1(d,S,!0),d.child}function tR(c){var d=c.stateNode;d.pendingContext?n1(c,d.pendingContext,d.pendingContext!==d.context):d.context&&n1(c,d.context,!1),hb(c,d.containerInfo)}function rR(c,d,S,C,P){return Yu(),sb(P),d.flags|=256,tn(c,d,S,C),d.child}var kb={dehydrated:null,treeContext:null,retryLane:0};function Mb(c){return{baseLanes:c,cachePool:null,transitions:null}}function nR(c,d,S){var C=d.pendingProps,P=Zt.current,R=!1,D=(d.flags&128)!==0,H;if((H=D)||(H=c!==null&&c.memoizedState===null?!1:(P&2)!==0),H?(R=!0,d.flags&=-129):(c===null||c.memoizedState!==null)&&(P|=1),Mt(Zt,P&1),c===null)return ib(d),c=d.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((d.mode&1)===0?d.lanes=1:c.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(D=C.children,c=C.fallback,R?(C=d.mode,R=d.child,D={mode:"hidden",children:D},(C&1)===0&&R!==null?(R.childLanes=0,R.pendingProps=D):R=v0(D,C,0,null),c=Wl(c,C,S,null),R.return=d,c.return=d,R.sibling=c,d.child=R,d.child.memoizedState=Mb(S),d.memoizedState=kb,c):Nb(d,D));if(P=c.memoizedState,P!==null&&(H=P.dehydrated,H!==null))return kB(c,d,D,C,H,P,S);if(R){R=C.fallback,D=d.mode,P=c.child,H=P.sibling;var K={mode:"hidden",children:C.children};return(D&1)===0&&d.child!==P?(C=d.child,C.childLanes=0,C.pendingProps=K,d.deletions=null):(C=ba(P,K),C.subtreeFlags=P.subtreeFlags&14680064),H!==null?R=ba(H,R):(R=Wl(R,D,S,null),R.flags|=2),R.return=d,C.return=d,C.sibling=R,d.child=C,C=R,R=d.child,D=c.child.memoizedState,D=D===null?Mb(S):{baseLanes:D.baseLanes|S,cachePool:null,transitions:D.transitions},R.memoizedState=D,R.childLanes=c.childLanes&~S,d.memoizedState=kb,C}return R=c.child,c=R.sibling,C=ba(R,{mode:"visible",children:C.children}),(d.mode&1)===0&&(C.lanes=S),C.return=d,C.sibling=null,c!==null&&(S=d.deletions,S===null?(d.deletions=[c],d.flags|=16):S.push(c)),d.child=C,d.memoizedState=null,C}function Nb(c,d){return d=v0({mode:"visible",children:d},c.mode,0,null),d.return=c,c.child=d}function i0(c,d,S,C){return C!==null&&sb(C),Xu(d,c.child,null,S),c=Nb(d,d.pendingProps.children),c.flags|=2,d.memoizedState=null,c}function kB(c,d,S,C,P,R,D){if(S)return d.flags&256?(d.flags&=-257,C=Pb(Error(t(422))),i0(c,d,D,C)):d.memoizedState!==null?(d.child=c.child,d.flags|=128,null):(R=C.fallback,P=d.mode,C=v0({mode:"visible",children:C.children},P,0,null),R=Wl(R,P,D,null),R.flags|=2,C.return=d,R.return=d,C.sibling=R,d.child=C,(d.mode&1)!==0&&Xu(d,c.child,null,D),d.child.memoizedState=Mb(D),d.memoizedState=kb,R);if((d.mode&1)===0)return i0(c,d,D,null);if(P.data==="$!"){if(C=P.nextSibling&&P.nextSibling.dataset,C)var H=C.dgst;return C=H,R=Error(t(419)),C=Pb(R,C,void 0),i0(c,d,D,C)}if(H=(D&c.childLanes)!==0,gn||H){if(C=xr,C!==null){switch(D&-D){case 4:P=2;break;case 16:P=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:P=32;break;case 536870912:P=268435456;break;default:P=0}P=(P&(C.suspendedLanes|D))!==0?0:P,P!==0&&P!==R.retryLane&&(R.retryLane=P,Xs(c,P),Bi(C,c,P,-1))}return Gb(),C=Pb(Error(t(421))),i0(c,d,D,C)}return P.data==="$?"?(d.flags|=128,d.child=c.child,d=ZB.bind(null,c),P._reactRetry=d,null):(c=R.treeContext,Nn=da(P.nextSibling),Mn=d,zt=!0,_i=null,c!==null&&(ci[ui++]=Ks,ci[ui++]=Ys,ci[ui++]=Nl,Ks=c.id,Ys=c.overflow,Nl=d),d=Nb(d,C.children),d.flags|=4096,d)}function iR(c,d,S){c.lanes|=d;var C=c.alternate;C!==null&&(C.lanes|=d),cb(c.return,d,S)}function Lb(c,d,S,C,P){var R=c.memoizedState;R===null?c.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:C,tail:S,tailMode:P}:(R.isBackwards=d,R.rendering=null,R.renderingStartTime=0,R.last=C,R.tail=S,R.tailMode=P)}function sR(c,d,S){var C=d.pendingProps,P=C.revealOrder,R=C.tail;if(tn(c,d,C.children,S),C=Zt.current,(C&2)!==0)C=C&1|2,d.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=d.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&iR(c,S,d);else if(c.tag===19)iR(c,S,d);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break e;for(;c.sibling===null;){if(c.return===null||c.return===d)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}C&=1}if(Mt(Zt,C),(d.mode&1)===0)d.memoizedState=null;else switch(P){case"forwards":for(S=d.child,P=null;S!==null;)c=S.alternate,c!==null&&Xy(c)===null&&(P=S),S=S.sibling;S=P,S===null?(P=d.child,d.child=null):(P=S.sibling,S.sibling=null),Lb(d,!1,P,S,R);break;case"backwards":for(S=null,P=d.child,d.child=null;P!==null;){if(c=P.alternate,c!==null&&Xy(c)===null){d.child=P;break}c=P.sibling,P.sibling=S,S=P,P=c}Lb(d,!0,S,null,R);break;case"together":Lb(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function s0(c,d){(d.mode&1)===0&&c!==null&&(c.alternate=null,d.alternate=null,d.flags|=2)}function Qs(c,d,S){if(c!==null&&(d.dependencies=c.dependencies),jl|=d.lanes,(S&d.childLanes)===0)return null;if(c!==null&&d.child!==c.child)throw Error(t(153));if(d.child!==null){for(c=d.child,S=ba(c,c.pendingProps),d.child=S,S.return=d;c.sibling!==null;)c=c.sibling,S=S.sibling=ba(c,c.pendingProps),S.return=d;S.sibling=null}return d.child}function MB(c,d,S){switch(d.tag){case 3:tR(d),Yu();break;case 5:y1(d);break;case 1:mn(d.type)&&Wy(d);break;case 4:hb(d,d.stateNode.containerInfo);break;case 10:var C=d.type._context,P=d.memoizedProps.value;Mt(qy,C._currentValue),C._currentValue=P;break;case 13:if(C=d.memoizedState,C!==null)return C.dehydrated!==null?(Mt(Zt,Zt.current&1),d.flags|=128,null):(S&d.child.childLanes)!==0?nR(c,d,S):(Mt(Zt,Zt.current&1),c=Qs(c,d,S),c!==null?c.sibling:null);Mt(Zt,Zt.current&1);break;case 19:if(C=(S&d.childLanes)!==0,(c.flags&128)!==0){if(C)return sR(c,d,S);d.flags|=128}if(P=d.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),Mt(Zt,Zt.current),C)break;return null;case 22:case 23:return d.lanes=0,J1(c,d,S)}return Qs(c,d,S)}var oR,_b,aR,lR;oR=function(c,d){for(var S=d.child;S!==null;){if(S.tag===5||S.tag===6)c.appendChild(S.stateNode);else if(S.tag!==4&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===d)break;for(;S.sibling===null;){if(S.return===null||S.return===d)return;S=S.return}S.sibling.return=S.return,S=S.sibling}},_b=function(){},aR=function(c,d,S,C){var P=c.memoizedProps;if(P!==C){c=d.stateNode,Ol(hs.current);var R=null;switch(S){case"input":P=ye(c,P),C=ye(c,C),R=[];break;case"select":P=ne({},P,{value:void 0}),C=ne({},C,{value:void 0}),R=[];break;case"textarea":P=li(c,P),C=li(c,C),R=[];break;default:typeof P.onClick!="function"&&typeof C.onClick=="function"&&(c.onclick=By)}ta(S,C);var D;S=null;for(le in P)if(!C.hasOwnProperty(le)&&P.hasOwnProperty(le)&&P[le]!=null)if(le==="style"){var H=P[le];for(D in H)H.hasOwnProperty(D)&&(S||(S={}),S[D]="")}else le!=="dangerouslySetInnerHTML"&&le!=="children"&&le!=="suppressContentEditableWarning"&&le!=="suppressHydrationWarning"&&le!=="autoFocus"&&(i.hasOwnProperty(le)?R||(R=[]):(R=R||[]).push(le,null));for(le in C){var K=C[le];if(H=P!=null?P[le]:void 0,C.hasOwnProperty(le)&&K!==H&&(K!=null||H!=null))if(le==="style")if(H){for(D in H)!H.hasOwnProperty(D)||K&&K.hasOwnProperty(D)||(S||(S={}),S[D]="");for(D in K)K.hasOwnProperty(D)&&H[D]!==K[D]&&(S||(S={}),S[D]=K[D])}else S||(R||(R=[]),R.push(le,S)),S=K;else le==="dangerouslySetInnerHTML"?(K=K?K.__html:void 0,H=H?H.__html:void 0,K!=null&&H!==K&&(R=R||[]).push(le,K)):le==="children"?typeof K!="string"&&typeof K!="number"||(R=R||[]).push(le,""+K):le!=="suppressContentEditableWarning"&&le!=="suppressHydrationWarning"&&(i.hasOwnProperty(le)?(K!=null&&le==="onScroll"&&Dt("scroll",c),R||H===K||(R=[])):(R=R||[]).push(le,K))}S&&(R=R||[]).push("style",S);var le=R;(d.updateQueue=le)&&(d.flags|=4)}},lR=function(c,d,S,C){S!==C&&(d.flags|=4)};function Lp(c,d){if(!zt)switch(c.tailMode){case"hidden":d=c.tail;for(var S=null;d!==null;)d.alternate!==null&&(S=d),d=d.sibling;S===null?c.tail=null:S.sibling=null;break;case"collapsed":S=c.tail;for(var C=null;S!==null;)S.alternate!==null&&(C=S),S=S.sibling;C===null?d||c.tail===null?c.tail=null:c.tail.sibling=null:C.sibling=null}}function Hr(c){var d=c.alternate!==null&&c.alternate.child===c.child,S=0,C=0;if(d)for(var P=c.child;P!==null;)S|=P.lanes|P.childLanes,C|=P.subtreeFlags&14680064,C|=P.flags&14680064,P.return=c,P=P.sibling;else for(P=c.child;P!==null;)S|=P.lanes|P.childLanes,C|=P.subtreeFlags,C|=P.flags,P.return=c,P=P.sibling;return c.subtreeFlags|=C,c.childLanes=S,d}function NB(c,d,S){var C=d.pendingProps;switch(rb(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hr(d),null;case 1:return mn(d.type)&&Fy(),Hr(d),null;case 3:return C=d.stateNode,ed(),jt(fn),jt(Zr),mb(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(c===null||c.child===null)&&(Hy(d)?d.flags|=4:c===null||c.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,_i!==null&&(Hb(_i),_i=null))),_b(c,d),Hr(d),null;case 5:pb(d);var P=Ol(Rp.current);if(S=d.type,c!==null&&d.stateNode!=null)aR(c,d,S,C,P),c.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!C){if(d.stateNode===null)throw Error(t(166));return Hr(d),null}if(c=Ol(hs.current),Hy(d)){C=d.stateNode,S=d.type;var R=d.memoizedProps;switch(C[ds]=d,C[xp]=R,c=(d.mode&1)!==0,S){case"dialog":Dt("cancel",C),Dt("close",C);break;case"iframe":case"object":case"embed":Dt("load",C);break;case"video":case"audio":for(P=0;P<Cp.length;P++)Dt(Cp[P],C);break;case"source":Dt("error",C);break;case"img":case"image":case"link":Dt("error",C),Dt("load",C);break;case"details":Dt("toggle",C);break;case"input":_e(C,R),Dt("invalid",C);break;case"select":C._wrapperState={wasMultiple:!!R.multiple},Dt("invalid",C);break;case"textarea":ss(C,R),Dt("invalid",C)}ta(S,R),P=null;for(var D in R)if(R.hasOwnProperty(D)){var H=R[D];D==="children"?typeof H=="string"?C.textContent!==H&&(R.suppressHydrationWarning!==!0&&jy(C.textContent,H,c),P=["children",H]):typeof H=="number"&&C.textContent!==""+H&&(R.suppressHydrationWarning!==!0&&jy(C.textContent,H,c),P=["children",""+H]):i.hasOwnProperty(D)&&H!=null&&D==="onScroll"&&Dt("scroll",C)}switch(S){case"input":pe(C),nt(C,R,!0);break;case"textarea":pe(C),as(C);break;case"select":case"option":break;default:typeof R.onClick=="function"&&(C.onclick=By)}C=P,d.updateQueue=C,C!==null&&(d.flags|=4)}else{D=P.nodeType===9?P:P.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=he(S)),c==="http://www.w3.org/1999/xhtml"?S==="script"?(c=D.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof C.is=="string"?c=D.createElement(S,{is:C.is}):(c=D.createElement(S),S==="select"&&(D=c,C.multiple?D.multiple=!0:C.size&&(D.size=C.size))):c=D.createElementNS(c,S),c[ds]=d,c[xp]=C,oR(c,d,!1,!1),d.stateNode=c;e:{switch(D=ra(S,C),S){case"dialog":Dt("cancel",c),Dt("close",c),P=C;break;case"iframe":case"object":case"embed":Dt("load",c),P=C;break;case"video":case"audio":for(P=0;P<Cp.length;P++)Dt(Cp[P],c);P=C;break;case"source":Dt("error",c),P=C;break;case"img":case"image":case"link":Dt("error",c),Dt("load",c),P=C;break;case"details":Dt("toggle",c),P=C;break;case"input":_e(c,C),P=ye(c,C),Dt("invalid",c);break;case"option":P=C;break;case"select":c._wrapperState={wasMultiple:!!C.multiple},P=ne({},C,{value:void 0}),Dt("invalid",c);break;case"textarea":ss(c,C),P=li(c,C),Dt("invalid",c);break;default:P=C}ta(S,P),H=P;for(R in H)if(H.hasOwnProperty(R)){var K=H[R];R==="style"?El(c,K):R==="dangerouslySetInnerHTML"?(K=K?K.__html:void 0,K!=null&&en(c,K)):R==="children"?typeof K=="string"?(S!=="textarea"||K!=="")&&ls(c,K):typeof K=="number"&&ls(c,""+K):R!=="suppressContentEditableWarning"&&R!=="suppressHydrationWarning"&&R!=="autoFocus"&&(i.hasOwnProperty(R)?K!=null&&R==="onScroll"&&Dt("scroll",c):K!=null&&T(c,R,K,D))}switch(S){case"input":pe(c),nt(c,C,!1);break;case"textarea":pe(c),as(c);break;case"option":C.value!=null&&c.setAttribute("value",""+te(C.value));break;case"select":c.multiple=!!C.multiple,R=C.value,R!=null?yt(c,!!C.multiple,R,!1):C.defaultValue!=null&&yt(c,!!C.multiple,C.defaultValue,!0);break;default:typeof P.onClick=="function"&&(c.onclick=By)}switch(S){case"button":case"input":case"select":case"textarea":C=!!C.autoFocus;break e;case"img":C=!0;break e;default:C=!1}}C&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Hr(d),null;case 6:if(c&&d.stateNode!=null)lR(c,d,c.memoizedProps,C);else{if(typeof C!="string"&&d.stateNode===null)throw Error(t(166));if(S=Ol(Rp.current),Ol(hs.current),Hy(d)){if(C=d.stateNode,S=d.memoizedProps,C[ds]=d,(R=C.nodeValue!==S)&&(c=Mn,c!==null))switch(c.tag){case 3:jy(C.nodeValue,S,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&jy(C.nodeValue,S,(c.mode&1)!==0)}R&&(d.flags|=4)}else C=(S.nodeType===9?S:S.ownerDocument).createTextNode(C),C[ds]=d,d.stateNode=C}return Hr(d),null;case 13:if(jt(Zt),C=d.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(zt&&Nn!==null&&(d.mode&1)!==0&&(d.flags&128)===0)d1(),Yu(),d.flags|=98560,R=!1;else if(R=Hy(d),C!==null&&C.dehydrated!==null){if(c===null){if(!R)throw Error(t(318));if(R=d.memoizedState,R=R!==null?R.dehydrated:null,!R)throw Error(t(317));R[ds]=d}else Yu(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Hr(d),R=!1}else _i!==null&&(Hb(_i),_i=null),R=!0;if(!R)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=S,d):(C=C!==null,C!==(c!==null&&c.memoizedState!==null)&&C&&(d.child.flags|=8192,(d.mode&1)!==0&&(c===null||(Zt.current&1)!==0?fr===0&&(fr=3):Gb())),d.updateQueue!==null&&(d.flags|=4),Hr(d),null);case 4:return ed(),_b(c,d),c===null&&Ap(d.stateNode.containerInfo),Hr(d),null;case 10:return lb(d.type._context),Hr(d),null;case 17:return mn(d.type)&&Fy(),Hr(d),null;case 19:if(jt(Zt),R=d.memoizedState,R===null)return Hr(d),null;if(C=(d.flags&128)!==0,D=R.rendering,D===null)if(C)Lp(R,!1);else{if(fr!==0||c!==null&&(c.flags&128)!==0)for(c=d.child;c!==null;){if(D=Xy(c),D!==null){for(d.flags|=128,Lp(R,!1),C=D.updateQueue,C!==null&&(d.updateQueue=C,d.flags|=4),d.subtreeFlags=0,C=S,S=d.child;S!==null;)R=S,c=C,R.flags&=14680066,D=R.alternate,D===null?(R.childLanes=0,R.lanes=c,R.child=null,R.subtreeFlags=0,R.memoizedProps=null,R.memoizedState=null,R.updateQueue=null,R.dependencies=null,R.stateNode=null):(R.childLanes=D.childLanes,R.lanes=D.lanes,R.child=D.child,R.subtreeFlags=0,R.deletions=null,R.memoizedProps=D.memoizedProps,R.memoizedState=D.memoizedState,R.updateQueue=D.updateQueue,R.type=D.type,c=D.dependencies,R.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),S=S.sibling;return Mt(Zt,Zt.current&1|2),d.child}c=c.sibling}R.tail!==null&&ir()>id&&(d.flags|=128,C=!0,Lp(R,!1),d.lanes=4194304)}else{if(!C)if(c=Xy(D),c!==null){if(d.flags|=128,C=!0,S=c.updateQueue,S!==null&&(d.updateQueue=S,d.flags|=4),Lp(R,!0),R.tail===null&&R.tailMode==="hidden"&&!D.alternate&&!zt)return Hr(d),null}else 2*ir()-R.renderingStartTime>id&&S!==1073741824&&(d.flags|=128,C=!0,Lp(R,!1),d.lanes=4194304);R.isBackwards?(D.sibling=d.child,d.child=D):(S=R.last,S!==null?S.sibling=D:d.child=D,R.last=D)}return R.tail!==null?(d=R.tail,R.rendering=d,R.tail=d.sibling,R.renderingStartTime=ir(),d.sibling=null,S=Zt.current,Mt(Zt,C?S&1|2:S&1),d):(Hr(d),null);case 22:case 23:return qb(),C=d.memoizedState!==null,c!==null&&c.memoizedState!==null!==C&&(d.flags|=8192),C&&(d.mode&1)!==0?(Ln&1073741824)!==0&&(Hr(d),d.subtreeFlags&6&&(d.flags|=8192)):Hr(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function LB(c,d){switch(rb(d),d.tag){case 1:return mn(d.type)&&Fy(),c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 3:return ed(),jt(fn),jt(Zr),mb(),c=d.flags,(c&65536)!==0&&(c&128)===0?(d.flags=c&-65537|128,d):null;case 5:return pb(d),null;case 13:if(jt(Zt),c=d.memoizedState,c!==null&&c.dehydrated!==null){if(d.alternate===null)throw Error(t(340));Yu()}return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 19:return jt(Zt),null;case 4:return ed(),null;case 10:return lb(d.type._context),null;case 22:case 23:return qb(),null;case 24:return null;default:return null}}var o0=!1,Vr=!1,_B=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function rd(c,d){var S=c.ref;if(S!==null)if(typeof S=="function")try{S(null)}catch(C){Yt(c,d,C)}else S.current=null}function Ob(c,d,S){try{S()}catch(C){Yt(c,d,C)}}var cR=!1;function OB(c,d){if(qA=Py,c=WE(),zA(c)){if("selectionStart"in c)var S={start:c.selectionStart,end:c.selectionEnd};else e:{S=(S=c.ownerDocument)&&S.defaultView||window;var C=S.getSelection&&S.getSelection();if(C&&C.rangeCount!==0){S=C.anchorNode;var P=C.anchorOffset,R=C.focusNode;C=C.focusOffset;try{S.nodeType,R.nodeType}catch{S=null;break e}var D=0,H=-1,K=-1,le=0,me=0,Se=c,fe=null;t:for(;;){for(var Pe;Se!==S||P!==0&&Se.nodeType!==3||(H=D+P),Se!==R||C!==0&&Se.nodeType!==3||(K=D+C),Se.nodeType===3&&(D+=Se.nodeValue.length),(Pe=Se.firstChild)!==null;)fe=Se,Se=Pe;for(;;){if(Se===c)break t;if(fe===S&&++le===P&&(H=D),fe===R&&++me===C&&(K=D),(Pe=Se.nextSibling)!==null)break;Se=fe,fe=Se.parentNode}Se=Pe}S=H===-1||K===-1?null:{start:H,end:K}}else S=null}S=S||{start:0,end:0}}else S=null;for(GA={focusedElem:c,selectionRange:S},Py=!1,Ie=d;Ie!==null;)if(d=Ie,c=d.child,(d.subtreeFlags&1028)!==0&&c!==null)c.return=d,Ie=c;else for(;Ie!==null;){d=Ie;try{var ke=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(ke!==null){var Me=ke.memoizedProps,sr=ke.memoizedState,ie=d.stateNode,Q=ie.getSnapshotBeforeUpdate(d.elementType===d.type?Me:Oi(d.type,Me),sr);ie.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var ae=d.stateNode.containerInfo;ae.nodeType===1?ae.textContent="":ae.nodeType===9&&ae.documentElement&&ae.removeChild(ae.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ce){Yt(d,d.return,Ce)}if(c=d.sibling,c!==null){c.return=d.return,Ie=c;break}Ie=d.return}return ke=cR,cR=!1,ke}function _p(c,d,S){var C=d.updateQueue;if(C=C!==null?C.lastEffect:null,C!==null){var P=C=C.next;do{if((P.tag&c)===c){var R=P.destroy;P.destroy=void 0,R!==void 0&&Ob(d,S,R)}P=P.next}while(P!==C)}}function a0(c,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var S=d=d.next;do{if((S.tag&c)===c){var C=S.create;S.destroy=C()}S=S.next}while(S!==d)}}function Db(c){var d=c.ref;if(d!==null){var S=c.stateNode;switch(c.tag){case 5:c=S;break;default:c=S}typeof d=="function"?d(c):d.current=c}}function uR(c){var d=c.alternate;d!==null&&(c.alternate=null,uR(d)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(d=c.stateNode,d!==null&&(delete d[ds],delete d[xp],delete d[JA],delete d[vB],delete d[SB])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function dR(c){return c.tag===5||c.tag===3||c.tag===4}function hR(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||dR(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function jb(c,d,S){var C=c.tag;if(C===5||C===6)c=c.stateNode,d?S.nodeType===8?S.parentNode.insertBefore(c,d):S.insertBefore(c,d):(S.nodeType===8?(d=S.parentNode,d.insertBefore(c,S)):(d=S,d.appendChild(c)),S=S._reactRootContainer,S!=null||d.onclick!==null||(d.onclick=By));else if(C!==4&&(c=c.child,c!==null))for(jb(c,d,S),c=c.sibling;c!==null;)jb(c,d,S),c=c.sibling}function Bb(c,d,S){var C=c.tag;if(C===5||C===6)c=c.stateNode,d?S.insertBefore(c,d):S.appendChild(c);else if(C!==4&&(c=c.child,c!==null))for(Bb(c,d,S),c=c.sibling;c!==null;)Bb(c,d,S),c=c.sibling}var Nr=null,Di=!1;function va(c,d,S){for(S=S.child;S!==null;)pR(c,d,S),S=S.sibling}function pR(c,d,S){if(us&&typeof us.onCommitFiberUnmount=="function")try{us.onCommitFiberUnmount(Cy,S)}catch{}switch(S.tag){case 5:Vr||rd(S,d);case 6:var C=Nr,P=Di;Nr=null,va(c,d,S),Nr=C,Di=P,Nr!==null&&(Di?(c=Nr,S=S.stateNode,c.nodeType===8?c.parentNode.removeChild(S):c.removeChild(S)):Nr.removeChild(S.stateNode));break;case 18:Nr!==null&&(Di?(c=Nr,S=S.stateNode,c.nodeType===8?XA(c.parentNode,S):c.nodeType===1&&XA(c,S),hp(c)):XA(Nr,S.stateNode));break;case 4:C=Nr,P=Di,Nr=S.stateNode.containerInfo,Di=!0,va(c,d,S),Nr=C,Di=P;break;case 0:case 11:case 14:case 15:if(!Vr&&(C=S.updateQueue,C!==null&&(C=C.lastEffect,C!==null))){P=C=C.next;do{var R=P,D=R.destroy;R=R.tag,D!==void 0&&((R&2)!==0||(R&4)!==0)&&Ob(S,d,D),P=P.next}while(P!==C)}va(c,d,S);break;case 1:if(!Vr&&(rd(S,d),C=S.stateNode,typeof C.componentWillUnmount=="function"))try{C.props=S.memoizedProps,C.state=S.memoizedState,C.componentWillUnmount()}catch(H){Yt(S,d,H)}va(c,d,S);break;case 21:va(c,d,S);break;case 22:S.mode&1?(Vr=(C=Vr)||S.memoizedState!==null,va(c,d,S),Vr=C):va(c,d,S);break;default:va(c,d,S)}}function fR(c){var d=c.updateQueue;if(d!==null){c.updateQueue=null;var S=c.stateNode;S===null&&(S=c.stateNode=new _B),d.forEach(function(C){var P=$B.bind(null,c,C);S.has(C)||(S.add(C),C.then(P,P))})}}function ji(c,d){var S=d.deletions;if(S!==null)for(var C=0;C<S.length;C++){var P=S[C];try{var R=c,D=d,H=D;e:for(;H!==null;){switch(H.tag){case 5:Nr=H.stateNode,Di=!1;break e;case 3:Nr=H.stateNode.containerInfo,Di=!0;break e;case 4:Nr=H.stateNode.containerInfo,Di=!0;break e}H=H.return}if(Nr===null)throw Error(t(160));pR(R,D,P),Nr=null,Di=!1;var K=P.alternate;K!==null&&(K.return=null),P.return=null}catch(le){Yt(P,d,le)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)mR(d,c),d=d.sibling}function mR(c,d){var S=c.alternate,C=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(ji(d,c),fs(c),C&4){try{_p(3,c,c.return),a0(3,c)}catch(Me){Yt(c,c.return,Me)}try{_p(5,c,c.return)}catch(Me){Yt(c,c.return,Me)}}break;case 1:ji(d,c),fs(c),C&512&&S!==null&&rd(S,S.return);break;case 5:if(ji(d,c),fs(c),C&512&&S!==null&&rd(S,S.return),c.flags&32){var P=c.stateNode;try{ls(P,"")}catch(Me){Yt(c,c.return,Me)}}if(C&4&&(P=c.stateNode,P!=null)){var R=c.memoizedProps,D=S!==null?S.memoizedProps:R,H=c.type,K=c.updateQueue;if(c.updateQueue=null,K!==null)try{H==="input"&&R.type==="radio"&&R.name!=null&&de(P,R),ra(H,D);var le=ra(H,R);for(D=0;D<K.length;D+=2){var me=K[D],Se=K[D+1];me==="style"?El(P,Se):me==="dangerouslySetInnerHTML"?en(P,Se):me==="children"?ls(P,Se):T(P,me,Se,le)}switch(H){case"input":Ae(P,R);break;case"textarea":os(P,R);break;case"select":var fe=P._wrapperState.wasMultiple;P._wrapperState.wasMultiple=!!R.multiple;var Pe=R.value;Pe!=null?yt(P,!!R.multiple,Pe,!1):fe!==!!R.multiple&&(R.defaultValue!=null?yt(P,!!R.multiple,R.defaultValue,!0):yt(P,!!R.multiple,R.multiple?[]:"",!1))}P[xp]=R}catch(Me){Yt(c,c.return,Me)}}break;case 6:if(ji(d,c),fs(c),C&4){if(c.stateNode===null)throw Error(t(162));P=c.stateNode,R=c.memoizedProps;try{P.nodeValue=R}catch(Me){Yt(c,c.return,Me)}}break;case 3:if(ji(d,c),fs(c),C&4&&S!==null&&S.memoizedState.isDehydrated)try{hp(d.containerInfo)}catch(Me){Yt(c,c.return,Me)}break;case 4:ji(d,c),fs(c);break;case 13:ji(d,c),fs(c),P=c.child,P.flags&8192&&(R=P.memoizedState!==null,P.stateNode.isHidden=R,!R||P.alternate!==null&&P.alternate.memoizedState!==null||(Wb=ir())),C&4&&fR(c);break;case 22:if(me=S!==null&&S.memoizedState!==null,c.mode&1?(Vr=(le=Vr)||me,ji(d,c),Vr=le):ji(d,c),fs(c),C&8192){if(le=c.memoizedState!==null,(c.stateNode.isHidden=le)&&!me&&(c.mode&1)!==0)for(Ie=c,me=c.child;me!==null;){for(Se=Ie=me;Ie!==null;){switch(fe=Ie,Pe=fe.child,fe.tag){case 0:case 11:case 14:case 15:_p(4,fe,fe.return);break;case 1:rd(fe,fe.return);var ke=fe.stateNode;if(typeof ke.componentWillUnmount=="function"){C=fe,S=fe.return;try{d=C,ke.props=d.memoizedProps,ke.state=d.memoizedState,ke.componentWillUnmount()}catch(Me){Yt(C,S,Me)}}break;case 5:rd(fe,fe.return);break;case 22:if(fe.memoizedState!==null){SR(Se);continue}}Pe!==null?(Pe.return=fe,Ie=Pe):SR(Se)}me=me.sibling}e:for(me=null,Se=c;;){if(Se.tag===5){if(me===null){me=Se;try{P=Se.stateNode,le?(R=P.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none"):(H=Se.stateNode,K=Se.memoizedProps.style,D=K!=null&&K.hasOwnProperty("display")?K.display:null,H.style.display=Pl("display",D))}catch(Me){Yt(c,c.return,Me)}}}else if(Se.tag===6){if(me===null)try{Se.stateNode.nodeValue=le?"":Se.memoizedProps}catch(Me){Yt(c,c.return,Me)}}else if((Se.tag!==22&&Se.tag!==23||Se.memoizedState===null||Se===c)&&Se.child!==null){Se.child.return=Se,Se=Se.child;continue}if(Se===c)break e;for(;Se.sibling===null;){if(Se.return===null||Se.return===c)break e;me===Se&&(me=null),Se=Se.return}me===Se&&(me=null),Se.sibling.return=Se.return,Se=Se.sibling}}break;case 19:ji(d,c),fs(c),C&4&&fR(c);break;case 21:break;default:ji(d,c),fs(c)}}function fs(c){var d=c.flags;if(d&2){try{e:{for(var S=c.return;S!==null;){if(dR(S)){var C=S;break e}S=S.return}throw Error(t(160))}switch(C.tag){case 5:var P=C.stateNode;C.flags&32&&(ls(P,""),C.flags&=-33);var R=hR(c);Bb(c,R,P);break;case 3:case 4:var D=C.stateNode.containerInfo,H=hR(c);jb(c,H,D);break;default:throw Error(t(161))}}catch(K){Yt(c,c.return,K)}c.flags&=-3}d&4096&&(c.flags&=-4097)}function DB(c,d,S){Ie=c,gR(c)}function gR(c,d,S){for(var C=(c.mode&1)!==0;Ie!==null;){var P=Ie,R=P.child;if(P.tag===22&&C){var D=P.memoizedState!==null||o0;if(!D){var H=P.alternate,K=H!==null&&H.memoizedState!==null||Vr;H=o0;var le=Vr;if(o0=D,(Vr=K)&&!le)for(Ie=P;Ie!==null;)D=Ie,K=D.child,D.tag===22&&D.memoizedState!==null?yR(P):K!==null?(K.return=D,Ie=K):yR(P);for(;R!==null;)Ie=R,gR(R),R=R.sibling;Ie=P,o0=H,Vr=le}vR(c)}else(P.subtreeFlags&8772)!==0&&R!==null?(R.return=P,Ie=R):vR(c)}}function vR(c){for(;Ie!==null;){var d=Ie;if((d.flags&8772)!==0){var S=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Vr||a0(5,d);break;case 1:var C=d.stateNode;if(d.flags&4&&!Vr)if(S===null)C.componentDidMount();else{var P=d.elementType===d.type?S.memoizedProps:Oi(d.type,S.memoizedProps);C.componentDidUpdate(P,S.memoizedState,C.__reactInternalSnapshotBeforeUpdate)}var R=d.updateQueue;R!==null&&S1(d,R,C);break;case 3:var D=d.updateQueue;if(D!==null){if(S=null,d.child!==null)switch(d.child.tag){case 5:S=d.child.stateNode;break;case 1:S=d.child.stateNode}S1(d,D,S)}break;case 5:var H=d.stateNode;if(S===null&&d.flags&4){S=H;var K=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":K.autoFocus&&S.focus();break;case"img":K.src&&(S.src=K.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var le=d.alternate;if(le!==null){var me=le.memoizedState;if(me!==null){var Se=me.dehydrated;Se!==null&&hp(Se)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Vr||d.flags&512&&Db(d)}catch(fe){Yt(d,d.return,fe)}}if(d===c){Ie=null;break}if(S=d.sibling,S!==null){S.return=d.return,Ie=S;break}Ie=d.return}}function SR(c){for(;Ie!==null;){var d=Ie;if(d===c){Ie=null;break}var S=d.sibling;if(S!==null){S.return=d.return,Ie=S;break}Ie=d.return}}function yR(c){for(;Ie!==null;){var d=Ie;try{switch(d.tag){case 0:case 11:case 15:var S=d.return;try{a0(4,d)}catch(K){Yt(d,S,K)}break;case 1:var C=d.stateNode;if(typeof C.componentDidMount=="function"){var P=d.return;try{C.componentDidMount()}catch(K){Yt(d,P,K)}}var R=d.return;try{Db(d)}catch(K){Yt(d,R,K)}break;case 5:var D=d.return;try{Db(d)}catch(K){Yt(d,D,K)}}}catch(K){Yt(d,d.return,K)}if(d===c){Ie=null;break}var H=d.sibling;if(H!==null){H.return=d.return,Ie=H;break}Ie=d.return}}var jB=Math.ceil,l0=k.ReactCurrentDispatcher,zb=k.ReactCurrentOwner,pi=k.ReactCurrentBatchConfig,ct=0,xr=null,lr=null,Lr=0,Ln=0,nd=ha(0),fr=0,Op=null,jl=0,c0=0,Fb=0,Dp=null,vn=null,Wb=0,id=1/0,eo=null,u0=!1,Ub=null,Sa=null,d0=!1,ya=null,h0=0,jp=0,Zb=null,p0=-1,f0=0;function rn(){return(ct&6)!==0?ir():p0!==-1?p0:p0=ir()}function Ca(c){return(c.mode&1)===0?1:(ct&2)!==0&&Lr!==0?Lr&-Lr:CB.transition!==null?(f0===0&&(f0=hE()),f0):(c=mt,c!==0||(c=window.event,c=c===void 0?16:AE(c.type)),c)}function Bi(c,d,S,C){if(50<jp)throw jp=0,Zb=null,Error(t(185));ap(c,S,C),((ct&2)===0||c!==xr)&&(c===xr&&((ct&2)===0&&(c0|=S),fr===4&&Aa(c,Lr)),Sn(c,C),S===1&&ct===0&&(d.mode&1)===0&&(id=ir()+500,Uy&&fa()))}function Sn(c,d){var S=c.callbackNode;C4(c,d);var C=xy(c,c===xr?Lr:0);if(C===0)S!==null&&cE(S),c.callbackNode=null,c.callbackPriority=0;else if(d=C&-C,c.callbackPriority!==d){if(S!=null&&cE(S),d===1)c.tag===0?yB(AR.bind(null,c)):o1(AR.bind(null,c)),mB(function(){(ct&6)===0&&fa()}),S=null;else{switch(pE(C)){case 1:S=bA;break;case 4:S=uE;break;case 16:S=yy;break;case 536870912:S=dE;break;default:S=yy}S=IR(S,CR.bind(null,c))}c.callbackPriority=d,c.callbackNode=S}}function CR(c,d){if(p0=-1,f0=0,(ct&6)!==0)throw Error(t(327));var S=c.callbackNode;if(sd()&&c.callbackNode!==S)return null;var C=xy(c,c===xr?Lr:0);if(C===0)return null;if((C&30)!==0||(C&c.expiredLanes)!==0||d)d=m0(c,C);else{d=C;var P=ct;ct|=2;var R=xR();(xr!==c||Lr!==d)&&(eo=null,id=ir()+500,zl(c,d));do try{FB();break}catch(H){bR(c,H)}while(!0);ab(),l0.current=R,ct=P,lr!==null?d=0:(xr=null,Lr=0,d=fr)}if(d!==0){if(d===2&&(P=xA(c),P!==0&&(C=P,d=$b(c,P))),d===1)throw S=Op,zl(c,0),Aa(c,C),Sn(c,ir()),S;if(d===6)Aa(c,C);else{if(P=c.current.alternate,(C&30)===0&&!BB(P)&&(d=m0(c,C),d===2&&(R=xA(c),R!==0&&(C=R,d=$b(c,R))),d===1))throw S=Op,zl(c,0),Aa(c,C),Sn(c,ir()),S;switch(c.finishedWork=P,c.finishedLanes=C,d){case 0:case 1:throw Error(t(345));case 2:Fl(c,vn,eo);break;case 3:if(Aa(c,C),(C&130023424)===C&&(d=Wb+500-ir(),10<d)){if(xy(c,0)!==0)break;if(P=c.suspendedLanes,(P&C)!==C){rn(),c.pingedLanes|=c.suspendedLanes&P;break}c.timeoutHandle=YA(Fl.bind(null,c,vn,eo),d);break}Fl(c,vn,eo);break;case 4:if(Aa(c,C),(C&4194240)===C)break;for(d=c.eventTimes,P=-1;0<C;){var D=31-Ni(C);R=1<<D,D=d[D],D>P&&(P=D),C&=~R}if(C=P,C=ir()-C,C=(120>C?120:480>C?480:1080>C?1080:1920>C?1920:3e3>C?3e3:4320>C?4320:1960*jB(C/1960))-C,10<C){c.timeoutHandle=YA(Fl.bind(null,c,vn,eo),C);break}Fl(c,vn,eo);break;case 5:Fl(c,vn,eo);break;default:throw Error(t(329))}}}return Sn(c,ir()),c.callbackNode===S?CR.bind(null,c):null}function $b(c,d){var S=Dp;return c.current.memoizedState.isDehydrated&&(zl(c,d).flags|=256),c=m0(c,d),c!==2&&(d=vn,vn=S,d!==null&&Hb(d)),c}function Hb(c){vn===null?vn=c:vn.push.apply(vn,c)}function BB(c){for(var d=c;;){if(d.flags&16384){var S=d.updateQueue;if(S!==null&&(S=S.stores,S!==null))for(var C=0;C<S.length;C++){var P=S[C],R=P.getSnapshot;P=P.value;try{if(!Li(R(),P))return!1}catch{return!1}}}if(S=d.child,d.subtreeFlags&16384&&S!==null)S.return=d,d=S;else{if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Aa(c,d){for(d&=~Fb,d&=~c0,c.suspendedLanes|=d,c.pingedLanes&=~d,c=c.expirationTimes;0<d;){var S=31-Ni(d),C=1<<S;c[S]=-1,d&=~C}}function AR(c){if((ct&6)!==0)throw Error(t(327));sd();var d=xy(c,0);if((d&1)===0)return Sn(c,ir()),null;var S=m0(c,d);if(c.tag!==0&&S===2){var C=xA(c);C!==0&&(d=C,S=$b(c,C))}if(S===1)throw S=Op,zl(c,0),Aa(c,d),Sn(c,ir()),S;if(S===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=d,Fl(c,vn,eo),Sn(c,ir()),null}function Vb(c,d){var S=ct;ct|=1;try{return c(d)}finally{ct=S,ct===0&&(id=ir()+500,Uy&&fa())}}function Bl(c){ya!==null&&ya.tag===0&&(ct&6)===0&&sd();var d=ct;ct|=1;var S=pi.transition,C=mt;try{if(pi.transition=null,mt=1,c)return c()}finally{mt=C,pi.transition=S,ct=d,(ct&6)===0&&fa()}}function qb(){Ln=nd.current,jt(nd)}function zl(c,d){c.finishedWork=null,c.finishedLanes=0;var S=c.timeoutHandle;if(S!==-1&&(c.timeoutHandle=-1,fB(S)),lr!==null)for(S=lr.return;S!==null;){var C=S;switch(rb(C),C.tag){case 1:C=C.type.childContextTypes,C!=null&&Fy();break;case 3:ed(),jt(fn),jt(Zr),mb();break;case 5:pb(C);break;case 4:ed();break;case 13:jt(Zt);break;case 19:jt(Zt);break;case 10:lb(C.type._context);break;case 22:case 23:qb()}S=S.return}if(xr=c,lr=c=ba(c.current,null),Lr=Ln=d,fr=0,Op=null,Fb=c0=jl=0,vn=Dp=null,_l!==null){for(d=0;d<_l.length;d++)if(S=_l[d],C=S.interleaved,C!==null){S.interleaved=null;var P=C.next,R=S.pending;if(R!==null){var D=R.next;R.next=P,C.next=D}S.pending=C}_l=null}return c}function bR(c,d){do{var S=lr;try{if(ab(),Jy.current=r0,Qy){for(var C=$t.memoizedState;C!==null;){var P=C.queue;P!==null&&(P.pending=null),C=C.next}Qy=!1}if(Dl=0,br=pr=$t=null,Ip=!1,kp=0,zb.current=null,S===null||S.return===null){fr=1,Op=d,lr=null;break}e:{var R=c,D=S.return,H=S,K=d;if(d=Lr,H.flags|=32768,K!==null&&typeof K=="object"&&typeof K.then=="function"){var le=K,me=H,Se=me.tag;if((me.mode&1)===0&&(Se===0||Se===11||Se===15)){var fe=me.alternate;fe?(me.updateQueue=fe.updateQueue,me.memoizedState=fe.memoizedState,me.lanes=fe.lanes):(me.updateQueue=null,me.memoizedState=null)}var Pe=q1(D);if(Pe!==null){Pe.flags&=-257,G1(Pe,D,H,R,d),Pe.mode&1&&V1(R,le,d),d=Pe,K=le;var ke=d.updateQueue;if(ke===null){var Me=new Set;Me.add(K),d.updateQueue=Me}else ke.add(K);break e}else{if((d&1)===0){V1(R,le,d),Gb();break e}K=Error(t(426))}}else if(zt&&H.mode&1){var sr=q1(D);if(sr!==null){(sr.flags&65536)===0&&(sr.flags|=256),G1(sr,D,H,R,d),sb(td(K,H));break e}}R=K=td(K,H),fr!==4&&(fr=2),Dp===null?Dp=[R]:Dp.push(R),R=D;do{switch(R.tag){case 3:R.flags|=65536,d&=-d,R.lanes|=d;var ie=$1(R,K,d);v1(R,ie);break e;case 1:H=K;var Q=R.type,ae=R.stateNode;if((R.flags&128)===0&&(typeof Q.getDerivedStateFromError=="function"||ae!==null&&typeof ae.componentDidCatch=="function"&&(Sa===null||!Sa.has(ae)))){R.flags|=65536,d&=-d,R.lanes|=d;var Ce=H1(R,H,d);v1(R,Ce);break e}}R=R.return}while(R!==null)}wR(S)}catch(Le){d=Le,lr===S&&S!==null&&(lr=S=S.return);continue}break}while(!0)}function xR(){var c=l0.current;return l0.current=r0,c===null?r0:c}function Gb(){(fr===0||fr===3||fr===2)&&(fr=4),xr===null||(jl&268435455)===0&&(c0&268435455)===0||Aa(xr,Lr)}function m0(c,d){var S=ct;ct|=2;var C=xR();(xr!==c||Lr!==d)&&(eo=null,zl(c,d));do try{zB();break}catch(P){bR(c,P)}while(!0);if(ab(),ct=S,l0.current=C,lr!==null)throw Error(t(261));return xr=null,Lr=0,fr}function zB(){for(;lr!==null;)TR(lr)}function FB(){for(;lr!==null&&!d4();)TR(lr)}function TR(c){var d=RR(c.alternate,c,Ln);c.memoizedProps=c.pendingProps,d===null?wR(c):lr=d,zb.current=null}function wR(c){var d=c;do{var S=d.alternate;if(c=d.return,(d.flags&32768)===0){if(S=NB(S,d,Ln),S!==null){lr=S;return}}else{if(S=LB(S,d),S!==null){S.flags&=32767,lr=S;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{fr=6,lr=null;return}}if(d=d.sibling,d!==null){lr=d;return}lr=d=c}while(d!==null);fr===0&&(fr=5)}function Fl(c,d,S){var C=mt,P=pi.transition;try{pi.transition=null,mt=1,WB(c,d,S,C)}finally{pi.transition=P,mt=C}return null}function WB(c,d,S,C){do sd();while(ya!==null);if((ct&6)!==0)throw Error(t(327));S=c.finishedWork;var P=c.finishedLanes;if(S===null)return null;if(c.finishedWork=null,c.finishedLanes=0,S===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var R=S.lanes|S.childLanes;if(A4(c,R),c===xr&&(lr=xr=null,Lr=0),(S.subtreeFlags&2064)===0&&(S.flags&2064)===0||d0||(d0=!0,IR(yy,function(){return sd(),null})),R=(S.flags&15990)!==0,(S.subtreeFlags&15990)!==0||R){R=pi.transition,pi.transition=null;var D=mt;mt=1;var H=ct;ct|=4,zb.current=null,OB(c,S),mR(S,c),aB(GA),Py=!!qA,GA=qA=null,c.current=S,DB(S),h4(),ct=H,mt=D,pi.transition=R}else c.current=S;if(d0&&(d0=!1,ya=c,h0=P),R=c.pendingLanes,R===0&&(Sa=null),m4(S.stateNode),Sn(c,ir()),d!==null)for(C=c.onRecoverableError,S=0;S<d.length;S++)P=d[S],C(P.value,{componentStack:P.stack,digest:P.digest});if(u0)throw u0=!1,c=Ub,Ub=null,c;return(h0&1)!==0&&c.tag!==0&&sd(),R=c.pendingLanes,(R&1)!==0?c===Zb?jp++:(jp=0,Zb=c):jp=0,fa(),null}function sd(){if(ya!==null){var c=pE(h0),d=pi.transition,S=mt;try{if(pi.transition=null,mt=16>c?16:c,ya===null)var C=!1;else{if(c=ya,ya=null,h0=0,(ct&6)!==0)throw Error(t(331));var P=ct;for(ct|=4,Ie=c.current;Ie!==null;){var R=Ie,D=R.child;if((Ie.flags&16)!==0){var H=R.deletions;if(H!==null){for(var K=0;K<H.length;K++){var le=H[K];for(Ie=le;Ie!==null;){var me=Ie;switch(me.tag){case 0:case 11:case 15:_p(8,me,R)}var Se=me.child;if(Se!==null)Se.return=me,Ie=Se;else for(;Ie!==null;){me=Ie;var fe=me.sibling,Pe=me.return;if(uR(me),me===le){Ie=null;break}if(fe!==null){fe.return=Pe,Ie=fe;break}Ie=Pe}}}var ke=R.alternate;if(ke!==null){var Me=ke.child;if(Me!==null){ke.child=null;do{var sr=Me.sibling;Me.sibling=null,Me=sr}while(Me!==null)}}Ie=R}}if((R.subtreeFlags&2064)!==0&&D!==null)D.return=R,Ie=D;else e:for(;Ie!==null;){if(R=Ie,(R.flags&2048)!==0)switch(R.tag){case 0:case 11:case 15:_p(9,R,R.return)}var ie=R.sibling;if(ie!==null){ie.return=R.return,Ie=ie;break e}Ie=R.return}}var Q=c.current;for(Ie=Q;Ie!==null;){D=Ie;var ae=D.child;if((D.subtreeFlags&2064)!==0&&ae!==null)ae.return=D,Ie=ae;else e:for(D=Q;Ie!==null;){if(H=Ie,(H.flags&2048)!==0)try{switch(H.tag){case 0:case 11:case 15:a0(9,H)}}catch(Le){Yt(H,H.return,Le)}if(H===D){Ie=null;break e}var Ce=H.sibling;if(Ce!==null){Ce.return=H.return,Ie=Ce;break e}Ie=H.return}}if(ct=P,fa(),us&&typeof us.onPostCommitFiberRoot=="function")try{us.onPostCommitFiberRoot(Cy,c)}catch{}C=!0}return C}finally{mt=S,pi.transition=d}}return!1}function PR(c,d,S){d=td(S,d),d=$1(c,d,1),c=ga(c,d,1),d=rn(),c!==null&&(ap(c,1,d),Sn(c,d))}function Yt(c,d,S){if(c.tag===3)PR(c,c,S);else for(;d!==null;){if(d.tag===3){PR(d,c,S);break}else if(d.tag===1){var C=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(Sa===null||!Sa.has(C))){c=td(S,c),c=H1(d,c,1),d=ga(d,c,1),c=rn(),d!==null&&(ap(d,1,c),Sn(d,c));break}}d=d.return}}function UB(c,d,S){var C=c.pingCache;C!==null&&C.delete(d),d=rn(),c.pingedLanes|=c.suspendedLanes&S,xr===c&&(Lr&S)===S&&(fr===4||fr===3&&(Lr&130023424)===Lr&&500>ir()-Wb?zl(c,0):Fb|=S),Sn(c,d)}function ER(c,d){d===0&&((c.mode&1)===0?d=1:(d=by,by<<=1,(by&130023424)===0&&(by=4194304)));var S=rn();c=Xs(c,d),c!==null&&(ap(c,d,S),Sn(c,S))}function ZB(c){var d=c.memoizedState,S=0;d!==null&&(S=d.retryLane),ER(c,S)}function $B(c,d){var S=0;switch(c.tag){case 13:var C=c.stateNode,P=c.memoizedState;P!==null&&(S=P.retryLane);break;case 19:C=c.stateNode;break;default:throw Error(t(314))}C!==null&&C.delete(d),ER(c,S)}var RR;RR=function(c,d,S){if(c!==null)if(c.memoizedProps!==d.pendingProps||fn.current)gn=!0;else{if((c.lanes&S)===0&&(d.flags&128)===0)return gn=!1,MB(c,d,S);gn=(c.flags&131072)!==0}else gn=!1,zt&&(d.flags&1048576)!==0&&a1(d,$y,d.index);switch(d.lanes=0,d.tag){case 2:var C=d.type;s0(c,d),c=d.pendingProps;var P=qu(d,Zr.current);Qu(d,S),P=Sb(null,d,C,c,P,S);var R=yb();return d.flags|=1,typeof P=="object"&&P!==null&&typeof P.render=="function"&&P.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,mn(C)?(R=!0,Wy(d)):R=!1,d.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,db(d),P.updater=n0,d.stateNode=P,P._reactInternals=d,wb(d,C,c,S),d=Ib(null,d,C,!0,R,S)):(d.tag=0,zt&&R&&tb(d),tn(null,d,P,S),d=d.child),d;case 16:C=d.elementType;e:{switch(s0(c,d),c=d.pendingProps,P=C._init,C=P(C._payload),d.type=C,P=d.tag=VB(C),c=Oi(C,c),P){case 0:d=Rb(null,d,C,c,S);break e;case 1:d=eR(null,d,C,c,S);break e;case 11:d=K1(null,d,C,c,S);break e;case 14:d=Y1(null,d,C,Oi(C.type,c),S);break e}throw Error(t(306,C,""))}return d;case 0:return C=d.type,P=d.pendingProps,P=d.elementType===C?P:Oi(C,P),Rb(c,d,C,P,S);case 1:return C=d.type,P=d.pendingProps,P=d.elementType===C?P:Oi(C,P),eR(c,d,C,P,S);case 3:e:{if(tR(d),c===null)throw Error(t(387));C=d.pendingProps,R=d.memoizedState,P=R.element,g1(c,d),Yy(d,C,null,S);var D=d.memoizedState;if(C=D.element,R.isDehydrated)if(R={element:C,isDehydrated:!1,cache:D.cache,pendingSuspenseBoundaries:D.pendingSuspenseBoundaries,transitions:D.transitions},d.updateQueue.baseState=R,d.memoizedState=R,d.flags&256){P=td(Error(t(423)),d),d=rR(c,d,C,S,P);break e}else if(C!==P){P=td(Error(t(424)),d),d=rR(c,d,C,S,P);break e}else for(Nn=da(d.stateNode.containerInfo.firstChild),Mn=d,zt=!0,_i=null,S=f1(d,null,C,S),d.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if(Yu(),C===P){d=Qs(c,d,S);break e}tn(c,d,C,S)}d=d.child}return d;case 5:return y1(d),c===null&&ib(d),C=d.type,P=d.pendingProps,R=c!==null?c.memoizedProps:null,D=P.children,KA(C,P)?D=null:R!==null&&KA(C,R)&&(d.flags|=32),Q1(c,d),tn(c,d,D,S),d.child;case 6:return c===null&&ib(d),null;case 13:return nR(c,d,S);case 4:return hb(d,d.stateNode.containerInfo),C=d.pendingProps,c===null?d.child=Xu(d,null,C,S):tn(c,d,C,S),d.child;case 11:return C=d.type,P=d.pendingProps,P=d.elementType===C?P:Oi(C,P),K1(c,d,C,P,S);case 7:return tn(c,d,d.pendingProps,S),d.child;case 8:return tn(c,d,d.pendingProps.children,S),d.child;case 12:return tn(c,d,d.pendingProps.children,S),d.child;case 10:e:{if(C=d.type._context,P=d.pendingProps,R=d.memoizedProps,D=P.value,Mt(qy,C._currentValue),C._currentValue=D,R!==null)if(Li(R.value,D)){if(R.children===P.children&&!fn.current){d=Qs(c,d,S);break e}}else for(R=d.child,R!==null&&(R.return=d);R!==null;){var H=R.dependencies;if(H!==null){D=R.child;for(var K=H.firstContext;K!==null;){if(K.context===C){if(R.tag===1){K=Js(-1,S&-S),K.tag=2;var le=R.updateQueue;if(le!==null){le=le.shared;var me=le.pending;me===null?K.next=K:(K.next=me.next,me.next=K),le.pending=K}}R.lanes|=S,K=R.alternate,K!==null&&(K.lanes|=S),cb(R.return,S,d),H.lanes|=S;break}K=K.next}}else if(R.tag===10)D=R.type===d.type?null:R.child;else if(R.tag===18){if(D=R.return,D===null)throw Error(t(341));D.lanes|=S,H=D.alternate,H!==null&&(H.lanes|=S),cb(D,S,d),D=R.sibling}else D=R.child;if(D!==null)D.return=R;else for(D=R;D!==null;){if(D===d){D=null;break}if(R=D.sibling,R!==null){R.return=D.return,D=R;break}D=D.return}R=D}tn(c,d,P.children,S),d=d.child}return d;case 9:return P=d.type,C=d.pendingProps.children,Qu(d,S),P=di(P),C=C(P),d.flags|=1,tn(c,d,C,S),d.child;case 14:return C=d.type,P=Oi(C,d.pendingProps),P=Oi(C.type,P),Y1(c,d,C,P,S);case 15:return X1(c,d,d.type,d.pendingProps,S);case 17:return C=d.type,P=d.pendingProps,P=d.elementType===C?P:Oi(C,P),s0(c,d),d.tag=1,mn(C)?(c=!0,Wy(d)):c=!1,Qu(d,S),U1(d,C,P),wb(d,C,P,S),Ib(null,d,C,!0,c,S);case 19:return sR(c,d,S);case 22:return J1(c,d,S)}throw Error(t(156,d.tag))};function IR(c,d){return lE(c,d)}function HB(c,d,S,C){this.tag=c,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(c,d,S,C){return new HB(c,d,S,C)}function Kb(c){return c=c.prototype,!(!c||!c.isReactComponent)}function VB(c){if(typeof c=="function")return Kb(c)?1:0;if(c!=null){if(c=c.$$typeof,c===$)return 11;if(c===ee)return 14}return 2}function ba(c,d){var S=c.alternate;return S===null?(S=fi(c.tag,d,c.key,c.mode),S.elementType=c.elementType,S.type=c.type,S.stateNode=c.stateNode,S.alternate=c,c.alternate=S):(S.pendingProps=d,S.type=c.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=c.flags&14680064,S.childLanes=c.childLanes,S.lanes=c.lanes,S.child=c.child,S.memoizedProps=c.memoizedProps,S.memoizedState=c.memoizedState,S.updateQueue=c.updateQueue,d=c.dependencies,S.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},S.sibling=c.sibling,S.index=c.index,S.ref=c.ref,S}function g0(c,d,S,C,P,R){var D=2;if(C=c,typeof c=="function")Kb(c)&&(D=1);else if(typeof c=="string")D=5;else e:switch(c){case L:return Wl(S.children,P,R,d);case j:D=8,P|=8;break;case B:return c=fi(12,S,d,P|2),c.elementType=B,c.lanes=R,c;case U:return c=fi(13,S,d,P),c.elementType=U,c.lanes=R,c;case Y:return c=fi(19,S,d,P),c.elementType=Y,c.lanes=R,c;case re:return v0(S,P,R,d);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case z:D=10;break e;case Z:D=9;break e;case $:D=11;break e;case ee:D=14;break e;case X:D=16,C=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return d=fi(D,S,d,P),d.elementType=c,d.type=C,d.lanes=R,d}function Wl(c,d,S,C){return c=fi(7,c,C,d),c.lanes=S,c}function v0(c,d,S,C){return c=fi(22,c,C,d),c.elementType=re,c.lanes=S,c.stateNode={isHidden:!1},c}function Yb(c,d,S){return c=fi(6,c,null,d),c.lanes=S,c}function Xb(c,d,S){return d=fi(4,c.children!==null?c.children:[],c.key,d),d.lanes=S,d.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},d}function qB(c,d,S,C,P){this.tag=d,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=TA(0),this.expirationTimes=TA(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=TA(0),this.identifierPrefix=C,this.onRecoverableError=P,this.mutableSourceEagerHydrationData=null}function Jb(c,d,S,C,P,R,D,H,K){return c=new qB(c,d,S,H,K),d===1?(d=1,R===!0&&(d|=8)):d=0,R=fi(3,null,null,d),c.current=R,R.stateNode=c,R.memoizedState={element:C,isDehydrated:S,cache:null,transitions:null,pendingSuspenseBoundaries:null},db(R),c}function GB(c,d,S){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:C==null?null:""+C,children:c,containerInfo:d,implementation:S}}function kR(c){if(!c)return pa;c=c._reactInternals;e:{if(Il(c)!==c||c.tag!==1)throw Error(t(170));var d=c;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(mn(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(c.tag===1){var S=c.type;if(mn(S))return i1(c,S,d)}return d}function MR(c,d,S,C,P,R,D,H,K){return c=Jb(S,C,!0,c,P,R,D,H,K),c.context=kR(null),S=c.current,C=rn(),P=Ca(S),R=Js(C,P),R.callback=d??null,ga(S,R,P),c.current.lanes=P,ap(c,P,C),Sn(c,C),c}function S0(c,d,S,C){var P=d.current,R=rn(),D=Ca(P);return S=kR(S),d.context===null?d.context=S:d.pendingContext=S,d=Js(R,D),d.payload={element:c},C=C===void 0?null:C,C!==null&&(d.callback=C),c=ga(P,d,D),c!==null&&(Bi(c,P,D,R),Ky(c,P,D)),D}function y0(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function NR(c,d){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var S=c.retryLane;c.retryLane=S!==0&&S<d?S:d}}function Qb(c,d){NR(c,d),(c=c.alternate)&&NR(c,d)}function KB(){return null}var LR=typeof reportError=="function"?reportError:function(c){console.error(c)};function ex(c){this._internalRoot=c}C0.prototype.render=ex.prototype.render=function(c){var d=this._internalRoot;if(d===null)throw Error(t(409));S0(c,d,null,null)},C0.prototype.unmount=ex.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var d=c.containerInfo;Bl(function(){S0(null,c,null,null)}),d[qs]=null}};function C0(c){this._internalRoot=c}C0.prototype.unstable_scheduleHydration=function(c){if(c){var d=gE();c={blockedOn:null,target:c,priority:d};for(var S=0;S<la.length&&d!==0&&d<la[S].priority;S++);la.splice(S,0,c),S===0&&yE(c)}};function tx(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function A0(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function _R(){}function YB(c,d,S,C,P){if(P){if(typeof C=="function"){var R=C;C=function(){var le=y0(D);R.call(le)}}var D=MR(d,C,c,0,null,!1,!1,"",_R);return c._reactRootContainer=D,c[qs]=D.current,Ap(c.nodeType===8?c.parentNode:c),Bl(),D}for(;P=c.lastChild;)c.removeChild(P);if(typeof C=="function"){var H=C;C=function(){var le=y0(K);H.call(le)}}var K=Jb(c,0,!1,null,null,!1,!1,"",_R);return c._reactRootContainer=K,c[qs]=K.current,Ap(c.nodeType===8?c.parentNode:c),Bl(function(){S0(d,K,S,C)}),K}function b0(c,d,S,C,P){var R=S._reactRootContainer;if(R){var D=R;if(typeof P=="function"){var H=P;P=function(){var K=y0(D);H.call(K)}}S0(d,D,c,P)}else D=YB(S,d,c,P,C);return y0(D)}fE=function(c){switch(c.tag){case 3:var d=c.stateNode;if(d.current.memoizedState.isDehydrated){var S=op(d.pendingLanes);S!==0&&(wA(d,S|1),Sn(d,ir()),(ct&6)===0&&(id=ir()+500,fa()))}break;case 13:Bl(function(){var C=Xs(c,1);if(C!==null){var P=rn();Bi(C,c,1,P)}}),Qb(c,1)}},PA=function(c){if(c.tag===13){var d=Xs(c,134217728);if(d!==null){var S=rn();Bi(d,c,134217728,S)}Qb(c,134217728)}},mE=function(c){if(c.tag===13){var d=Ca(c),S=Xs(c,d);if(S!==null){var C=rn();Bi(S,c,d,C)}Qb(c,d)}},gE=function(){return mt},vE=function(c,d){var S=mt;try{return mt=c,d()}finally{mt=S}},rp=function(c,d,S){switch(d){case"input":if(Ae(c,S),d=S.name,S.type==="radio"&&d!=null){for(S=c;S.parentNode;)S=S.parentNode;for(S=S.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<S.length;d++){var C=S[d];if(C!==c&&C.form===c.form){var P=zy(C);if(!P)throw Error(t(90));Be(C),Ae(C,P)}}}break;case"textarea":os(c,S);break;case"select":d=S.value,d!=null&&yt(c,!!S.multiple,d,!1)}},tE=Vb,rE=Bl;var XB={usingClientEntryPoint:!1,Events:[Tp,Hu,zy,gy,eE,Vb]},Bp={findFiberByHostInstance:kl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},JB={bundleType:Bp.bundleType,version:Bp.version,rendererPackageName:Bp.rendererPackageName,rendererConfig:Bp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=oE(c),c===null?null:c.stateNode},findFiberByHostInstance:Bp.findFiberByHostInstance||KB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var x0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!x0.isDisabled&&x0.supportsFiber)try{Cy=x0.inject(JB),us=x0}catch{}}return yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XB,yn.createPortal=function(c,d){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tx(d))throw Error(t(200));return GB(c,d,null,S)},yn.createRoot=function(c,d){if(!tx(c))throw Error(t(299));var S=!1,C="",P=LR;return d!=null&&(d.unstable_strictMode===!0&&(S=!0),d.identifierPrefix!==void 0&&(C=d.identifierPrefix),d.onRecoverableError!==void 0&&(P=d.onRecoverableError)),d=Jb(c,1,!1,null,null,S,!1,C,P),c[qs]=d.current,Ap(c.nodeType===8?c.parentNode:c),new ex(d)},yn.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var d=c._reactInternals;if(d===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=oE(d),c=c===null?null:c.stateNode,c},yn.flushSync=function(c){return Bl(c)},yn.hydrate=function(c,d,S){if(!A0(d))throw Error(t(200));return b0(null,c,d,!0,S)},yn.hydrateRoot=function(c,d,S){if(!tx(c))throw Error(t(405));var C=S!=null&&S.hydratedSources||null,P=!1,R="",D=LR;if(S!=null&&(S.unstable_strictMode===!0&&(P=!0),S.identifierPrefix!==void 0&&(R=S.identifierPrefix),S.onRecoverableError!==void 0&&(D=S.onRecoverableError)),d=MR(d,null,c,1,S??null,P,!1,R,D),c[qs]=d.current,Ap(c),C)for(c=0;c<C.length;c++)S=C[c],P=S._getVersion,P=P(S._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[S,P]:d.mutableSourceEagerHydrationData.push(S,P);return new C0(d)},yn.render=function(c,d,S){if(!A0(d))throw Error(t(200));return b0(null,c,d,!1,S)},yn.unmountComponentAtNode=function(c){if(!A0(c))throw Error(t(40));return c._reactRootContainer?(Bl(function(){b0(null,null,c,!1,function(){c._reactRootContainer=null,c[qs]=null})}),!0):!1},yn.unstable_batchedUpdates=Vb,yn.unstable_renderSubtreeIntoContainer=function(c,d,S,C){if(!A0(S))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return b0(c,d,S,!1,C)},yn.version="18.3.1-next-f1338f8080-20240426",yn}var ZR;function c3(){if(ZR)return sx.exports;ZR=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),sx.exports=l3(),sx.exports}var $R;function u3(){if($R)return T0;$R=1;var r=c3();return T0.createRoot=r.createRoot,T0.hydrateRoot=r.hydrateRoot,T0}var d3=u3();const h3=s_(d3),HR="azure-tts-settings",wP="azure-tts-api-keys",a_="azure-voice-live-settings",w0={apiKey:"",region:"eastus",selectedVoice:"en-US-JennyNeural",voiceLiveEndpoint:"",voiceLiveApiKey:""};function p3(){try{const r=localStorage.getItem(a_);if(r)return JSON.parse(r)}catch(r){console.error("Failed to load Voice Live settings from localStorage:",r)}return{endpoint:"",apiKey:""}}function f3(r,e){try{localStorage.setItem(a_,JSON.stringify({endpoint:r,apiKey:e}))}catch(t){console.error("Failed to save Voice Live settings to localStorage:",t)}}function Fp(){try{const r=localStorage.getItem(wP);if(r)return JSON.parse(r)}catch(r){console.error("Failed to load API keys from localStorage:",r)}return{}}function VR(r){try{localStorage.setItem(wP,JSON.stringify(r))}catch(e){console.error("Failed to save API keys to localStorage:",e)}}function m3(){const[r,e]=O.useState(()=>{try{const o=localStorage.getItem(HR),a=Fp(),l=p3();console.log("=== LOADING SETTINGS ===");const u={};if(Object.keys(a).forEach(h=>{const m=a[h];u[h]=m.length>8?`${m.substring(0,4)}...${m.substring(m.length-4)}`:"****"}),console.log("Stored API keys by region:",u),o){const h=JSON.parse(o),m=h.region||w0.region,g=a[m]||h.apiKey||"",v=g.length>8?`${g.substring(0,4)}...${g.substring(g.length-4)}`:"****";return console.log("Loading settings for region:",m),console.log("Loaded API key:",v),console.log("========================"),{...w0,...h,apiKey:g,voiceLiveEndpoint:l.endpoint,voiceLiveApiKey:l.apiKey}}return{...w0,voiceLiveEndpoint:l.endpoint,voiceLiveApiKey:l.apiKey}}catch(o){console.error("Failed to load settings from localStorage:",o)}return w0});O.useEffect(()=>{try{const o=r.apiKey.length>8?`${r.apiKey.substring(0,4)}...${r.apiKey.substring(r.apiKey.length-4)}`:"****";console.log("=== SAVING SETTINGS (useEffect) ==="),console.log("Region:",r.region),console.log("API Key being saved:",o),console.log("This key will be saved FOR region:",r.region),console.log("===================================");const{apiKey:a,voiceLiveEndpoint:l,voiceLiveApiKey:u,...h}=r;if(localStorage.setItem(HR,JSON.stringify(h)),a){const m=Fp();m[r.region]=a,VR(m),console.log(` API key ${o} saved for region: ${r.region}`)}(l||u)&&f3(l||"",u||"")}catch(o){console.error("Failed to save settings to localStorage:",o)}},[r]);const t=o=>{console.log("=== UPDATE SETTINGS CALLED ==="),console.trace("Called from:"),e(a=>{const l=a.apiKey.length>8?`${a.apiKey.substring(0,4)}...${a.apiKey.substring(a.apiKey.length-4)}`:"****";console.log("Previous settings:",{region:a.region,apiKey:l});const u={...o};if(o.apiKey){const m=o.apiKey;u.apiKey=m.length>8?`${m.substring(0,4)}...${m.substring(m.length-4)}`:"****"}console.log("Partial update:",u);const h={...a,...o};if(o.region&&o.region!==a.region&&!o.apiKey){const g=Fp()[o.region]||"";h.apiKey=g;const v=a.apiKey.length>8?`${a.apiKey.substring(0,4)}...${a.apiKey.substring(a.apiKey.length-4)}`:"****",y=g.length>8?`${g.substring(0,4)}...${g.substring(g.length-4)}`:"****";console.log(` Region changed from "${a.region}" to "${o.region}"`),console.log(` Loading saved API key for "${o.region}": ${v}  ${y}`),g||console.warn(` No API key found for region "${o.region}" - you'll need to enter one`)}return console.log("New settings:",{region:h.region,apiKey:h.apiKey.length>8?`${h.apiKey.substring(0,4)}...${h.apiKey.substring(h.apiKey.length-4)}`:"****"}),console.log("=============================="),h})},n=r.apiKey.length>0&&r.region.length>0,i=o=>{const a=Fp();delete a[o],VR(a),console.log(` Cleared API key for region: ${o}`),console.log("Remaining keys:",a)},s=()=>{localStorage.removeItem(wP),console.log(" Cleared all API keys from localStorage")};return typeof window<"u"&&(window.debugSettings={clearRegionKey:i,clearAllKeys:s,viewKeys:()=>{console.log("Current API keys in localStorage:",Fp())}}),{settings:r,updateSettings:t,isConfigured:n}}function g3(){const[r,e]=O.useState([]),t=O.useCallback(s=>{const o={...s,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(a=>[...a,o])},[]),n=O.useCallback(s=>{e(o=>o.filter(a=>a.id!==s))},[]),i=O.useCallback(()=>{e([])},[]);return{history:r,addToHistory:t,removeFromHistory:n,clearHistory:i}}function v3(){const[r,e]=O.useState([]),t=O.useCallback(s=>{const o={...s,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(a=>[...a,o])},[]),n=O.useCallback(s=>{e(o=>o.filter(a=>a.id!==s))},[]),i=O.useCallback(()=>{e([])},[]);return{history:r,addToHistory:t,removeFromHistory:n,clearHistory:i}}function S3(){const[r,e]=O.useState([]),t=O.useCallback(s=>{const o={...s,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(a=>[...a,o])},[]),n=O.useCallback(s=>{e(o=>o.filter(a=>a.id!==s))},[]),i=O.useCallback(()=>{e([])},[]);return{history:r,addToHistory:t,removeFromHistory:n,clearHistory:i}}function y3(){const[r,e]=O.useState([]),t=O.useCallback(s=>{const o={...s,id:`stt-${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(a=>[o,...a])},[]),n=O.useCallback(s=>{e(o=>o.filter(a=>a.id!==s))},[]),i=O.useCallback(()=>{e([])},[]);return{history:r,addToHistory:t,removeFromHistory:n,clearHistory:i}}const l_="podcast.history",C3=50;function A3(){try{const r=localStorage.getItem(l_);if(r)return JSON.parse(r)}catch(r){console.error("Failed to load podcast history:",r)}return[]}function P0(r){try{localStorage.setItem(l_,JSON.stringify(r))}catch(e){console.error("Failed to save podcast history:",e)}}function b3(){const[r,e]=O.useState(A3),t=O.useCallback(s=>{const o={...s,id:crypto.randomUUID()};e(a=>{const l=[o,...a].slice(0,C3);return P0(l),l})},[]),n=O.useCallback(s=>{e(o=>{const a=o.filter(l=>l.id!==s);return P0(a),a})},[]),i=O.useCallback(()=>{e([]),P0([])},[]);return O.useEffect(()=>{P0(r)},[r]),{history:r,addToHistory:t,removeFromHistory:n,clearHistory:i}}const x3="2026-01-25T10:23:17.235Z",qR="0e10434",T3=[{value:"brazilsouth",label:"Brazil South"},{value:"canadacentral",label:"Canada Central"},{value:"canadaeast",label:"Canada East"},{value:"centralus",label:"Central US"},{value:"eastus",label:"East US"},{value:"eastus2",label:"East US 2"},{value:"northcentralus",label:"North Central US"},{value:"southcentralus",label:"South Central US"},{value:"westcentralus",label:"West Central US"},{value:"westus",label:"West US"},{value:"westus2",label:"West US 2"},{value:"westus3",label:"West US 3"},{value:"francecentral",label:"France Central"},{value:"germanywestcentral",label:"Germany West Central"},{value:"italynorth",label:"Italy North"},{value:"northeurope",label:"North Europe"},{value:"norwayeast",label:"Norway East"},{value:"swedencentral",label:"Sweden Central"},{value:"switzerlandnorth",label:"Switzerland North"},{value:"switzerlandwest",label:"Switzerland West"},{value:"uksouth",label:"UK South"},{value:"ukwest",label:"UK West"},{value:"westeurope",label:"West Europe"},{value:"australiaeast",label:"Australia East"},{value:"centralindia",label:"Central India"},{value:"eastasia",label:"East Asia"},{value:"japaneast",label:"Japan East"},{value:"japanwest",label:"Japan West"},{value:"koreacentral",label:"Korea Central"},{value:"southeastasia",label:"Southeast Asia"},{value:"qatarcentral",label:"Qatar Central"},{value:"southafricanorth",label:"South Africa North"},{value:"uaenorth",label:"UAE North"}],GR=[{mode:"voice-creation",label:"Voice Creation",category:"content",icon:f.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})},{mode:"text-to-speech",label:"Text to Speech",category:"content",icon:f.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})},{mode:"multi-talker",label:"Multi Talker",category:"content",icon:f.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})},{mode:"voice-changer",label:"Voice Changer",category:"content",icon:f.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},{mode:"speech-to-text",label:"Speech to Text",category:"content",icon:f.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})})},{mode:"video-translation",label:"Video Translation",category:"content",icon:f.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})},{mode:"podcast-agent",label:"Podcast Agent",category:"content",icon:f.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})},{mode:"voice-live-chat",label:"Voice Live Chat",category:"agent",icon:f.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})},{mode:"voice-live-translator",label:"Voice Live Translator",category:"agent",icon:f.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})})},{mode:"gemini-live",label:"Gemini Live",category:"agent",icon:f.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}];function w3({activeMode:r,onModeChange:e,settings:t,onSettingsChange:n,geminiLiveEnabled:i=!1}){const[s,o]=O.useState(!1),[a,l]=O.useState(!1),u=r==="voice-live-chat"||r==="voice-live-translator"||r==="gemini-live";return f.jsxs("div",{className:`h-full bg-gray-900 text-white flex flex-col flex-shrink-0 transition-all duration-300 ${s?"w-16":"w-64"}`,children:[f.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[!s&&f.jsxs("div",{children:[f.jsx("h1",{className:"text-lg font-bold text-white",children:"Azure Voice"}),f.jsx("p",{className:"text-xs text-gray-400",children:"Playground"})]}),f.jsx("button",{onClick:()=>o(!s),className:`p-1.5 rounded-lg hover:bg-gray-800 transition-colors ${s?"mx-auto":""}`,title:s?"Expand sidebar":"Collapse sidebar",children:f.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform duration-300 ${s?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})})]}),f.jsxs("div",{className:"p-3",children:[!s&&f.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-2 px-2",children:"Content Generation"}),f.jsx("nav",{className:"space-y-1",children:GR.filter(h=>h.category==="content").map(({mode:h,label:m,icon:g})=>f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("button",{onClick:()=>e(h),title:s?m:void 0,className:`flex-1 flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${r===h?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"} ${s?"justify-center":""}`,children:[g,!s&&f.jsx("span",{children:m})]}),!s&&f.jsx("a",{href:`${window.location.origin}${window.location.pathname}#${h}`,onClick:v=>{v.preventDefault();const y=`${window.location.origin}${window.location.pathname}#${h}`;navigator.clipboard.writeText(y)},className:"p-1.5 rounded text-gray-500 hover:text-gray-300 hover:bg-gray-800 transition-colors",title:"Click to copy link",children:f.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})})]},h))})]}),f.jsxs("div",{className:"p-3 pt-0",children:[!s&&f.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-2 px-2",children:"Voice Agent"}),f.jsx("nav",{className:"space-y-1",children:GR.filter(h=>h.category==="agent"&&(h.mode!=="gemini-live"||i)).map(({mode:h,label:m,icon:g})=>f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("button",{onClick:()=>e(h),title:s?m:void 0,className:`flex-1 flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${r===h?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"} ${s?"justify-center":""}`,children:[g,!s&&f.jsx("span",{children:m})]}),!s&&f.jsx("a",{href:`${window.location.origin}${window.location.pathname}#${h}`,onClick:v=>{v.preventDefault();const y=`${window.location.origin}${window.location.pathname}#${h}`;navigator.clipboard.writeText(y)},className:"p-1.5 rounded text-gray-500 hover:text-gray-300 hover:bg-gray-800 transition-colors",title:"Click to copy link",children:f.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})})]},h))})]}),f.jsx("div",{className:"border-t border-gray-700 mx-3 my-2"}),f.jsx("div",{className:`flex-1 overflow-y-auto p-3 ${s?"hidden":""}`,children:u?f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-3 px-2",children:"Voice Live Config"}),f.jsxs("div",{className:"space-y-2 px-2 mb-4",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"Endpoint"}),f.jsx("input",{type:"text",value:t.voiceLiveEndpoint||"",onChange:h=>{const m=h.target.value;n({voiceLiveEndpoint:m})},placeholder:"https://{resource}.cognitiveservices.azure.com/",autoComplete:"off",className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{className:"space-y-2 px-2 mb-4",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"API Key"}),f.jsx("input",{type:"password",value:t.voiceLiveApiKey||"",onChange:h=>{const m=h.target.value;n({voiceLiveApiKey:m})},placeholder:"Enter API key",autoComplete:"new-password","data-lpignore":"true","data-form-type":"other",className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),f.jsx("a",{href:"https://ai.azure.com",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-400 hover:text-blue-300 underline",children:"Get credentials"})]}),f.jsxs("div",{className:"mt-4 bg-yellow-900/30 border border-yellow-700/50 rounded-md overflow-hidden",children:[f.jsxs("button",{onClick:()=>l(!a),className:"w-full p-3 flex items-center justify-between hover:bg-yellow-900/50 transition-colors",children:[f.jsx("h3",{className:"text-xs font-semibold text-yellow-400",children:"Security Notice"}),f.jsx("svg",{className:`w-4 h-4 text-yellow-400 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&f.jsx("div",{className:"px-3 pb-3",children:f.jsx("p",{className:"text-xs text-yellow-200/70",children:"Your credentials are stored in browser localStorage. Never share your key or use on untrusted devices."})})]})]}):f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-3 px-2",children:"Azure Speech Config"}),f.jsxs("div",{className:"space-y-2 px-2 mb-4",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"API Key"}),f.jsx("input",{type:"password",value:t.apiKey,onChange:h=>{const m=h.target.value;m!==t.apiKey&&n({apiKey:m})},placeholder:"Enter API key",autoComplete:"new-password","data-lpignore":"true","data-form-type":"other",className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),f.jsx("a",{href:"https://portal.azure.com/#view/Microsoft_Azure_ProjectOxford/CognitiveServicesHub/~/SpeechServices",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-400 hover:text-blue-300 underline",children:"Get API key"})]}),f.jsxs("div",{className:"space-y-2 px-2",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"Region"}),f.jsx("select",{value:t.region,onChange:h=>n({region:h.target.value}),className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:T3.map(h=>f.jsx("option",{value:h.value,children:h.label},h.value))})]}),f.jsxs("div",{className:"mt-6 bg-yellow-900/30 border border-yellow-700/50 rounded-md overflow-hidden",children:[f.jsxs("button",{onClick:()=>l(!a),className:"w-full p-3 flex items-center justify-between hover:bg-yellow-900/50 transition-colors",children:[f.jsx("h3",{className:"text-xs font-semibold text-yellow-400",children:"Security Notice"}),f.jsx("svg",{className:`w-4 h-4 text-yellow-400 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&f.jsx("div",{className:"px-3 pb-3",children:f.jsx("p",{className:"text-xs text-yellow-200/70",children:"Your API key is stored in browser localStorage. Never share your key or use on untrusted devices."})})]})]})}),s&&f.jsx("div",{className:"flex-1 flex flex-col items-center pt-2",children:f.jsx("div",{className:"p-2 text-gray-500",title:"Expand to configure Azure settings",children:f.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})}),f.jsx("div",{className:"p-3 border-t border-gray-700",children:!s&&f.jsxs("div",{className:"text-xs text-gray-500 text-center space-y-1",children:[f.jsx("p",{children:"API key stored locally"}),f.jsxs("p",{className:"text-gray-600",children:["Build: ",f.jsx("a",{href:`https://github.com/szhaomsft/AzureVoicePlayground/commit/${qR}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:qR})]}),f.jsx("p",{className:"text-gray-600",children:new Date(x3).toLocaleString()})]})})]})}var Ul={},Zl={},Wp={},$l={},Ht={},lx={},Hl={},cx={},Up={},E0={},KR;function c_(){if(KR)return E0;KR=1,Object.defineProperty(E0,"__esModule",{value:!0}),E0.default=t;let r;const e=new Uint8Array(16);function t(){if(!r&&(r=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(e)}return E0}var od={},Zp={},$p={},YR;function P3(){if(YR)return $p;YR=1,Object.defineProperty($p,"__esModule",{value:!0}),$p.default=void 0;var r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;return $p.default=r,$p}var XR;function sA(){if(XR)return Zp;XR=1,Object.defineProperty(Zp,"__esModule",{value:!0}),Zp.default=void 0;var r=e(P3());function e(i){return i&&i.__esModule?i:{default:i}}function t(i){return typeof i=="string"&&r.default.test(i)}var n=t;return Zp.default=n,Zp}var JR;function oA(){if(JR)return od;JR=1,Object.defineProperty(od,"__esModule",{value:!0}),od.default=void 0,od.unsafeStringify=n;var r=e(sA());function e(o){return o&&o.__esModule?o:{default:o}}const t=[];for(let o=0;o<256;++o)t.push((o+256).toString(16).slice(1));function n(o,a=0){return t[o[a+0]]+t[o[a+1]]+t[o[a+2]]+t[o[a+3]]+"-"+t[o[a+4]]+t[o[a+5]]+"-"+t[o[a+6]]+t[o[a+7]]+"-"+t[o[a+8]]+t[o[a+9]]+"-"+t[o[a+10]]+t[o[a+11]]+t[o[a+12]]+t[o[a+13]]+t[o[a+14]]+t[o[a+15]]}function i(o,a=0){const l=n(o,a);if(!(0,r.default)(l))throw TypeError("Stringified UUID is invalid");return l}var s=i;return od.default=s,od}var QR;function E3(){if(QR)return Up;QR=1,Object.defineProperty(Up,"__esModule",{value:!0}),Up.default=void 0;var r=t(c_()),e=oA();function t(u){return u&&u.__esModule?u:{default:u}}let n,i,s=0,o=0;function a(u,h,m){let g=h&&m||0;const v=h||new Array(16);u=u||{};let y=u.node||n,A=u.clockseq!==void 0?u.clockseq:i;if(y==null||A==null){const I=u.random||(u.rng||r.default)();y==null&&(y=n=[I[0]|1,I[1],I[2],I[3],I[4],I[5]]),A==null&&(A=i=(I[6]<<8|I[7])&16383)}let x=u.msecs!==void 0?u.msecs:Date.now(),b=u.nsecs!==void 0?u.nsecs:o+1;const w=x-s+(b-o)/1e4;if(w<0&&u.clockseq===void 0&&(A=A+1&16383),(w<0||x>s)&&u.nsecs===void 0&&(b=0),b>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=x,o=b,i=A,x+=122192928e5;const T=((x&268435455)*1e4+b)%4294967296;v[g++]=T>>>24&255,v[g++]=T>>>16&255,v[g++]=T>>>8&255,v[g++]=T&255;const k=x/4294967296*1e4&268435455;v[g++]=k>>>8&255,v[g++]=k&255,v[g++]=k>>>24&15|16,v[g++]=k>>>16&255,v[g++]=A>>>8|128,v[g++]=A&255;for(let I=0;I<6;++I)v[g+I]=y[I];return h||(0,e.unsafeStringify)(v)}var l=a;return Up.default=l,Up}var Hp={},Ta={},Vp={},eI;function u_(){if(eI)return Vp;eI=1,Object.defineProperty(Vp,"__esModule",{value:!0}),Vp.default=void 0;var r=e(sA());function e(i){return i&&i.__esModule?i:{default:i}}function t(i){if(!(0,r.default)(i))throw TypeError("Invalid UUID");let s;const o=new Uint8Array(16);return o[0]=(s=parseInt(i.slice(0,8),16))>>>24,o[1]=s>>>16&255,o[2]=s>>>8&255,o[3]=s&255,o[4]=(s=parseInt(i.slice(9,13),16))>>>8,o[5]=s&255,o[6]=(s=parseInt(i.slice(14,18),16))>>>8,o[7]=s&255,o[8]=(s=parseInt(i.slice(19,23),16))>>>8,o[9]=s&255,o[10]=(s=parseInt(i.slice(24,36),16))/1099511627776&255,o[11]=s/4294967296&255,o[12]=s>>>24&255,o[13]=s>>>16&255,o[14]=s>>>8&255,o[15]=s&255,o}var n=t;return Vp.default=n,Vp}var tI;function d_(){if(tI)return Ta;tI=1,Object.defineProperty(Ta,"__esModule",{value:!0}),Ta.URL=Ta.DNS=void 0,Ta.default=o;var r=oA(),e=t(u_());function t(a){return a&&a.__esModule?a:{default:a}}function n(a){a=unescape(encodeURIComponent(a));const l=[];for(let u=0;u<a.length;++u)l.push(a.charCodeAt(u));return l}const i="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Ta.DNS=i;const s="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Ta.URL=s;function o(a,l,u){function h(m,g,v,y){var A;if(typeof m=="string"&&(m=n(m)),typeof g=="string"&&(g=(0,e.default)(g)),((A=g)===null||A===void 0?void 0:A.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let x=new Uint8Array(16+m.length);if(x.set(g),x.set(m,g.length),x=u(x),x[6]=x[6]&15|l,x[8]=x[8]&63|128,v){y=y||0;for(let b=0;b<16;++b)v[y+b]=x[b];return v}return(0,r.unsafeStringify)(x)}try{h.name=a}catch{}return h.DNS=i,h.URL=s,h}return Ta}var qp={},rI;function R3(){if(rI)return qp;rI=1,Object.defineProperty(qp,"__esModule",{value:!0}),qp.default=void 0;function r(v){if(typeof v=="string"){const y=unescape(encodeURIComponent(v));v=new Uint8Array(y.length);for(let A=0;A<y.length;++A)v[A]=y.charCodeAt(A)}return e(n(i(v),v.length*8))}function e(v){const y=[],A=v.length*32,x="0123456789abcdef";for(let b=0;b<A;b+=8){const w=v[b>>5]>>>b%32&255,T=parseInt(x.charAt(w>>>4&15)+x.charAt(w&15),16);y.push(T)}return y}function t(v){return(v+64>>>9<<4)+14+1}function n(v,y){v[y>>5]|=128<<y%32,v[t(y)-1]=y;let A=1732584193,x=-271733879,b=-1732584194,w=271733878;for(let T=0;T<v.length;T+=16){const k=A,I=x,M=b,L=w;A=l(A,x,b,w,v[T],7,-680876936),w=l(w,A,x,b,v[T+1],12,-389564586),b=l(b,w,A,x,v[T+2],17,606105819),x=l(x,b,w,A,v[T+3],22,-1044525330),A=l(A,x,b,w,v[T+4],7,-176418897),w=l(w,A,x,b,v[T+5],12,1200080426),b=l(b,w,A,x,v[T+6],17,-1473231341),x=l(x,b,w,A,v[T+7],22,-45705983),A=l(A,x,b,w,v[T+8],7,1770035416),w=l(w,A,x,b,v[T+9],12,-1958414417),b=l(b,w,A,x,v[T+10],17,-42063),x=l(x,b,w,A,v[T+11],22,-1990404162),A=l(A,x,b,w,v[T+12],7,1804603682),w=l(w,A,x,b,v[T+13],12,-40341101),b=l(b,w,A,x,v[T+14],17,-1502002290),x=l(x,b,w,A,v[T+15],22,1236535329),A=u(A,x,b,w,v[T+1],5,-165796510),w=u(w,A,x,b,v[T+6],9,-1069501632),b=u(b,w,A,x,v[T+11],14,643717713),x=u(x,b,w,A,v[T],20,-373897302),A=u(A,x,b,w,v[T+5],5,-701558691),w=u(w,A,x,b,v[T+10],9,38016083),b=u(b,w,A,x,v[T+15],14,-660478335),x=u(x,b,w,A,v[T+4],20,-405537848),A=u(A,x,b,w,v[T+9],5,568446438),w=u(w,A,x,b,v[T+14],9,-1019803690),b=u(b,w,A,x,v[T+3],14,-187363961),x=u(x,b,w,A,v[T+8],20,1163531501),A=u(A,x,b,w,v[T+13],5,-1444681467),w=u(w,A,x,b,v[T+2],9,-51403784),b=u(b,w,A,x,v[T+7],14,1735328473),x=u(x,b,w,A,v[T+12],20,-1926607734),A=h(A,x,b,w,v[T+5],4,-378558),w=h(w,A,x,b,v[T+8],11,-2022574463),b=h(b,w,A,x,v[T+11],16,1839030562),x=h(x,b,w,A,v[T+14],23,-35309556),A=h(A,x,b,w,v[T+1],4,-1530992060),w=h(w,A,x,b,v[T+4],11,1272893353),b=h(b,w,A,x,v[T+7],16,-155497632),x=h(x,b,w,A,v[T+10],23,-1094730640),A=h(A,x,b,w,v[T+13],4,681279174),w=h(w,A,x,b,v[T],11,-358537222),b=h(b,w,A,x,v[T+3],16,-722521979),x=h(x,b,w,A,v[T+6],23,76029189),A=h(A,x,b,w,v[T+9],4,-640364487),w=h(w,A,x,b,v[T+12],11,-421815835),b=h(b,w,A,x,v[T+15],16,530742520),x=h(x,b,w,A,v[T+2],23,-995338651),A=m(A,x,b,w,v[T],6,-198630844),w=m(w,A,x,b,v[T+7],10,1126891415),b=m(b,w,A,x,v[T+14],15,-1416354905),x=m(x,b,w,A,v[T+5],21,-57434055),A=m(A,x,b,w,v[T+12],6,1700485571),w=m(w,A,x,b,v[T+3],10,-1894986606),b=m(b,w,A,x,v[T+10],15,-1051523),x=m(x,b,w,A,v[T+1],21,-2054922799),A=m(A,x,b,w,v[T+8],6,1873313359),w=m(w,A,x,b,v[T+15],10,-30611744),b=m(b,w,A,x,v[T+6],15,-1560198380),x=m(x,b,w,A,v[T+13],21,1309151649),A=m(A,x,b,w,v[T+4],6,-145523070),w=m(w,A,x,b,v[T+11],10,-1120210379),b=m(b,w,A,x,v[T+2],15,718787259),x=m(x,b,w,A,v[T+9],21,-343485551),A=s(A,k),x=s(x,I),b=s(b,M),w=s(w,L)}return[A,x,b,w]}function i(v){if(v.length===0)return[];const y=v.length*8,A=new Uint32Array(t(y));for(let x=0;x<y;x+=8)A[x>>5]|=(v[x/8]&255)<<x%32;return A}function s(v,y){const A=(v&65535)+(y&65535);return(v>>16)+(y>>16)+(A>>16)<<16|A&65535}function o(v,y){return v<<y|v>>>32-y}function a(v,y,A,x,b,w){return s(o(s(s(y,v),s(x,w)),b),A)}function l(v,y,A,x,b,w,T){return a(y&A|~y&x,v,y,b,w,T)}function u(v,y,A,x,b,w,T){return a(y&x|A&~x,v,y,b,w,T)}function h(v,y,A,x,b,w,T){return a(y^A^x,v,y,b,w,T)}function m(v,y,A,x,b,w,T){return a(A^(y|~x),v,y,b,w,T)}var g=r;return qp.default=g,qp}var nI;function I3(){if(nI)return Hp;nI=1,Object.defineProperty(Hp,"__esModule",{value:!0}),Hp.default=void 0;var r=t(d_()),e=t(R3());function t(s){return s&&s.__esModule?s:{default:s}}var i=(0,r.default)("v3",48,e.default);return Hp.default=i,Hp}var Gp={},Kp={},iI;function k3(){if(iI)return Kp;iI=1,Object.defineProperty(Kp,"__esModule",{value:!0}),Kp.default=void 0;var e={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};return Kp.default=e,Kp}var sI;function M3(){if(sI)return Gp;sI=1,Object.defineProperty(Gp,"__esModule",{value:!0}),Gp.default=void 0;var r=n(k3()),e=n(c_()),t=oA();function n(o){return o&&o.__esModule?o:{default:o}}function i(o,a,l){if(r.default.randomUUID&&!a&&!o)return r.default.randomUUID();o=o||{};const u=o.random||(o.rng||e.default)();if(u[6]=u[6]&15|64,u[8]=u[8]&63|128,a){l=l||0;for(let h=0;h<16;++h)a[l+h]=u[h];return a}return(0,t.unsafeStringify)(u)}var s=i;return Gp.default=s,Gp}var Yp={},Xp={},oI;function N3(){if(oI)return Xp;oI=1,Object.defineProperty(Xp,"__esModule",{value:!0}),Xp.default=void 0;function r(i,s,o,a){switch(i){case 0:return s&o^~s&a;case 1:return s^o^a;case 2:return s&o^s&a^o&a;case 3:return s^o^a}}function e(i,s){return i<<s|i>>>32-s}function t(i){const s=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof i=="string"){const h=unescape(encodeURIComponent(i));i=[];for(let m=0;m<h.length;++m)i.push(h.charCodeAt(m))}else Array.isArray(i)||(i=Array.prototype.slice.call(i));i.push(128);const a=i.length/4+2,l=Math.ceil(a/16),u=new Array(l);for(let h=0;h<l;++h){const m=new Uint32Array(16);for(let g=0;g<16;++g)m[g]=i[h*64+g*4]<<24|i[h*64+g*4+1]<<16|i[h*64+g*4+2]<<8|i[h*64+g*4+3];u[h]=m}u[l-1][14]=(i.length-1)*8/Math.pow(2,32),u[l-1][14]=Math.floor(u[l-1][14]),u[l-1][15]=(i.length-1)*8&4294967295;for(let h=0;h<l;++h){const m=new Uint32Array(80);for(let b=0;b<16;++b)m[b]=u[h][b];for(let b=16;b<80;++b)m[b]=e(m[b-3]^m[b-8]^m[b-14]^m[b-16],1);let g=o[0],v=o[1],y=o[2],A=o[3],x=o[4];for(let b=0;b<80;++b){const w=Math.floor(b/20),T=e(g,5)+r(w,v,y,A)+x+s[w]+m[b]>>>0;x=A,A=y,y=e(v,30)>>>0,v=g,g=T}o[0]=o[0]+g>>>0,o[1]=o[1]+v>>>0,o[2]=o[2]+y>>>0,o[3]=o[3]+A>>>0,o[4]=o[4]+x>>>0}return[o[0]>>24&255,o[0]>>16&255,o[0]>>8&255,o[0]&255,o[1]>>24&255,o[1]>>16&255,o[1]>>8&255,o[1]&255,o[2]>>24&255,o[2]>>16&255,o[2]>>8&255,o[2]&255,o[3]>>24&255,o[3]>>16&255,o[3]>>8&255,o[3]&255,o[4]>>24&255,o[4]>>16&255,o[4]>>8&255,o[4]&255]}var n=t;return Xp.default=n,Xp}var aI;function L3(){if(aI)return Yp;aI=1,Object.defineProperty(Yp,"__esModule",{value:!0}),Yp.default=void 0;var r=t(d_()),e=t(N3());function t(s){return s&&s.__esModule?s:{default:s}}var i=(0,r.default)("v5",80,e.default);return Yp.default=i,Yp}var Jp={},lI;function _3(){if(lI)return Jp;lI=1,Object.defineProperty(Jp,"__esModule",{value:!0}),Jp.default=void 0;var r="00000000-0000-0000-0000-000000000000";return Jp.default=r,Jp}var Qp={},cI;function O3(){if(cI)return Qp;cI=1,Object.defineProperty(Qp,"__esModule",{value:!0}),Qp.default=void 0;var r=e(sA());function e(i){return i&&i.__esModule?i:{default:i}}function t(i){if(!(0,r.default)(i))throw TypeError("Invalid UUID");return parseInt(i.slice(14,15),16)}var n=t;return Qp.default=n,Qp}var uI;function D3(){return uI||(uI=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"NIL",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"validate",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return o.default}});var e=h(E3()),t=h(I3()),n=h(M3()),i=h(L3()),s=h(_3()),o=h(O3()),a=h(sA()),l=h(oA()),u=h(u_());function h(m){return m&&m.__esModule?m:{default:m}}})(cx)),cx}var dI;function Nu(){if(dI)return Hl;dI=1,Object.defineProperty(Hl,"__esModule",{value:!0}),Hl.createNoDashGuid=Hl.createGuid=void 0;const r=D3(),e=()=>(0,r.v4)();Hl.createGuid=e;const t=()=>e().replace(new RegExp("-","g"),"").toUpperCase();return Hl.createNoDashGuid=t,Hl}var hI;function iy(){return hI||(hI=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.PlatformEvent=r.EventType=void 0;const e=Nu();(function(n){n[n.Debug=0]="Debug",n[n.Info=1]="Info",n[n.Warning=2]="Warning",n[n.Error=3]="Error",n[n.None=4]="None"})(r.EventType||(r.EventType={}));class t{constructor(i,s){this.privName=i,this.privEventId=(0,e.createNoDashGuid)(),this.privEventTime=new Date().toISOString(),this.privEventType=s,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}r.PlatformEvent=t})(lx)),lx}var pI;function j3(){if(pI)return Ht;pI=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.AudioStreamNodeErrorEvent=Ht.AudioStreamNodeDetachedEvent=Ht.AudioStreamNodeAttachedEvent=Ht.AudioStreamNodeAttachingEvent=Ht.AudioStreamNodeEvent=Ht.AudioSourceErrorEvent=Ht.AudioSourceOffEvent=Ht.AudioSourceReadyEvent=Ht.AudioSourceInitializingEvent=Ht.AudioSourceEvent=void 0;const r=iy();class e extends r.PlatformEvent{constructor(g,v,y=r.EventType.Info){super(g,y),this.privAudioSourceId=v}get audioSourceId(){return this.privAudioSourceId}}Ht.AudioSourceEvent=e;class t extends e{constructor(g){super("AudioSourceInitializingEvent",g)}}Ht.AudioSourceInitializingEvent=t;class n extends e{constructor(g){super("AudioSourceReadyEvent",g)}}Ht.AudioSourceReadyEvent=n;class i extends e{constructor(g){super("AudioSourceOffEvent",g)}}Ht.AudioSourceOffEvent=i;class s extends e{constructor(g,v){super("AudioSourceErrorEvent",g,r.EventType.Error),this.privError=v}get error(){return this.privError}}Ht.AudioSourceErrorEvent=s;class o extends e{constructor(g,v,y){super(g,v),this.privAudioNodeId=y}get audioNodeId(){return this.privAudioNodeId}}Ht.AudioStreamNodeEvent=o;class a extends o{constructor(g,v){super("AudioStreamNodeAttachingEvent",g,v)}}Ht.AudioStreamNodeAttachingEvent=a;class l extends o{constructor(g,v){super("AudioStreamNodeAttachedEvent",g,v)}}Ht.AudioStreamNodeAttachedEvent=l;class u extends o{constructor(g,v){super("AudioStreamNodeDetachedEvent",g,v)}}Ht.AudioStreamNodeDetachedEvent=u;class h extends o{constructor(g,v,y){super("AudioStreamNodeErrorEvent",g,v),this.privError=y}get error(){return this.privError}}return Ht.AudioStreamNodeErrorEvent=h,Ht}var Vt={},fI;function B3(){if(fI)return Vt;fI=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.ConnectionRedirectEvent=Vt.ConnectionMessageSentEvent=Vt.ConnectionMessageReceivedEvent=Vt.ConnectionEstablishErrorEvent=Vt.ConnectionErrorEvent=Vt.ConnectionClosedEvent=Vt.ConnectionEstablishedEvent=Vt.ConnectionStartEvent=Vt.ConnectionEvent=Vt.ServiceEvent=void 0;const r=iy();class e extends r.PlatformEvent{constructor(g,v,y=r.EventType.Info){super(g,y),this.privJsonResult=v}get jsonString(){return this.privJsonResult}}Vt.ServiceEvent=e;class t extends r.PlatformEvent{constructor(g,v,y=r.EventType.Info){super(g,y),this.privConnectionId=v}get connectionId(){return this.privConnectionId}}Vt.ConnectionEvent=t;class n extends t{constructor(g,v,y){super("ConnectionStartEvent",g),this.privUri=v,this.privHeaders=y}get uri(){return this.privUri}get headers(){return this.privHeaders}}Vt.ConnectionStartEvent=n;class i extends t{constructor(g){super("ConnectionEstablishedEvent",g)}}Vt.ConnectionEstablishedEvent=i;class s extends t{constructor(g,v,y){super("ConnectionClosedEvent",g,r.EventType.Debug),this.privReason=y,this.privStatusCode=v}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}Vt.ConnectionClosedEvent=s;class o extends t{constructor(g,v,y){super("ConnectionErrorEvent",g,r.EventType.Debug),this.privMessage=v,this.privType=y}get message(){return this.privMessage}get type(){return this.privType}}Vt.ConnectionErrorEvent=o;class a extends t{constructor(g,v,y){super("ConnectionEstablishErrorEvent",g,r.EventType.Error),this.privStatusCode=v,this.privReason=y}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}Vt.ConnectionEstablishErrorEvent=a;class l extends t{constructor(g,v,y){super("ConnectionMessageReceivedEvent",g),this.privNetworkReceivedTime=v,this.privMessage=y}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}Vt.ConnectionMessageReceivedEvent=l;class u extends t{constructor(g,v,y){super("ConnectionMessageSentEvent",g),this.privNetworkSentTime=v,this.privMessage=y}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}Vt.ConnectionMessageSentEvent=u;class h extends t{constructor(g,v,y,A){super("ConnectionRedirectEvent",g,r.EventType.Info),this.privRedirectUrl=v,this.privOriginalUrl=y,this.privContext=A}get redirectUrl(){return this.privRedirectUrl}get originalUrl(){return this.privOriginalUrl}get context(){return this.privContext}}return Vt.ConnectionRedirectEvent=h,Vt}var ux={},to={},mI;function Zs(){if(mI)return to;mI=1,Object.defineProperty(to,"__esModule",{value:!0}),to.ObjectDisposedError=to.InvalidOperationError=to.ArgumentNullError=void 0;class r extends Error{constructor(i){super(i),this.name="ArgumentNull",this.message=i}}to.ArgumentNullError=r;class e extends Error{constructor(i){super(i),this.name="InvalidOperation",this.message=i}}to.InvalidOperationError=e;class t extends Error{constructor(i,s){super(s),this.name=i+"ObjectDisposed",this.message=s}}return to.ObjectDisposedError=t,to}var gI;function h_(){return gI||(gI=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ConnectionMessage=r.MessageType=void 0;const e=Zs(),t=Nu();var n;(function(s){s[s.Text=0]="Text",s[s.Binary=1]="Binary"})(n=r.MessageType||(r.MessageType={}));class i{constructor(o,a,l,u){if(this.privBody=null,o===n.Text&&a&&typeof a!="string")throw new e.InvalidOperationError("Payload must be a string");if(o===n.Binary&&a&&!(a instanceof ArrayBuffer))throw new e.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=o,this.privBody=a,this.privHeaders=l||{},this.privId=u||(0,t.createNoDashGuid)(),this.messageType){case n.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case n.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===n.Binary)throw new e.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===n.Text)throw new e.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}r.ConnectionMessage=i})(ux)),ux}var ef={},vI;function z3(){if(vI)return ef;vI=1,Object.defineProperty(ef,"__esModule",{value:!0}),ef.ConnectionOpenResponse=void 0;let r=class{constructor(t,n){this.privStatusCode=t,this.privReason=n}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};return ef.ConnectionOpenResponse=r,ef}var tf={},SI;function F3(){if(SI)return tf;SI=1,Object.defineProperty(tf,"__esModule",{value:!0}),tf.DeferralMap=void 0;let r=class{constructor(){this.privMap={}}add(t,n){this.privMap[t]=n}getId(t){return this.privMap[t]}complete(t,n){try{this.privMap[t].resolve(n)}catch(i){this.privMap[t].reject(i)}finally{this.privMap[t]=void 0}}};return tf.DeferralMap=r,tf}var Vl={},yI;function p_(){if(yI)return Vl;yI=1,Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.SendingAgentContextMessageEvent=Vl.DialogEvent=void 0;const r=iy();class e extends r.PlatformEvent{constructor(i,s=r.EventType.Info){super(i,s)}}Vl.DialogEvent=e;class t extends e{constructor(i){super("SendingAgentContextMessageEvent"),this.privAgentConfig=i}get agentConfig(){return this.privAgentConfig}}return Vl.SendingAgentContextMessageEvent=t,Vl}var rf={},nf={},CI;function f_(){if(CI)return nf;CI=1,Object.defineProperty(nf,"__esModule",{value:!0}),nf.EventSource=void 0;const r=Zs(),e=Nu();let t=class{constructor(i){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=i}onEvent(i){if(this.isDisposed())throw new r.ObjectDisposedError("EventSource");if(this.metadata)for(const s in this.metadata)s&&i.metadata&&(i.metadata[s]||(i.metadata[s]=this.metadata[s]));for(const s in this.privEventListeners)s&&this.privEventListeners[s]&&this.privEventListeners[s](i)}attach(i){const s=(0,e.createNoDashGuid)();return this.privEventListeners[s]=i,{detach:()=>(delete this.privEventListeners[s],Promise.resolve())}}attachListener(i){return this.attach(s=>i.onEvent(s))}attachConsoleListener(i){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(s=>i.onEvent(s)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};return nf.EventSource=t,nf}var AI;function W3(){if(AI)return rf;AI=1,Object.defineProperty(rf,"__esModule",{value:!0}),rf.Events=void 0;const r=Zs(),e=f_();let t=class jT{static setEventSource(i){if(!i)throw new r.ArgumentNullError("eventSource");jT.privInstance=i}static get instance(){return jT.privInstance}};return rf.Events=t,t.privInstance=new e.EventSource,rf}var dx={},bI;function U3(){return bI||(bI=1,Object.defineProperty(dx,"__esModule",{value:!0})),dx}var hx={},xI;function Z3(){return xI||(xI=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ConnectionState=void 0,(function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"})(r.ConnectionState||(r.ConnectionState={}))})(hx)),hx}var px={},TI;function $3(){return TI||(TI=1,Object.defineProperty(px,"__esModule",{value:!0})),px}var fx={},wI;function H3(){return wI||(wI=1,Object.defineProperty(fx,"__esModule",{value:!0})),fx}var mx={},PI;function V3(){return PI||(PI=1,Object.defineProperty(mx,"__esModule",{value:!0})),mx}var gx={},EI;function q3(){return EI||(EI=1,Object.defineProperty(gx,"__esModule",{value:!0})),gx}var vx={},RI;function G3(){return RI||(RI=1,Object.defineProperty(vx,"__esModule",{value:!0})),vx}var Sx={},II;function K3(){return II||(II=1,Object.defineProperty(Sx,"__esModule",{value:!0})),Sx}var yx={},kI;function Y3(){return kI||(kI=1,Object.defineProperty(yx,"__esModule",{value:!0})),yx}var Cx={},MI;function X3(){return MI||(MI=1,Object.defineProperty(Cx,"__esModule",{value:!0})),Cx}var sf={},NI;function m_(){if(NI)return sf;NI=1,Object.defineProperty(sf,"__esModule",{value:!0}),sf.List=void 0;const r=Zs();let e=class oc{constructor(n){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],n)for(const i of n)this.privList.push(i)}get(n){return this.throwIfDisposed(),this.privList[n]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(n){this.throwIfDisposed(),this.insertAt(this.privList.length,n)}insertAt(n,i){this.throwIfDisposed(),n===0?this.privList.unshift(i):n===this.privList.length?this.privList.push(i):this.privList.splice(n,0,i),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(n){return this.throwIfDisposed(),this.remove(n,1)[0]}remove(n,i){this.throwIfDisposed();const s=this.privList.splice(n,i);return this.triggerSubscriptions(this.privRemoveSubscriptions),s}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(n){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[i]=n,{detach:()=>(delete this.privAddSubscriptions[i],Promise.resolve())}}onRemoved(n){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[i]=n,{detach:()=>(delete this.privRemoveSubscriptions[i],Promise.resolve())}}onDisposed(n){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[i]=n,{detach:()=>(delete this.privDisposedSubscriptions[i],Promise.resolve())}}join(n){return this.throwIfDisposed(),this.privList.join(n)}toArray(){const n=Array();return this.privList.forEach(i=>{n.push(i)}),n}any(n){return this.throwIfDisposed(),n?this.where(n).length()>0:this.length()>0}all(n){return this.throwIfDisposed(),this.where(n).length()===this.length()}forEach(n){this.throwIfDisposed();for(let i=0;i<this.length();i++)n(this.privList[i],i)}select(n){this.throwIfDisposed();const i=[];for(let s=0;s<this.privList.length;s++)i.push(n(this.privList[s],s));return new oc(i)}where(n){this.throwIfDisposed();const i=new oc;for(let s=0;s<this.privList.length;s++)n(this.privList[s],s)&&i.add(this.privList[s]);return i}orderBy(n){this.throwIfDisposed();const s=this.toArray().sort(n);return new oc(s)}orderByDesc(n){return this.throwIfDisposed(),this.orderBy((i,s)=>n(s,i))}clone(){return this.throwIfDisposed(),new oc(this.toArray())}concat(n){return this.throwIfDisposed(),new oc(this.privList.concat(n.toArray()))}concatArray(n){return this.throwIfDisposed(),new oc(this.privList.concat(n))}isDisposed(){return this.privList==null}dispose(n){this.isDisposed()||(this.privDisposeReason=n,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new r.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(n){if(n)for(const i in n)i&&n[i]()}};return sf.List=e,sf}var Ax={},LI;function g_(){return LI||(LI=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.marshalPromiseToCallbacks=r.Sink=r.Deferred=r.PromiseResultEventSource=r.PromiseResult=r.PromiseState=void 0;var e;(function(a){a[a.None=0]="None",a[a.Resolved=1]="Resolved",a[a.Rejected=2]="Rejected"})(e=r.PromiseState||(r.PromiseState={}));class t{constructor(l){this.throwIfError=()=>{if(this.isError)throw this.error},l.on(u=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=u)},u=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=u)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}r.PromiseResult=t;class n{constructor(){this.setResult=l=>{this.privOnSetResult(l)},this.setError=l=>{this.privOnSetError(l)},this.on=(l,u)=>{this.privOnSetResult=l,this.privOnSetError=u}}}r.PromiseResultEventSource=n;class i{constructor(){this.resolve=l=>(this.privResolve(l),this),this.reject=l=>(this.privReject(l),this),this.privPromise=new Promise((l,u)=>{this.privResolve=l,this.privReject=u})}get promise(){return this.privPromise}}r.Deferred=i;class s{constructor(){this.privState=e.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new n,this.privPromiseResult=new t(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(l){if(this.privState!==e.None)throw new Error("'Cannot resolve a completed promise'");this.privState=e.Resolved,this.privPromiseResultEvents.setResult(l);for(let u=0;u<this.privSuccessHandlers.length;u++)this.executeSuccessCallback(l,this.privSuccessHandlers[u],this.privErrorHandlers[u]);this.detachHandlers()}reject(l){if(this.privState!==e.None)throw new Error("'Cannot reject a completed promise'");this.privState=e.Rejected,this.privPromiseResultEvents.setError(l);for(const u of this.privErrorHandlers)this.executeErrorCallback(l,u);this.detachHandlers()}on(l,u){l==null&&(l=()=>{}),this.privState===e.None?(this.privSuccessHandlers.push(l),this.privErrorHandlers.push(u)):(this.privState===e.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,l,u):this.privState===e.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,u),this.detachHandlers())}executeSuccessCallback(l,u,h){try{u(l)}catch(m){this.executeErrorCallback(`'Unhandled callback error: ${m}'`,h)}}executeErrorCallback(l,u){if(u)try{u(l)}catch(h){throw new Error(`'Unhandled callback error: ${h}. InnerError: ${l}'`)}else throw new Error(`'Unhandled error: ${l}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}}r.Sink=s;function o(a,l,u){a.then(h=>{try{l&&l(h)}catch(m){if(u)try{if(m instanceof Error){const g=m;u(g.name+": "+g.message)}else u(m)}catch{}}},h=>{if(u)try{if(h instanceof Error){const m=h;u(m.name+": "+m.message)}else u(h)}catch{}})}r.marshalPromiseToCallbacks=o})(Ax)),Ax}var of={},_I;function v_(){if(_I)return of;_I=1,Object.defineProperty(of,"__esModule",{value:!0}),of.Queue=void 0;const r=Zs(),e=m_(),t=g_();var n;(function(s){s[s.Dequeue=0]="Dequeue",s[s.Peek=1]="Peek"})(n||(n={}));let i=class{constructor(o){this.privPromiseStore=new e.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=o||new e.List,this.privDetachables=[],this.privSubscribers=new e.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(o){this.throwIfDispose(),this.enqueueFromPromise(new Promise(a=>a(o)))}enqueueFromPromise(o){this.throwIfDispose(),o.then(a=>{this.privList.add(a)},()=>{})}dequeue(){this.throwIfDispose();const o=new t.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:o,type:n.Dequeue}),this.drain()),o.promise}peek(){this.throwIfDispose();const o=new t.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:o,type:n.Peek}),this.drain()),o.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(o,a){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=a,this.privIsDisposing=!0;const l=this.privSubscribers;if(l){for(;l.length()>0;)l.removeFirst().deferral.resolve(void 0);this.privSubscribers===l&&(this.privSubscribers=l)}for(const u of this.privDetachables)await u.detach();if(this.privPromiseStore.length()>0&&o){const u=[];return this.privPromiseStore.toArray().forEach(h=>{u.push(h)}),Promise.all(u).finally(()=>{this.privSubscribers=null,this.privList.forEach(h=>{o(h)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}}async dispose(o){await this.drainAndDispose(null,o)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const o=this.privSubscribers,a=this.privList;if(o&&a){for(;a.length()>0&&o.length()>0&&!this.privIsDisposing;){const l=o.removeFirst();if(l.type===n.Peek)l.deferral.resolve(a.first());else{const u=a.removeFirst();l.deferral.resolve(u)}}this.privSubscribers===o&&(this.privSubscribers=o),this.privList===a&&(this.privList=a)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new r.InvalidOperationError(this.privDisposeReason):new r.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new r.InvalidOperationError("Queue disposing")}};return of.Queue=i,of}var af={},OI;function J3(){if(OI)return af;OI=1,Object.defineProperty(af,"__esModule",{value:!0}),af.RawWebsocketMessage=void 0;const r=h_(),e=Zs(),t=Nu();let n=class{constructor(s,o,a){if(this.privPayload=null,!o)throw new e.ArgumentNullError("payload");if(s===r.MessageType.Binary&&Object.getPrototypeOf(o).constructor.name!=="ArrayBuffer")throw new e.InvalidOperationError("Payload must be ArrayBuffer");if(s===r.MessageType.Text&&typeof o!="string")throw new e.InvalidOperationError("Payload must be a string");this.privMessageType=s,this.privPayload=o,this.privId=a||(0,t.createNoDashGuid)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===r.MessageType.Binary)throw new e.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===r.MessageType.Text)throw new e.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};return af.RawWebsocketMessage=n,af}var lf={},DI;function Q3(){if(DI)return lf;DI=1,Object.defineProperty(lf,"__esModule",{value:!0}),lf.RiffPcmEncoder=void 0;let r=class{constructor(t,n){this.privActualSampleRate=t,this.privDesiredSampleRate=n}encode(t){const n=this.downSampleAudioFrame(t,this.privActualSampleRate,this.privDesiredSampleRate);if(!n)return null;const i=n.length*2,s=new ArrayBuffer(i),o=new DataView(s);return this.floatTo16BitPCM(o,0,n),s}setString(t,n,i){for(let s=0;s<i.length;s++)t.setUint8(n+s,i.charCodeAt(s))}floatTo16BitPCM(t,n,i){for(let s=0;s<i.length;s++,n+=2){const o=Math.max(-1,Math.min(1,i[s]));t.setInt16(n,o<0?o*32768:o*32767,!0)}}downSampleAudioFrame(t,n,i){if(!t)return null;if(i===n||i>n)return t;const s=n/i,o=Math.round(t.length/s),a=new Float32Array(o);let l=0,u=0;for(;u<o;){const h=Math.round((u+1)*s);let m=0,g=0;for(;l<h&&l<t.length;)m+=t[l++],g++;a[u++]=m/g}return a}};return lf.RiffPcmEncoder=r,lf}var cf={},jI;function e5(){if(jI)return cf;jI=1,Object.defineProperty(cf,"__esModule",{value:!0}),cf.Stream=void 0;const r=Zs(),e=Nu(),t=v_();let n=class{constructor(s){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=s||(0,e.createNoDashGuid)(),this.privReaderQueue=new t.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(s){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(s)}catch{}}read(){if(this.privIsReadEnded)throw new r.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async s=>((s===void 0||s.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),s))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new t.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new r.InvalidOperationError("Stream closed")}};return cf.Stream=n,cf}var bx={},BI;function PP(){return BI||(BI=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.TranslationStatus=void 0,(function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"})(r.TranslationStatus||(r.TranslationStatus={}))})(bx)),bx}var uf={},zI;function t5(){if(zI)return uf;zI=1,Object.defineProperty(uf,"__esModule",{value:!0}),uf.ChunkedArrayBufferStream=void 0;const r=We();let e=class extends r.Stream{constructor(n,i){super(i),this.privTargetChunkSize=Math.round(n),this.privNextBufferReadyBytes=0}writeStreamChunk(n){if(n.isEnd||this.privNextBufferReadyBytes===0&&n.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(n);return}let i=0;for(;i<n.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=n.timeReceived);const s=Math.min(n.buffer.byteLength-i,this.privTargetChunkSize-this.privNextBufferReadyBytes),o=new Uint8Array(this.privNextBufferToWrite),a=new Uint8Array(n.buffer.slice(i,s+i));o.set(a,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=s,i+=s,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};return uf.ChunkedArrayBufferStream=e,uf}var xx={},FI;function r5(){return FI||(FI=1,Object.defineProperty(xx,"__esModule",{value:!0})),xx}var df={},WI;function n5(){if(WI)return df;WI=1,Object.defineProperty(df,"__esModule",{value:!0}),df.Timeout=void 0;let r=class Pa{static load(){const t=new Map([[0,()=>{}]]),n=new Map,s="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),o=new Worker(s);return o.addEventListener("message",({data:u})=>{if(Pa.isCallNotification(u)){const{params:{timerId:h}}=u,m=t.get(h);if(typeof m=="number"){const g=n.get(m);if(g===void 0||g!==h)throw new Error("The timer is in an undefined state.")}else if(typeof m<"u")m(),t.delete(h);else throw new Error("The timer is in an undefined state.")}else if(Pa.isClearResponse(u)){const{id:h}=u,m=n.get(h);if(m===void 0)throw new Error("The timer is in an undefined state.");n.delete(h),t.delete(m)}else{const{error:{message:h}}=u;throw new Error(h)}}),{clearTimeout:u=>{const h=Math.random();n.set(h,u),t.set(u,h),o.postMessage({id:h,method:"clear",params:{timerId:u}})},setTimeout:(u,h)=>{const m=Math.random();return t.set(m,u),o.postMessage({id:null,method:"set",params:{delay:h,now:performance.now(),timerId:m}}),m}}}static loadWorkerTimers(){return()=>(Pa.workerTimers!==null||(Pa.workerTimers=Pa.load()),Pa.workerTimers)}static isCallNotification(t){return t.method!==void 0&&t.method==="call"}static isClearResponse(t){return t.error===null&&typeof t.id=="number"}};return df.Timeout=r,r.workerTimers=null,r.clearTimeout=e=>r.timers().clearTimeout(e),r.setTimeout=(e,t)=>r.timers().setTimeout(e,t),r.timers=r.loadWorkerTimers(),df}var et={},UI;function i5(){if(UI)return et;UI=1,Object.defineProperty(et,"__esModule",{value:!0}),et.OCSPCacheUpdateErrorEvent=et.OCSPResponseRetrievedEvent=et.OCSPCacheFetchErrorEvent=et.OCSPVerificationFailedEvent=et.OCSPCacheHitEvent=et.OCSPCacheEntryNeedsRefreshEvent=et.OCSPCacheEntryExpiredEvent=et.OCSPWSUpgradeStartedEvent=et.OCSPStapleReceivedEvent=et.OCSPCacheUpdateCompleteEvent=et.OCSPDiskCacheStoreEvent=et.OCSPMemoryCacheStoreEvent=et.OCSPCacheUpdateNeededEvent=et.OCSPDiskCacheHitEvent=et.OCSPCacheMissEvent=et.OCSPMemoryCacheHitEvent=et.OCSPEvent=void 0;const r=iy();class e extends r.PlatformEvent{constructor(T,k,I){super(T,k),this.privSignature=I}}et.OCSPEvent=e;class t extends e{constructor(T){super("OCSPMemoryCacheHitEvent",r.EventType.Debug,T)}}et.OCSPMemoryCacheHitEvent=t;class n extends e{constructor(T){super("OCSPCacheMissEvent",r.EventType.Debug,T)}}et.OCSPCacheMissEvent=n;class i extends e{constructor(T){super("OCSPDiskCacheHitEvent",r.EventType.Debug,T)}}et.OCSPDiskCacheHitEvent=i;class s extends e{constructor(T){super("OCSPCacheUpdateNeededEvent",r.EventType.Debug,T)}}et.OCSPCacheUpdateNeededEvent=s;class o extends e{constructor(T){super("OCSPMemoryCacheStoreEvent",r.EventType.Debug,T)}}et.OCSPMemoryCacheStoreEvent=o;class a extends e{constructor(T){super("OCSPDiskCacheStoreEvent",r.EventType.Debug,T)}}et.OCSPDiskCacheStoreEvent=a;class l extends e{constructor(T){super("OCSPCacheUpdateCompleteEvent",r.EventType.Debug,T)}}et.OCSPCacheUpdateCompleteEvent=l;class u extends e{constructor(){super("OCSPStapleReceivedEvent",r.EventType.Debug,"")}}et.OCSPStapleReceivedEvent=u;class h extends e{constructor(T){super("OCSPWSUpgradeStartedEvent",r.EventType.Debug,T)}}et.OCSPWSUpgradeStartedEvent=h;class m extends e{constructor(T,k){super("OCSPCacheEntryExpiredEvent",r.EventType.Debug,T),this.privExpireTime=k}}et.OCSPCacheEntryExpiredEvent=m;class g extends e{constructor(T,k,I){super("OCSPCacheEntryNeedsRefreshEvent",r.EventType.Debug,T),this.privExpireTime=I,this.privStartTime=k}}et.OCSPCacheEntryNeedsRefreshEvent=g;class v extends e{constructor(T,k,I){super("OCSPCacheHitEvent",r.EventType.Debug,T),this.privExpireTime=I,this.privExpireTimeString=new Date(I).toLocaleDateString(),this.privStartTime=k,this.privStartTimeString=new Date(k).toLocaleTimeString()}}et.OCSPCacheHitEvent=v;class y extends e{constructor(T,k){super("OCSPVerificationFailedEvent",r.EventType.Debug,T),this.privError=k}}et.OCSPVerificationFailedEvent=y;class A extends e{constructor(T,k){super("OCSPCacheFetchErrorEvent",r.EventType.Debug,T),this.privError=k}}et.OCSPCacheFetchErrorEvent=A;class x extends e{constructor(T){super("OCSPResponseRetrievedEvent",r.EventType.Debug,T)}}et.OCSPResponseRetrievedEvent=x;class b extends e{constructor(T,k){super("OCSPCacheUpdateErrorEvent",r.EventType.Debug,T),this.privError=k}}return et.OCSPCacheUpdateErrorEvent=b,et}var hf={},ZI;function s5(){if(ZI)return hf;ZI=1,Object.defineProperty(hf,"__esModule",{value:!0}),hf.BackgroundEvent=void 0;const r=We();class e extends r.PlatformEvent{constructor(n){super("BackgroundEvent",r.EventType.Error),this.privError=n}get error(){return this.privError}}return hf.BackgroundEvent=e,hf}var $I;function We(){return $I||($I=1,(function(r){var e=$l&&$l.__createBinding||(Object.create?(function(i,s,o,a){a===void 0&&(a=o),Object.defineProperty(i,a,{enumerable:!0,get:function(){return s[o]}})}):(function(i,s,o,a){a===void 0&&(a=o),i[a]=s[o]})),t=$l&&$l.__exportStar||function(i,s){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,i,o)};Object.defineProperty(r,"__esModule",{value:!0}),r.TranslationStatus=void 0,t(j3(),r),t(B3(),r),t(h_(),r),t(z3(),r),t(F3(),r),t(p_(),r),t(Zs(),r),t(W3(),r),t(f_(),r),t(Nu(),r),t(U3(),r),t(Z3(),r),t($3(),r),t(H3(),r),t(V3(),r),t(q3(),r),t(G3(),r),t(K3(),r),t(Y3(),r),t(X3(),r),t(m_(),r),t(iy(),r),t(g_(),r),t(v_(),r),t(J3(),r),t(Q3(),r),t(e5(),r);var n=PP();Object.defineProperty(r,"TranslationStatus",{enumerable:!0,get:function(){return n.TranslationStatus}}),t(t5(),r),t(r5(),r),t(n5(),r),t(i5(),r),t(s5(),r)})($l)),$l}var pf={},HI;function ai(){if(HI)return pf;HI=1,Object.defineProperty(pf,"__esModule",{value:!0}),pf.HeaderNames=void 0;let r=class{};return pf.HeaderNames=r,r.AuthKey="Ocp-Apim-Subscription-Key",r.Authorization="Authorization",r.SpIDAuthKey="Apim-Subscription-Id",r.ConnectionId="X-ConnectionId",r.ContentType="Content-Type",r.CustomCommandsAppId="X-CommandsAppId",r.Path="Path",r.RequestId="X-RequestId",r.RequestStreamId="X-StreamId",r.RequestTimestamp="X-Timestamp",pf}var ff={},VI;function EP(){if(VI)return ff;VI=1,Object.defineProperty(ff,"__esModule",{value:!0}),ff.AuthInfo=void 0;class r{constructor(t,n){this.privHeaderName=t,this.privToken=n}get headerName(){return this.privHeaderName}get token(){return this.privToken}}return ff.AuthInfo=r,ff}var qI;function o5(){if(qI)return Wp;qI=1,Object.defineProperty(Wp,"__esModule",{value:!0}),Wp.CognitiveSubscriptionKeyAuthentication=void 0;const r=We(),e=ai(),t=EP();let n=class{constructor(s){if(!s)throw new r.ArgumentNullError("subscriptionKey");this.privAuthInfo=new t.AuthInfo(e.HeaderNames.AuthKey,s)}fetch(s){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(s){return Promise.resolve(this.privAuthInfo)}};return Wp.CognitiveSubscriptionKeyAuthentication=n,Wp}var mf={},GI;function a5(){if(GI)return mf;GI=1,Object.defineProperty(mf,"__esModule",{value:!0}),mf.CognitiveTokenAuthentication=void 0;const r=We(),e=EP(),t=ai();let n=class BT{constructor(s,o){if(!s)throw new r.ArgumentNullError("fetchCallback");if(!o)throw new r.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=s,this.privFetchOnExpiryCallback=o}fetch(s){return this.privFetchCallback(s).then(o=>new e.AuthInfo(t.HeaderNames.Authorization,o===void 0?void 0:BT.privTokenPrefix+o))}fetchOnExpiry(s){return this.privFetchOnExpiryCallback(s).then(o=>new e.AuthInfo(t.HeaderNames.Authorization,o===void 0?void 0:BT.privTokenPrefix+o))}};return mf.CognitiveTokenAuthentication=n,n.privTokenPrefix="Bearer ",mf}var Tx={},KI;function l5(){return KI||(KI=1,Object.defineProperty(Tx,"__esModule",{value:!0})),Tx}var wx={},YI;function c5(){return YI||(YI=1,Object.defineProperty(wx,"__esModule",{value:!0})),wx}var Px={},XI;function RP(){return XI||(XI=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.RecognitionEndedEvent=r.RecognitionCompletionStatus=r.RecognitionStartedEvent=r.ConnectingToServiceEvent=r.ListeningStartedEvent=r.RecognitionTriggeredEvent=r.SpeechRecognitionEvent=void 0;const e=We();class t extends e.PlatformEvent{constructor(h,m,g,v=e.EventType.Info){super(h,v),this.privRequestId=m,this.privSessionId=g}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}r.SpeechRecognitionEvent=t;class n extends t{constructor(h,m,g,v){super("RecognitionTriggeredEvent",h,m),this.privAudioSourceId=g,this.privAudioNodeId=v}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}r.RecognitionTriggeredEvent=n;class i extends t{constructor(h,m,g,v){super("ListeningStartedEvent",h,m),this.privAudioSourceId=g,this.privAudioNodeId=v}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}r.ListeningStartedEvent=i;class s extends t{constructor(h,m,g){super("ConnectingToServiceEvent",h,g),this.privAuthFetchEventid=m}get authFetchEventid(){return this.privAuthFetchEventid}}r.ConnectingToServiceEvent=s;class o extends t{constructor(h,m,g,v,y){super("RecognitionStartedEvent",h,y),this.privAudioSourceId=m,this.privAudioNodeId=g,this.privAuthFetchEventId=v}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}r.RecognitionStartedEvent=o;var a;(function(u){u[u.Success=0]="Success",u[u.AudioSourceError=1]="AudioSourceError",u[u.AudioSourceTimeout=2]="AudioSourceTimeout",u[u.AuthTokenFetchError=3]="AuthTokenFetchError",u[u.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",u[u.UnAuthorized=5]="UnAuthorized",u[u.ConnectTimeout=6]="ConnectTimeout",u[u.ConnectError=7]="ConnectError",u[u.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",u[u.UnknownError=9]="UnknownError"})(a=r.RecognitionCompletionStatus||(r.RecognitionCompletionStatus={}));class l extends t{constructor(h,m,g,v,y,A,x,b){super("RecognitionEndedEvent",h,y,x===a.Success?e.EventType.Info:e.EventType.Error),this.privAudioSourceId=m,this.privAudioNodeId=g,this.privAuthFetchEventId=v,this.privStatus=x,this.privError=b,this.privServiceTag=A}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}}r.RecognitionEndedEvent=l})(Px)),Px}var gf={},ql={},zi={};const u5={},d5=Object.freeze(Object.defineProperty({__proto__:null,default:u5},Symbol.toStringTag,{value:"Module"})),uc=r3(d5);var Ex={},JI;function S_(){return JI||(JI=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.LogLevel=void 0;const e=We();Object.defineProperty(r,"LogLevel",{enumerable:!0,get:function(){return e.EventType}})})(Ex)),Ex}var vf={},QI;function rt(){if(QI)return vf;QI=1,Object.defineProperty(vf,"__esModule",{value:!0}),vf.Contracts=void 0;let r=class Ea{static throwIfNullOrUndefined(t,n){if(t==null)throw new Error("throwIfNullOrUndefined:"+n)}static throwIfNull(t,n){if(t===null)throw new Error("throwIfNull:"+n)}static throwIfNullOrWhitespace(t,n){if(Ea.throwIfNullOrUndefined(t,n),(""+t).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+n)}static throwIfNullOrTooLong(t,n,i){if(Ea.throwIfNullOrUndefined(t,n),(""+t).length>i)throw new Error("throwIfNullOrTooLong:"+n+" (more than "+i.toString()+" characters)")}static throwIfNullOrTooShort(t,n,i){if(Ea.throwIfNullOrUndefined(t,n),(""+t).length<i)throw new Error("throwIfNullOrTooShort:"+n+" (less than "+i.toString()+" characters)")}static throwIfDisposed(t){if(t)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(t,n){if(Ea.throwIfNullOrUndefined(t,n),t.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+n);for(const i of t)Ea.throwIfNullOrWhitespace(i,n)}static throwIfFileDoesNotExist(t,n){Ea.throwIfNullOrWhitespace(t,n)}static throwIfNotUndefined(t,n){if(t!==void 0)throw new Error("throwIfNotUndefined:"+n)}static throwIfNumberOutOfRange(t,n,i,s){if(Ea.throwIfNullOrUndefined(t,n),t<i||t>s)throw new Error("throwIfNumberOutOfRange:"+n+" (must be between "+i.toString()+" and "+s.toString()+")")}};return vf.Contracts=r,vf}var ek;function h5(){if(ek)return zi;ek=1;var r=zi&&zi.__createBinding||(Object.create?(function(a,l,u,h){h===void 0&&(h=u),Object.defineProperty(a,h,{enumerable:!0,get:function(){return l[u]}})}):(function(a,l,u,h){h===void 0&&(h=u),a[h]=l[u]})),e=zi&&zi.__setModuleDefault||(Object.create?(function(a,l){Object.defineProperty(a,"default",{enumerable:!0,value:l})}):function(a,l){a.default=l}),t=zi&&zi.__importStar||function(a){if(a&&a.__esModule)return a;var l={};if(a!=null)for(var u in a)u!=="default"&&Object.prototype.hasOwnProperty.call(a,u)&&r(l,a,u);return e(l,a),l};Object.defineProperty(zi,"__esModule",{value:!0}),zi.ConsoleLoggingListener=void 0;const n=t(uc),i=S_(),s=rt();let o=class{constructor(l=i.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=l}set logPath(l){s.Contracts.throwIfNullOrUndefined(n.openSync,`
File System access not available`),this.privLogPath=l}set enableConsoleOutput(l){this.privEnableConsoleOutput=l}onEvent(l){if(l.eventType>=this.privLogLevelFilter){const u=this.toString(l);if(this.logCallback&&this.logCallback(u),this.privLogPath&&n.writeFileSync(this.privLogPath,u+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(l.eventType){case i.LogLevel.Debug:console.debug(u);break;case i.LogLevel.Info:console.info(u);break;case i.LogLevel.Warning:console.warn(u);break;case i.LogLevel.Error:console.error(u);break;default:console.log(u);break}}}toString(l){const u=[`${l.eventTime}`,`${l.name}`],h=l;for(const m in h)if(m&&l.hasOwnProperty(m)&&m!=="eventTime"&&m!=="eventType"&&m!=="eventId"&&m!=="name"&&m!=="constructor"){const g=h[m];let v="<NULL>";g!=null&&(typeof g=="number"||typeof g=="string"?v=g.toString():v=JSON.stringify(g)),u.push(`${m}: ${v}`)}return u.join(" | ")}};return zi.ConsoleLoggingListener=o,zi}var Rx={},tk;function p5(){return tk||(tk=1,Object.defineProperty(Rx,"__esModule",{value:!0})),Rx}var Ix={},kx={},rk;function Lu(){return rk||(rk=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.AudioStreamFormatImpl=r.AudioStreamFormat=r.AudioFormatTag=void 0;var e;(function(i){i[i.PCM=1]="PCM",i[i.MuLaw=2]="MuLaw",i[i.Siren=3]="Siren",i[i.MP3=4]="MP3",i[i.SILKSkype=5]="SILKSkype",i[i.OGG_OPUS=6]="OGG_OPUS",i[i.WEBM_OPUS=7]="WEBM_OPUS",i[i.ALaw=8]="ALaw",i[i.FLAC=9]="FLAC",i[i.OPUS=10]="OPUS",i[i.AMR_WB=11]="AMR_WB",i[i.G722=12]="G722"})(e=r.AudioFormatTag||(r.AudioFormatTag={}));class t{static getDefaultInputFormat(){return n.getDefaultInputFormat()}static getWaveFormat(s,o,a,l){return new n(s,o,a,l)}static getWaveFormatPCM(s,o,a){return new n(s,o,a)}}r.AudioStreamFormat=t;class n extends t{constructor(s=16e3,o=16,a=1,l=e.PCM){super();let u=!0;switch(l){case e.PCM:this.formatTag=1;break;case e.ALaw:this.formatTag=6;break;case e.MuLaw:this.formatTag=7;break;default:u=!1}if(this.bitsPerSample=o,this.samplesPerSec=s,this.channels=a,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),u){this.privHeader=new ArrayBuffer(44);const h=new DataView(this.privHeader);this.setString(h,0,"RIFF"),h.setUint32(4,0,!0),this.setString(h,8,"WAVEfmt "),h.setUint32(16,16,!0),h.setUint16(20,this.formatTag,!0),h.setUint16(22,this.channels,!0),h.setUint32(24,this.samplesPerSec,!0),h.setUint32(28,this.avgBytesPerSec,!0),h.setUint16(32,this.channels*(this.bitsPerSample/8),!0),h.setUint16(34,this.bitsPerSample,!0),this.setString(h,36,"data"),h.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new n}static getAudioContext(s){const o=window.AudioContext||window.webkitAudioContext||!1;if(o)return s!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new o({sampleRate:s}):new o;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(s,o,a){for(let l=0;l<a.length;l++)s.setUint8(o+l,a.charCodeAt(l))}}r.AudioStreamFormatImpl=n})(kx)),kx}var nk;function f5(){return nk||(nk=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.MicAudioSource=r.AudioWorkletSourceURLPropertyName=void 0;const e=Oe(),t=We(),n=Lu();r.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";class i{constructor(o,a,l,u){this.privRecorder=o,this.deviceId=a,this.privStreams={},this.privOutputChunkSize=i.AUDIOFORMAT.avgBytesPerSec/10,this.privId=l||(0,t.createNoDashGuid)(),this.privEvents=new t.EventSource,this.privMediaStream=u||null,this.privIsClosing=!1}get format(){return Promise.resolve(i.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new t.Deferred;try{this.createAudioContext()}catch(l){if(l instanceof Error){const u=l;this.privInitializeDeferral.reject(u.name+": "+u.message)}else this.privInitializeDeferral.reject(l);return this.privInitializeDeferral.promise}const o=window.navigator;let a=o.getUserMedia||o.webkitGetUserMedia||o.mozGetUserMedia||o.msGetUserMedia;if(o.mediaDevices&&(a=(l,u,h)=>{o.mediaDevices.getUserMedia(l).then(u).catch(h)}),a){const l=()=>{this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new t.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):a({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},u=>{this.privMediaStream=u,this.onEvent(new t.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},u=>{const h=`Error occurred during microphone initialization: ${u}`;this.privInitializeDeferral.reject(h),this.onEvent(new t.AudioSourceErrorEvent(this.privId,h))})};this.privContext.state==="suspended"?this.privContext.resume().then(l).catch(u=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${u}`)}):l()}else{const l="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(l),this.onEvent(new t.AudioSourceErrorEvent(l,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(o){return this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,o)),this.listen(o).then(a=>(this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,o)),{detach:async()=>(a.readEnded(),delete this.privStreams[o],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,o)),this.turnOff()),id:()=>o,read:()=>a.read()}))}detach(o){o&&this.privStreams[o]&&(this.privStreams[o].close(),delete this.privStreams[o],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,o)))}async turnOff(){for(const o in this.privStreams)if(o){const a=this.privStreams[o];a&&a.close()}this.onEvent(new t.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(o=>({bitspersample:i.AUDIOFORMAT.bitsPerSample,channelcount:i.AUDIOFORMAT.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:o,samplerate:i.AUDIOFORMAT.samplesPerSec,type:e.type.Microphones}))}setProperty(o,a){if(o===r.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(a);else throw new Error("Property '"+o+"' is not supported on Microphone.")}getMicrophoneLabel(){const o="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(o);this.privMicrophoneLabel=o;const a=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(a===void 0)return Promise.resolve(this.privMicrophoneLabel);const l=new t.Deferred;return navigator.mediaDevices.enumerateDevices().then(u=>{for(const h of u)if(h.deviceId===a){this.privMicrophoneLabel=h.label;break}l.resolve(this.privMicrophoneLabel)},()=>l.resolve(this.privMicrophoneLabel)),l.promise}async listen(o){await this.turnOn();const a=new t.ChunkedArrayBufferStream(this.privOutputChunkSize,o);this.privStreams[o]=a;try{this.privRecorder.record(this.privContext,this.privMediaStream,a)}catch(u){throw this.onEvent(new t.AudioStreamNodeErrorEvent(this.privId,o,u)),u}return a}onEvent(o){this.privEvents.onEvent(o),t.Events.instance.onEvent(o)}createAudioContext(){this.privContext||(this.privContext=n.AudioStreamFormatImpl.getAudioContext(i.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let o=!1;"close"in this.privContext&&(o=!0),o?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}}r.MicAudioSource=i,i.AUDIOFORMAT=n.AudioStreamFormat.getDefaultInputFormat()})(Ix)),Ix}var Sf={},ik;function m5(){if(ik)return Sf;ik=1,Object.defineProperty(Sf,"__esModule",{value:!0}),Sf.FileAudioSource=void 0;const r=Oe(),e=We(),t=Lu();let n=class{constructor(s,o,a){this.privStreams={},this.privHeaderEnd=44,this.privId=a||(0,e.createNoDashGuid)(),this.privEvents=new e.EventSource,this.privSource=s,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=s.name:this.privFilename=o||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const s=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new e.AudioSourceErrorEvent(s,"")),Promise.reject(s)}this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(s){this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,s));const o=await this.upload(s);return this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,s)),Promise.resolve({detach:async()=>{o.readEnded(),delete this.privStreams[s],this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,s)),await this.turnOff()},id:()=>s,read:()=>o.read()})}detach(s){s&&this.privStreams[s]&&(this.privStreams[s].close(),delete this.privStreams[s],this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,s)))}turnOff(){for(const s in this.privStreams)if(s){const o=this.privStreams[s];o&&!o.isClosed&&o.close()}return this.onEvent(new e.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(s=>Promise.resolve({bitspersample:s.bitsPerSample,channelcount:s.channels,connectivity:r.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:s.samplesPerSec,type:r.type.File}))}readHeader(){const o=this.privSource.slice(0,4296),a=new e.Deferred,l=u=>{const h=new DataView(u),m=b=>String.fromCharCode(h.getUint8(b),h.getUint8(b+1),h.getUint8(b+2),h.getUint8(b+3));if(m(0)!=="RIFF"){a.reject("Invalid WAV header in file, RIFF was not found");return}if(m(8)!=="WAVE"||m(12)!=="fmt "){a.reject("Invalid WAV header in file, WAVEfmt was not found");return}const g=h.getInt32(16,!0),v=h.getUint16(22,!0),y=h.getUint32(24,!0),A=h.getUint16(34,!0);let x=36+Math.max(g-16,0);for(;m(x)!=="data";x+=2)if(x>4288){a.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=x+8,a.resolve(t.AudioStreamFormat.getWaveFormatPCM(y,A,v))};if(typeof window<"u"&&typeof Blob<"u"&&o instanceof Blob){const u=new FileReader;u.onload=h=>{const m=h.target.result;l(m)},u.readAsArrayBuffer(o)}else{const u=o;l(u.buffer.slice(u.byteOffset,u.byteOffset+u.byteLength))}return a.promise}async upload(s){const o=a=>{const l=`Error occurred while processing '${this.privFilename}'. ${a}`;throw this.onEvent(new e.AudioStreamNodeErrorEvent(this.privId,s,l)),new Error(l)};try{await this.turnOn();const a=await this.privAudioFormatPromise,l=new e.ChunkedArrayBufferStream(a.avgBytesPerSec/10,s);this.privStreams[s]=l;const u=this.privSource.slice(this.privHeaderEnd),h=m=>{l.isClosed||(l.writeStreamChunk({buffer:m,isEnd:!1,timeReceived:Date.now()}),l.close())};if(typeof window<"u"&&typeof Blob<"u"&&u instanceof Blob){const m=new FileReader;m.onerror=g=>o(g.toString()),m.onload=g=>{const v=g.target.result;h(v)},m.readAsArrayBuffer(u)}else{const m=u;h(m.buffer.slice(m.byteOffset,m.byteOffset+m.byteLength))}return l}catch(a){o(a)}}onEvent(s){this.privEvents.onEvent(s),e.Events.instance.onEvent(s)}};return Sf.FileAudioSource=n,Sf}var yf={},sk;function g5(){if(sk)return yf;sk=1,Object.defineProperty(yf,"__esModule",{value:!0}),yf.PcmRecorder=void 0;const r=We();class e{constructor(n){this.privStopInputOnRelease=n}record(n,i,s){const a=new r.RiffPcmEncoder(n.sampleRate,16e3),l=n.createMediaStreamSource(i),u=()=>{const m=(()=>{let g=0;try{return n.createScriptProcessor(g,1,1)}catch{g=2048;let y=n.sampleRate;for(;g<16384&&y>=32e3;)g<<=1,y>>=1;return n.createScriptProcessor(g,1,1)}})();m.onaudioprocess=g=>{const v=g.inputBuffer.getChannelData(0);if(s&&!s.isClosed){const y=a.encode(v);y&&s.writeStreamChunk({buffer:y,isEnd:!1,timeReceived:Date.now()})}},l.connect(m),m.connect(n.destination),this.privMediaResources={scriptProcessorNode:m,source:l,stream:i}},h=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(n.audioWorklet&&!h){if(!this.privSpeechProcessorScript){const m=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,g=new Blob([m],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(g)}n.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const m=new AudioWorkletNode(n,"speech-processor");m.port.onmessage=g=>{const v=g.data;if(s&&!s.isClosed){const y=a.encode(v);y&&s.writeStreamChunk({buffer:y,isEnd:!1,timeReceived:Date.now()})}},l.connect(m),m.connect(n.destination),this.privMediaResources={scriptProcessorNode:m,source:l,stream:i}}).catch(()=>{u()})}else try{u()}catch(m){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${m}`)}}releaseMediaResources(n){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(n.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(i=>i.stop()),this.privMediaResources.source=null))}setWorkletUrl(n){this.privSpeechProcessorScript=n}}return yf.PcmRecorder=e,yf}var Cf={},_n={},ok;function y_(){if(ok)return _n;ok=1;var r=_n&&_n.__createBinding||(Object.create?(function(g,v,y,A){A===void 0&&(A=y),Object.defineProperty(g,A,{enumerable:!0,get:function(){return v[y]}})}):(function(g,v,y,A){A===void 0&&(A=y),g[A]=v[y]})),e=_n&&_n.__setModuleDefault||(Object.create?(function(g,v){Object.defineProperty(g,"default",{enumerable:!0,value:v})}):function(g,v){g.default=v}),t=_n&&_n.__importStar||function(g){if(g&&g.__esModule)return g;var v={};if(g!=null)for(var y in g)y!=="default"&&Object.prototype.hasOwnProperty.call(g,y)&&r(v,g,y);return e(v,g),v},n=_n&&_n.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(_n,"__esModule",{value:!0}),_n.WebsocketMessageAdapter=void 0;const i=t(uc),s=t(uc),o=n(uc),a=n(uc),l=n(uc),u=ai(),h=We();let m=class zT{constructor(v,y,A,x,b,w){if(!v)throw new h.ArgumentNullError("uri");if(!A)throw new h.ArgumentNullError("messageFormatter");this.proxyInfo=x,this.privConnectionEvents=new h.EventSource,this.privConnectionId=y,this.privMessageFormatter=A,this.privConnectionState=h.ConnectionState.None,this.privUri=v,this.privHeaders=b,this.privEnableCompression=w,this.privHeaders[u.HeaderNames.ConnectionId]=this.privConnectionId,this.privHeaders.connectionId=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===h.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new h.Deferred,this.privCertificateValidatedDeferral=new h.Deferred,this.privConnectionState=h.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!zT.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{let y=new URL(this.privUri).protocol;(y==null?void 0:y.toLocaleLowerCase())==="wss:"?y="https:":(y==null?void 0:y.toLocaleLowerCase())==="ws:"&&(y="http:");const A={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression,followRedirects:y.toLocaleLowerCase()==="https:"};this.privCertificateValidatedDeferral.resolve(),A.agent=this.getAgent(),A.agent.protocol=y,this.privWebsocketClient=new l.default(this.privUri,A),this.privWebsocketClient.on("redirect",x=>{const b=new h.ConnectionRedirectEvent(this.privConnectionId,x,this.privUri,`Getting redirect URL from endpoint ${this.privUri} with redirect URL '${x}'`);h.Events.instance.onEvent(b)})}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new h.Queue,this.privDisconnectDeferral=new h.Deferred,this.privSendMessageQueue=new h.Queue,this.processSendQueue().catch(v=>{h.Events.instance.onEvent(new h.BackgroundEvent(v))})}catch(v){return this.privConnectionEstablishDeferral.resolve(new h.ConnectionOpenResponse(500,v)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new h.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=h.ConnectionState.Connected,this.onEvent(new h.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new h.ConnectionOpenResponse(200,""))},v=>{this.privConnectionEstablishDeferral.reject(v)})},this.privWebsocketClient.onerror=v=>{this.onEvent(new h.ConnectionErrorEvent(this.privConnectionId,v.message,v.type)),this.privLastErrorReceived=v.message},this.privWebsocketClient.onclose=v=>{this.privConnectionState===h.ConnectionState.Connecting?(this.privConnectionState=h.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new h.ConnectionOpenResponse(v.code,v.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=h.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new h.ConnectionClosedEvent(this.privConnectionId,v.code,v.reason))),this.onClose(v.code,v.reason).catch(y=>{h.Events.instance.onEvent(new h.BackgroundEvent(y))})},this.privWebsocketClient.onmessage=v=>{const y=new Date().toISOString();if(this.privConnectionState===h.ConnectionState.Connected){const A=new h.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(A.promise),v.data instanceof ArrayBuffer){const x=new h.RawWebsocketMessage(h.MessageType.Binary,v.data);this.privMessageFormatter.toConnectionMessage(x).then(b=>{this.onEvent(new h.ConnectionMessageReceivedEvent(this.privConnectionId,y,b)),A.resolve(b)},b=>{A.reject(`Invalid binary message format. Error: ${b}`)})}else{const x=new h.RawWebsocketMessage(h.MessageType.Text,v.data);this.privMessageFormatter.toConnectionMessage(x).then(b=>{this.onEvent(new h.ConnectionMessageReceivedEvent(this.privConnectionId,y,b)),A.resolve(b)},b=>{A.reject(`Invalid text message format. Error: ${b}`)})}}},this.privConnectionEstablishDeferral.promise}send(v){if(this.privConnectionState!==h.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${h.ConnectionState[this.privConnectionState]} state`);const y=new h.Deferred,A=new h.Deferred;return this.privSendMessageQueue.enqueueFromPromise(A.promise),this.privMessageFormatter.fromConnectionMessage(v).then(x=>{A.resolve({Message:v,RawWebsocketMessage:x,sendStatusDeferral:y})},x=>{A.reject(`Error formatting the message. ${x}`)}),y.promise}read(){return this.privConnectionState!==h.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(v){if(this.privWebsocketClient)this.privConnectionState!==h.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,v||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(v){try{if(!v)return Promise.resolve();if(this.onEvent(new h.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),v.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(v.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+v.Message.id+" "+new Error().stack);return Promise.resolve()}catch(y){return Promise.reject(`websocket send error: ${y}`)}}async onClose(v,y){const A=`Connection closed. ${v}: ${y}`;this.privConnectionState=h.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},A),await this.privSendMessageQueue.drainAndDispose(x=>{x.sendStatusDeferral.reject(A)},A)}async processSendQueue(){for(;;){const y=await this.privSendMessageQueue.dequeue();if(!y)return;try{await this.sendRawMessage(y),y.sendStatusDeferral.resolve()}catch(A){y.sendStatusDeferral.reject(A)}}}onEvent(v){this.privConnectionEvents.onEvent(v),h.Events.instance.onEvent(v)}getAgent(){const v=new o.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(v.proxyInfo=this.proxyInfo),v}static GetProxyAgent(v){const y={host:v.HostName,port:v.Port};return v.UserName?y.headers={"Proxy-Authentication":"Basic "+Buffer.from(`${v.UserName}:${v.Password===void 0?"":v.Password}`).toString("base64")}:y.headers={},y.headers.requestOCSP="true",new a.default(y)}createConnection(v,y){let A;if(y={...y,requestOCSP:!0,servername:y.host},this.proxyInfo){const b=zT.GetProxyAgent(this.proxyInfo);A=new Promise((w,T)=>{b.callback(v,y,(k,I)=>{k?T(k):w(I)})})}else y.secureEndpoint?A=Promise.resolve(s.connect(y)):A=Promise.resolve(i.connect(y));return A}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};return _n.WebsocketMessageAdapter=m,m.forceNpmWebSocket=!1,_n}var ak;function v5(){if(ak)return Cf;ak=1,Object.defineProperty(Cf,"__esModule",{value:!0}),Cf.WebsocketConnection=void 0;const r=We(),e=y_();let t=class{constructor(i,s,o,a,l,u=!1,h){if(this.privIsDisposed=!1,!i)throw new r.ArgumentNullError("uri");if(!a)throw new r.ArgumentNullError("messageFormatter");this.privMessageFormatter=a;let m="",g=0;if(s){for(const v in s)if(v){m+=g===0&&i.indexOf("?")===-1?"?":"&";const y=encodeURIComponent(v);m+=y;let A=s[v];A&&(A=encodeURIComponent(A),m+=`=${A}`),g++}}if(o){for(const v in o)if(v){m+=g===0&&i.indexOf("?")===-1?"?":"&";const y=encodeURIComponent(o[v]);m+=`${v}=${y}`,g++}}this.privUri=i+m,this.privId=h||(0,r.createNoDashGuid)(),this.privConnectionMessageAdapter=new e.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,l,o,u)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(i){return this.privConnectionMessageAdapter.send(i)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};return Cf.WebsocketConnection=t,Cf}var Af={},lk;function S5(){if(lk)return Af;lk=1,Object.defineProperty(Af,"__esModule",{value:!0}),Af.ReplayableAudioNode=void 0;let r=class{constructor(n,i){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=n,this.privBytesPerSecond=i}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){const n=this.privReplayOffset-this.privBufferStartOffset;let i=Math.round(n*this.privBytesPerSecond*1e-7);i%2!==0&&i++;let s=0;for(;s<this.privBuffers.length&&i>=this.privBuffers[s].chunk.buffer.byteLength;)i-=this.privBuffers[s++].chunk.buffer.byteLength;if(s<this.privBuffers.length){const o=this.privBuffers[s].chunk.buffer.slice(i);return this.privReplayOffset+=o.byteLength/this.privBytesPerSecond*1e7,s===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:o,isEnd:!1,timeReceived:this.privBuffers[s].chunk.timeReceived})}}return this.privAudioNode.read().then(n=>(n&&n.buffer&&this.privBuffers&&(this.privBuffers.push(new e(n,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=n.buffer.byteLength),n))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(n){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=n;const i=n-this.privBufferStartOffset;let s=Math.round(i*this.privBytesPerSecond*1e-7),o=0;for(;o<this.privBuffers.length&&s>=this.privBuffers[o].chunk.buffer.byteLength;)s-=this.privBuffers[o++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(n-s/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(o)}findTimeAtOffset(n){if(n<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const i of this.privBuffers){const s=i.byteOffset/this.privBytesPerSecond*1e7,o=s+i.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(n>=s&&n<=o)return i.chunk.timeReceived}return 0}};Af.ReplayableAudioNode=r;class e{constructor(n,i,s){this.chunk=n,this.serial=i,this.byteOffset=s}}return Af}var bf={},Mx={},ro={},Fi={},ck;function C_(){if(ck)return Fi;ck=1;var r=Fi&&Fi.__createBinding||(Object.create?(function(o,a,l,u){u===void 0&&(u=l),Object.defineProperty(o,u,{enumerable:!0,get:function(){return a[l]}})}):(function(o,a,l,u){u===void 0&&(u=l),o[u]=a[l]})),e=Fi&&Fi.__setModuleDefault||(Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a}),t=Fi&&Fi.__importStar||function(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var l in o)l!=="default"&&Object.prototype.hasOwnProperty.call(o,l)&&r(a,o,l);return e(a,o),a};Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.AudioFileWriter=void 0;const n=t(uc),i=rt();let s=class{constructor(a){i.Contracts.throwIfNullOrUndefined(n.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=n.openSync(a,"w")}set format(a){i.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=a;let l=0;this.privAudioFormat.hasHeader&&(l=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=n.createWriteStream("",{fd:this.privFd,start:l,autoClose:!1}))}write(a){i.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(a.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),n.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),n.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};return Fi.AudioFileWriter=s,Fi}var On={},uk;function A_(){if(uk)return On;uk=1,Object.defineProperty(On,"__esModule",{value:!0}),On.PullAudioInputStreamImpl=On.PullAudioInputStream=On.PushAudioInputStreamImpl=On.PushAudioInputStream=On.AudioInputStream=void 0;const r=Oe(),e=We(),t=Nu(),n=xe(),i=Lu();let s=class{constructor(){}static createPushStream(m){return o.create(m)}static createPullStream(m,g){return l.create(m,g)}};On.AudioInputStream=s;class o extends s{static create(m){return new a(m)}}On.PushAudioInputStream=o;class a extends o{constructor(m){super(),m===void 0?this.privFormat=i.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=m,this.privEvents=new e.EventSource,this.privId=(0,t.createNoDashGuid)(),this.privStream=new e.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(m){this.privStream.writeStreamChunk({buffer:m,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}async attach(m){this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,m)),await this.turnOn();const g=this.privStream;return this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,m)),{detach:async()=>(this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,m)),this.turnOff()),id:()=>m,read:()=>g.read()}}detach(m){this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,m))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:r.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:r.type.Stream})}onEvent(m){this.privEvents.onEvent(m),e.Events.instance.onEvent(m)}toBuffer(m){const g=Buffer.alloc(m.byteLength),v=new Uint8Array(m);for(let y=0;y<g.length;++y)g[y]=v[y];return g}}On.PushAudioInputStreamImpl=a;class l extends s{constructor(){super()}static create(m,g){return new u(m,g)}}On.PullAudioInputStream=l;class u extends l{constructor(m,g){super(),g===void 0?this.privFormat=n.AudioStreamFormat.getDefaultInputFormat():this.privFormat=g,this.privEvents=new e.EventSource,this.privId=(0,t.createNoDashGuid)(),this.privCallback=m,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}async attach(m){return this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,m)),await this.turnOn(),this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,m)),{detach:()=>(this.privCallback.close(),this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,m)),this.turnOff()),id:()=>m,read:()=>{let g=0,v;for(;g<this.privBufferSize;){const y=new ArrayBuffer(this.privBufferSize-g),A=this.privCallback.read(y);if(v===void 0?v=y:new Int8Array(v).set(new Int8Array(y),g),A===0)break;g+=A}return Promise.resolve({buffer:v.slice(0,g),isEnd:this.privIsClosed||g===0,timeReceived:Date.now()})}}}detach(m){this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,m))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:r.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:r.type.Stream})}onEvent(m){this.privEvents.onEvent(m),e.Events.instance.onEvent(m)}}return On.PullAudioInputStreamImpl=u,On}var Dn={},xf={},Nx={},dk;function b_(){return dk||(dk=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SpeechSynthesisOutputFormat=void 0,(function(e){e[e.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",e[e.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",e[e.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",e[e.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",e[e.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",e[e.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",e[e.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",e[e.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",e[e.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",e[e.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",e[e.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",e[e.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",e[e.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",e[e.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",e[e.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",e[e.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",e[e.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",e[e.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",e[e.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",e[e.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",e[e.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",e[e.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",e[e.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",e[e.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",e[e.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",e[e.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",e[e.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",e[e.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",e[e.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",e[e.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",e[e.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",e[e.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",e[e.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",e[e.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",e[e.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",e[e.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",e[e.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",e[e.AmrWb16000Hz=37]="AmrWb16000Hz",e[e.G72216Khz64Kbps=38]="G72216Khz64Kbps"})(r.SpeechSynthesisOutputFormat||(r.SpeechSynthesisOutputFormat={}))})(Nx)),Nx}var hk;function sy(){if(hk)return xf;hk=1,Object.defineProperty(xf,"__esModule",{value:!0}),xf.AudioOutputFormatImpl=void 0;const r=b_(),e=Lu();class t extends e.AudioStreamFormatImpl{constructor(i,s,o,a,l,u,h,m,g){super(o,u,s,i),this.formatTag=i,this.avgBytesPerSec=a,this.blockAlign=l,this.priAudioFormatString=h,this.priRequestAudioFormatString=m,this.priHasHeader=g}static fromSpeechSynthesisOutputFormat(i){return i===void 0?t.getDefaultOutputFormat():t.fromSpeechSynthesisOutputFormatString(t.SpeechSynthesisOutputFormatToString[i])}static fromSpeechSynthesisOutputFormatString(i){switch(i){case"raw-8khz-8bit-mono-mulaw":return new t(e.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,i,i,!1);case"riff-16khz-16kbps-mono-siren":return new t(e.AudioFormatTag.Siren,1,16e3,2e3,40,0,i,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new t(e.AudioFormatTag.Siren,1,16e3,2e3,40,0,i,i,!1);case"audio-16khz-32kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,16e3,4096,2,16,i,i,!1);case"audio-16khz-128kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,16e3,16384,2,16,i,i,!1);case"audio-16khz-64kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,16e3,8192,2,16,i,i,!1);case"audio-24khz-48kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,24e3,6144,2,16,i,i,!1);case"audio-24khz-96kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,24e3,12288,2,16,i,i,!1);case"audio-24khz-160kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,24e3,20480,2,16,i,i,!1);case"raw-16khz-16bit-mono-truesilk":return new t(e.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,i,i,!1);case"riff-8khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,8e3,16e3,2,16,i,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,24e3,48e3,2,16,i,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new t(e.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,i,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,16e3,32e3,2,16,i,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,24e3,48e3,2,16,i,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,8e3,16e3,2,16,i,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new t(e.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,i,i,!1);case"ogg-24khz-16bit-mono-opus":return new t(e.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,i,i,!1);case"raw-48khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,48e3,96e3,2,16,i,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,48e3,96e3,2,16,i,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,48e3,12288,2,16,i,i,!1);case"audio-48khz-192kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,48e3,24576,2,16,i,i,!1);case"ogg-48khz-16bit-mono-opus":return new t(e.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,i,i,!1);case"webm-16khz-16bit-mono-opus":return new t(e.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,i,i,!1);case"webm-24khz-16bit-mono-opus":return new t(e.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,i,i,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new t(e.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,i,i,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new t(e.AudioFormatTag.OPUS,1,16e3,4e3,2,16,i,i,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new t(e.AudioFormatTag.OPUS,1,24e3,6e3,2,16,i,i,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new t(e.AudioFormatTag.OPUS,1,24e3,3e3,2,16,i,i,!1);case"audio-24khz-16bit-mono-flac":return new t(e.AudioFormatTag.FLAC,1,24e3,24e3,2,16,i,i,!1);case"audio-48khz-16bit-mono-flac":return new t(e.AudioFormatTag.FLAC,1,48e3,3e4,2,16,i,i,!1);case"raw-24khz-16bit-mono-truesilk":return new t(e.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,i,i,!1);case"raw-8khz-8bit-mono-alaw":return new t(e.AudioFormatTag.ALaw,1,8e3,8e3,1,8,i,i,!1);case"riff-8khz-8bit-mono-alaw":return new t(e.AudioFormatTag.ALaw,1,8e3,8e3,1,8,i,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,22050,44100,2,16,i,i,!1);case"riff-22050hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,22050,44100,2,16,i,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,44100,88200,2,16,i,i,!1);case"riff-44100hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,44100,88200,2,16,i,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new t(e.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,i,i,!1);case"g722-16khz-64kbps":return new t(e.AudioFormatTag.G722,1,16e3,8e3,2,16,i,i,!1);case"riff-16khz-16bit-mono-pcm":default:return new t(e.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return t.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(i){if(this.priHasHeader){const s=new DataView(this.privHeader);s.setUint32(4,i+this.privHeader.byteLength-8,!0),s.setUint32(40,i,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(i){if(!this.hasHeader)return i;this.updateHeader(i.byteLength);const s=new Uint8Array(i.byteLength+this.header.byteLength);return s.set(new Uint8Array(this.header),0),s.set(new Uint8Array(i),this.header.byteLength),s.buffer}}return xf.AudioOutputFormatImpl=t,t.SpeechSynthesisOutputFormatToString={[r.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[r.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[r.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[r.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[r.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[r.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[r.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[r.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[r.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[r.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[r.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[r.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[r.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[r.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[r.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[r.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[r.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[r.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[r.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"},xf}var pk;function Xh(){if(pk)return Dn;pk=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.PushAudioOutputStreamImpl=Dn.PushAudioOutputStream=Dn.PullAudioOutputStreamImpl=Dn.PullAudioOutputStream=Dn.AudioOutputStream=void 0;const r=We(),e=rt(),t=sy();let n=class{constructor(){}static createPullStream(){return i.create()}};Dn.AudioOutputStream=n;class i extends n{static create(){return new s}}Dn.PullAudioOutputStream=i;class s extends i{constructor(){super(),this.privId=(0,r.createNoDashGuid)(),this.privStream=new r.Stream}set format(u){u==null&&(this.privFormat=t.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=u}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(u){const h=new Int8Array(u);let m=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>u.byteLength)return h.set(this.privLastChunkView.slice(0,u.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(u.byteLength),Promise.resolve(u.byteLength);h.set(this.privLastChunkView),m=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;m<u.byteLength&&!this.privStream.isReadEnded;){const g=await this.privStream.read();if(g!==void 0&&!g.isEnd){let v;g.buffer.byteLength>u.byteLength-m?(v=g.buffer.slice(0,u.byteLength-m),this.privLastChunkView=new Int8Array(g.buffer.slice(u.byteLength-m))):v=g.buffer,h.set(new Int8Array(v),m),m+=v.byteLength}else this.privStream.readEnded()}return m}write(u){e.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:u,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}Dn.PullAudioOutputStreamImpl=s;class o extends n{constructor(){super()}static create(u){return new a(u)}}Dn.PushAudioOutputStream=o;class a extends o{constructor(u){super(),this.privId=(0,r.createNoDashGuid)(),this.privCallback=u}set format(u){}write(u){this.privCallback.write&&this.privCallback.write(u)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}return Dn.PushAudioOutputStreamImpl=a,Dn}var fk;function y5(){if(fk)return ro;fk=1,Object.defineProperty(ro,"__esModule",{value:!0}),ro.AudioOutputConfigImpl=ro.AudioConfigImpl=ro.AudioConfig=void 0;const r=In(),e=rt(),t=xe(),n=C_(),i=A_(),s=Xh();let o=class x_{static fromDefaultMicrophoneInput(){const h=new r.PcmRecorder(!0);return new a(new r.MicAudioSource(h))}static fromMicrophoneInput(h){const m=new r.PcmRecorder(!0);return new a(new r.MicAudioSource(m,h))}static fromWavFileInput(h,m="unnamedBuffer.wav"){return new a(new r.FileAudioSource(h,m))}static fromStreamInput(h){if(h instanceof t.PullAudioInputStreamCallback)return new a(new i.PullAudioInputStreamImpl(h));if(h instanceof t.AudioInputStream)return new a(h);if(typeof MediaStream<"u"&&h instanceof MediaStream){const m=new r.PcmRecorder(!1);return new a(new r.MicAudioSource(m,null,null,h))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new l(new t.SpeakerAudioDestination)}static fromSpeakerOutput(h){if(h===void 0)return x_.fromDefaultSpeakerOutput();if(h instanceof t.SpeakerAudioDestination)return new l(h);throw new Error("Not Supported Type")}static fromAudioFileOutput(h){return new l(new n.AudioFileWriter(h))}static fromStreamOutput(h){if(h instanceof t.PushAudioOutputStreamCallback)return new l(new s.PushAudioOutputStreamImpl(h));if(h instanceof t.PushAudioOutputStream)return new l(h);if(h instanceof t.PullAudioOutputStream)return new l(h);throw new Error("Not Supported Type")}};ro.AudioConfig=o;class a extends o{constructor(h){super(),this.privSource=h}get format(){return this.privSource.format}close(h,m){this.privSource.turnOff().then(()=>{h&&h()},g=>{m&&m(g)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(h){return this.privSource.attach(h)}detach(h){return this.privSource.detach(h)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(h,m){if(e.Contracts.throwIfNull(m,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(h,m);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(h,m){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(h,m);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}ro.AudioConfigImpl=a;class l extends o{constructor(h){super(),this.privDestination=h}set format(h){this.privDestination.format=h}write(h){this.privDestination.write(h)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}return ro.AudioOutputConfigImpl=l,ro}var Lx={},mk;function C5(){return mk||(mk=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.CancellationReason=void 0,(function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"})(r.CancellationReason||(r.CancellationReason={}))})(Lx)),Lx}var Tf={},gk;function A5(){if(gk)return Tf;gk=1,Object.defineProperty(Tf,"__esModule",{value:!0}),Tf.PullAudioInputStreamCallback=void 0;let r=class{};return Tf.PullAudioInputStreamCallback=r,Tf}var wf={},vk;function b5(){if(vk)return wf;vk=1,Object.defineProperty(wf,"__esModule",{value:!0}),wf.PushAudioOutputStreamCallback=void 0;let r=class{};return wf.PushAudioOutputStreamCallback=r,wf}var Pf={},Sk;function x5(){if(Sk)return Pf;Sk=1,Object.defineProperty(Pf,"__esModule",{value:!0}),Pf.KeywordRecognitionModel=void 0;const r=rt();let e=class{constructor(){this.privDisposed=!1}static fromFile(n){throw r.Contracts.throwIfFileDoesNotExist(n,"fileName"),new Error("Not yet implemented.")}static fromStream(n){throw r.Contracts.throwIfNull(n,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};return Pf.KeywordRecognitionModel=e,Pf}var Ef={},yk;function T5(){if(yk)return Ef;yk=1,Object.defineProperty(Ef,"__esModule",{value:!0}),Ef.SessionEventArgs=void 0;let r=class{constructor(t){this.privSessionId=t}get sessionId(){return this.privSessionId}};return Ef.SessionEventArgs=r,Ef}var Rf={},Ck;function w5(){if(Ck)return Rf;Ck=1,Object.defineProperty(Rf,"__esModule",{value:!0}),Rf.RecognitionEventArgs=void 0;const r=xe();let e=class extends r.SessionEventArgs{constructor(n,i){super(i),this.privOffset=n}get offset(){return this.privOffset}};return Rf.RecognitionEventArgs=e,Rf}var _x={},Ak;function P5(){return Ak||(Ak=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.OutputFormat=void 0,(function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"})(r.OutputFormat||(r.OutputFormat={}))})(_x)),_x}var If={},bk;function E5(){if(bk)return If;bk=1,Object.defineProperty(If,"__esModule",{value:!0}),If.RecognitionResult=void 0;let r=class{constructor(t,n,i,s,o,a,l,u,h,m){this.privResultId=t,this.privReason=n,this.privText=i,this.privDuration=s,this.privOffset=o,this.privLanguage=a,this.privLanguageDetectionConfidence=l,this.privErrorDetails=u,this.privJson=h,this.privProperties=m}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};return If.RecognitionResult=r,If}var kf={},xk;function R5(){if(xk)return kf;xk=1,Object.defineProperty(kf,"__esModule",{value:!0}),kf.SpeechRecognitionResult=void 0;const r=xe();let e=class extends r.RecognitionResult{constructor(n,i,s,o,a,l,u,h,m,g,v){super(n,i,s,o,a,l,u,m,g,v),this.privSpeakerId=h}get speakerId(){return this.privSpeakerId}};return kf.SpeechRecognitionResult=e,kf}var no={},Tk;function I5(){if(Tk)return no;Tk=1,Object.defineProperty(no,"__esModule",{value:!0}),no.MeetingTranscriptionEventArgs=no.ConversationTranscriptionEventArgs=no.SpeechRecognitionEventArgs=void 0;const r=xe();let e=class extends r.RecognitionEventArgs{constructor(s,o,a){super(o,a),this.privResult=s}get result(){return this.privResult}};no.SpeechRecognitionEventArgs=e;class t extends r.RecognitionEventArgs{constructor(s,o,a){super(o,a),this.privResult=s}get result(){return this.privResult}}no.ConversationTranscriptionEventArgs=t;class n extends e{}return no.MeetingTranscriptionEventArgs=n,no}var Mf={},Nf={},wk;function oy(){if(wk)return Nf;wk=1,Object.defineProperty(Nf,"__esModule",{value:!0}),Nf.CancellationEventArgsBase=void 0;const r=xe();let e=class extends r.RecognitionEventArgs{constructor(n,i,s,o,a){super(o,a),this.privReason=n,this.privErrorDetails=i,this.privErrorCode=s}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return Nf.CancellationEventArgsBase=e,Nf}var Pk;function k5(){if(Pk)return Mf;Pk=1,Object.defineProperty(Mf,"__esModule",{value:!0}),Mf.SpeechRecognitionCanceledEventArgs=void 0;const r=oy();let e=class extends r.CancellationEventArgsBase{};return Mf.SpeechRecognitionCanceledEventArgs=e,Mf}var Lf={},Ek;function M5(){if(Ek)return Lf;Ek=1,Object.defineProperty(Lf,"__esModule",{value:!0}),Lf.TranslationRecognitionEventArgs=void 0;const r=xe();let e=class extends r.RecognitionEventArgs{constructor(n,i,s){super(i,s),this.privResult=n}get result(){return this.privResult}};return Lf.TranslationRecognitionEventArgs=e,Lf}var _f={},Rk;function N5(){if(Rk)return _f;Rk=1,Object.defineProperty(_f,"__esModule",{value:!0}),_f.TranslationSynthesisEventArgs=void 0;const r=xe();let e=class extends r.SessionEventArgs{constructor(n,i){super(i),this.privResult=n}get result(){return this.privResult}};return _f.TranslationSynthesisEventArgs=e,_f}var Of={},Ik;function w_(){if(Ik)return Of;Ik=1,Object.defineProperty(Of,"__esModule",{value:!0}),Of.TranslationRecognitionResult=void 0;const r=xe();let e=class T_ extends r.SpeechRecognitionResult{constructor(n,i,s,o,a,l,u,h,m,g,v){super(i,s,o,a,l,u,h,void 0,m,g,v),this.privTranslations=n}static fromSpeechRecognitionResult(n){return new T_(void 0,n.resultId,n.reason,n.text,n.duration,n.offset,n.language,n.languageDetectionConfidence,n.errorDetails,n.json,n.properties)}get translations(){return this.privTranslations}};return Of.TranslationRecognitionResult=e,Of}var Df={},kk;function L5(){if(kk)return Df;kk=1,Object.defineProperty(Df,"__esModule",{value:!0}),Df.TranslationSynthesisResult=void 0;let r=class{constructor(t,n){this.privReason=t,this.privAudio=n}get audio(){return this.privAudio}get reason(){return this.privReason}};return Df.TranslationSynthesisResult=r,Df}var Ox={},Mk;function _5(){return Mk||(Mk=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ResultReason=void 0,(function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizedKeyword=4]="RecognizedKeyword",e[e.TranslatingSpeech=5]="TranslatingSpeech",e[e.TranslatedSpeech=6]="TranslatedSpeech",e[e.SynthesizingAudio=7]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=8]="SynthesizingAudioCompleted",e[e.SynthesizingAudioStarted=9]="SynthesizingAudioStarted",e[e.VoicesListRetrieved=10]="VoicesListRetrieved",e[e.TranslatingParticipantSpeech=11]="TranslatingParticipantSpeech",e[e.TranslatedParticipantSpeech=12]="TranslatedParticipantSpeech",e[e.TranslatedInstantMessage=13]="TranslatedInstantMessage",e[e.TranslatedParticipantInstantMessage=14]="TranslatedParticipantInstantMessage"})(r.ResultReason||(r.ResultReason={}))})(Ox)),Ox}var Gl={},Nk;function O5(){if(Nk)return Gl;Nk=1,Object.defineProperty(Gl,"__esModule",{value:!0}),Gl.SpeechConfigImpl=Gl.SpeechConfig=void 0;const r=Oe(),e=rt(),t=xe();let n=class{constructor(){}static fromSubscription(o,a){e.Contracts.throwIfNullOrWhitespace(o,"subscriptionKey"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),l}static fromEndpoint(o,a){e.Contracts.throwIfNull(o,"endpoint");const l=typeof a=="string"&&a.trim().length>0,u=typeof a=="object"&&a!==null&&typeof a.getToken=="function",h=typeof a=="object"&&a!==null&&typeof a.key=="string";if(a!==void 0&&!l&&!u&&!h)throw new Error("Invalid 'auth' parameter: expected a non-empty API key string, a TokenCredential, or a KeyCredential.");let m;return typeof a=="string"?(m=new i,m.setProperty(t.PropertyId.SpeechServiceConnection_Key,a)):typeof a=="object"&&typeof a.getToken=="function"?m=new i(a):typeof a=="object"&&typeof a.key=="string"?(m=new i,m.setProperty(t.PropertyId.SpeechServiceConnection_Key,a.key)):m=new i,m.setProperty(t.PropertyId.SpeechServiceConnection_Endpoint,o.href),m}static fromHost(o,a){e.Contracts.throwIfNull(o,"hostName");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Host,o.protocol+"//"+o.hostname+(o.port===""?"":":"+o.port)),l.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),a!==void 0&&l.setProperty(t.PropertyId.SpeechServiceConnection_Key,a),l}static fromAuthorizationToken(o,a){e.Contracts.throwIfNull(o,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l.authorizationToken=o,l}close(){}};Gl.SpeechConfig=n;class i extends n{constructor(o){super(),this.privProperties=new t.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=t.OutputFormat.Simple,this.privTokenCredential=o}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o)}get speechRecognitionLanguage(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,o)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,o)}get outputFormat(){return t.OutputFormat[this.privProperties.getProperty(r.OutputFormatPropertyName,void 0)]}set outputFormat(o){this.privProperties.setProperty(r.OutputFormatPropertyName,t.OutputFormat[o])}get endpointId(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_EndpointId,o)}get tokenCredential(){return this.privTokenCredential}setProperty(o,a){e.Contracts.throwIfNull(a,"value"),this.privProperties.setProperty(o,a)}getProperty(o,a){return this.privProperties.getProperty(o,a)}setProxy(o,a,l,u){this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyHostName],o),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPort],a),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyUserName],l),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPassword],u)}setServiceProperty(o,a){const l=JSON.parse(this.privProperties.getProperty(r.ServicePropertiesPropertyName,"{}"));l[o]=a,this.privProperties.setProperty(r.ServicePropertiesPropertyName,JSON.stringify(l))}setProfanity(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceResponse_ProfanityOption,t.ProfanityOption[o])}enableAudioLogging(){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true"),this.privProperties.setProperty(r.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Detailed])}enableDictation(){this.privProperties.setProperty(r.ForceDictationPropertyName,"true")}clone(){const o=new i(this.tokenCredential);return o.privProperties=this.privProperties.clone(),o}get speechSynthesisLanguage(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage,o)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthVoice,o)}get speechSynthesisOutputFormat(){return t.SpeechSynthesisOutputFormat[this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,t.SpeechSynthesisOutputFormat[o])}}return Gl.SpeechConfigImpl=i,Gl}var Kl={},Lk;function D5(){if(Lk)return Kl;Lk=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.SpeechTranslationConfigImpl=Kl.SpeechTranslationConfig=void 0;const r=Oe(),e=rt(),t=xe();let n=class extends t.SpeechConfig{constructor(){super()}static fromSubscription(o,a){e.Contracts.throwIfNullOrWhitespace(o,"subscriptionKey"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.properties.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),l.properties.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}static fromAuthorizationToken(o,a){e.Contracts.throwIfNullOrWhitespace(o,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.properties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o),l.properties.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}static fromHost(o,a){e.Contracts.throwIfNull(o,"hostName");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Host,o.protocol+"//"+o.hostname+(o.port===""?"":":"+o.port)),a!==void 0&&l.setProperty(t.PropertyId.SpeechServiceConnection_Key,a),l}static fromEndpoint(o,a){e.Contracts.throwIfNull(o,"endpoint");const l=typeof a=="string"&&a.trim().length>0,u=typeof a=="object"&&a!==null&&typeof a.getToken=="function",h=typeof a=="object"&&a!==null&&typeof a.key=="string";if(a!==void 0&&!l&&!u&&!h)throw new Error("Invalid 'auth' parameter: expected a non-empty API key string, a TokenCredential, or a KeyCredential.");let m;return typeof a=="string"?(m=new i,m.setProperty(t.PropertyId.SpeechServiceConnection_Key,a)):typeof a=="object"&&typeof a.getToken=="function"?m=new i(a):typeof a=="object"&&typeof a.key=="string"?(m=new i,m.setProperty(t.PropertyId.SpeechServiceConnection_Key,a.key)):m=new i,m.setProperty(t.PropertyId.SpeechServiceConnection_Endpoint,o.href),m}};Kl.SpeechTranslationConfig=n;class i extends n{constructor(o){super(),this.privSpeechProperties=new t.PropertyCollection,this.outputFormat=t.OutputFormat.Simple,this.privTokenCredential=o}set authorizationToken(o){e.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o)}set speechRecognitionLanguage(o){e.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,o)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return t.OutputFormat[this.privSpeechProperties.getProperty(r.OutputFormatPropertyName,void 0)]}set outputFormat(o){this.privSpeechProperties.setProperty(r.OutputFormatPropertyName,t.OutputFormat[o])}get endpointId(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_EndpointId,o)}addTargetLanguage(o){e.Contracts.throwIfNullOrWhitespace(o,"value");const a=this.targetLanguages;a.includes(o)||(a.push(o),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,a.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(o){e.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,o)}get region(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_Region)}get tokenCredential(){return this.privTokenCredential}setProxy(o,a,l,u){this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyHostName],o),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPort],a),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyUserName],l),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPassword],u)}getProperty(o,a){return this.privSpeechProperties.getProperty(o,a)}setProperty(o,a){this.privSpeechProperties.setProperty(o,a)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(o,a){const l=JSON.parse(this.privSpeechProperties.getProperty(r.ServicePropertiesPropertyName,"{}"));l[o]=a,this.privSpeechProperties.setProperty(r.ServicePropertiesPropertyName,JSON.stringify(l))}setProfanity(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceResponse_ProfanityOption,t.ProfanityOption[o])}enableAudioLogging(){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(r.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage,o)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthVoice,o)}get speechSynthesisOutputFormat(){return t.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,t.SpeechSynthesisOutputFormat[o])}}return Kl.SpeechTranslationConfigImpl=i,Kl}var jf={},_k;function E_(){if(_k)return jf;_k=1,Object.defineProperty(jf,"__esModule",{value:!0}),jf.PropertyCollection=void 0;const r=xe();let e=class P_{constructor(){this.privKeys=[],this.privValues=[]}getProperty(n,i){let s;typeof n=="string"?s=n:s=r.PropertyId[n];for(let o=0;o<this.privKeys.length;o++)if(this.privKeys[o]===s)return this.privValues[o];if(i!==void 0)return String(i)}setProperty(n,i){let s;typeof n=="string"?s=n:s=r.PropertyId[n];for(let o=0;o<this.privKeys.length;o++)if(this.privKeys[o]===s){this.privValues[o]=i;return}this.privKeys.push(s),this.privValues.push(i)}clone(){const n=new P_;for(let i=0;i<this.privKeys.length;i++)n.privKeys.push(this.privKeys[i]),n.privValues.push(this.privValues[i]);return n}mergeTo(n){this.privKeys.forEach(i=>{if(n.getProperty(i,void 0)===void 0){const s=this.getProperty(i);n.setProperty(i,s)}})}get keys(){return this.privKeys}};return jf.PropertyCollection=e,jf}var Dx={},Ok;function IP(){return Ok||(Ok=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.PropertyId=void 0,(function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_TranslationCategoryId=9]="SpeechServiceConnection_TranslationCategoryId",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",e[e.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",e[e.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",e[e.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=25]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",e[e.SpeechServiceConnection_Url=28]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=29]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=30]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.Speech_SegmentationSilenceTimeoutMs=31]="Speech_SegmentationSilenceTimeoutMs",e[e.Speech_SegmentationMaximumTimeMs=32]="Speech_SegmentationMaximumTimeMs",e[e.Speech_SegmentationStrategy=33]="Speech_SegmentationStrategy",e[e.Speech_StartEventSensitivity=34]="Speech_StartEventSensitivity",e[e.SpeechServiceConnection_EnableAudioLogging=35]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceConnection_LanguageIdMode=36]="SpeechServiceConnection_LanguageIdMode",e[e.SpeechServiceConnection_RecognitionEndpointVersion=37]="SpeechServiceConnection_RecognitionEndpointVersion",e[e.SpeechServiceResponse_ProfanityOption=38]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=39]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=40]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=41]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=42]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=43]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.SpeechServiceResponse_RequestWordBoundary=44]="SpeechServiceResponse_RequestWordBoundary",e[e.SpeechServiceResponse_RequestPunctuationBoundary=45]="SpeechServiceResponse_RequestPunctuationBoundary",e[e.SpeechServiceResponse_RequestSentenceBoundary=46]="SpeechServiceResponse_RequestSentenceBoundary",e[e.SpeechServiceResponse_DiarizeIntermediateResults=47]="SpeechServiceResponse_DiarizeIntermediateResults",e[e.Conversation_ApplicationId=48]="Conversation_ApplicationId",e[e.Conversation_DialogType=49]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=50]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=51]="Conversation_From_Id",e[e.Conversation_Conversation_Id=52]="Conversation_Conversation_Id",e[e.Conversation_Custom_Voice_Deployment_Ids=53]="Conversation_Custom_Voice_Deployment_Ids",e[e.Conversation_Speech_Activity_Template=54]="Conversation_Speech_Activity_Template",e[e.Conversation_Request_Bot_Status_Messages=55]="Conversation_Request_Bot_Status_Messages",e[e.Conversation_Agent_Connection_Id=56]="Conversation_Agent_Connection_Id",e[e.SpeechServiceConnection_Host=57]="SpeechServiceConnection_Host",e[e.ConversationTranslator_Host=58]="ConversationTranslator_Host",e[e.ConversationTranslator_Name=59]="ConversationTranslator_Name",e[e.ConversationTranslator_CorrelationId=60]="ConversationTranslator_CorrelationId",e[e.ConversationTranslator_Token=61]="ConversationTranslator_Token",e[e.PronunciationAssessment_ReferenceText=62]="PronunciationAssessment_ReferenceText",e[e.PronunciationAssessment_GradingSystem=63]="PronunciationAssessment_GradingSystem",e[e.PronunciationAssessment_Granularity=64]="PronunciationAssessment_Granularity",e[e.PronunciationAssessment_EnableMiscue=65]="PronunciationAssessment_EnableMiscue",e[e.PronunciationAssessment_Json=66]="PronunciationAssessment_Json",e[e.PronunciationAssessment_Params=67]="PronunciationAssessment_Params",e[e.WebWorkerLoadType=68]="WebWorkerLoadType",e[e.TalkingAvatarService_WebRTC_SDP=69]="TalkingAvatarService_WebRTC_SDP"})(r.PropertyId||(r.PropertyId={}))})(Dx)),Dx}var Bf={},Dk;function j5(){if(Dk)return Bf;Dk=1,Object.defineProperty(Bf,"__esModule",{value:!0}),Bf.Recognizer=void 0;const r=Oe(),e=We(),t=rt(),n=xe();let i=class R_{constructor(o,a,l,u){this.audioConfig=o!==void 0?o:n.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=a.clone(),this.privConnectionFactory=l,this.tokenCredential=u,this.implCommonRecognizerSetup()}close(o,a){t.Contracts.throwIfDisposed(this.privDisposed),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),o,a)}get internalData(){return this.privReco}async dispose(o){this.privDisposed||(this.privDisposed=!0,o&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return r.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(o){r.ServiceRecognizerBase.telemetryDataEnabled=o}implCommonRecognizerSetup(){let o=typeof window<"u"?"Browser":"Node",a="unknown",l="unknown";typeof navigator<"u"&&(o=o+"/"+navigator.platform,a=navigator.userAgent,l=navigator.appVersion);const u=this.createRecognizerConfig(new r.SpeechServiceConfig(new r.Context(new r.OS(o,a,l))));this.privReco=this.createServiceRecognizer(R_.getAuth(this.privProperties,this.tokenCredential),this.privConnectionFactory,this.audioConfig,u)}async recognizeOnceAsyncImpl(o){t.Contracts.throwIfDisposed(this.privDisposed);const a=new e.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(o,a.resolve,a.reject);const l=await a.promise;return await this.implRecognizerStop(),l}async startContinuousRecognitionAsyncImpl(o){t.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(o,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){t.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuth(o,a){const l=o.getProperty(n.PropertyId.SpeechServiceConnection_Key,void 0);return l&&l!==""?new r.CognitiveSubscriptionKeyAuthentication(l):a?new r.CognitiveTokenAuthentication(async()=>{try{const u=await a.getToken("https://cognitiveservices.azure.com/.default");return(u==null?void 0:u.token)??""}catch(u){throw u}},async()=>{try{const u=await a.getToken("https://cognitiveservices.azure.com/.default");return(u==null?void 0:u.token)??""}catch(u){throw u}}):new r.CognitiveTokenAuthentication(()=>{const u=o.getProperty(n.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(u)},()=>{const u=o.getProperty(n.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(u)})}};return Bf.Recognizer=i,Bf}var zf={},jx={},jk;function is(){return jk||(jk=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SpeechStartEventSensitivity=r.RecognitionMode=void 0,(function(e){e.Interactive="Interactive",e.Dictation="Dictation",e.Conversation="Conversation",e.None="None"})(r.RecognitionMode||(r.RecognitionMode={})),(function(e){e.Low="low",e.Medium="medium",e.High="high"})(r.SpeechStartEventSensitivity||(r.SpeechStartEventSensitivity={}))})(jx)),jx}var Bk;function B5(){if(Bk)return zf;Bk=1,Object.defineProperty(zf,"__esModule",{value:!0}),zf.SpeechRecognizer=void 0;const r=Oe(),e=is(),t=We(),n=rt(),i=xe();let s=class I_ extends i.Recognizer{constructor(a,l){const u=a;n.Contracts.throwIfNull(u,"speechConfig"),n.Contracts.throwIfNullOrWhitespace(u.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),super(l,u.properties,new r.SpeechConnectionFactory,a.tokenCredential),this.privDisposedRecognizer=!1}static FromConfig(a,l,u){const h=a;return l.properties.mergeTo(h.properties),new I_(a,u)}get endpointId(){return n.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){n.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,a)}get speechRecognitionLanguage(){return n.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return n.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple])===i.OutputFormat[i.OutputFormat.Simple]?i.OutputFormat.Simple:i.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(e.RecognitionMode.Interactive),a,l)}startContinuousRecognitionAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(this.properties.getProperty(r.ForceDictationPropertyName,void 0)===void 0?e.RecognitionMode.Conversation:e.RecognitionMode.Dictation),a,l)}stopContinuousRecognitionAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),a,l)}startKeywordRecognitionAsync(a,l,u){n.Contracts.throwIfNull(a,"model"),u&&u("Not yet implemented.")}stopKeywordRecognitionAsync(a){a&&a()}close(a,l){n.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),a,l)}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new r.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,l,u,h){const m=u;return new r.SpeechServiceRecognizer(a,l,m,h,this)}};return zf.SpeechRecognizer=s,zf}var Ff={},Wf={},Yl={},zk;function k_(){if(zk)return Yl;zk=1,Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.ConnectionMessageImpl=Yl.ConnectionMessage=void 0;const r=ai(),e=We(),t=E_(),n=IP();let i=class{};Yl.ConnectionMessage=i;class s{constructor(a){this.privConnectionMessage=a,this.privProperties=new t.PropertyCollection,this.privConnectionMessage.headers[r.HeaderNames.ConnectionId]&&this.privProperties.setProperty(n.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[r.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(l=>{this.privProperties.setProperty(l,this.privConnectionMessage.headers[l])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(a=>a.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===e.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===e.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}return Yl.ConnectionMessageImpl=s,Yl}var Fk;function M_(){if(Fk)return Wf;Fk=1,Object.defineProperty(Wf,"__esModule",{value:!0}),Wf.Connection=void 0;const r=Oe(),e=We(),t=k_(),n=rt(),i=xe();let s=class FT{static fromRecognizer(a){const l=a.internalData,u=new FT;return u.privInternalData=l,u.setupEvents(),u}static fromSynthesizer(a){const l=a.internalData,u=new FT;return u.privInternalData=l,u.setupEvents(),u}openConnection(a,l){(0,e.marshalPromiseToCallbacks)(this.privInternalData.connect(),a,l)}closeConnection(a,l){if(this.privInternalData instanceof r.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");(0,e.marshalPromiseToCallbacks)(this.privInternalData.disconnect(),a,l)}setMessageProperty(a,l,u){if(n.Contracts.throwIfNullOrWhitespace(l,"propertyName"),this.privInternalData instanceof r.ServiceRecognizerBase){if(a.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");{const h=this.privInternalData.speechContext.getContext();h[l]=u}}else if(this.privInternalData instanceof r.SynthesisAdapterBase){if(a.toLowerCase()!=="speech.config"&&a.toLowerCase()!=="synthesis.context")throw new Error("Only speech.config and synthesis.context message paths are currently supported for synthesizer");if(a.toLowerCase()==="speech.config"){if(l.toLowerCase()!=="context")throw new Error("Only context property is currently supported for speech.config message path for synthesizer");this.privInternalData.synthesizerConfig.setContextFromJson(u)}else this.privInternalData.synthesisContext.setSection(l,u)}}sendMessageAsync(a,l,u,h){(0,e.marshalPromiseToCallbacks)(this.privInternalData.sendNetworkMessage(a,l),u,h)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(a=>{a.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new i.ConnectionEventArgs(a.connectionId)):a.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new i.ConnectionEventArgs(a.connectionId)):a.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new i.ConnectionMessageEventArgs(new t.ConnectionMessageImpl(a.message))):a.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new i.ConnectionMessageEventArgs(new t.ConnectionMessageImpl(a.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(a=>{this.receivedServiceMessage&&this.receivedServiceMessage(new i.ServiceEventArgs(a.jsonString,a.name))})}};return Wf.Connection=s,Wf}var Wk;function z5(){if(Wk)return Ff;Wk=1,Object.defineProperty(Ff,"__esModule",{value:!0}),Ff.TranslationRecognizer=void 0;const r=Oe(),e=is(),t=We(),n=M_(),i=rt(),s=xe();let o=class N_ extends s.Recognizer{constructor(l,u,h){const m=l;i.Contracts.throwIfNull(m,"speechConfig"),super(u,m.properties,h||new r.TranslationConnectionFactory,l.tokenCredential),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice),s.PropertyId[s.PropertyId.SpeechServiceConnection_TranslationVoice]),i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages),s.PropertyId[s.PropertyId.SpeechServiceConnection_TranslationToLanguages]),i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage),s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(l,u,h){const m=l;return u.properties.mergeTo(m.properties),u.properties.getProperty(s.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)===r.AutoDetectSourceLanguagesOpenRangeOptionName&&m.properties.setProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),new N_(l,h)}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(l){this.properties.setProperty(s.PropertyId.SpeechServiceAuthorization_Token,l)}recognizeOnceAsync(l,u){i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,t.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(e.RecognitionMode.Interactive),l,u)}startContinuousRecognitionAsync(l,u){(0,t.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(e.RecognitionMode.Conversation),l,u)}stopContinuousRecognitionAsync(l,u){(0,t.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),l,u)}removeTargetLanguage(l){if(i.Contracts.throwIfNullOrUndefined(l,"language to be removed"),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){const u=this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),h=u.indexOf(l);h>-1&&(u.splice(h,1),this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,u.join(",")),this.updateLanguages(u))}}addTargetLanguage(l){i.Contracts.throwIfNullOrUndefined(l,"language to be added");let u=[];this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(u=this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),u.includes(l)||(u.push(l),this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,u.join(",")))):(this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,l),u=[l]),this.updateLanguages(u)}close(l,u){i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),l,u)}onConnection(){}async dispose(l){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,l&&(await this.implRecognizerStop(),await super.dispose(l)))}createRecognizerConfig(l){return new r.RecognizerConfig(l,this.privProperties)}createServiceRecognizer(l,u,h,m){const g=h;return new r.TranslationServiceRecognizer(l,u,g,m,this)}updateLanguages(l){const u=n.Connection.fromRecognizer(this);u&&(u.setMessageProperty("speech.context","translationcontext",{to:l}),u.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:l})))}};return Ff.TranslationRecognizer=o,Ff}var Uf={},Uk;function F5(){if(Uk)return Uf;Uk=1,Object.defineProperty(Uf,"__esModule",{value:!0}),Uf.Translations=void 0;const r=xe();let e=class{constructor(){this.privMap=new r.PropertyCollection}get languages(){return this.privMap.keys}get(n,i){return this.privMap.getProperty(n,i)}set(n,i){this.privMap.setProperty(n,i)}};return Uf.Translations=e,Uf}var Bx={},Zk;function W5(){return Zk||(Zk=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.NoMatchReason=void 0,(function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"})(r.NoMatchReason||(r.NoMatchReason={}))})(Bx)),Bx}var Zf={},$k;function U5(){if($k)return Zf;$k=1,Object.defineProperty(Zf,"__esModule",{value:!0}),Zf.NoMatchDetails=void 0;const r=Oe(),e=xe();let t=class L_{constructor(i){this.privReason=i}static fromResult(i){const s=r.SimpleSpeechPhrase.fromJSON(i.json,0);let o=e.NoMatchReason.NotRecognized;switch(s.RecognitionStatus){case r.RecognitionStatus.BabbleTimeout:o=e.NoMatchReason.InitialBabbleTimeout;break;case r.RecognitionStatus.InitialSilenceTimeout:o=e.NoMatchReason.InitialSilenceTimeout;break;default:o=e.NoMatchReason.NotRecognized;break}return new L_(o)}get reason(){return this.privReason}};return Zf.NoMatchDetails=t,Zf}var $f={},Hk;function Z5(){if(Hk)return $f;Hk=1,Object.defineProperty($f,"__esModule",{value:!0}),$f.TranslationRecognitionCanceledEventArgs=void 0;let r=class{constructor(t,n,i,s,o){this.privCancelReason=n,this.privErrorDetails=i,this.privResult=o,this.privSessionId=t,this.privErrorCode=s}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return $f.TranslationRecognitionCanceledEventArgs=r,$f}var Hf={},Vk;function __(){if(Vk)return Hf;Vk=1,Object.defineProperty(Hf,"__esModule",{value:!0}),Hf.CancellationDetailsBase=void 0;let r=class{constructor(t,n,i){this.privReason=t,this.privErrorDetails=n,this.privErrorCode=i}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};return Hf.CancellationDetailsBase=r,Hf}var Vf={},qk;function $5(){if(qk)return Vf;qk=1,Object.defineProperty(Vf,"__esModule",{value:!0}),Vf.CancellationDetails=void 0;const r=Oe(),e=__(),t=xe();let n=class O_ extends e.CancellationDetailsBase{constructor(s,o,a){super(s,o,a)}static fromResult(s){let o=t.CancellationReason.Error,a=t.CancellationErrorCode.NoError;if(s instanceof t.RecognitionResult&&s.json){const l=r.SimpleSpeechPhrase.fromJSON(s.json,0);o=r.EnumTranslation.implTranslateCancelResult(l.RecognitionStatus)}return s.properties&&(a=t.CancellationErrorCode[s.properties.getProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[t.CancellationErrorCode.NoError])]),new O_(o,s.errorDetails||r.EnumTranslation.implTranslateErrorDetails(a),a)}};return Vf.CancellationDetails=n,Vf}var zx={},Gk;function H5(){return Gk||(Gk=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.CancellationErrorCode=void 0,(function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError",e[e.Forbidden=8]="Forbidden"})(r.CancellationErrorCode||(r.CancellationErrorCode={}))})(zx)),zx}var qf={},Kk;function V5(){if(Kk)return qf;Kk=1,Object.defineProperty(qf,"__esModule",{value:!0}),qf.ConnectionEventArgs=void 0;const r=xe();let e=class extends r.SessionEventArgs{};return qf.ConnectionEventArgs=e,qf}var Gf={},Yk;function q5(){if(Yk)return Gf;Yk=1,Object.defineProperty(Gf,"__esModule",{value:!0}),Gf.ServiceEventArgs=void 0;const r=xe();let e=class extends r.SessionEventArgs{constructor(n,i,s){super(s),this.privJsonResult=n,this.privEventName=i}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};return Gf.ServiceEventArgs=e,Gf}var Kf={},Xk;function G5(){if(Xk)return Kf;Xk=1,Object.defineProperty(Kf,"__esModule",{value:!0}),Kf.PhraseListGrammar=void 0;const r=rt();let e=class D_{constructor(n){this.privGrammerBuilder=n.dynamicGrammar}static fromRecognizer(n){const i=n.internalData;return new D_(i)}addPhrase(n){this.privGrammerBuilder.addPhrase(n)}addPhrases(n){this.privGrammerBuilder.addPhrase(n)}clear(){this.privGrammerBuilder.clearPhrases()}setWeight(n){r.Contracts.throwIfNumberOutOfRange(n,"weight",0,2),this.privGrammerBuilder.setWeight(n)}};return Kf.PhraseListGrammar=e,Kf}var Xl={},Jk;function kP(){if(Jk)return Xl;Jk=1,Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.DialogServiceConfigImpl=Xl.DialogServiceConfig=void 0;const r=rt(),e=xe();let t=class{constructor(){}set applicationId(s){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};Xl.DialogServiceConfig=t;class n extends t{constructor(){super(),this.privSpeechConfig=new e.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(s){r.Contracts.throwIfNullOrWhitespace(s,"value"),this.privSpeechConfig.speechRecognitionLanguage=s}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(s){this.privSpeechConfig.outputFormat=s}setProperty(s,o){this.privSpeechConfig.setProperty(s,o)}getProperty(s,o){return this.privSpeechConfig.getProperty(s)}setProxy(s,o,a,l){this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyHostName,s),this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyPort,`${o}`),a&&this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyUserName,a),l&&this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyPassword,l)}setServiceProperty(s,o,a){this.privSpeechConfig.setServiceProperty(s,o)}close(){}}return Xl.DialogServiceConfigImpl=n,Xl}var Yf={},Qk;function K5(){if(Qk)return Yf;Qk=1,Object.defineProperty(Yf,"__esModule",{value:!0}),Yf.BotFrameworkConfig=void 0;const r=rt(),e=kP(),t=xe();let n=class extends e.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(s,o,a){r.Contracts.throwIfNullOrWhitespace(s,"subscription"),r.Contracts.throwIfNullOrWhitespace(o,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),l.setProperty(t.PropertyId.SpeechServiceConnection_Key,s),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,o),a&&l.setProperty(t.PropertyId.Conversation_ApplicationId,a),l}static fromAuthorizationToken(s,o,a){r.Contracts.throwIfNullOrWhitespace(s,"authorizationToken"),r.Contracts.throwIfNullOrWhitespace(o,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),l.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,s),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,o),a&&l.setProperty(t.PropertyId.Conversation_ApplicationId,a),l}static fromHost(s,o,a){r.Contracts.throwIfNullOrUndefined(s,"host");const l=s instanceof URL?s:new URL(`wss://${s}.convai.speech.azure.us`);r.Contracts.throwIfNullOrUndefined(l,"resolvedHost");const u=new e.DialogServiceConfigImpl;return u.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),u.setProperty(t.PropertyId.SpeechServiceConnection_Host,l.toString()),o!==void 0&&u.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),u}static fromEndpoint(s,o){r.Contracts.throwIfNull(s,"endpoint");const a=new e.DialogServiceConfigImpl;return a.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),a.setProperty(t.PropertyId.SpeechServiceConnection_Endpoint,s.toString()),o!==void 0&&a.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),a}};return Yf.BotFrameworkConfig=n,Yf}var Xf={},eM;function Y5(){if(eM)return Xf;eM=1,Object.defineProperty(Xf,"__esModule",{value:!0}),Xf.CustomCommandsConfig=void 0;const r=rt(),e=kP(),t=xe();let n=class extends e.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(s,o,a){r.Contracts.throwIfNullOrWhitespace(s,"applicationId"),r.Contracts.throwIfNullOrWhitespace(o,"subscription"),r.Contracts.throwIfNullOrWhitespace(a,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.CustomCommands),l.setProperty(t.PropertyId.Conversation_ApplicationId,s),l.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}static fromAuthorizationToken(s,o,a){r.Contracts.throwIfNullOrWhitespace(s,"applicationId"),r.Contracts.throwIfNullOrWhitespace(o,"authorizationToken"),r.Contracts.throwIfNullOrWhitespace(a,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.CustomCommands),l.setProperty(t.PropertyId.Conversation_ApplicationId,s),l.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}set applicationId(s){r.Contracts.throwIfNullOrWhitespace(s,"value"),this.setProperty(t.PropertyId.Conversation_ApplicationId,s)}get applicationId(){return this.getProperty(t.PropertyId.Conversation_ApplicationId)}};return Xf.CustomCommandsConfig=n,Xf}var Jf={},Qf={},em={},tm={},tM;function wl(){if(tM)return tm;tM=1,Object.defineProperty(tm,"__esModule",{value:!0}),tm.QueryParameterNames=void 0;let r=class{};return tm.QueryParameterNames=r,r.BotId="botid",r.CustomSpeechDeploymentId="cid",r.CustomVoiceDeploymentId="deploymentId",r.EnableAudioLogging="storeAudio",r.EnableLanguageId="lidEnabled",r.EnableWordLevelTimestamps="wordLevelTimestamps",r.EndSilenceTimeoutMs="endSilenceTimeoutMs",r.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",r.SegmentationMaximumTimeMs="segmentationMaximumTimeMs",r.SegmentationStrategy="segmentationStrategy",r.Format="format",r.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",r.Language="language",r.Profanity="profanity",r.RequestBotStatusMessages="enableBotMessageStatus",r.StableIntermediateThreshold="stableIntermediateThreshold",r.StableTranslation="stableTranslation",r.TestHooks="testhooks",r.Postprocessing="postprocessing",r.CtsMeetingId="meetingId",r.CtsDeviceId="deviceId",r.CtsIsParticipant="isParticipant",r.EnableAvatar="enableTalkingAvatar",tm}var rM;function Jo(){if(rM)return em;rM=1,Object.defineProperty(em,"__esModule",{value:!0}),em.ConnectionFactoryBase=void 0;const r=Oe(),e=We(),t=xe(),n=wl();let i=class{static getHostSuffix(o){if(o){if(o.toLowerCase().startsWith("china"))return".azure.cn";if(o.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(o,a,l){new Map([[t.PropertyId.Speech_SegmentationSilenceTimeoutMs,n.QueryParameterNames.SegmentationSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_EnableAudioLogging,n.QueryParameterNames.EnableAudioLogging],[t.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,n.QueryParameterNames.EndSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,n.QueryParameterNames.InitialSilenceTimeoutMs],[t.PropertyId.SpeechServiceResponse_PostProcessingOption,n.QueryParameterNames.Postprocessing],[t.PropertyId.SpeechServiceResponse_ProfanityOption,n.QueryParameterNames.Profanity],[t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,n.QueryParameterNames.EnableWordLevelTimestamps],[t.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,n.QueryParameterNames.StableIntermediateThreshold]]).forEach((m,g)=>{this.setUrlParameter(g,m,o,a,l)});const h=JSON.parse(o.parameters.getProperty(r.ServicePropertiesPropertyName,"{}"));Object.keys(h).forEach(m=>{a[m]=h[m]})}setUrlParameter(o,a,l,u,h){const m=l.parameters.getProperty(o,void 0);m&&(!h||h.search(a)===-1)&&(u[a]=m.toLocaleLowerCase())}static async getRedirectUrlFromEndpoint(o){const a=new URL(o);a.protocol="https:",a.port="443",a.searchParams.append("GenerateRedirectResponse","true");const u=a.toString();e.Events.instance.onEvent(new e.ConnectionRedirectEvent("",u,void 0,"ConnectionFactoryBase: redirectUrl request"));const h=await fetch(u);if(h.status!==200)return o;const m=await h.text();e.Events.instance.onEvent(new e.ConnectionRedirectEvent("",m,o,"ConnectionFactoryBase: redirectUrlString"));try{return new URL(m.trim()).toString()}catch{return o}}};return em.ConnectionFactoryBase=i,em}var nM;function X5(){if(nM)return Qf;nM=1,Object.defineProperty(Qf,"__esModule",{value:!0}),Qf.DialogConnectionFactory=void 0;const r=In(),e=Oe(),t=xe(),n=Jo(),i=Oe(),s=ai(),o=wl();class a extends n.ConnectionFactoryBase{create(u,h,m){const g=u.parameters.getProperty(t.PropertyId.Conversation_ApplicationId,""),v=u.parameters.getProperty(t.PropertyId.Conversation_DialogType),y=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region),A=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),x=u.parameters.getProperty(t.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),b={};b[s.HeaderNames.ConnectionId]=m,b[o.QueryParameterNames.Format]=u.parameters.getProperty(e.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple]).toLowerCase(),b[o.QueryParameterNames.Language]=A,b[o.QueryParameterNames.RequestBotStatusMessages]=x,g&&(b[o.QueryParameterNames.BotId]=g,v===t.DialogServiceConfig.DialogTypes.CustomCommands&&(b[s.HeaderNames.CustomCommandsAppId]=g));const w=v===t.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",T=v===t.DialogServiceConfig.DialogTypes.CustomCommands?"v1":v===t.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",k={};h.token!=null&&h.token!==""&&(k[h.headerName]=h.token);let I=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,"");if(!I){const L=n.ConnectionFactoryBase.getHostSuffix(y),j=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,`wss://${y}.${a.BaseUrl}${L}`);I=`${j.endsWith("/")?j:j+"/"}${w}${a.ApiKey}/${T}`}this.setCommonUrlParams(u,b,I);const M=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new r.WebsocketConnection(I,b,k,new i.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(u),M,m))}}return Qf.DialogConnectionFactory=a,a.ApiKey="api",a.BaseUrl="convai.speech",Qf}var iM;function J5(){if(iM)return Jf;iM=1,Object.defineProperty(Jf,"__esModule",{value:!0}),Jf.DialogServiceConnector=void 0;const r=X5(),e=Oe(),t=is(),n=We(),i=rt(),s=xe(),o=IP();let a=class extends s.Recognizer{constructor(u,h){const m=u;i.Contracts.throwIfNull(u,"dialogConfig"),super(h,m.properties,new r.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=m.properties.clone();const g=this.buildAgentConfig();this.privReco.agentConfig.set(g)}connect(u,h){(0,n.marshalPromiseToCallbacks)(this.privReco.connect(),u,h)}disconnect(u,h){(0,n.marshalPromiseToCallbacks)(this.privReco.disconnect(),u,h)}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(u){i.Contracts.throwIfNullOrWhitespace(u,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,u)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(o.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(u){this.properties.setProperty(o.PropertyId.Conversation_Speech_Activity_Template,u)}listenOnceAsync(u,h){if(this.isTurnComplete){i.Contracts.throwIfDisposed(this.privIsDisposed);const g=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;const v=new n.Deferred;await this.privReco.recognize(t.RecognitionMode.Conversation,v.resolve,v.reject);const y=await v.promise;return await this.implRecognizerStop(),y})();g.catch(()=>{this.dispose(!0).catch(()=>{})}),(0,n.marshalPromiseToCallbacks)(g.finally(()=>{this.isTurnComplete=!0}),u,h)}}sendActivityAsync(u,h,m){(0,n.marshalPromiseToCallbacks)(this.privReco.sendMessage(u),h,m)}close(u,h){i.Contracts.throwIfDisposed(this.privIsDisposed),(0,n.marshalPromiseToCallbacks)(this.dispose(!0),u,h)}async dispose(u){this.privIsDisposed||u&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(u))}createRecognizerConfig(u){return new e.RecognizerConfig(u,this.privProperties)}createServiceRecognizer(u,h,m,g){const v=m;return new e.DialogServiceAdapter(u,h,v,g,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(o.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(o.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(o.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};return Jf.DialogServiceConnector=a,Jf}var rm={},sM;function Q5(){if(sM)return rm;sM=1,Object.defineProperty(rm,"__esModule",{value:!0}),rm.ActivityReceivedEventArgs=void 0;let r=class{constructor(t,n){this.privActivity=t,this.privAudioStream=n}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};return rm.ActivityReceivedEventArgs=r,rm}var nm={},im={},oM;function ez(){if(oM)return im;oM=1,Object.defineProperty(im,"__esModule",{value:!0}),im.TurnStatusResponsePayload=void 0;class r{constructor(t){this.privMessageStatusResponse=JSON.parse(t)}static fromJSON(t){return new r(t)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}return im.TurnStatusResponsePayload=r,im}var aM;function tz(){if(aM)return nm;aM=1,Object.defineProperty(nm,"__esModule",{value:!0}),nm.TurnStatusReceivedEventArgs=void 0;const r=ez();let e=class{constructor(n){this.privTurnStatus=r.TurnStatusResponsePayload.fromJSON(n)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};return nm.TurnStatusReceivedEventArgs=e,nm}var Fx={},lM;function rz(){return lM||(lM=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ServicePropertyChannel=void 0,(function(e){e[e.UriQueryParameter=0]="UriQueryParameter"})(r.ServicePropertyChannel||(r.ServicePropertyChannel={}))})(Fx)),Fx}var Wx={},cM;function nz(){return cM||(cM=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ProfanityOption=void 0,(function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"})(r.ProfanityOption||(r.ProfanityOption={}))})(Wx)),Wx}var sm={},uM;function iz(){if(uM)return sm;uM=1,Object.defineProperty(sm,"__esModule",{value:!0}),sm.BaseAudioPlayer=void 0;const r=Zs(),e=xe(),t=Lu();let n=class{constructor(s){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,s===void 0&&(s=e.AudioStreamFormat.getDefaultInputFormat()),this.init(s)}playAudioSample(s,o,a){try{this.ensureInitializedContext();const l=this.formatAudioData(s),u=new Float32Array(this.samples.length+l.length);u.set(this.samples,0),u.set(l,this.samples.length),this.samples=u,o&&o()}catch(l){a&&a(l)}}stopAudio(s,o){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{s&&s()},a=>{o&&o(a)}),this.audioContext=null)}init(s){this.audioFormat=s,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();const s=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},s)}}createAudioContext(){this.audioContext=t.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(s){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(s),128);case 16:return this.formatArrayBuffer(new Int16Array(s),32768);case 32:return this.formatArrayBuffer(new Int32Array(s),2147483648);default:throw new r.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(s,o){const a=new Float32Array(s.length);for(let l=0;l<s.length;l++)a[l]=s[l]/o;return a}updateAudioBuffer(){if(this.samples.length===0)return;const s=this.audioFormat.channels,o=this.audioContext.createBufferSource(),a=this.samples.length/s,l=this.audioContext.createBuffer(s,a,this.audioFormat.samplesPerSec);for(let u=0;u<s;u++){let h=u;const m=l.getChannelData(u);for(let g=0;g<this.samples.length;g++,h+=s)m[g]=this.samples[h]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),o.buffer=l,o.connect(this.gainNode),o.start(this.startTime),this.startTime+=l.duration,this.samples=new Float32Array}async playAudio(s){this.audioContext===null&&this.createAudioContext();const o=this.audioContext.createBufferSource(),a=this.audioContext.destination;await this.audioContext.decodeAudioData(s,l=>{o.buffer=l,o.connect(a),o.start(0)})}};return sm.BaseAudioPlayer=n,sm}var om={},dM;function sz(){if(dM)return om;dM=1,Object.defineProperty(om,"__esModule",{value:!0}),om.ConnectionMessageEventArgs=void 0;let r=class{constructor(t){this.privConnectionMessage=t}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};return om.ConnectionMessageEventArgs=r,om}var am={},Ux={},hM;function j_(){return hM||(hM=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.LanguageIdMode=void 0,(function(e){e[e.AtStart=0]="AtStart",e[e.Continuous=1]="Continuous"})(r.LanguageIdMode||(r.LanguageIdMode={}))})(Ux)),Ux}var pM;function oz(){if(pM)return am;pM=1,Object.defineProperty(am,"__esModule",{value:!0}),am.AutoDetectSourceLanguageConfig=void 0;const r=Oe(),e=rt(),t=xe(),n=j_();let i=class $0{constructor(){this.privProperties=new t.PropertyCollection,this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=n.LanguageIdMode.AtStart}static fromOpenRange(){const o=new $0;return o.properties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,r.AutoDetectSourceLanguagesOpenRangeOptionName),o.properties.setProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),o}static fromLanguages(o){e.Contracts.throwIfArrayEmptyOrWhitespace(o,"languages");const a=new $0;return a.properties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,o.join()),a}static fromSourceLanguageConfigs(o){if(o.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const a=new $0,l=[];return o.forEach(u=>{if(l.push(u.language),u.endpointId!==void 0&&u.endpointId!==""){const h=u.language+t.PropertyId.SpeechServiceConnection_EndpointId.toString();a.properties.setProperty(h,u.endpointId)}}),a.properties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,l.join()),a}get properties(){return this.privProperties}set mode(o){o===n.LanguageIdMode.Continuous?(this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=o}};return am.AutoDetectSourceLanguageConfig=i,am}var lm={},fM;function az(){if(fM)return lm;fM=1,Object.defineProperty(lm,"__esModule",{value:!0}),lm.AutoDetectSourceLanguageResult=void 0;const r=rt();let e=class WT{constructor(n,i){r.Contracts.throwIfNullOrUndefined(n,"language"),r.Contracts.throwIfNullOrUndefined(i,"languageDetectionConfidence"),this.privLanguage=n,this.privLanguageDetectionConfidence=i}static fromResult(n){return new WT(n.language,n.languageDetectionConfidence)}static fromConversationTranscriptionResult(n){return new WT(n.language,n.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};return lm.AutoDetectSourceLanguageResult=e,lm}var cm={},mM;function lz(){if(mM)return cm;mM=1,Object.defineProperty(cm,"__esModule",{value:!0}),cm.SourceLanguageConfig=void 0;const r=rt();let e=class B_{constructor(n,i){r.Contracts.throwIfNullOrUndefined(n,"language"),this.privLanguage=n,this.privEndpointId=i}static fromLanguage(n,i){return new B_(n,i)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};return cm.SourceLanguageConfig=e,cm}var Zx={},Jl={},gM;function z_(){if(gM)return Jl;gM=1,Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.ConversationImpl=Jl.Conversation=void 0;const r=Oe(),e=We(),t=rt(),n=xe();let i=class{constructor(){}static createConversationAsync(a,l,u,h){t.Contracts.throwIfNullOrUndefined(a,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrUndefined(a.region,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!a.subscriptionKey&&!a.getProperty(n.PropertyId[n.PropertyId.SpeechServiceAuthorization_Token])&&t.Contracts.throwIfNullOrUndefined(a.subscriptionKey,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let m,g,v;return typeof l=="string"?(m=new s(a,l),(0,e.marshalPromiseToCallbacks)((async()=>{})(),u,h)):(m=new s(a),g=l,v=u,m.createConversationAsync((()=>{g&&g()}),y=>{v&&v(y)})),m}};Jl.Conversation=i;class s extends i{constructor(a,l){if(super(),this.privErrors=r.ConversationConnectionConfig.restErrors,this.onConnected=m=>{var g;this.privIsConnected=!0;try{(g=this.privConversationTranslator)!=null&&g.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,m)}catch{}},this.onDisconnected=m=>{var g;try{(g=this.privConversationTranslator)!=null&&g.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,m)}catch{}finally{this.close(!1)}},this.onCanceled=(m,g)=>{var v;try{(v=this.privConversationTranslator)!=null&&v.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,g)}catch{}},this.onParticipantUpdateCommandReceived=(m,g)=>{try{const v=this.privParticipants.getParticipant(g.id);if(v!==void 0){switch(g.key){case r.ConversationTranslatorCommandTypes.changeNickname:v.displayName=g.value;break;case r.ConversationTranslatorCommandTypes.setUseTTS:v.isUsingTts=g.value;break;case r.ConversationTranslatorCommandTypes.setProfanityFiltering:v.profanity=g.value;break;case r.ConversationTranslatorCommandTypes.setMute:v.isMuted=g.value;break;case r.ConversationTranslatorCommandTypes.setTranslateToLanguages:v.translateToLanguages=g.value;break}this.privParticipants.addOrUpdateParticipant(v),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new n.ConversationParticipantsChangedEventArgs(n.ParticipantChangedReason.Updated,[this.toParticipant(v)],g.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(m,g)=>{try{this.privParticipants.participants.forEach(v=>v.isMuted=v.isHost?!1:g.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new n.ConversationParticipantsChangedEventArgs(n.ParticipantChangedReason.Updated,this.toParticipants(!1),g.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(m,g)=>{try{const v=this.privParticipants.addOrUpdateParticipant(g.participant);v!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new n.ConversationParticipantsChangedEventArgs(n.ParticipantChangedReason.JoinedConversation,[this.toParticipant(v)],g.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(m,g)=>{try{const v=this.privParticipants.getParticipant(g.participant.id);v!==void 0&&(this.privParticipants.deleteParticipant(g.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new n.ConversationParticipantsChangedEventArgs(n.ParticipantChangedReason.LeftConversation,[this.toParticipant(v)],g.sessionId)))}catch{}},this.onTranslationReceived=(m,g)=>{try{switch(g.command){case r.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new n.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case r.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new n.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case r.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new n.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break}}catch{}},this.onParticipantsListReceived=(m,g)=>{var v;try{if(g.sessionToken!==void 0&&g.sessionToken!==null&&(this.privRoom.token=g.sessionToken),this.privParticipants.participants=[...g.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new n.ConversationParticipantsChangedEventArgs(n.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),g.sessionId)),this.me.isHost){const y=(v=this.privConversationTranslator)==null?void 0:v.properties.getProperty(n.PropertyId.ConversationTranslator_Name);y!==void 0&&y.length>0&&y!==this.me.displayName&&this.changeNicknameAsync(y)}}catch{}},this.onConversationExpiration=(m,g)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,g)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new n.PropertyCollection,this.privManager=new r.ConversationManager,a.getProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage])||a.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage],r.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=a.getProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage]),l)this.privConversationId=l;else{a.targetLanguages.length===0&&a.addTargetLanguage(this.privLanguage),a.getProperty(n.PropertyId[n.PropertyId.SpeechServiceResponse_ProfanityOption])||a.setProfanity(n.ProfanityOption.Masked);let g=a.getProperty(n.PropertyId[n.PropertyId.ConversationTranslator_Name]);g==null&&(g="Host"),t.Contracts.throwIfNullOrTooLong(g,"nickname",50),t.Contracts.throwIfNullOrTooShort(g,"nickname",2),a.setProperty(n.PropertyId[n.PropertyId.ConversationTranslator_Name],g)}this.privConfig=a;const h=a;t.Contracts.throwIfNull(h,"speechConfig"),this.privProperties=h.properties.clone(),this.privIsConnected=!1,this.privParticipants=new r.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var a,l;return(a=this.privParticipants.me)!=null&&a.isHost?!1:(l=this.privParticipants.me)==null?void 0:l.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const a=this.conversationId,l=this.participants.map(m=>({id:m.id,preferredLanguage:m.preferredLanguage,voice:m.voice})),u={};for(const m of r.ConversationConnectionConfig.transcriptionEventKeys){const g=this.properties.getProperty(m,"");g!==""&&(u[m]=g)}return{id:a,participants:l,conversationProperties:u}}get canSend(){var a;return this.privIsConnected&&!((a=this.privParticipants.me)!=null&&a.isMuted)}get canSendAsHost(){var a;return this.privIsConnected&&((a=this.privParticipants.me)==null?void 0:a.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),this.privToken=a}set conversationTranslator(a){this.privConversationTranslator=a}onToken(a){this.privConversationTranslator.onToken(a)}createConversationAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),this.privManager.createOrJoin(this.privProperties,void 0,(u=>{u||this.handleError(new Error(this.privErrors.permissionDeniedConnect),l),this.privRoom=u,this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}startConversationAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=r.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}addParticipantAsync(a,l,u){t.Contracts.throwIfNullOrUndefined(a,"Participant"),(0,e.marshalPromiseToCallbacks)(this.addParticipantImplAsync(a),l,u)}joinConversationAsync(a,l,u,h,m){try{t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","conversationId")),t.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,a,(g=>{t.Contracts.throwIfNullOrUndefined(g,this.privErrors.permissionDeniedConnect),this.privRoom=g,this.privConfig.authorizationToken=g.cognitiveSpeechAuthToken,h&&h(g.cognitiveSpeechAuthToken)}),(g=>{this.handleError(g,m)}))}catch(g){this.handleError(g,m)}}deleteConversationAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.deleteConversationImplAsync(),a,l)}async deleteConversationImplAsync(){t.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),t.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.endConversationImplAsync(),a,l)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}muteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}muteParticipantAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!0),(()=>{this.handleCallback(l,u)}),(m=>{this.handleError(m,u)}))}catch(h){this.handleError(h,u)}}removeParticipantAsync(a,l,u){try{if(t.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&a.hasOwnProperty("id"))(0,e.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(a),l,u);else{t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),u);let h="";typeof a=="string"?h=a:a.hasOwnProperty("id")?h=a.id:a.hasOwnProperty("userId")&&(h=a.userId),t.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(g=>g.id===h)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(h),(()=>{this.handleCallback(l,u)}),(g=>{this.handleError(g,u)}))}}catch(h){this.handleError(h,u)}}unlockConversationAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}unmuteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}unmuteParticipantAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!1),(()=>{this.handleCallback(l,u)}),(m=>{this.handleError(m,u)}))}catch(h){this.handleError(h,u)}}sendTextMessageAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","message")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),a.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(a),(()=>{this.handleCallback(l,u)}),(h=>{this.handleError(h,u)}))}catch(h){this.handleError(h,u)}}setTranslatedLanguagesAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfArrayEmptyOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","languages")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(a),(()=>{this.handleCallback(l,u)}),(h=>{this.handleError(h,u)}))}catch(h){this.handleError(h,u)}}changeNicknameAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(a),(()=>{this.handleCallback(l,u)}),(h=>{this.handleError(h,u)}))}catch(h){this.handleError(h,u)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(a){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await a.enforceAudioGating(),this.privTranscriberRecognizer=a,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){const a=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:a,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(a){if(this.privParticipants.addOrUpdateParticipant(a)!==void 0&&this.privTranscriberRecognizer){const u=this.conversationInfo;return u.participants=[a],this.privTranscriberRecognizer.pushConversationEvent(u,"join")}}removeParticipantImplAsync(a){this.privParticipants.deleteParticipant(a.id);const l=this.conversationInfo;return l.participants=[a],this.privTranscriberRecognizer.pushConversationEvent(l,"leave")}async close(a){var l;try{this.privIsConnected=!1,await((l=this.privConversationRecognizer)==null?void 0:l.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(u){throw u}a&&this.dispose()}handleCallback(a,l){if(a){try{a()}catch(u){l&&l(u)}a=void 0}}handleError(a,l){if(l)if(a instanceof Error){const u=a;l(u.name+": "+u.message)}else l(a)}toParticipants(a){const l=this.privParticipants.participants.map(u=>this.toParticipant(u));return a?l:l.filter(u=>u.isHost===!1)}toParticipant(a){return new n.Participant(a.id,a.avatar,a.displayName,a.isHost,a.isMuted,a.isUsingTts,a.preferredLanguage,a.voice)}getMuteAllCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMuteCommand(a,l){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setMute,participantId:a,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:l})}getLockCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:a})}getEjectCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.ejectParticipant,participantId:a,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:a})}getChangeNicknameCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"nickname"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.changeNickname,nickname:a,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMessageCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),t.Contracts.throwIfNullOrWhitespace(a,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:a,type:r.ConversationTranslatorMessageTypes.instantMessage})}}return Jl.ConversationImpl=s,Jl}var um={},vM;function cz(){if(vM)return um;vM=1,Object.defineProperty(um,"__esModule",{value:!0}),um.ConversationCommon=void 0;let r=class{constructor(t){this.privAudioConfig=t}handleCallback(t,n){if(t){try{t()}catch(i){n&&n(i)}t=void 0}}handleError(t,n){if(n)if(t instanceof Error){const i=t;n(i.name+": "+i.message)}else n(t)}};return um.ConversationCommon=r,um}var dm={},SM;function uz(){if(SM)return dm;SM=1,Object.defineProperty(dm,"__esModule",{value:!0}),dm.ConversationExpirationEventArgs=void 0;const r=xe();let e=class extends r.SessionEventArgs{constructor(n,i){super(i),this.privExpirationTime=n}get expirationTime(){return this.privExpirationTime}};return dm.ConversationExpirationEventArgs=e,dm}var hm={},yM;function dz(){if(yM)return hm;yM=1,Object.defineProperty(hm,"__esModule",{value:!0}),hm.ConversationParticipantsChangedEventArgs=void 0;const r=xe();let e=class extends r.SessionEventArgs{constructor(n,i,s){super(s),this.privReason=n,this.privParticipant=i}get reason(){return this.privReason}get participants(){return this.privParticipant}};return hm.ConversationParticipantsChangedEventArgs=e,hm}var pm={},CM;function hz(){if(CM)return pm;CM=1,Object.defineProperty(pm,"__esModule",{value:!0}),pm.ConversationTranslationCanceledEventArgs=void 0;const r=oy();let e=class extends r.CancellationEventArgsBase{};return pm.ConversationTranslationCanceledEventArgs=e,pm}var fm={},AM;function pz(){if(AM)return fm;AM=1,Object.defineProperty(fm,"__esModule",{value:!0}),fm.ConversationTranslationEventArgs=void 0;const r=xe();let e=class extends r.RecognitionEventArgs{constructor(n,i,s){super(i,s),this.privResult=n}get result(){return this.privResult}};return fm.ConversationTranslationEventArgs=e,fm}var mm={},bM;function fz(){if(bM)return mm;bM=1,Object.defineProperty(mm,"__esModule",{value:!0}),mm.ConversationTranslationResult=void 0;const r=w_();let e=class extends r.TranslationRecognitionResult{constructor(n,i,s,o,a,l,u,h,m,g,v){super(i,o,a,l,u,h,void 0,void 0,m,g,v),this.privId=n,this.privOrigLang=s}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};return mm.ConversationTranslationResult=e,mm}var $x={},gm={},vm={},xM;function F_(){if(xM)return vm;xM=1,Object.defineProperty(vm,"__esModule",{value:!0}),vm.StringUtils=void 0;let r=class{static formatString(t,n){if(!t)return"";if(!n)return t;let i="",s="";const o=u=>{i+=u},a=u=>{s+=u};let l=o;for(let u=0;u<t.length;u++){const h=t[u],m=u+1<t.length?t[u+1]:"";switch(h){case"{":m==="{"?(l("{"),u++):l=a;break;case"}":m==="}"?(l("}"),u++):(n.hasOwnProperty(s)&&(i+=n[s]),l=o,s="");break;default:l(h);break}}return i}};return vm.StringUtils=r,vm}var TM;function mz(){if(TM)return gm;TM=1,Object.defineProperty(gm,"__esModule",{value:!0}),gm.ConversationTranslatorConnectionFactory=void 0;const r=In(),e=F_(),t=rt(),n=xe(),i=ai(),s=wl(),o=Jo(),a=Oe();let l=class W_ extends o.ConnectionFactoryBase{constructor(h){super(),t.Contracts.throwIfNullOrUndefined(h,"convGetter"),this.privConvGetter=h}create(h,m,g){const v=h.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",y=this.privConvGetter().room,A=y.cognitiveSpeechRegion||h.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region,""),x={hostSuffix:o.ConnectionFactoryBase.getHostSuffix(A),path:W_.CTS_VIRT_MIC_PATH,region:encodeURIComponent(A)};x[s.QueryParameterNames.Language]=encodeURIComponent(h.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,"")),x[s.QueryParameterNames.CtsMeetingId]=encodeURIComponent(y.roomId),x[s.QueryParameterNames.CtsDeviceId]=encodeURIComponent(y.participantId),x[s.QueryParameterNames.CtsIsParticipant]=y.isHost?"":"&"+s.QueryParameterNames.CtsIsParticipant;let b="";const w={},T={};if(v){b=h.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint),b||(b="wss://"+h.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),b=e.StringUtils.formatString(b,x);const I=new URL(b);I.searchParams.forEach((L,j)=>{w[j]=L}),new a.TranscriberConnectionFactory().setQueryParams(w,h,b),w[s.QueryParameterNames.CtsMeetingId]=x[s.QueryParameterNames.CtsMeetingId],w[s.QueryParameterNames.CtsDeviceId]=x[s.QueryParameterNames.CtsDeviceId],y.isHost||(w[s.QueryParameterNames.CtsIsParticipant]=""),s.QueryParameterNames.Format in w||(w[s.QueryParameterNames.Format]="simple"),I.searchParams.forEach((L,j)=>{I.searchParams.set(j,w[j]),delete w[j]}),b=I.toString()}else{const I=new a.TranslationConnectionFactory;b=I.getEndpointUrl(h,!0),b=e.StringUtils.formatString(b,x),I.setQueryParams(w,h,b)}T[i.HeaderNames.ConnectionId]=g,T[r.RestConfigBase.configParams.token]=y.token,m.token&&(T[m.headerName]=m.token);const k=h.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return Promise.resolve(new r.WebsocketConnection(b,w,T,new a.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(h),k,g))}};return gm.ConversationTranslatorConnectionFactory=l,l.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio",gm}var wM;function gz(){return wM||(wM=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ConversationTranslator=r.SpeechState=void 0;const e=Oe(),t=mz(),n=We(),i=rt(),s=xe(),o=z_(),a=MP();var l;(function(m){m[m.Inactive=0]="Inactive",m[m.Connecting=1]="Connecting",m[m.Connected=2]="Connected"})(l=r.SpeechState||(r.SpeechState={}));class u extends s.TranslationRecognizer{constructor(g,v,y,A){super(g,v,new t.ConversationTranslatorConnectionFactory(A)),this.privSpeechState=l.Inactive,y&&(this.privTranslator=y,this.sessionStarted=()=>{this.privSpeechState=l.Connected},this.sessionStopped=()=>{this.privSpeechState=l.Inactive},this.recognizing=(x,b)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,b)},this.recognized=async(x,b)=>{var w;(w=b.result)!=null&&w.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(b.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,b)},this.canceled=async()=>{if(this.privSpeechState!==l.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=l.Inactive}})}get state(){return this.privSpeechState}set state(g){this.privSpeechState=g}set authentication(g){this.privReco.authentication=g}onConnection(){this.privSpeechState=l.Connected}async onCancelSpeech(){this.privSpeechState=l.Inactive,await this.cancelSpeech()}fireCancelEvent(g){try{if(this.privTranslator.canceled){const v=new a.ConversationTranslationCanceledEventArgs(s.CancellationReason.Error,g,s.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,v)}}catch{}}async cancelSpeech(){var g;try{this.stopContinuousRecognitionAsync(),await((g=this.privReco)==null?void 0:g.disconnect()),this.privSpeechState=l.Inactive}catch{}}}class h extends a.ConversationCommon{constructor(g){super(g),this.privErrors=e.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new s.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){var g;return(g=this.privConversation)==null?void 0:g.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===l.Connected||this.privCTRecognizer.state===l.Connecting||this.privConversation.isMutedByHost)}onToken(g){this.privCTRecognizer.authentication=g}setServiceProperty(g,v){const y=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));y[g]=v,this.privProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(y))}joinConversationAsync(g,v,y,A,x){try{if(typeof g=="string"){i.Contracts.throwIfNullOrUndefined(g,this.privErrors.invalidArgs.replace("{arg}","conversation id")),i.Contracts.throwIfNullOrWhitespace(v,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),x);let b=y;(b==null||b==="")&&(b=e.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=s.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(s.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(b),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage],b),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.ConversationTranslator_Name],v);const w=[s.PropertyId.SpeechServiceConnection_Host,s.PropertyId.ConversationTranslator_Host,s.PropertyId.SpeechServiceConnection_Endpoint,s.PropertyId.SpeechServiceConnection_ProxyHostName,s.PropertyId.SpeechServiceConnection_ProxyPassword,s.PropertyId.SpeechServiceConnection_ProxyPort,s.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const k of w){const I=this.privProperties.getProperty(k);if(I){const M=typeof k=="string"?k:s.PropertyId[k];this.privSpeechTranslationConfig.setProperty(M,I)}}const T=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));for(const k of Object.keys(T))this.privSpeechTranslationConfig.setServiceProperty(k,T[k],s.ServicePropertyChannel.UriQueryParameter);this.privConversation=new o.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(g,v,b,(k=>{k||this.handleError(new Error(this.privErrors.permissionDeniedConnect),x),this.privSpeechTranslationConfig.authorizationToken=k,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync((()=>{this.handleCallback(A,x)}),(I=>{this.handleError(I,x)}))}),(k=>{this.handleError(k,x)}))}else typeof g=="object"?(i.Contracts.throwIfNullOrUndefined(g,this.privErrors.invalidArgs.replace("{arg}","conversation id")),i.Contracts.throwIfNullOrWhitespace(v,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(s.PropertyId.ConversationTranslator_Name,v),this.privConversation=g,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),i.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=g.config,this.handleCallback(y,A)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),A)}catch(b){this.handleError(b,typeof y=="string"?x:A)}}leaveConversationAsync(g,v){(0,n.marshalPromiseToCallbacks)((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),g,v)}sendTextMessageAsync(g,v,y){try{i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrWhitespace(g,this.privErrors.invalidArgs.replace("{arg}",g)),this.privConversation.sendTextMessageAsync(g,v,y)}catch(A){this.handleError(A,y)}}startTranscribingAsync(g,v){(0,n.marshalPromiseToCallbacks)((async()=>{try{i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),i.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),v),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(y){throw this.privIsSpeaking=!1,await this.cancelSpeech(),y}})(),g,v)}stopTranscribingAsync(g,v){(0,n.marshalPromiseToCallbacks)((async()=>{try{if(!this.privIsSpeaking){await this.cancelSpeech();return}this.privIsSpeaking=!1,await new Promise((y,A)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(y,A)})}catch{await this.cancelSpeech()}})(),g,v)}isDisposed(){return this.privIsDisposed}dispose(g,v,y){(0,n.marshalPromiseToCallbacks)((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),v,y)}async cancelSpeech(){var g;try{this.privIsSpeaking=!1,await((g=this.privCTRecognizer)==null?void 0:g.onCancelSpeech()),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=s.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key],"");const g=()=>this.privConversation;this.privCTRecognizer=new u(this.privSpeechTranslationConfig,this.privAudioConfig,this,g)}catch(g){throw await this.cancelSpeech(),g}}startContinuousRecognition(){return new Promise((g,v)=>{this.privCTRecognizer.startContinuousRecognitionAsync(g,v)})}}r.ConversationTranslator=h})($x)),$x}var Sm={},PM;function vz(){if(PM)return Sm;PM=1,Object.defineProperty(Sm,"__esModule",{value:!0}),Sm.ConversationTranscriber=void 0;const r=Oe(),e=is(),t=We(),n=rt(),i=xe();let s=class U_ extends i.Recognizer{constructor(a,l){const u=a;n.Contracts.throwIfNull(u,"speechConfig"),n.Contracts.throwIfNullOrWhitespace(u.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),super(l,u.properties,new r.ConversationTranscriberConnectionFactory,a.tokenCredential),this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(a,l,u){const h=a;return l.properties.mergeTo(h.properties),new U_(a,u)}get endpointId(){return n.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){n.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,a)}get speechRecognitionLanguage(){return n.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return n.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple])===i.OutputFormat[i.OutputFormat.Simple]?i.OutputFormat.Simple:i.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(e.RecognitionMode.Conversation),a,l)}stopTranscribingAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),a,l)}close(a,l){n.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),a,l)}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new r.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,l,u,h){const m=u;return h.isSpeakerDiarizationEnabled=!0,new r.ConversationTranscriptionServiceRecognizer(a,l,m,h,this)}};return Sm.ConversationTranscriber=s,Sm}var Ql={},EM;function Sz(){if(EM)return Ql;EM=1,Object.defineProperty(Ql,"__esModule",{value:!0}),Ql.Participant=Ql.User=void 0;const r=xe();class e{constructor(i){this.privUserId=i}get userId(){return this.privUserId}}Ql.User=e;class t{constructor(i,s,o,a,l,u,h,m){this.privId=i,this.privAvatar=s,this.privDisplayName=o,this.privIsHost=a,this.privIsMuted=l,this.privIsUsingTts=u,this.privPreferredLanguage=h,this.privVoice=m,this.privProperties=new r.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(i,s,o){return new t(i,"",i,!1,!1,!1,s,o)}}return Ql.Participant=t,Ql}var Hx={},RM;function yz(){return RM||(RM=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ParticipantChangedReason=void 0,(function(e){e[e.JoinedConversation=0]="JoinedConversation",e[e.LeftConversation=1]="LeftConversation",e[e.Updated=2]="Updated"})(r.ParticipantChangedReason||(r.ParticipantChangedReason={}))})(Hx)),Hx}var ec={},IM;function Cz(){if(IM)return ec;IM=1,Object.defineProperty(ec,"__esModule",{value:!0}),ec.MeetingImpl=ec.Meeting=void 0;const r=Oe(),e=We(),t=rt(),n=xe();let i=class{constructor(){}static createMeetingAsync(a,l,u,h){if(t.Contracts.throwIfNullOrUndefined(a,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrUndefined(a.region,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),t.Contracts.throwIfNull(l,"meetingId"),l.length===0)throw new Error("meetingId cannot be empty");!a.subscriptionKey&&!a.getProperty(n.PropertyId[n.PropertyId.SpeechServiceAuthorization_Token])&&t.Contracts.throwIfNullOrUndefined(a.subscriptionKey,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const m=new s(a,l);return(0,e.marshalPromiseToCallbacks)((async()=>{})(),u,h),m}};ec.Meeting=i;class s extends i{constructor(a,l){super(),this.privErrors=r.ConversationConnectionConfig.restErrors,this.onConnected=m=>{var g;this.privIsConnected=!0;try{(g=this.privConversationTranslator)!=null&&g.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,m)}catch{}},this.onDisconnected=m=>{var g;try{(g=this.privConversationTranslator)!=null&&g.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,m)}catch{}finally{this.close(!1)}},this.onCanceled=(m,g)=>{var v;try{(v=this.privConversationTranslator)!=null&&v.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,g)}catch{}},this.onParticipantUpdateCommandReceived=(m,g)=>{try{const v=this.privParticipants.getParticipant(g.id);if(v!==void 0){switch(g.key){case r.ConversationTranslatorCommandTypes.changeNickname:v.displayName=g.value;break;case r.ConversationTranslatorCommandTypes.setUseTTS:v.isUsingTts=g.value;break;case r.ConversationTranslatorCommandTypes.setProfanityFiltering:v.profanity=g.value;break;case r.ConversationTranslatorCommandTypes.setMute:v.isMuted=g.value;break;case r.ConversationTranslatorCommandTypes.setTranslateToLanguages:v.translateToLanguages=g.value;break}this.privParticipants.addOrUpdateParticipant(v),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new n.ConversationParticipantsChangedEventArgs(n.ParticipantChangedReason.Updated,[this.toParticipant(v)],g.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(m,g)=>{try{this.privParticipants.participants.forEach(v=>v.isMuted=v.isHost?!1:g.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new n.ConversationParticipantsChangedEventArgs(n.ParticipantChangedReason.Updated,this.toParticipants(!1),g.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(m,g)=>{try{const v=this.privParticipants.addOrUpdateParticipant(g.participant);v!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new n.ConversationParticipantsChangedEventArgs(n.ParticipantChangedReason.JoinedConversation,[this.toParticipant(v)],g.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(m,g)=>{try{const v=this.privParticipants.getParticipant(g.participant.id);v!==void 0&&(this.privParticipants.deleteParticipant(g.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new n.ConversationParticipantsChangedEventArgs(n.ParticipantChangedReason.LeftConversation,[this.toParticipant(v)],g.sessionId)))}catch{}},this.onTranslationReceived=(m,g)=>{try{switch(g.command){case r.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new n.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case r.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new n.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case r.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new n.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break}}catch{}},this.onParticipantsListReceived=(m,g)=>{var v;try{if(g.sessionToken!==void 0&&g.sessionToken!==null&&(this.privRoom.token=g.sessionToken),this.privParticipants.participants=[...g.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new n.ConversationParticipantsChangedEventArgs(n.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),g.sessionId)),this.me.isHost){const y=(v=this.privConversationTranslator)==null?void 0:v.properties.getProperty(n.PropertyId.ConversationTranslator_Name);y!==void 0&&y.length>0&&y!==this.me.displayName&&this.changeNicknameAsync(y)}}catch{}},this.onConversationExpiration=(m,g)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,g)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new n.PropertyCollection,this.privManager=new r.ConversationManager,a.getProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage])||a.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage],r.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=a.getProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=l,this.privConfig=a;const h=a;t.Contracts.throwIfNull(h,"speechConfig"),this.privProperties=h.properties.clone(),this.privIsConnected=!1,this.privParticipants=new r.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var a,l;return(a=this.privParticipants.me)!=null&&a.isHost?!1:(l=this.privParticipants.me)==null?void 0:l.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const a=this.meetingId,l=this.participants.map(m=>({id:m.id,preferredLanguage:m.preferredLanguage,voice:m.voice})),u={};for(const m of r.ConversationConnectionConfig.transcriptionEventKeys){const g=this.properties.getProperty(m,"");g!==""&&(u[m]=g)}return{id:a,participants:l,meetingProperties:u}}get canSend(){var a;return this.privIsConnected&&!((a=this.privParticipants.me)!=null&&a.isMuted)}get canSendAsHost(){var a;return this.privIsConnected&&((a=this.privParticipants.me)==null?void 0:a.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),this.privToken=a}createMeetingAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),this.privManager.createOrJoin(this.privProperties,void 0,(u=>{u||this.handleError(new Error(this.privErrors.permissionDeniedConnect),l),this.privRoom=u,this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}startMeetingAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}addParticipantAsync(a,l,u){t.Contracts.throwIfNullOrUndefined(a,"Participant"),(0,e.marshalPromiseToCallbacks)(this.addParticipantImplAsync(a),l,u)}joinMeetingAsync(a,l,u,h,m){try{t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","conversationId")),t.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,a,(g=>{t.Contracts.throwIfNullOrUndefined(g,this.privErrors.permissionDeniedConnect),this.privRoom=g,this.privConfig.authorizationToken=g.cognitiveSpeechAuthToken,h&&h(g.cognitiveSpeechAuthToken)}),(g=>{this.handleError(g,m)}))}catch(g){this.handleError(g,m)}}deleteMeetingAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.deleteMeetingImplAsync(),a,l)}async deleteMeetingImplAsync(){t.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),t.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.endMeetingImplAsync(),a,l)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}muteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}muteParticipantAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!0),(()=>{this.handleCallback(l,u)}),(m=>{this.handleError(m,u)}))}catch(h){this.handleError(h,u)}}removeParticipantAsync(a,l,u){try{if(t.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&a.hasOwnProperty("id"))(0,e.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(a),l,u);else{t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),u);let h="";typeof a=="string"?h=a:a.hasOwnProperty("id")?h=a.id:a.hasOwnProperty("userId")&&(h=a.userId),t.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(g=>g.id===h)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(h),(()=>{this.handleCallback(l,u)}),(g=>{this.handleError(g,u)}))}}catch(h){this.handleError(h,u)}}unlockMeetingAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}unmuteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(a,l)}),(u=>{this.handleError(u,l)}))}catch(u){this.handleError(u,l)}}unmuteParticipantAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!1),(()=>{this.handleCallback(l,u)}),(m=>{this.handleError(m,u)}))}catch(h){this.handleError(h,u)}}sendTextMessageAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","message")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),a.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(a),(()=>{this.handleCallback(l,u)}),(h=>{this.handleError(h,u)}))}catch(h){this.handleError(h,u)}}setTranslatedLanguagesAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfArrayEmptyOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","languages")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(a),(()=>{this.handleCallback(l,u)}),(h=>{this.handleError(h,u)}))}catch(h){this.handleError(h,u)}}changeNicknameAsync(a,l,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(a),(()=>{this.handleCallback(l,u)}),(h=>{this.handleError(h,u)}))}catch(h){this.handleError(h,u)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(a){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await a.enforceAudioGating(),this.privTranscriberRecognizer=a,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){const a=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:a,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(a){if(this.privParticipants.addOrUpdateParticipant(a)!==void 0&&this.privTranscriberRecognizer){const u=this.meetingInfo;return u.participants=[a],this.privTranscriberRecognizer.pushMeetingEvent(u,"join")}}removeParticipantImplAsync(a){this.privParticipants.deleteParticipant(a.id);const l=this.meetingInfo;return l.participants=[a],this.privTranscriberRecognizer.pushMeetingEvent(l,"leave")}async close(a){var l;try{this.privIsConnected=!1,await((l=this.privConversationRecognizer)==null?void 0:l.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(u){throw u}a&&this.dispose()}handleCallback(a,l){if(a){try{a()}catch(u){l&&l(u)}a=void 0}}handleError(a,l){if(l)if(a instanceof Error){const u=a;l(u.name+": "+u.message)}else l(a)}toParticipants(a){const l=this.privParticipants.participants.map(u=>this.toParticipant(u));return a?l:l.filter(u=>u.isHost===!1)}toParticipant(a){return new n.Participant(a.id,a.avatar,a.displayName,a.isHost,a.isMuted,a.isUsingTts,a.preferredLanguage,a.voice)}getMuteAllCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMuteCommand(a,l){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setMute,participantId:a,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:l})}getLockCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:a})}getEjectCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.ejectParticipant,participantId:a,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:a})}getChangeNicknameCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(a,"nickname"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.changeNickname,nickname:a,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMessageCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),t.Contracts.throwIfNullOrWhitespace(a,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:a,type:r.ConversationTranslatorMessageTypes.instantMessage})}}return ec.MeetingImpl=s,ec}var ym={},kM;function Az(){if(kM)return ym;kM=1,Object.defineProperty(ym,"__esModule",{value:!0}),ym.MeetingTranscriptionCanceledEventArgs=void 0;const r=oy();class e extends r.CancellationEventArgsBase{}return ym.MeetingTranscriptionCanceledEventArgs=e,ym}var Cm={},MM;function bz(){if(MM)return Cm;MM=1,Object.defineProperty(Cm,"__esModule",{value:!0}),Cm.MeetingTranscriber=void 0;const r=Oe(),e=We(),t=rt(),n=xe(),i=MP();let s=class{constructor(a){this.privAudioConfig=a,this.privProperties=new n.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return t.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return n.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,a)}joinMeetingAsync(a,l,u){const h=a;t.Contracts.throwIfNullOrUndefined(i.MeetingImpl,"Meeting"),this.privRecognizer=new r.TranscriberRecognizer(a.config,this.privAudioConfig),t.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),(0,e.marshalPromiseToCallbacks)(h.connectTranscriberRecognizer(this.privRecognizer),l,u)}startTranscribingAsync(a,l){this.privRecognizer.startContinuousRecognitionAsync(a,l)}stopTranscribingAsync(a,l){this.privRecognizer.stopContinuousRecognitionAsync(a,l)}leaveMeetingAsync(a,l){this.privRecognizer.disconnectCallbacks(),(0,e.marshalPromiseToCallbacks)((async()=>{})(),a,l)}close(a,l){t.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),a,l)}async dispose(a){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),a&&(this.privDisposedRecognizer=!0))}};return Cm.MeetingTranscriber=s,Cm}var Am={},NM;function xz(){if(NM)return Am;NM=1,Object.defineProperty(Am,"__esModule",{value:!0}),Am.ConversationTranscriptionResult=void 0;const r=xe();let e=class extends r.RecognitionResult{constructor(n,i,s,o,a,l,u,h,m,g,v){super(n,i,s,o,a,l,u,m,g,v),this.privSpeakerId=h}get speakerId(){return this.privSpeakerId}};return Am.ConversationTranscriptionResult=e,Am}var LM;function MP(){return LM||(LM=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ConversationTranscriptionResult=r.MeetingTranscriber=r.MeetingTranscriptionCanceledEventArgs=r.MeetingImpl=r.Meeting=r.ParticipantChangedReason=r.User=r.Participant=r.ConversationTranscriber=r.ConversationTranslator=r.ConversationTranslationResult=r.ConversationTranslationEventArgs=r.ConversationTranslationCanceledEventArgs=r.ConversationParticipantsChangedEventArgs=r.ConversationExpirationEventArgs=r.ConversationCommon=r.ConversationImpl=r.Conversation=void 0;var e=z_();Object.defineProperty(r,"Conversation",{enumerable:!0,get:function(){return e.Conversation}}),Object.defineProperty(r,"ConversationImpl",{enumerable:!0,get:function(){return e.ConversationImpl}});var t=cz();Object.defineProperty(r,"ConversationCommon",{enumerable:!0,get:function(){return t.ConversationCommon}});var n=uz();Object.defineProperty(r,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return n.ConversationExpirationEventArgs}});var i=dz();Object.defineProperty(r,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return i.ConversationParticipantsChangedEventArgs}});var s=hz();Object.defineProperty(r,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return s.ConversationTranslationCanceledEventArgs}});var o=pz();Object.defineProperty(r,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return o.ConversationTranslationEventArgs}});var a=fz();Object.defineProperty(r,"ConversationTranslationResult",{enumerable:!0,get:function(){return a.ConversationTranslationResult}});var l=gz();Object.defineProperty(r,"ConversationTranslator",{enumerable:!0,get:function(){return l.ConversationTranslator}});var u=vz();Object.defineProperty(r,"ConversationTranscriber",{enumerable:!0,get:function(){return u.ConversationTranscriber}});var h=Sz();Object.defineProperty(r,"Participant",{enumerable:!0,get:function(){return h.Participant}}),Object.defineProperty(r,"User",{enumerable:!0,get:function(){return h.User}});var m=yz();Object.defineProperty(r,"ParticipantChangedReason",{enumerable:!0,get:function(){return m.ParticipantChangedReason}});var g=Cz();Object.defineProperty(r,"Meeting",{enumerable:!0,get:function(){return g.Meeting}}),Object.defineProperty(r,"MeetingImpl",{enumerable:!0,get:function(){return g.MeetingImpl}});var v=Az();Object.defineProperty(r,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return v.MeetingTranscriptionCanceledEventArgs}});var y=bz();Object.defineProperty(r,"MeetingTranscriber",{enumerable:!0,get:function(){return y.MeetingTranscriber}});var A=xz();Object.defineProperty(r,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return A.ConversationTranscriptionResult}})})(Zx)),Zx}var tc={},_M;function NP(){if(_M)return tc;_M=1,Object.defineProperty(tc,"__esModule",{value:!0}),tc.SynthesisRequest=tc.Synthesizer=void 0;const r=Oe(),e=We(),t=rt(),n=xe();let i=class Z_{constructor(a){const l=a;t.Contracts.throwIfNull(l,"speechConfig"),this.privProperties=l.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new e.Queue,this.tokenCredential=a.tokenCredential}get authorizationToken(){return this.properties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,a)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(n.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===r.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(a){const l={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let u=this.properties.getProperty(n.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),h=this.properties.getProperty(n.PropertyId.SpeechServiceConnection_SynthVoice,""),m=Z_.XMLEncode(a);return this.autoDetectSourceLanguage?u="en-US":h=h||l[u],h&&(m=`<voice name='${h}'>${m}</voice>`),m=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${u}'>${m}</speak>`,m}async dispose(a){this.privDisposed||(a&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const a=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(a.text,a.isSSML,a.requestId,a.cb,a.err,a.dataStream)}}createSynthesizerConfig(a){return new r.SynthesizerConfig(a,this.privProperties)}implCommonSynthesizeSetup(){let a=typeof window<"u"?"Browser":"Node",l="unknown",u="unknown";typeof navigator<"u"&&(a=a+"/"+navigator.platform,l=navigator.userAgent,u=navigator.appVersion);const h=this.createSynthesizerConfig(new r.SpeechServiceConfig(new r.Context(new r.OS(a,l,u)))),m=this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_Key,void 0),g=m&&m!==""?new r.CognitiveSubscriptionKeyAuthentication(m):this.tokenCredential?new r.CognitiveTokenAuthentication(async()=>{try{const v=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(v==null?void 0:v.token)??""}catch(v){throw v}},async()=>{try{const v=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(v==null?void 0:v.token)??""}catch(v){throw v}}):new r.CognitiveTokenAuthentication(()=>{const v=this.privProperties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(v)},()=>{const v=this.privProperties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(v)});this.privAdapter=this.createSynthesisAdapter(g,this.privConnectionFactory,h),this.privRestAdapter=this.createRestSynthesisAdapter(g,h)}static XMLEncode(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};tc.Synthesizer=i;class s{constructor(a,l,u,h,m,g){this.requestId=a,this.text=l,this.isSSML=u,this.cb=h,this.err=m,this.dataStream=g}}return tc.SynthesisRequest=s,tc}var bm={},OM;function Tz(){if(OM)return bm;OM=1,Object.defineProperty(bm,"__esModule",{value:!0}),bm.SpeechSynthesizer=void 0;const r=Oe(),e=We(),t=C_(),n=sy(),i=Xh(),s=rt(),o=xe(),a=NP();let l=class $_ extends o.Synthesizer{constructor(h,m){super(h),m!==null&&(m===void 0?this.audioConfig=typeof window>"u"?void 0:o.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=m),this.privConnectionFactory=new r.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(h,m,g){const v=h;return m.properties.mergeTo(v.properties),new $_(h,g)}speakTextAsync(h,m,g,v){this.speakImpl(h,!1,m,g,v)}speakSsmlAsync(h,m,g,v){this.speakImpl(h,!0,m,g,v)}async getVoicesAsync(h=""){return this.getVoices(h)}close(h,m){s.Contracts.throwIfDisposed(this.privDisposed),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),h,m)}get internalData(){return this.privAdapter}createSynthesisAdapter(h,m,g){return new r.SpeechSynthesisAdapter(h,m,g,this,this.audioConfig)}createRestSynthesisAdapter(h,m){return new r.SynthesisRestAdapter(m,h)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=n.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(o.SpeechSynthesisOutputFormat[this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(h,m,g,v,y){try{s.Contracts.throwIfDisposed(this.privDisposed);const A=(0,e.createNoDashGuid)();let x;y instanceof o.PushAudioOutputStreamCallback?x=new i.PushAudioOutputStreamImpl(y):y instanceof o.PullAudioOutputStream?x=y:y!==void 0?x=new t.AudioFileWriter(y):x=void 0,this.synthesisRequestQueue.enqueue(new a.SynthesisRequest(A,h,m,b=>{if(this.privSynthesizing=!1,g)try{g(b)}catch(w){v&&v(w)}g=void 0,this.adapterSpeak().catch(()=>{})},b=>{v&&v(b)},x)),this.adapterSpeak().catch(()=>{})}catch(A){if(v)if(A instanceof Error){const x=A;v(x.name+": "+x.message)}else v(A);this.dispose(!0).catch(()=>{})}}async getVoices(h){const m=(0,e.createNoDashGuid)(),g=await this.privRestAdapter.getVoicesList(m);if(g.ok&&Array.isArray(g.json)){let v=g.json;return h&&h.length>0&&(v=v.filter(y=>!!y.Locale&&y.Locale.toLowerCase()===h.toLowerCase())),new o.SynthesisVoicesResult(m,v,void 0)}else return new o.SynthesisVoicesResult(m,void 0,`Error: ${g.status}: ${g.statusText}`)}};return bm.SpeechSynthesizer=l,bm}var xm={},DM;function wz(){if(DM)return xm;DM=1,Object.defineProperty(xm,"__esModule",{value:!0}),xm.SynthesisResult=void 0;let r=class{constructor(t,n,i,s){this.privResultId=t,this.privReason=n,this.privErrorDetails=i,this.privProperties=s}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};return xm.SynthesisResult=r,xm}var Tm={},jM;function Pz(){if(jM)return Tm;jM=1,Object.defineProperty(Tm,"__esModule",{value:!0}),Tm.SpeechSynthesisResult=void 0;const r=xe();let e=class extends r.SynthesisResult{constructor(n,i,s,o,a,l){super(n,i,o,a),this.privAudioData=s,this.privAudioDuration=l}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};return Tm.SpeechSynthesisResult=e,Tm}var wm={},BM;function Ez(){if(BM)return wm;BM=1,Object.defineProperty(wm,"__esModule",{value:!0}),wm.SpeechSynthesisEventArgs=void 0;let r=class{constructor(t){this.privResult=t}get result(){return this.privResult}};return wm.SpeechSynthesisEventArgs=r,wm}var Pm={},zM;function Rz(){if(zM)return Pm;zM=1,Object.defineProperty(Pm,"__esModule",{value:!0}),Pm.SpeechSynthesisWordBoundaryEventArgs=void 0;let r=class{constructor(t,n,i,s,o,a){this.privAudioOffset=t,this.privDuration=n,this.privText=i,this.privWordLength=s,this.privTextOffset=o,this.privBoundaryType=a}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};return Pm.SpeechSynthesisWordBoundaryEventArgs=r,Pm}var Em={},FM;function Iz(){if(FM)return Em;FM=1,Object.defineProperty(Em,"__esModule",{value:!0}),Em.SpeechSynthesisBookmarkEventArgs=void 0;let r=class{constructor(t,n){this.privAudioOffset=t,this.privText=n}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};return Em.SpeechSynthesisBookmarkEventArgs=r,Em}var Rm={},WM;function kz(){if(WM)return Rm;WM=1,Object.defineProperty(Rm,"__esModule",{value:!0}),Rm.SpeechSynthesisVisemeEventArgs=void 0;let r=class{constructor(t,n,i){this.privAudioOffset=t,this.privVisemeId=n,this.privAnimation=i}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};return Rm.SpeechSynthesisVisemeEventArgs=r,Rm}var Vx={},UM;function Mz(){return UM||(UM=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SpeechSynthesisBoundaryType=void 0,(function(e){e.Word="WordBoundary",e.Punctuation="PunctuationBoundary",e.Sentence="SentenceBoundary"})(r.SpeechSynthesisBoundaryType||(r.SpeechSynthesisBoundaryType={}))})(Vx)),Vx}var Im={},ZM;function Nz(){if(ZM)return Im;ZM=1,Object.defineProperty(Im,"__esModule",{value:!0}),Im.SynthesisVoicesResult=void 0;const r=xe();let e=class extends r.SynthesisResult{constructor(n,i,s){if(Array.isArray(i)){super(n,r.ResultReason.VoicesListRetrieved,void 0,new r.PropertyCollection),this.privVoices=[];for(const o of i)this.privVoices.push(new r.VoiceInfo(o))}else super(n,r.ResultReason.Canceled,s||"Error information unavailable",new r.PropertyCollection)}get voices(){return this.privVoices}};return Im.SynthesisVoicesResult=e,Im}var qx={},$M;function Lz(){return $M||($M=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.VoiceInfo=r.SynthesisVoiceType=r.SynthesisVoiceGender=void 0;var e;(function(o){o[o.Unknown=0]="Unknown",o[o.Female=1]="Female",o[o.Male=2]="Male",o[o.Neutral=3]="Neutral"})(e=r.SynthesisVoiceGender||(r.SynthesisVoiceGender={}));var t;(function(o){o[o.Unknown=0]="Unknown",o[o.OnlineNeural=1]="OnlineNeural",o[o.OnlineStandard=2]="OnlineStandard",o[o.OfflineNeural=3]="OfflineNeural",o[o.OfflineStandard=4]="OfflineStandard",o[o.OnlineNeuralHD=5]="OnlineNeuralHD"})(t=r.SynthesisVoiceType||(r.SynthesisVoiceType={}));const n={[e[e.Neutral]]:e.Neutral,[e[e.Male]]:e.Male,[e[e.Female]]:e.Female},i={Neural:t.OnlineNeural,NeuralHD:t.OnlineNeuralHD};class s{constructor(a){if(this.privStyleList=[],a){if(this.privName=a.Name,this.privLocale=a.Locale,this.privShortName=a.ShortName,this.privLocaleName=a.LocaleName,this.privDisplayName=a.DisplayName,this.privLocalName=a.LocalName,this.privVoiceType=i[a.VoiceType]||t.Unknown,this.privGender=n[a.Gender]||e.Unknown,a.StyleList&&Array.isArray(a.StyleList))for(const l of a.StyleList)this.privStyleList.push(l);this.privSampleRateHertz=a.SampleRateHertz,this.privStatus=a.Status,a.ExtendedPropertyMap&&(this.privExtendedPropertyMap=a.ExtendedPropertyMap),this.privWordsPerMinute=a.WordsPerMinute,Array.isArray(a.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...a.SecondaryLocaleList]),Array.isArray(a.RolePlayList)&&(this.privRolePlayList=[...a.RolePlayList]),a.VoiceTag&&(this.privVoiceTag=a.VoiceTag)}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}get voiceTag(){return this.privVoiceTag}}r.VoiceInfo=s})(qx)),qx}var km={},HM;function _z(){if(HM)return km;HM=1,Object.defineProperty(km,"__esModule",{value:!0}),km.SpeakerAudioDestination=void 0;const r=We(),e=Xh(),t=Lu(),n=1800,i={[t.AudioFormatTag.PCM]:"audio/wav",[t.AudioFormatTag.MuLaw]:"audio/x-wav",[t.AudioFormatTag.MP3]:"audio/mpeg",[t.AudioFormatTag.OGG_OPUS]:"audio/ogg",[t.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[t.AudioFormatTag.ALaw]:"audio/x-wav",[t.AudioFormatTag.FLAC]:"audio/flac",[t.AudioFormatTag.AMR_WB]:"audio/amr-wb",[t.AudioFormatTag.G722]:"audio/G722"};let s=class{constructor(a){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=a||(0,r.createNoDashGuid)(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(a,l,u){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(a),this.updateSourceBuffer().then(()=>{l&&l()},h=>{u&&u(h)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(a),this.privBytesReceived+=a.byteLength)}close(a,l){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{a&&a()},u=>{l&&l(u)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===t.AudioFormatTag.PCM||this.privFormat.formatTag===t.AudioFormatTag.MuLaw||this.privFormat.formatTag===t.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let u=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(u).then(()=>{u=this.privFormat.addHeader(u);const h=new Blob([u],{type:i[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(h),this.notifyPlayback().then(()=>{a&&a()},m=>{l&&l(m)})},h=>{l&&l(h)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(a){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=a;const l=i[this.privFormat.formatTag];l===void 0?console.warn(`Unknown mimeType for format ${t.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(l)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=n,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(l),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(u=>{r.Events.instance.onEvent(new r.BackgroundEvent(u))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(u=>{r.Events.instance.onEvent(new r.BackgroundEvent(u))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(u=>{r.Events.instance.onEvent(new r.BackgroundEvent(u))})):(console.warn(`Format ${t.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new e.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var a;return((a=this.privAudio)==null?void 0:a.volume)??-1}set volume(a){this.privAudio&&(this.privAudio.volume=a)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(a,l){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{a&&a()},u=>{l&&l(u)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const a=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(a)}catch{this.privAudioBuffer.unshift(a),console.log("buffer filled, pausing addition of binaries until space is made");return}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};return km.SpeakerAudioDestination=s,km}var Mm={},VM;function Oz(){if(VM)return Mm;VM=1,Object.defineProperty(Mm,"__esModule",{value:!0}),Mm.ConversationTranscriptionCanceledEventArgs=void 0;const r=oy();let e=class extends r.CancellationEventArgsBase{};return Mm.ConversationTranscriptionCanceledEventArgs=e,Mm}var Nm={},qM;function Dz(){if(qM)return Nm;qM=1,Object.defineProperty(Nm,"__esModule",{value:!0}),Nm.MeetingTranscriptionCanceledEventArgs=void 0;const r=oy();let e=class extends r.CancellationEventArgsBase{};return Nm.MeetingTranscriptionCanceledEventArgs=e,Nm}var Gx={},GM;function jz(){return GM||(GM=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.PronunciationAssessmentGradingSystem=void 0,(function(e){e[e.FivePoint=1]="FivePoint",e[e.HundredMark=2]="HundredMark"})(r.PronunciationAssessmentGradingSystem||(r.PronunciationAssessmentGradingSystem={}))})(Gx)),Gx}var Kx={},KM;function Bz(){return KM||(KM=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.PronunciationAssessmentGranularity=void 0,(function(e){e[e.Phoneme=1]="Phoneme",e[e.Word=2]="Word",e[e.FullText=3]="FullText"})(r.PronunciationAssessmentGranularity||(r.PronunciationAssessmentGranularity={}))})(Kx)),Kx}var Lm={},YM;function zz(){if(YM)return Lm;YM=1,Object.defineProperty(Lm,"__esModule",{value:!0}),Lm.PronunciationAssessmentConfig=void 0;const r=rt(),e=xe();let t=class H_{constructor(i,s=e.PronunciationAssessmentGradingSystem.FivePoint,o=e.PronunciationAssessmentGranularity.Phoneme,a=!1){r.Contracts.throwIfNullOrUndefined(i,"referenceText"),this.privProperties=new e.PropertyCollection,this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_ReferenceText,i),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_GradingSystem,e.PronunciationAssessmentGradingSystem[s]),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_Granularity,e.PronunciationAssessmentGranularity[o]),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,String(a))}static fromJSON(i){r.Contracts.throwIfNullOrUndefined(i,"json");const s=new H_("");return s.privProperties=new e.PropertyCollection,s.properties.setProperty(e.PropertyId.PronunciationAssessment_Json,i),s}toJSON(){return this.updateJson(),this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Params)}applyTo(i){this.updateJson();const s=i.internalData;s.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(e.PropertyId.PronunciationAssessment_Params),s.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(e.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(i){r.Contracts.throwIfNullOrWhitespace(i,"referenceText"),this.properties.setProperty(e.PropertyId.PronunciationAssessment_ReferenceText,i)}set phonemeAlphabet(i){r.Contracts.throwIfNullOrWhitespace(i,"phonemeAlphabet"),this.privPhonemeAlphabet=i}set enableMiscue(i){const s=i?"true":"false";this.properties.setProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,s)}get enableMiscue(){return this.properties.getProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(i){this.privNBestPhonemeCount=i}set enableProsodyAssessment(i){this.privEnableProsodyAssessment=i}get properties(){return this.privProperties}updateJson(){const i=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Json,"{}"),s=JSON.parse(i),o=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_ReferenceText);o&&(s.referenceText=o);const a=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_GradingSystem);a&&(s.gradingSystem=a);const l=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Granularity);l&&(s.granularity=l),this.privPhonemeAlphabet&&(s.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(s.nbestPhonemeCount=this.privNBestPhonemeCount),s.enableProsodyAssessment=this.privEnableProsodyAssessment,s.dimension="Comprehensive",this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_EnableMiscue)&&(s.enableMiscue=this.enableMiscue),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_Params,JSON.stringify(s))}};return Lm.PronunciationAssessmentConfig=t,Lm}var _m={},XM;function Fz(){if(XM)return _m;XM=1,Object.defineProperty(_m,"__esModule",{value:!0}),_m.PronunciationAssessmentResult=void 0;const r=rt(),e=xe();let t=class V_{constructor(i){const s=JSON.parse(i);r.Contracts.throwIfNullOrUndefined(s.NBest[0],"NBest"),this.privPronJson=s.NBest[0]}static fromResult(i){r.Contracts.throwIfNullOrUndefined(i,"result");const s=i.properties.getProperty(e.PropertyId.SpeechServiceResponse_JsonResult);return r.Contracts.throwIfNullOrUndefined(s,"json"),new V_(s)}get detailResult(){return this.privPronJson}get accuracyScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.AccuracyScore}get pronunciationScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.PronScore}get completenessScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.CompletenessScore}get fluencyScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.FluencyScore}get prosodyScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.ProsodyScore}};return _m.PronunciationAssessmentResult=t,_m}var Om={},JM;function Wz(){if(JM)return Om;JM=1,Object.defineProperty(Om,"__esModule",{value:!0}),Om.AvatarConfig=void 0;const r=rt(),e=xe();let t=class{constructor(i,s,o){this.privCustomized=!1,this.privUseBuiltInVoice=!1,r.Contracts.throwIfNullOrWhitespace(i,"character"),this.character=i,this.style=s,o===void 0&&(o=new e.AvatarVideoFormat),this.videoFormat=o}get customized(){return this.privCustomized}set customized(i){this.privCustomized=i}get useBuiltInVoice(){return this.privUseBuiltInVoice}set useBuiltInVoice(i){this.privUseBuiltInVoice=i}get photoAvatarBaseModel(){return this.privPhotoAvatarBaseModel}set photoAvatarBaseModel(i){this.privPhotoAvatarBaseModel=i}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(i){this.privBackgroundColor=i}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(i){this.privBackgroundImage=i}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(i){this.privRemoteIceServers=i}};return Om.AvatarConfig=t,Om}var Yx={},QM;function Uz(){return QM||(QM=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.AvatarEventArgs=r.AvatarEventTypes=void 0,(function(t){t.SwitchedToSpeaking="SwitchedToSpeaking",t.SwitchedToIdle="SwitchedToIdle",t.SessionClosed="SessionClosed"})(r.AvatarEventTypes||(r.AvatarEventTypes={}));class e{constructor(n,i){this.privOffset=n,this.privDescription=i}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}r.AvatarEventArgs=e})(Yx)),Yx}var Dm={},jm={},eN;function q_(){if(eN)return jm;eN=1,Object.defineProperty(jm,"__esModule",{value:!0}),jm.SpeechSynthesisConnectionFactory=void 0;const r=In(),e=xe(),t=Jo(),n=Oe(),i=ai(),s=wl();let o=class{constructor(){this.synthesisUri="/tts/cognitiveservices/websocket/v1"}async create(l,u,h){let m=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const g=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,void 0),v=t.ConnectionFactoryBase.getHostSuffix(g),y=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),A=y===void 0?"tts":"voice",x=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,"wss://"+g+"."+A+".speech"+v),b={},w={};if(u.token!==void 0&&u.token!==""&&(w[u.headerName]=u.token),w[i.HeaderNames.ConnectionId]=h,y!==void 0&&y!==""&&(!m||m.search(s.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(b[s.QueryParameterNames.CustomVoiceDeploymentId]=y),l.avatarEnabled&&(!m||m.search(s.QueryParameterNames.EnableAvatar)===-1)&&(b[s.QueryParameterNames.EnableAvatar]="true"),m){const k=new URL(m),I=k.pathname;(I===""||I==="/")&&(k.pathname=this.synthesisUri,m=await t.ConnectionFactoryBase.getRedirectUrlFromEndpoint(k.toString()))}m||(m=x+this.synthesisUri),l.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,m);const T=l.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new r.WebsocketConnection(m,b,w,new n.WebsocketMessageFormatter,r.ProxyInfo.fromParameters(l.parameters),T,h)}};return jm.SpeechSynthesisConnectionFactory=o,jm}var tN;function Zz(){if(tN)return Dm;tN=1,Object.defineProperty(Dm,"__esModule",{value:!0}),Dm.AvatarSynthesizer=void 0;const r=q_(),e=Oe(),t=We(),n=sy(),i=xe(),s=rt(),o=NP();let a=class extends i.Synthesizer{constructor(u,h){super(u),s.Contracts.throwIfNullOrUndefined(h,"avatarConfig"),this.privConnectionFactory=new r.SpeechSynthesisConnectionFactory,this.privAvatarConfig=h,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=n.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(i.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(u){s.Contracts.throwIfNullOrUndefined(u,"peerConnection"),this.privIceServers=u.getConfiguration().iceServers,s.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const h=new t.Deferred;u.onicegatheringstatechange=()=>{t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice gathering state: "+u.iceGatheringState,t.EventType.Debug)),u.iceGatheringState==="complete"&&(t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice gathering complete.",t.EventType.Info)),h.resolve())},u.onicecandidate=A=>{A.candidate?t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice candidate: "+A.candidate.candidate,t.EventType.Debug)):(t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice candidate: complete",t.EventType.Debug)),h.resolve())},setTimeout(()=>{u.iceGatheringState!=="complete"&&(t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice gathering timeout.",t.EventType.Warning)),h.resolve())},2e3);const m=await u.createOffer();await u.setLocalDescription(m),await h.promise,t.Events.instance.onEvent(new t.PlatformEvent("peer connection: got local SDP.",t.EventType.Info)),this.privProperties.setProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(u.localDescription));const g=await this.speak("",!1);if(g.reason!==i.ResultReason.SynthesizingAudioCompleted)return new i.SynthesisResult(g.resultId,g.reason,g.errorDetails,g.properties);const v=atob(g.properties.getProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP)),y=new RTCSessionDescription(JSON.parse(v));return await u.setRemoteDescription(y),new i.SynthesisResult(g.resultId,g.reason,void 0,g.properties)}async speakTextAsync(u){const h=await this.speak(u,!1);return new i.SynthesisResult(h.resultId,h.reason,h.errorDetails,h.properties)}async speakSsmlAsync(u){const h=await this.speak(u,!0);return new i.SynthesisResult(h.resultId,h.reason,h.errorDetails,h.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return s.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(u,h,m){return new e.AvatarSynthesisAdapter(u,h,m,this,this.privAvatarConfig)}createRestSynthesisAdapter(u,h){}createSynthesizerConfig(u){const h=super.createSynthesizerConfig(u);return h.avatarEnabled=!0,h}async speak(u,h){const m=(0,t.createNoDashGuid)(),g=new t.Deferred;return this.synthesisRequestQueue.enqueue(new o.SynthesisRequest(m,u,h,v=>{g.resolve(v),this.privSynthesizing=!1,this.adapterSpeak()},v=>{g.reject(v),this.privSynthesizing=!1})),this.adapterSpeak(),g.promise}};return Dm.AvatarSynthesizer=a,Dm}var rc={},rN;function $z(){if(rN)return rc;rN=1,Object.defineProperty(rc,"__esModule",{value:!0}),rc.AvatarVideoFormat=rc.Coordinate=void 0;class r{constructor(n,i){this.x=n,this.y=i}}rc.Coordinate=r;let e=class{constructor(n="H264",i=2e6,s=1920,o=1080){this.codec=n,this.bitrate=i,this.width=s,this.height=o}setCropRange(n,i){this.cropRange={bottomRight:i,topLeft:n}}};return rc.AvatarVideoFormat=e,rc}var Bm={},nN;function Hz(){if(nN)return Bm;nN=1,Object.defineProperty(Bm,"__esModule",{value:!0}),Bm.AvatarWebRTCConnectionResult=void 0;const r=xe();let e=class extends r.SynthesisResult{constructor(n,i,s,o,a){super(i,s,o,a),this.privSDPAnswer=n}get SDPAnswer(){return this.privSDPAnswer}};return Bm.AvatarWebRTCConnectionResult=e,Bm}var zm={},iN;function Vz(){if(iN)return zm;iN=1,Object.defineProperty(zm,"__esModule",{value:!0}),zm.Diagnostics=void 0;const r=In(),e=We();let t=class{static SetLoggingLevel(i){this.privListener=new r.ConsoleLoggingListener(i),e.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(i){if(typeof window>"u")this.privListener&&(this.privListener.logPath=i);else throw new Error("File system logging not available in browser.")}static set onLogOutput(i){this.privListener&&(this.privListener.logCallback=i)}};return zm.Diagnostics=t,t.privListener=void 0,zm}var sN;function xe(){return sN||(sN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.CustomCommandsConfig=r.BotFrameworkConfig=r.DialogServiceConfig=r.PhraseListGrammar=r.Connection=r.ServiceEventArgs=r.ConnectionEventArgs=r.CancellationErrorCode=r.CancellationDetails=r.CancellationDetailsBase=r.TranslationRecognitionCanceledEventArgs=r.NoMatchDetails=r.NoMatchReason=r.Translations=r.TranslationRecognizer=r.SpeechRecognizer=r.Recognizer=r.PropertyId=r.PropertyCollection=r.SpeechTranslationConfigImpl=r.SpeechTranslationConfig=r.SpeechConfigImpl=r.SpeechConfig=r.ResultReason=r.TranslationSynthesisResult=r.TranslationRecognitionResult=r.TranslationSynthesisEventArgs=r.TranslationRecognitionEventArgs=r.SpeechRecognitionCanceledEventArgs=r.MeetingTranscriptionEventArgs=r.ConversationTranscriptionEventArgs=r.SpeechRecognitionEventArgs=r.SpeechRecognitionResult=r.RecognitionResult=r.OutputFormat=r.RecognitionEventArgs=r.SessionEventArgs=r.KeywordRecognitionModel=r.PushAudioOutputStreamCallback=r.PullAudioInputStreamCallback=r.CancellationReason=r.PushAudioOutputStream=r.PullAudioOutputStream=r.AudioOutputStream=r.PushAudioInputStream=r.PullAudioInputStream=r.AudioInputStream=r.AudioFormatTag=r.AudioStreamFormat=r.AudioConfig=void 0,r.AvatarSynthesizer=r.AvatarEventArgs=r.AvatarConfig=r.LanguageIdMode=r.PronunciationAssessmentResult=r.PronunciationAssessmentConfig=r.PronunciationAssessmentGranularity=r.PronunciationAssessmentGradingSystem=r.MeetingTranscriptionCanceledEventArgs=r.ConversationTranscriptionCanceledEventArgs=r.SpeakerAudioDestination=r.VoiceInfo=r.SynthesisVoiceType=r.SynthesisVoiceGender=r.SynthesisVoicesResult=r.SpeechSynthesisBoundaryType=r.SpeechSynthesisVisemeEventArgs=r.SpeechSynthesisBookmarkEventArgs=r.SpeechSynthesisWordBoundaryEventArgs=r.SpeechSynthesisEventArgs=r.SpeechSynthesisResult=r.SynthesisResult=r.SpeechSynthesizer=r.SpeechSynthesisOutputFormat=r.Synthesizer=r.User=r.ParticipantChangedReason=r.Participant=r.MeetingTranscriber=r.Meeting=r.ConversationTranscriptionResult=r.ConversationTranscriber=r.ConversationTranslator=r.ConversationTranslationResult=r.ConversationTranslationEventArgs=r.ConversationTranslationCanceledEventArgs=r.ConversationParticipantsChangedEventArgs=r.ConversationExpirationEventArgs=r.Conversation=r.SourceLanguageConfig=r.AutoDetectSourceLanguageResult=r.AutoDetectSourceLanguageConfig=r.ConnectionMessage=r.ConnectionMessageEventArgs=r.BaseAudioPlayer=r.ProfanityOption=r.ServicePropertyChannel=r.TurnStatusReceivedEventArgs=r.ActivityReceivedEventArgs=r.DialogServiceConnector=void 0,r.LogLevel=r.Diagnostics=r.AvatarWebRTCConnectionResult=r.Coordinate=r.AvatarVideoFormat=void 0;var e=y5();Object.defineProperty(r,"AudioConfig",{enumerable:!0,get:function(){return e.AudioConfig}});var t=Lu();Object.defineProperty(r,"AudioStreamFormat",{enumerable:!0,get:function(){return t.AudioStreamFormat}}),Object.defineProperty(r,"AudioFormatTag",{enumerable:!0,get:function(){return t.AudioFormatTag}});var n=A_();Object.defineProperty(r,"AudioInputStream",{enumerable:!0,get:function(){return n.AudioInputStream}}),Object.defineProperty(r,"PullAudioInputStream",{enumerable:!0,get:function(){return n.PullAudioInputStream}}),Object.defineProperty(r,"PushAudioInputStream",{enumerable:!0,get:function(){return n.PushAudioInputStream}});var i=Xh();Object.defineProperty(r,"AudioOutputStream",{enumerable:!0,get:function(){return i.AudioOutputStream}}),Object.defineProperty(r,"PullAudioOutputStream",{enumerable:!0,get:function(){return i.PullAudioOutputStream}}),Object.defineProperty(r,"PushAudioOutputStream",{enumerable:!0,get:function(){return i.PushAudioOutputStream}});var s=C5();Object.defineProperty(r,"CancellationReason",{enumerable:!0,get:function(){return s.CancellationReason}});var o=A5();Object.defineProperty(r,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return o.PullAudioInputStreamCallback}});var a=b5();Object.defineProperty(r,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return a.PushAudioOutputStreamCallback}});var l=x5();Object.defineProperty(r,"KeywordRecognitionModel",{enumerable:!0,get:function(){return l.KeywordRecognitionModel}});var u=T5();Object.defineProperty(r,"SessionEventArgs",{enumerable:!0,get:function(){return u.SessionEventArgs}});var h=w5();Object.defineProperty(r,"RecognitionEventArgs",{enumerable:!0,get:function(){return h.RecognitionEventArgs}});var m=P5();Object.defineProperty(r,"OutputFormat",{enumerable:!0,get:function(){return m.OutputFormat}});var g=E5();Object.defineProperty(r,"RecognitionResult",{enumerable:!0,get:function(){return g.RecognitionResult}});var v=R5();Object.defineProperty(r,"SpeechRecognitionResult",{enumerable:!0,get:function(){return v.SpeechRecognitionResult}});var y=I5();Object.defineProperty(r,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return y.SpeechRecognitionEventArgs}}),Object.defineProperty(r,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return y.ConversationTranscriptionEventArgs}}),Object.defineProperty(r,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return y.MeetingTranscriptionEventArgs}});var A=k5();Object.defineProperty(r,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return A.SpeechRecognitionCanceledEventArgs}});var x=M5();Object.defineProperty(r,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return x.TranslationRecognitionEventArgs}});var b=N5();Object.defineProperty(r,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return b.TranslationSynthesisEventArgs}});var w=w_();Object.defineProperty(r,"TranslationRecognitionResult",{enumerable:!0,get:function(){return w.TranslationRecognitionResult}});var T=L5();Object.defineProperty(r,"TranslationSynthesisResult",{enumerable:!0,get:function(){return T.TranslationSynthesisResult}});var k=_5();Object.defineProperty(r,"ResultReason",{enumerable:!0,get:function(){return k.ResultReason}});var I=O5();Object.defineProperty(r,"SpeechConfig",{enumerable:!0,get:function(){return I.SpeechConfig}}),Object.defineProperty(r,"SpeechConfigImpl",{enumerable:!0,get:function(){return I.SpeechConfigImpl}});var M=D5();Object.defineProperty(r,"SpeechTranslationConfig",{enumerable:!0,get:function(){return M.SpeechTranslationConfig}}),Object.defineProperty(r,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return M.SpeechTranslationConfigImpl}});var L=E_();Object.defineProperty(r,"PropertyCollection",{enumerable:!0,get:function(){return L.PropertyCollection}});var j=IP();Object.defineProperty(r,"PropertyId",{enumerable:!0,get:function(){return j.PropertyId}});var B=j5();Object.defineProperty(r,"Recognizer",{enumerable:!0,get:function(){return B.Recognizer}});var z=B5();Object.defineProperty(r,"SpeechRecognizer",{enumerable:!0,get:function(){return z.SpeechRecognizer}});var Z=z5();Object.defineProperty(r,"TranslationRecognizer",{enumerable:!0,get:function(){return Z.TranslationRecognizer}});var $=F5();Object.defineProperty(r,"Translations",{enumerable:!0,get:function(){return $.Translations}});var U=W5();Object.defineProperty(r,"NoMatchReason",{enumerable:!0,get:function(){return U.NoMatchReason}});var Y=U5();Object.defineProperty(r,"NoMatchDetails",{enumerable:!0,get:function(){return Y.NoMatchDetails}});var ee=Z5();Object.defineProperty(r,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return ee.TranslationRecognitionCanceledEventArgs}});var X=__();Object.defineProperty(r,"CancellationDetailsBase",{enumerable:!0,get:function(){return X.CancellationDetailsBase}});var re=$5();Object.defineProperty(r,"CancellationDetails",{enumerable:!0,get:function(){return re.CancellationDetails}});var G=H5();Object.defineProperty(r,"CancellationErrorCode",{enumerable:!0,get:function(){return G.CancellationErrorCode}});var J=V5();Object.defineProperty(r,"ConnectionEventArgs",{enumerable:!0,get:function(){return J.ConnectionEventArgs}});var ne=q5();Object.defineProperty(r,"ServiceEventArgs",{enumerable:!0,get:function(){return ne.ServiceEventArgs}});var W=M_();Object.defineProperty(r,"Connection",{enumerable:!0,get:function(){return W.Connection}});var V=G5();Object.defineProperty(r,"PhraseListGrammar",{enumerable:!0,get:function(){return V.PhraseListGrammar}});var ce=kP();Object.defineProperty(r,"DialogServiceConfig",{enumerable:!0,get:function(){return ce.DialogServiceConfig}});var ue=K5();Object.defineProperty(r,"BotFrameworkConfig",{enumerable:!0,get:function(){return ue.BotFrameworkConfig}});var ve=Y5();Object.defineProperty(r,"CustomCommandsConfig",{enumerable:!0,get:function(){return ve.CustomCommandsConfig}});var se=J5();Object.defineProperty(r,"DialogServiceConnector",{enumerable:!0,get:function(){return se.DialogServiceConnector}});var F=Q5();Object.defineProperty(r,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return F.ActivityReceivedEventArgs}});var te=tz();Object.defineProperty(r,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return te.TurnStatusReceivedEventArgs}});var ge=rz();Object.defineProperty(r,"ServicePropertyChannel",{enumerable:!0,get:function(){return ge.ServicePropertyChannel}});var oe=nz();Object.defineProperty(r,"ProfanityOption",{enumerable:!0,get:function(){return oe.ProfanityOption}});var pe=iz();Object.defineProperty(r,"BaseAudioPlayer",{enumerable:!0,get:function(){return pe.BaseAudioPlayer}});var Be=sz();Object.defineProperty(r,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return Be.ConnectionMessageEventArgs}});var Fe=k_();Object.defineProperty(r,"ConnectionMessage",{enumerable:!0,get:function(){return Fe.ConnectionMessage}});var ye=oz();Object.defineProperty(r,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return ye.AutoDetectSourceLanguageConfig}});var _e=az();Object.defineProperty(r,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return _e.AutoDetectSourceLanguageResult}});var de=lz();Object.defineProperty(r,"SourceLanguageConfig",{enumerable:!0,get:function(){return de.SourceLanguageConfig}});var Ae=MP();Object.defineProperty(r,"Conversation",{enumerable:!0,get:function(){return Ae.Conversation}}),Object.defineProperty(r,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return Ae.ConversationExpirationEventArgs}}),Object.defineProperty(r,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return Ae.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(r,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return Ae.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(r,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return Ae.ConversationTranslationEventArgs}}),Object.defineProperty(r,"ConversationTranslationResult",{enumerable:!0,get:function(){return Ae.ConversationTranslationResult}}),Object.defineProperty(r,"ConversationTranslator",{enumerable:!0,get:function(){return Ae.ConversationTranslator}}),Object.defineProperty(r,"ConversationTranscriber",{enumerable:!0,get:function(){return Ae.ConversationTranscriber}}),Object.defineProperty(r,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return Ae.ConversationTranscriptionResult}}),Object.defineProperty(r,"Meeting",{enumerable:!0,get:function(){return Ae.Meeting}}),Object.defineProperty(r,"MeetingTranscriber",{enumerable:!0,get:function(){return Ae.MeetingTranscriber}}),Object.defineProperty(r,"Participant",{enumerable:!0,get:function(){return Ae.Participant}}),Object.defineProperty(r,"ParticipantChangedReason",{enumerable:!0,get:function(){return Ae.ParticipantChangedReason}}),Object.defineProperty(r,"User",{enumerable:!0,get:function(){return Ae.User}});var nt=NP();Object.defineProperty(r,"Synthesizer",{enumerable:!0,get:function(){return nt.Synthesizer}});var at=b_();Object.defineProperty(r,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return at.SpeechSynthesisOutputFormat}});var be=Tz();Object.defineProperty(r,"SpeechSynthesizer",{enumerable:!0,get:function(){return be.SpeechSynthesizer}});var yt=wz();Object.defineProperty(r,"SynthesisResult",{enumerable:!0,get:function(){return yt.SynthesisResult}});var li=Pz();Object.defineProperty(r,"SpeechSynthesisResult",{enumerable:!0,get:function(){return li.SpeechSynthesisResult}});var ss=Ez();Object.defineProperty(r,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return ss.SpeechSynthesisEventArgs}});var os=Rz();Object.defineProperty(r,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return os.SpeechSynthesisWordBoundaryEventArgs}});var as=Iz();Object.defineProperty(r,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return as.SpeechSynthesisBookmarkEventArgs}});var he=kz();Object.defineProperty(r,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return he.SpeechSynthesisVisemeEventArgs}});var Qe=Mz();Object.defineProperty(r,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return Qe.SpeechSynthesisBoundaryType}});var Ct=Nz();Object.defineProperty(r,"SynthesisVoicesResult",{enumerable:!0,get:function(){return Ct.SynthesisVoicesResult}});var en=Lz();Object.defineProperty(r,"SynthesisVoiceGender",{enumerable:!0,get:function(){return en.SynthesisVoiceGender}}),Object.defineProperty(r,"SynthesisVoiceType",{enumerable:!0,get:function(){return en.SynthesisVoiceType}}),Object.defineProperty(r,"VoiceInfo",{enumerable:!0,get:function(){return en.VoiceInfo}});var ls=_z();Object.defineProperty(r,"SpeakerAudioDestination",{enumerable:!0,get:function(){return ls.SpeakerAudioDestination}});var cs=Oz();Object.defineProperty(r,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return cs.ConversationTranscriptionCanceledEventArgs}});var Du=Dz();Object.defineProperty(r,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return Du.MeetingTranscriptionCanceledEventArgs}});var Pl=jz();Object.defineProperty(r,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return Pl.PronunciationAssessmentGradingSystem}});var El=Bz();Object.defineProperty(r,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return El.PronunciationAssessmentGranularity}});var ju=zz();Object.defineProperty(r,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return ju.PronunciationAssessmentConfig}});var ta=Fz();Object.defineProperty(r,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return ta.PronunciationAssessmentResult}});var ra=j_();Object.defineProperty(r,"LanguageIdMode",{enumerable:!0,get:function(){return ra.LanguageIdMode}});var na=Wz();Object.defineProperty(r,"AvatarConfig",{enumerable:!0,get:function(){return na.AvatarConfig}});var Rl=Uz();Object.defineProperty(r,"AvatarEventArgs",{enumerable:!0,get:function(){return Rl.AvatarEventArgs}});var rp=Zz();Object.defineProperty(r,"AvatarSynthesizer",{enumerable:!0,get:function(){return rp.AvatarSynthesizer}});var Vs=$z();Object.defineProperty(r,"AvatarVideoFormat",{enumerable:!0,get:function(){return Vs.AvatarVideoFormat}}),Object.defineProperty(r,"Coordinate",{enumerable:!0,get:function(){return Vs.Coordinate}});var ia=Hz();Object.defineProperty(r,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return ia.AvatarWebRTCConnectionResult}});var my=Vz();Object.defineProperty(r,"Diagnostics",{enumerable:!0,get:function(){return my.Diagnostics}});var gy=S_();Object.defineProperty(r,"LogLevel",{enumerable:!0,get:function(){return gy.LogLevel}})})(Mx)),Mx}var oN;function qz(){if(oN)return bf;oN=1,Object.defineProperty(bf,"__esModule",{value:!0}),bf.ProxyInfo=void 0;const r=xe();let e=class G_{constructor(n,i,s,o){this.privProxyHostName=n,this.privProxyPort=i,this.privProxyUserName=s,this.privProxyPassword=o}static fromParameters(n){return new G_(n.getProperty(r.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(n.getProperty(r.PropertyId.SpeechServiceConnection_ProxyPort),10),n.getProperty(r.PropertyId.SpeechServiceConnection_ProxyUserName),n.getProperty(r.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(n){return this.fromParameters(n.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};return bf.ProxyInfo=e,bf}var Fm={},Xx,aN;function Gz(){if(aN)return Xx;aN=1;const r=new Set(["json","buffer","string"]);return Xx=e=>(...t)=>{const n=new Set;let i,s,o,a="";return t.forEach(l=>{if(typeof l=="string")if(l.toUpperCase()===l)if(i){const u=`Can't set method to ${l}, already set to ${i}.`;throw new Error(u)}else i=l;else if(l.startsWith("http:")||l.startsWith("https:"))a=l;else if(r.has(l))s=l;else throw new Error(`Unknown encoding, ${l}`);else if(typeof l=="number")n.add(l);else if(typeof l=="object")if(Array.isArray(l)||l instanceof Set)l.forEach(u=>n.add(u));else{if(o)throw new Error("Cannot set headers twice.");o=l}else throw new Error(`Unknown type: ${typeof l}`)}),i||(i="GET"),n.size===0&&n.add(200),e(n,i,s,o,a)},Xx}var Jx,lN;function Kz(){if(lN)return Jx;lN=1;const r=Gz();class e extends Error{constructor(i,...s){super(...s),Error.captureStackTrace&&Error.captureStackTrace(this,e),this.name="StatusError",this.message=i.statusMessage,this.statusCode=i.status,this.res=i,this.json=i.json.bind(i),this.text=i.text.bind(i),this.arrayBuffer=i.arrayBuffer.bind(i);let o;Object.defineProperty(this,"responseBody",{get:()=>(o||(o=this.arrayBuffer()),o)}),this.headers={};for(const[l,u]of i.headers.entries())this.headers[l.toLowerCase()]=u}}return Jx=r((n,i,s,o,a)=>async(l,u,h={})=>{l=a+(l||"");let m=new URL(l);if(o||(o={}),m.username&&(o.Authorization="Basic "+btoa(m.username+":"+m.password),m=new URL(m.protocol+"//"+m.host+m.pathname+m.search)),m.protocol!=="https:"&&m.protocol!=="http:")throw new Error(`Unknown protocol, ${m.protocol}`);if(u&&!(u instanceof ArrayBuffer||ArrayBuffer.isView(u)||typeof u=="string"))if(typeof u=="object")u=JSON.stringify(u),o["Content-Type"]="application/json";else throw new Error("Unknown body type.");h=new Headers({...o||{},...h});const g=await fetch(m,{method:i,headers:h,body:u});if(g.statusCode=g.status,!n.has(g.status))throw new e(g);return s==="json"?g.json():s==="buffer"?g.arrayBuffer():s==="string"?g.text():g}),Jx}var cN;function Yz(){return cN||(cN=1,(function(r){var e=Fm&&Fm.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(r,"__esModule",{value:!0}),r.RestMessageAdapter=r.RestRequestType=void 0;const t=e(Kz()),n=We();var i;(function(o){o.Get="GET",o.Post="POST",o.Delete="DELETE",o.File="file"})(i=r.RestRequestType||(r.RestRequestType={}));let s=class{constructor(a){if(!a)throw new n.ArgumentNullError("configParams");this.privHeaders=a.headers,this.privIgnoreCache=a.ignoreCache}static extractHeaderValue(a,l){let u="";try{const h=l.trim().split(/[\r\n]+/),m={};h.forEach(g=>{const v=g.split(": "),y=v.shift().toLowerCase(),A=v.join(": ");m[y]=A}),u=m[a.toLowerCase()]}catch{}return u}set options(a){this.privHeaders=a.headers,this.privIgnoreCache=a.ignoreCache}setHeaders(a,l){this.privHeaders[a]=l}request(a,l,u={},h=null){const m=new n.Deferred,g=a===i.File?"POST":a,v=(A,x={})=>{const b=A;return{data:JSON.stringify(x),headers:JSON.stringify(A.headers),json:x,ok:A.statusCode>=200&&A.statusCode<300,status:A.statusCode,statusText:x.error?x.error.message:b.statusText?b.statusText:b.statusMessage}},y=A=>{const x=(0,t.default)(l,g,this.privHeaders,200,201,202,204,400,401,402,403,404),b=this.queryParams(u)===""?"":`?${this.queryParams(u)}`;x(b,A).then(async w=>{if(a===i.Delete||w.statusCode===204)m.resolve(v(w));else try{const T=await w.json();m.resolve(v(w,T))}catch{m.resolve(v(w))}}).catch(w=>{m.reject(w)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),a===i.Post&&h&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),y(h),m.promise}queryParams(a={}){return Object.keys(a).map(l=>encodeURIComponent(l)+"="+encodeURIComponent(a[l])).join("&")}};r.RestMessageAdapter=s})(Fm)),Fm}var Wm={},uN;function K_(){if(uN)return Wm;uN=1,Object.defineProperty(Wm,"__esModule",{value:!0}),Wm.RestConfigBase=void 0;let r=class H0{static get requestOptions(){return H0.privDefaultRequestOptions}static get configParams(){return H0.privDefaultParams}static get restErrors(){return H0.privRestErrors}};return Wm.RestConfigBase=r,r.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},r.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},r.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"},Wm}var dN;function In(){return dN||(dN=1,(function(r){var e=ql&&ql.__createBinding||(Object.create?(function(n,i,s,o){o===void 0&&(o=s),Object.defineProperty(n,o,{enumerable:!0,get:function(){return i[s]}})}):(function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]})),t=ql&&ql.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(h5(),r),t(p5(),r),t(f5(),r),t(m5(),r),t(g5(),r),t(v5(),r),t(y_(),r),t(S5(),r),t(qz(),r),t(Yz(),r),t(K_(),r)})(ql)),ql}var Um={},hN;function aA(){if(hN)return Um;hN=1,Object.defineProperty(Um,"__esModule",{value:!0}),Um.SpeechConnectionMessage=void 0;const r=We(),e=ai();class t extends r.ConnectionMessage{constructor(i,s,o,a,l,u,h,m){if(!s)throw new r.ArgumentNullError("path");if(!o)throw new r.ArgumentNullError("requestId");const g={};if(g[e.HeaderNames.Path]=s,g[e.HeaderNames.RequestId]=o,g[e.HeaderNames.RequestTimestamp]=new Date().toISOString(),a&&(g[e.HeaderNames.ContentType]=a),u&&(g[e.HeaderNames.RequestStreamId]=u),h)for(const v in h)v&&(g[v]=h[v]);m?super(i,l,g,m):super(i,l,g),this.privPath=s,this.privRequestId=o,this.privContentType=a,this.privStreamId=u,this.privAdditionalHeaders=h}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(i){let s=null,o=null,a=null,l=null;const u={};if(i.headers)for(const h in i.headers)h&&(h.toLowerCase()===e.HeaderNames.Path.toLowerCase()?s=i.headers[h]:h.toLowerCase()===e.HeaderNames.RequestId.toLowerCase()?o=i.headers[h]:h.toLowerCase()===e.HeaderNames.ContentType.toLowerCase()?a=i.headers[h]:h.toLowerCase()===e.HeaderNames.RequestStreamId.toLowerCase()?l=i.headers[h]:u[h]=i.headers[h]);return new t(i.messageType,s,o,a,i.body,l,u,i.id)}}return Um.SpeechConnectionMessage=t,Um}var Qx={},pN;function Xz(){return pN||(pN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SegmentationMode=void 0,(function(e){e.Normal="Normal",e.Disabled="Disabled",e.Custom="Custom",e.Semantic="Semantic"})(r.SegmentationMode||(r.SegmentationMode={}))})(Qx)),Qx}var eT={},fN;function Jz(){return fN||(fN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.NextAction=void 0,(function(e){e.None="None",e.Synthesize="Synthesize"})(r.NextAction||(r.NextAction={}))})(eT)),eT}var tT={},mN;function Qz(){return mN||(mN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Mode=void 0,(function(e){e.None="None",e.Always="Always"})(r.Mode||(r.Mode={}))})(tT)),tT}var rT={},gN;function e8(){return gN||(gN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.LanguageIdDetectionPriority=r.LanguageIdDetectionMode=void 0,(function(e){e.DetectAtAudioStart="DetectAtAudioStart",e.DetectContinuous="DetectContinuous",e.DetectSegments="DetectSegments"})(r.LanguageIdDetectionMode||(r.LanguageIdDetectionMode={})),(function(e){e.Auto="Auto",e.PrioritizeLatency="PrioritizeLatency",e.PrioritizeAccuracy="PrioritizeAccuracy"})(r.LanguageIdDetectionPriority||(r.LanguageIdDetectionPriority={}))})(rT)),rT}var nT={},vN;function t8(){return vN||(vN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.NextAction=void 0,(function(e){e.Recognize="Recognize",e.None="None"})(r.NextAction||(r.NextAction={}))})(nT)),nT}var iT={},SN;function r8(){return SN||(SN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.OnUnknownAction=void 0,(function(e){e.RecognizeWithDefaultLanguage="RecognizeWithDefaultLanguage",e.None="None"})(r.OnUnknownAction||(r.OnUnknownAction={}))})(iT)),iT}var sT={},yN;function n8(){return yN||(yN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ResultType=void 0,(function(e){e.Auto="Auto",e.StableFragment="StableFragment",e.Hypothesis="Hypothesis",e.None="None"})(r.ResultType||(r.ResultType={}))})(sT)),sT}var oT={},CN;function i8(){return CN||(CN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.PhraseResultOutputType=void 0,(function(e){e.Always="Always",e.None="None"})(r.PhraseResultOutputType||(r.PhraseResultOutputType={}))})(oT)),oT}var aT={},AN;function s8(){return AN||(AN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.NextAction=void 0,(function(e){e.None="None",e.Translate="Translate"})(r.NextAction||(r.NextAction={}))})(aT)),aT}var bN;function o8(){if(bN)return gf;bN=1,Object.defineProperty(gf,"__esModule",{value:!0}),gf.ServiceRecognizerBase=void 0;const r=In(),e=We(),t=xe(),n=Oe(),i=aA(),s=Xz(),o=is(),a=Jz(),l=Qz(),u=e8(),h=t8(),m=r8(),g=n8(),v=i8(),y=s8();let A=class Bg{constructor(b,w,T,k,I){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!b)throw new e.ArgumentNullError("authentication");if(!w)throw new e.ArgumentNullError("connectionFactory");if(!T)throw new e.ArgumentNullError("audioSource");if(!k)throw new e.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=k.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=b,this.privConnectionFactory=w,this.privAudioSource=T,this.privRecognizerConfig=k,this.privIsDisposed=!1,this.privRecognizer=I,this.privRequestSession=new n.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new e.EventSource,this.privServiceEvents=new e.EventSource,this.privDynamicGrammar=new n.DynamicGrammarBuilder,this.privSpeechContext=new n.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new n.AgentConfig,this.privRecognizerConfig.parameters.getProperty(t.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=e.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(L=>{if(L.name==="ConnectionClosedEvent"){const j=L;(j.statusCode===1003||j.statusCode===1007||j.statusCode===1002||j.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(t.CancellationReason.Error,j.statusCode===1007?t.CancellationErrorCode.BadRequestParameters:t.CancellationErrorCode.ConnectionFailure,`${j.reason} websocket error code: ${j.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=(0,e.createNoDashGuid)())}setTranslationJson(){const b=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(b!==void 0){const w=b.split(","),T=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),k=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationCategoryId,void 0),I=T!==void 0?a.NextAction.Synthesize:a.NextAction.None;if(this.privSpeechContext.getContext().translation={onPassthrough:{action:I},onSuccess:{action:I},output:{includePassThroughResults:!0,interimResults:{mode:l.Mode.Always}},targetLanguages:w},k!==void 0&&(this.privSpeechContext.getContext().translation.category=k),T!==void 0){const L={};for(const j of w)L[j]=T;this.privSpeechContext.getContext().synthesis={defaultVoices:L}}const M=this.privSpeechContext.getContext().phraseDetection||{};M.onSuccess={action:y.NextAction.Translate},M.onInterim={action:y.NextAction.Translate},this.privSpeechContext.getContext().phraseDetection=M}}setSpeechSegmentationTimeoutJson(){const b=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0),w=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_SegmentationMaximumTimeMs,void 0),T=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_SegmentationStrategy,void 0),k={mode:s.SegmentationMode.Normal};let I=!1;if(T!==void 0){I=!0;let M=s.SegmentationMode.Normal;switch(T.toLowerCase()){case"default":break;case"time":M=s.SegmentationMode.Custom;break;case"semantic":M=s.SegmentationMode.Semantic;break}k.mode=M}if(b!==void 0){I=!0;const M=parseInt(b,10);k.mode=s.SegmentationMode.Custom,k.segmentationSilenceTimeoutMs=M}if(w!==void 0){I=!0;const M=parseInt(w,10);k.mode=s.SegmentationMode.Custom,k.segmentationForcedTimeoutMs=M}if(I){const M=this.privSpeechContext.getContext().phraseDetection||{};switch(M.mode=this.recognitionMode,this.recognitionMode){case o.RecognitionMode.Conversation:M.conversation=M.conversation??{segmentation:{}},M.conversation.segmentation=k;break;case o.RecognitionMode.Interactive:M.interactive=M.interactive??{segmentation:{}},M.interactive.segmentation=k;break;case o.RecognitionMode.Dictation:M.dictation=M.dictation??{},M.dictation.segmentation=k;break}this.privSpeechContext.getContext().phraseDetection=M}}setLanguageIdJson(){const b=this.privSpeechContext.getContext().phraseDetection||{};if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){const w=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");w.length===1&&w[0]===n.AutoDetectSourceLanguagesOpenRangeOptionName&&(w[0]="UND");let T;this.privRecognizerConfig.languageIdMode==="Continuous"?T=u.LanguageIdDetectionMode.DetectContinuous:T=u.LanguageIdDetectionMode.DetectAtAudioStart,this.privSpeechContext.getContext().languageId={languages:w,mode:T,onSuccess:{action:h.NextAction.Recognize},onUnknown:{action:m.OnUnknownAction.None},priority:u.LanguageIdDetectionPriority.PrioritizeLatency},this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:g.ResultType.Auto},phraseResults:{resultType:v.PhraseResultOutputType.Always}};const k=this.privRecognizerConfig.sourceLanguageModels;k!==void 0&&(b.customModels=k,b.onInterim={action:y.NextAction.None},b.onSuccess={action:y.NextAction.None})}this.privSpeechContext.getContext().phraseDetection=b}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(n.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple]).toLowerCase()===t.OutputFormat[t.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}setSpeechStartEventSensitivityJson(){const b=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_StartEventSensitivity,void 0);if(b!==void 0){let w=!1;switch(b.toLowerCase()){case o.SpeechStartEventSensitivity.Low:case o.SpeechStartEventSensitivity.Medium:case o.SpeechStartEventSensitivity.High:w=!0;break}if(w){const T=this.privSpeechContext.getContext().phraseDetection||{};T.voiceOnsetSensitivity=b.toLowerCase(),this.privSpeechContext.getContext().phraseDetection=T}}}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(b){this.privRecognizerConfig.parameters.setProperty(t.PropertyId.ConversationTranslator_Token,b)}set authentication(b){this.privAuthentication=b}isDisposed(){return this.privIsDisposed}async dispose(b){if(this.privIsDisposed=!0,this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose(b)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(b,w,T){if(this.recognizeOverride!==void 0){await this.recognizeOverride(b,w,T);return}if(this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=b,this.privRecognizerConfig.recognitionEndpointVersion==="2"){const j=this.privSpeechContext.getContext().phraseDetection||{};j.mode=b,this.privSpeechContext.getContext().phraseDetection=j}this.setLanguageIdJson(),this.setTranslationJson(),this.privRecognizerConfig.autoDetectSourceLanguages!==void 0&&this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&this.setupTranslationWithLanguageId(),this.setSpeechSegmentationTimeoutJson(),this.setOutputDetailLevelJson(),this.setSpeechStartEventSensitivityJson(),this.privSuccessCallback=w,this.privErrorCallback=T,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const k=this.connectImpl();let I;try{const j=await this.audioSource.attach(this.privRequestSession.audioNodeId),B=await this.audioSource.format,z=await this.audioSource.deviceInfo;this.privIsLiveAudio=z.type&&z.type===n.type.Microphones,I=new r.ReplayableAudioNode(j,B.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(I,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:z}}catch(j){throw await this.privRequestSession.onStopRecognizing(),j}try{await k}catch(j){await this.cancelRecognitionLocal(t.CancellationReason.Error,t.CancellationErrorCode.ConnectionFailure,j);return}const M=new t.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,M),this.receiveMessage(),this.sendAudio(I).catch(async j=>{await this.cancelRecognitionLocal(t.CancellationReason.Error,t.CancellationErrorCode.RuntimeError,j)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(b,w){this.connectImpl().then(()=>{try{b&&b()}catch(T){w&&w(T)}},T=>{try{w&&w(T)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(t.CancellationReason.Error,t.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(b){}async sendNetworkMessage(b,w){const T=typeof w=="string"?e.MessageType.Text:e.MessageType.Binary,k=typeof w=="string"?"application/json":"";return(await this.fetchConnection()).send(new i.SpeechConnectionMessage(T,b,this.privRequestSession.requestId,k,w))}set activityTemplate(b){this.privActivityTemplate=b}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(b){this.privExpectContentAssessmentResponse=b}async sendTelemetryData(){const b=this.privRequestSession.getTelemetry();if(Bg.telemetryDataEnabled!==!0||this.privIsDisposed||b===null)return;if(Bg.telemetryData)try{Bg.telemetryData(b)}catch{}await(await this.fetchConnection()).send(new i.SpeechConnectionMessage(e.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",b))}async cancelRecognitionLocal(b,w,T){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,b,w,T))}async receiveMessage(){try{if(this.privIsDisposed)return;let b=await this.fetchConnection();const w=await b.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!w)return this.receiveMessage();this.privServiceHasSentMessage=!0;const T=i.SpeechConnectionMessage.fromConnectionMessage(w);if(T.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(T.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const k=n.SpeechDetected.fromJSON(T.textBody,this.privRequestSession.currentTurnAudioOffset),I=new t.RecognitionEventArgs(k.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,I);break;case"speech.enddetected":let M;T.textBody.length>0?M=T.textBody:M="{ Offset: 0 }";const L=n.SpeechDetected.fromJSON(M,this.privRequestSession.currentTurnAudioOffset),j=new t.RecognitionEventArgs(L.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,j);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(t.CancellationReason.EndOfStream,t.CancellationErrorCode.NoError,void 0));const B=new t.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,B);return}else b=await this.fetchConnection(),await this.sendPrePayloadJSON(b);break;default:await this.processTypeSpecificMessages(T)||this.privServiceEvents&&this.serviceEvents.onEvent(new e.ServiceEvent(T.path.toLowerCase(),T.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){const b=this.privRequestSession.recognitionBytesSent,w=this.privAverageBytesPerMs!==0?b/this.privAverageBytesPerMs:0;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(w)}sendSpeechContext(b,w){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const T=this.speechContext.toJSON();if(w&&this.privRequestSession.onSpeechContext(),T)return b.send(new i.SpeechConnectionMessage(e.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",T))}setupTranslationWithLanguageId(){const b=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0),w=this.privRecognizerConfig.autoDetectSourceLanguages!==void 0;if(b!==void 0&&w){this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:g.ResultType.None},phraseResults:{resultType:v.PhraseResultOutputType.None}};const T=this.privSpeechContext.getContext().translation;if(T){const k=this.privRecognizerConfig.sourceLanguageModels;if(k!==void 0&&k.length>0){const M=this.privSpeechContext.getContext().phraseDetection||{};M.customModels=k,this.privSpeechContext.getContext().phraseDetection=M}this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&(T.onSuccess={action:a.NextAction.Synthesize},T.onPassthrough={action:a.NextAction.Synthesize})}}}noOp(){}async sendPrePayloadJSON(b,w=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(b);await this.sendSpeechContext(b,w),await this.sendWaveHeader(b)}async sendWaveHeader(b){const w=await this.audioSource.format;return b.send(new i.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",w.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(b=>b.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(b,w,T){if(w.onSpeechContext(),Bg.telemetryDataEnabled!==!0){const I={context:{system:JSON.parse(T).context.system}};T=JSON.stringify(I)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){const k=JSON.parse(T);k.context.DisableReferenceChannel="True",k.context.MicSpec="1_0_0",T=JSON.stringify(k)}if(T)return b.send(new i.SpeechConnectionMessage(e.MessageType.Text,"speech.config",w.requestId,"application/json",T))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(b=>b.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(b){const w=await this.audioSource.format;this.privAverageBytesPerMs=w.avgBytesPerSec/1e3;let T=Date.now();const k=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),I=w.avgBytesPerSec/1e3*parseInt(k,10),M=this.privRequestSession.recogNumber,L=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===M){const j=await this.fetchConnection(),B=await b.read();if(this.privRequestSession.isSpeechEnded)return;let z,Z;if(!B||B.isEnd?(z=null,Z=0):(z=B.buffer,this.privRequestSession.onAudioSent(z.byteLength),I>=this.privRequestSession.bytesSent?Z=0:Z=Math.max(0,T-Date.now())),Z!==0&&await this.delay(Z),z!==null&&(T=Date.now()+z.byteLength*1e3/(w.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===M)if(j.send(new i.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,null,z)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),B!=null&&B.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return L()}};return L()}async retryableConnect(){let b=!1;this.privAuthFetchEventId=(0,e.createNoDashGuid)();const w=this.privRequestSession.sessionId;this.privConnectionId=w!==void 0?w:(0,e.createNoDashGuid)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let T=0,k="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){this.privRequestSession.onRetryConnection();const M=await(b?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId));await this.privRequestSession.onAuthCompleted(!1);const L=await this.privConnectionFactory.create(this.privRecognizerConfig,M,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(L.events),L.events.attach(B=>{this.connectionEvents.onEvent(B)});const j=await L.open();if(j.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(j.statusCode),Promise.resolve(L);j.statusCode===1006&&(b=!0),T=j.statusCode,k=j.reason}return await this.privRequestSession.onConnectionEstablishCompleted(T,k),Promise.reject(`Unable to contact server. StatusCode: ${T}, ${this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${k}`)}delay(b){return new Promise(w=>this.privSetTimeout(w,b))}writeBufferToConsole(b){let w="Buffer Size: ";if(b===null)w+="null";else{const T=new Uint8Array(b);w+=`${b.byteLength}\r
`;for(let k=0;k<b.byteLength;k++)w+=T[k].toString(16).padStart(2,"0")+" ",(k+1)%16===0&&(console.info(w),w="")}console.info(w)}async sendFinalAudio(){await(await this.fetchConnection()).send(new i.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){const b=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(b):(await this.sendSpeechServiceConfig(b,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(b,!1),b)}};return gf.ServiceRecognizerBase=A,A.telemetryDataEnabled=!0,gf}var Zm={},xN;function a8(){if(xN)return Zm;xN=1,Object.defineProperty(Zm,"__esModule",{value:!0}),Zm.ConversationServiceRecognizer=void 0;const r=xe(),e=Oe();let t=class extends e.ServiceRecognizerBase{constructor(i,s,o,a,l){super(i,s,o,a,l),this.handleSpeechPhraseMessage=async u=>this.handleSpeechPhrase(u),this.handleSpeechHypothesisMessage=u=>this.handleSpeechHypothesis(u)}processTypeSpecificMessages(i){}handleRecognizedCallback(i,s,o){}handleRecognizingCallback(i,s,o){}async processSpeechMessages(i){let s=!1;switch(i.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(i.textBody),s=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(i.textBody),s=!0;break}return s}cancelRecognition(i,s,o,a,l){}async handleSpeechPhrase(i){const s=e.SimpleSpeechPhrase.fromJSON(i,this.privRequestSession.currentTurnAudioOffset),o=e.EnumTranslation.implTranslateRecognitionResult(s.RecognitionStatus);let a;const l=new r.PropertyCollection;if(l.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,i),this.privRequestSession.onPhraseRecognized(s.Offset+s.Duration),r.ResultReason.Canceled===o){const u=e.EnumTranslation.implTranslateCancelResult(s.RecognitionStatus),h=e.EnumTranslation.implTranslateCancelErrorCode(s.RecognitionStatus);await this.cancelRecognitionLocal(u,h,e.EnumTranslation.implTranslateErrorDetails(h))}else if(s.RecognitionStatus!==e.RecognitionStatus.EndOfDictation){if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===r.OutputFormat[r.OutputFormat.Simple])a=new r.SpeechRecognitionResult(this.privRequestSession.requestId,o,s.DisplayText,s.Duration,s.Offset,s.Language,s.LanguageDetectionConfidence,s.SpeakerId,void 0,s.asJson(),l);else{const u=e.DetailedSpeechPhrase.fromJSON(i,this.privRequestSession.currentTurnAudioOffset);a=new r.SpeechRecognitionResult(this.privRequestSession.requestId,o,u.Text,u.Duration,u.Offset,u.Language,u.LanguageDetectionConfidence,u.SpeakerId,void 0,u.asJson(),l)}this.handleRecognizedCallback(a,a.offset,this.privRequestSession.sessionId)}}handleSpeechHypothesis(i){const s=e.SpeechHypothesis.fromJSON(i,this.privRequestSession.currentTurnAudioOffset),o=new r.PropertyCollection;o.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,i);const a=new r.SpeechRecognitionResult(this.privRequestSession.requestId,r.ResultReason.RecognizingSpeech,s.Text,s.Duration,s.Offset,s.Language,s.LanguageDetectionConfidence,s.SpeakerId,void 0,s.asJson(),o);this.privRequestSession.onHypothesis(s.Offset),this.handleRecognizingCallback(a,s.Duration,this.privRequestSession.sessionId)}};return Zm.ConversationServiceRecognizer=t,Zm}var lT={},TN;function l8(){return TN||(TN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.RecognizerConfig=r.SpeechResultFormat=void 0;const e=xe(),t=Oe(),n=is();(function(s){s[s.Simple=0]="Simple",s[s.Detailed=1]="Detailed"})(r.SpeechResultFormat||(r.SpeechResultFormat={}));class i{constructor(o,a){this.privSpeechServiceConfig=o||new t.SpeechServiceConfig(new t.Context(null)),this.privParameters=a,this.privMaxRetryCount=parseInt(a.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=a.getProperty(e.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(o){this.privRecognitionMode=o,this.privRecognitionActivityTimeout=o===n.RecognitionMode.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=n.RecognitionMode[o]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==n.RecognitionMode.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(e.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2")}set recognitionEndpointVersion(o){this.parameters.setProperty(e.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,o)}get sourceLanguageModels(){const o=[];let a=!1;if(this.autoDetectSourceLanguages!==void 0)for(const l of this.autoDetectSourceLanguages.split(",")){const u=l+e.PropertyId.SpeechServiceConnection_EndpointId.toString(),h=this.parameters.getProperty(u,void 0);h!==void 0?(o.push({language:l,endpoint:h}),a=!0):o.push({language:l,endpoint:""})}return a?o:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(o){this.privEnableSpeakerId=o}}r.RecognizerConfig=i})(lT)),lT}var cT={},wN;function c8(){return wN||(wN=1,Object.defineProperty(cT,"__esModule",{value:!0})),cT}var $m={},PN;function u8(){if(PN)return $m;PN=1,Object.defineProperty($m,"__esModule",{value:!0}),$m.WebsocketMessageFormatter=void 0;const r=We(),e=`\r
`;let t=class{toConnectionMessage(i){const s=new r.Deferred;try{if(i.messageType===r.MessageType.Text){const o=i.textContent;let a={},l=null;if(o){const u=o.split(`\r
\r
`);u&&u.length>0&&(a=this.parseHeaders(u[0]),u.length>1&&(l=u[1]))}s.resolve(new r.ConnectionMessage(i.messageType,l,a,i.id))}else if(i.messageType===r.MessageType.Binary){const o=i.binaryContent;let a={},l=null;if(!o||o.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const u=new DataView(o),h=u.getInt16(0);if(o.byteLength<h+2)throw new Error("Invalid binary message format. Header content missing.");let m="";for(let g=0;g<h;g++)m+=String.fromCharCode(u.getInt8(g+2));a=this.parseHeaders(m),o.byteLength>h+2&&(l=o.slice(2+h)),s.resolve(new r.ConnectionMessage(i.messageType,l,a,i.id))}}catch(o){s.reject(`Error formatting the message. Error: ${o}`)}return s.promise}fromConnectionMessage(i){const s=new r.Deferred;try{if(i.messageType===r.MessageType.Text){const o=`${this.makeHeaders(i)}${e}${i.textBody?i.textBody:""}`;s.resolve(new r.RawWebsocketMessage(r.MessageType.Text,o,i.id))}else if(i.messageType===r.MessageType.Binary){const o=this.makeHeaders(i),a=i.binaryBody,l=this.stringToArrayBuffer(o),u=new Int8Array(l),h=u.byteLength,m=new Int8Array(2+h+(a?a.byteLength:0));if(m[0]=h>>8&255,m[1]=h&255,m.set(u,2),a){const v=new Int8Array(a);m.set(v,2+h)}const g=m.buffer;s.resolve(new r.RawWebsocketMessage(r.MessageType.Binary,g,i.id))}}catch(o){s.reject(`Error formatting the message. ${o}`)}return s.promise}makeHeaders(i){let s="";if(i.headers)for(const o in i.headers)o&&(s+=`${o}: ${i.headers[o]}${e}`);return s}parseHeaders(i){const s={};if(i){const o=i.match(/[^\r\n]+/g);if(s){for(const a of o)if(a){const l=a.indexOf(":"),u=l>0?a.substr(0,l).trim().toLowerCase():a,h=l>0&&a.length>l+1?a.substr(l+1).trim():"";s[u]=h}}}return s}stringToArrayBuffer(i){const s=new ArrayBuffer(i.length),o=new DataView(s);for(let a=0;a<i.length;a++)o.setUint8(a,i.charCodeAt(a));return s}};return $m.WebsocketMessageFormatter=t,$m}var Hm={},EN;function d8(){if(EN)return Hm;EN=1,Object.defineProperty(Hm,"__esModule",{value:!0}),Hm.SpeechConnectionFactory=void 0;const r=In(),e=Oe(),t=xe(),n=Jo(),i=Oe(),s=ai(),o=wl(),a=is();let l=class extends n.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/stt/speech/universal/v"}async create(h,m,g){let v=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const y=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),A=n.ConnectionFactoryBase.getHostSuffix(y),x=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+y+".stt.speech"+A),b={},w=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),T=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(w?(!v||v.search(o.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(b[o.QueryParameterNames.CustomSpeechDeploymentId]=w):T&&(!v||v.search(o.QueryParameterNames.Language)===-1)&&(b[o.QueryParameterNames.Language]=T),(!v||v.search(o.QueryParameterNames.Format)===-1)&&(b[o.QueryParameterNames.Format]=h.parameters.getProperty(e.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple]).toLowerCase()),h.autoDetectSourceLanguages!==void 0&&(b[o.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(h,b,v),v){const j=new URL(v),B=j.pathname;(B===""||B==="/")&&(j.pathname=this.universalUri+h.recognitionEndpointVersion,v=await n.ConnectionFactoryBase.getRedirectUrlFromEndpoint(j.toString()))}if(!v)switch(h.recognitionMode){case a.RecognitionMode.Conversation:h.parameters.getProperty(e.ForceDictationPropertyName,"false")==="true"?v=x+this.dictationRelativeUri:h.recognitionEndpointVersion!==void 0&&parseInt(h.recognitionEndpointVersion,10)>1?v=`${x}${this.universalUri}${h.recognitionEndpointVersion}`:v=x+this.conversationRelativeUri;break;case a.RecognitionMode.Dictation:v=x+this.dictationRelativeUri;break;default:h.recognitionEndpointVersion!==void 0&&parseInt(h.recognitionEndpointVersion,10)>1?v=`${x}${this.universalUri}${h.recognitionEndpointVersion}`:v=x+this.interactiveRelativeUri;break}const k={};m.token!==void 0&&m.token!==""&&(k[m.headerName]=m.token),k[s.HeaderNames.ConnectionId]=g,k.connectionId=g;const I=h.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",M=new r.WebsocketConnection(v,b,k,new i.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(h),I,g),L=M.uri;return h.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,L),M}};return Hm.SpeechConnectionFactory=l,Hm}var Vm={},RN;function h8(){if(RN)return Vm;RN=1,Object.defineProperty(Vm,"__esModule",{value:!0}),Vm.ConversationTranscriberConnectionFactory=void 0;const r=In(),e=xe(),t=Oe(),n=Jo(),i=Oe(),s=ai(),o=wl();let a=class extends n.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.conversationRelativeUriV1="/speech/recognition/conversation/cognitiveservices/v1"}async create(u,h,m){let g=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const v=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,void 0),y=n.ConnectionFactoryBase.getHostSuffix(v),A=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,"wss://"+v+".stt.speech"+y),x={},b=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),w=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(b?(!g||g.search(o.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(x[o.QueryParameterNames.CustomSpeechDeploymentId]=b):w&&(!g||g.search(o.QueryParameterNames.Language)===-1)&&(x[o.QueryParameterNames.Language]=w),u.autoDetectSourceLanguages!==void 0&&(x[o.QueryParameterNames.EnableLanguageId]="true"),u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,void 0)==="1")g=`${A}${this.universalUri}`;else{if(this.setV2UrlParams(u,x,g),g){const j=new URL(g),B=j.pathname;(B===""||B==="/")&&(j.pathname=this.universalUri,g=await n.ConnectionFactoryBase.getRedirectUrlFromEndpoint(j.toString()))}g||(g=`${A}${this.conversationRelativeUriV1}`)}const k={};h.token!==void 0&&h.token!==""&&(k[h.headerName]=h.token),k[s.HeaderNames.ConnectionId]=m;const I=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",M=new r.WebsocketConnection(g,x,k,new i.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(u),I,m),L=M.uri;return u.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,L),M}setV2UrlParams(u,h,m){new Map([[e.PropertyId.Speech_SegmentationSilenceTimeoutMs,o.QueryParameterNames.SegmentationSilenceTimeoutMs],[e.PropertyId.SpeechServiceConnection_EnableAudioLogging,o.QueryParameterNames.EnableAudioLogging],[e.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,o.QueryParameterNames.EndSilenceTimeoutMs],[e.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,o.QueryParameterNames.InitialSilenceTimeoutMs],[e.PropertyId.SpeechServiceResponse_PostProcessingOption,o.QueryParameterNames.Postprocessing],[e.PropertyId.SpeechServiceResponse_ProfanityOption,o.QueryParameterNames.Profanity],[e.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,o.QueryParameterNames.StableIntermediateThreshold]]).forEach((y,A)=>{this.setUrlParameter(A,y,u,h,m)});const v=JSON.parse(u.parameters.getProperty(t.ServicePropertiesPropertyName,"{}"));Object.keys(v).forEach(y=>{h[y]=v[y]})}};return Vm.ConversationTranscriberConnectionFactory=a,Vm}var qm={},IN;function p8(){if(IN)return qm;IN=1,Object.defineProperty(qm,"__esModule",{value:!0}),qm.TranscriberConnectionFactory=void 0;const r=In(),e=xe(),t=Jo(),n=Oe(),i=ai(),s=wl();let o=class extends t.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(l,u,h){let m=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const g=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,"centralus"),v=t.ConnectionFactoryBase.getHostSuffix(g),y="wss://transcribe."+g+".cts.speech"+v+this.multiaudioRelativeUri,A=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,y),x={};this.setQueryParams(x,l,m),m||(m=A);const b={};u.token!==void 0&&u.token!==""&&(b[u.headerName]=u.token),b[i.HeaderNames.ConnectionId]=h,l.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,m);const w=l.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new r.WebsocketConnection(m,x,b,new n.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(l),w,h))}setQueryParams(l,u,h){const m=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),g=u.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);m&&!(s.QueryParameterNames.CustomSpeechDeploymentId in l)&&(l[s.QueryParameterNames.CustomSpeechDeploymentId]=m),g&&!(s.QueryParameterNames.Language in l)&&(l[s.QueryParameterNames.Language]=g);const v=u.parameters.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",y=u.parameters.getProperty(n.OutputFormatPropertyName,e.OutputFormat[e.OutputFormat.Simple])!==e.OutputFormat[e.OutputFormat.Simple];(v||y)&&(l[s.QueryParameterNames.Format]=e.OutputFormat[e.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(u,l,h)}};return qm.TranscriberConnectionFactory=o,qm}var Gm={},kN;function f8(){if(kN)return Gm;kN=1,Object.defineProperty(Gm,"__esModule",{value:!0}),Gm.TranslationConnectionFactory=void 0;const r=In(),e=F_(),t=xe(),n=Jo(),i=Oe(),s=ai(),o=wl(),a=is();let l=class extends n.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.translationV1Uri="/speech/translation/cognitiveservices/v1"}async create(h,m,g){let v=this.getEndpointUrl(h);const y={};if(this.setQueryParams(y,h,v),v){const w=new URL(v),T=w.pathname;(T===""||T==="/")&&(w.pathname=this.universalUri,v=await n.ConnectionFactoryBase.getRedirectUrlFromEndpoint(w.toString()))}const A={};m.token!==void 0&&m.token!==""&&(A[m.headerName]=m.token),A[s.HeaderNames.ConnectionId]=g,h.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,v);const x=h.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new r.WebsocketConnection(v,y,A,new i.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(h),x,g)}getEndpointUrl(h,m){const g=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region),v=n.ConnectionFactoryBase.getHostSuffix(g);let y=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);return y?m===!0?y:e.StringUtils.formatString(y,{region:g}):(h.parameters.getProperty("SPEECH-ForceV1Endpoint","false")==="true"?y=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+v)+this.translationV1Uri:y=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+v)+this.universalUri,m===!0?y:e.StringUtils.formatString(y,{region:g}))}setQueryParams(h,m,g){h.from=m.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage),h.to=m.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages),h.scenario=m.recognitionMode===a.RecognitionMode.Interactive?"interactive":m.recognitionMode===a.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(m,h,g),this.setUrlParameter(t.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,o.QueryParameterNames.StableTranslation,m,h,g);const v=m.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);v!==void 0&&(h.voice=v,h.features="requireVoice")}};return Gm.TranslationConnectionFactory=l,Gm}var Km={},MN;function m8(){if(MN)return Km;MN=1,Object.defineProperty(Km,"__esModule",{value:!0}),Km.EnumTranslation=void 0;const r=xe(),e=Oe();let t=class{static implTranslateRecognitionResult(i,s=!1){let o=r.ResultReason.Canceled;switch(i){case e.RecognitionStatus.Success:o=r.ResultReason.RecognizedSpeech;break;case e.RecognitionStatus.EndOfDictation:o=s?r.ResultReason.RecognizedSpeech:r.ResultReason.NoMatch;break;case e.RecognitionStatus.NoMatch:case e.RecognitionStatus.InitialSilenceTimeout:case e.RecognitionStatus.BabbleTimeout:o=r.ResultReason.NoMatch;break;case e.RecognitionStatus.Error:case e.RecognitionStatus.BadRequest:case e.RecognitionStatus.Forbidden:default:o=r.ResultReason.Canceled;break}return o}static implTranslateCancelResult(i){let s=r.CancellationReason.EndOfStream;switch(i){case e.RecognitionStatus.Success:case e.RecognitionStatus.EndOfDictation:case e.RecognitionStatus.NoMatch:s=r.CancellationReason.EndOfStream;break;case e.RecognitionStatus.InitialSilenceTimeout:case e.RecognitionStatus.BabbleTimeout:case e.RecognitionStatus.Error:case e.RecognitionStatus.BadRequest:case e.RecognitionStatus.Forbidden:default:s=r.CancellationReason.Error;break}return s}static implTranslateCancelErrorCode(i){let s=r.CancellationErrorCode.NoError;switch(i){case e.RecognitionStatus.Error:s=r.CancellationErrorCode.ServiceError;break;case e.RecognitionStatus.TooManyRequests:s=r.CancellationErrorCode.TooManyRequests;break;case e.RecognitionStatus.BadRequest:s=r.CancellationErrorCode.BadRequestParameters;break;case e.RecognitionStatus.Forbidden:s=r.CancellationErrorCode.Forbidden;break;default:s=r.CancellationErrorCode.NoError;break}return s}static implTranslateErrorDetails(i){let s="The speech service encountered an internal error and could not continue.";switch(i){case r.CancellationErrorCode.Forbidden:s="The recognizer is using a free subscription that ran out of quota.";break;case r.CancellationErrorCode.BadRequestParameters:s="Invalid parameter or unsupported audio format in the request.";break;case r.CancellationErrorCode.TooManyRequests:s="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break}return s}};return Km.EnumTranslation=t,Km}var uT={},NN;function g8(){return NN||(NN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.RecognitionStatus=r.SynthesisStatus=void 0,(function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"})(r.SynthesisStatus||(r.SynthesisStatus={})),(function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests",e[e.BadRequest=7]="BadRequest",e[e.Forbidden=8]="Forbidden"})(r.RecognitionStatus||(r.RecognitionStatus={}))})(uT)),uT}var Ym={},LN;function v8(){if(LN)return Ym;LN=1,Object.defineProperty(Ym,"__esModule",{value:!0}),Ym.TranslationSynthesisEnd=void 0;const r=Oe();let e=class Y_{constructor(n){this.privSynthesisEnd=JSON.parse(n),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=r.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=r.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(n){return new Y_(n)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};return Ym.TranslationSynthesisEnd=e,Ym}var Xm={},_N;function S8(){if(_N)return Xm;_N=1,Object.defineProperty(Xm,"__esModule",{value:!0}),Xm.TranslationHypothesis=void 0;const r=rt(),e=PP();let t=class UT{constructor(i,s){this.privTranslationHypothesis=i,this.privTranslationHypothesis.Offset+=s,this.privTranslationHypothesis.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationHypothesis.Translation.TranslationStatus)}static fromJSON(i,s){return new UT(JSON.parse(i),s)}static fromTranslationResponse(i,s){r.Contracts.throwIfNullOrUndefined(i,"translationHypothesis");const o=i.SpeechHypothesis;return i.SpeechHypothesis=void 0,o.Translation=i,new UT(o,s)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){var i;return(i=this.privTranslationHypothesis.PrimaryLanguage)==null?void 0:i.Language}asJson(){const i={...this.privTranslationHypothesis};return i.Translation!==void 0?JSON.stringify({...i,TranslationStatus:e.TranslationStatus[i.Translation.TranslationStatus]}):JSON.stringify(i)}mapTranslationStatus(i){if(typeof i=="string")return e.TranslationStatus[i];if(typeof i=="number")return i}};return Xm.TranslationHypothesis=t,Xm}var Jm={},ON;function y8(){if(ON)return Jm;ON=1,Object.defineProperty(Jm,"__esModule",{value:!0}),Jm.TranslationPhrase=void 0;const r=rt(),e=Oe(),t=PP();let n=class ZT{constructor(s,o){this.privTranslationPhrase=s,this.privTranslationPhrase.Offset+=o,this.privTranslationPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privTranslationPhrase.RecognitionStatus),this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationPhrase.Translation.TranslationStatus))}static fromJSON(s,o){return new ZT(JSON.parse(s),o)}static fromTranslationResponse(s,o){r.Contracts.throwIfNullOrUndefined(s,"translationResponse");const a=s.SpeechPhrase;return s.SpeechPhrase=void 0,a.Translation=s,a.Text=a.DisplayText,new ZT(a,o)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){var s;return(s=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:s.Language}get Confidence(){var s;return(s=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:s.Confidence}get Translation(){return this.privTranslationPhrase.Translation}asJson(){const s={...this.privTranslationPhrase},o={...s,RecognitionStatus:e.RecognitionStatus[s.RecognitionStatus]};return s.Translation&&(o.Translation={...s.Translation,TranslationStatus:t.TranslationStatus[s.Translation.TranslationStatus]}),JSON.stringify(o)}mapRecognitionStatus(s){if(typeof s=="string")return e.RecognitionStatus[s];if(typeof s=="number")return s}mapTranslationStatus(s){if(typeof s=="string")return t.TranslationStatus[s];if(typeof s=="number")return s}};return Jm.TranslationPhrase=n,Jm}var Qm={},DN;function C8(){if(DN)return Qm;DN=1,Object.defineProperty(Qm,"__esModule",{value:!0}),Qm.TranslationServiceRecognizer=void 0;const r=We(),e=xe(),t=Oe();let n=class extends t.ConversationServiceRecognizer{constructor(s,o,a,l,u){super(s,o,a,l,u),this.privTranslationRecognizer=u,this.connectionEvents.attach(h=>{h.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(s){const o=new e.PropertyCollection;let a=await this.processSpeechMessages(s);if(a)return!0;const l=async h=>{if(o.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,h.asJson()),this.privRequestSession.onPhraseRecognized(h.Offset+h.Duration),h.RecognitionStatus===t.RecognitionStatus.Success){const m=this.fireEventForResult(h,o);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,m)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(m.result)}catch(g){this.privErrorCallback&&this.privErrorCallback(g)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const m=t.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus),g=new e.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,m,h.Text,h.Duration,h.Offset,h.Language,h.Confidence,void 0,h.asJson(),o);if(m===e.ResultReason.Canceled){const v=t.EnumTranslation.implTranslateCancelResult(h.RecognitionStatus),y=t.EnumTranslation.implTranslateCancelErrorCode(h.RecognitionStatus);await this.cancelRecognitionLocal(v,y,t.EnumTranslation.implTranslateErrorDetails(y))}else if(h.RecognitionStatus!==t.RecognitionStatus.EndOfDictation){const v=new e.TranslationRecognitionEventArgs(g,g.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,v)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(g)}catch(y){this.privErrorCallback&&this.privErrorCallback(y)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}a=!0}},u=h=>{o.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,h.asJson());const m=this.fireEventForResult(h,o);if(this.privRequestSession.onHypothesis(m.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,m)}catch{}a=!0};switch(s.messageType===r.MessageType.Text&&o.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,s.textBody),s.path.toLowerCase()){case"translation.hypothesis":u(t.TranslationHypothesis.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.response":const h=JSON.parse(s.textBody);if(h.SpeechPhrase)await l(t.TranslationPhrase.fromTranslationResponse(h,this.privRequestSession.currentTurnAudioOffset));else{const g=JSON.parse(s.textBody);g.SpeechHypothesis&&u(t.TranslationHypothesis.fromTranslationResponse(g,this.privRequestSession.currentTurnAudioOffset))}break;case"translation.phrase":await l(t.TranslationPhrase.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.synthesis":case"audio":this.sendSynthesisAudio(s.binaryBody,this.privRequestSession.sessionId),a=!0;break;case"audio.end":case"translation.synthesis.end":const m=t.TranslationSynthesisEnd.fromJSON(s.textBody);switch(m.SynthesisStatus){case t.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){const g=new e.TranslationSynthesisResult(e.ResultReason.Canceled,void 0),v=new e.TranslationSynthesisEventArgs(g,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,v)}catch{}}if(this.privTranslationRecognizer.canceled){const g=new e.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,e.CancellationReason.Error,m.FailureReason,e.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,g)}catch{}}break;case t.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break}a=!0;break}return a}cancelRecognition(s,o,a,l,u){const h=new e.PropertyCollection;if(h.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[l]),this.privTranslationRecognizer.canceled){const m=new e.TranslationRecognitionCanceledEventArgs(s,a,u,l,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,m)}catch{}}if(this.privSuccessCallback){const m=new e.TranslationRecognitionResult(void 0,o,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,u,void 0,h);try{this.privSuccessCallback(m),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(s,o,a){try{const l=new e.TranslationRecognitionEventArgs(e.TranslationRecognitionResult.fromSpeechRecognitionResult(s),o,a);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,l)}catch{}}handleRecognizedCallback(s,o,a){try{const l=new e.TranslationRecognitionEventArgs(e.TranslationRecognitionResult.fromSpeechRecognitionResult(s),o,a);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,l)}catch{}}fireEventForResult(s,o){let a;if(s.Translation.Translations!==void 0){a=new e.Translations;for(const v of s.Translation.Translations)a.set(v.Language,v.Text||v.DisplayText)}let l,u;s instanceof t.TranslationPhrase?(s.Translation&&s.Translation.TranslationStatus===r.TranslationStatus.Success?l=e.ResultReason.TranslatedSpeech:l=e.ResultReason.RecognizedSpeech,u=s.Confidence):l=e.ResultReason.TranslatingSpeech;const h=s.Language,m=new e.TranslationRecognitionResult(a,this.privRequestSession.requestId,l,s.Text,s.Duration,s.Offset,h,u,s.Translation.FailureReason,s.asJson(),o);return new e.TranslationRecognitionEventArgs(m,s.Offset,this.privRequestSession.sessionId)}sendSynthesisAudio(s,o){const a=s===void 0?e.ResultReason.SynthesizingAudioCompleted:e.ResultReason.SynthesizingAudio,l=new e.TranslationSynthesisResult(a,s),u=new e.TranslationSynthesisEventArgs(l,o);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,u)}catch{}}};return Qm.TranslationServiceRecognizer=n,Qm}var eg={},jN;function A8(){if(jN)return eg;jN=1,Object.defineProperty(eg,"__esModule",{value:!0}),eg.SpeechDetected=void 0;let r=class X_{constructor(t,n){this.privSpeechStartDetected=JSON.parse(t),this.privSpeechStartDetected.Offset+=n}static fromJSON(t,n){return new X_(t,n)}get Offset(){return this.privSpeechStartDetected.Offset}};return eg.SpeechDetected=r,eg}var tg={},BN;function b8(){if(BN)return tg;BN=1,Object.defineProperty(tg,"__esModule",{value:!0}),tg.SpeechHypothesis=void 0;let r=class J_{constructor(t,n){this.privSpeechHypothesis=JSON.parse(t),this.updateOffset(n)}static fromJSON(t,n){return new J_(t,n)}updateOffset(t){this.privSpeechHypothesis.Offset+=t}asJson(){return JSON.stringify(this.privSpeechHypothesis)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};return tg.SpeechHypothesis=r,tg}var rg={},zN;function x8(){if(zN)return rg;zN=1,Object.defineProperty(rg,"__esModule",{value:!0}),rg.SpeechKeyword=void 0;let r=class Q_{constructor(t,n){this.privSpeechKeyword=JSON.parse(t),this.privSpeechKeyword.Offset+=n}static fromJSON(t,n){return new Q_(t,n)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}asJson(){return JSON.stringify(this.privSpeechKeyword)}};return rg.SpeechKeyword=r,rg}var ng={},FN;function T8(){if(FN)return ng;FN=1,Object.defineProperty(ng,"__esModule",{value:!0}),ng.SpeechServiceRecognizer=void 0;const r=xe(),e=Oe();let t=class extends e.ServiceRecognizerBase{constructor(i,s,o,a,l){super(i,s,o,a,l),this.privSpeechRecognizer=l}async processTypeSpecificMessages(i){let s;const o=new r.PropertyCollection;let a=!1;switch(i.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const l=e.SpeechHypothesis.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);o.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,l.asJson()),s=new r.SpeechRecognitionResult(this.privRequestSession.requestId,r.ResultReason.RecognizingSpeech,l.Text,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,void 0,void 0,l.asJson(),o),this.privRequestSession.onHypothesis(l.Offset);const u=new r.SpeechRecognitionEventArgs(s,l.Offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,u)}catch{}a=!0;break;case"speech.phrase":const h=e.SimpleSpeechPhrase.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);o.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,h.asJson());const m=e.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(h.Offset+h.Duration),r.ResultReason.Canceled===m){const g=e.EnumTranslation.implTranslateCancelResult(h.RecognitionStatus),v=e.EnumTranslation.implTranslateCancelErrorCode(h.RecognitionStatus);await this.cancelRecognitionLocal(g,v,e.EnumTranslation.implTranslateErrorDetails(v))}else{if(h.RecognitionStatus===e.RecognitionStatus.EndOfDictation)break;if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===r.OutputFormat[r.OutputFormat.Simple])s=new r.SpeechRecognitionResult(this.privRequestSession.requestId,m,h.DisplayText,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,void 0,void 0,h.asJson(),o);else{const v=e.DetailedSpeechPhrase.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);o.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,v.asJson()),s=new r.SpeechRecognitionResult(this.privRequestSession.requestId,m,v.RecognitionStatus===e.RecognitionStatus.Success?v.NBest[0].Display:"",v.Duration,v.Offset,v.Language,v.LanguageDetectionConfidence,void 0,void 0,v.asJson(),o)}const g=new r.SpeechRecognitionEventArgs(s,s.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,g)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(s)}catch(v){this.privErrorCallback&&this.privErrorCallback(v)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}a=!0;break}return a}cancelRecognition(i,s,o,a,l){const u=new r.PropertyCollection;if(u.setProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[a]),this.privSpeechRecognizer.canceled){const h=new r.SpeechRecognitionCanceledEventArgs(o,l,a,void 0,i);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,h)}catch{}}if(this.privSuccessCallback){const h=new r.SpeechRecognitionResult(s,r.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,l,void 0,u);try{this.privSuccessCallback(h),this.privSuccessCallback=void 0}catch{}}}};return ng.SpeechServiceRecognizer=t,ng}var ig={},dT={},WN;function w8(){return WN||(WN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.IdentityProvider=r.SpeakerDiarizationMode=void 0,(function(e){e.None="None",e.Identity="Identity",e.Anonymous="Anonymous"})(r.SpeakerDiarizationMode||(r.SpeakerDiarizationMode={})),(function(e){e.CallCenter="CallCenter"})(r.IdentityProvider||(r.IdentityProvider={}))})(dT)),dT}var UN;function P8(){if(UN)return ig;UN=1,Object.defineProperty(ig,"__esModule",{value:!0}),ig.ConversationTranscriptionServiceRecognizer=void 0;const r=xe(),e=Oe(),t=w8(),n=is();let i=class extends e.ServiceRecognizerBase{constructor(o,a,l,u,h){super(o,a,l,u,h),this.privConversationTranscriber=h,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const o=this.privSpeechContext.getContext().phraseDetection||{};o.mode=n.RecognitionMode.Conversation;const a={};a.mode=t.SpeakerDiarizationMode.Anonymous,a.audioSessionId=this.privDiarizationSessionId,a.audioOffsetMs=0,a.diarizeIntermediates=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceResponse_DiarizeIntermediateResults,"false")==="true",o.speakerDiarization=a,this.privSpeechContext.getContext().phraseDetection=o}}async processTypeSpecificMessages(o){let a;const l=new r.PropertyCollection;l.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,o.textBody);let u=!1;switch(o.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const h=e.SpeechHypothesis.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);a=new r.ConversationTranscriptionResult(this.privRequestSession.requestId,r.ResultReason.RecognizingSpeech,h.Text,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,h.SpeakerId,void 0,h.asJson(),l),this.privRequestSession.onHypothesis(h.Offset);const m=new r.ConversationTranscriptionEventArgs(a,h.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,m)}catch{}u=!0;break;case"speech.phrase":const g=e.SimpleSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset),v=e.EnumTranslation.implTranslateRecognitionResult(g.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(g.Offset+g.Duration),r.ResultReason.Canceled===v){const y=e.EnumTranslation.implTranslateCancelResult(g.RecognitionStatus),A=e.EnumTranslation.implTranslateCancelErrorCode(g.RecognitionStatus);await this.cancelRecognitionLocal(y,A,e.EnumTranslation.implTranslateErrorDetails(A))}else if(!(this.privRequestSession.isSpeechEnded&&v===r.ResultReason.NoMatch&&g.RecognitionStatus!==e.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===r.OutputFormat[r.OutputFormat.Simple])a=new r.ConversationTranscriptionResult(this.privRequestSession.requestId,v,g.DisplayText,g.Duration,g.Offset,g.Language,g.LanguageDetectionConfidence,g.SpeakerId,void 0,g.asJson(),l);else{const A=e.DetailedSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);a=new r.ConversationTranscriptionResult(this.privRequestSession.requestId,v,A.RecognitionStatus===e.RecognitionStatus.Success?A.NBest[0].Display:void 0,A.Duration,A.Offset,A.Language,A.LanguageDetectionConfidence,g.SpeakerId,void 0,A.asJson(),l)}const y=new r.ConversationTranscriptionEventArgs(a,a.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,y)}catch{}}u=!0;break}return u}cancelRecognition(o,a,l,u,h){if(new r.PropertyCollection().setProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[u]),this.privConversationTranscriber.canceled){const g=new r.ConversationTranscriptionCanceledEventArgs(l,h,u,void 0,o);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,g)}catch{}}}};return ig.ConversationTranscriptionServiceRecognizer=i,ig}var sg={},ZN;function E8(){if(ZN)return sg;ZN=1,Object.defineProperty(sg,"__esModule",{value:!0}),sg.TranscriptionServiceRecognizer=void 0;const r=We(),e=xe(),t=Oe(),n=aA();let i=class extends t.ConversationServiceRecognizer{constructor(o,a,l,u,h){super(o,a,l,u,h),this.privTranscriberRecognizer=h,this.sendPrePayloadJSONOverride=m=>this.sendTranscriptionStartJSON(m),this.privRecognizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(o,a){if(this.privRequestSession.isRecognizing){const l=await this.fetchConnection();await this.sendSpeechEvent(l,this.createSpeechEventPayload(o,a))}}async sendMeetingSpeechEventAsync(o,a){if(this.privRequestSession.isRecognizing){const l=await this.fetchConnection();await this.sendSpeechEvent(l,this.createMeetingSpeechEventPayload(o,a))}}processTypeSpecificMessages(o){return this.processSpeechMessages(o)}handleRecognizedCallback(o,a,l){try{const u=new e.SpeechRecognitionEventArgs(o,a,l);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,u),this.privSuccessCallback){try{this.privSuccessCallback(o)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(o,a,l){try{const u=new e.SpeechRecognitionEventArgs(o,a,l);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,u)}catch{}}cancelRecognition(o,a,l,u,h){const m=new e.PropertyCollection;if(m.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[u]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const g=new e.MeetingTranscriptionCanceledEventArgs(l,h,u,void 0,o);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,g)}catch{}}}else if(this.privTranscriberRecognizer.canceled){const g=new e.ConversationTranscriptionCanceledEventArgs(l,h,u,void 0,o);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,g)}catch{}}if(this.privSuccessCallback){const g=new e.SpeechRecognitionResult(a,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,h,void 0,m);try{this.privSuccessCallback(g),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(o){if(await this.sendSpeechContext(o,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const a=this.privTranscriberRecognizer.getMeetingInfo(),l=this.createMeetingSpeechEventPayload(a,"start");await this.sendSpeechEvent(o,l)}else{const a=this.privTranscriberRecognizer.getConversationInfo(),l=this.createSpeechEventPayload(a,"start");await this.sendSpeechEvent(o,l)}await this.sendWaveHeader(o)}sendSpeechEvent(o,a){const l=JSON.stringify(a);if(l)return o.send(new n.SpeechConnectionMessage(r.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",l))}createSpeechEventPayload(o,a){const l={id:"meeting",name:a,meeting:o.conversationProperties};return l.meeting.id=o.id,l.meeting.attendees=o.participants,l}createMeetingSpeechEventPayload(o,a){const l={id:"meeting",name:a,meeting:o.meetingProperties};return l.meeting.id=o.id,l.meeting.attendees=o.participants,l}};return sg.TranscriptionServiceRecognizer=i,sg}var og={},$N;function R8(){if($N)return og;$N=1,Object.defineProperty(og,"__esModule",{value:!0}),og.DetailedSpeechPhrase=void 0;const r=Oe();let e=class eO{constructor(n,i){this.privDetailedSpeechPhrase=JSON.parse(n),this.privDetailedSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privDetailedSpeechPhrase.RecognitionStatus),this.updateOffsets(i)}static fromJSON(n,i){return new eO(n,i)}updateOffsets(n){if(this.privDetailedSpeechPhrase.Offset+=n,this.privDetailedSpeechPhrase.NBest)for(const i of this.privDetailedSpeechPhrase.NBest){if(i.Words)for(const s of i.Words)s.Offset+=n;if(i.DisplayWords)for(const s of i.DisplayWords)s.Offset+=n}}asJson(){const n={...this.privDetailedSpeechPhrase};return JSON.stringify({...n,RecognitionStatus:r.RecognitionStatus[n.RecognitionStatus]})}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}mapRecognitionStatus(n){if(typeof n=="string")return r.RecognitionStatus[n];if(typeof n=="number")return n}};return og.DetailedSpeechPhrase=e,og}var ag={},HN;function I8(){if(HN)return ag;HN=1,Object.defineProperty(ag,"__esModule",{value:!0}),ag.SimpleSpeechPhrase=void 0;const r=Oe();let e=class tO{constructor(n,i=0){this.privSimpleSpeechPhrase=JSON.parse(n),this.privSimpleSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privSimpleSpeechPhrase.RecognitionStatus),this.updateOffset(i)}static fromJSON(n,i){return new tO(n,i)}updateOffset(n){this.privSimpleSpeechPhrase.Offset+=n}asJson(){const n={...this.privSimpleSpeechPhrase};return JSON.stringify({...n,RecognitionStatus:r.RecognitionStatus[n.RecognitionStatus]})}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}mapRecognitionStatus(n){if(typeof n=="string")return r.RecognitionStatus[n];if(typeof n=="number")return n}};return ag.SimpleSpeechPhrase=e,ag}var lg={},cg={},VN;function k8(){if(VN)return cg;VN=1,Object.defineProperty(cg,"__esModule",{value:!0}),cg.ServiceTelemetryListener=void 0;const r=We(),e=RP();class t{constructor(i,s,o){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=i,this.privAudioSourceId=s,this.privAudioNodeId=o,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(i){i>0&&this.privPhraseLatencies.push(Date.now()-i)}hypothesisReceived(i){i>0&&this.privHypothesisLatencies.push(Date.now()-i)}onEvent(i){this.privIsDisposed||(i instanceof e.RecognitionTriggeredEvent&&i.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:i.eventTime,Name:"ListeningTrigger",Start:i.eventTime}),i instanceof r.AudioStreamNodeAttachingEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof r.AudioStreamNodeAttachedEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof r.AudioSourceErrorEvent&&i.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof r.AudioStreamNodeErrorEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof r.AudioStreamNodeDetachedEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Name:"Microphone",Start:this.privMicStartTime})),i instanceof e.ConnectingToServiceEvent&&i.requestId===this.privRequestId&&(this.privConnectionId=i.sessionId),i instanceof r.ConnectionStartEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionStartTime=i.eventTime),i instanceof r.ConnectionEstablishedEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof r.ConnectionEstablishErrorEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Error:this.getConnectionError(i.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof r.ConnectionMessageReceivedEvent&&i.connectionId===this.privConnectionId&&i.message&&i.message.headers&&i.message.headers.path&&(this.privReceivedMessages[i.message.headers.path]||(this.privReceivedMessages[i.message.headers.path]=new Array),this.privReceivedMessages[i.message.headers.path].length<50&&this.privReceivedMessages[i.message.headers.path].push(i.networkReceivedTime)))}getTelemetry(){const i=new Array;this.privListeningTriggerMetric&&i.push(this.privListeningTriggerMetric),this.privMicMetric&&i.push(this.privMicMetric),this.privConnectionEstablishMetric&&i.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&i.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&i.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const s={Metrics:i,ReceivedMessages:this.privReceivedMessages},o=JSON.stringify(s);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],o}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(i){switch(i){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+i.toString()}}}return cg.ServiceTelemetryListener=t,cg}var qN;function M8(){if(qN)return lg;qN=1,Object.defineProperty(lg,"__esModule",{value:!0}),lg.RequestSession=void 0;const r=We(),e=RP(),t=k8();let n=class{constructor(s){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=s,this.privRequestId=(0,r.createNoDashGuid)(),this.privAudioNodeId=(0,r.createNoDashGuid)(),this.privTurnDeferral=new r.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(s){this.privServiceTelemetryListener&&this.privDetachables.push(s.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new t.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new e.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(s,o){this.privAudioNode=s,this.privIsAudioNodeDetached=!1,o?await this.onComplete():this.onEvent(new e.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(s,o){this.privAuthFetchEventId=s,this.privSessionId=o,this.onEvent(new e.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(s){s&&await this.onComplete()}async onConnectionEstablishCompleted(s,o){if(s===200){this.onEvent(new e.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else s===403&&await this.onComplete()}async onServiceTurnEndResponse(s){this.privTurnDeferral.resolve(),!s||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=(0,r.createNoDashGuid)()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new r.Deferred}onHypothesis(s){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(s)))}onPhraseRecognized(s){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(s)),this.onServiceRecognized(s)}onServiceRecognized(s){this.privLastRecoOffset=s,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(s),this.privConnectionAttempts=0}onAudioSent(s){this.privBytesSent+=s,this.privRecognitionBytesSent+=s}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const s of this.privDetachables)await s.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(s){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(s),r.Events.instance.onEvent(s)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}};return lg.RequestSession=n,lg}var ug={},hT={},GN;function N8(){return GN||(GN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.TentativePhraseResultsOption=r.OutputFormat=r.PhraseExtension=r.PhraseOption=void 0,(function(e){e.WordTimings="WordTimings",e.SNR="SNR",e.Pronunciation="Pronunciation",e.WordPronunciation="WordPronunciation",e.WordConfidence="WordConfidence",e.Words="Words",e.Sentiment="Sentiment",e.PronunciationAssessment="PronunciationAssessment",e.ContentAssessment="ContentAssessment",e.PhraseAMScore="PhraseAMScore",e.PhraseLMScore="PhraseLMScore",e.WordAMScore="WordAMScore",e.WordLMScore="WordLMScore",e.RuleTree="RuleTree",e.NBestTimings="NBestTimings",e.DecoderDiagnostics="DecoderDiagnostics",e.DisplayWordTimings="DisplayWordTimings",e.DisplayWords="DisplayWords"})(r.PhraseOption||(r.PhraseOption={})),(function(e){e.Graph="Graph",e.Corrections="Corrections",e.Sentiment="Sentiment"})(r.PhraseExtension||(r.PhraseExtension={})),(function(e){e.Simple="Simple",e.Detailed="Detailed"})(r.OutputFormat||(r.OutputFormat={})),(function(e){e.None="None",e.Always="Always"})(r.TentativePhraseResultsOption||(r.TentativePhraseResultsOption={}))})(hT)),hT}var KN;function L8(){if(KN)return ug;KN=1,Object.defineProperty(ug,"__esModule",{value:!0}),ug.SpeechContext=void 0;const r=is(),e=N8();let t=class{constructor(i){this.privContext={},this.privDynamicGrammar=i}getContext(){return this.privContext}setPronunciationAssessmentParams(i,s=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(i)||{},s&&(this.privContext.phraseDetection.mode=r.RecognitionMode.Conversation),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push(e.PhraseOption.PronunciationAssessment),this.privContext.phraseOutput.detailed.options.indexOf(e.PhraseOption.SNR)===-1&&this.privContext.phraseOutput.detailed.options.push(e.PhraseOption.SNR)}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=e.OutputFormat.Detailed}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=e.OutputFormat.Detailed,this.privContext.phraseOutput.detailed.options.indexOf(e.PhraseOption.WordTimings)===-1&&this.privContext.phraseOutput.detailed.options.push(e.PhraseOption.WordTimings)}setSpeakerDiarizationAudioOffsetMs(i){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=i}toJSON(){const i=this.privDynamicGrammar.generateGrammarObject();return this.privContext.dgi=i,JSON.stringify(this.privContext)}};return ug.SpeechContext=t,ug}var dg={},pT={},YN;function _8(){return YN||(YN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SubstringMatchType=r.GroupType=void 0,(function(e){e.IntentText="IntentText",e.IntentEntity="IntentEntity",e.Generic="Generic",e.People="People",e.Place="Place",e.DynamicEntity="DynamicEntity"})(r.GroupType||(r.GroupType={})),(function(e){e.None="None",e.LeftRooted="LeftRooted",e.PartialName="PartialName",e.MiddleOfSentence="MiddleOfSentence"})(r.SubstringMatchType||(r.SubstringMatchType={}))})(pT)),pT}var XN;function O8(){if(XN)return dg;XN=1,Object.defineProperty(dg,"__esModule",{value:!0}),dg.DynamicGrammarBuilder=void 0;const r=_8();let e=class{constructor(){this.privWeight=1}addPhrase(n){this.privPhrases||(this.privPhrases=[]),n instanceof Array?this.privPhrases=this.privPhrases.concat(n):this.privPhrases.push(n)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(n){this.privGrammars||(this.privGrammars=[]),n instanceof Array?this.privGrammars=this.privGrammars.concat(n):this.privGrammars.push(n)}clearGrammars(){this.privGrammars=void 0}setWeight(n){this.privWeight=n}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const n={};if(n.referenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const i=[];this.privPhrases.forEach(s=>{i.push({text:s})}),n.groups=[{type:r.GroupType.Generic,items:i}],n.bias=this.privWeight}return n}};return dg.DynamicGrammarBuilder=e,dg}var hg={},pg={},fg={},fT={},JN;function rO(){return JN||(JN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.MessageDataStreamType=r.ActivityPayloadResponse=void 0;class e{constructor(n){this.privActivityResponse=JSON.parse(n)}static fromJSON(n){return new e(n)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}r.ActivityPayloadResponse=e,(function(t){t[t.None=0]="None",t[t.TextToSpeechAudio=1]="TextToSpeechAudio"})(r.MessageDataStreamType||(r.MessageDataStreamType={}))})(fT)),fT}var QN;function D8(){if(QN)return fg;QN=1,Object.defineProperty(fg,"__esModule",{value:!0}),fg.DialogServiceTurnState=void 0;const r=sy(),e=Xh(),t=rO();let n=class{constructor(s,o){this.privRequestId=o,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=s,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(s,o){return s.messageDataStreamType===t.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=e.AudioOutputStream.createPullStream(),this.privAudioStream.format=o!==void 0?o:r.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};return fg.DialogServiceTurnState=n,fg}var e2;function j8(){if(e2)return pg;e2=1,Object.defineProperty(pg,"__esModule",{value:!0}),pg.DialogServiceTurnStateManager=void 0;const r=Zs(),e=D8();let t=class{constructor(){this.privTurnMap=new Map}StartTurn(i){if(this.privTurnMap.has(i))throw new r.InvalidOperationError("Service error: There is already a turn with id:"+i);const s=new e.DialogServiceTurnState(this,i);return this.privTurnMap.set(i,s),this.privTurnMap.get(i)}GetTurn(i){return this.privTurnMap.get(i)}CompleteTurn(i){if(!this.privTurnMap.has(i))throw new r.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+i);const s=this.privTurnMap.get(i);return s.complete(),this.privTurnMap.delete(i),s}};return pg.DialogServiceTurnStateManager=t,pg}var mT={},t2;function B8(){return t2||(t2=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.InvocationSource=void 0,(function(e){e.None="None",e.VoiceActivationWithKeyword="VoiceActivationWithKeyword"})(r.InvocationSource||(r.InvocationSource={}))})(mT)),mT}var gT={},r2;function z8(){return r2||(r2=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.OnRejectAction=r.KeywordDetectionType=void 0,(function(e){e.StartTrigger="StartTrigger"})(r.KeywordDetectionType||(r.KeywordDetectionType={})),(function(e){e.EndOfTurn="EndOfTurn",e.Continue="Continue"})(r.OnRejectAction||(r.OnRejectAction={}))})(gT)),gT}var n2;function F8(){if(n2)return hg;n2=1,Object.defineProperty(hg,"__esModule",{value:!0}),hg.DialogServiceAdapter=void 0;const r=In(),e=p_(),t=We(),n=sy(),i=xe(),s=j8(),o=Oe(),a=rO(),l=B8(),u=z8(),h=aA();let m=class extends o.ServiceRecognizerBase{constructor(v,y,A,x,b){super(v,y,A,x,b),this.privEvents=new t.EventSource,this.privDialogServiceConnector=b,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new s.DialogServiceTurnStateManager,this.recognizeOverride=(w,T,k)=>this.listenOnce(w,T,k),this.postConnectImplOverride=w=>this.dialogConnectImpl(w),this.configConnectionOverride=w=>this.configConnection(w),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=A,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(w=>{w.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(v){const y=(0,t.createGuid)(),A=(0,t.createNoDashGuid)(),x={context:{interactionId:y},messagePayload:JSON.parse(v),version:.5},b=JSON.stringify(x);await(await this.fetchConnection()).send(new h.SpeechConnectionMessage(t.MessageType.Text,"agent",A,"application/json",b))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(v){const y=new i.PropertyCollection;v.messageType===t.MessageType.Text&&y.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,v.textBody);let A,x;switch(v.path.toLowerCase()){case"speech.phrase":const w=o.SimpleSpeechPhrase.fromJSON(v.textBody,this.privRequestSession.currentTurnAudioOffset);if(this.privRequestSession.onPhraseRecognized(w.Offset+w.Duration),w.RecognitionStatus!==o.RecognitionStatus.TooManyRequests&&w.RecognitionStatus!==o.RecognitionStatus.Error){const L=this.fireEventForResult(w,y);if(this.privLastResult=L.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,L)}catch{}}x=!0;break;case"speech.hypothesis":const T=o.SpeechHypothesis.fromJSON(v.textBody,this.privRequestSession.currentTurnAudioOffset);A=new i.SpeechRecognitionResult(this.privRequestSession.requestId,i.ResultReason.RecognizingSpeech,T.Text,T.Duration,T.Offset,T.Language,T.LanguageDetectionConfidence,void 0,void 0,T.asJson(),y),this.privRequestSession.onHypothesis(T.Offset);const k=new i.SpeechRecognitionEventArgs(A,T.Offset,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,k)}catch{}x=!0;break;case"speech.keyword":const I=o.SpeechKeyword.fromJSON(v.textBody,this.privRequestSession.currentTurnAudioOffset);A=new i.SpeechRecognitionResult(this.privRequestSession.requestId,I.Status==="Accepted"?i.ResultReason.RecognizedKeyword:i.ResultReason.NoMatch,I.Text,I.Duration,I.Offset,void 0,void 0,void 0,void 0,I.asJson(),y),I.Status!=="Accepted"&&(this.privLastResult=A);const M=new i.SpeechRecognitionEventArgs(A,A.duration,A.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,M)}catch{}x=!0;break;case"audio":{const L=v.requestId.toUpperCase(),j=this.privTurnStateManager.GetTurn(L);try{v.binaryBody?j.audioStream.write(v.binaryBody):j.endAudioStream()}catch{}}x=!0;break;case"response":this.handleResponseMessage(v),x=!0;break}const b=new t.Deferred;return b.resolve(x),b.promise}async cancelRecognition(v,y,A,x,b){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const w=new i.PropertyCollection;w.setProperty(o.CancellationErrorCodePropertyName,i.CancellationErrorCode[x]);const T=new i.SpeechRecognitionCanceledEventArgs(A,b,x,void 0,v);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,T)}catch{}if(this.privSuccessCallback){const k=new i.SpeechRecognitionResult(void 0,i.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,b,void 0,w);try{this.privSuccessCallback(k),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(v,y,A){this.privRecognizerConfig.recognitionMode=v,this.privSuccessCallback=y,this.privErrorCallback=A,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(i.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const x=this.connectImpl(),b=this.sendPreAudioMessages(),w=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),T=await this.privDialogAudioSource.format,k=await this.privDialogAudioSource.deviceInfo,I=new r.ReplayableAudioNode(w,T.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(I,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:k};try{await x,await b}catch(j){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,j),Promise.resolve()}const M=new i.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,M),this.sendAudio(I).then(()=>{},async j=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,j)})}dialogConnectImpl(v){return this.privConnectionLoop=this.startMessageLoop(),v}receiveDialogMessageOverride(){const v=new t.Deferred,y=async()=>{try{const A=this.isDisposed(),x=!this.isDisposed()&&this.terminateMessageLoop;if(A||x){v.resolve(void 0);return}const w=await(await this.fetchConnection()).read();if(!w)return y();const T=h.SpeechConnectionMessage.fromConnectionMessage(w);switch(T.path.toLowerCase()){case"turn.start":{const z=T.requestId.toUpperCase(),Z=this.privRequestSession.requestId.toUpperCase();z!==Z?this.privTurnStateManager.StartTurn(z):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const I=o.SpeechDetected.fromJSON(T.textBody,this.privRequestSession.currentTurnAudioOffset),M=new i.RecognitionEventArgs(I.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,M);break;case"speech.enddetected":let L;T.textBody.length>0?L=T.textBody:L="{ Offset: 0 }";const j=o.SpeechDetected.fromJSON(L,this.privRequestSession.currentTurnAudioOffset);this.privRequestSession.onServiceRecognized(j.Offset);const B=new i.RecognitionEventArgs(j.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,B);break;case"turn.end":{const z=T.requestId.toUpperCase(),Z=this.privRequestSession.requestId.toUpperCase();if(z!==Z)this.privTurnStateManager.CompleteTurn(z);else{const $=new i.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,$),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(U){this.privErrorCallback&&this.privErrorCallback(U)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(T)||this.serviceEvents&&this.serviceEvents.onEvent(new t.ServiceEvent(T.path.toLowerCase(),T.textBody))}catch{}}return y()}catch{this.terminateMessageLoop=!0,v.resolve()}};return y().catch(A=>{t.Events.instance.onEvent(new t.BackgroundEvent(A))}),v.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(v){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,v)}return Promise.resolve()}async configConnection(v){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(v,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(v),v)}async sendPreAudioMessages(){const v=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(v,!0),await this.sendAgentContext(v),await this.sendWaveHeader(v)}sendAgentConfig(v){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Conversation_DialogType)===i.DialogServiceConfig.DialogTypes.CustomCommands){const A=this.agentConfig.get();A.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(A)}this.onEvent(new e.SendingAgentContextMessageEvent(this.agentConfig));const y=this.agentConfig.toJsonString();return this.agentConfigSent=!0,v.send(new h.SpeechConnectionMessage(t.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",y))}}sendAgentContext(v){const y=(0,t.createGuid)(),A=this.privDialogServiceConnector.properties.getProperty(i.PropertyId.Conversation_Speech_Activity_Template),b=JSON.stringify({channelData:"",context:{interactionId:y},messagePayload:typeof A===void 0?void 0:A,version:.5});return v.send(new h.SpeechConnectionMessage(t.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",b))}fireEventForResult(v,y){const A=o.EnumTranslation.implTranslateRecognitionResult(v.RecognitionStatus),x=new i.SpeechRecognitionResult(this.privRequestSession.requestId,A,v.DisplayText,v.Duration,v.Offset,v.Language,v.LanguageDetectionConfidence,void 0,void 0,v.asJson(),y);return new i.SpeechRecognitionEventArgs(x,v.Offset,this.privRequestSession.sessionId)}handleResponseMessage(v){const y=JSON.parse(v.textBody);switch(y.messageType.toLowerCase()){case"message":const A=v.requestId.toUpperCase(),x=a.ActivityPayloadResponse.fromJSON(v.textBody),b=this.privTurnStateManager.GetTurn(A);if(x.conversationId){const k=this.agentConfig.get();k.botInfo.conversationId=x.conversationId,this.agentConfig.set(k)}const w=b.processActivityPayload(x,n.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),T=new i.ActivityReceivedEventArgs(x.messagePayload,w);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,T)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new i.TurnStatusReceivedEventArgs(v.textBody))}catch{}break;default:t.Events.instance.onEvent(new t.BackgroundEvent(`Unexpected response of type ${y.messageType}. Ignoring.`));break}}onEvent(v){this.privEvents.onEvent(v),t.Events.instance.onEvent(v)}addKeywordContextData(){const v=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(v===void 0)return;const y=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),A=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),x=v.split(";"),b=y===void 0?[]:y.split(";"),w=A===void 0?[]:A.split(";"),T=[];for(let k=0;k<x.length;k++){const I={text:x[k]};k<b.length&&(I.startOffset=Number(b[k])),k<w.length&&(I.duration=Number(w[k])),T.push(I)}this.speechContext.getContext().invocationSource=l.InvocationSource.VoiceActivationWithKeyword,this.speechContext.getContext().keywordDetection=[{clientDetectedKeywords:T,onReject:{action:u.OnRejectAction.EndOfTurn},type:u.KeywordDetectionType.StartTrigger}]}};return hg.DialogServiceAdapter=m,hg}var mg={},i2;function W8(){if(i2)return mg;i2=1,Object.defineProperty(mg,"__esModule",{value:!0}),mg.AgentConfig=void 0;let r=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(t){this.iPrivConfig=t}};return mg.AgentConfig=r,mg}var vT={},gg={},vg={},s2;function LP(){if(s2)return vg;s2=1,Object.defineProperty(vg,"__esModule",{value:!0}),vg.ConversationConnectionConfig=void 0;const r=K_();let e=class Ra extends r.RestConfigBase{static get host(){return Ra.privHost}static get apiVersion(){return Ra.privApiVersion}static get clientAppId(){return Ra.privClientAppId}static get defaultLanguageCode(){return Ra.privDefaultLanguageCode}static get restPath(){return Ra.privRestPath}static get webSocketPath(){return Ra.privWebSocketPath}static get transcriptionEventKeys(){return Ra.privTranscriptionEventKeys}};return vg.ConversationConnectionConfig=e,e.privHost="dev.microsofttranslator.com",e.privRestPath="/capito/room",e.privApiVersion="2.0",e.privDefaultLanguageCode="en-US",e.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",e.privWebSocketPath="/capito/translate",e.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"],vg}var o2;function U8(){if(o2)return gg;o2=1,Object.defineProperty(gg,"__esModule",{value:!0}),gg.ConversationManager=void 0;const r=In(),e=rt(),t=xe(),n=LP();let i=class{constructor(){this.privRequestParams=n.ConversationConnectionConfig.configParams,this.privErrors=n.ConversationConnectionConfig.restErrors,this.privHost=n.ConversationConnectionConfig.host,this.privApiVersion=n.ConversationConnectionConfig.apiVersion,this.privRestPath=n.ConversationConnectionConfig.restPath,this.privRestAdapter=new r.RestMessageAdapter({})}createOrJoin(o,a,l,u){try{e.Contracts.throwIfNullOrUndefined(o,"args");const h=o.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,n.ConversationConnectionConfig.defaultLanguageCode),m=o.getProperty(t.PropertyId.ConversationTranslator_Name,"conversation_host"),g=o.getProperty(t.PropertyId.ConversationTranslator_Host,this.privHost),v=o.getProperty(t.PropertyId.ConversationTranslator_CorrelationId),y=o.getProperty(t.PropertyId.SpeechServiceConnection_Key),A=o.getProperty(t.PropertyId.SpeechServiceConnection_Region),x=o.getProperty(t.PropertyId.SpeechServiceAuthorization_Token);e.Contracts.throwIfNullOrWhitespace(h,"languageCode"),e.Contracts.throwIfNullOrWhitespace(m,"nickname"),e.Contracts.throwIfNullOrWhitespace(g,"endpointHost");const b={};b[this.privRequestParams.apiVersion]=this.privApiVersion,b[this.privRequestParams.languageCode]=h,b[this.privRequestParams.nickname]=m;const w={};v&&(w[this.privRequestParams.correlationId]=v),w[this.privRequestParams.clientAppId]=n.ConversationConnectionConfig.clientAppId,a!==void 0?b[this.privRequestParams.roomId]=a:(e.Contracts.throwIfNullOrUndefined(A,this.privErrors.authInvalidSubscriptionRegion),w[this.privRequestParams.subscriptionRegion]=A,y?w[this.privRequestParams.subscriptionKey]=y:x?w[this.privRequestParams.authorization]=`Bearer ${x}`:e.Contracts.throwIfNullOrUndefined(y,this.privErrors.authInvalidSubscriptionKey));const T={};T.headers=w,this.privRestAdapter.options=T;const k=`https://${g}${this.privRestPath}`;this.privRestAdapter.request(r.RestRequestType.Post,k,b,null).then(I=>{const M=r.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,I.headers);if(!I.ok){if(u){let j=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",I.status.toString()),B;try{B=JSON.parse(I.data),j+=` [${B.error.code}: ${B.error.message}]`}catch{j+=` [${I.data}]`}M&&(j+=` ${M}`),u(j)}return}const L=JSON.parse(I.data);if(L&&(L.requestId=M),l){try{l(L)}catch(j){u&&u(j)}l=void 0}}).catch(()=>{})}catch(h){if(u)if(h instanceof Error){const m=h;u(m.name+": "+m.message)}else u(h)}}leave(o,a){return new Promise((l,u)=>{try{e.Contracts.throwIfNullOrUndefined(o,this.privErrors.invalidArgs.replace("{arg}","config")),e.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","token"));const h=o.getProperty(t.PropertyId.ConversationTranslator_Host,this.privHost),m=o.getProperty(t.PropertyId.ConversationTranslator_CorrelationId),g={};g[this.privRequestParams.apiVersion]=this.privApiVersion,g[this.privRequestParams.sessionToken]=a;const v={};m&&(v[this.privRequestParams.correlationId]=m);const y={};y.headers=v,this.privRestAdapter.options=y;const A=`https://${h}${this.privRestPath}`;this.privRestAdapter.request(r.RestRequestType.Delete,A,g,null).then(x=>{x.ok,l()}).catch(()=>{})}catch(h){if(h instanceof Error){const m=h;u(m.name+": "+m.message)}else u(h)}})}};return gg.ConversationManager=i,gg}var nc={},Sg={},yg={},Cg={},a2;function nO(){if(a2)return Cg;a2=1,Object.defineProperty(Cg,"__esModule",{value:!0}),Cg.ConversationConnectionMessage=void 0;const r=We();let e=class extends r.ConnectionMessage{constructor(n,i,s,o){super(n,i,s,o);const a=JSON.parse(this.textBody);a.type!==void 0&&(this.privConversationMessageType=a.type)}get conversationMessageType(){return this.privConversationMessageType}};return Cg.ConversationConnectionMessage=e,Cg}var l2;function Z8(){if(l2)return yg;l2=1,Object.defineProperty(yg,"__esModule",{value:!0}),yg.ConversationWebsocketMessageFormatter=void 0;const r=We(),e=nO();let t=class{toConnectionMessage(i){const s=new r.Deferred;try{if(i.messageType===r.MessageType.Text){const o=new e.ConversationConnectionMessage(i.messageType,i.textContent,{},i.id);s.resolve(o)}else i.messageType===r.MessageType.Binary&&s.resolve(new e.ConversationConnectionMessage(i.messageType,i.binaryContent,void 0,i.id))}catch(o){s.reject(`Error formatting the message. Error: ${o}`)}return s.promise}fromConnectionMessage(i){const s=new r.Deferred;try{if(i.messageType===r.MessageType.Text){const o=`${i.textBody?i.textBody:""}`;s.resolve(new r.RawWebsocketMessage(r.MessageType.Text,o,i.id))}}catch(o){s.reject(`Error formatting the message. ${o}`)}return s.promise}};return yg.ConversationWebsocketMessageFormatter=t,yg}var c2;function $8(){if(c2)return Sg;c2=1,Object.defineProperty(Sg,"__esModule",{value:!0}),Sg.ConversationConnectionFactory=void 0;const r=In(),e=We(),t=rt(),n=xe(),i=Jo(),s=LP(),o=Z8();let a=class extends i.ConnectionFactoryBase{create(u,h,m){const g=u.parameters.getProperty(n.PropertyId.ConversationTranslator_Host,s.ConversationConnectionConfig.host),v=u.parameters.getProperty(n.PropertyId.ConversationTranslator_CorrelationId,(0,e.createGuid)()),y=`wss://${g}${s.ConversationConnectionConfig.webSocketPath}`,A=u.parameters.getProperty(n.PropertyId.ConversationTranslator_Token,void 0);t.Contracts.throwIfNullOrUndefined(A,"token");const x={};x[s.ConversationConnectionConfig.configParams.apiVersion]=s.ConversationConnectionConfig.apiVersion,x[s.ConversationConnectionConfig.configParams.token]=A,x[s.ConversationConnectionConfig.configParams.correlationId]=v;const b=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new r.WebsocketConnection(y,x,{},new o.ConversationWebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(u),b,m))}};return Sg.ConversationConnectionFactory=a,Sg}var Ag={},bg={},u2;function H8(){if(u2)return bg;u2=1,Object.defineProperty(bg,"__esModule",{value:!0}),bg.ConversationRequestSession=void 0;const r=We();let e=class{constructor(n){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=n,this.privRequestId=(0,r.createNoDashGuid)(),this.privRequestCompletionDeferral=new r.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(n,i){this.privSessionId=i}onAuthCompleted(n){n&&this.onComplete()}onConnectionEstablishCompleted(n){n!==200&&n===403&&this.onComplete()}onServiceTurnEndResponse(n){n?this.privRequestId=(0,r.createNoDashGuid)():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const n of this.privDetachables)await n.detach()}}onComplete(){}};return bg.ConversationRequestSession=e,bg}var nn={},d2;function iO(){if(d2)return nn;d2=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.ConversationReceivedTranslationEventArgs=nn.ParticipantsListEventArgs=nn.ParticipantAttributeEventArgs=nn.ParticipantEventArgs=nn.LockRoomEventArgs=nn.MuteAllEventArgs=void 0;const r=xe();class e extends r.SessionEventArgs{constructor(l,u){super(u),this.privIsMuted=l}get isMuted(){return this.privIsMuted}}nn.MuteAllEventArgs=e;class t extends r.SessionEventArgs{constructor(l,u){super(u),this.privIsLocked=l}get isMuted(){return this.privIsLocked}}nn.LockRoomEventArgs=t;class n extends r.SessionEventArgs{constructor(l,u){super(u),this.privParticipant=l}get participant(){return this.privParticipant}}nn.ParticipantEventArgs=n;class i extends r.SessionEventArgs{constructor(l,u,h,m){super(m),this.privKey=u,this.privValue=h,this.privParticipantId=l}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}nn.ParticipantAttributeEventArgs=i;class s extends r.SessionEventArgs{constructor(l,u,h,m,g,v,y,A,x){super(x),this.privRoomId=l,this.privSessionToken=u,this.privTranslateTo=h,this.privProfanityFilter=m,this.privRoomProfanityFilter=g,this.privIsRoomLocked=v,this.privIsRoomLocked=y,this.privParticipants=A}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}nn.ParticipantsListEventArgs=s;class o{constructor(l,u,h){this.privPayload=u,this.privCommand=l,this.privSessionId=h}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}return nn.ConversationReceivedTranslationEventArgs=o,nn}var io={},h2;function sO(){if(h2)return io;h2=1,Object.defineProperty(io,"__esModule",{value:!0}),io.ConversationTranslatorCommandTypes=io.ConversationTranslatorMessageTypes=io.InternalParticipants=void 0;class r{constructor(t=[],n){this.participants=t,this.meId=n}addOrUpdateParticipant(t){if(t===void 0)return;const n=this.getParticipantIndex(t.id);return n>-1?this.participants.splice(n,1,t):this.participants.push(t),this.getParticipant(t.id)}getParticipantIndex(t){return this.participants.findIndex(n=>n.id===t)}getParticipant(t){return this.participants.find(n=>n.id===t)}deleteParticipant(t){this.participants=this.participants.filter(n=>n.id!==t)}get host(){return this.participants.find(t=>t.isHost===!0)}get me(){return this.getParticipant(this.meId)}}return io.InternalParticipants=r,io.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},io.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"},io}var ST={},xg={},p2;function V8(){if(p2)return xg;p2=1,Object.defineProperty(xg,"__esModule",{value:!0}),xg.CommandResponsePayload=void 0;const r=t=>JSON.parse(t);let e=class oO{constructor(n){this.privCommandResponse=r(n)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(n){return new oO(n)}};return xg.CommandResponsePayload=e,xg}var ic={},f2;function q8(){if(f2)return ic;f2=1,Object.defineProperty(ic,"__esModule",{value:!0}),ic.ParticipantPayloadResponse=ic.ParticipantsListPayloadResponse=void 0;const r=i=>JSON.parse(i),e=i=>JSON.parse(i);class t{constructor(s){this.privParticipantsPayloadResponse=r(s)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(s){return new t(s)}}ic.ParticipantsListPayloadResponse=t;class n{constructor(s){this.privParticipantPayloadResponse=e(s)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(s){return new n(s)}}return ic.ParticipantPayloadResponse=n,ic}var sc={},m2;function G8(){if(m2)return sc;m2=1,Object.defineProperty(sc,"__esModule",{value:!0}),sc.TextResponsePayload=sc.SpeechResponsePayload=void 0;const r=i=>JSON.parse(i),e=i=>JSON.parse(i);class t{constructor(s){this.privSpeechResponse=r(s)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(s){return new t(s)}}sc.SpeechResponsePayload=t;class n{constructor(s){this.privTextResponse=e(s)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(s){return new n(s)}}return sc.TextResponsePayload=n,sc}var g2;function K8(){return g2||(g2=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.TextResponsePayload=r.SpeechResponsePayload=r.ParticipantPayloadResponse=r.ParticipantsListPayloadResponse=r.CommandResponsePayload=void 0;var e=V8();Object.defineProperty(r,"CommandResponsePayload",{enumerable:!0,get:function(){return e.CommandResponsePayload}});var t=q8();Object.defineProperty(r,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return t.ParticipantsListPayloadResponse}}),Object.defineProperty(r,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return t.ParticipantPayloadResponse}});var n=G8();Object.defineProperty(r,"SpeechResponsePayload",{enumerable:!0,get:function(){return n.SpeechResponsePayload}}),Object.defineProperty(r,"TextResponsePayload",{enumerable:!0,get:function(){return n.TextResponsePayload}})})(ST)),ST}var v2;function Y8(){if(v2)return Ag;v2=1,Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.ConversationServiceAdapter=void 0;const r=We(),e=xe(),t=Oe(),n=nO(),i=H8(),s=iO(),o=sO(),a=K8();let l=class extends t.ServiceRecognizerBase{constructor(h,m,g,v,y){super(h,m,g,v,y),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=y,this.privConversationAuthentication=h,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=A=>this.conversationConnectImpl(A),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new i.ConversationRequestSession((0,r.createNoDashGuid)()),this.privConversationConnectionFactory=m,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(h){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(h),await super.dispose(h)}async sendMessage(h){return(await this.fetchConnection()).send(new n.ConversationConnectionMessage(r.MessageType.Text,h))}async sendMessageAsync(h){await(await this.fetchConnection()).send(new n.ConversationConnectionMessage(r.MessageType.Text,h))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,e.CancellationReason.Error,e.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(h,m,g,v,y){this.terminateMessageLoop=!0;const A=new e.ConversationTranslationCanceledEventArgs(g,y,v,void 0,h);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,A)}catch{}}async conversationConnectImpl(h){return this.privConnectionLoop=this.startMessageLoop(),h}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const h=new r.Deferred;try{const g=await(await this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return h.resolve(),Promise.resolve();if(!g)return this.receiveConversationMessageOverride();const v=this.privConversationRequestSession.sessionId,y=g.conversationMessageType.toLowerCase();let A=!1;try{switch(y){case"info":case"participant_command":case"command":const x=a.CommandResponsePayload.fromJSON(g.textBody);switch(x.command.toLowerCase()){case"participantlist":const M=a.ParticipantsListPayloadResponse.fromJSON(g.textBody),L=M.participants.map(U=>({avatar:U.avatar,displayName:U.nickname,id:U.participantId,isHost:U.ishost,isMuted:U.ismuted,isUsingTts:U.usetts,preferredLanguage:U.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new s.ParticipantsListEventArgs(M.roomid,M.token,M.translateTo,M.profanityFilter,M.roomProfanityFilter,M.roomLocked,M.muteAll,L,v));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(x.participantId,o.ConversationTranslatorCommandTypes.setTranslateToLanguages,x.value,v));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(x.participantId,o.ConversationTranslatorCommandTypes.setProfanityFiltering,x.value,v));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(x.participantId,o.ConversationTranslatorCommandTypes.setMute,x.value,v));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new s.MuteAllEventArgs(x.value,v));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new e.ConversationExpirationEventArgs(x.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(x.participantId,o.ConversationTranslatorCommandTypes.setUseTTS,x.value,v));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new s.LockRoomEventArgs(x.value,v));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(x.participantId,o.ConversationTranslatorCommandTypes.changeNickname,x.value,v));break;case"joinsession":const j=a.ParticipantPayloadResponse.fromJSON(g.textBody),B={avatar:j.avatar,displayName:j.nickname,id:j.participantId,isHost:j.ishost,isMuted:j.ismuted,isUsingTts:j.usetts,preferredLanguage:j.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new s.ParticipantEventArgs(B,v));break;case"leavesession":const z={id:x.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new s.ParticipantEventArgs(z,v));break;case"disconnectsession":const Z={id:x.participantId};break;case"token":const $=new t.CognitiveTokenAuthentication(()=>{const U=x.token;return Promise.resolve(U)},()=>{const U=x.token;return Promise.resolve(U)});this.authentication=$,this.privConversationServiceConnector.onToken($);break;default:break}break;case"partial":case"final":const b=a.SpeechResponsePayload.fromJSON(g.textBody),w=y==="final"?e.ResultReason.TranslatedParticipantSpeech:e.ResultReason.TranslatingParticipantSpeech,T=new e.ConversationTranslationResult(b.participantId,this.getTranslations(b.translations),b.language,b.id,w,b.recognition,void 0,void 0,g.textBody,void 0);b.isFinal?((T.text!==void 0&&T.text.length>0||b.id===this.privLastPartialUtteranceId)&&(A=!0),A&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(o.ConversationTranslatorMessageTypes.final,T,v))):T.text!==void 0&&(this.privLastPartialUtteranceId=b.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(o.ConversationTranslatorMessageTypes.partial,T,v)));break;case"translated_message":const k=a.TextResponsePayload.fromJSON(g.textBody),I=new e.ConversationTranslationResult(k.participantId,this.getTranslations(k.translations),k.language,void 0,void 0,k.originalText,void 0,void 0,void 0,g.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(o.ConversationTranslatorMessageTypes.instantMessage,I,v));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return h.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const h=this.receiveConversationMessageOverride();try{return await h}catch(m){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",e.CancellationReason.Error,e.CancellationErrorCode.RuntimeError,m),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(h=>h.state()===r.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(h=>h),this.privConnectionConfigPromise)}getTranslations(h){let m;if(h!==void 0){m=new e.Translations;for(const g of h)m.set(g.lang,g.translation)}return m}};return Ag.ConversationServiceAdapter=l,Ag}var S2;function X8(){if(S2)return nc;S2=1,Object.defineProperty(nc,"__esModule",{value:!0}),nc.ConversationTranslatorRecognizer=nc.ConversationRecognizerFactory=void 0;const r=Oe(),e=We(),t=rt(),n=xe(),i=$8(),s=Y8();class o{static fromConfig(u,h,m){return new a(u,h,m)}}nc.ConversationRecognizerFactory=o;let a=class extends n.Recognizer{constructor(u,h,m){const g=h;t.Contracts.throwIfNull(g,"speechConfig");const v=u;t.Contracts.throwIfNull(v,"conversationImpl"),super(m,g.properties,new i.ConversationConnectionFactory),this.privConversation=v,this.privIsDisposed=!1,this.privProperties=g.properties.clone(),this.privConnection=n.Connection.fromRecognizer(this),this.privProperties.getProperty(n.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=e.Timeout.setTimeout,this.privClearTimeout=e.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(u){this.privConnection.connected=u}set disconnected(u){this.privConnection.disconnected=u}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(u,h,m){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfNullOrWhitespace(u,"token"),this.privReco.conversationTranslatorToken=u,this.resetConversationTimeout(),this.privReco.connectAsync(h,m)}catch(g){if(m)if(g instanceof Error){const v=g;m(v.name+": "+v.message)}else m(g)}}disconnect(u,h){try{t.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{u&&u()},m=>{h&&h(m)})}catch(m){if(h)if(m instanceof Error){const g=m;h(g.name+": "+g.message)}else h(m);this.dispose(!0).catch(g=>{e.Events.instance.onEvent(new e.BackgroundEvent(g))})}}sendRequest(u,h,m){try{t.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(u,h,m)}catch(g){if(m)if(g instanceof Error){const v=g;m(v.name+": "+v.message)}else m(g);this.dispose(!0).catch(v=>{e.Events.instance.onEvent(new e.BackgroundEvent(v))})}}onToken(u){this.privConversation.onToken(u)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(u){this.privIsDisposed||u&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(u))}createRecognizerConfig(u){return new r.RecognizerConfig(u,this.privProperties)}createServiceRecognizer(u,h,m,g){const v=m;return new s.ConversationServiceAdapter(u,h,v,g,this)}sendMessage(u,h,m){const g=this.privReco;((y,A,x)=>{y!==void 0?y.then(()=>{try{A&&A()}catch(b){x&&x(`'Unhandled error on promise callback: ${b}'`)}},b=>{try{x&&x(b)}catch{}}):x&&x("Null promise")})(g.sendMessageAsync(u),h,m),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};return nc.ConversationTranslatorRecognizer=a,nc}var Tg={},y2;function J8(){if(y2)return Tg;y2=1,Object.defineProperty(Tg,"__esModule",{value:!0}),Tg.TranscriberRecognizer=void 0;const r=We(),e=rt(),t=xe(),n=Oe(),i=is();let s=class extends t.Recognizer{constructor(a,l){const u=a;e.Contracts.throwIfNull(u,"speechTranslationConfig");const h=l;e.Contracts.throwIfNull(h,"audioConfigImpl"),e.Contracts.throwIfNullOrWhitespace(u.speechRecognitionLanguage,t.PropertyId[t.PropertyId.SpeechServiceConnection_RecoLanguage]),super(l,u.properties,new n.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return e.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(t.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){e.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,a)}set conversation(a){e.Contracts.throwIfNullOrUndefined(a,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=a}getConversationInfo(){return e.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(a){e.Contracts.throwIfNullOrUndefined(a,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=a}getMeetingInfo(){return e.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(a,l){(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(i.RecognitionMode.Conversation),a,l)}stopContinuousRecognitionAsync(a,l){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),a,l)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(a,l){const u=this.privReco;e.Contracts.throwIfNullOrUndefined(u,"serviceRecognizer"),await u.sendSpeechEventAsync(a,l)}async pushMeetingEvent(a,l){const u=this.privReco;e.Contracts.throwIfNullOrUndefined(u,"serviceRecognizer"),await u.sendMeetingSpeechEventAsync(a,l)}async enforceAudioGating(){const u=(await this.audioConfig.format).channels;if(u===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(u!==8)throw new Error(`Unsupported audio configuration: Detected ${u}-channel audio`)}connectMeetingCallbacks(a){this.isMeetingRecognizer=!0,this.canceled=(l,u)=>{a.canceled&&a.canceled(a,u)},this.recognizing=(l,u)=>{a.transcribing&&a.transcribing(a,u)},this.recognized=(l,u)=>{a.transcribed&&a.transcribed(a,u)},this.sessionStarted=(l,u)=>{a.sessionStarted&&a.sessionStarted(a,u)},this.sessionStopped=(l,u)=>{a.sessionStopped&&a.sessionStopped(a,u)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new n.RecognizerConfig(a,this.properties)}createServiceRecognizer(a,l,u,h){const m=u;return new n.TranscriptionServiceRecognizer(a,l,m,h,this)}};return Tg.TranscriberRecognizer=s,Tg}var C2;function Q8(){return C2||(C2=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.InternalParticipants=r.ConversationTranslatorMessageTypes=r.ConversationTranslatorCommandTypes=r.ParticipantsListEventArgs=r.ParticipantEventArgs=r.ParticipantAttributeEventArgs=r.MuteAllEventArgs=r.LockRoomEventArgs=r.ConversationReceivedTranslationEventArgs=r.TranscriberRecognizer=r.ConversationRecognizerFactory=r.ConversationConnectionConfig=r.ConversationManager=void 0;var e=U8();Object.defineProperty(r,"ConversationManager",{enumerable:!0,get:function(){return e.ConversationManager}});var t=LP();Object.defineProperty(r,"ConversationConnectionConfig",{enumerable:!0,get:function(){return t.ConversationConnectionConfig}});var n=X8();Object.defineProperty(r,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return n.ConversationRecognizerFactory}});var i=J8();Object.defineProperty(r,"TranscriberRecognizer",{enumerable:!0,get:function(){return i.TranscriberRecognizer}});var s=iO();Object.defineProperty(r,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return s.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(r,"LockRoomEventArgs",{enumerable:!0,get:function(){return s.LockRoomEventArgs}}),Object.defineProperty(r,"MuteAllEventArgs",{enumerable:!0,get:function(){return s.MuteAllEventArgs}}),Object.defineProperty(r,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return s.ParticipantAttributeEventArgs}}),Object.defineProperty(r,"ParticipantEventArgs",{enumerable:!0,get:function(){return s.ParticipantEventArgs}}),Object.defineProperty(r,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return s.ParticipantsListEventArgs}});var o=sO();Object.defineProperty(r,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return o.ConversationTranslatorCommandTypes}}),Object.defineProperty(r,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return o.ConversationTranslatorMessageTypes}}),Object.defineProperty(r,"InternalParticipants",{enumerable:!0,get:function(){return o.InternalParticipants}})})(vT)),vT}var yT={},A2;function aO(){return A2||(A2=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SynthesisAudioMetadata=r.MetadataType=void 0,(function(t){t.WordBoundary="WordBoundary",t.Bookmark="Bookmark",t.Viseme="Viseme",t.SentenceBoundary="SentenceBoundary",t.SessionEnd="SessionEnd",t.AvatarSignal="TalkingAvatarSignal"})(r.MetadataType||(r.MetadataType={}));class e{constructor(n){this.privSynthesisAudioMetadata=JSON.parse(n)}static fromJSON(n){return new e(n)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}r.SynthesisAudioMetadata=e})(yT)),yT}var wg={},Wi={},b2;function eF(){if(b2)return Wi;b2=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.SynthesisStartedEvent=Wi.ConnectingToSynthesisServiceEvent=Wi.SynthesisTriggeredEvent=Wi.SpeechSynthesisEvent=void 0;const r=We();class e extends r.PlatformEvent{constructor(o,a,l=r.EventType.Info){super(o,l),this.privRequestId=a}get requestId(){return this.privRequestId}}Wi.SpeechSynthesisEvent=e;class t extends e{constructor(o,a,l){super("SynthesisTriggeredEvent",o),this.privSessionAudioDestinationId=a,this.privTurnAudioDestinationId=l}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}Wi.SynthesisTriggeredEvent=t;class n extends e{constructor(o,a){super("ConnectingToSynthesisServiceEvent",o),this.privAuthFetchEventId=a}get authFetchEventId(){return this.privAuthFetchEventId}}Wi.ConnectingToSynthesisServiceEvent=n;class i extends e{constructor(o,a){super("SynthesisStartedEvent",o),this.privAuthFetchEventId=a}get authFetchEventId(){return this.privAuthFetchEventId}}return Wi.SynthesisStartedEvent=i,Wi}var x2;function tF(){if(x2)return wg;x2=1,Object.defineProperty(wg,"__esModule",{value:!0}),wg.SynthesisTurn=void 0;const r=We(),e=Xh(),t=xe(),n=aO(),i=eF();let s=class $T{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=(0,r.createNoDashGuid)(),this.privTurnDeferral=new r.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(a){this.privStreamId=a}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(a){this.privAudioOutputFormat=a}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const a=new t.PropertyCollection;return a.setProperty(t.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),a}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const a=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(a),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()}startNewSynthesis(a,l,u,h){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=a,this.privRawText=l,this.privIsSSML=u,this.privAudioOutputStream=new e.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",h!==void 0&&(this.privTurnAudioDestination=h,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new i.SynthesisTriggeredEvent(this.requestId,void 0,h===void 0?void 0:h.id()))}onPreConnectionStart(a){this.privAuthFetchEventId=a,this.onEvent(new i.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(a){a&&this.onComplete()}onConnectionEstablishCompleted(a){if(a===200){this.onEvent(new i.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else a===403&&this.onComplete()}onServiceResponseMessage(a){const l=JSON.parse(a);this.streamId=l.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(a){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new r.Deferred;const l=JSON.parse(a);l.webrtc&&(this.privWebRTCSDP=l.webrtc.connectionString)}onAudioChunkReceived(a){this.isSynthesizing&&(this.privAudioOutputStream.write(a),this.privBytesReceived+=a.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(a))}onTextBoundaryEvent(a){this.updateTextOffset(a.Data.text.Text,a.Type)}onVisemeMetadataReceived(a){a.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=a.Data.AnimationChunk)}onSessionEnd(a){this.privAudioDuration=a.Data.Offset}async constructSynthesisResult(){const a=await this.getAllReceivedAudioWithHeader();return new t.SpeechSynthesisResult(this.requestId,t.ResultReason.SynthesizingAudioCompleted,a,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const a=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",a}onEvent(a){r.Events.instance.onEvent(a)}static isXmlTag(a){return a.length>=2&&a[0]==="<"&&a[a.length-1]===">"}updateTextOffset(a,l){l===n.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(a,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+a.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!$T.isXmlTag(a)&&this.updateTextOffset(a,l))):(this.privSentenceOffset=this.privRawText.indexOf(a,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+a.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!$T.isXmlTag(a)&&this.updateTextOffset(a,l)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(a){return this.privRawText.indexOf("<",a+1)>this.privRawText.indexOf(">",a+1)}};return wg.SynthesisTurn=s,wg}var Pg={},T2;function rF(){if(T2)return Pg;T2=1,Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.SynthesisAdapterBase=void 0;const r=We(),e=xe(),t=Oe(),n=aA();let i=class{constructor(o,a,l,u){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!o)throw new r.ArgumentNullError("authentication");if(!a)throw new r.ArgumentNullError("connectionFactory");if(!l)throw new r.ArgumentNullError("synthesizerConfig");this.privAuthentication=o,this.privConnectionFactory=a,this.privSynthesizerConfig=l,this.privIsDisposed=!1,this.privSessionAudioDestination=u,this.privSynthesisTurn=new t.SynthesisTurn,this.privConnectionEvents=new r.EventSource,this.privServiceEvents=new r.EventSource,this.privSynthesisContext=new t.SynthesisContext,this.privAgentConfig=new t.AgentConfig,this.connectionEvents.attach(h=>{if(h.name==="ConnectionClosedEvent"){const m=h;m.statusCode!==1e3&&this.cancelSynthesisLocal(e.CancellationReason.Error,m.statusCode===1007?e.CancellationErrorCode.BadRequestParameters:e.CancellationErrorCode.ConnectionFailure,`${m.reason} websocket error code: ${m.statusCode}`)}})}get synthesizerConfig(){return this.privSynthesizerConfig}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(o){this.privActivityTemplate=o}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(o){this.privAudioOutputFormat=o,this.privSynthesisTurn.audioOutputFormat=o,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=o),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=o)}isDisposed(){return this.privIsDisposed}async dispose(o){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(o)}async connect(){await this.connectImpl()}async sendNetworkMessage(o,a){const l=typeof a=="string"?r.MessageType.Text:r.MessageType.Binary,u=typeof a=="string"?"application/json":"";return(await this.fetchConnection()).send(new n.SpeechConnectionMessage(l,o,this.privSynthesisTurn.requestId,u,a))}async Speak(o,a,l,u,h,m){let g;if(a?g=o:g=this.privSynthesizer.buildSsml(o),this.speakOverride!==void 0)return this.speakOverride(g,l,u,h);this.privSuccessCallback=u,this.privErrorCallback=h,this.privSynthesisTurn.startNewSynthesis(l,o,a,m);try{await this.connectImpl();const v=await this.fetchConnection();await this.sendSynthesisContext(v),await this.sendSsmlMessage(v,g,l),this.onSynthesisStarted(l),this.receiveMessage()}catch(v){return this.cancelSynthesisLocal(e.CancellationReason.Error,e.CancellationErrorCode.ConnectionFailure,v),Promise.reject(v)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new n.SpeechConnectionMessage(r.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(o,a,l,u){const h=new e.PropertyCollection;h.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[l]);const m=new e.SpeechSynthesisResult(o,e.ResultReason.Canceled,void 0,u,h);if(this.onSynthesisCancelled(m),this.privSuccessCallback)try{this.privSuccessCallback(m)}catch{}}cancelSynthesisLocal(o,a,l){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,o,a,l))}processTypeSpecificMessages(o){return!0}async receiveMessage(){try{const a=await(await this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!a)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const l=n.SpeechConnectionMessage.fromConnectionMessage(a);if(l.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(l.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(l.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(l.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===l.streamId.toLowerCase()&&l.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(l.binaryBody),this.onSynthesizing(l.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(l.binaryBody));break;case"audio.metadata":const u=t.SynthesisAudioMetadata.fromJSON(l.textBody).Metadata;for(const m of u)switch(m.Type){case t.MetadataType.WordBoundary:case t.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(m);const g=new e.SpeechSynthesisWordBoundaryEventArgs(m.Data.Offset,m.Data.Duration,m.Data.text.Text,m.Data.text.Length,m.Type===t.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,m.Data.text.BoundaryType);this.onWordBoundary(g);break;case t.MetadataType.Bookmark:const v=new e.SpeechSynthesisBookmarkEventArgs(m.Data.Offset,m.Data.Bookmark);this.onBookmarkReached(v);break;case t.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(m),m.Data.IsLastAnimation){const y=new e.SpeechSynthesisVisemeEventArgs(m.Data.Offset,m.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(y)}break;case t.MetadataType.AvatarSignal:this.onAvatarEvent(m);break;case t.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(m);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let h;try{h=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(h)}catch(m){this.privErrorCallback&&this.privErrorCallback(m)}this.onSynthesisCompleted(h);break;default:this.processTypeSpecificMessages(l)||this.privServiceEvents&&this.serviceEvents.onEvent(new r.ServiceEvent(l.path.toLowerCase(),l.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(o){this.setSynthesisContextSynthesisSection();const a=this.synthesisContext.toJSON();if(a)return o.send(new n.SpeechConnectionMessage(r.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",a))}setSpeechConfigSynthesisSection(){}connectImpl(o=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(l=>l.state()===r.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=(0,r.createNoDashGuid)(),this.privConnectionId=(0,r.createNoDashGuid)(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const a=o?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=a.then(async l=>{this.privSynthesisTurn.onAuthCompleted(!1);const u=await this.privConnectionFactory.create(this.privSynthesizerConfig,l,this.privConnectionId);u.events.attach(m=>{this.connectionEvents.onEvent(m)});const h=await u.open();return h.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(h.statusCode),Promise.resolve(u)):h.statusCode===403&&!o?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(h.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${h.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Url)} Reason: ${h.reason}`))},l=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(l)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(o,a){if(a)return o.send(new n.SpeechConnectionMessage(r.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",a))}sendSsmlMessage(o,a,l){return o.send(new n.SpeechConnectionMessage(r.MessageType.Text,"ssml",l,"application/ssml+xml",a))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(o=>o.state()===r.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){const o=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(o):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(o,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),o)}onAvatarEvent(o){}onSynthesisStarted(o){}onSynthesizing(o){}onSynthesisCancelled(o){}onSynthesisCompleted(o){}onWordBoundary(o){}onVisemeReceived(o){}onBookmarkReached(o){}};return Pg.SynthesisAdapterBase=i,i.telemetryDataEnabled=!0,Pg}var Eg={},w2;function nF(){if(w2)return Eg;w2=1,Object.defineProperty(Eg,"__esModule",{value:!0}),Eg.AvatarSynthesisAdapter=void 0;const r=xe(),e=Oe();let t=class extends e.SynthesisAdapterBase{constructor(i,s,o,a,l){super(i,s,o,void 0),this.privAvatarSynthesizer=a,this.privSynthesizer=a,this.privAvatarConfig=l}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){var i,s,o,a,l,u,h,m,g,v,y,A,x,b,w,T,k;this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:(i=this.privAvatarConfig.videoFormat)==null?void 0:i.bitrate,codec:(s=this.privAvatarConfig.videoFormat)==null?void 0:s.codec,crop:{bottomRight:{x:(l=(a=(o=this.privAvatarConfig.videoFormat)==null?void 0:o.cropRange)==null?void 0:a.bottomRight)==null?void 0:l.x,y:(m=(h=(u=this.privAvatarConfig.videoFormat)==null?void 0:u.cropRange)==null?void 0:h.bottomRight)==null?void 0:m.y},topLeft:{x:(y=(v=(g=this.privAvatarConfig.videoFormat)==null?void 0:g.cropRange)==null?void 0:v.topLeft)==null?void 0:y.x,y:(b=(x=(A=this.privAvatarConfig.videoFormat)==null?void 0:A.cropRange)==null?void 0:x.topLeft)==null?void 0:b.y}},resolution:{height:(w=this.privAvatarConfig.videoFormat)==null?void 0:w.height,width:(T=this.privAvatarConfig.videoFormat)==null?void 0:T.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(r.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:(k=this.privAvatarConfig.backgroundImage)==null?void 0:k.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,photoAvatarBaseModel:this.privAvatarConfig.photoAvatarBaseModel,style:this.privAvatarConfig.style,useBuiltInVoice:this.privAvatarConfig.useBuiltInVoice}}}onAvatarEvent(i){if(this.privAvatarSynthesizer.avatarEventReceived){const s=new r.AvatarEventArgs(i.Data.Offset,i.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,s)}catch{}}}};return Eg.AvatarSynthesisAdapter=t,Eg}var Rg={},P2;function iF(){if(P2)return Rg;P2=1,Object.defineProperty(Rg,"__esModule",{value:!0}),Rg.SpeechSynthesisAdapter=void 0;const r=xe(),e=Oe();let t=class extends e.SynthesisAdapterBase{constructor(i,s,o,a,l){super(i,s,o,l),this.privSpeechSynthesizer=a,this.privSynthesizer=a}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(i){const s=new r.SpeechSynthesisEventArgs(new r.SpeechSynthesisResult(i,r.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,s)}onSynthesizing(i){if(this.privSpeechSynthesizer.synthesizing)try{const s=this.privSynthesisTurn.audioOutputFormat.addHeader(i),o=new r.SpeechSynthesisEventArgs(new r.SpeechSynthesisResult(this.privSynthesisTurn.requestId,r.ResultReason.SynthesizingAudio,s));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,o)}catch{}}onSynthesisCancelled(i){if(this.privSpeechSynthesizer.SynthesisCanceled){const s=new r.SpeechSynthesisEventArgs(i);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,s)}catch{}}}onSynthesisCompleted(i){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new r.SpeechSynthesisEventArgs(i))}catch{}}onWordBoundary(i){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,i)}catch{}}onVisemeReceived(i){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,i)}catch{}}onBookmarkReached(i){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,i)}catch{}}};return Rg.SpeechSynthesisAdapter=t,Rg}var Ig={},E2;function sF(){if(E2)return Ig;E2=1,Object.defineProperty(Ig,"__esModule",{value:!0}),Ig.SynthesisRestAdapter=void 0;const r=In(),e=xe(),t=Jo(),n=ai();let i=class{constructor(o,a){let l=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!l){const h=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,"westus"),m=t.ConnectionFactoryBase.getHostSuffix(h);l=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,`https://${h}.tts.speech${m}`)}this.privUri=`${l}/cognitiveservices/voices/list`;const u=r.RestConfigBase.requestOptions;this.privRestAdapter=new r.RestMessageAdapter(u),this.privAuthentication=a}getVoicesList(o){return this.privRestAdapter.setHeaders(n.HeaderNames.ConnectionId,o),this.privAuthentication.fetch(o).then(a=>(this.privRestAdapter.setHeaders(a.headerName,a.token),this.privRestAdapter.request(r.RestRequestType.Get,this.privUri)))}};return Ig.SynthesisRestAdapter=i,Ig}var CT={},R2;function oF(){return R2||(R2=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SynthesizerConfig=r.SynthesisServiceType=void 0;const e=Oe();var t;(function(i){i[i.Standard=0]="Standard",i[i.Custom=1]="Custom"})(t=r.SynthesisServiceType||(r.SynthesisServiceType={}));class n{constructor(s,o){this.privSynthesisServiceType=t.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=s||new e.SpeechServiceConfig(new e.Context(null)),this.privParameters=o}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(s){this.privSynthesisServiceType=s}set synthesisVideoSection(s){this.privSpeechServiceConfig.Context.synthesis={video:s}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}setContextFromJson(s){const o=JSON.parse(s);o.system&&(this.privSpeechServiceConfig.Context.system=o.system),o.os&&(this.privSpeechServiceConfig.Context.os=o.os),o.audio&&(this.privSpeechServiceConfig.Context.audio=o.audio),o.synthesis&&(this.privSpeechServiceConfig.Context.synthesis=o.synthesis)}}r.SynthesizerConfig=n})(CT)),CT}var kg={},I2;function aF(){if(I2)return kg;I2=1,Object.defineProperty(kg,"__esModule",{value:!0}),kg.SynthesisContext=void 0;const r=xe();let e=class{constructor(){this.privContext={}}setSection(n,i){this.privContext[n]=i}set audioOutputFormat(n){this.privAudioOutputFormat=n}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(n){const i=this.buildSynthesisContext(n);this.setSection("synthesis",i)}buildSynthesisContext(n){return{audio:{metadataOptions:{bookmarkEnabled:!!(n!=null&&n.bookmarkReached),punctuationBoundaryEnabled:n==null?void 0:n.properties.getProperty(r.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!(n!=null&&n.wordBoundary)),sentenceBoundaryEnabled:n==null?void 0:n.properties.getProperty(r.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!(n!=null&&n.visemeReceived),wordBoundaryEnabled:n==null?void 0:n.properties.getProperty(r.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!(n!=null&&n.wordBoundary))},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:n==null?void 0:n.autoDetectSourceLanguage}}}};return kg.SynthesisContext=e,kg}var AT={},k2;function lF(){return k2||(k2=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.type=r.connectivity=r.Device=r.OS=r.System=r.Context=r.SpeechServiceConfig=void 0;class e{constructor(a){this.context=a}serialize(){return JSON.stringify(this,(a,l)=>{if(l&&typeof l=="object"&&!Array.isArray(l)){const u={};for(const h in l)Object.hasOwnProperty.call(l,h)&&(u[h&&h.charAt(0).toLowerCase()+h.substring(1)]=l[h]);return u}return l})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(a){this.recognition=a.toLowerCase()}}r.SpeechServiceConfig=e;class t{constructor(a){this.system=new n,this.os=a}}r.Context=t;class n{constructor(){const a="1.47.0";this.name="SpeechSDK",this.version=a,this.build="JavaScript",this.lang="JavaScript"}}r.System=n;class i{constructor(a,l,u){this.platform=a,this.name=l,this.version=u}}r.OS=i;class s{constructor(a,l,u){this.manufacturer=a,this.model=l,this.version=u}}r.Device=s,(function(o){o.Bluetooth="Bluetooth",o.Wired="Wired",o.WiFi="WiFi",o.Cellular="Cellular",o.InBuilt="InBuilt",o.Unknown="Unknown"})(r.connectivity||(r.connectivity={})),(function(o){o.Phone="Phone",o.Speaker="Speaker",o.Car="Car",o.Headset="Headset",o.Thermostat="Thermostat",o.Microphones="Microphones",o.Deskphone="Deskphone",o.RemoteControl="RemoteControl",o.Unknown="Unknown",o.File="File",o.Stream="Stream"})(r.type||(r.type={}))})(AT)),AT}var M2;function Oe(){return M2||(M2=1,(function(r){var e=Zl&&Zl.__createBinding||(Object.create?(function(s,o,a,l){l===void 0&&(l=a),Object.defineProperty(s,l,{enumerable:!0,get:function(){return o[a]}})}):(function(s,o,a,l){l===void 0&&(l=a),s[l]=o[a]})),t=Zl&&Zl.__exportStar||function(s,o){for(var a in s)a!=="default"&&!Object.prototype.hasOwnProperty.call(o,a)&&e(o,s,a)};Object.defineProperty(r,"__esModule",{value:!0}),r.AutoDetectSourceLanguagesOpenRangeOptionName=r.ForceDictationPropertyName=r.ServicePropertiesPropertyName=r.CancellationErrorCodePropertyName=r.OutputFormatPropertyName=r.SpeechSynthesisAdapter=r.AvatarSynthesisAdapter=void 0,t(o5(),r),t(a5(),r),t(EP(),r),t(l5(),r),t(c5(),r),t(RP(),r),t(o8(),r),t(a8(),r),t(l8(),r),t(c8(),r),t(u8(),r),t(d8(),r),t(h8(),r),t(p8(),r),t(f8(),r),t(q_(),r),t(m8(),r),t(g8(),r),t(v8(),r),t(S8(),r),t(y8(),r),t(C8(),r),t(A8(),r),t(b8(),r),t(x8(),r),t(T8(),r),t(P8(),r),t(E8(),r),t(R8(),r),t(I8(),r),t(M8(),r),t(L8(),r),t(O8(),r),t(F8(),r),t(W8(),r),t(Q8(),r),t(aO(),r),t(tF(),r),t(rF(),r);var n=nF();Object.defineProperty(r,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return n.AvatarSynthesisAdapter}});var i=iF();Object.defineProperty(r,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return i.SpeechSynthesisAdapter}}),t(sF(),r),t(oF(),r),t(aF(),r),t(lF(),r),r.OutputFormatPropertyName="OutputFormat",r.CancellationErrorCodePropertyName="CancellationErrorCode",r.ServicePropertiesPropertyName="ServiceProperties",r.ForceDictationPropertyName="ForceDictation",r.AutoDetectSourceLanguagesOpenRangeOptionName="UND"})(Zl)),Zl}var N2;function cF(){return N2||(N2=1,(function(r){var e=Ul&&Ul.__createBinding||(Object.create?(function(i,s,o,a){a===void 0&&(a=o),Object.defineProperty(i,a,{enumerable:!0,get:function(){return s[o]}})}):(function(i,s,o,a){a===void 0&&(a=o),i[a]=s[o]})),t=Ul&&Ul.__exportStar||function(i,s){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,i,o)};Object.defineProperty(r,"__esModule",{value:!0});const n=Oe();new n.AgentConfig,t(xe(),r)})(Ul)),Ul}var _t=cF();const $s="2024-02-01-preview";function Hs(r){return`https://${r}.api.cognitive.microsoft.com/customvoice`}function Qo(r){return{"Ocp-Apim-Subscription-Key":r}}function uF(r){return{"Ocp-Apim-Subscription-Key":r,"Content-Type":"application/json"}}async function ea(r){var e;if(!r.ok){const t=await r.text();let n=`API error: ${r.status} ${r.statusText}`;try{const i=JSON.parse(t);(e=i.error)!=null&&e.message?n=i.error.message:i.message&&(n=i.message)}catch{t&&(n=t)}throw new Error(n)}if(r.status!==204)return r.json()}async function dF(r,e){const t=`${Hs(r.region)}/projects/${e}?api-version=${$s}`;try{const n=await fetch(t,{method:"GET",headers:Qo(r.apiKey)});return n.status===404?null:n.ok?await n.json():(console.warn(`getProject returned ${n.status}, will create new project`),null)}catch(n){return console.warn("getProject failed, will create new project:",n),null}}async function hF(r,e,t){const n=`${Hs(r.region)}/projects/${e}?api-version=${$s}`,i={kind:"PersonalVoice",description:"Personal Voice Playground Project"},s=await fetch(n,{method:"PUT",headers:uF(r.apiKey),body:JSON.stringify(i)});return ea(s)}async function pF(r,e){let t=`${Hs(r.region)}/consents?api-version=${$s}`;e&&(t+=`&filter=projectId eq '${e}'`);const n=await fetch(t,{method:"GET",headers:Qo(r.apiKey)});return(await ea(n)).value}async function fF(r,e){const t=`${Hs(r.region)}/consents/${e}?api-version=${$s}`,n=await fetch(t,{method:"GET",headers:Qo(r.apiKey)});return ea(n)}async function mF(r,e){const t=`${Hs(r.region)}/consents/${e.consentId}?api-version=${$s}`,n=new FormData;n.append("projectId",e.projectId),n.append("voiceTalentName",e.voiceTalentName),n.append("companyName",e.companyName),n.append("locale",e.locale),e.description&&n.append("description",e.description),n.append("audiodata",e.audioFile,"consent.wav");const i=await fetch(t,{method:"POST",headers:Qo(r.apiKey),body:n});return ea(i)}async function gF(r,e){const t=`${Hs(r.region)}/consents/${e}?api-version=${$s}`,n=await fetch(t,{method:"DELETE",headers:Qo(r.apiKey)});await ea(n)}async function lO(r,e){let t=`${Hs(r.region)}/personalvoices?api-version=${$s}`;e&&(t+=`&filter=projectId eq '${e}'`);const n=await fetch(t,{method:"GET",headers:Qo(r.apiKey)});return(await ea(n)).value}async function vF(r,e){const t=`${Hs(r.region)}/personalvoices/${e}?api-version=${$s}`,n=await fetch(t,{method:"GET",headers:Qo(r.apiKey)});return ea(n)}async function SF(r,e){const t=`${Hs(r.region)}/personalvoices/${e.personalVoiceId}?api-version=${$s}`,n=new FormData;n.append("projectId",e.projectId),n.append("consentId",e.consentId),e.description&&n.append("description",e.description),e.audioFiles.forEach((s,o)=>{n.append("audiodata",s,`audio_${o}.wav`)});const i=await fetch(t,{method:"POST",headers:Qo(r.apiKey),body:n});return ea(i)}async function yF(r,e){const t=`${Hs(r.region)}/personalvoices/${e}?api-version=${$s}`,n=await fetch(t,{method:"DELETE",headers:Qo(r.apiKey)});await ea(n)}async function CF(r,e,t=3e4,n=1e3){const i=Date.now();for(;Date.now()-i<t;){const s=await fF(r,e);if(s.status==="Succeeded"||s.status==="Failed")return s;await new Promise(o=>setTimeout(o,n))}throw new Error("Consent creation timed out")}async function AF(r,e,t=6e4,n=2e3){const i=Date.now();for(;Date.now()-i<t;){const s=await vF(r,e);if(s.status==="Succeeded"||s.status==="Failed")return s;await new Promise(o=>setTimeout(o,n))}throw new Error("Personal voice creation timed out")}function av(r,e,t="en-US",n="DragonLatestNeural"){return`<speak version='1.0' xml:lang='${t}' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts'>
  <voice name='${n}'>
    <mstts:ttsembedding speakerProfileId='${e}'/>
    <mstts:express-as style='Prompt'>
      ${r}
    </mstts:express-as>
  </voice>
</speak>`}async function bF(r,e,t,n="en-US",i="DragonLatestNeural"){const s=av(e,t,n,i),o=`https://${r.region}.tts.speech.microsoft.com/cognitiveservices/v1`,a=await fetch(o,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":r.apiKey,"Content-Type":"application/ssml+xml","X-Microsoft-OutputFormat":"audio-24khz-48kbitrate-mono-mp3"},body:s});if(!a.ok){const l=await a.text();throw new Error(`TTS synthesis failed: ${a.status} ${l}`)}return a.arrayBuffer()}function xF(r){const[e,t]=O.useState("idle"),[n,i]=O.useState(""),[s,o]=O.useState([]),[a,l]=O.useState(-1),[u,h]=O.useState(null),m=O.useRef(r);O.useEffect(()=>{m.current=r},[r]);const g=O.useRef(null),v=O.useRef(null),y=O.useRef([]),A=O.useRef(0),x=O.useRef(null),b=O.useRef(!1),w=O.useRef([]),T=O.useRef(!1),k=O.useRef(!1),I=O.useRef(!1),M=O.useRef(""),L=O.useRef(null),j=O.useCallback(()=>{var ne,W;g.current&&g.current.close();const Y=m.current,ee=((ne=Y.personalVoiceInfo)==null?void 0:ne.isPersonalVoice)&&((W=Y.personalVoiceInfo)==null?void 0:W.speakerProfileId);console.log("Initializing synthesizer with voice:",Y.selectedVoice,"isPersonalVoice:",ee),console.log("personalVoiceInfo:",Y.personalVoiceInfo);const X=_t.SpeechConfig.fromSubscription(Y.apiKey,Y.region);ee||(X.speechSynthesisVoiceName=Y.selectedVoice),X.speechSynthesisOutputFormat=_t.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3;const re=new _t.SpeakerAudioDestination;v.current=re;const G=_t.AudioConfig.fromSpeakerOutput(re),J=new _t.SpeechSynthesizer(X,G);return g.current=J,J},[]),B=O.useCallback(()=>{if(!b.current){console.log("Stopped tracking - not playing");return}let Y=Date.now()-A.current;if(v.current&&v.current.currentTime)try{const X=v.current.currentTime;X>0&&(Y=X*1e3)}catch{}let ee=-1;for(let X=0;X<w.current.length&&w.current[X].audioOffset<=Y+300;X++)ee=X;if(ee!==-1&&l(ee),Math.floor(Y/500)!==Math.floor((Y-16)/500)){const X=ee>=0?w.current[ee]:null;console.log(` ${Y.toFixed(0)}ms | Word [${ee}]: "${X==null?void 0:X.text}" @ ${X==null?void 0:X.audioOffset}ms | Total: ${w.current.length} | Complete: ${k.current}`)}b.current&&(x.current=requestAnimationFrame(B))},[]),z=O.useCallback((Y,ee)=>{var ne,W;if(!Y.trim()){i("Please enter some text to synthesize");return}t("synthesizing"),i(""),o([]),l(-1),y.current=[],w.current=[],b.current=!1,T.current=!1,k.current=!1,I.current=!1,M.current=Y;const X=j(),re=setTimeout(()=>{w.current.length===0&&(console.log(" No word boundary received within 1 second - will start playback when audio arrives"),I.current=!0)},1e3);X.wordBoundary=(V,ce)=>{var F;let ue=ce.textOffset;if(((F=m.current.personalVoiceInfo)==null?void 0:F.isPersonalVoice)&&ce.text){const te=w.current[w.current.length-1],ge=te?te.offset+te.length:0,oe=M.current.indexOf(ce.text,ge);oe!==-1&&(ue=oe)}const se={text:ce.text,offset:ue,length:ce.wordLength,audioOffset:ce.audioOffset/1e4};if(w.current.push(se),o([...w.current]),console.log(` Word boundary: "${se.text}" at ${se.audioOffset}ms (text offset: ${se.offset})`),w.current.length===1){clearTimeout(re),I.current=!1;const te=Date.now(),ge=te-se.audioOffset;A.current=ge,console.log(" FIRST word boundary - starting playback. Word:",se.text,"offset:",se.audioOffset,"ms. Playback start:",ge,"Current time:",te),b.current?(console.log(" Switching from fallback mode to word boundary mode - restarting tracking"),B()):(b.current=!0,t("playing"),B())}},X.synthesizing=(V,ce)=>{ce.result.audioData&&(y.current.push(new Uint8Array(ce.result.audioData)),I.current&&!b.current&&y.current.length===1&&(console.log(" First audio chunk received (fallback mode) - starting playback"),A.current=Date.now(),b.current=!0,t("playing")))},X.synthesisStarted=()=>{t("synthesizing"),console.log("Synthesis started")},X.synthesisCompleted=(V,ce)=>{const ue=y.current.reduce((oe,pe)=>oe+pe.length,0),ve=new Uint8Array(ue);let se=0;for(const oe of y.current)ve.set(oe,se),se+=oe.length;h(ve.buffer),k.current=!0,console.log(" Synthesis completed - now have all",w.current.length,"word boundaries");const F=ue*8/48e3*1e3,te=Date.now()-A.current,ge=Math.max(100,F-te+300);console.log(` Estimated audio duration: ${F}ms, current playback: ${te}ms, will stop in: ${ge}ms`),b.current||(A.current=Date.now(),b.current=!0,t("playing")),L.current&&clearTimeout(L.current),L.current=setTimeout(()=>{console.log(" Audio playback ended (duration timeout)"),b.current=!1,x.current&&(cancelAnimationFrame(x.current),x.current=null),t("idle"),l(-1),L.current=null},ge)},X.SynthesisCanceled=(V,ce)=>{console.error("Synthesis canceled:",ce.errorDetails),i(ce.errorDetails||"Synthesis was canceled"),t("error"),l(-1),b.current=!1,x.current&&cancelAnimationFrame(x.current)};const G=m.current,J=((ne=G.personalVoiceInfo)==null?void 0:ne.isPersonalVoice)&&((W=G.personalVoiceInfo)==null?void 0:W.speakerProfileId);if(console.log("=== SYNTHESIS DEBUG ==="),console.log("currentSettings.personalVoiceInfo:",G.personalVoiceInfo),console.log("isPersonalVoice:",J),console.log("selectedVoice:",G.selectedVoice),console.log("locale:",ee),console.log("======================="),J){const V=G.personalVoiceInfo.model||"DragonLatestNeural",ce=ee||"en-US",ue=av(Y,G.personalVoiceInfo.speakerProfileId,ce,V);console.log("Using personal voice SSML with model:",V),console.log("SSML:",ue),X.speakSsmlAsync(ue,ve=>{ve.reason===_t.ResultReason.SynthesizingAudioCompleted?console.log("Personal voice synthesis completed successfully"):(console.error("Personal voice synthesis failed:",ve.errorDetails),i(ve.errorDetails||"Synthesis failed"),t("error"))},ve=>{console.error("Personal voice synthesis error:",ve),i(ve),t("error")})}else X.speakTextAsync(Y,V=>{V.reason===_t.ResultReason.SynthesizingAudioCompleted?console.log("Synthesis completed successfully"):(console.error("Synthesis failed:",V.errorDetails),i(V.errorDetails||"Synthesis failed"),t("error"))},V=>{console.error("Synthesis error:",V),i(V),t("error")})},[j,B]),Z=O.useCallback(()=>{v.current&&e==="playing"&&(v.current.pause(),t("paused"),b.current=!1,x.current&&(cancelAnimationFrame(x.current),x.current=null))},[e]),$=O.useCallback(()=>{v.current&&e==="paused"&&(v.current.resume(),t("playing"),b.current=!0,B())},[e,B]),U=O.useCallback(()=>{console.log(" Stop called - cleaning up"),b.current=!1,x.current&&(cancelAnimationFrame(x.current),x.current=null),v.current&&v.current.pause(),g.current&&(g.current.close(),g.current=null),t("idle"),l(-1)},[]);return{state:e,error:n,wordBoundaries:s,currentWordIndex:a,audioData:u,synthesize:z,pause:Z,resume:$,stop:U}}async function TF(r,e,t=!1){try{const n=r.length>8?`${r.substring(0,4)}...${r.substring(r.length-4)}`:"****";console.log("=== FETCHING VOICES ==="),console.log("Region:",e),console.log("API Key:",n),console.log("=======================");const i=`https://${e}.tts.speech.microsoft.com/cognitiveservices/voices/list`,s=await fetch(i,{headers:{"Ocp-Apim-Subscription-Key":r}});if(!s.ok)throw new Error(`Failed to fetch voices: ${s.status} ${s.statusText}`);const o=await s.json();console.log("Fetched voices - total count:",o.length),console.log("First voice full structure:",JSON.stringify(o[0],null,2));const a=[...new Set(o.map(u=>u.VoiceType))];console.log("Available VoiceType values:",a),a.forEach(u=>{const h=o.find(m=>m.VoiceType===u);h&&console.log(`Sample ${u} voice:`,h.ShortName,h)});const l=o.map(u=>{var v,y;const h=((v=u.ShortName)==null?void 0:v.includes("HD"))||((y=u.Name)==null?void 0:y.includes("HD")),m=u.WordsPerMinute||u.SecondaryLocaleList||[];let g="Female";return typeof u.Gender=="number"?g=u.Gender===1?"Female":"Male":typeof u.Gender=="string"&&(g=u.Gender),{name:u.ShortName||u.Name||"Unknown",locale:String(u.Locale||"en-US"),gender:g,description:`${u.LocalName||u.DisplayName||u.Name||"Unknown"} (${u.Locale||"Unknown"})`,styleList:u.StyleList||[],isFeatured:h,voiceType:u.VoiceType,isNeuralHD:h,keywords:Array.isArray(m)?m:[],wordsPer:u.WordsPerMinute,voiceTag:u.VoiceTag||{}}});return t&&(e.toLowerCase()==="eastus"||e==="East US")&&(console.log("Adding hardcoded MAI voices for East US region"),l.unshift({name:"en-us-phoebe:MAI-Voice-1",locale:"en-US",gender:"Female",description:"Phoebe MAI Voice (en-US)",styleList:[],isFeatured:!0,voiceType:"Neural",isNeuralHD:!0,keywords:["MAI"],wordsPer:void 0},{name:"en-us-benjamin:MAI-Voice-1",locale:"en-US",gender:"Male",description:"Benjamin MAI Voice (en-US)",styleList:[],isFeatured:!0,voiceType:"Neural",isNeuralHD:!0,keywords:["MAI"],wordsPer:void 0})),l.sort((u,h)=>u.isFeatured&&!h.isFeatured?-1:!u.isFeatured&&h.isFeatured?1:u.name.localeCompare(h.name)),console.log("Successfully processed voices:",l.length),l}catch(n){throw console.error("Failed to fetch voices:",n),n}}function wF({apiKey:r,region:e,selectedVoice:t,onVoiceChange:n,onVoiceInfoChange:i,enableMAIVoices:s=!1}){const[o,a]=O.useState([]),[l,u]=O.useState([]),[h,m]=O.useState(!1),[g,v]=O.useState(""),[y,A]=O.useState(""),[x,b]=O.useState(""),[w,T]=O.useState(!1);O.useEffect(()=>{r&&e&&(m(!0),v(""),TF(r,e,s).then(M=>{a(M);const L=M.filter(B=>B.name.toLowerCase().includes("openai")),j=M.filter(B=>B.name.toLowerCase().includes("mai-voice")||B.name.toLowerCase().includes(":mai-"));console.log(`Found ${L.length} OpenAI voices:`,L.map(B=>B.name)),console.log(`Found ${j.length} MAI voices:`,j.map(B=>B.name)),m(!1)}).catch(M=>{console.error("Failed to fetch voices:",M),v("Failed to load voices from Azure."),a([]),m(!1)}))},[r,e,s]),O.useEffect(()=>{x==="MyVoices"&&r&&e&&(m(!0),lO({apiKey:r,region:e}).then(L=>{const j=L.filter(B=>B.status==="Succeeded");u(j),console.log(`Found ${j.length} personal voices:`,j.map(B=>B.id)),m(!1)}).catch(L=>{console.error("Failed to fetch personal voices:",L),u([]),m(!1)}))},[x,r,e]);const k=x==="MyVoices",I=k?[]:o.filter(M=>{var B,z,Z,$;if(M.name.toLowerCase().includes("multitalker"))return!1;if(x)switch(x){case"MAI":const U=M.name.toLowerCase().includes("mai-voice")||M.name.toLowerCase().includes(":mai-"),Y=Array.isArray((B=M.voiceTag)==null?void 0:B.Source)&&M.voiceTag.Source.some(re=>re.toLowerCase()==="mai");if(!U&&!Y)return!1;break;case"HD":if(!M.isNeuralHD)return!1;break;case"NonHD":if(M.isNeuralHD)return!1;break;case"OpenAI":const ee=M.name.toLowerCase().includes("openai"),X=Array.isArray((z=M.voiceTag)==null?void 0:z.Source)&&M.voiceTag.Source.some(re=>re.toLowerCase()==="openai");if(!ee&&!X)return!1;break}if(!y)return!0;const L=y.toLowerCase().trim(),j=U=>U.toLowerCase().split(/\s+/).some(ee=>ee===L);return M.name.toLowerCase().includes(L)||M.description.toLowerCase().includes(L)||j(M.locale)||M.gender&&j(M.gender)||((Z=M.styleList)==null?void 0:Z.some(U=>j(U)))||(($=M.keywords)==null?void 0:$.some(U=>j(String(U))))});return O.useEffect(()=>{if(I.length>0){const M=I[0],L=I.some(j=>j.name===t);w&&(y||x)&&!L&&(console.log("Auto-selecting top voice from filtered list:",M.name),n(M.name),i==null||i({voiceName:M.name,isPersonalVoice:!1,locale:M.locale}))}},[y,I.length,x]),f.jsxs("div",{className:"h-full flex flex-col space-y-2",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Voice"}),g&&f.jsx("div",{className:"text-sm text-yellow-600 bg-yellow-50 p-2 rounded",children:g}),f.jsxs("div",{className:"flex gap-2 flex-wrap",children:[f.jsx("button",{onClick:()=>b(""),className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${x===""?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"All"}),f.jsx("button",{onClick:()=>{b(x==="HD"?"":"HD"),T(!0)},className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${x==="HD"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"HD"}),f.jsx("button",{onClick:()=>{b(x==="MAI"?"":"MAI"),T(!0)},className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${x==="MAI"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"MAI"}),f.jsx("button",{onClick:()=>{b(x==="OpenAI"?"":"OpenAI"),T(!0)},className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${x==="OpenAI"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"OpenAI"}),f.jsx("button",{onClick:()=>{b(x==="NonHD"?"":"NonHD"),T(!0)},className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${x==="NonHD"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Non-HD"}),f.jsx("button",{onClick:()=>{b(x==="MyVoices"?"":"MyVoices"),T(!0)},className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${x==="MyVoices"?"bg-emerald-600 text-white":"bg-emerald-100 text-emerald-700 hover:bg-emerald-200"}`,children:"My Voices"})]}),f.jsx("input",{type:"text",placeholder:"Search voices...",value:y,onChange:M=>{console.log("Search term changed to:",M.target.value),A(M.target.value),T(!0)},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),t&&f.jsxs("div",{className:"p-2 bg-blue-50 border border-blue-200 rounded-md flex-shrink-0",children:[f.jsx("div",{className:"text-xs text-blue-600 font-medium",children:"Selected:"}),f.jsx("div",{className:"text-sm text-blue-800 truncate",children:t})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto border border-gray-200 rounded-md min-h-0",children:[h&&f.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"Loading voices..."}),!h&&!k&&I.length===0&&f.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No voices found"}),!h&&!k&&I.map(M=>{var B,z;const L=[];(B=M.voiceTag)!=null&&B.ContentCategories&&L.push(...M.voiceTag.ContentCategories),(z=M.voiceTag)!=null&&z.VoicePersonalities&&L.push(...M.voiceTag.VoicePersonalities);const j=L.length>0?` [${L.join(", ")}]`:"";return f.jsxs("button",{onClick:()=>{console.log("Voice changed to:",M.name),n(M.name),i==null||i({voiceName:M.name,isPersonalVoice:!1,locale:M.locale})},className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${t===M.name?"bg-blue-50 border-l-4 border-l-blue-600":"hover:bg-gray-50"}`,children:[f.jsxs("div",{className:"font-medium text-gray-800 text-sm",children:[M.isFeatured?" ":"",M.name]}),j&&f.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:j})]},M.name)}),!h&&k&&l.length===0&&f.jsxs("div",{className:"p-4 text-center text-gray-500 text-sm",children:[f.jsx("p",{children:"No personal voices found"}),f.jsx("p",{className:"text-xs mt-1",children:"Create voices in Voice Creation playground"})]}),!h&&k&&l.map(M=>f.jsxs("button",{onClick:()=>{console.log("Personal voice selected:",M.id,"speakerProfileId:",M.speakerProfileId);const L=`personal:${M.id}`;n(L),i==null||i({voiceName:M.id,isPersonalVoice:!0,speakerProfileId:M.speakerProfileId})},className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${t===`personal:${M.id}`?"bg-emerald-50 border-l-4 border-l-emerald-600":"hover:bg-gray-50"}`,children:[f.jsxs("div",{className:"font-medium text-gray-800 text-sm flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),M.id]}),f.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"Personal Voice"})]},M.id))]}),f.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 pt-2",children:k?`${l.length} personal voice${l.length!==1?"s":""}`:`${I.length} voice${I.length!==1?"s":""} available${y?` (filtered from ${o.length})`:""}`})]})}const L2={"en-GB":"Welcome to our programme exploring the fascinating world of marine biology. From the depths of the ocean to coastal waters, we'll discover the wonders of underwater life.","en-AU":"G'day and welcome to our show about the amazing world of marine biology. From the deep blue ocean to our beautiful coastlines, we'll explore the incredible underwater world.","en-CA":"Welcome to our podcast about the wonderful world of marine biology. From the depths of the ocean to our coastal waters, we'll explore the amazing underwater ecosystems.","en-IN":"Welcome to our programme on marine biology. We will explore the fascinating world beneath the oceans, from the deepest waters to coastal regions.","hi-IN":"                ,           ","es-ES":"Bienvenidos a nuestro programa sobre el fascinante mundo de la biologa marina. Desde las profundidades del ocano hasta las costas, exploraremos las maravillas del mundo submarino.","es-MX":"Bienvenidos a nuestro podcast sobre el fascinante mundo de la biologa marina. Desde las profundidades del mar hasta nuestras costas, exploraremos las maravillas del mundo submarino.","ja-JP":"","fr-FR":"Bienvenue dans notre mission sur le monde fascinant de la biologie marine. Des profondeurs ocaniques aux ctes, nous explorerons les merveilles du monde sous-marin.","fr-CA":"Bienvenue  notre mission sur le merveilleux monde de la biologie marine. Des profondeurs de l'ocan jusqu'aux ctes, nous explorerons les merveilles du monde sous-marin.","pt-BR":"Bem-vindos ao nosso podcast sobre o fascinante mundo da biologia marinha. Das profundezas do oceano at as costas, vamos explorar as maravilhas do mundo submarino.","pt-PT":"Bem-vindos ao nosso programa sobre o fascinante mundo da biologia marinha. Desde as profundezas do oceano at s costas, iremos explorar as maravilhas do mundo submarino.","it-IT":"Benvenuti al nostro programma sul affascinante mondo della biologia marina. Dalle profondit dell'oceano alle coste, esploreremo le meraviglie del mondo sottomarino.","zh-TW":",","ko-KR":"      .   ,          .","nl-NL":"Welkom bij ons programma over de fascinerende wereld van de mariene biologie. Van de diepten van de oceaan tot de kustlijnen, we verkennen de wonderen van de onderwaterwereld.","sv-SE":"Vlkommen till vrt program om den fascinerande vrlden av marinbiologi. Frn havets djup till kusterna kommer vi att utforska undervattensvrldens under.","pl-PL":"Witamy w naszym programie o fascynujcym wiecie biologii morskiej. Od gbin oceanu po wybrzea, bdziemy odkrywa cuda podwodnego wiata.","nb-NO":"Velkommen til vrt program om den fascinerende verden av marinbiologi. Fra havets dyp til kystene vil vi utforske undervannens underverker.","da-DK":"Velkommen til vores program om den fascinerende verden af marinbiologi. Fra havets dybder til kysterne vil vi udforske undervandensverdenens vidundere.","fi-FI":"Tervetuloa ohjelmaammme meribiologian kiehtovasta maailmasta. Valtameren syvyyksist rannikoille tutkimme vedenalaisen maailman ihmeit.","ru-RU":"         .           .","ca-ES":"Benvinguts al nostre programa sobre el fascinant mn de la biologia marina. Des de les profunditats de l'oce fins a les costes, explorarem les meravelles del mn submar.","tr-TR":"Deniz biyolojisinin byleyici dnyas hakkndaki programmza ho geldiniz. Okyanusun derinliklerinden kylara kadar, su alt dnyasnn harikalarn kefedeceiz.","ar-SA":"        .          .","ar-EG":"        .           .","th-TH":"  ","he-IL":"         .    ,      -.","cs-CZ":"Vtejte v naem poadu o fascinujcm svt mosk biologie. Od hlubin ocenu a po pobe budeme zkoumat zzraky podmoskho svta.","hu-HU":"dvzljk msorunkban a tengeri biolgia lenygz vilgrl. Az cen mlytl a partokig felfedezzk a vz alatti vilg csodit.","uk-UA":"         .          .","cy-GB":"Croeso i'n rhaglen am fyd hynod ddiddorol bioleg forol. O ddyfnderoedd y cefnfor i'r arfordiroedd, byddwn yn archwilio rhyfeddodau'r byd tanddwr.","vi-VN":"Cho mng n vi chng trnh ca chng ti v th gii hp dn ca sinh hc bin. T  su ca i dng n b bin, chng ta s khm ph nhng k quan ca th gii di nc.","sl-SI":"Dobrodoli v naem programu o fascinantnem svetu morske biologije. Od globin oceana do obal bomo raziskovali udee podvodnega sveta.","id-ID":"Selamat datang di program kami tentang dunia biologi laut yang menarik. Dari kedalaman samudra hingga garis pantai, kami akan menjelajahi keajaiban dunia bawah laut.","el-GR":"           .        ,       .","sk-SK":"Vitajte v naom programe o fascinujcom svete morskej biolgie. Od hlbn ocenu a po pobreia budeme skma zzraky podmorskho sveta.","hr-HR":"Dobrodoli u na program o fascinantnom svijetu morske biologije. Od dubina oceana do obala, istrait emo uda podvodnog svijeta.","ro-RO":"Bun venit la programul nostru despre lumea fascinant a biologiei marine. De la adncurile oceanului pn la coaste, vom explora minunile lumii subacvatice.","lt-LT":"Sveiki atvyk  ms program apie av jr biologijos pasaul. Nuo vandenyno gelmi iki krant tyrinsime povandeninio pasaulio stebuklus.","bg-BG":"      fascinating world   .            .","lv-LV":"Laipni ldzam msu programm par aizraujoo jras bioloijas pasauli. No okena dziumiem ldz krastiem ms izptsim zemdens pasaules brnumus.","et-EE":"Tere tulemast meie saatesse pnevast merebioloogia maailmast. Ookeani sgavustest kuni rannikualadeni uurime veealuse maailma imesid.","sr-RS":"Dobrodoli u na program o fascinantnom svetu morske biologije. Od dubina okeana do obala, istraiemo uda podvodnog sveta."},bT={"en-US":{podcast:"Welcome to One Fish, Two Fish, the podcast that aims to make you laugh as you learn about the fascinating world of marine biology. From the depths of the deep blue to the shores of our coastlines, we'll explore the wonders of the underwater world and the creatures that call it home.",education:"Welcome to today's online math lesson! In this session, we'll delve into the fascinating world of algebra. We'll start by exploring the basics, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardized checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed on her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named 'Perseverance,' touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, beautiful people! Welcome back to my channel. Today, we're about to spill all the tea on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh boy, here we go. You know, I walked into this improv show, and I thought, 'Hey, this could be fun. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you folks.",enthusiastic:"Oh my gosh, that's AMAZING news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a mix of both? Tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, uh, I was thinkingno, I mean, I was wondering if, um, if you might want to go to the, uh, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite.",callcenter:"Thank you for calling customer support. My name is Sarah, and I'll be happy to assist you today. I understand you're experiencing an issue with your account. Let me pull up your information and see how I can help resolve this for you right away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their color. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"zh-CN":{podcast:",",education:"",instructions:"",story:"",ads:"iPhoneiPhone",news:"NASA",promotional:"",vlog:"",business:"Winnebago IndustriesWGO",standup:"",enthusiastic:"",casual:"",hesitant:"",callcenter:"",explainer:""},"de-DE":{podcast:"Willkommen zu unserem Podcast ber die faszinierende Welt der Meeresbiologie. Von den Tiefen des Ozeans bis zu den Ksten werden wir die Wunder der Unterwasserwelt und die erstaunlichen Kreaturen erkunden.",education:"Willkommen zur heutigen Online-Mathematikstunde! In dieser Sitzung werden wir in die faszinierende Welt der Algebra eintauchen. Wir beginnen mit den Grundlagen, vom Lsen einfacher Gleichungen bis zum Verstndnis von Variablen.",instructions:"Machen Sie bei der Durchfhrung der Inspektion klare und umfassende Notizen. Verwenden Sie unsere standardisierte Checkliste als Leitfaden und notieren Sie Abweichungen oder Problembereiche.",story:"Eine sanfte Melancholie lag auf ihrem Herzen, gewebt aus Erinnerungen an eine Zeit, als Lachen durch diese Wiesen hallte. Sie strich ber die zarten Bltenbltter eines vergessenen Gnseblmchens.",ads:"Wir prsentieren das brandneue iPhone, das den Standard fr neu definierte Innovation setzt. Mit elegantem Design und modernsten Funktionen definiert dieses iPhone den Gipfel der Technologie neu.",news:"In den internationalen Nachrichten hat die erfolgreiche Mission der NASA, einen Rover zum Mars zu schicken, weltweite Aufmerksamkeit erregt. Der Rover namens Perseverance landete diese Woche auf der Marsoberflche.",promotional:"Meine Damen, es ist Zeit fr etwas Selbstverwhnung! Gnnen Sie sich einen Moment der Glckseligkeit mit unserem exklusiven Winter-Spa-Paket.",vlog:"Hallo, ihr Lieben! Willkommen zurck auf meinem Kanal. Heute werden wir ber die neuesten Make-up-Must-haves sprechen.",business:"Winnebago Industries ist ein Unternehmen, das Wohnmobile, Reiseanhnger und andere Freizeitfahrzeuge herstellt. Das Brsenkrzel lautet WGO und wird an der New Yorker Brse gehandelt.",standup:"Oh je, jetzt geht's los. Wissen Sie, ich kam zu dieser Improv-Show und dachte: 'Hey, das knnte lustig werden.' Die berraschung war, dass ich hier Stand-up fr Sie machen muss.",enthusiastic:"Oh mein Gott, das sind ja fantastische Neuigkeiten! Herzlichen Glckwunsch! Wie fhlen Sie sich dabei? Aufgeregt, nervs oder beides?",casual:"Oh nein, das wollte ich nicht! Wie wre es damit: Wenn Sie etwas Skurriles mit viel Lachen wollen, nehmen Sie die Blue Man Group. Fr etwas Magisches ist Cirque du Soleil die beste Wahl.",hesitant:"Also, h, ich habe gedachtnein, ich meine, ich habe mich gefragt, ob, hm, ob Sie vielleicht Freitag in das, h, neue italienische Restaurant gehen mchten?",callcenter:"Vielen Dank fr Ihren Anruf beim Kundendienst. Mein Name ist Anna, und ich helfe Ihnen gerne weiter. Ich verstehe, dass Sie ein Problem mit Ihrem Konto haben. Lassen Sie mich Ihre Informationen abrufen und schauen, wie ich Ihnen umgehend helfen kann.",explainer:"Lassen Sie mich erklren, wie Photosynthese funktioniert. Pflanzen nutzen Sonnenlicht, Wasser und Kohlendioxid, um Energie zu erzeugen. Der Prozess findet in den Chloroplasten statt, die Chlorophyll enthalten  das grne Pigment, das Pflanzen ihre Farbe verleiht. Wenn Sonnenlicht auf die Bltter trifft, lst es eine chemische Reaktion aus, die diese Bestandteile in Glukose und Sauerstoff umwandelt."},"en-GB":{podcast:"Welcome to our programme exploring the fascinating world of marine biology. From the depths of the ocean to coastal waters, we'll discover the wonders of underwater life and the remarkable creatures that inhabit these environments.",education:"Welcome to today's online maths lesson! In this session, we'll explore the fascinating world of algebra. We'll begin with the fundamentals, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardised checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed upon her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, lovely people! Welcome back to my channel. Today, we're going to share all the details on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh blimey, here we go. You know, I walked into this improv show, and I thought, 'Right, this could be fun. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you lot.",enthusiastic:"Oh my goodness, that's brilliant news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a mix of both? Tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, um, I was thinkingno, I mean, I was wondering if, er, if you might want to go to the, um, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite.",callcenter:"Thank you for calling customer support. My name is Emily, and I'll be pleased to assist you today. I understand you're experiencing an issue with your account. Let me pull up your information and see how I can help resolve this for you straight away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"en-AU":{podcast:"G'day and welcome to our show about the amazing world of marine biology. From the deep blue ocean to our beautiful coastlines, we'll explore the incredible underwater world and the fascinating creatures that call it home.",education:"Welcome to today's online maths lesson! In this session, we'll dive into the fascinating world of algebra. We'll start with the basics, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardised checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed on her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, beautiful people! Welcome back to my channel. Today, we're going to spill all the tea on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh crikey, here we go. You know, I rocked up to this improv show, and I thought, 'Yeah, this could be a laugh. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you mob.",enthusiastic:"Oh my gosh, that's bloody amazing news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a bit of both? Tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with heaps of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, um, I was thinkingno, I mean, I was wondering if, er, if you might want to go to the, um, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite.",callcenter:"Thanks for calling customer support. My name is Jessica, and I'll be happy to help you out today. I understand you're having an issue with your account. Let me pull up your details and see how I can sort this out for you right away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"en-CA":{podcast:"Welcome to our podcast about the wonderful world of marine biology. From the depths of the ocean to our coastal waters, we'll explore the amazing underwater ecosystems and the remarkable creatures that inhabit them.",education:"Welcome to today's online math lesson! In this session, we'll delve into the fascinating world of algebra. We'll start by exploring the basics, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardized checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed on her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, beautiful people! Welcome back to my channel. Today, we're about to share all the details on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh boy, here we go. You know, eh, I walked into this improv show, and I thought, 'Hey, this could be fun. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you folks.",enthusiastic:"Oh my gosh, that's amazing news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a mix of both? Tell me everything, eh!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, uh, I was thinkingno, I mean, I was wondering if, um, if you might want to go to the, uh, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite, eh?",callcenter:"Thank you for calling customer support. My name is Laura, and I'll be happy to assist you today. I understand you're experiencing an issue with your account. Let me pull up your information and see how I can help resolve this for you right away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"en-IN":{podcast:"Welcome to our programme on marine biology. We will explore the fascinating world beneath the oceans, from the deepest waters to coastal regions, and learn about the wonderful creatures that inhabit these environments.",education:"Welcome to today's online mathematics lesson! In this session, we shall delve into the fascinating world of algebra. We will begin with the fundamentals, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, kindly take clear and comprehensive notes. Use our standardised checklist as a guide, noting any deviations or areas of concern. If possible, please take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed upon her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hello, beautiful people! Welcome back to my channel. Today, we are going to share all the details on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to enhance your beauty routine, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh my, here we go. You know, I walked into this improv show, and I thought, 'This could be interesting. Perhaps they'll have a surprise for me.' Well, what happened? The surprise was that I got roped into doing standup for you all.",enthusiastic:"Oh my goodness, that's wonderful news! Congratulations! How are you feeling about it all? Any excitement, nervousness, or perhaps a combination of both? Please tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughter, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil would be your best option.",hesitant:"So, um, I was thinkingno, I mean, I was wondering if, er, if you might want to go to the, um, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordah yes, exquisite.",callcenter:"Thank you for calling customer support. My name is Priya, and I shall be pleased to assist you today. I understand you are experiencing an issue with your account. Kindly allow me to access your information and see how I can help resolve this matter for you immediately.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"hi-IN":{podcast:"                ,                 ",education:"        !   ,              ,  2x  5  11      ,     ",instructions:"   ,               ,             ,      -           ",story:"       ,                              ,    ,          ",ads:"  iPhone  ,                     ,  iPhone         ",news:"     ,                                    ",promotional:",          !                                  ",vlog:",  !       ,                             ,     ",business:"Winnebago Industries      ,               WGO           ",standup:" ,       ,       ,   , ',             ' ,   ?                 ",enthusiastic:" ,    !  !           ?  , ,    ?    !",casual:" ,      !   :             ,                ,  Cirque du Soleil     ",hesitant:", ,    ,   ,     , ,    , ,       ?         ,  ",callcenter:"            ,                                     ",explainer:"                 ,              ,     -                 ,                   "},"es-ES":{podcast:"Bienvenidos a nuestro programa sobre el fascinante mundo de la biologa marina. Desde las profundidades del ocano hasta las costas, exploraremos las maravillas del mundo submarino y las criaturas asombrosas que lo habitan.",education:"Bienvenidos a la clase de matemticas en lnea de hoy! En esta sesin, nos adentraremos en el fascinante mundo del lgebra. Empezaremos explorando los fundamentos, desde resolver ecuaciones simples como 2x ms 5 igual a 11, hasta comprender variables y coeficientes.",instructions:"Al completar la inspeccin, tome notas claras y completas. Utilice nuestra lista de verificacin estandarizada como gua, anotando cualquier desviacin o rea de preocupacin. Si es posible, tome fotografas para documentar visualmente cualquier peligro o problema de incumplimiento.",story:"Una suave melancola pesaba sobre su corazn, tejida de recuerdos de un tiempo cuando las risas resonaban por estos mismos prados. Acarici los delicados ptalos de una margarita olvidada, perdida en sus pensamientos hasta que una voz suave rompi el silencio.",ads:"Presentamos el nuevo iPhone, que establece el estndar de Innovacin Redefinida. Con un diseo elegante y funciones de vanguardia, este iPhone redefine la cspide de la tecnologa.",news:"En las noticias internacionales, la reciente misin exitosa de la NASA para enviar un rover a explorar Marte ha captado la atencin del mundo. El rover, llamado Perseverance, aterriz en la superficie marciana a principios de esta semana.",promotional:"Seoras, es hora de mimarse! Reglese un momento de felicidad con nuestro exclusivo Paquete de Spa de Invierno. Disfrute de un da de spa rejuvenecedor como nunca antes y deje que sus preocupaciones se derritan.",vlog:"Hola, gente hermosa! Bienvenidos de nuevo a mi canal. Hoy, vamos a compartir todos los detalles sobre los ltimos imprescindibles de maquillaje. Ya sea que seas un entusiasta del maquillaje o simplemente quieras mejorar tu juego de glamour, ests en el lugar correcto.",business:"Winnebago Industries es una empresa que fabrica autocaravanas, remolques de viaje y otros vehculos recreativos. Su smbolo de cotizacin burstil es WGO y se cotiza en la Bolsa de Nueva York.",standup:"Oh vaya, aqu vamos. Sabis, entr en este espectculo de improvisacin y pens: 'Oye, esto podra ser divertido. Quizs tengan una sorpresa para m.' Pues, adivinis qu? La sorpresa fue que me obligaron a hacer monlogos para vosotros.",enthusiastic:"Oh Dios mo, esas son noticias increbles! Enhorabuena! Cmo te sientes al respecto? Emocionado, nervioso, o una mezcla de ambos? Cuntamelo todo!",casual:"Oh no, no quise decepcionarte! Qu te parece esto? Si quieres algo peculiar y divertido con muchas risas, ve a ver Blue Man Group. Si buscas algo impresionante y mgico, Cirque du Soleil es tu mejor opcin.",hesitant:"Entonces, eh, estaba pensandono, quiero decir, me preguntaba si, um, si tal vez quisieras ir al, eh, el nuevo restaurante italiano el viernes. He odo que es realmentecul es la palabra?oh, exquisito.",callcenter:"Gracias por llamar al servicio de atencin al cliente. Mi nombre es Carmen, y estar encantada de ayudarle hoy. Entiendo que est experimentando un problema con su cuenta. Permtame consultar su informacin y ver cmo puedo resolver esto para usted de inmediato.",explainer:"Permtanme explicar cmo funciona la fotosntesis. Las plantas utilizan la luz solar, el agua y el dixido de carbono para crear energa. El proceso ocurre en los cloroplastos, que contienen clorofila, el pigmento verde que da a las plantas su color. Cuando la luz solar llega a las hojas, desencadena una reaccin qumica que convierte estos ingredientes en glucosa y oxgeno."},"es-MX":{podcast:"Bienvenidos a nuestro podcast sobre el fascinante mundo de la biologa marina. Desde las profundidades del mar hasta nuestras costas, exploraremos las maravillas del mundo submarino y las criaturas asombrosas que lo habitan.",education:"Bienvenidos a la clase de matemticas en lnea de hoy! En esta sesin, nos adentraremos en el fascinante mundo del lgebra. Comenzaremos explorando los fundamentos, desde resolver ecuaciones simples como 2x ms 5 igual a 11, hasta comprender variables y coeficientes.",instructions:"Al completar la inspeccin, tome notas claras y completas. Utilice nuestra lista de verificacin estandarizada como gua, anotando cualquier desviacin o rea de preocupacin. Si es posible, tome fotografas para documentar visualmente cualquier peligro o problema de incumplimiento.",story:"Una suave melancola pesaba sobre su corazn, tejida de recuerdos de un tiempo cuando las risas resonaban por estos mismos prados. Acarici los delicados ptalos de una margarita olvidada, perdida en sus pensamientos hasta que una voz suave rompi el silencio.",ads:"Presentamos el nuevo iPhone, que establece el estndar de Innovacin Redefinida. Con un diseo elegante y funciones de vanguardia, este iPhone redefine la cspide de la tecnologa.",news:"En las noticias internacionales, la reciente misin exitosa de la NASA para enviar un rover a explorar Marte ha captado la atencin del mundo. El rover, llamado Perseverance, aterriz en la superficie marciana a principios de esta semana.",promotional:"Seoras, es hora de consentirse! Reglense un momento de felicidad con nuestro exclusivo Paquete de Spa de Invierno. Disfruten de un da de spa rejuvenecedor como nunca antes y dejen que sus preocupaciones se derritan.",vlog:"Hola, gente linda! Bienvenidos de nuevo a mi canal. Hoy, vamos a compartir todos los detalles sobre los ltimos imprescindibles de maquillaje. Ya sea que sean entusiastas del maquillaje o simplemente quieran mejorar su juego de glamour, estn en el lugar correcto.",business:"Winnebago Industries es una compaa que fabrica casas rodantes, trileres de viaje y otros vehculos recreativos. Su smbolo de cotizacin burstil es WGO y se cotiza en la Bolsa de Nueva York.",standup:"Ay gey, aqu vamos. Saben, entr a este show de improvisacin y pens: 'rale, esto podra ser divertido. A lo mejor tienen una sorpresa para m.' Pues, adivinen qu? La sorpresa fue que me obligaron a hacer stand-up para ustedes.",enthusiastic:"Ay, qu padre! Esas son noticias increbles! Felicidades! Cmo te sientes al respecto? Emocionado, nervioso, o una mezcla de ambos? Cuntamelo todo!",casual:"Ay no, no quise decepcionarte! Qu te parece esto? Si quieres algo peculiar y divertido con muchas risas, ve a ver Blue Man Group. Si buscas algo impresionante y mgico, Cirque du Soleil es tu mejor opcin.",hesitant:"Entonces, eh, estaba pensandono, o sea, me preguntaba si, este, si tal vez quisieras ir al, eh, el nuevo restaurante italiano el viernes. He odo que es realmentecul es la palabra?ah s, exquisito.",callcenter:"Gracias por llamar a servicio al cliente. Mi nombre es Mara, y con gusto le atender el da de hoy. Entiendo que est teniendo un problema con su cuenta. Permtame consultar su informacin y ver cmo puedo ayudarle a resolver esto de inmediato.",explainer:"Permtanme explicar cmo funciona la fotosntesis. Las plantas utilizan la luz solar, el agua y el dixido de carbono para crear energa. El proceso ocurre en los cloroplastos, que contienen clorofila, el pigmento verde que da a las plantas su color. Cuando la luz solar llega a las hojas, desencadena una reaccin qumica que convierte estos ingredientes en glucosa y oxgeno."},"ja-JP":{podcast:"",education:"2x + 5 = 11",instructions:"",story:"",ads:"iPhoneiPhone",news:"NASA",promotional:"",vlog:"",business:"Winnebago IndustriesWGO",standup:"",enthusiastic:"",casual:"",hesitant:"",callcenter:"",explainer:""},"fr-FR":{podcast:"Bienvenue dans notre mission sur le monde fascinant de la biologie marine. Des profondeurs ocaniques aux ctes, nous explorerons les merveilles du monde sous-marin et les cratures extraordinaires qui l'habitent.",education:"Bienvenue au cours de mathmatiques en ligne d'aujourd'hui ! Dans cette session, nous plongerons dans le monde fascinant de l'algbre. Nous commencerons par explorer les bases, de la rsolution d'quations simples comme 2x plus 5 gale 11,  la comprhension des variables et des coefficients.",instructions:"En effectuant l'inspection, prenez des notes claires et compltes. Utilisez notre liste de contrle standardise comme guide, en notant tout cart ou domaine proccupant. Si possible, prenez des photographies pour documenter visuellement tout danger ou problme de non-conformit.",story:"Une douce mlancolie pesait sur son cur, tisse de souvenirs d'un temps o le rire rsonnait dans ces mmes prairies. Elle caressa les ptales dlicats d'une marguerite oublie, perdue dans ses penses jusqu' ce qu'une voix douce rompe le silence.",ads:"Prsentation du tout nouvel iPhone, tablissant la norme de l'Innovation Redfinie. Arborant un design lgant et des fonctionnalits de pointe, cet iPhone redfinit le summum de la technologie.",news:"En tournant vers les nouvelles internationales, la rcente mission russie de la NASA pour envoyer un rover explorer Mars a capt l'attention du monde. Le rover, nomm Perseverance, s'est pos sur la surface martienne plus tt cette semaine.",promotional:"Mesdames, il est temps de vous faire plaisir ! Offrez-vous un moment de bonheur avec notre forfait spa d'hiver exclusif. Profitez d'une journe spa rajeunissante comme jamais auparavant et laissez vos soucis s'envoler.",vlog:"Salut, les gens magnifiques ! Bienvenue sur ma chane. Aujourd'hui, nous allons partager tous les dtails sur les derniers incontournables du maquillage. Que vous soyez passionn de maquillage ou que vous cherchiez simplement  amliorer votre jeu glamour, vous tes au bon endroit.",business:"Winnebago Industries est une entreprise qui fabrique des camping-cars, des caravanes et d'autres vhicules rcratifs. Son symbole boursier est WGO et elle est cote  la Bourse de New York.",standup:"Oh l l, c'est parti. Vous savez, je suis entr dans ce spectacle d'improvisation, et je me suis dit : 'H, a pourrait tre amusant. Peut-tre qu'ils auront une surprise pour moi.' Eh bien, devinez quoi ? La surprise, c'est qu'on m'a oblig  faire du stand-up pour vous.",enthusiastic:"Oh mon Dieu, c'est une nouvelle incroyable ! Flicitations ! Comment vous sentez-vous  ce sujet ? Excit, nerveux, ou un mlange des deux ? Racontez-moi tout !",casual:"Oh non, je ne voulais pas vous dcevoir ! Que diriez-vous de ceci : Si vous voulez quelque chose d'original et amusant avec beaucoup de rires, optez pour Blue Man Group. Si vous cherchez quelque chose d'impressionnant et magique, Cirque du Soleil est votre meilleur choix.",hesitant:"Alors, euh, je pensaisnon, je veux dire, je me demandais si, euh, si vous aimeriez aller au, euh, nouveau restaurant italien vendredi ? J'ai entendu dire que c'est vraimentquel est le motoh, exquis.",callcenter:"Merci d'avoir appel le service client. Je m'appelle Sophie, et je serai ravie de vous aider aujourd'hui. Je comprends que vous rencontrez un problme avec votre compte. Permettez-moi de consulter vos informations et voir comment je peux rsoudre cela pour vous immdiatement.",explainer:"Permettez-moi d'expliquer comment fonctionne la photosynthse. Les plantes utilisent la lumire du soleil, l'eau et le dioxyde de carbone pour crer de l'nergie. Le processus se droule dans les chloroplastes, qui contiennent de la chlorophylle - le pigment vert qui donne leur couleur aux plantes. Lorsque la lumire du soleil frappe les feuilles, elle dclenche une raction chimique qui convertit ces ingrdients en glucose et en oxygne."},"fr-CA":{podcast:"Bienvenue  notre mission sur le merveilleux monde de la biologie marine. Des profondeurs de l'ocan jusqu'aux ctes, nous explorerons les merveilles du monde sous-marin et les cratures remarquables qui l'habitent.",education:"Bienvenue au cours de mathmatiques en ligne d'aujourd'hui ! Dans cette session, nous plongerons dans le monde fascinant de l'algbre. Nous commencerons par explorer les bases, de la rsolution d'quations simples comme 2x plus 5 gale 11,  la comprhension des variables et des coefficients.",instructions:"En effectuant l'inspection, prenez des notes claires et compltes. Utilisez notre liste de contrle standardise comme guide, en notant tout cart ou domaine proccupant. Si possible, prenez des photos pour documenter visuellement tout danger ou problme de non-conformit.",story:"Une douce mlancolie pesait sur son cur, tisse de souvenirs d'un temps o le rire rsonnait dans ces mmes prairies. Elle caressa les ptales dlicats d'une marguerite oublie, perdue dans ses penses jusqu' ce qu'une voix douce rompe le silence.",ads:"Prsentation du tout nouvel iPhone, tablissant la norme de l'Innovation Redfinie. Arborant un design lgant et des fonctionnalits de pointe, cet iPhone redfinit le summum de la technologie.",news:"En tournant vers les nouvelles internationales, la rcente mission russie de la NASA pour envoyer un rover explorer Mars a capt l'attention du monde. Le rover, nomm Perseverance, s'est pos sur la surface martienne plus tt cette semaine.",promotional:"Mesdames, c'est le temps de vous gter ! Offrez-vous un moment de bonheur avec notre forfait spa d'hiver exclusif. Profitez d'une journe spa rajeunissante comme jamais auparavant et laissez vos soucis s'envoler.",vlog:"Salut, les gens magnifiques ! Bienvenue sur ma chane. Aujourd'hui, on va partager tous les dtails sur les derniers incontournables du maquillage. Que vous soyez passionn de maquillage ou que vous cherchiez simplement  amliorer votre jeu glamour, vous tes  la bonne place.",business:"Winnebago Industries est une entreprise qui fabrique des vhicules rcratifs, des roulottes et d'autres vhicules de loisir. Son symbole boursier est WGO et elle est cote  la Bourse de New York.",standup:"Oh l l, a commence. Vous savez, je suis entr dans ce spectacle d'improvisation, pis je me suis dit : 'H, a pourrait tre le fun. Peut-tre qu'ils auront une surprise pour moi.' Ben, devinez quoi ? La surprise, c'est qu'on m'a oblig  faire du stand-up pour vous autres.",enthusiastic:"Oh mon Dieu, c'est une nouvelle incroyable ! Flicitations ! Comment tu te sens par rapport  a ? Excit, nerveux, ou un mlange des deux ? Raconte-moi tout !",casual:"Oh non, je voulais pas te dcevoir ! Que dirais-tu de a : Si tu veux quelque chose d'original pis amusant avec ben des rires, va voir Blue Man Group. Si tu cherches quelque chose d'impressionnant pis magique, Cirque du Soleil est ton meilleur choix.",hesitant:"Alors, euh, je pensaisnon, je veux dire, je me demandais si, euh, si tu aimerais aller au, euh, nouveau restaurant italien vendredi ? J'ai entendu dire que c'est vraimentquel est le motoh, exquis.",callcenter:"Merci d'avoir appel le service  la clientle. Je m'appelle Isabelle, et je serai heureuse de vous aider aujourd'hui. Je comprends que vous prouvez un problme avec votre compte. Permettez-moi de consulter vos informations et voir comment je peux rgler a pour vous tout de suite.",explainer:"Permettez-moi d'expliquer comment fonctionne la photosynthse. Les plantes utilisent la lumire du soleil, l'eau et le dioxyde de carbone pour crer de l'nergie. Le processus se droule dans les chloroplastes, qui contiennent de la chlorophylle - le pigment vert qui donne leur couleur aux plantes. Lorsque la lumire du soleil frappe les feuilles, elle dclenche une raction chimique qui convertit ces ingrdients en glucose et en oxygne."},"pt-BR":{podcast:"Bem-vindos ao nosso podcast sobre o fascinante mundo da biologia marinha. Das profundezas do oceano at as costas, vamos explorar as maravilhas do mundo submarino e as criaturas incrveis que o habitam.",education:"Bem-vindos  aula de matemtica online de hoje! Nesta sesso, vamos mergulhar no fascinante mundo da lgebra. Comearemos explorando os fundamentos, desde resolver equaes simples como 2x mais 5 igual a 11, at entender variveis e coeficientes.",instructions:"Ao completar a inspeo, faa anotaes claras e abrangentes. Use nossa lista de verificao padronizada como guia, anotando quaisquer desvios ou reas de preocupao. Se possvel, tire fotografias para documentar visualmente quaisquer perigos ou problemas de no conformidade.",story:"Uma melancolia suave pesava em seu corao, tecida de memrias de um tempo quando risadas ecoavam por estes mesmos prados. Ela acariciou as delicadas ptalas de uma margarida esquecida, perdida em pensamentos at que uma voz suave quebrou o silncio.",ads:"Apresentando o novssimo iPhone, estabelecendo o padro para Inovao Redefinida. Com um design elegante e recursos de ponta, este iPhone redefine o pice da tecnologia.",news:"Nas notcias internacionais, a recente misso bem-sucedida da NASA para enviar um rover para explorar Marte capturou a ateno do mundo. O rover, chamado Perseverance, pousou na superfcie marciana no incio desta semana.",promotional:"Senhoras,  hora de se mimarem! Presenteiem-se com um momento de felicidade com nosso exclusivo Pacote de Spa de Inverno. Deliciem-se com um dia de spa rejuvenescedor como nunca antes e deixem suas preocupaes derreterem.",vlog:"E a, gente linda! Bem-vindos de volta ao meu canal. Hoje, vamos compartilhar todos os detalhes sobre os ltimos itens indispensveis de maquiagem. Seja voc um entusiasta de maquiagem ou apenas procurando melhorar seu jogo de glamour, voc est no lugar certo.",business:"Winnebago Industries  uma empresa que fabrica trailers, reboques de viagem e outros veculos recreativos. Seu smbolo de aes  WGO e  negociado na Bolsa de Valores de Nova York.",standup:"Ah cara, l vamos ns. Sabe, eu entrei nesse show de improviso e pensei: 'Ei, isso pode ser divertido. Talvez eles tenham uma surpresa para mim.' Bem, adivinha o qu? A surpresa foi que me obrigaram a fazer stand-up para vocs.",enthusiastic:"Meu Deus, essa  uma notcia incrvel! Parabns! Como voc est se sentindo sobre isso tudo? Empolgado, nervoso, ou uma mistura dos dois? Me conta tudo!",casual:"Ah no, no quis decepcionar! Que tal isso: Se voc quer algo peculiar e divertido com muitas risadas, v de Blue Man Group. Se voc est procurando algo impressionante e mgico, Cirque du Soleil  sua melhor aposta.",hesitant:"Ento, , eu estava pensandono, quero dizer, eu estava me perguntando se, hum, se voc talvez quisesse ir ao, , o novo restaurante italiano na sexta-feira? Eu ouvi que  realmentequal  a palavraah, requintado.",callcenter:"Obrigada por ligar para o suporte ao cliente. Meu nome  Juliana, e terei o prazer de ajud-lo hoje. Entendo que voc est enfrentando um problema com sua conta. Deixe-me consultar suas informaes e ver como posso resolver isso para voc imediatamente.",explainer:"Deixe-me explicar como funciona a fotossntese. As plantas usam luz solar, gua e dixido de carbono para criar energia. O processo acontece nos cloroplastos, que contm clorofila - o pigmento verde que d s plantas sua cor. Quando a luz solar atinge as folhas, ela desencadeia uma reao qumica que converte esses ingredientes em glicose e oxignio."},"pt-PT":{podcast:"Bem-vindos ao nosso programa sobre o fascinante mundo da biologia marinha. Desde as profundezas do oceano at s costas, iremos explorar as maravilhas do mundo submarino e as criaturas extraordinrias que o habitam.",education:"Bem-vindos  aula de matemtica online de hoje! Nesta sesso, vamos mergulhar no fascinante mundo da lgebra. Comearemos por explorar os fundamentos, desde resolver equaes simples como 2x mais 5 igual a 11, at compreender variveis e coeficientes.",instructions:"Ao completar a inspeo, faa anotaes claras e abrangentes. Use a nossa lista de verificao padronizada como guia, anotando quaisquer desvios ou reas de preocupao. Se possvel, tire fotografias para documentar visualmente quaisquer perigos ou problemas de no conformidade.",story:"Uma melancolia suave pesava no seu corao, tecida de memrias de um tempo quando risadas ecoavam por estes mesmos prados. Ela acariciou as delicadas ptalas de uma margarida esquecida, perdida em pensamentos at que uma voz suave quebrou o silncio.",ads:"Apresentamos o novssimo iPhone, estabelecendo o padro para Inovao Redefinida. Com um design elegante e funcionalidades de ponta, este iPhone redefine o auge da tecnologia.",news:"Nas notcias internacionais, a recente misso bem-sucedida da NASA para enviar um rover para explorar Marte capturou a ateno do mundo. O rover, chamado Perseverance, aterrou na superfcie marciana no incio desta semana.",promotional:"Senhoras,  hora de se mimarem! Presenteiem-se com um momento de felicidade com o nosso exclusivo Pacote de Spa de Inverno. Deliciem-se com um dia de spa rejuvenescedor como nunca antes e deixem as vossas preocupaes derreterem.",vlog:"Ol, gente linda! Bem-vindos de volta ao meu canal. Hoje, vamos partilhar todos os detalhes sobre os ltimos indispensveis de maquilhagem. Quer sejam entusiastas de maquilhagem ou apenas procurem melhorar o vosso jogo de glamour, esto no stio certo.",business:"Winnebago Industries  uma empresa que fabrica autocaravanas, reboques de viagem e outros veculos recreativos. O seu smbolo de cotao  WGO e  negociado na Bolsa de Valores de Nova Iorque.",standup:"Oh cus, c vamos ns. Sabem, entrei neste espetculo de improviso e pensei: 'Eh p, isto pode ser divertido. Talvez tenham uma surpresa para mim.' Bem, adivinhem? A surpresa foi que me obrigaram a fazer stand-up para vocs.",enthusiastic:"Meu Deus, essa  uma notcia fantstica! Parabns! Como se est a sentir em relao a isto tudo? Entusiasmado, nervoso, ou uma mistura dos dois? Conta-me tudo!",casual:"Oh no, no quis desiludir! Que tal isto: Se querem algo peculiar e divertido com muitas risadas, vo ao Blue Man Group. Se procuram algo impressionante e mgico, o Cirque du Soleil  a vossa melhor aposta.",hesitant:"Ento, , eu estava a pensarno, quer dizer, estava a perguntar-me se, hum, se talvez quisesses ir ao, , o novo restaurante italiano na sexta-feira? Ouvi dizer que  realmentequal  a palavraah, requintado.",callcenter:"Obrigada por contactar o apoio ao cliente. O meu nome  Sofia, e terei todo o gosto em ajud-lo hoje. Compreendo que est a ter um problema com a sua conta. Permita-me consultar as suas informaes e ver como posso resolver isto para si de imediato.",explainer:"Permitam-me explicar como funciona a fotossntese. As plantas usam luz solar, gua e dixido de carbono para criar energia. O processo acontece nos cloroplastos, que contm clorofila - o pigmento verde que d s plantas a sua cor. Quando a luz solar atinge as folhas, desencadeia uma reao qumica que converte estes ingredientes em glucose e oxignio."},"it-IT":{podcast:"Benvenuti al nostro programma sul affascinante mondo della biologia marina. Dalle profondit dell'oceano alle coste, esploreremo le meraviglie del mondo sottomarino e le creature straordinarie che lo abitano.",education:"Benvenuti alla lezione di matematica online di oggi! In questa sessione, ci immergeremo nel affascinante mondo dell'algebra. Inizieremo esplorando i fondamenti, dalla risoluzione di equazioni semplici come 2x pi 5 uguale 11, alla comprensione di variabili e coefficienti.",instructions:"Mentre completi l'ispezione, prendi note chiare e complete. Usa la nostra lista di controllo standardizzata come guida, annotando eventuali deviazioni o aree di preoccupazione. Se possibile, scatta fotografie per documentare visivamente eventuali pericoli o problemi di non conformit.",story:"Una dolce malinconia pesava sul suo cuore, tessuta da ricordi di un tempo quando le risate risuonavano in questi stessi prati. Accarezz i delicati petali di una margherita dimenticata, persa nei pensieri finch una voce dolce ruppe il silenzio.",ads:"Vi presentiamo il nuovissimo iPhone, che stabilisce lo standard per l'Innovazione Ridefinita. Con un design elegante e funzionalit all'avanguardia, questo iPhone ridefinisce l'apice della tecnologia.",news:"Passando alle notizie internazionali, la recente missione di successo della NASA per inviare un rover ad esplorare Marte ha catturato l'attenzione del mondo. Il rover, chiamato Perseverance,  atterrato sulla superficie marziana all'inizio di questa settimana.",promotional:"Signore,  ora di coccolarsi! Regalatevi un momento di felicit con il nostro esclusivo Pacchetto Spa Invernale. Concedetevi una giornata termale rigenerante come mai prima d'ora e lasciate che le vostre preoccupazioni si sciolgano.",vlog:"Ciao, belle persone! Bentornati sul mio canale. Oggi condivideremo tutti i dettagli sugli ultimi must-have del trucco. Che siate appassionati di trucco o semplicemente vogliate migliorare il vostro gioco glamour, siete nel posto giusto.",business:"Winnebago Industries  un'azienda che produce camper, roulotte e altri veicoli ricr eativi. Il suo simbolo azionario  WGO ed  quotata alla Borsa di New York.",standup:"Oh cavolo, eccoci qui. Sapete, sono entrato in questo spettacolo di improvvisazione e ho pensato: 'Ehi, questo potrebbe essere divertente. Forse avranno una sorpresa per me.' Beh, indovinate un po'? La sorpresa  stata che mi hanno costretto a fare stand-up per voi.",enthusiastic:"Oh mio Dio, questa  una notizia fantastica! Congratulazioni! Come ti senti riguardo a tutto questo? Eccitato, nervoso, o un mix di entrambi? Dimmi tutto!",casual:"Oh no, non volevo deluderti! Che ne dici di questo: Se vuoi qualcosa di stravagante e divertente con tante risate, scegli Blue Man Group. Se cerchi qualcosa di impressionante e magico, Cirque du Soleil  la tua scelta migliore.",hesitant:"Allora, ehm, stavo pensandono, voglio dire, mi chiedevo se, ehm, se forse vorresti andare al, ehm, nuovo ristorante italiano venerd? Ho sentito che  davveroqual  la parolaoh, squisito.",callcenter:"Grazie per aver chiamato l'assistenza clienti. Mi chiamo Francesca, e sar lieta di aiutarla oggi. Capisco che sta riscontrando un problema con il suo account. Mi permetta di consultare le sue informazioni e vedere come posso risolvere questo per lei immediatamente.",explainer:"Permettetemi di spiegare come funziona la fotosintesi. Le piante usano la luce solare, l'acqua e l'anidride carbonica per creare energia. Il processo avviene nei cloroplasti, che contengono la clorofilla - il pigmento verde che d alle piante il loro colore. Quando la luce solare colpisce le foglie, innesca una reazione chimica che converte questi ingredienti in glucosio e ossigeno."}};function cO(r){const e=r.match(/^([a-z]{2}-[A-Z]{2})/i);if(e){const t=e[1].split("-");return`${t[0].toLowerCase()}-${t[1].toUpperCase()}`}return"en-US"}function PF(r){if(bT[r])return bT[r];if(L2[r]){const e=L2[r];return{podcast:e,education:e,instructions:e,story:e,ads:e,news:e,promotional:e,vlog:e,business:e,standup:e,enthusiastic:e,casual:e,hesitant:e,callcenter:e,explainer:e}}return bT["en-US"]}function EF({text:r,onTextChange:e,wordBoundaries:t,currentWordIndex:n,selectedVoice:i,state:s,personalVoiceInfo:o,selectedPresetLanguage:a,onPresetLanguageChange:l}){const u=O.useRef(null),h=O.useRef(null),[m,g]=O.useState(!1),v=r.trim()?r.trim().split(/\s+/).length:0,y=r.length,A=cO(i),b=PF(a||A),w=B=>{const z=b[B];z&&(e(z),g(!1))},T=s==="synthesizing"||s==="playing",k=()=>{u.current&&h.current&&(h.current.scrollTop=u.current.scrollTop,h.current.scrollLeft=u.current.scrollLeft)};O.useEffect(()=>{if(n>=0&&n<t.length){const B=t[n];if(u.current&&h.current){const z=u.current,Z=document.createElement("div");Z.style.cssText=window.getComputedStyle(z).cssText,Z.style.position="absolute",Z.style.visibility="hidden",Z.style.height="auto",Z.style.width=`${z.clientWidth-24}px`,Z.style.whiteSpace="pre-wrap",Z.style.wordWrap="break-word",Z.style.font=window.getComputedStyle(z).font,Z.style.lineHeight=window.getComputedStyle(z).lineHeight,Z.style.padding="0",document.body.appendChild(Z);const $=r.substring(0,B.offset);Z.textContent=$;const U=Z.scrollHeight,Y=r.substring(0,B.offset+B.length);Z.textContent=Y;const ee=Z.scrollHeight;document.body.removeChild(Z);const X=z.scrollTop,re=z.clientHeight,G=X+re,J=50;U<X+J?z.scrollTop=Math.max(0,U-J):ee>G-J&&(z.scrollTop=ee-re+J),h.current.scrollTop=z.scrollTop,h.current.scrollLeft=z.scrollLeft}}},[n,t,r]);const I=()=>{if(n<0||n>=t.length)return r;const B=t[n],z=r.substring(0,B.offset),Z=r.substring(B.offset,B.offset+B.length),$=r.substring(B.offset+B.length);return f.jsxs(f.Fragment,{children:[z,f.jsx("span",{className:"bg-yellow-300 font-semibold",children:Z}),$]})},M=B=>{if(!B.trim())return null;const z=/[\u4e00-\u9fff\u3400-\u4dbf]/g,Z=/[\u3040-\u309f\u30a0-\u30ff]/g,$=/[\uac00-\ud7af\u1100-\u11ff]/g,U=/[\u0600-\u06ff]/g,Y=/[\u0590-\u05ff]/g,ee=/[\u0400-\u04ff]/g,X=/[\u0e00-\u0e7f]/g,re=(B.match(z)||[]).length,G=(B.match(Z)||[]).length,J=(B.match($)||[]).length,ne=(B.match(U)||[]).length,W=(B.match(Y)||[]).length,V=(B.match(ee)||[]).length,ce=(B.match(X)||[]).length,ue=5;return G>ue?"ja-JP":J>ue?"ko-KR":re>ue?"zh-CN":ne>ue?"ar-SA":W>ue?"he-IL":V>ue?"ru-RU":ce>ue?"th-TH":null},j=m?(()=>{const B=M(r),z=a||B||A||"en-US";return o!=null&&o.isPersonalVoice&&(o!=null&&o.speakerProfileId)?av(r,o.speakerProfileId,z,o.model||"DragonLatestNeural"):`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="${z}">
  <voice name="${i}">
    ${r}
  </voice>
</speak>`})():r;return f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Text to Synthesize"}),f.jsxs("div",{className:"flex gap-4 text-sm text-gray-600",children:[f.jsxs("span",{children:[v," word",v!==1?"s":""]}),f.jsxs("span",{children:[y," char",y!==1?"s":""]})]})]}),f.jsxs("div",{className:"mb-3 grid grid-cols-[200px_1fr] gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preset Language"}),f.jsxs("select",{value:a,onChange:B=>l(B.target.value),disabled:T,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[f.jsxs("option",{value:"",children:["Voice Language (",A,")"]}),f.jsx("option",{value:"ar-EG",children:"Arabic (Egypt)"}),f.jsx("option",{value:"ar-SA",children:"Arabic (Saudi Arabia)"}),f.jsx("option",{value:"bg-BG",children:"Bulgarian"}),f.jsx("option",{value:"ca-ES",children:"Catalan"}),f.jsx("option",{value:"cs-CZ",children:"Czech"}),f.jsx("option",{value:"cy-GB",children:"Welsh"}),f.jsx("option",{value:"da-DK",children:"Danish"}),f.jsx("option",{value:"de-DE",children:"German"}),f.jsx("option",{value:"el-GR",children:"Greek"}),f.jsx("option",{value:"en-AU",children:"English (Australia)"}),f.jsx("option",{value:"en-CA",children:"English (Canada)"}),f.jsx("option",{value:"en-GB",children:"English (UK)"}),f.jsx("option",{value:"en-IN",children:"English (India)"}),f.jsx("option",{value:"en-US",children:"English (US)"}),f.jsx("option",{value:"es-ES",children:"Spanish (Spain)"}),f.jsx("option",{value:"es-MX",children:"Spanish (Mexico)"}),f.jsx("option",{value:"et-EE",children:"Estonian"}),f.jsx("option",{value:"fi-FI",children:"Finnish"}),f.jsx("option",{value:"fr-CA",children:"French (Canada)"}),f.jsx("option",{value:"fr-FR",children:"French (France)"}),f.jsx("option",{value:"he-IL",children:"Hebrew"}),f.jsx("option",{value:"hi-IN",children:"Hindi"}),f.jsx("option",{value:"hr-HR",children:"Croatian"}),f.jsx("option",{value:"hu-HU",children:"Hungarian"}),f.jsx("option",{value:"id-ID",children:"Indonesian"}),f.jsx("option",{value:"it-IT",children:"Italian"}),f.jsx("option",{value:"ja-JP",children:"Japanese"}),f.jsx("option",{value:"ko-KR",children:"Korean"}),f.jsx("option",{value:"lt-LT",children:"Lithuanian"}),f.jsx("option",{value:"lv-LV",children:"Latvian"}),f.jsx("option",{value:"nb-NO",children:"Norwegian"}),f.jsx("option",{value:"nl-NL",children:"Dutch"}),f.jsx("option",{value:"pl-PL",children:"Polish"}),f.jsx("option",{value:"pt-BR",children:"Portuguese (Brazil)"}),f.jsx("option",{value:"pt-PT",children:"Portuguese (Portugal)"}),f.jsx("option",{value:"ro-RO",children:"Romanian"}),f.jsx("option",{value:"ru-RU",children:"Russian"}),f.jsx("option",{value:"sk-SK",children:"Slovak"}),f.jsx("option",{value:"sl-SI",children:"Slovenian"}),f.jsx("option",{value:"sr-RS",children:"Serbian"}),f.jsx("option",{value:"sv-SE",children:"Swedish"}),f.jsx("option",{value:"th-TH",children:"Thai"}),f.jsx("option",{value:"tr-TR",children:"Turkish"}),f.jsx("option",{value:"uk-UA",children:"Ukrainian"}),f.jsx("option",{value:"vi-VN",children:"Vietnamese"}),f.jsx("option",{value:"zh-CN",children:"Chinese (Mandarin)"}),f.jsx("option",{value:"zh-TW",children:"Chinese (Taiwan)"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Load Preset Text"}),f.jsxs("select",{onChange:B=>w(B.target.value),disabled:T,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",defaultValue:"",children:[f.jsx("option",{value:"",children:"-- Select a preset --"}),f.jsx("option",{value:"podcast",children:"Podcast"}),f.jsx("option",{value:"education",children:"Education/Learning"}),f.jsx("option",{value:"instructions",children:"Instructions/Guidance"}),f.jsx("option",{value:"story",children:"Story/Narrative"}),f.jsx("option",{value:"ads",children:"Advertisement"}),f.jsx("option",{value:"news",children:"News Report"}),f.jsx("option",{value:"promotional",children:"Promotional/Marketing"}),f.jsx("option",{value:"vlog",children:"Vlog/Social Media"}),f.jsx("option",{value:"business",children:"Business/Professional"}),f.jsx("option",{value:"callcenter",children:"Call Center/Customer Care"}),f.jsx("option",{value:"standup",children:"Stand-up Comedy"}),f.jsx("option",{value:"enthusiastic",children:"Enthusiastic/Excited"}),f.jsx("option",{value:"casual",children:"Casual Conversation"}),f.jsx("option",{value:"hesitant",children:"Hesitant/Uncertain"}),f.jsx("option",{value:"explainer",children:"Explainer Video"})]})]})]}),f.jsxs("div",{className:"flex-1 relative",children:[n>=0&&f.jsx("div",{ref:h,className:"absolute inset-0 px-3 py-2 pointer-events-none overflow-auto whitespace-pre-wrap break-words font-mono text-base leading-6 text-transparent",style:{zIndex:1},children:I()}),f.jsx("textarea",{ref:u,value:j,onChange:B=>!m&&e(B.target.value),onScroll:k,placeholder:"Enter text here to convert to speech...",readOnly:m,className:"w-full h-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none font-mono text-base leading-6",style:{position:"relative",zIndex:2,background:m?"#f9fafb":"transparent"}})]}),f.jsxs("div",{className:"mt-4 flex gap-2",children:[f.jsx("button",{onClick:()=>g(!m),disabled:!r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Show Plain Text":"Show SSML"}),f.jsx("button",{onClick:()=>e(""),disabled:!r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Clear Text"})]})]})}function uO({state:r,error:e,audioData:t,hasText:n,isConfigured:i,onPlay:s,onPause:o,onResume:a,onStop:l}){const[u,h]=O.useState(!1),m=n&&i&&r==="idle",g=r==="playing",v=r==="paused",y=r==="playing"||r==="paused"||r==="synthesizing",A=()=>{switch(r){case"idle":return"Ready";case"synthesizing":return"Synthesizing...";case"playing":return"Playing";case"paused":return"Paused";case"error":return"Error";default:return"Unknown"}},x=()=>{switch(r){case"idle":return"text-gray-600";case"synthesizing":return"text-blue-600";case"playing":return"text-green-600";case"paused":return"text-yellow-600";case"error":return"text-red-600";default:return"text-gray-600"}};return f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center justify-between",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status:"}),f.jsx("span",{className:`text-sm font-semibold ${x()}`,children:A()}),r==="synthesizing"&&f.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full"})]})}),e&&f.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:[f.jsx("p",{className:"text-sm text-red-700 font-medium",children:"Error:"}),f.jsx("p",{className:"text-xs text-red-600 mt-1",children:e})]}),!i&&f.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:f.jsx("p",{className:"text-sm text-yellow-700",children:"Please configure your API key and region in the settings panel."})}),f.jsxs("div",{className:"flex gap-2 flex-wrap",children:[f.jsx("button",{onClick:s,disabled:!m,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-600",title:n?i?"Play":"Configure settings first":"Enter text first",children:" Play"}),v?f.jsx("button",{onClick:a,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:" Resume"}):f.jsx("button",{onClick:o,disabled:!g,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-yellow-600 rounded-md hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-yellow-600",children:" Pause"}),f.jsx("button",{onClick:l,disabled:!y,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-red-600",children:" Stop"}),f.jsx("button",{onClick:()=>h(!u),className:"px-3 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",title:"Help",children:f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})})]}),u&&f.jsxs("div",{className:"text-xs text-gray-500 space-y-1 pt-2 mt-2 border-t border-gray-200",children:[f.jsx("p",{children:" Click Play to start synthesis and playback"}),f.jsx("p",{children:" Word highlighting shows the current word being spoken"}),f.jsx("p",{children:" Save audio from history panel below"})]})]})}function dO({text:r,selectedVoice:e,region:t,audioData:n}){const i=async()=>{try{const s=`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="en-US">
  <voice name="${e}">
    ${r}
  </voice>
</speak>`,o=`
Voice: ${e}
Region: ${t}

SSML:
${s}

Text:
${r}

${n?"Please find the audio file attached (downloaded separately).":"[No audio generated yet]"}
      `.trim(),a=encodeURIComponent(`Azure Voice Playground Feedback - ${e}`),l=encodeURIComponent(o),u=`mailto:ttsvoicefeedback@microsoft.com?subject=${a}&body=${l}`;if(n){const h=new Blob([n],{type:"audio/mpeg"}),m=URL.createObjectURL(h),g=document.createElement("a");g.href=m,g.download=`feedback-${e}-${Date.now()}.mp3`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(m)}navigator.clipboard&&await navigator.clipboard.writeText(s),window.open(u,"_blank"),n&&alert("Audio file downloaded! Please attach it to your email before sending.")}catch(s){console.error("Error sending feedback:",s),alert("Error preparing feedback. Please try again.")}};return f.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200 text-sm font-medium",title:"Send feedback with SSML and audio",children:[f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[f.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),f.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),"Send Feedback"]})}function hO(r,e){const t=new Blob([r],{type:"audio/mpeg"}),n=URL.createObjectURL(t),i=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5),s=e||`tts-output-${i}.mp3`,o=document.createElement("a");o.href=n,o.download=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(()=>URL.revokeObjectURL(n),100)}function lA(r){return new Promise((e,t)=>{const n=r instanceof Blob?r:new Blob([r],{type:"audio/mpeg"}),i=URL.createObjectURL(n),s=new Audio(i);s.addEventListener("loadedmetadata",()=>{e(s.duration),URL.revokeObjectURL(i)}),s.addEventListener("error",()=>{t(new Error("Failed to load audio metadata")),URL.revokeObjectURL(i)})})}function pO(r){const e=Math.floor(r/60),t=Math.floor(r%60);return`${e}:${t.toString().padStart(2,"0")}`}function RF({entry:r,onDelete:e}){const[t,n]=O.useState(!1),i=O.useRef(null),s=O.useRef(null);O.useEffect(()=>{const m=new Blob([r.audioData],{type:"audio/mpeg"}),g=URL.createObjectURL(m);return s.current=g,()=>{s.current&&URL.revokeObjectURL(s.current)}},[r.audioData]);const o=()=>{i.current||(i.current=new Audio(s.current||""),i.current.addEventListener("ended",()=>{n(!1)})),t?(i.current.pause(),n(!1)):(i.current.play(),n(!0))},a=()=>{const m=new Date(r.timestamp).toISOString().replace(/[:.]/g,"-").slice(0,-5),g=r.voice.replace(/[^a-zA-Z0-9-]/g,"_"),v=r.region.replace(/[^a-zA-Z0-9-]/g,"_"),y=r.model?`-${r.model.replace(/[^a-zA-Z0-9-]/g,"_")}`:"",A=`azurevoice-${v}-${g}${y}-${m}.mp3`;hO(r.audioData,A)},l=()=>{e&&(i.current&&(i.current.pause(),i.current=null),e(r.id))},u=r.text.length>100?r.text.substring(0,100)+"...":r.text,h=new Date(r.timestamp).toLocaleTimeString();return f.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border border-gray-200 rounded-md hover:bg-gray-50",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"text-sm text-gray-800 truncate mb-1",children:u}),f.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 flex-wrap",children:[f.jsx("span",{children:h}),f.jsx("span",{children:""}),f.jsx("span",{className:"truncate max-w-[200px]",children:r.voice}),r.model&&f.jsxs(f.Fragment,{children:[f.jsx("span",{children:""}),f.jsx("span",{className:"text-emerald-600 font-medium",children:r.model})]}),f.jsx("span",{children:""}),f.jsx("span",{children:r.region}),f.jsx("span",{children:""}),f.jsx("span",{children:pO(r.duration)})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:o,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md transition-colors",title:t?"Pause":"Play",children:t?f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),f.jsx("button",{onClick:a,className:"p-2 text-green-600 hover:bg-green-50 rounded-md transition-colors",title:"Save as MP3",children:f.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:[f.jsx("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),f.jsx("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})]})}),e&&f.jsx("button",{onClick:l,className:"p-2 text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z",clipRule:"evenodd"})})})]})]})}function IF({history:r,onClearHistory:e,onDeleteEntry:t}){const[n,i]=O.useState(!1),s=()=>{i(!n)};return f.jsxs("div",{className:"border-t border-gray-200 bg-gray-50",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-gray-100",onClick:s,children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Synthesis History"}),r.length>0&&f.jsx("span",{className:"px-2 py-1 text-xs font-medium text-white bg-blue-600 rounded-full",children:r.length})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[r.length>0&&f.jsx("button",{onClick:o=>{o.stopPropagation(),window.confirm("Clear all history?")&&e()},className:"px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors",children:"Clear All"}),f.jsx("button",{className:"p-1 text-gray-600",children:f.jsx("svg",{className:`w-5 h-5 transform transition-transform ${n?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),n&&f.jsx("div",{className:"px-4 pb-4 max-h-60 overflow-y-auto",children:r.length===0?f.jsxs("div",{className:"py-8 text-center text-gray-500",children:[f.jsx("p",{children:"No synthesis history yet"}),f.jsx("p",{className:"text-sm mt-1",children:"Synthesized audio will appear here"})]}):f.jsx("div",{className:"space-y-2",children:[...r].reverse().map(o=>f.jsx(RF,{entry:o,onDelete:t},o.id))})})]})}const xT={projectId:"personal-voice-playground",voiceTalentName:"",companyName:"Voice Playground",locale:"en-US",voiceName:""},_2=[{code:"en-US",name:"English (US)"},{code:"en-GB",name:"English (UK)"},{code:"zh-CN",name:"Chinese (Simplified)"},{code:"ja-JP",name:"Japanese"},{code:"ko-KR",name:"Korean"},{code:"de-DE",name:"German"},{code:"fr-FR",name:"French"},{code:"es-ES",name:"Spanish (Spain)"},{code:"it-IT",name:"Italian"},{code:"pt-BR",name:"Portuguese (Brazil)"}],fO=[{id:"DragonLatestNeural",name:"Dragon (Latest)",description:"High quality personal voice"},{id:"PhoenixLatestNeural",name:"Phoenix (Latest)",description:"Supports word boundary events"}];function _P(){return O.useMemo(()=>({enableMAIVoices:new URLSearchParams(window.location.search).get("maivoice")==="true"}),[])}function kF({settings:r,onSettingsChange:e,isConfigured:t,history:n,addToHistory:i,removeFromHistory:s,clearHistory:o}){var B,z,Z;const{enableMAIVoices:a}=_P(),[l,u]=O.useState("Welcome to Azure Voice Playground. Select a voice and choose a preset text to get started, or type your own text."),[h,m]=O.useState(""),g=O.useRef(null),{state:v,error:y,wordBoundaries:A,currentWordIndex:x,audioData:b,synthesize:w,pause:T,resume:k,stop:I}=xF(r),M=cO(r.selectedVoice),L=h||M||"en-US";O.useEffect(()=>{var $;if(b&&b!==g.current){g.current=b;const U=($=r.personalVoiceInfo)!=null&&$.isPersonalVoice?r.personalVoiceInfo.model:void 0;lA(b).then(Y=>{i({timestamp:Date.now(),text:l,voice:r.selectedVoice,region:r.region,audioData:b,duration:Y,model:U})}).catch(Y=>{console.error("Failed to get audio duration:",Y);const ee=b.byteLength*8/48e3;i({timestamp:Date.now(),text:l,voice:r.selectedVoice,region:r.region,audioData:b,duration:ee,model:U})})}},[b,l,r.selectedVoice,r.region,r.personalVoiceInfo,i]);const j=()=>{w(l,L)};return f.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[f.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 shadow-md",children:[f.jsx("h1",{className:"text-3xl font-bold",children:"Text to Speech"}),f.jsx("p",{className:"text-blue-100 mt-1",children:"Realtime text-to-Speech voices from Microsoft Foundry Voice Gallery"})]}),f.jsxs("div",{className:"flex-1 grid grid-rows-[1fr_auto] gap-6 p-6 overflow-hidden",children:[f.jsx("div",{className:"overflow-hidden",children:f.jsx(EF,{text:l,onTextChange:u,wordBoundaries:A,currentWordIndex:x,selectedVoice:r.selectedVoice,state:v,personalVoiceInfo:r.personalVoiceInfo,selectedPresetLanguage:h,onPresetLanguageChange:m})}),f.jsx("div",{className:"border-t border-gray-200 pt-6",children:f.jsx(uO,{state:v,error:y,audioData:b,hasText:l.trim().length>0,isConfigured:t,onPlay:j,onPause:T,onResume:k,onStop:I})})]}),f.jsx(IF,{history:n,onClearHistory:o,onDeleteEntry:s}),f.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:"text-xs text-gray-600",children:"Built with React, TypeScript, and Azure Cognitive Services Speech SDK"}),f.jsx(dO,{text:l,selectedVoice:r.selectedVoice,region:r.region,audioData:b})]})})]}),f.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-hidden",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Voice Selection"}),f.jsx("div",{className:"flex-1 min-h-0",children:f.jsx(wF,{apiKey:r.apiKey,region:r.region,selectedVoice:r.selectedVoice,enableMAIVoices:a,onVoiceChange:$=>{console.log("TTSPlayground: Voice changed to:",$),e({selectedVoice:$})},onVoiceInfoChange:$=>{var Y;console.log("TTSPlayground: Voice info changed:",$);const U=$.isPersonalVoice?`personal:${$.voiceName}`:$.voiceName;e({selectedVoice:U,personalVoiceInfo:{isPersonalVoice:$.isPersonalVoice,speakerProfileId:$.speakerProfileId,locale:$.locale,model:$.isPersonalVoice?((Y=r.personalVoiceInfo)==null?void 0:Y.model)||"DragonLatestNeural":void 0}})}})}),((B=r.personalVoiceInfo)==null?void 0:B.isPersonalVoice)&&((z=r.selectedVoice)==null?void 0:z.startsWith("personal:"))&&f.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Voice Model"}),f.jsx("select",{value:((Z=r.personalVoiceInfo)==null?void 0:Z.model)||"DragonLatestNeural",onChange:$=>{e({personalVoiceInfo:{...r.personalVoiceInfo,model:$.target.value}})},className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:fO.map($=>f.jsxs("option",{value:$.id,children:[$.name," - ",$.description]},$.id))})]})]})]})}async function cA(r){const e=new AudioContext({sampleRate:16e3});try{const t=await r.arrayBuffer(),n=await e.decodeAudioData(t),i=n.numberOfChannels>1?MF(n):n.getChannelData(0);return NF(i,16e3)}finally{await e.close()}}function MF(r){const e=r.numberOfChannels,t=r.length,n=new Float32Array(t);for(let i=0;i<e;i++){const s=r.getChannelData(i);for(let o=0;o<t;o++)n[o]+=s[o]/e}return n}function NF(r,e){const t=new ArrayBuffer(44+r.length*2),n=new DataView(t);return R0(n,0,"RIFF"),n.setUint32(4,36+r.length*2,!0),R0(n,8,"WAVE"),R0(n,12,"fmt "),n.setUint32(16,16,!0),n.setUint16(20,1,!0),n.setUint16(22,1,!0),n.setUint32(24,e,!0),n.setUint32(28,e*2,!0),n.setUint16(32,2,!0),n.setUint16(34,16,!0),R0(n,36,"data"),n.setUint32(40,r.length*2,!0),LF(n,44,r),new Blob([t],{type:"audio/wav"})}function R0(r,e,t){for(let n=0;n<t.length;n++)r.setUint8(e+n,t.charCodeAt(n))}function LF(r,e,t){for(let n=0;n<t.length;n++,e+=2){const i=Math.max(-1,Math.min(1,t[n]));r.setInt16(e,i<0?i*32768:i*32767,!0)}}const O2=["en-US","zh-CN","ja-JP","ko-KR"];function _F(r){const[e,t]=O.useState("idle"),[n,i]=O.useState(null),[s,o]=O.useState(""),a=O.useRef(null),l=O.useRef(null);O.useEffect(()=>()=>{a.current&&a.current.close(),l.current&&l.current.close()},[]);const u=O.useCallback(async(g,v)=>{try{t("processing"),o("");const y=await cA(g),A=_t.SpeechConfig.fromSubscription(r.apiKey,r.region);A.outputFormat=_t.OutputFormat.Detailed;const x=_t.AudioInputStream.createPushStream();l.current=x;const b=_t.AudioConfig.fromStreamInput(x);let w;if(v==="auto"){const j=_t.AutoDetectSourceLanguageConfig.fromLanguages(O2);w=_t.SpeechRecognizer.FromConfig(A,j,b),console.log("Auto-detect enabled with languages:",O2)}else A.speechRecognitionLanguage=v,w=new _t.SpeechRecognizer(A,b);a.current=w,i({text:"",segments:[],isStreaming:!0,isFinal:!1,interimText:""}),w.recognizing=(j,B)=>{B.result.reason===_t.ResultReason.RecognizingSpeech&&i(z=>z?{...z,interimText:B.result.text,isStreaming:!0}:null)},w.recognized=(j,B)=>{var z;if(B.result.reason===_t.ResultReason.RecognizedSpeech){const Z=B.result.text,$=B.result.offset/1e4,U=B.result.duration/1e4;let Y=.9,ee,X;try{const G=JSON.parse(B.result.properties.getProperty(_t.PropertyId.SpeechServiceResponse_JsonResult));if(console.log("Realtime STT Detailed Result:",G),G.NBest&&G.NBest.length>0){const J=G.NBest[0];Y=J.Confidence||.9,J.Words&&(ee=J.Words.map(ne=>({text:ne.Word,offset:ne.Offset/1e4,duration:ne.Duration/1e4,confidence:ne.Confidence||Y})))}X=((z=G.PrimaryLanguage)==null?void 0:z.Language)||G.Locale}catch(G){console.warn("Could not parse detailed result:",G)}if(!X){const G=B.result.properties.getProperty(_t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages);G?(console.log(`Detected language: ${G}`),X=G):v!=="auto"&&(X=v)}const re={text:Z,offset:$,duration:U,confidence:Y,words:ee,locale:X};i(G=>{if(!G)return null;const J=[...G.segments,re],ne=J.map(W=>W.text).join(" ");return{...G,text:ne,segments:J,interimText:""}})}else B.result.reason===_t.ResultReason.NoMatch&&console.warn("No speech could be recognized")},w.canceled=(j,B)=>{B.reason===_t.CancellationReason.Error&&(o(B.errorDetails||"Recognition error occurred"),t("error")),i(z=>z?{...z,isStreaming:!1,isFinal:!0}:null),w.stopContinuousRecognitionAsync()},w.sessionStopped=(j,B)=>{i(z=>z?{...z,isStreaming:!1,isFinal:!0}:null),t("completed"),w.stopContinuousRecognitionAsync()},w.startContinuousRecognitionAsync(()=>{t("streaming")},j=>{o(`Failed to start recognition: ${j}`),t("error")});const T=await y.arrayBuffer(),k=new Uint8Array(T),I=3200;let M=44;const L=()=>{if(M<k.length){const j=k.slice(M,M+I);x.write(j.buffer),M+=I,setTimeout(L,100)}else x.close()};L()}catch(y){o(y.message||"Failed to start recognition"),t("error")}},[r]),h=O.useCallback(()=>{a.current&&a.current.stopContinuousRecognitionAsync(()=>{i(g=>g?{...g,isStreaming:!1,isFinal:!0}:null),t("completed")},g=>{console.error("Error stopping recognition:",g)})},[]),m=O.useCallback(()=>{a.current&&(a.current.close(),a.current=null),l.current&&(l.current.close(),l.current=null),t("idle"),i(null),o("")},[]);return{state:e,transcript:n,error:s,startRecognition:u,stopRecognition:h,reset:m}}const mO={code:"auto",name:"Auto-detect",nativeName:"Auto-detect language"},OP=[{code:"en-US",name:"English",nativeName:"English (United States)",region:"US"},{code:"en-GB",name:"English",nativeName:"English (United Kingdom)",region:"GB"},{code:"en-AU",name:"English",nativeName:"English (Australia)",region:"AU"},{code:"en-CA",name:"English",nativeName:"English (Canada)",region:"CA"},{code:"en-IN",name:"English",nativeName:"English (India)",region:"IN"},{code:"en-IE",name:"English",nativeName:"English (Ireland)",region:"IE"},{code:"en-NZ",name:"English",nativeName:"English (New Zealand)",region:"NZ"},{code:"en-SG",name:"English",nativeName:"English (Singapore)",region:"SG"},{code:"en-ZA",name:"English",nativeName:"English (South Africa)",region:"ZA"},{code:"en-HK",name:"English",nativeName:"English (Hong Kong)",region:"HK"},{code:"en-PH",name:"English",nativeName:"English (Philippines)",region:"PH"},{code:"zh-CN",name:"Chinese",nativeName:" ()",region:"CN"},{code:"zh-HK",name:"Chinese",nativeName:" ()",region:"HK"},{code:"es-ES",name:"Spanish",nativeName:"Espaol (Espaa)",region:"ES"},{code:"es-MX",name:"Spanish",nativeName:"Espaol (Mxico)",region:"MX"},{code:"es-AR",name:"Spanish",nativeName:"Espaol (Argentina)",region:"AR"},{code:"es-CO",name:"Spanish",nativeName:"Espaol (Colombia)",region:"CO"},{code:"es-CL",name:"Spanish",nativeName:"Espaol (Chile)",region:"CL"},{code:"fr-FR",name:"French",nativeName:"Franais (France)",region:"FR"},{code:"fr-CA",name:"French",nativeName:"Franais (Canada)",region:"CA"},{code:"de-DE",name:"German",nativeName:"Deutsch (Deutschland)",region:"DE"},{code:"de-AT",name:"German",nativeName:"Deutsch (sterreich)",region:"AT"},{code:"de-CH",name:"German",nativeName:"Deutsch (Schweiz)",region:"CH"},{code:"ja-JP",name:"Japanese",nativeName:" ()",region:"JP"},{code:"ko-KR",name:"Korean",nativeName:" ()",region:"KR"},{code:"pt-BR",name:"Portuguese",nativeName:"Portugus (Brasil)",region:"BR"},{code:"pt-PT",name:"Portuguese",nativeName:"Portugus (Portugal)",region:"PT"},{code:"it-IT",name:"Italian",nativeName:"Italiano (Italia)",region:"IT"},{code:"ru-RU",name:"Russian",nativeName:" ()",region:"RU"},{code:"ar-SA",name:"Arabic",nativeName:" ()",region:"SA"},{code:"ar-EG",name:"Arabic",nativeName:" ()",region:"EG"},{code:"ar-AE",name:"Arabic",nativeName:" ()",region:"AE"},{code:"hi-IN",name:"Hindi",nativeName:" ()",region:"IN"},{code:"th-TH",name:"Thai",nativeName:" ()",region:"TH"},{code:"tr-TR",name:"Turkish",nativeName:"Trke (Trkiye)",region:"TR"},{code:"pl-PL",name:"Polish",nativeName:"Polski (Polska)",region:"PL"},{code:"nl-NL",name:"Dutch",nativeName:"Nederlands (Nederland)",region:"NL"},{code:"sv-SE",name:"Swedish",nativeName:"Svenska (Sverige)",region:"SE"},{code:"da-DK",name:"Danish",nativeName:"Dansk (Danmark)",region:"DK"},{code:"fi-FI",name:"Finnish",nativeName:"Suomi (Suomi)",region:"FI"},{code:"nb-NO",name:"Norwegian",nativeName:"Norsk Bokml (Norge)",region:"NO"},{code:"cs-CZ",name:"Czech",nativeName:"etina (esk republika)",region:"CZ"},{code:"hu-HU",name:"Hungarian",nativeName:"Magyar (Magyarorszg)",region:"HU"},{code:"ro-RO",name:"Romanian",nativeName:"Romn (Romnia)",region:"RO"},{code:"vi-VN",name:"Vietnamese",nativeName:"Ting Vit (Vit Nam)",region:"VN"},{code:"id-ID",name:"Indonesian",nativeName:"Bahasa Indonesia (Indonesia)",region:"ID"},{code:"ms-MY",name:"Malay",nativeName:"Bahasa Melayu (Malaysia)",region:"MY"},{code:"el-GR",name:"Greek",nativeName:" ()",region:"GR"},{code:"he-IL",name:"Hebrew",nativeName:" ()",region:"IL"},{code:"uk-UA",name:"Ukrainian",nativeName:" ()",region:"UA"},{code:"bg-BG",name:"Bulgarian",nativeName:" ()",region:"BG"},{code:"hr-HR",name:"Croatian",nativeName:"Hrvatski (Hrvatska)",region:"HR"},{code:"sk-SK",name:"Slovak",nativeName:"Slovenina (Slovensko)",region:"SK"},{code:"sl-SI",name:"Slovenian",nativeName:"Slovenina (Slovenija)",region:"SI"},{code:"et-EE",name:"Estonian",nativeName:"Eesti (Eesti)",region:"EE"},{code:"lv-LV",name:"Latvian",nativeName:"Latvieu (Latvija)",region:"LV"},{code:"lt-LT",name:"Lithuanian",nativeName:"Lietuvi (Lietuva)",region:"LT"},{code:"fa-IR",name:"Persian",nativeName:" ()",region:"IR"},{code:"bn-IN",name:"Bengali",nativeName:" ()",region:"IN"},{code:"ta-IN",name:"Tamil",nativeName:" ()",region:"IN"},{code:"te-IN",name:"Telugu",nativeName:" ()",region:"IN"},{code:"mr-IN",name:"Marathi",nativeName:" ()",region:"IN"},{code:"gu-IN",name:"Gujarati",nativeName:" ()",region:"IN"},{code:"kn-IN",name:"Kannada",nativeName:" ()",region:"IN"},{code:"ml-IN",name:"Malayalam",nativeName:" ()",region:"IN"},{code:"af-ZA",name:"Afrikaans",nativeName:"Afrikaans (Suid-Afrika)",region:"ZA"},{code:"fil-PH",name:"Filipino",nativeName:"Filipino (Pilipinas)",region:"PH"},{code:"ca-ES",name:"Catalan",nativeName:"Catal (Espanya)",region:"ES"}],gO=[{code:"af-ZA",name:"Afrikaans",nativeName:"Afrikaans (South Africa)",region:"ZA"},{code:"am-ET",name:"Amharic",nativeName:"Amharic (Ethiopia)",region:"ET"},{code:"ar-AE",name:"Arabic",nativeName:" ()",region:"AE"},{code:"ar-BH",name:"Arabic",nativeName:" ()",region:"BH"},{code:"ar-DZ",name:"Arabic",nativeName:" ()",region:"DZ"},{code:"ar-EG",name:"Arabic",nativeName:" ()",region:"EG"},{code:"ar-IL",name:"Arabic",nativeName:" ()",region:"IL"},{code:"ar-IQ",name:"Arabic",nativeName:" ()",region:"IQ"},{code:"ar-JO",name:"Arabic",nativeName:" ()",region:"JO"},{code:"ar-KW",name:"Arabic",nativeName:" ()",region:"KW"},{code:"ar-LB",name:"Arabic",nativeName:" ()",region:"LB"},{code:"ar-LY",name:"Arabic",nativeName:" ()",region:"LY"},{code:"ar-MA",name:"Arabic",nativeName:" ()",region:"MA"},{code:"ar-OM",name:"Arabic",nativeName:" ()",region:"OM"},{code:"ar-PS",name:"Arabic",nativeName:" ()",region:"PS"},{code:"ar-QA",name:"Arabic",nativeName:" ()",region:"QA"},{code:"ar-SA",name:"Arabic",nativeName:" ()",region:"SA"},{code:"ar-SY",name:"Arabic",nativeName:" ()",region:"SY"},{code:"ar-TN",name:"Arabic",nativeName:" ()",region:"TN"},{code:"ar-YE",name:"Arabic",nativeName:" ()",region:"YE"},{code:"as-IN",name:"Assamese",nativeName:" ()",region:"IN"},{code:"az-AZ",name:"Azerbaijani",nativeName:"Azrbaycan (Azrbaycan)",region:"AZ"},{code:"bg-BG",name:"Bulgarian",nativeName:" ()",region:"BG"},{code:"bn-IN",name:"Bengali",nativeName:" ()",region:"IN"},{code:"bs-BA",name:"Bosnian",nativeName:"Bosanski (Bosna i Hercegovina)",region:"BA"},{code:"ca-ES",name:"Catalan",nativeName:"Catal (Espanya)",region:"ES"},{code:"cs-CZ",name:"Czech",nativeName:"etina (esk republika)",region:"CZ"},{code:"cy-GB",name:"Welsh",nativeName:"Cymraeg (Y Deyrnas Unedig)",region:"GB"},{code:"da-DK",name:"Danish",nativeName:"Dansk (Danmark)",region:"DK"},{code:"de-AT",name:"German",nativeName:"Deutsch (sterreich)",region:"AT"},{code:"de-CH",name:"German",nativeName:"Deutsch (Schweiz)",region:"CH"},{code:"de-DE",name:"German",nativeName:"Deutsch (Deutschland)",region:"DE"},{code:"el-GR",name:"Greek",nativeName:" ()",region:"GR"},{code:"en-AU",name:"English",nativeName:"English (Australia)",region:"AU"},{code:"en-CA",name:"English",nativeName:"English (Canada)",region:"CA"},{code:"en-GB",name:"English",nativeName:"English (United Kingdom)",region:"GB"},{code:"en-GH",name:"English",nativeName:"English (Ghana)",region:"GH"},{code:"en-HK",name:"English",nativeName:"English (Hong Kong SAR)",region:"HK"},{code:"en-IE",name:"English",nativeName:"English (Ireland)",region:"IE"},{code:"en-IN",name:"English",nativeName:"English (India)",region:"IN"},{code:"en-KE",name:"English",nativeName:"English (Kenya)",region:"KE"},{code:"en-NG",name:"English",nativeName:"English (Nigeria)",region:"NG"},{code:"en-NZ",name:"English",nativeName:"English (New Zealand)",region:"NZ"},{code:"en-PH",name:"English",nativeName:"English (Philippines)",region:"PH"},{code:"en-SG",name:"English",nativeName:"English (Singapore)",region:"SG"},{code:"en-TZ",name:"English",nativeName:"English (Tanzania)",region:"TZ"},{code:"en-US",name:"English",nativeName:"English (United States)",region:"US"},{code:"en-ZA",name:"English",nativeName:"English (South Africa)",region:"ZA"},{code:"es-AR",name:"Spanish",nativeName:"Espaol (Argentina)",region:"AR"},{code:"es-BO",name:"Spanish",nativeName:"Espaol (Bolivia)",region:"BO"},{code:"es-CL",name:"Spanish",nativeName:"Espaol (Chile)",region:"CL"},{code:"es-CO",name:"Spanish",nativeName:"Espaol (Colombia)",region:"CO"},{code:"es-CR",name:"Spanish",nativeName:"Espaol (Costa Rica)",region:"CR"},{code:"es-CU",name:"Spanish",nativeName:"Espaol (Cuba)",region:"CU"},{code:"es-DO",name:"Spanish",nativeName:"Espaol (Repblica Dominicana)",region:"DO"},{code:"es-EC",name:"Spanish",nativeName:"Espaol (Ecuador)",region:"EC"},{code:"es-ES",name:"Spanish",nativeName:"Espaol (Espaa)",region:"ES"},{code:"es-GQ",name:"Spanish",nativeName:"Espaol (Guinea Ecuatorial)",region:"GQ"},{code:"es-GT",name:"Spanish",nativeName:"Espaol (Guatemala)",region:"GT"},{code:"es-HN",name:"Spanish",nativeName:"Espaol (Honduras)",region:"HN"},{code:"es-MX",name:"Spanish",nativeName:"Espaol (Mxico)",region:"MX"},{code:"es-NI",name:"Spanish",nativeName:"Espaol (Nicaragua)",region:"NI"},{code:"es-PA",name:"Spanish",nativeName:"Espaol (Panam)",region:"PA"},{code:"es-PE",name:"Spanish",nativeName:"Espaol (Per)",region:"PE"},{code:"es-PR",name:"Spanish",nativeName:"Espaol (Puerto Rico)",region:"PR"},{code:"es-PY",name:"Spanish",nativeName:"Espaol (Paraguay)",region:"PY"},{code:"es-SV",name:"Spanish",nativeName:"Espaol (El Salvador)",region:"SV"},{code:"es-US",name:"Spanish",nativeName:"Espaol (Estados Unidos)",region:"US"},{code:"es-UY",name:"Spanish",nativeName:"Espaol (Uruguay)",region:"UY"},{code:"es-VE",name:"Spanish",nativeName:"Espaol (Venezuela)",region:"VE"},{code:"et-EE",name:"Estonian",nativeName:"Eesti (Eesti)",region:"EE"},{code:"eu-ES",name:"Basque",nativeName:"Euskara (Espainia)",region:"ES"},{code:"fa-IR",name:"Persian",nativeName:" ()",region:"IR"},{code:"fi-FI",name:"Finnish",nativeName:"Suomi (Suomi)",region:"FI"},{code:"fil-PH",name:"Filipino",nativeName:"Filipino (Pilipinas)",region:"PH"},{code:"fr-BE",name:"French",nativeName:"Franais (Belgique)",region:"BE"},{code:"fr-CA",name:"French",nativeName:"Franais (Canada)",region:"CA"},{code:"fr-CH",name:"French",nativeName:"Franais (Suisse)",region:"CH"},{code:"fr-FR",name:"French",nativeName:"Franais (France)",region:"FR"},{code:"ga-IE",name:"Irish",nativeName:"Gaeilge (ire)",region:"IE"},{code:"gl-ES",name:"Galician",nativeName:"Galego (Espaa)",region:"ES"},{code:"gu-IN",name:"Gujarati",nativeName:" ()",region:"IN"},{code:"he-IL",name:"Hebrew",nativeName:" ()",region:"IL"},{code:"hi-IN",name:"Hindi",nativeName:" ()",region:"IN"},{code:"hr-HR",name:"Croatian",nativeName:"Hrvatski (Hrvatska)",region:"HR"},{code:"hu-HU",name:"Hungarian",nativeName:"Magyar (Magyarorszg)",region:"HU"},{code:"hy-AM",name:"Armenian",nativeName:" ()",region:"AM"},{code:"id-ID",name:"Indonesian",nativeName:"Bahasa Indonesia (Indonesia)",region:"ID"},{code:"is-IS",name:"Icelandic",nativeName:"slenska (sland)",region:"IS"},{code:"it-CH",name:"Italian",nativeName:"Italiano (Svizzera)",region:"CH"},{code:"it-IT",name:"Italian",nativeName:"Italiano (Italia)",region:"IT"},{code:"ja-JP",name:"Japanese",nativeName:" ()",region:"JP"},{code:"jv-ID",name:"Javanese",nativeName:"Jawa (Indonesia)",region:"ID"},{code:"ka-GE",name:"Georgian",nativeName:" ()",region:"GE"},{code:"kk-KZ",name:"Kazakh",nativeName:" ()",region:"KZ"},{code:"km-KH",name:"Khmer",nativeName:" ()",region:"KH"},{code:"kn-IN",name:"Kannada",nativeName:" ()",region:"IN"},{code:"ko-KR",name:"Korean",nativeName:" ()",region:"KR"},{code:"lo-LA",name:"Lao",nativeName:" ()",region:"LA"},{code:"lt-LT",name:"Lithuanian",nativeName:"Lietuvi (Lietuva)",region:"LT"},{code:"lv-LV",name:"Latvian",nativeName:"Latvieu (Latvija)",region:"LV"},{code:"mk-MK",name:"Macedonian",nativeName:" ( )",region:"MK"},{code:"ml-IN",name:"Malayalam",nativeName:" ()",region:"IN"},{code:"mn-MN",name:"Mongolian",nativeName:" ()",region:"MN"},{code:"mr-IN",name:"Marathi",nativeName:" ()",region:"IN"},{code:"ms-MY",name:"Malay",nativeName:"Bahasa Melayu (Malaysia)",region:"MY"},{code:"mt-MT",name:"Maltese",nativeName:"Malti (Malta)",region:"MT"},{code:"my-MM",name:"Burmese",nativeName:" ()",region:"MM"},{code:"nb-NO",name:"Norwegian Bokml",nativeName:"Norsk Bokml (Norge)",region:"NO"},{code:"ne-NP",name:"Nepali",nativeName:" ()",region:"NP"},{code:"nl-BE",name:"Dutch",nativeName:"Nederlands (Belgi)",region:"BE"},{code:"nl-NL",name:"Dutch",nativeName:"Nederlands (Nederland)",region:"NL"},{code:"or-IN",name:"Odia",nativeName:" ()",region:"IN"},{code:"pa-IN",name:"Punjabi",nativeName:" ()",region:"IN"},{code:"pl-PL",name:"Polish",nativeName:"Polski (Polska)",region:"PL"},{code:"ps-AF",name:"Pashto",nativeName:" ()",region:"AF"},{code:"pt-BR",name:"Portuguese",nativeName:"Portugus (Brasil)",region:"BR"},{code:"pt-PT",name:"Portuguese",nativeName:"Portugus (Portugal)",region:"PT"},{code:"ro-RO",name:"Romanian",nativeName:"Romn (Romnia)",region:"RO"},{code:"ru-RU",name:"Russian",nativeName:" ()",region:"RU"},{code:"si-LK",name:"Sinhala",nativeName:" ( )",region:"LK"},{code:"sk-SK",name:"Slovak",nativeName:"Slovenina (Slovensko)",region:"SK"},{code:"sl-SI",name:"Slovenian",nativeName:"Slovenina (Slovenija)",region:"SI"},{code:"so-SO",name:"Somali",nativeName:"Soomaali (Soomaaliya)",region:"SO"},{code:"sq-AL",name:"Albanian",nativeName:"Shqip (Shqipri)",region:"AL"},{code:"sr-RS",name:"Serbian",nativeName:" ()",region:"RS"},{code:"sv-SE",name:"Swedish",nativeName:"Svenska (Sverige)",region:"SE"},{code:"sw-KE",name:"Swahili",nativeName:"Kiswahili (Kenya)",region:"KE"},{code:"sw-TZ",name:"Swahili",nativeName:"Kiswahili (Tanzania)",region:"TZ"},{code:"ta-IN",name:"Tamil",nativeName:" ()",region:"IN"},{code:"te-IN",name:"Telugu",nativeName:" ()",region:"IN"},{code:"th-TH",name:"Thai",nativeName:" ()",region:"TH"},{code:"tr-TR",name:"Turkish",nativeName:"Trke (Trkiye)",region:"TR"},{code:"uk-UA",name:"Ukrainian",nativeName:" ()",region:"UA"},{code:"ur-IN",name:"Urdu",nativeName:" ()",region:"IN"},{code:"uz-UZ",name:"Uzbek",nativeName:"Ozbek (Ozbekiston)",region:"UZ"},{code:"vi-VN",name:"Vietnamese",nativeName:"Ting Vit (Vit Nam)",region:"VN"},{code:"wuu-CN",name:"Chinese (Wu)",nativeName:" ()",region:"CN"},{code:"yue-CN",name:"Chinese (Cantonese)",nativeName:" ()",region:"CN"},{code:"zh-CN",name:"Chinese (Mandarin)",nativeName:" ()",region:"CN"},{code:"zh-CN-shandong",name:"Chinese (Jilu Mandarin)",nativeName:" ()",region:"CN"},{code:"zh-CN-sichuan",name:"Chinese (Southwestern Mandarin)",nativeName:" ()",region:"CN"},{code:"zh-HK",name:"Chinese (Cantonese)",nativeName:" ()",region:"HK"},{code:"zh-TW",name:"Chinese (Taiwanese Mandarin)",nativeName:" ()",region:"TW"},{code:"zu-ZA",name:"Zulu",nativeName:"isiZulu (South Africa)",region:"ZA"}];function OF(r){return[mO,...r==="fast-transcription"?OP:gO]}function DF(r){const[e,t]=O.useState("idle"),[n,i]=O.useState(null),[s,o]=O.useState(""),[a,l]=O.useState(0),u=O.useCallback(async(m,g,v)=>{try{if(t("processing"),o(""),l(0),m.size>25*1024*1024)throw new Error("Audio file must be less than 25 MB for Fast Transcription API");l(10);const y=await cA(m);l(30);let A;g==="auto"?(A=OP.map(M=>M.code),console.log("Auto-detect enabled, using all Fast Transcription locales:",A.length)):A=[g];const x={locales:A};v!=null&&v.enableDiarization&&(x.diarization={enabled:!0,maxSpeakers:v.maxSpeakers||2});const b=`https://${r.region}.api.cognitive.microsoft.com/speechtotext/transcriptions:transcribe?api-version=2024-11-15`;l(50);const w=new FormData;w.append("audio",y,"audio.wav"),w.append("definition",JSON.stringify(x)),console.log("Fast Transcription API Request:",x);const T=await fetch(b,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":r.apiKey},body:w});if(l(70),!T.ok){const M=await T.text();throw new Error(`API request failed (${T.status}): ${M}`)}const k=await T.json();l(90);const I=jF(k,g);i(I),l(100),t("completed")}catch(y){o(y.message||"Transcription failed"),t("error"),l(0)}},[r]),h=O.useCallback(()=>{t("idle"),i(null),o(""),l(0)},[]);return{state:e,transcript:n,error:s,progress:a,transcribe:u,reset:h}}function jF(r,e){console.log("Fast Transcription API Response:",r);let t="",n=[];r.combinedPhrases&&r.combinedPhrases.length>0?t=r.combinedPhrases[0].text||"":r.combinedRecognizedPhrases&&r.combinedRecognizedPhrases.length>0&&(t=r.combinedRecognizedPhrases[0].display||""),r.phrases&&Array.isArray(r.phrases)?n=r.phrases.map(s=>{var v,y,A,x,b;const o=s.offsetMilliseconds??I0(s.offset||s.offsetInTicks||0),a=s.durationMilliseconds??I0(s.duration||s.durationInTicks||0),l=s.confidence||((y=(v=s.nBest)==null?void 0:v[0])==null?void 0:y.confidence)||.9,u=s.text||((x=(A=s.nBest)==null?void 0:A[0])==null?void 0:x.display)||"",h=(b=s.words)==null?void 0:b.map(w=>({text:w.text||w.word,offset:w.offsetMilliseconds??I0(w.offset||w.offsetInTicks||0),duration:w.durationMilliseconds??I0(w.duration||w.durationInTicks||0),confidence:w.confidence||l})),m=s.speaker,g=s.locale;return{text:u,offset:o,duration:a,confidence:l,words:h,speaker:m,locale:g}}).filter(s=>s.text):r.recognizedPhrases&&Array.isArray(r.recognizedPhrases)&&(n=r.recognizedPhrases.map(s=>{var m,g;const o=(m=s.nBest)==null?void 0:m[0];if(!o)return null;const a=zg(s.offset||"PT0S"),l=zg(s.duration||"PT0S"),u=o.confidence||.9,h=(g=o.words)==null?void 0:g.map(v=>({text:v.word,offset:zg(v.offset),duration:zg(v.duration),confidence:v.confidence||u}));return{text:o.display,offset:a,duration:l,confidence:u,words:h}}).filter(Boolean));const i=n.length>0?Math.max(...n.map(s=>s.offset+s.duration)):0;return{fullText:t,segments:n,language:e,duration:i}}function I0(r){return typeof r=="number"?r/1e4:typeof r=="string"?zg(r):0}function zg(r){const e=r.match(/PT(?:(\d+(?:\.\d+)?)H)?(?:(\d+(?:\.\d+)?)M)?(?:(\d+(?:\.\d+)?)S)?/);if(!e)return 0;const t=parseFloat(e[1]||"0"),n=parseFloat(e[2]||"0"),i=parseFloat(e[3]||"0");return(t*3600+n*60+i)*1e3}function BF(r){const[e,t]=O.useState("idle"),[n,i]=O.useState(null),[s,o]=O.useState(""),[a,l]=O.useState(""),[u,h]=O.useState(""),m=O.useRef(null),g=O.useCallback(async(A,x)=>{var b;try{throw t("processing"),o(""),l(""),h("Preparing audio..."),m.current=new AbortController,A.size>10*1024*1024?new Error("Audio file must be less than 10 MB for Whisper API (data URL limitation)"):new Error("Whisper API requires publicly accessible audio URLs. Data URLs are not supported. Please use Azure Blob Storage or a public URL.")}catch(w){w.name==="AbortError"?(o("Transcription cancelled"),h("Cancelled")):(o(w.message||"Transcription failed"),h("Failed")),t("error")}},[r]),v=O.useCallback(()=>{m.current&&m.current.abort()},[]),y=O.useCallback(()=>{v(),t("idle"),i(null),o(""),l(""),h("")},[v]);return{state:e,transcript:n,error:s,jobId:a,pollingStatus:u,transcribe:g,cancelJob:v,reset:y}}function zF(r){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=t,n.readAsDataURL(r)})}async function FF(r,e,t,n){const i=`https://${r.region}.api.cognitive.microsoft.com/speechtotext/models/base?api-version=2024-11-15`,s=await fetch(i,{headers:{"Ocp-Apim-Subscription-Key":r.apiKey},signal:n});if(!s.ok)throw new Error(`Failed to get Whisper model (${s.status})`);const a=(await s.json()).self,l=`https://${r.region}.api.cognitive.microsoft.com/speechtotext/transcriptions:submit?api-version=2024-11-15`,u=await fetch(l,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":r.apiKey,"Content-Type":"application/json"},body:JSON.stringify({contentUrls:[e],locale:t,displayName:`Whisper Transcription ${Date.now()}`,model:{self:a},properties:{wordLevelTimestampsEnabled:!0}}),signal:n});if(!u.ok){const m=await u.text();throw console.error("Whisper API Error:",m),console.error("Request body:",JSON.stringify({contentUrls:[e.substring(0,100)+"..."],locale:t,displayName:`Whisper Transcription ${Date.now()}`,model:{self:a},properties:{wordLevelTimestampsEnabled:!0}},null,2)),new Error(`Failed to create transcription job (${u.status}): ${m}`)}return(await u.json()).self}async function WF(r,e,t,n){let s=0,o=2e3;const a=5e3;for(;s<150;){const l=await fetch(e,{headers:{"Ocp-Apim-Subscription-Key":r.apiKey},signal:n});if(!l.ok)throw new Error(`Failed to poll job status (${l.status})`);const u=await l.json();if(t(`Status: ${u.status}${u.status==="Running"?` (${s*o/1e3}s elapsed)`:""}`),u.status==="Succeeded"||u.status==="Failed")return u;await $F(o),s>15&&(o=a),s++}throw new Error("Transcription timeout after 5 minutes")}async function UF(r,e,t,n,i){var h;const s=await fetch(`${e}/files`,{headers:{"Ocp-Apim-Subscription-Key":r.apiKey},signal:i});if(!s.ok)throw new Error(`Failed to get transcription files (${s.status})`);const a=(h=(await s.json()).values)==null?void 0:h.find(m=>m.kind==="Transcription");if(!a)throw new Error("Transcription file not found");const l=await fetch(a.links.contentUrl,{signal:i});if(!l.ok)throw new Error(`Failed to download transcription (${l.status})`);const u=await l.json();return ZF(u,t,n)}function ZF(r,e,t){var a;const i=((a=(r.combinedRecognizedPhrases||[])[0])==null?void 0:a.display)||"",s=(r.recognizedPhrases||[]).map(l=>{var A,x;const u=(A=l.nBest)==null?void 0:A[0];if(!u)return null;const h=k0(l.offset||"PT0S"),m=k0(l.duration||"PT0S"),g=u.confidence||.95,v=(x=u.words)==null?void 0:x.map(b=>({text:b.word,offset:k0(b.offset),duration:k0(b.duration),confidence:b.confidence||g})),y=l.locale||t;return{text:u.display,offset:h,duration:m,confidence:g,words:v,locale:y}}).filter(Boolean),o=s.length>0?Math.max(...s.map(l=>l.offset+l.duration)):0;return{fullText:i,segments:s,language:t,duration:o,jobId:e}}function k0(r){const e=r.match(/PT(?:(\d+(?:\.\d+)?)H)?(?:(\d+(?:\.\d+)?)M)?(?:(\d+(?:\.\d+)?)S)?/);if(!e)return 0;const t=parseFloat(e[1]||"0"),n=parseFloat(e[2]||"0"),i=parseFloat(e[3]||"0");return(t*3600+n*60+i)*1e3}function $F(r){return new Promise(e=>setTimeout(e,r))}const vO=[{code:"en-US",name:"English",nativeName:"English (United States)"},{code:"zh-CN",name:"Chinese",nativeName:" ()"},{code:"de-DE",name:"German",nativeName:"Deutsch (Deutschland)"},{code:"fr-FR",name:"French",nativeName:"Franais (France)"},{code:"it-IT",name:"Italian",nativeName:"Italiano (Italia)"},{code:"ja-JP",name:"Japanese",nativeName:" ()"},{code:"es-ES",name:"Spanish",nativeName:"Espaol (Espaa)"},{code:"pt-BR",name:"Portuguese",nativeName:"Portugus (Brasil)"},{code:"ko-KR",name:"Korean",nativeName:" ()"}];function HF(r){const[e,t]=O.useState("idle"),[n,i]=O.useState(null),[s,o]=O.useState(""),[a,l]=O.useState(0),u=O.useCallback(async(m,g,v={})=>{try{if(t("processing"),o(""),l(0),m.size>300*1024*1024)throw new Error("Audio file must be less than 300 MB for LLM Speech API");l(10);const y=await cA(m);l(30);const A=g.split("-")[0],x={enhancedMode:{enabled:!0,task:v.task||"transcribe"}};if(v.task==="translate"&&v.targetLanguage){const M=v.targetLanguage.split("-")[0];x.enhancedMode.targetLanguage=M}v.prompt&&v.prompt.length>0&&(x.enhancedMode.prompt=v.prompt),v.enableDiarization&&(x.diarization={enabled:!0,maxSpeakers:v.maxSpeakers||2});const b=`https://${r.region}.api.cognitive.microsoft.com/speechtotext/transcriptions:transcribe?api-version=2025-10-15`;l(50);const w=new FormData;w.append("audio",y,"audio.wav"),w.append("definition",JSON.stringify(x)),console.log("LLM Speech API Request:",x);const T=await fetch(b,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":r.apiKey},body:w});if(l(70),!T.ok){const M=await T.text();throw new Error(`API request failed (${T.status}): ${M}`)}const k=await T.json();l(90),console.log("LLM Speech API Response:",k);const I=VF(k,g);i(I),l(100),t("completed")}catch(y){o(y.message||"Transcription failed"),t("error"),l(0)}},[r]),h=O.useCallback(()=>{t("idle"),i(null),o(""),l(0)},[]);return{state:e,transcript:n,error:s,progress:a,transcribe:u,reset:h}}function VF(r,e){let t="",n=[];r.combinedPhrases&&r.combinedPhrases.length>0&&(t=r.combinedPhrases[0].text||""),r.phrases&&Array.isArray(r.phrases)&&(n=r.phrases.map(s=>{var v;const o=s.offsetMilliseconds??M0(s.offset||s.offsetInTicks||0),a=s.durationMilliseconds??M0(s.duration||s.durationInTicks||0),l=s.confidence||0,u=s.text||"",h=(v=s.words)==null?void 0:v.map(y=>({text:y.text||y.word,offset:y.offsetMilliseconds??M0(y.offset||y.offsetInTicks||0),duration:y.durationMilliseconds??M0(y.duration||y.durationInTicks||0),confidence:y.confidence||l})),m=s.speaker,g=s.locale;return{text:u,offset:o,duration:a,confidence:l,words:h,speaker:m,locale:g}}).filter(s=>s.text));const i=n.length>0?Math.max(...n.map(s=>s.offset+s.duration)):0;return{fullText:t,segments:n,language:e,duration:i}}function M0(r){return typeof r=="number"?r/1e4:typeof r=="string"?qF(r):0}function qF(r){const e=r.match(/PT(?:(\d+(?:\.\d+)?)H)?(?:(\d+(?:\.\d+)?)M)?(?:(\d+(?:\.\d+)?)S)?/);if(!e)return 0;const t=parseFloat(e[1]||"0"),n=parseFloat(e[2]||"0"),i=parseFloat(e[3]||"0");return(t*3600+n*60+i)*1e3}const GF=["australiaeast","centralindia","eastus","eastus2","northeurope","southcentralus","southeastasia","swedencentral","westeurope"],KF=["centralindia","eastus","northeurope","southeastasia","westus"],D2=[{id:"realtime",name:"Azure Realtime ASR",description:"WebSocket streaming, low-latency recognition",icon:"",useCases:"Live transcription, real-time captions",features:["Streaming results","Word-level timestamps","Low latency","Any file size",`${gO.length} locales`]},{id:"fast-transcription",name:"Azure Fast Transcription",description:"REST API optimized for speed",icon:"",useCases:"Quick audio file transcription",features:["Fast processing","Batch transcription","Max 25 MB",`${OP.length} locales`]},{id:"llm-speech",name:"LLM Speech (Preview)",description:"LLM-enhanced with deep contextual understanding",icon:"",useCases:"High-accuracy transcription & translation",features:["LLM-enhanced","Prompt tuning","Translation","Diarization",`${vO.length} locales`]}];function YF(r,e){const t=e.toLowerCase();switch(r){case"realtime":return!0;case"fast-transcription":return GF.includes(t);case"llm-speech":return KF.includes(t);case"whisper":return!0;default:return!0}}function XF({selectedModel:r,onModelChange:e,region:t=""}){const[n,i]=O.useState(!1),s=O.useMemo(()=>D2.find(a=>a.id===r),[r]),o=a=>{e(a),i(!1)};return f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Recognition Model"}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>i(!n),className:"w-full px-4 py-2.5 bg-white border border-gray-300 rounded-lg text-left flex items-center justify-between hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-xl",children:s==null?void 0:s.icon}),f.jsx("span",{className:"text-gray-900",children:(s==null?void 0:s.name)||"Select model"})]}),f.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&f.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg max-h-80 overflow-y-auto",children:D2.map(a=>{const l=YF(a.id,t);return f.jsx("button",{onClick:()=>l&&o(a.id),disabled:!l,className:`
                    w-full px-4 py-3 text-left transition-colors
                    ${l?r===a.id?"bg-blue-50":"hover:bg-gray-50":"bg-gray-50 opacity-60 cursor-not-allowed"}
                  `,children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:`text-xl ${l?"":"opacity-50"}`,children:a.icon}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:`font-medium ${l?"text-gray-900":"text-gray-500"}`,children:a.name}),!l&&f.jsx("span",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:"Not in region"})]}),f.jsx("p",{className:`text-xs ${l?"text-gray-500":"text-gray-400"}`,children:a.description})]})]}),r===a.id&&l&&f.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},a.id)})}),n&&f.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>i(!1)})]}),s&&f.jsx("div",{className:"p-4 rounded-lg border-2 border-blue-500 bg-blue-50",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx("span",{className:"text-2xl flex-shrink-0",children:s.icon}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),f.jsx("svg",{className:"w-4 h-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),f.jsx("p",{className:"text-sm mt-1 text-gray-600",children:s.description}),f.jsx("p",{className:"text-xs mt-1 text-gray-500",children:s.useCases}),f.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:s.features.map((a,l)=>f.jsx("span",{className:"inline-block px-2 py-0.5 text-xs rounded bg-white text-gray-700",children:a},l))})]})]})})]})}const JF=vO.map(r=>({code:r.code,name:r.name,nativeName:r.nativeName}));function QF({selectedLanguage:r,onLanguageChange:e,selectedModel:t}){const[n,i]=O.useState(""),[s,o]=O.useState(!1),a=O.useMemo(()=>t==="llm-speech"?[mO,...JF]:OF(t==="fast-transcription"?"fast-transcription":"realtime"),[t]),l=O.useMemo(()=>{if(!n.trim())return a;const m=n.toLowerCase();return a.filter(g=>g.name.toLowerCase().includes(m)||g.nativeName.toLowerCase().includes(m)||g.code.toLowerCase().includes(m))},[n,a]),u=O.useMemo(()=>a.find(m=>m.code===r),[r,a]),h=m=>{e(m),o(!1),i("")};return f.jsxs("div",{className:"relative",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recognition Language"}),f.jsxs("button",{onClick:()=>o(!s),className:"w-full px-4 py-2.5 bg-white border border-gray-300 rounded-lg text-left flex items-center justify-between hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[(u==null?void 0:u.code)==="auto"?f.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}):f.jsx("span",{className:"text-sm text-gray-500 font-mono",children:u==null?void 0:u.code}),f.jsx("span",{className:"text-gray-900",children:(u==null?void 0:u.nativeName)||"Select language"})]}),f.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform ${s?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&f.jsxs("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg max-h-80 overflow-hidden",children:[f.jsx("div",{className:"p-2 border-b border-gray-200",children:f.jsx("input",{type:"text",value:n,onChange:m=>i(m.target.value),placeholder:"Search languages...",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})}),f.jsx("div",{className:"overflow-y-auto max-h-64",children:l.length>0?l.map(m=>f.jsx("button",{onClick:()=>h(m.code),className:`
                    w-full px-4 py-2.5 text-left hover:bg-gray-50 transition-colors
                    ${r===m.code?"bg-blue-50":""}
                  `,children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[m.code==="auto"?f.jsx("svg",{className:"w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}):f.jsx("span",{className:"text-xs text-gray-500 font-mono w-16",children:m.code}),f.jsx("span",{className:"text-sm text-gray-900",children:m.nativeName})]}),m.code!=="auto"&&m.name!==m.nativeName&&f.jsx("div",{className:"text-xs text-gray-500 ml-[72px]",children:m.name})]}),r===m.code&&f.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},m.code)):f.jsx("div",{className:"px-4 py-8 text-center text-gray-500 text-sm",children:"No languages found"})})]}),s&&f.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>o(!1)})]})}function e6({segments:r,fullText:e,interimText:t,isStreaming:n,showTimestamps:i=!0,showConfidence:s=!0,audioSource:o,detectedLanguage:a}){const l=O.useRef(null),[u,h]=O.useState(null),[m,g]=O.useState(null),v=O.useRef(null);o_.useEffect(()=>{if(v.current&&(v.current(),v.current=null),l.current&&(l.current.pause(),h(null)),o){const T=URL.createObjectURL(o);return g(T),()=>{URL.revokeObjectURL(T),v.current&&(v.current(),v.current=null)}}else g(null)},[o]);const y=async(T,k)=>{if(!l.current||!m){console.log("No audio ref or URL available");return}const I=l.current;if(u===k){console.log("Stopping currently playing segment:",k),I.pause(),h(null),v.current&&(v.current(),v.current=null);return}const M=T.offset/1e3,L=(T.offset+T.duration)/1e3;console.log("Playing segment:",k,"from",M,"to",L),v.current&&(v.current(),v.current=null);try{I.pause()}catch{}h(null);try{I.src=m,I.readyState<2&&(console.log("Waiting for audio to load..."),await new Promise((Z,$)=>{const U=setTimeout(()=>$(new Error("Timeout loading audio")),5e3),Y=()=>{clearTimeout(U),Z(!0)};I.addEventListener("loadeddata",Y,{once:!0}),I.addEventListener("error",ee=>{clearTimeout(U),$(ee)},{once:!0})})),console.log("Setting currentTime to",M),I.currentTime=M,console.log("Playing audio...");const j=I.play();j!==void 0&&(await j,console.log("Audio playing successfully")),h(k);const B=()=>{I.currentTime>=L&&(console.log("Reached end of segment, stopping"),I.pause(),h(null))},z=()=>{console.log("Audio paused or ended"),h(null)};I.addEventListener("timeupdate",B),I.addEventListener("pause",z),I.addEventListener("ended",z),v.current=()=>{I.removeEventListener("timeupdate",B),I.removeEventListener("pause",z),I.removeEventListener("ended",z)}}catch(j){console.error("Error playing audio segment:",j),h(null)}},A=T=>{const k=Math.floor(T/1e3),I=Math.floor(k/60),M=Math.floor(I/60);return M>0?`${M}:${String(I%60).padStart(2,"0")}:${String(k%60).padStart(2,"0")}`:`${I}:${String(k%60).padStart(2,"0")}`},x=T=>T>=.9?"text-green-600":T>=.7?"text-yellow-600":"text-red-600",b=T=>T>=.9?"High":T>=.7?"Medium":"Low",w=r.length>0||t;return f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Transcript"}),a&&f.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:a})]}),n&&f.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[f.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse"}),f.jsx("span",{children:"Streaming..."})]})]}),f.jsx("div",{className:"bg-white border border-gray-300 rounded-lg min-h-[200px] max-h-[400px] overflow-y-auto p-4",children:w?f.jsxs("div",{className:"space-y-4",children:[r.map((T,k)=>f.jsxs("div",{onClick:()=>o&&y(T,k),className:`border-l-2 pl-3 transition-all ${u===k?"border-green-500 bg-green-50":"border-blue-500"} ${o?"cursor-pointer hover:bg-blue-50":""}`,title:o?"Click to play this segment":"",children:[i&&f.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[T.speaker!==void 0&&f.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800",children:["Speaker ",T.speaker]}),T.locale&&f.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:T.locale}),f.jsx("span",{className:"text-xs text-gray-500 font-mono",children:A(T.offset)}),s&&f.jsxs("span",{className:`text-xs font-medium ${x(T.confidence)}`,children:[b(T.confidence)," (",Math.round(T.confidence*100),"%)"]}),o&&f.jsx("span",{className:"text-xs text-gray-400",children:u===k?f.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):f.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})]}),f.jsx("p",{className:"text-gray-900 leading-relaxed",children:T.text}),T.words&&T.words.length>0&&f.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:T.words.map((I,M)=>f.jsx("span",{className:"inline-block px-1.5 py-0.5 bg-gray-50 text-gray-700 text-xs rounded border border-gray-200 hover:bg-gray-100 transition-colors cursor-default",title:`${A(I.offset)} - ${b(I.confidence)}`,children:I.text},M))})]},k)),t&&f.jsxs("div",{className:"border-l-2 border-gray-300 pl-3",children:[f.jsx("div",{className:"flex items-center gap-2 mb-1",children:f.jsx("span",{className:"text-xs text-gray-400 italic",children:"Recognizing..."})}),f.jsx("p",{className:"text-gray-500 italic leading-relaxed",children:t})]})]}):f.jsxs("div",{className:"flex flex-col items-center justify-center h-[180px] text-gray-400",children:[f.jsx("svg",{className:"w-12 h-12 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),f.jsx("p",{className:"text-sm",children:"No transcript yet"}),f.jsx("p",{className:"text-xs mt-1",children:"Upload or record audio to begin transcription"})]})}),r.length>0&&f.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-600",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})}),f.jsxs("span",{children:[r.length," segment",r.length!==1?"s":""]})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})}),f.jsxs("span",{children:[e.split(" ").length," word",e.split(" ").length!==1?"s":""]})]}),r.length>0&&r[r.length-1].offset&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),f.jsxs("span",{children:["Duration: ",A(r[r.length-1].offset+r[r.length-1].duration)]})]})]}),f.jsx("audio",{ref:l,className:"hidden"})]})}function t6(r){return r.map(e=>e.text).join(" ")}function r6(r){return r.map((e,t)=>{const n=j2(e.offset),i=j2(e.offset+e.duration);return`${t+1}
${n} --> ${i}
${e.text}
`}).join(`
`)}function n6(r){const e=`WEBVTT

`,t=r.map((n,i)=>{const s=B2(n.offset),o=B2(n.offset+n.duration);return`${i+1}
${s} --> ${o}
${n.text}
`}).join(`
`);return e+t}function j2(r){const e=Math.floor(r/36e5),t=Math.floor(r%36e5/6e4),n=Math.floor(r%6e4/1e3),i=r%1e3;return`${Al(e,2)}:${Al(t,2)}:${Al(n,2)},${Al(i,3)}`}function B2(r){const e=Math.floor(r/36e5),t=Math.floor(r%36e5/6e4),n=Math.floor(r%6e4/1e3),i=r%1e3;return`${Al(e,2)}:${Al(t,2)}:${Al(n,2)}.${Al(i,3)}`}function Al(r,e){return r.toString().padStart(e,"0")}function i6(r,e,t){const n={txt:"text/plain",srt:"text/srt",vtt:"text/vtt"},i=new Blob([r],{type:n[t]}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=`${e}.${t}`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}function s6(r,e,t){let n;switch(t){case"txt":n=t6(r);break;case"srt":n=r6(r);break;case"vtt":n=n6(r);break;default:throw new Error(`Unsupported export format: ${t}`)}i6(n,e,t)}function o6({segments:r,filename:e="transcript",disabled:t=!1}){const n=s=>{r.length!==0&&s6(r,e,s)},i=r.length>0;return f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Export Transcript"}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsx("button",{onClick:()=>n("txt"),disabled:t||!i,className:"flex-1 min-w-[100px] px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),f.jsx("span",{children:"TXT"})]})}),f.jsx("button",{onClick:()=>n("srt"),disabled:t||!i,className:"flex-1 min-w-[100px] px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"})}),f.jsx("span",{children:"SRT"})]})}),f.jsx("button",{onClick:()=>n("vtt"),disabled:t||!i,className:"flex-1 min-w-[100px] px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),f.jsx("span",{children:"VTT"})]})})]}),!i&&!t&&f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Transcribe audio to enable export"})]})}const a6=["audio/wav","audio/wave","audio/x-wav","audio/mp3","audio/mpeg","audio/ogg","audio/flac","audio/x-flac","audio/webm","video/mp4","video/webm","video/x-m4v","video/quicktime","video/x-msvideo"],l6=100*1024*1024;function SO({file:r,onFileChange:e,disabled:t}){const n=O.useRef(null),i=O.useRef(null),s=O.useRef(null),[o,a]=O.useState(!1),[l,u]=O.useState(""),[h,m]=O.useState(!1);O.useEffect(()=>(r?(s.current&&URL.revokeObjectURL(s.current),s.current=URL.createObjectURL(r)):(s.current&&(URL.revokeObjectURL(s.current),s.current=null),i.current&&(i.current.pause(),i.current=null),m(!1)),()=>{s.current&&URL.revokeObjectURL(s.current)}),[r]);const g=O.useCallback(L=>{L.stopPropagation(),!(!s.current||!r)&&(i.current||(i.current=new Audio(s.current),i.current.addEventListener("ended",()=>{m(!1)})),h?(i.current.pause(),m(!1)):(i.current.play(),m(!0)))},[h,r]),v=O.useCallback(L=>!a6.includes(L.type)&&!L.name.match(/\.(wav|mp3|ogg|flac|webm|mp4|m4v|mov|avi)$/i)?"Unsupported file format. Please use WAV, MP3, OGG, FLAC, WebM, MP4, MOV, or AVI.":L.size>l6?`File size must be less than 100 MB. Your file is ${(L.size/(1024*1024)).toFixed(1)} MB.`:null,[]),y=O.useCallback(L=>{const j=v(L);if(j){u(j),e(null);return}u(""),e(L)},[v,e]),A=O.useCallback(L=>{L.preventDefault(),L.stopPropagation(),a(!0)},[]),x=O.useCallback(L=>{L.preventDefault(),L.stopPropagation(),a(!1)},[]),b=O.useCallback(L=>{if(L.preventDefault(),L.stopPropagation(),a(!1),t)return;const j=L.dataTransfer.files;j.length>0&&y(j[0])},[t,y]),w=O.useCallback(L=>{const j=L.target.files;j&&j.length>0&&y(j[0])},[y]),T=O.useCallback(()=>{var L;(L=n.current)==null||L.click()},[]),k=O.useCallback(()=>{e(null),u(""),n.current&&(n.current.value="")},[e]),I=L=>L<1024?`${L} B`:L<1024*1024?`${(L/1024).toFixed(1)} KB`:`${(L/(1024*1024)).toFixed(1)} MB`,M=L=>L.type.startsWith("video/")||L.name.match(/\.(mp4|m4v|mov|avi|webm)$/i)!==null;return f.jsxs("div",{className:"space-y-3",children:[f.jsx("input",{ref:n,type:"file",accept:".wav,.mp3,.ogg,.flac,.webm,.mp4,.m4v,.mov,.avi,audio/*,video/*",onChange:w,className:"hidden",disabled:t}),f.jsx("div",{onDragOver:A,onDragLeave:x,onDrop:b,className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${t?"border-gray-200 bg-gray-50 cursor-not-allowed":o?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400 cursor-pointer"}`,onClick:t?void 0:T,children:r?f.jsxs("div",{className:"flex items-center justify-center gap-3",children:[M(r)?f.jsx("svg",{className:"w-8 h-8 text-purple-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}):f.jsx("svg",{className:"w-8 h-8 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})}),f.jsxs("div",{className:"text-left flex-1 min-w-0",children:[f.jsx("p",{className:"font-medium text-gray-800 truncate",children:r.name}),f.jsx("p",{className:"text-sm text-gray-500",children:I(r.size)})]}),f.jsx("button",{onClick:g,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-full transition-colors flex-shrink-0",title:h?"Pause":"Play source audio",children:h?f.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):f.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),f.jsx("button",{onClick:L=>{L.stopPropagation(),k()},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors flex-shrink-0",title:"Remove file",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):f.jsxs("div",{children:[f.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),f.jsxs("p",{className:"text-gray-600 mb-1",children:[f.jsx("span",{className:"font-medium text-blue-600",children:"Click to browse"})," or drag and drop"]}),f.jsx("p",{className:"text-sm text-gray-500",children:"WAV, MP3, OGG, FLAC, WebM, MP4, MOV, AVI (max 100 MB)"})]})}),l&&f.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded-md",children:l})]})}function HT({onRecordingComplete:r,maxDuration:e=90,minDuration:t=0,disabled:n=!1,shouldReset:i=!1}){const[s,o]=O.useState(!1),[a,l]=O.useState(0),[u,h]=O.useState(null),[m,g]=O.useState(null),[v,y]=O.useState(!1),A=O.useRef(null),x=O.useRef([]),b=O.useRef(null),w=O.useRef(null),T=O.useRef(null);O.useEffect(()=>{i&&u&&(u&&URL.revokeObjectURL(u),h(null),l(0),g(null))},[i,u]),O.useEffect(()=>()=>{b.current&&clearInterval(b.current),w.current&&w.current.getTracks().forEach(z=>z.stop()),u&&URL.revokeObjectURL(u)},[u]);const k=O.useCallback(async()=>{try{g(null),x.current=[];const z=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:16e3,echoCancellation:!0,noiseSuppression:!0}});w.current=z;const Z=new MediaRecorder(z,{mimeType:"audio/webm;codecs=opus"});A.current=Z,Z.ondataavailable=U=>{U.data.size>0&&x.current.push(U.data)},Z.onstop=async()=>{w.current&&(w.current.getTracks().forEach(X=>X.stop()),w.current=null);const U=new Blob(x.current,{type:"audio/webm"}),Y=await c6(U);u&&URL.revokeObjectURL(u);const ee=URL.createObjectURL(Y);h(ee),r(Y)},Z.start(100),o(!0),l(0);const $=Date.now();b.current=window.setInterval(()=>{const U=Math.floor((Date.now()-$)/1e3);l(U),U>=e&&I()},100)}catch(z){console.error("Error starting recording:",z),g("Failed to access microphone. Please check permissions.")}},[e,u,r]),I=O.useCallback(()=>{b.current&&(clearInterval(b.current),b.current=null),A.current&&A.current.state==="recording"&&A.current.stop(),o(!1)},[]),M=O.useCallback(()=>{u&&URL.revokeObjectURL(u),h(null),l(0),r(null)},[u,r]),L=O.useCallback(async z=>{var $;const Z=($=z.target.files)==null?void 0:$[0];if(Z){g(null),y(!0);try{if(!Z.type.startsWith("audio/"))throw new Error("Please upload an audio file (MP3, WAV, etc.)");const U=await u6(Z),Y=await d6(U);if(t>0&&Y<t)throw new Error(`Audio must be at least ${t} seconds long`);if(Y>e)throw new Error(`Audio must be less than ${e} seconds long`);l(Math.floor(Y)),u&&URL.revokeObjectURL(u);const ee=URL.createObjectURL(U);h(ee),r(U)}catch(U){console.error("Error processing audio file:",U),g(U instanceof Error?U.message:"Failed to process audio file")}finally{y(!1),T.current&&(T.current.value="")}}},[u,e,t,r]),j=z=>{const Z=Math.floor(z/60),$=z%60;return`${Z}:${$.toString().padStart(2,"0")}`},B=a>=t;return f.jsxs("div",{className:"space-y-3",children:[m&&f.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:m}),f.jsxs("div",{className:"flex items-center gap-3",children:[s?f.jsxs("button",{onClick:I,disabled:!B,className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${B?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})}),"Stop Recording"]}):f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:k,disabled:n||v,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("circle",{cx:"12",cy:"12",r:"6"})}),"Record"]}),f.jsx("span",{className:"text-gray-400 text-sm",children:"or"}),f.jsxs("label",{className:`flex items-center gap-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer ${n||v?"opacity-50 cursor-not-allowed":""}`,children:[f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),v?"Processing...":"Upload",f.jsx("input",{ref:T,type:"file",accept:"audio/*",onChange:L,disabled:n||v,className:"hidden"})]})]}),f.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s&&f.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),f.jsxs("span",{className:"font-mono text-lg",children:[j(a)," / ",j(e)]})]}),u&&!s&&f.jsx("button",{onClick:M,className:"px-3 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),s&&t>0&&a<t&&f.jsxs("p",{className:"text-sm text-yellow-600",children:["Minimum recording length: ",j(t)]}),u&&!s&&f.jsx("div",{className:"mt-3",children:f.jsx("audio",{src:u,controls:!0,className:"w-full"})})]})}async function c6(r){const e=new AudioContext({sampleRate:16e3});try{const t=await r.arrayBuffer(),n=await e.decodeAudioData(t),i=n.getChannelData(0),s=n.sampleRate,o=yO(i,s);return new Blob([o],{type:"audio/wav"})}finally{await e.close()}}function yO(r,e){const t=new ArrayBuffer(44+r.length*2),n=new DataView(t);N0(n,0,"RIFF"),n.setUint32(4,36+r.length*2,!0),N0(n,8,"WAVE"),N0(n,12,"fmt "),n.setUint32(16,16,!0),n.setUint16(20,1,!0),n.setUint16(22,1,!0),n.setUint32(24,e,!0),n.setUint32(28,e*2,!0),n.setUint16(32,2,!0),n.setUint16(34,16,!0),N0(n,36,"data"),n.setUint32(40,r.length*2,!0);let i=44;for(let s=0;s<r.length;s++,i+=2){const o=Math.max(-1,Math.min(1,r[s]));n.setInt16(i,o<0?o*32768:o*32767,!0)}return t}function N0(r,e,t){for(let n=0;n<t.length;n++)r.setUint8(e+n,t.charCodeAt(n))}async function u6(r){const e=new AudioContext({sampleRate:16e3});try{const t=await r.arrayBuffer(),n=await e.decodeAudioData(t),i=n.getChannelData(0),s=n.sampleRate,o=yO(i,s);return new Blob([o],{type:"audio/wav"})}finally{await e.close()}}function d6(r){return new Promise((e,t)=>{const n=new Audio;n.onloadedmetadata=()=>{e(n.duration),URL.revokeObjectURL(n.src)},n.onerror=()=>{URL.revokeObjectURL(n.src),t(new Error("Failed to load audio"))},n.src=URL.createObjectURL(r)})}function h6({settings:r,onSettingsChange:e,isConfigured:t,history:n,addToHistory:i,removeFromHistory:s,clearHistory:o}){const[a,l]=O.useState("realtime"),[u,h]=O.useState("auto"),[m,g]=O.useState(null),[v,y]=O.useState(""),[A,x]=O.useState(!1),[b,w]=O.useState(!1),[T,k]=O.useState(2),[I,M]=O.useState(""),L=_F(r),j=DF(r),B=BF(r),z=HF(r),$=(()=>{switch(a){case"realtime":return L;case"fast-transcription":return j;case"llm-speech":return z;case"whisper":return B}})();O.useEffect(()=>{if($.state==="completed"&&m){const V=a==="realtime"&&L.transcript?{text:L.transcript.text,segments:L.transcript.segments}:a==="fast-transcription"&&j.transcript?{text:j.transcript.fullText,segments:j.transcript.segments}:a==="llm-speech"&&z.transcript?{text:z.transcript.fullText,segments:z.transcript.segments}:a==="whisper"&&B.transcript?{text:B.transcript.fullText,segments:B.transcript.segments}:null;V&&lA(m).then(ce=>{i({timestamp:Date.now(),model:a,audioFileName:v||"audio",audioSize:m.size,audioDuration:ce,language:u,transcript:V.text,processingTime:0,segments:V.segments})}).catch(ce=>{console.error("Failed to get audio duration:",ce)})}},[$.state,a,m,v,u,i]);const U=W=>{g(W),y((W==null?void 0:W.name)||""),x(!1),$.reset()},Y=W=>{W&&(g(W),y("recording"),x(!0),$.reset())},ee=async()=>{if(m)try{a==="realtime"?await L.startRecognition(m,u):a==="fast-transcription"?await j.transcribe(m,u,{enableDiarization:b,maxSpeakers:T}):a==="llm-speech"?await z.transcribe(m,u,{enableDiarization:b,maxSpeakers:T,prompt:I.trim()?I.split(`
`).filter(W=>W.trim()):void 0}):a==="whisper"&&await B.transcribe(m,u)}catch(W){console.error("Transcription error:",W)}},X=()=>{a==="realtime"?L.stopRecognition():a==="whisper"&&B.cancelJob()},re=$.state==="processing"||$.state==="streaming",G=$.state==="completed",ne=a==="realtime"&&L.transcript?{segments:L.transcript.segments,fullText:L.transcript.text,interimText:L.transcript.interimText,isStreaming:L.transcript.isStreaming,detectedLanguage:void 0}:a==="fast-transcription"&&j.transcript?{segments:j.transcript.segments,fullText:j.transcript.fullText,interimText:void 0,isStreaming:!1,detectedLanguage:j.transcript.language}:a==="llm-speech"&&z.transcript?{segments:z.transcript.segments,fullText:z.transcript.fullText,interimText:void 0,isStreaming:!1,detectedLanguage:z.transcript.language}:a==="whisper"&&B.transcript?{segments:B.transcript.segments,fullText:B.transcript.fullText,interimText:void 0,isStreaming:!1,detectedLanguage:B.transcript.language}:{segments:[],fullText:"",interimText:void 0,isStreaming:!1,detectedLanguage:void 0};return f.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 shadow-md",children:[f.jsx("h1",{className:"text-3xl font-bold",children:"Speech to Text"}),f.jsx("p",{className:"text-purple-100 mt-1",children:"Transcribe audio using Azure Speech Recognition APIs"})]}),f.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[f.jsx("div",{className:"flex-1 bg-gray-50 border-r border-gray-200 flex flex-col overflow-hidden",children:f.jsxs("div",{className:"flex-1 flex flex-col gap-6 p-6 overflow-y-auto",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Audio Source"}),f.jsx("div",{children:f.jsx(SO,{file:m instanceof File?m:null,onFileChange:U,disabled:!t})}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-0 flex items-center",children:f.jsx("div",{className:"w-full border-t border-gray-300"})}),f.jsx("div",{className:"relative flex justify-center text-sm",children:f.jsx("span",{className:"px-2 bg-gray-50 text-gray-500",children:"or"})})]}),f.jsx("div",{children:f.jsx(HT,{onRecordingComplete:Y,shouldReset:!A})}),f.jsxs("div",{className:"space-y-2",children:[!t&&f.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:f.jsx("p",{className:"text-sm text-yellow-800",children:"Please configure your Azure API key and region in the settings to use Speech-to-Text."})}),$.error&&f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:f.jsx("p",{className:"text-sm text-red-800",children:$.error})}),a==="whisper"&&B.pollingStatus&&!$.error&&f.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:f.jsx("p",{className:"text-sm text-blue-800",children:B.pollingStatus})}),f.jsx("button",{onClick:re?X:ee,disabled:!t||!m,className:`
                  w-full py-3 px-6 rounded-lg font-semibold text-white transition-all
                  ${re?"bg-red-600 hover:bg-red-700":"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700"}
                  disabled:opacity-50 disabled:cursor-not-allowed
                  flex items-center justify-center gap-2
                `,children:re?f.jsxs(f.Fragment,{children:[f.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),f.jsx("span",{children:"Cancel"})]}):f.jsxs(f.Fragment,{children:[f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})}),f.jsx("span",{children:"Transcribe Audio"})]})})]}),f.jsx(e6,{segments:ne.segments,fullText:ne.fullText,interimText:ne.interimText,isStreaming:ne.isStreaming,audioSource:m,detectedLanguage:ne.detectedLanguage,showConfidence:a!=="llm-speech"}),G&&f.jsx(o6,{segments:ne.segments,filename:v||"transcript"})]})}),f.jsxs("div",{className:"w-full md:w-[400px] flex-shrink-0 bg-white border-l border-gray-200 flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex-1 flex flex-col gap-6 p-6 overflow-y-auto",children:[f.jsx(XF,{selectedModel:a,onModelChange:W=>{l(W),$.reset()},region:r.region}),f.jsx(QF,{selectedLanguage:u,onLanguageChange:h,selectedModel:a}),(a==="fast-transcription"||a==="llm-speech")&&f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Speaker Diarization"}),f.jsxs("div",{className:"flex items-start",children:[f.jsx("input",{type:"checkbox",id:"enableDiarization",checked:b,onChange:W=>w(W.target.checked),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),f.jsx("label",{htmlFor:"enableDiarization",className:"ml-2 block text-sm text-gray-700",children:"Identify different speakers in the audio"})]}),b&&f.jsxs("div",{className:"ml-6 space-y-2",children:[f.jsx("label",{htmlFor:"maxSpeakers",className:"block text-sm text-gray-700",children:"Maximum speakers"}),f.jsxs("select",{id:"maxSpeakers",value:T,onChange:W=>k(parseInt(W.target.value)),className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[f.jsx("option",{value:2,children:"2 speakers"}),f.jsx("option",{value:3,children:"3 speakers"}),f.jsx("option",{value:4,children:"4 speakers"}),f.jsx("option",{value:5,children:"5 speakers"}),f.jsx("option",{value:6,children:"6 speakers"}),f.jsx("option",{value:8,children:"8 speakers"}),f.jsx("option",{value:10,children:"10 speakers"})]}),f.jsx("p",{className:"text-xs text-gray-500",children:"Set the maximum number of speakers expected in the audio"})]})]}),a==="llm-speech"&&f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{htmlFor:"llmPrompt",className:"block text-sm font-medium text-gray-700",children:"LLM Prompt (Optional)"}),f.jsx("textarea",{id:"llmPrompt",value:I,onChange:W=>M(W.target.value),placeholder:`Example: Output must be in lexical format.
Include all technical terms.
Preserve punctuation.`,rows:3,className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm font-mono text-xs"}),f.jsx("p",{className:"text-xs text-gray-500",children:"Add custom instructions for the LLM to guide transcription output format and style. Each line becomes a separate prompt instruction."})]})]}),f.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:f.jsx("p",{className:"text-xs text-gray-600",children:"Powered by Azure Speech Services - Realtime, Fast Transcription, and Whisper APIs"})})]})]})]})}const CO=[{name:"en-US-AmandaMultilingualNeural",displayName:"Amanda",gender:"Female"},{name:"en-US-AvaMultilingualNeural",displayName:"Ava",gender:"Female"},{name:"en-US-CoraMultilingualNeural",displayName:"Cora",gender:"Female"},{name:"en-US-EmmaMultilingualNeural",displayName:"Emma",gender:"Female"},{name:"en-US-EvelynMultilingualNeural",displayName:"Evelyn",gender:"Female"},{name:"en-US-JennyMultilingualNeural",displayName:"Jenny",gender:"Female"},{name:"en-US-LolaMultilingualNeural",displayName:"Lola",gender:"Female"},{name:"en-US-NancyMultilingualNeural",displayName:"Nancy",gender:"Female"},{name:"en-US-NovaTurboMultilingualNeural",displayName:"Nova (Turbo)",gender:"Female"},{name:"en-US-PhoebeMultilingualNeural",displayName:"Phoebe",gender:"Female"},{name:"en-US-SerenaMultilingualNeural",displayName:"Serena",gender:"Female"},{name:"en-US-ShimmerTurboMultilingualNeural",displayName:"Shimmer (Turbo)",gender:"Female"},{name:"en-US-AdamMultilingualNeural",displayName:"Adam",gender:"Male"},{name:"en-US-AlloyTurboMultilingualNeural",displayName:"Alloy (Turbo)",gender:"Male"},{name:"en-US-AndrewMultilingualNeural",displayName:"Andrew",gender:"Male"},{name:"en-US-BrandonMultilingualNeural",displayName:"Brandon",gender:"Male"},{name:"en-US-BrianMultilingualNeural",displayName:"Brian",gender:"Male"},{name:"en-US-ChristopherMultilingualNeural",displayName:"Christopher",gender:"Male"},{name:"en-US-DavisMultilingualNeural",displayName:"Davis",gender:"Male"},{name:"en-US-DerekMultilingualNeural",displayName:"Derek",gender:"Male"},{name:"en-US-DustinMultilingualNeural",displayName:"Dustin",gender:"Male"},{name:"en-US-EchoTurboMultilingualNeural",displayName:"Echo (Turbo)",gender:"Male"},{name:"en-US-LewisMultilingualNeural",displayName:"Lewis",gender:"Male"},{name:"en-US-OnyxTurboMultilingualNeural",displayName:"Onyx (Turbo)",gender:"Male"},{name:"en-US-RyanMultilingualNeural",displayName:"Ryan",gender:"Male"},{name:"en-US-SamuelMultilingualNeural",displayName:"Samuel",gender:"Male"},{name:"en-US-SteffanMultilingualNeural",displayName:"Steffan",gender:"Male"},{name:"en-US-FableTurboMultilingualNeural",displayName:"Fable (Turbo)",gender:"Neutral"}];async function AO(r,e){const t=e.accountName.trim(),n=e.containerName.trim(),i=e.sasToken.trim(),s=Date.now(),o=r.name.replace(/[^a-zA-Z0-9.-]/g,"_"),a=`voice-conversion/${s}-${o}`,l=i.startsWith("?")?i:`?${i}`,u=`https://${t}.blob.core.windows.net/${n}/${a}${l}`;console.log("Uploading to blob URL:",u.split("?")[0]);const h=await r.arrayBuffer();let m;try{m=await fetch(u,{method:"PUT",headers:{"x-ms-blob-type":"BlockBlob","Content-Type":r.type||"application/octet-stream"},body:h})}catch(v){throw console.error("Blob upload fetch error:",v),new Error(`Failed to upload to blob storage. This is likely a CORS issue. Please enable CORS on your Azure Storage Account "${t}": Go to Azure Portal  Storage Account  Settings  Resource sharing (CORS)  Add rule with Allowed origins: *, Methods: GET,PUT,OPTIONS, Headers: *`)}if(!m.ok){const v=await m.text();throw new Error(`Failed to upload to blob storage: ${m.status} ${m.statusText}. ${v}`)}const g=`https://${t}.blob.core.windows.net/${n}/${a}${l}`;return console.log("Blob uploaded successfully:",g.split("?")[0]),g}function bO(r){return r.accountName.trim()?r.containerName.trim()?r.sasToken.trim()?null:"SAS Token is required":"Container Name is required":"Storage Account Name is required"}function xO(){try{const r=localStorage.getItem("azure-voice-blob-config");if(r)return JSON.parse(r)}catch(r){console.error("Failed to load blob config:",r)}return{accountName:"",containerName:"",sasToken:""}}function TO(r){try{localStorage.setItem("azure-voice-blob-config",JSON.stringify(r))}catch(e){console.error("Failed to save blob config:",e)}}function p6({apiKey:r,region:e}){const[t,n]=O.useState("idle"),[i,s]=O.useState(""),[o,a]=O.useState(null),l=O.useCallback(()=>{n("idle"),s(""),a(null)},[]),u=O.useCallback(async(h,m,g)=>{if(!r){s("Azure API Key is required"),n("error");return}if(!e){s("Azure Region is required"),n("error");return}const v=bO(g);if(v){s(v),n("error");return}const y=100*1024*1024;if(h.size>y){s("File size must be less than 100 MB"),n("error");return}try{n("uploading"),s(""),console.log("Uploading audio to blob storage...");const A=await AO(h,g);console.log("Audio uploaded, URL:",A.split("?")[0]),n("converting"),console.log("Starting voice conversion...");const x=A.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),b=`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="en-US"><voice name="${m.name}"><mstts:voiceconversion url="${x}"/></voice></speak>`;console.log("SSML:",b);const w=`https://${e}.tts.speech.microsoft.com/cognitiveservices/v1`,T=await fetch(w,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":r,"Content-Type":"application/ssml+xml","X-Microsoft-OutputFormat":"audio-24khz-48kbitrate-mono-mp3","User-Agent":"AzureVoicePlayground"},body:b});if(!T.ok){const I=await T.text();throw new Error(`Voice conversion failed: ${T.status} ${T.statusText}. ${I}`)}const k=await T.arrayBuffer();console.log("Voice conversion completed, audio size:",k.byteLength),a(k),n("idle")}catch(A){console.error("Voice conversion error:",A),s(A instanceof Error?A.message:"Voice conversion failed"),n("error")}},[r,e]);return{state:t,error:i,resultAudioData:o,convert:u,reset:l}}function f6({selectedVoice:r,onVoiceChange:e}){const[t,n]=O.useState(""),[i,s]=O.useState("All"),o=O.useMemo(()=>CO.filter(l=>{if(i!=="All"&&l.gender!==i)return!1;if(t){const u=t.toLowerCase();return l.displayName.toLowerCase().includes(u)||l.name.toLowerCase().includes(u)}return!0}),[t,i]),a=["All","Female","Male"];return f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Target Voice"}),f.jsx("div",{className:"flex gap-2 flex-wrap",children:a.map(l=>f.jsx("button",{onClick:()=>s(l),className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${i===l?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:l},l))}),f.jsx("input",{type:"text",placeholder:"Search voices...",value:t,onChange:l=>n(l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),r&&f.jsxs("div",{className:"p-2 bg-blue-50 border border-blue-200 rounded-md",children:[f.jsx("div",{className:"text-xs text-blue-600 font-medium",children:"Selected:"}),f.jsx("div",{className:"text-sm text-blue-800 truncate",children:r.displayName})]}),f.jsx("div",{className:"max-h-96 overflow-y-auto border border-gray-200 rounded-md",children:o.length===0?f.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No voices found"}):o.map(l=>f.jsxs("button",{onClick:()=>e(l),className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${(r==null?void 0:r.name)===l.name?"bg-blue-50 border-l-4 border-l-blue-600":"hover:bg-gray-50"}`,children:[f.jsx("div",{className:"font-medium text-gray-800",children:l.displayName}),f.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[f.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs ${l.gender==="Female"?"bg-pink-100 text-pink-700":l.gender==="Male"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:l.gender}),f.jsx("span",{className:"text-gray-400",children:"en-US"})]})]},l.name))}),f.jsxs("div",{className:"text-xs text-gray-500",children:[o.length," voice",o.length!==1?"s":""," available"]})]})}function m6({history:r,onClearHistory:e,onDeleteEntry:t}){const[n,i]=O.useState(!1),s=()=>{i(!n)};return f.jsxs("div",{className:"border-t border-gray-200 bg-gray-50",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-gray-100",onClick:s,children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Conversion History"}),r.length>0&&f.jsx("span",{className:"px-2 py-1 text-xs font-medium text-white bg-purple-600 rounded-full",children:r.length})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[r.length>0&&f.jsx("button",{onClick:o=>{o.stopPropagation(),window.confirm("Clear all conversion history?")&&e()},className:"px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors",children:"Clear All"}),f.jsx("button",{className:"p-1 text-gray-600",children:f.jsx("svg",{className:`w-5 h-5 transform transition-transform ${n?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),n&&f.jsx("div",{className:"px-4 pb-4 max-h-60 overflow-y-auto",children:r.length===0?f.jsxs("div",{className:"py-8 text-center text-gray-500",children:[f.jsx("p",{children:"No conversion history yet"}),f.jsx("p",{className:"text-sm mt-1",children:"Converted audio will appear here"})]}):f.jsx("div",{className:"space-y-2",children:[...r].reverse().map(o=>f.jsx(g6,{entry:o,onDelete:t},o.id))})})]})}function g6({entry:r,onDelete:e}){const[t,n]=O.useState(!1),i=O.useRef(null),s=O.useRef(null);O.useEffect(()=>{const m=new Blob([r.resultAudioData],{type:"audio/mpeg"}),g=URL.createObjectURL(m);return s.current=g,()=>{s.current&&URL.revokeObjectURL(s.current)}},[r.resultAudioData]);const o=()=>{i.current||(i.current=new Audio(s.current||""),i.current.addEventListener("ended",()=>{n(!1)})),t?(i.current.pause(),n(!1)):(i.current.play(),n(!0))},a=()=>{const m=new Date(r.timestamp).toISOString().replace(/[:.]/g,"-").slice(0,-5),g=r.targetVoice.replace(/[^a-zA-Z0-9-]/g,"_"),y=`voiceconversion-${r.sourceFileName.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9-]/g,"_")}-to-${g}-${m}.mp3`;hO(r.resultAudioData,y)},l=()=>{i.current&&(i.current.pause(),i.current=null),e(r.id)},u=new Date(r.timestamp).toLocaleTimeString(),h=r.targetVoice.replace("en-US-","").replace("MultilingualNeural","").replace("Turbo"," (Turbo)");return f.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border border-gray-200 rounded-md hover:bg-gray-50",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("p",{className:"text-sm text-gray-800 truncate mb-1",children:[f.jsx("span",{className:"font-medium",children:r.sourceFileName}),f.jsx("span",{className:"text-gray-400 mx-2",children:""}),f.jsx("span",{className:"text-purple-600",children:h})]}),f.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[f.jsx("span",{children:u}),f.jsx("span",{children:""}),f.jsx("span",{children:r.region}),f.jsx("span",{children:""}),f.jsx("span",{children:pO(r.duration)})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:o,className:"p-2 text-purple-600 hover:bg-purple-50 rounded-md transition-colors",title:t?"Pause":"Play",children:t?f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),f.jsx("button",{onClick:a,className:"p-2 text-green-600 hover:bg-green-50 rounded-md transition-colors",title:"Save as MP3",children:f.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:[f.jsx("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),f.jsx("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})]})}),f.jsx("button",{onClick:l,className:"p-2 text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z",clipRule:"evenodd"})})})]})]})}function v6({sourceFileName:r,targetVoice:e,region:t,audioData:n}){const i=async()=>{try{const s=`
Source File: ${r||"[No file selected]"}
Target Voice: ${e||"[No voice selected]"}
Region: ${t}

${n?"Please find the converted audio file attached (downloaded separately).":"[No conversion completed yet]"}
      `.trim(),o=encodeURIComponent(`Azure Voice Conversion Feedback - ${e||"No voice"}`),a=encodeURIComponent(s),l=`mailto:ttsvoicefeedback@microsoft.com?subject=${o}&body=${a}`;if(n){const u=new Blob([n],{type:"audio/mpeg"}),h=URL.createObjectURL(u),m=document.createElement("a");m.href=h,m.download=`conversion-${e||"output"}-${Date.now()}.mp3`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(h)}window.open(l,"_blank"),n&&alert("Audio file downloaded! Please attach it to your email before sending.")}catch(s){console.error("Error sending feedback:",s),alert("Error preparing feedback. Please try again.")}};return f.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200 text-sm font-medium",title:"Send feedback about voice conversion",children:[f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[f.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),f.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),"Send Feedback"]})}function S6({settings:r,onSettingsChange:e,isConfigured:t,history:n,addToHistory:i,removeFromHistory:s,clearHistory:o}){const[a,l]=O.useState(xO),[u,h]=O.useState(!1),[m,g]=O.useState(null),[v,y]=O.useState(CO[0]),[A,x]=O.useState(!1),b=O.useRef(null),w=O.useRef(null),T=O.useRef(null),{state:k,error:I,resultAudioData:M,convert:L,reset:j}=p6({apiKey:r.apiKey,region:r.region});O.useEffect(()=>{TO(a)},[a]),O.useEffect(()=>{M&&m&&v&&M!==T.current&&(T.current=M,lA(M).then(ee=>{i({timestamp:Date.now(),sourceFileName:m.name,targetVoice:v.name,region:r.region,resultAudioData:M,duration:ee})}).catch(ee=>{console.error("Failed to get audio duration:",ee);const X=M.byteLength*8/48e3;i({timestamp:Date.now(),sourceFileName:m.name,targetVoice:v.name,region:r.region,resultAudioData:M,duration:X})}))},[M,m,v,r.region,i]),O.useEffect(()=>{if(M){w.current&&URL.revokeObjectURL(w.current);const ee=new Blob([M],{type:"audio/mpeg"});w.current=URL.createObjectURL(ee)}return()=>{w.current&&URL.revokeObjectURL(w.current)}},[M]);const B=O.useCallback(()=>{!m||!v||L(m,v,a)},[m,v,a,L]),z=O.useCallback(()=>{w.current&&(b.current||(b.current=new Audio(w.current),b.current.addEventListener("ended",()=>{x(!1)})),A?(b.current.pause(),x(!1)):(b.current.play(),x(!0)))},[A]),Z=a.accountName&&a.containerName&&a.sasToken,U=["eastus","westeurope","southeastasia"].includes(r.region.toLowerCase()),Y=t&&U&&Z&&m&&v&&(k==="idle"||k==="error");return f.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[f.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 shadow-md",children:[f.jsx("h1",{className:"text-3xl font-bold",children:"Voice Changer"}),f.jsx("p",{className:"text-purple-100 mt-1",children:"Transform your voice using Azure Voice Conversion (Preview)"})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[t&&!U&&f.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx("svg",{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-amber-800",children:"Region Not Supported"}),f.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Voice Changer is currently only available in the following regions:"}),f.jsxs("ul",{className:"text-sm text-amber-700 mt-2 list-disc list-inside",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"East US"})," (eastus)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"West Europe"})," (westeurope)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Southeast Asia"})," (southeastasia)"]})]}),f.jsxs("p",{className:"text-sm text-amber-700 mt-2",children:["Your current region is ",f.jsx("strong",{children:r.region}),". Please update your region in the sidebar settings."]})]})]})}),(!t||U)&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[f.jsxs("button",{onClick:()=>h(!u),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})}),f.jsx("span",{className:"font-medium text-gray-800",children:"Azure Blob Storage Configuration"}),Z&&f.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded-full",children:"Configured"})]}),f.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${u?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),u&&f.jsxs("div",{className:"p-4 space-y-4 border-t border-gray-200",children:[f.jsxs("p",{className:"text-sm text-gray-600",children:["Voice conversion requires uploading audio to Azure Blob Storage.",f.jsx("a",{href:"https://portal.azure.com/#create/Microsoft.StorageAccount",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline ml-1",children:"Create a storage account"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Storage Account Name"}),f.jsx("input",{type:"text",value:a.accountName,onChange:ee=>l(X=>({...X,accountName:ee.target.value})),placeholder:"mystorageaccount",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Container Name"}),f.jsx("input",{type:"text",value:a.containerName,onChange:ee=>l(X=>({...X,containerName:ee.target.value})),placeholder:"audio-files",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SAS Token"}),f.jsx("input",{type:"password",value:a.sasToken,onChange:ee=>l(X=>({...X,sasToken:ee.target.value})),placeholder:"?sv=2022-11-02&ss=b...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})]}),f.jsx("p",{className:"text-xs text-gray-500",children:"SAS token needs read and write permissions. Credentials are stored locally in your browser."}),f.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-md",children:[f.jsx("p",{className:"text-xs font-medium text-amber-800 mb-1",children:"CORS Configuration Required"}),f.jsx("p",{className:"text-xs text-amber-700",children:"In Azure Portal, go to your Storage Account  Resource sharing (CORS) and add a rule:"}),f.jsxs("ul",{className:"text-xs text-amber-700 mt-1 ml-4 list-disc",children:[f.jsxs("li",{children:["Allowed origins: ",f.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"*"})]}),f.jsxs("li",{children:["Allowed methods: ",f.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"GET, PUT, OPTIONS"})]}),f.jsxs("li",{children:["Allowed headers: ",f.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"*"})]})]})]})]})]}),f.jsx(SO,{file:m,onFileChange:g,disabled:k!=="idle"}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("button",{onClick:B,disabled:!Y,className:`px-6 py-3 rounded-lg font-medium transition-colors ${Y?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:k==="uploading"?"Uploading...":k==="converting"?"Converting...":"Convert Voice"}),!t&&f.jsx("p",{className:"text-sm text-amber-600",children:"Please configure Azure API key and region in the sidebar."}),t&&!Z&&f.jsx("p",{className:"text-sm text-amber-600",children:"Please configure Blob Storage above."})]}),I&&f.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:[f.jsx("p",{className:"font-medium",children:"Error"}),f.jsx("p",{className:"text-sm",children:I})]}),M&&f.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-green-800",children:"Conversion Complete"}),f.jsxs("p",{className:"text-sm text-green-600",children:[m==null?void 0:m.name,"  ",v==null?void 0:v.displayName]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:z,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:A?f.jsxs(f.Fragment,{children:[f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}),"Pause"]}):f.jsxs(f.Fragment,{children:[f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})}),"Play Result"]})}),f.jsx("button",{onClick:j,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"New Conversion"})]})]})})]})]}),f.jsx(m6,{history:n,onClearHistory:o,onDeleteEntry:s}),f.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:"text-xs text-gray-600",children:"Voice Conversion is a preview feature. Only en-US voices are supported. Zeroshot is also supported, contact us."}),f.jsx(v6,{sourceFileName:(m==null?void 0:m.name)||null,targetVoice:(v==null?void 0:v.displayName)||null,region:r.region,audioData:M})]})})]}),f.jsx("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 overflow-y-auto",children:f.jsx(f6,{selectedVoice:v,onVoiceChange:y})})]})}function z2(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function wO(r,e,t,n){const i=n.map(a=>a.toLowerCase()),o=r.split(`
`).filter(a=>a.trim()).map(a=>{const l=a.indexOf(":");if(l>0){const h=a.substring(0,l).trim().toLowerCase(),m=a.substring(l+1).trim();if(i.indexOf(h)>=0&&m)return`<mstts:turn speaker="${h}">${z2(m)}</mstts:turn>`}return a.trim()?`<mstts:turn speaker="${n[0].toLowerCase()}">${z2(a.trim())}</mstts:turn>`:""}).filter(a=>a).join(`
`);return`<speak xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" version="1.0" xml:lang="${t}">
<voice name="${e}">
<mstts:dialog>
${o}
</mstts:dialog>
</voice>
</speak>`}function y6({apiKey:r,region:e}){const[t,n]=O.useState("idle"),[i,s]=O.useState(""),[o,a]=O.useState(null),[l,u]=O.useState(""),h=O.useRef(null),m=O.useRef(null),g=O.useRef([]),v=O.useRef(0),y=O.useRef(!1),A=O.useRef(null),x=O.useCallback(I=>{h.current&&h.current.close(),console.log("Initializing multi-talker synthesizer with voice:",I);const M=_t.SpeechConfig.fromSubscription(r,e);M.speechSynthesisOutputFormat=_t.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3;const L=new _t.SpeakerAudioDestination;m.current=L;const j=_t.AudioConfig.fromSpeakerOutput(L),B=new _t.SpeechSynthesizer(M,j);return h.current=B,B},[r,e]),b=O.useCallback((I,M,L,j)=>{if(!I.trim()){s("Please enter some text to synthesize");return}if(!M){s("Please select a multi-talker voice");return}if(j.length===0){s("No speakers found in voice name");return}const B=wO(I,M,L,j);u(B),console.log("Generated SSML:",B),n("synthesizing"),s(""),g.current=[],y.current=!1;const z=x(M);z.synthesizing=(Z,$)=>{$.result.audioData&&(g.current.push(new Uint8Array($.result.audioData)),!y.current&&g.current.length===1&&(console.log("First audio chunk received - starting playback"),v.current=Date.now(),y.current=!0,n("playing")))},z.synthesisStarted=()=>{n("synthesizing"),console.log("Multi-talker synthesis started")},z.synthesisCompleted=(Z,$)=>{const U=g.current.reduce((J,ne)=>J+ne.length,0),Y=new Uint8Array(U);let ee=0;for(const J of g.current)Y.set(J,ee),ee+=J.length;a(Y.buffer),console.log("Multi-talker synthesis completed - audio size:",U,"bytes");const X=U*8/48e3*1e3,re=Date.now()-v.current,G=Math.max(100,X-re+300);console.log(`Estimated audio duration: ${X}ms, will stop in: ${G}ms`),y.current||(v.current=Date.now(),y.current=!0,n("playing")),A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{console.log("Audio playback ended"),y.current=!1,n("idle"),A.current=null},G)},z.SynthesisCanceled=(Z,$)=>{console.error("Multi-talker synthesis canceled:",$.errorDetails),s($.errorDetails||"Synthesis was canceled"),n("error"),y.current=!1},z.speakSsmlAsync(B,Z=>{Z.reason===_t.ResultReason.SynthesizingAudioCompleted?console.log("Multi-talker synthesis completed successfully"):(console.error("Multi-talker synthesis failed:",Z.errorDetails),s(Z.errorDetails||"Synthesis failed"),n("error"))},Z=>{console.error("Multi-talker synthesis error:",Z),s(Z),n("error")})},[x]),w=O.useCallback(()=>{m.current&&t==="playing"&&(m.current.pause(),n("paused"),y.current=!1)},[t]),T=O.useCallback(()=>{m.current&&t==="paused"&&(m.current.resume(),n("playing"),y.current=!0)},[t]),k=O.useCallback(()=>{console.log("Stop called - cleaning up"),y.current=!1,A.current&&(clearTimeout(A.current),A.current=null),m.current&&m.current.pause(),h.current&&(h.current.close(),h.current=null),n("idle")},[]);return{state:t,error:i,audioData:o,generatedSSML:l,synthesize:b,pause:w,resume:T,stop:k}}const F2=[{female:"ava",male:"andrew",display:"Ava & Andrew"},{female:"ava",male:"brian",display:"Ava & Brian"},{female:"ava",male:"davis",display:"Ava & Davis"},{female:"ava",male:"steffan",display:"Ava & Steffan"},{female:"ada",male:"andrew",display:"Ada & Andrew"},{female:"ada",male:"brian",display:"Ada & Brian"},{female:"ada",male:"davis",display:"Ada & Davis"},{female:"ada",male:"steffan",display:"Ada & Steffan"},{female:"emma",male:"andrew",display:"Emma & Andrew"},{female:"emma",male:"brian",display:"Emma & Brian"},{female:"emma",male:"davis",display:"Emma & Davis"},{female:"emma",male:"steffan",display:"Emma & Steffan"},{female:"jane",male:"andrew",display:"Jane & Andrew"},{female:"jane",male:"brian",display:"Jane & Brian"},{female:"jane",male:"davis",display:"Jane & Davis"},{female:"jane",male:"steffan",display:"Jane & Steffan"}];function C6({selectedPair:r,onPairChange:e}){const[t,n]=O.useState(""),i=O.useMemo(()=>{if(!t)return F2;const s=t.toLowerCase().trim();return F2.filter(o=>o.display.toLowerCase().includes(s)||o.female.toLowerCase().includes(s)||o.male.toLowerCase().includes(s))},[t]);return f.jsxs("div",{className:"h-full flex flex-col space-y-2",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Speaker Pair"}),f.jsx("input",{type:"text",placeholder:"Search speaker pairs...",value:t,onChange:s=>n(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),r&&f.jsxs("div",{className:"p-2 bg-purple-50 border border-purple-200 rounded-md flex-shrink-0",children:[f.jsx("div",{className:"text-xs text-purple-600 font-medium",children:"Selected:"}),f.jsx("div",{className:"text-sm text-purple-800 truncate",children:r.display})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto border border-gray-200 rounded-md min-h-0",children:[i.length===0&&f.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No speaker pairs found"}),i.map(s=>f.jsxs("button",{onClick:()=>e(s),className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${(r==null?void 0:r.female)===s.female&&(r==null?void 0:r.male)===s.male?"bg-purple-50 border-l-4 border-l-purple-600":"hover:bg-gray-50"}`,children:[f.jsx("div",{className:"font-medium text-gray-800 text-sm",children:s.display}),f.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[f.jsx("span",{className:"inline-block px-1.5 py-0.5 bg-purple-100 text-purple-700 rounded mr-2",children:"en-US"}),f.jsx("span",{className:"inline-block px-1.5 py-0.5 bg-pink-100 text-pink-700 rounded mr-1",children:s.female}),f.jsx("span",{className:"inline-block px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded",children:s.male})]})]},`${s.female}-${s.male}`))]}),f.jsxs("div",{className:"text-xs text-gray-500 flex-shrink-0 pt-2",children:[i.length," speaker pair",i.length!==1?"s":""," available"]})]})}function wa(r){return r?{voiceName:"en-us-multitalker-set1:DragonHDV2.4Neural",locale:"en-US",speakers:[r.female,r.male],displayName:r.display}:null}const TT=[{locale:"zh-CN",language:"Chinese (Simplified)",speakers:["xiaochen","yunhan"],script:`xiaochen: !,
yunhan: !?
xiaochen: ,
yunhan: !?
xiaochen: ,
yunhan: ,?
xiaochen: !
yunhan: !!
xiaochen: !!
yunhan: !`},{locale:"en-US",language:"English (US)",speakers:["speaker1","speaker2"],script:`speaker1: Welcome to Tech Talk! I'm your host, and today we're diving into artificial intelligence.
speaker2: Thanks for having me! AI is such a fascinating topic these days.
speaker1: Absolutely! Can you explain what makes modern AI so powerful?
speaker2: Of course! The key is deep learning, which allows computers to learn patterns from massive amounts of data.
speaker1: That sounds incredible. What are some practical applications?
speaker2: We see AI everywhere now - voice assistants, recommendation systems, autonomous vehicles, and more.
speaker1: Amazing! What do you think the future holds for AI?
speaker2: I believe we'll see even more integration into daily life, making technology more intuitive and helpful.
speaker1: Thank you for sharing your insights!
speaker2: My pleasure! Thanks for having me on the show.`},{locale:"ja-JP",language:"Japanese",speakers:["speaker1","speaker2"],script:`speaker1: !
speaker2: !AI
speaker1: !AI?
speaker2: !
speaker1: ?
speaker2: AI
speaker1: !AI?
speaker2: 
speaker1: !
speaker2: `},{locale:"de-DE",language:"German",speakers:["speaker1","speaker2"],script:`speaker1: Willkommen bei Tech Talk! Heute sprechen wir ber knstliche Intelligenz.
speaker2: Danke fr die Einladung! KI ist wirklich ein faszinierendes Thema.
speaker1: Absolut! Knnen Sie erklren, was moderne KI so leistungsfhig macht?
speaker2: Natrlich! Der Schlssel ist Deep Learning, das es Computern ermglicht, Muster aus riesigen Datenmengen zu lernen.
speaker1: Das klingt unglaublich. Welche praktischen Anwendungen gibt es?
speaker2: Wir sehen KI berall - Sprachassistenten, Empfehlungssysteme, autonome Fahrzeuge und mehr.
speaker1: Erstaunlich! Was denken Sie, wie die Zukunft der KI aussieht?
speaker2: Ich glaube, wir werden noch mehr Integration in den Alltag sehen.
speaker1: Vielen Dank fr Ihre Einblicke!
speaker2: Gern geschehen! Danke fr die Einladung zur Sendung.`},{locale:"fr-FR",language:"French",speakers:["speaker1","speaker2"],script:`speaker1: Bienvenue sur Tech Talk! Aujourd'hui, nous parlons d'intelligence artificielle.
speaker2: Merci de m'avoir invit! L'IA est un sujet vraiment fascinant.
speaker1: Absolument! Pouvez-vous expliquer ce qui rend l'IA moderne si puissante?
speaker2: Bien sr! La cl est l'apprentissage profond, qui permet aux ordinateurs d'apprendre des modles  partir de grandes quantits de donnes.
speaker1: C'est incroyable. Quelles sont les applications pratiques?
speaker2: L'IA est partout maintenant - assistants vocaux, systmes de recommandation, vhicules autonomes et plus encore.
speaker1: Incroyable! Que pensez-vous de l'avenir de l'IA?
speaker2: Je pense que nous verrons encore plus d'intgration dans la vie quotidienne.
speaker1: Merci pour vos perspectives!
speaker2: Avec plaisir! Merci de m'avoir reu dans l'mission.`},{locale:"es-ES",language:"Spanish",speakers:["speaker1","speaker2"],script:`speaker1: Bienvenidos a Tech Talk! Hoy hablamos sobre inteligencia artificial.
speaker2: Gracias por invitarme! La IA es un tema realmente fascinante.
speaker1: Absolutamente! Puede explicar qu hace que la IA moderna sea tan poderosa?
speaker2: Por supuesto! La clave es el aprendizaje profundo, que permite a las computadoras aprender patrones de grandes cantidades de datos.
speaker1: Eso suena increble. Cules son las aplicaciones prcticas?
speaker2: La IA est en todas partes ahora: asistentes de voz, sistemas de recomendacin, vehculos autnomos y ms.
speaker1: Increble! Qu piensa sobre el futuro de la IA?
speaker2: Creo que veremos an ms integracin en la vida diaria.
speaker1: Gracias por compartir sus conocimientos!
speaker2: Con mucho gusto! Gracias por invitarme al programa.`},{locale:"pt-BR",language:"Portuguese (Brazil)",speakers:["speaker1","speaker2"],script:`speaker1: Bem-vindos ao Tech Talk! Hoje vamos falar sobre inteligncia artificial.
speaker2: Obrigado pelo convite! IA  um tema realmente fascinante.
speaker1: Com certeza! Voc pode explicar o que torna a IA moderna to poderosa?
speaker2: Claro! A chave  o aprendizado profundo, que permite aos computadores aprender padres de grandes quantidades de dados.
speaker1: Isso parece incrvel. Quais so as aplicaes prticas?
speaker2: A IA est em toda parte agora - assistentes de voz, sistemas de recomendao, veculos autnomos e muito mais.
speaker1: Incrvel! O que voc acha sobre o futuro da IA?
speaker2: Acredito que veremos ainda mais integrao na vida cotidiana.
speaker1: Obrigado por compartilhar seus conhecimentos!
speaker2: Foi um prazer! Obrigado por me receber no programa.`},{locale:"it-IT",language:"Italian",speakers:["speaker1","speaker2"],script:`speaker1: Benvenuti a Tech Talk! Oggi parliamo di intelligenza artificiale.
speaker2: Grazie per l'invito! L'IA  un argomento davvero affascinante.
speaker1: Assolutamente! Pu spiegare cosa rende l'IA moderna cos potente?
speaker2: Certo! La chiave  il deep learning, che permette ai computer di imparare modelli da grandi quantit di dati.
speaker1: Sembra incredibile. Quali sono le applicazioni pratiche?
speaker2: L'IA  ovunque ora - assistenti vocali, sistemi di raccomandazione, veicoli autonomi e altro ancora.
speaker1: Fantastico! Cosa pensa del futuro dell'IA?
speaker2: Credo che vedremo ancora pi integrazione nella vita quotidiana.
speaker1: Grazie per aver condiviso le sue intuizioni!
speaker2:  stato un piacere! Grazie per avermi invitato al programma.`},{locale:"ko-KR",language:"Korean",speakers:["speaker1","speaker2"],script:`speaker1:     !     .
speaker2:   ! AI   .
speaker1: !  AI     ?
speaker2: !  .         .
speaker1:  .      ?
speaker2: AI   .  ,  ,    .
speaker1: ! AI    ?
speaker2:         .
speaker1:    !
speaker2:  !    .`}];function W2(r,e){let t=r.script;return r.speakers.forEach((n,i)=>{if(i<e.length){const s=new RegExp(`^${n}:`,"gmi");t=t.replace(s,`${e[i]}:`)}}),t}var A6={34:((r,e,t)=>{var n=t(4901);r.exports=function(i){return typeof i=="object"?i!==null:n(i)}}),81:((r,e,t)=>{var n=t(9565),i=t(9306),s=t(8551),o=t(6823),a=t(851),l=TypeError;r.exports=function(u,h){var m=arguments.length<2?a(u):h;if(i(m))return s(n(m,u));throw new l(o(u)+" is not iterable")}}),116:((r,e,t)=>{var n=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),u=t(9539),h=t(4549),m=h("find",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:m},{find:function(v){a(this);try{o(v)}catch(x){u(this,"throw",x)}if(m)return i(m,this,v);var y=l(this),A=0;return s(y,function(x,b){if(v(x,A++))return b(x)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})}),283:((r,e,t)=>{var n=t(9504),i=t(9039),s=t(4901),o=t(9297),a=t(3724),l=t(350).CONFIGURABLE,u=t(3706),h=t(1181),m=h.enforce,g=h.get,v=String,y=Object.defineProperty,A=n("".slice),x=n("".replace),b=n([].join),w=a&&!i(function(){return y(function(){},"length",{value:8}).length!==8}),T=String(String).split("String"),k=r.exports=function(I,M,L){A(v(M),0,7)==="Symbol("&&(M="["+x(v(M),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),L&&L.getter&&(M="get "+M),L&&L.setter&&(M="set "+M),(!o(I,"name")||l&&I.name!==M)&&(a?y(I,"name",{value:M,configurable:!0}):I.name=M),w&&L&&o(L,"arity")&&I.length!==L.arity&&y(I,"length",{value:L.arity});try{L&&o(L,"constructor")&&L.constructor?a&&y(I,"prototype",{writable:!1}):I.prototype&&(I.prototype=void 0)}catch{}var j=m(I);return o(j,"source")||(j.source=b(T,typeof M=="string"?M:"")),I};Function.prototype.toString=k(function(){return s(this)&&g(this).source||u(this)},"toString")}),350:((r,e,t)=>{var n=t(3724),i=t(9297),s=Function.prototype,o=n&&Object.getOwnPropertyDescriptor,a=i(s,"name"),l=a&&(function(){}).name==="something",u=a&&(!n||n&&o(s,"name").configurable);r.exports={EXISTS:a,PROPER:l,CONFIGURABLE:u}}),397:((r,e,t)=>{var n=t(7751);r.exports=n("document","documentElement")}),421:(r=>{r.exports={}}),456:((r,e,t)=>{var n=t(6518),i=t(4576),s=t(9504),o=t(4154),a=t(5169),l=s(1.1.toString),u=i.Uint8Array,h=!u||!u.prototype.toHex||!(function(){try{var m=new u([255,255,255,255,255,255,255,255]);return m.toHex()==="ffffffffffffffff"}catch{return!1}})();u&&n({target:"Uint8Array",proto:!0,forced:h},{toHex:function(){o(this),a(this.buffer);for(var g="",v=0,y=this.length;v<y;v++){var A=l(this[v],16);g+=A.length===1?"0"+A:A}return g}})}),507:((r,e,t)=>{var n=t(9565);r.exports=function(i,s,o){for(var a=o?i:i.iterator,l=i.next,u,h;!(u=n(l,a)).done;)if(h=s(u.value),h!==void 0)return h}}),531:((r,e,t)=>{var n=t(6518),i=t(9565),s=t(9306),o=t(8551),a=t(1767),l=t(8646),u=t(9462),h=t(9539),m=t(6395),g=t(684),v=t(4549),y=!m&&!g("flatMap",function(){}),A=!m&&!y&&v("flatMap",TypeError),x=m||y||A,b=u(function(){for(var w=this.iterator,T=this.mapper,k,I;;){if(I=this.inner)try{if(k=o(i(I.next,I.iterator)),!k.done)return k.value;this.inner=null}catch(M){h(w,"throw",M)}if(k=o(i(this.next,w)),this.done=!!k.done)return;try{this.inner=l(T(k.value,this.counter++),!1)}catch(M){h(w,"throw",M)}}});n({target:"Iterator",proto:!0,real:!0,forced:x},{flatMap:function(T){o(this);try{s(T)}catch(k){h(this,"throw",k)}return A?i(A,this,T):new b(a(this),{mapper:T,inner:null})}})}),616:((r,e,t)=>{var n=t(9039);r.exports=!n(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")})}),655:((r,e,t)=>{var n=t(6955),i=String;r.exports=function(s){if(n(s)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return i(s)}}),679:((r,e,t)=>{var n=t(1625),i=TypeError;r.exports=function(s,o){if(n(o,s))return s;throw new i("Incorrect invocation")}}),684:(r=>{r.exports=function(e,t){var n=typeof Iterator=="function"&&Iterator.prototype[e];if(n)try{n.call({next:null},t).next()}catch{return!0}}}),741:(r=>{var e=Math.ceil,t=Math.floor;r.exports=Math.trunc||function(i){var s=+i;return(s>0?t:e)(s)}}),757:((r,e,t)=>{var n=t(7751),i=t(4901),s=t(1625),o=t(7040),a=Object;r.exports=o?function(l){return typeof l=="symbol"}:function(l){var u=n("Symbol");return i(u)&&s(u.prototype,a(l))}}),851:((r,e,t)=>{var n=t(6955),i=t(5966),s=t(4117),o=t(6269),a=t(8227),l=a("iterator");r.exports=function(u){if(!s(u))return i(u,l)||i(u,"@@iterator")||o[n(u)]}}),944:(r=>{var e=TypeError;r.exports=function(t){var n=t&&t.alphabet;if(n===void 0||n==="base64"||n==="base64url")return n||"base64";throw new e("Incorrect `alphabet` option")}}),1072:((r,e,t)=>{var n=t(1828),i=t(8727);r.exports=Object.keys||function(o){return n(o,i)}}),1103:(r=>{r.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}}),1108:((r,e,t)=>{var n=t(6955);r.exports=function(i){var s=n(i);return s==="BigInt64Array"||s==="BigUint64Array"}}),1148:((r,e,t)=>{var n=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),u=t(9539),h=t(4549),m=h("every",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:m},{every:function(v){a(this);try{o(v)}catch(x){u(this,"throw",x)}if(m)return i(m,this,v);var y=l(this),A=0;return!s(y,function(x,b){if(!v(x,A++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),1181:((r,e,t)=>{var n=t(8622),i=t(4576),s=t(34),o=t(6699),a=t(9297),l=t(7629),u=t(6119),h=t(421),m="Object already initialized",g=i.TypeError,v=i.WeakMap,y,A,x,b=function(I){return x(I)?A(I):y(I,{})},w=function(I){return function(M){var L;if(!s(M)||(L=A(M)).type!==I)throw new g("Incompatible receiver, "+I+" required");return L}};if(n||l.state){var T=l.state||(l.state=new v);T.get=T.get,T.has=T.has,T.set=T.set,y=function(I,M){if(T.has(I))throw new g(m);return M.facade=I,T.set(I,M),M},A=function(I){return T.get(I)||{}},x=function(I){return T.has(I)}}else{var k=u("state");h[k]=!0,y=function(I,M){if(a(I,k))throw new g(m);return M.facade=I,o(I,k,M),M},A=function(I){return a(I,k)?I[k]:{}},x=function(I){return a(I,k)}}r.exports={set:y,get:A,has:x,enforce:b,getterFor:w}}),1291:((r,e,t)=>{var n=t(741);r.exports=function(i){var s=+i;return s!==s||s===0?0:n(s)}}),1385:((r,e,t)=>{var n=t(9539);r.exports=function(i,s,o){for(var a=i.length-1;a>=0;a--)if(i[a]!==void 0)try{o=n(i[a].iterator,s,o)}catch(l){s="throw",o=l}if(s==="throw")throw o;return o}}),1548:((r,e,t)=>{var n=t(4576),i=t(9039),s=t(9519),o=t(4215),a=n.structuredClone;r.exports=!!a&&!i(function(){if(o==="DENO"&&s>92||o==="NODE"&&s>94||o==="BROWSER"&&s>97)return!1;var l=new ArrayBuffer(8),u=a(l,{transfer:[l]});return l.byteLength!==0||u.byteLength!==8})}),1549:((r,e,t)=>{t(6632)}),1625:((r,e,t)=>{var n=t(9504);r.exports=n({}.isPrototypeOf)}),1689:((r,e,t)=>{var n=t(6518),i=t(4576),s=t(8745),o=t(7680),a=t(6043),l=t(9306),u=t(1103),h=i.Promise,m=!1,g=!h||!h.try||u(function(){h.try(function(v){m=v===8},8)}).error||!m;n({target:"Promise",stat:!0,forced:g},{try:function(v){var y=arguments.length>1?o(arguments,1):[],A=a.f(this),x=u(function(){return s(l(v),void 0,y)});return(x.error?A.reject:A.resolve)(x.value),A.promise}})}),1698:((r,e,t)=>{var n=t(6518),i=t(4204),s=t(9835),o=t(4916),a=!o("union")||!s("union");n({target:"Set",proto:!0,real:!0,forced:a},{union:i})}),1701:((r,e,t)=>{var n=t(6518),i=t(9565),s=t(9306),o=t(8551),a=t(1767),l=t(9462),u=t(6319),h=t(9539),m=t(684),g=t(4549),v=t(6395),y=!v&&!m("map",function(){}),A=!v&&!y&&g("map",TypeError),x=v||y||A,b=l(function(){var w=this.iterator,T=o(i(this.next,w)),k=this.done=!!T.done;if(!k)return u(w,this.mapper,[T.value,this.counter++],!0)});n({target:"Iterator",proto:!0,real:!0,forced:x},{map:function(T){o(this);try{s(T)}catch(k){h(this,"throw",k)}return A?i(A,this,T):new b(a(this),{mapper:T})}})}),1767:(r=>{r.exports=function(e){return{iterator:e,next:e.next,done:!1}}}),1828:((r,e,t)=>{var n=t(9504),i=t(9297),s=t(5397),o=t(9617).indexOf,a=t(421),l=n([].push);r.exports=function(u,h){var m=s(u),g=0,v=[],y;for(y in m)!i(a,y)&&i(m,y)&&l(v,y);for(;h.length>g;)i(m,y=h[g++])&&(~o(v,y)||l(v,y));return v}}),2106:((r,e,t)=>{var n=t(283),i=t(4913);r.exports=function(s,o,a){return a.get&&n(a.get,o,{getter:!0}),a.set&&n(a.set,o,{setter:!0}),i.f(s,o,a)}}),2140:((r,e,t)=>{var n=t(8227),i=n("toStringTag"),s={};s[i]="z",r.exports=String(s)==="[object z]"}),2195:((r,e,t)=>{var n=t(9504),i=n({}.toString),s=n("".slice);r.exports=function(o){return s(i(o),8,-1)}}),2211:((r,e,t)=>{var n=t(9039);r.exports=!n(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})}),2303:((r,e,t)=>{var n=t(4576),i=t(9504),s=n.Uint8Array,o=n.SyntaxError,a=n.parseInt,l=Math.min,u=/[^\da-f]/i,h=i(u.exec),m=i("".slice);r.exports=function(g,v){var y=g.length;if(y%2!==0)throw new o("String should be an even number of characters");for(var A=v?l(v.length,y/2):y/2,x=v||new s(A),b=0,w=0;w<A;){var T=m(g,b,b+=2);if(h(u,T))throw new o("String should only contain hex characters");x[w++]=a(T,16)}return{bytes:x,read:b}}}),2360:((r,e,t)=>{var n=t(8551),i=t(6801),s=t(8727),o=t(421),a=t(397),l=t(4055),u=t(6119),h=">",m="<",g="prototype",v="script",y=u("IE_PROTO"),A=function(){},x=function(I){return m+v+h+I+m+"/"+v+h},b=function(I){I.write(x("")),I.close();var M=I.parentWindow.Object;return I=null,M},w=function(){var I=l("iframe"),M="java"+v+":",L;return I.style.display="none",a.appendChild(I),I.src=String(M),L=I.contentWindow.document,L.open(),L.write(x("document.F=Object")),L.close(),L.F},T,k=function(){try{T=new ActiveXObject("htmlfile")}catch{}k=typeof document<"u"?document.domain&&T?b(T):w():b(T);for(var I=s.length;I--;)delete k[g][s[I]];return k()};o[y]=!0,r.exports=Object.create||function(M,L){var j;return M!==null?(A[g]=n(M),j=new A,A[g]=null,j[y]=M):j=k(),L===void 0?j:i.f(j,L)}}),2475:((r,e,t)=>{var n=t(6518),i=t(8527),s=t(4916),o=!s("isSupersetOf",function(a){return!a});n({target:"Set",proto:!0,real:!0,forced:o},{isSupersetOf:i})}),2489:((r,e,t)=>{var n=t(6518),i=t(9565),s=t(9306),o=t(8551),a=t(1767),l=t(9462),u=t(6319),h=t(6395),m=t(9539),g=t(684),v=t(4549),y=!h&&!g("filter",function(){}),A=!h&&!y&&v("filter",TypeError),x=h||y||A,b=l(function(){for(var w=this.iterator,T=this.predicate,k=this.next,I,M,L;;){if(I=o(i(k,w)),M=this.done=!!I.done,M)return;if(L=I.value,u(w,T,[L,this.counter++],!0))return L}});n({target:"Iterator",proto:!0,real:!0,forced:x},{filter:function(T){o(this);try{s(T)}catch(k){m(this,"throw",k)}return A?i(A,this,T):new b(a(this),{predicate:T})}})}),2529:(r=>{r.exports=function(e,t){return{value:e,done:t}}}),2603:((r,e,t)=>{var n=t(655);r.exports=function(i,s){return i===void 0?arguments.length<2?"":s:n(i)}}),2652:((r,e,t)=>{var n=t(6080),i=t(9565),s=t(8551),o=t(6823),a=t(4209),l=t(6198),u=t(1625),h=t(81),m=t(851),g=t(9539),v=TypeError,y=function(x,b){this.stopped=x,this.result=b},A=y.prototype;r.exports=function(x,b,w){var T=w&&w.that,k=!!(w&&w.AS_ENTRIES),I=!!(w&&w.IS_RECORD),M=!!(w&&w.IS_ITERATOR),L=!!(w&&w.INTERRUPTED),j=n(b,T),B,z,Z,$,U,Y,ee,X=function(G){return B&&g(B,"normal"),new y(!0,G)},re=function(G){return k?(s(G),L?j(G[0],G[1],X):j(G[0],G[1])):L?j(G,X):j(G)};if(I)B=x.iterator;else if(M)B=x;else{if(z=m(x),!z)throw new v(o(x)+" is not iterable");if(a(z)){for(Z=0,$=l(x);$>Z;Z++)if(U=re(x[Z]),U&&u(A,U))return U;return new y(!1)}B=h(x,z)}for(Y=I?x.next:B.next;!(ee=i(Y,B)).done;){try{U=re(ee.value)}catch(G){g(B,"throw",G)}if(typeof U=="object"&&U&&u(A,U))return U}return new y(!1)}}),2777:((r,e,t)=>{var n=t(9565),i=t(34),s=t(757),o=t(5966),a=t(4270),l=t(8227),u=TypeError,h=l("toPrimitive");r.exports=function(m,g){if(!i(m)||s(m))return m;var v=o(m,h),y;if(v){if(g===void 0&&(g="default"),y=n(v,m,g),!i(y)||s(y))return y;throw new u("Can't convert object to primitive value")}return g===void 0&&(g="number"),a(m,g)}}),2787:((r,e,t)=>{var n=t(9297),i=t(4901),s=t(8981),o=t(6119),a=t(2211),l=o("IE_PROTO"),u=Object,h=u.prototype;r.exports=a?u.getPrototypeOf:function(m){var g=s(m);if(n(g,l))return g[l];var v=g.constructor;return i(v)&&g instanceof v?v.prototype:g instanceof u?h:null}}),2796:((r,e,t)=>{var n=t(9039),i=t(4901),s=/#|\.prototype\./,o=function(m,g){var v=l[a(m)];return v===h?!0:v===u?!1:i(g)?n(g):!!g},a=o.normalize=function(m){return String(m).replace(s,".").toLowerCase()},l=o.data={},u=o.NATIVE="N",h=o.POLYFILL="P";r.exports=o}),2804:(r=>{var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=e+"+/",n=e+"-_",i=function(s){for(var o={},a=0;a<64;a++)o[s.charAt(a)]=a;return o};r.exports={i2c:t,c2i:i(t),i2cUrl:n,c2iUrl:i(n)}}),2812:(r=>{var e=TypeError;r.exports=function(t,n){if(t<n)throw new e("Not enough arguments");return t}}),2839:((r,e,t)=>{var n=t(4576),i=n.navigator,s=i&&i.userAgent;r.exports=s?String(s):""}),2967:((r,e,t)=>{var n=t(6706),i=t(34),s=t(7750),o=t(3506);r.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var a=!1,l={},u;try{u=n(Object.prototype,"__proto__","set"),u(l,[]),a=l instanceof Array}catch{}return function(m,g){return s(m),o(g),i(m)&&(a?u(m,g):m.__proto__=g),m}})():void 0)}),3068:((r,e,t)=>{var n=t(6518),i=t(9504),s=t(2652),o=RangeError,a=TypeError,l=1/0,u=NaN,h=Math.abs,m=Math.pow,g=i([].push),v=m(2,1023),y=m(2,53)-1,A=Number.MAX_VALUE,x=m(2,971),b={},w={},T={},k={},I={},M=function(L,j){var B=L+j,z=j-(B-L);return{hi:B,lo:z}};n({target:"Math",stat:!0},{sumPrecise:function(j){var B=[],z=0,Z=k;switch(s(j,function(se){if(++z>=y)throw new o("Maximum allowed index exceeded");if(typeof se!="number")throw new a("Value is not a number");Z!==b&&(se!==se?Z=b:se===l?Z=Z===w?b:T:se===-l?Z=Z===T?b:w:(se!==0||1/se===l)&&(Z===k||Z===I)&&(Z=I,g(B,se)))}),Z){case b:return u;case w:return-l;case T:return l;case k:return-0}for(var $=[],U=0,Y,ee,X,re,G,J,ne=0;ne<B.length;ne++){Y=B[ne];for(var W=0,V=0;V<$.length;V++){if(ee=$[V],h(Y)<h(ee)&&(J=Y,Y=ee,ee=J),X=M(Y,ee),re=X.hi,G=X.lo,h(re)===l){var ce=re===l?1:-1;U+=ce,Y=Y-ce*v-ce*v,h(Y)<h(ee)&&(J=Y,Y=ee,ee=J),X=M(Y,ee),re=X.hi,G=X.lo}G!==0&&($[W++]=G),Y=re}$.length=W,Y!==0&&g($,Y)}var ue=$.length-1;if(re=0,G=0,U!==0){var ve=ue>=0?$[ue]:0;if(ue--,h(U)>1||U>0&&ve>0||U<0&&ve<0)return U>0?l:-l;if(X=M(U*v,ve/2),re=X.hi,G=X.lo,G*=2,h(2*re)===l)return re>0?re===v&&G===-(x/2)&&ue>=0&&$[ue]<0?A:l:re===-v&&G===x/2&&ue>=0&&$[ue]>0?-A:-l;G!==0&&($[++ue]=G,G=0),re*=2}for(;ue>=0&&(X=M(re,$[ue--]),re=X.hi,G=X.lo,G===0););return ue>=0&&(G<0&&$[ue]<0||G>0&&$[ue]>0)&&(ee=G*2,Y=re+ee,ee===Y-re&&(re=Y)),re}})}),3167:((r,e,t)=>{var n=t(4901),i=t(34),s=t(2967);r.exports=function(o,a,l){var u,h;return s&&n(u=a.constructor)&&u!==l&&i(h=u.prototype)&&h!==l.prototype&&s(o,h),o}}),3238:((r,e,t)=>{var n=t(4576),i=t(7811),s=t(7394),o=n.DataView;r.exports=function(a){if(!i||s(a)!==0)return!1;try{return new o(a),!1}catch{return!0}}}),3392:((r,e,t)=>{var n=t(9504),i=0,s=Math.random(),o=n(1.1.toString);r.exports=function(a){return"Symbol("+(a===void 0?"":a)+")_"+o(++i+s,36)}}),3440:((r,e,t)=>{var n=t(7080),i=t(4402),s=t(9286),o=t(5170),a=t(3789),l=t(8469),u=t(507),h=i.has,m=i.remove;r.exports=function(v){var y=n(this),A=a(v),x=s(y);return o(y)<=A.size?l(y,function(b){A.includes(b)&&m(x,b)}):u(A.getIterator(),function(b){h(x,b)&&m(x,b)}),x}}),3463:(r=>{var e=TypeError;r.exports=function(t){if(typeof t=="string")return t;throw new e("Argument is not a string")}}),3506:((r,e,t)=>{var n=t(3925),i=String,s=TypeError;r.exports=function(o){if(n(o))return o;throw new s("Can't set "+i(o)+" as a prototype")}}),3579:((r,e,t)=>{var n=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),u=t(9539),h=t(4549),m=h("some",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:m},{some:function(v){a(this);try{o(v)}catch(x){u(this,"throw",x)}if(m)return i(m,this,v);var y=l(this),A=0;return s(y,function(x,b){if(v(x,A++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),3650:((r,e,t)=>{var n=t(7080),i=t(4402),s=t(9286),o=t(3789),a=t(507),l=i.add,u=i.has,h=i.remove;r.exports=function(g){var v=n(this),y=o(g).getIterator(),A=s(v);return a(y,function(x){u(v,x)?h(A,x):l(A,x)}),A}}),3706:((r,e,t)=>{var n=t(9504),i=t(4901),s=t(7629),o=n(Function.toString);i(s.inspectSource)||(s.inspectSource=function(a){return o(a)}),r.exports=s.inspectSource}),3717:((r,e)=>{e.f=Object.getOwnPropertySymbols}),3724:((r,e,t)=>{var n=t(9039);r.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})}),3789:((r,e,t)=>{var n=t(9306),i=t(8551),s=t(9565),o=t(1291),a=t(1767),l="Invalid size",u=RangeError,h=TypeError,m=Math.max,g=function(v,y){this.set=v,this.size=m(y,0),this.has=n(v.has),this.keys=n(v.keys)};g.prototype={getIterator:function(){return a(i(s(this.keys,this.set)))},includes:function(v){return s(this.has,this.set,v)}},r.exports=function(v){i(v);var y=+v.size;if(y!==y)throw new h(l);var A=o(y);if(A<0)throw new u(l);return new g(v,A)}}),3838:((r,e,t)=>{var n=t(7080),i=t(5170),s=t(8469),o=t(3789);r.exports=function(l){var u=n(this),h=o(l);return i(u)>h.size?!1:s(u,function(m){if(!h.includes(m))return!1},!0)!==!1}}),3853:((r,e,t)=>{var n=t(6518),i=t(4449),s=t(4916),o=!s("isDisjointFrom",function(a){return!a});n({target:"Set",proto:!0,real:!0,forced:o},{isDisjointFrom:i})}),3925:((r,e,t)=>{var n=t(34);r.exports=function(i){return n(i)||i===null}}),3972:((r,e,t)=>{var n=t(34),i=String,s=TypeError;r.exports=function(o){if(o===void 0||n(o))return o;throw new s(i(o)+" is not an object or undefined")}}),4055:((r,e,t)=>{var n=t(4576),i=t(34),s=n.document,o=i(s)&&i(s.createElement);r.exports=function(a){return o?s.createElement(a):{}}}),4114:((r,e,t)=>{var n=t(6518),i=t(8981),s=t(6198),o=t(4527),a=t(6837),l=t(9039),u=l(function(){return[].push.call({length:4294967296},1)!==4294967297}),h=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(g){return g instanceof TypeError}},m=u||!h();n({target:"Array",proto:!0,arity:1,forced:m},{push:function(v){var y=i(this),A=s(y),x=arguments.length;a(A+x);for(var b=0;b<x;b++)y[A]=arguments[b],A++;return o(y,A),A}})}),4117:(r=>{r.exports=function(e){return e==null}}),4149:(r=>{var e=RangeError;r.exports=function(t){if(t===t)return t;throw new e("NaN is not allowed")}}),4154:((r,e,t)=>{var n=t(6955),i=TypeError;r.exports=function(s){if(n(s)==="Uint8Array")return s;throw new i("Argument is not an Uint8Array")}}),4204:((r,e,t)=>{var n=t(7080),i=t(4402).add,s=t(9286),o=t(3789),a=t(507);r.exports=function(u){var h=n(this),m=o(u).getIterator(),g=s(h);return a(m,function(v){i(g,v)}),g}}),4209:((r,e,t)=>{var n=t(8227),i=t(6269),s=n("iterator"),o=Array.prototype;r.exports=function(a){return a!==void 0&&(i.Array===a||o[s]===a)}}),4215:((r,e,t)=>{var n=t(4576),i=t(2839),s=t(2195),o=function(a){return i.slice(0,a.length)===a};r.exports=(function(){return o("Bun/")?"BUN":o("Cloudflare-Workers")?"CLOUDFLARE":o("Deno/")?"DENO":o("Node.js/")?"NODE":n.Bun&&typeof Bun.version=="string"?"BUN":n.Deno&&typeof Deno.version=="object"?"DENO":s(n.process)==="process"?"NODE":n.window&&n.document?"BROWSER":"REST"})()}),4226:((r,e,t)=>{var n=t(6518),i=t(4576),s=t(3463),o=t(4154),a=t(5169),l=t(2303);i.Uint8Array&&n({target:"Uint8Array",proto:!0},{setFromHex:function(h){o(this),s(h),a(this.buffer);var m=l(h,this).read;return{read:m,written:m/2}}})}),4235:((r,e,t)=>{t(3068)}),4270:((r,e,t)=>{var n=t(9565),i=t(4901),s=t(34),o=TypeError;r.exports=function(a,l){var u,h;if(l==="string"&&i(u=a.toString)&&!s(h=n(u,a))||i(u=a.valueOf)&&!s(h=n(u,a))||l!=="string"&&i(u=a.toString)&&!s(h=n(u,a)))return h;throw new o("Can't convert object to primitive value")}}),4376:((r,e,t)=>{var n=t(2195);r.exports=Array.isArray||function(s){return n(s)==="Array"}}),4402:((r,e,t)=>{var n=t(9504),i=Set.prototype;r.exports={Set,add:n(i.add),has:n(i.has),remove:n(i.delete),proto:i}}),4449:((r,e,t)=>{var n=t(7080),i=t(4402).has,s=t(5170),o=t(3789),a=t(8469),l=t(507),u=t(9539);r.exports=function(m){var g=n(this),v=o(m);if(s(g)<=v.size)return a(g,function(A){if(v.includes(A))return!1},!0)!==!1;var y=v.getIterator();return l(y,function(A){if(i(g,A))return u(y,"normal",!1)})!==!1}}),4483:((r,e,t)=>{var n=t(4576),i=t(9429),s=t(1548),o=n.structuredClone,a=n.ArrayBuffer,l=n.MessageChannel,u=!1,h,m,g,v;if(s)u=function(y){o(y,{transfer:[y]})};else if(a)try{l||(h=i("worker_threads"),h&&(l=h.MessageChannel)),l&&(m=new l,g=new a(2),v=function(y){m.port1.postMessage(null,[y])},g.byteLength===2&&(v(g),g.byteLength===0&&(u=v)))}catch{}r.exports=u}),4495:((r,e,t)=>{var n=t(9519),i=t(9039),s=t(4576),o=s.String;r.exports=!!Object.getOwnPropertySymbols&&!i(function(){var a=Symbol("symbol detection");return!o(a)||!(Object(a)instanceof Symbol)||!Symbol.sham&&n&&n<41})}),4527:((r,e,t)=>{var n=t(3724),i=t(4376),s=TypeError,o=Object.getOwnPropertyDescriptor,a=n&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(l){return l instanceof TypeError}})();r.exports=a?function(l,u){if(i(l)&&!o(l,"length").writable)throw new s("Cannot set read only .length");return l.length=u}:function(l,u){return l.length=u}}),4549:((r,e,t)=>{var n=t(4576);r.exports=function(i,s){var o=n.Iterator,a=o&&o.prototype,l=a&&a[i],u=!1;if(l)try{l.call({next:function(){return{done:!0}},return:function(){u=!0}},-1)}catch(h){h instanceof s||(u=!1)}if(!u)return l}}),4576:(function(r){var e=function(t){return t&&t.Math===Math&&t};r.exports=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof global=="object"&&global)||e(typeof this=="object"&&this)||(function(){return this})()||Function("return this")()}),4603:((r,e,t)=>{var n=t(6840),i=t(9504),s=t(655),o=t(2812),a=URLSearchParams,l=a.prototype,u=i(l.append),h=i(l.delete),m=i(l.forEach),g=i([].push),v=new a("a=1&a=2&b=3");v.delete("a",1),v.delete("b",void 0),v+""!="a=2"&&n(l,"delete",function(y){var A=arguments.length,x=A<2?void 0:arguments[1];if(A&&x===void 0)return h(this,y);var b=[];m(this,function(B,z){g(b,{key:z,value:B})}),o(A,1);for(var w=s(y),T=s(x),k=0,I=0,M=!1,L=b.length,j;k<L;)j=b[k++],M||j.key===w?(M=!0,h(this,j.key)):I++;for(;I<L;)j=b[I++],j.key===w&&j.value===T||u(this,j.key,j.value)},{enumerable:!0,unsafe:!0})}),4628:((r,e,t)=>{var n=t(6518),i=t(6043);n({target:"Promise",stat:!0},{withResolvers:function(){var o=i.f(this);return{promise:o.promise,resolve:o.resolve,reject:o.reject}}})}),4644:((r,e,t)=>{var n=t(7811),i=t(3724),s=t(4576),o=t(4901),a=t(34),l=t(9297),u=t(6955),h=t(6823),m=t(6699),g=t(6840),v=t(2106),y=t(1625),A=t(2787),x=t(2967),b=t(8227),w=t(3392),T=t(1181),k=T.enforce,I=T.get,M=s.Int8Array,L=M&&M.prototype,j=s.Uint8ClampedArray,B=j&&j.prototype,z=M&&A(M),Z=L&&A(L),$=Object.prototype,U=s.TypeError,Y=b("toStringTag"),ee=w("TYPED_ARRAY_TAG"),X="TypedArrayConstructor",re=n&&!!x&&u(s.opera)!=="Opera",G=!1,J,ne,W,V={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},ce={BigInt64Array:8,BigUint64Array:8},ue=function(Be){if(!a(Be))return!1;var Fe=u(Be);return Fe==="DataView"||l(V,Fe)||l(ce,Fe)},ve=function(pe){var Be=A(pe);if(a(Be)){var Fe=I(Be);return Fe&&l(Fe,X)?Fe[X]:ve(Be)}},se=function(pe){if(!a(pe))return!1;var Be=u(pe);return l(V,Be)||l(ce,Be)},F=function(pe){if(se(pe))return pe;throw new U("Target is not a typed array")},te=function(pe){if(o(pe)&&(!x||y(z,pe)))return pe;throw new U(h(pe)+" is not a typed array constructor")},ge=function(pe,Be,Fe,ye){if(i){if(Fe)for(var _e in V){var de=s[_e];if(de&&l(de.prototype,pe))try{delete de.prototype[pe]}catch{try{de.prototype[pe]=Be}catch{}}}(!Z[pe]||Fe)&&g(Z,pe,Fe?Be:re&&L[pe]||Be,ye)}},oe=function(pe,Be,Fe){var ye,_e;if(i){if(x){if(Fe){for(ye in V)if(_e=s[ye],_e&&l(_e,pe))try{delete _e[pe]}catch{}}if(!z[pe]||Fe)try{return g(z,pe,Fe?Be:re&&z[pe]||Be)}catch{}else return}for(ye in V)_e=s[ye],_e&&(!_e[pe]||Fe)&&g(_e,pe,Be)}};for(J in V)ne=s[J],W=ne&&ne.prototype,W?k(W)[X]=ne:re=!1;for(J in ce)ne=s[J],W=ne&&ne.prototype,W&&(k(W)[X]=ne);if((!re||!o(z)||z===Function.prototype)&&(z=function(){throw new U("Incorrect invocation")},re))for(J in V)s[J]&&x(s[J],z);if((!re||!Z||Z===$)&&(Z=z.prototype,re))for(J in V)s[J]&&x(s[J].prototype,Z);if(re&&A(B)!==Z&&x(B,Z),i&&!l(Z,Y)){G=!0,v(Z,Y,{configurable:!0,get:function(){return a(this)?this[ee]:void 0}});for(J in V)s[J]&&m(s[J],ee,J)}r.exports={NATIVE_ARRAY_BUFFER_VIEWS:re,TYPED_ARRAY_TAG:G&&ee,aTypedArray:F,aTypedArrayConstructor:te,exportTypedArrayMethod:ge,exportTypedArrayStaticMethod:oe,getTypedArrayConstructor:ve,isView:ue,isTypedArray:se,TypedArray:z,TypedArrayPrototype:Z}}),4659:((r,e,t)=>{var n=t(3724),i=t(4913),s=t(6980);r.exports=function(o,a,l){n?i.f(o,a,s(0,l)):o[a]=l}}),4901:(r=>{var e=typeof document=="object"&&document.all;r.exports=typeof e>"u"&&e!==void 0?function(t){return typeof t=="function"||t===e}:function(t){return typeof t=="function"}}),4913:((r,e,t)=>{var n=t(3724),i=t(5917),s=t(8686),o=t(8551),a=t(6969),l=TypeError,u=Object.defineProperty,h=Object.getOwnPropertyDescriptor,m="enumerable",g="configurable",v="writable";e.f=n?s?function(A,x,b){if(o(A),x=a(x),o(b),typeof A=="function"&&x==="prototype"&&"value"in b&&v in b&&!b[v]){var w=h(A,x);w&&w[v]&&(A[x]=b.value,b={configurable:g in b?b[g]:w[g],enumerable:m in b?b[m]:w[m],writable:!1})}return u(A,x,b)}:u:function(A,x,b){if(o(A),x=a(x),o(b),i)try{return u(A,x,b)}catch{}if("get"in b||"set"in b)throw new l("Accessors not supported");return"value"in b&&(A[x]=b.value),A}}),4916:((r,e,t)=>{var n=t(7751),i=function(o){return{size:o,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},s=function(o){return{size:o,has:function(){return!0},keys:function(){throw new Error("e")}}};r.exports=function(o,a){var l=n("Set");try{new l()[o](i(0));try{return new l()[o](i(-1)),!1}catch{if(!a)return!0;try{return new l()[o](s(-1/0)),!1}catch{var u=new l([1,2]);return a(u[o](s(1/0)))}}}catch{return!1}}}),4972:((r,e,t)=>{var n=t(6518),i=t(9565),s=t(8551),o=t(1767),a=t(4149),l=t(9590),u=t(9462),h=t(9539),m=t(4549),g=t(6395),v=!g&&m("take",RangeError),y=u(function(){var A=this.iterator;if(!this.remaining--)return this.done=!0,h(A,"normal",void 0);var x=s(i(this.next,A)),b=this.done=!!x.done;if(!b)return x.value});n({target:"Iterator",proto:!0,real:!0,forced:g||v},{take:function(x){s(this);var b;try{b=l(a(+x))}catch(w){h(this,"throw",w)}return v?i(v,this,b):new y(o(this),{remaining:b})}})}),4979:((r,e,t)=>{var n=t(6518),i=t(4576),s=t(7751),o=t(6980),a=t(4913).f,l=t(9297),u=t(679),h=t(3167),m=t(2603),g=t(5002),v=t(8574),y=t(3724),A=t(6395),x="DOMException",b=s("Error"),w=s(x),T=function(){u(this,k);var X=arguments.length,re=m(X<1?void 0:arguments[0]),G=m(X<2?void 0:arguments[1],"Error"),J=new w(re,G),ne=new b(re);return ne.name=x,a(J,"stack",o(1,v(ne.stack,1))),h(J,this,T),J},k=T.prototype=w.prototype,I="stack"in new b(x),M="stack"in new w(1,2),L=w&&y&&Object.getOwnPropertyDescriptor(i,x),j=!!L&&!(L.writable&&L.configurable),B=I&&!j&&!M;n({global:!0,constructor:!0,forced:A||B},{DOMException:B?T:w});var z=s(x),Z=z.prototype;if(Z.constructor!==z){A||a(Z,"constructor",o(1,z));for(var $ in g)if(l(g,$)){var U=g[$],Y=U.s;l(z,Y)||a(z,Y,o(6,U.c))}}}),5002:(r=>{r.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}}),5024:((r,e,t)=>{var n=t(6518),i=t(3650),s=t(9835),o=t(4916),a=!o("symmetricDifference")||!s("symmetricDifference");n({target:"Set",proto:!0,real:!0,forced:a},{symmetricDifference:i})}),5031:((r,e,t)=>{var n=t(7751),i=t(9504),s=t(8480),o=t(3717),a=t(8551),l=i([].concat);r.exports=n("Reflect","ownKeys")||function(h){var m=s.f(a(h)),g=o.f;return g?l(m,g(h)):m}}),5169:((r,e,t)=>{var n=t(3238),i=TypeError;r.exports=function(s){if(n(s))throw new i("ArrayBuffer is detached");return s}}),5170:((r,e,t)=>{var n=t(6706),i=t(4402);r.exports=n(i.proto,"size","get")||function(s){return s.size}}),5213:((r,e,t)=>{var n=t(6518),i=t(4576),s=t(5370),o=t(9143),a=i.Uint8Array,l=!a||!a.fromBase64||!(function(){try{a.fromBase64("a");return}catch{}try{a.fromBase64("",null)}catch{return!0}})();a&&n({target:"Uint8Array",stat:!0,forced:l},{fromBase64:function(h){var m=o(h,arguments.length>1?arguments[1]:void 0,null,9007199254740991);return s(a,m.bytes)}})}),5370:((r,e,t)=>{var n=t(6198);r.exports=function(i,s,o){for(var a=0,l=arguments.length>2?o:n(s),u=new i(l);l>a;)u[a]=s[a++];return u}}),5397:((r,e,t)=>{var n=t(7055),i=t(7750);r.exports=function(s){return n(i(s))}}),5610:((r,e,t)=>{var n=t(1291),i=Math.max,s=Math.min;r.exports=function(o,a){var l=n(o);return l<0?i(l+a,0):s(l,a)}}),5623:((r,e,t)=>{t(456)}),5636:((r,e,t)=>{var n=t(4576),i=t(9504),s=t(6706),o=t(7696),a=t(5169),l=t(7394),u=t(4483),h=t(1548),m=n.structuredClone,g=n.ArrayBuffer,v=n.DataView,y=Math.min,A=g.prototype,x=v.prototype,b=i(A.slice),w=s(A,"resizable","get"),T=s(A,"maxByteLength","get"),k=i(x.getInt8),I=i(x.setInt8);r.exports=(h||u)&&function(M,L,j){var B=l(M),z=L===void 0?B:o(L),Z=!w||!w(M),$;if(a(M),h&&(M=m(M,{transfer:[M]}),B===z&&(j||Z)))return M;if(B>=z&&(!j||Z))$=b(M,0,z);else{var U=j&&!Z&&T?{maxByteLength:T(M)}:void 0;$=new g(z,U);for(var Y=new v(M),ee=new v($),X=y(z,B),re=0;re<X;re++)I(ee,re,k(Y,re))}return h||u(M),$}}),5745:((r,e,t)=>{var n=t(7629);r.exports=function(i,s){return n[i]||(n[i]=s||{})}}),5781:((r,e,t)=>{var n=t(6518),i=t(7751),s=t(2812),o=t(655),a=t(7416),l=i("URL");n({target:"URL",stat:!0,forced:!a},{parse:function(h){var m=s(arguments.length,1),g=o(h),v=m<2||arguments[1]===void 0?void 0:o(arguments[1]);try{return new l(g,v)}catch{return null}}})}),5854:((r,e,t)=>{var n=t(2777),i=TypeError;r.exports=function(s){var o=n(s,"number");if(typeof o=="number")throw new i("Can't convert number to bigint");return BigInt(o)}}),5876:((r,e,t)=>{var n=t(6518),i=t(3838),s=t(4916),o=!s("isSubsetOf",function(a){return a});n({target:"Set",proto:!0,real:!0,forced:o},{isSubsetOf:i})}),5917:((r,e,t)=>{var n=t(3724),i=t(9039),s=t(4055);r.exports=!n&&!i(function(){return Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a!==7})}),5966:((r,e,t)=>{var n=t(9306),i=t(4117);r.exports=function(s,o){var a=s[o];return i(a)?void 0:n(a)}}),6043:((r,e,t)=>{var n=t(9306),i=TypeError,s=function(o){var a,l;this.promise=new o(function(u,h){if(a!==void 0||l!==void 0)throw new i("Bad Promise constructor");a=u,l=h}),this.resolve=n(a),this.reject=n(l)};r.exports.f=function(o){return new s(o)}}),6080:((r,e,t)=>{var n=t(7476),i=t(9306),s=t(616),o=n(n.bind);r.exports=function(a,l){return i(a),l===void 0?a:s?o(a,l):function(){return a.apply(l,arguments)}}}),6119:((r,e,t)=>{var n=t(5745),i=t(3392),s=n("keys");r.exports=function(o){return s[o]||(s[o]=i(o))}}),6193:((r,e,t)=>{var n=t(4215);r.exports=n==="NODE"}),6198:((r,e,t)=>{var n=t(8014);r.exports=function(i){return n(i.length)}}),6269:(r=>{r.exports={}}),6279:((r,e,t)=>{var n=t(6840);r.exports=function(i,s,o){for(var a in s)n(i,a,s[a],o);return i}}),6319:((r,e,t)=>{var n=t(8551),i=t(9539);r.exports=function(s,o,a,l){try{return l?o(n(a)[0],a[1]):o(a)}catch(u){i(s,"throw",u)}}}),6395:(r=>{r.exports=!1}),6518:((r,e,t)=>{var n=t(4576),i=t(7347).f,s=t(6699),o=t(6840),a=t(9433),l=t(7740),u=t(2796);r.exports=function(h,m){var g=h.target,v=h.global,y=h.stat,A,x,b,w,T,k;if(v?x=n:y?x=n[g]||a(g,{}):x=n[g]&&n[g].prototype,x)for(b in m){if(T=m[b],h.dontCallGetSet?(k=i(x,b),w=k&&k.value):w=x[b],A=u(v?b:g+(y?".":"#")+b,h.forced),!A&&w!==void 0){if(typeof T==typeof w)continue;l(T,w)}(h.sham||w&&w.sham)&&s(T,"sham",!0),o(x,b,T,h)}}}),6573:((r,e,t)=>{var n=t(3724),i=t(2106),s=t(3238),o=ArrayBuffer.prototype;n&&!("detached"in o)&&i(o,"detached",{configurable:!0,get:function(){return s(this)}})}),6632:((r,e,t)=>{var n=t(6518),i=t(4576),s=t(9143),o=t(4154),a=i.Uint8Array,l=!a||!a.prototype.setFromBase64||!(function(){var u=new a([255,255,255,255,255]);try{u.setFromBase64("",null);return}catch{}try{u.setFromBase64("a");return}catch{}try{u.setFromBase64("MjYyZg===")}catch{return u[0]===50&&u[1]===54&&u[2]===50&&u[3]===255&&u[4]===255}})();a&&n({target:"Uint8Array",proto:!0,forced:l},{setFromBase64:function(h){o(this);var m=s(h,arguments.length>1?arguments[1]:void 0,this,this.length);return{read:m.read,written:m.written}}})}),6699:((r,e,t)=>{var n=t(3724),i=t(4913),s=t(6980);r.exports=n?function(o,a,l){return i.f(o,a,s(1,l))}:function(o,a,l){return o[a]=l,o}}),6706:((r,e,t)=>{var n=t(9504),i=t(9306);r.exports=function(s,o,a){try{return n(i(Object.getOwnPropertyDescriptor(s,o)[a]))}catch{}}}),6801:((r,e,t)=>{var n=t(3724),i=t(8686),s=t(4913),o=t(8551),a=t(5397),l=t(1072);e.f=n&&!i?Object.defineProperties:function(h,m){o(h);for(var g=a(m),v=l(m),y=v.length,A=0,x;y>A;)s.f(h,x=v[A++],g[x]);return h}}),6823:(r=>{var e=String;r.exports=function(t){try{return e(t)}catch{return"Object"}}}),6837:(r=>{var e=TypeError,t=9007199254740991;r.exports=function(n){if(n>t)throw e("Maximum allowed index exceeded");return n}}),6840:((r,e,t)=>{var n=t(4901),i=t(4913),s=t(283),o=t(9433);r.exports=function(a,l,u,h){h||(h={});var m=h.enumerable,g=h.name!==void 0?h.name:l;if(n(u)&&s(u,g,h),h.global)m?a[l]=u:o(l,u);else{try{h.unsafe?a[l]&&(m=!0):delete a[l]}catch{}m?a[l]=u:i.f(a,l,{value:u,enumerable:!1,configurable:!h.nonConfigurable,writable:!h.nonWritable})}return a}}),6955:((r,e,t)=>{var n=t(2140),i=t(4901),s=t(2195),o=t(8227),a=o("toStringTag"),l=Object,u=s((function(){return arguments})())==="Arguments",h=function(m,g){try{return m[g]}catch{}};r.exports=n?s:function(m){var g,v,y;return m===void 0?"Undefined":m===null?"Null":typeof(v=h(g=l(m),a))=="string"?v:u?s(g):(y=s(g))==="Object"&&i(g.callee)?"Arguments":y}}),6969:((r,e,t)=>{var n=t(2777),i=t(757);r.exports=function(s){var o=n(s,"string");return i(o)?o:o+""}}),6980:(r=>{r.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}}),7040:((r,e,t)=>{var n=t(4495);r.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}),7055:((r,e,t)=>{var n=t(9504),i=t(9039),s=t(2195),o=Object,a=n("".split);r.exports=i(function(){return!o("z").propertyIsEnumerable(0)})?function(l){return s(l)==="String"?a(l,""):o(l)}:o}),7080:((r,e,t)=>{var n=t(4402).has;r.exports=function(i){return n(i),i}}),7347:((r,e,t)=>{var n=t(3724),i=t(9565),s=t(8773),o=t(6980),a=t(5397),l=t(6969),u=t(9297),h=t(5917),m=Object.getOwnPropertyDescriptor;e.f=n?m:function(v,y){if(v=a(v),y=l(y),h)try{return m(v,y)}catch{}if(u(v,y))return o(!i(s.f,v,y),v[y])}}),7394:((r,e,t)=>{var n=t(4576),i=t(6706),s=t(2195),o=n.ArrayBuffer,a=n.TypeError;r.exports=o&&i(o.prototype,"byteLength","get")||function(l){if(s(l)!=="ArrayBuffer")throw new a("ArrayBuffer expected");return l.byteLength}}),7416:((r,e,t)=>{var n=t(9039),i=t(8227),s=t(3724),o=t(6395),a=i("iterator");r.exports=!n(function(){var l=new URL("b?a=1&b=2&c=3","https://a"),u=l.searchParams,h=new URLSearchParams("a=1&a=2&b=3"),m="";return l.pathname="c%20d",u.forEach(function(g,v){u.delete("b"),m+=v+g}),h.delete("a",2),h.delete("b",void 0),o&&(!l.toJSON||!h.has("a",1)||h.has("a",2)||!h.has("a",void 0)||h.has("b"))||!u.size&&(o||!s)||!u.sort||l.href!=="https://a/c%20d?a=1&c=3"||u.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!u[a]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://").host!=="xn--e1aybc"||new URL("https://a#").hash!=="#%D0%B1"||m!=="a1c3"||new URL("https://x",void 0).host!=="x"})}),7476:((r,e,t)=>{var n=t(2195),i=t(9504);r.exports=function(s){if(n(s)==="Function")return i(s)}}),7566:((r,e,t)=>{var n=t(6840),i=t(9504),s=t(655),o=t(2812),a=URLSearchParams,l=a.prototype,u=i(l.getAll),h=i(l.has),m=new a("a=1");(m.has("a",2)||!m.has("a",void 0))&&n(l,"has",function(v){var y=arguments.length,A=y<2?void 0:arguments[1];if(y&&A===void 0)return h(this,v);var x=u(this,v);o(y,1);for(var b=s(A),w=0;w<x.length;)if(x[w++]===b)return!0;return!1},{enumerable:!0,unsafe:!0})}),7588:((r,e,t)=>{var n=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),u=t(9539),h=t(4549),m=h("forEach",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:m},{forEach:function(v){a(this);try{o(v)}catch(x){u(this,"throw",x)}if(m)return i(m,this,v);var y=l(this),A=0;s(y,function(x){v(x,A++)},{IS_RECORD:!0})}})}),7629:((r,e,t)=>{var n=t(6395),i=t(4576),s=t(9433),o="__core-js_shared__",a=r.exports=i[o]||s(o,{});(a.versions||(a.versions=[])).push({version:"3.47.0",mode:n?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),7642:((r,e,t)=>{var n=t(6518),i=t(3440),s=t(9039),o=t(4916),a=!o("difference",function(u){return u.size===0}),l=a||s(function(){var u={size:1,has:function(){return!0},keys:function(){var m=0;return{next:function(){var g=m++>1;return h.has(1)&&h.clear(),{done:g,value:2}}}}},h=new Set([1,2,3,4]);return h.difference(u).size!==3});n({target:"Set",proto:!0,real:!0,forced:l},{difference:i})}),7657:((r,e,t)=>{var n=t(9039),i=t(4901),s=t(34),o=t(2360),a=t(2787),l=t(6840),u=t(8227),h=t(6395),m=u("iterator"),g=!1,v,y,A;[].keys&&(A=[].keys(),"next"in A?(y=a(a(A)),y!==Object.prototype&&(v=y)):g=!0);var x=!s(v)||n(function(){var b={};return v[m].call(b)!==b});x?v={}:h&&(v=o(v)),i(v[m])||l(v,m,function(){return this}),r.exports={IteratorPrototype:v,BUGGY_SAFARI_ITERATORS:g}}),7680:((r,e,t)=>{var n=t(9504);r.exports=n([].slice)}),7696:((r,e,t)=>{var n=t(1291),i=t(8014),s=RangeError;r.exports=function(o){if(o===void 0)return 0;var a=n(o),l=i(a);if(a!==l)throw new s("Wrong length or index");return l}}),7740:((r,e,t)=>{var n=t(9297),i=t(5031),s=t(7347),o=t(4913);r.exports=function(a,l,u){for(var h=i(l),m=o.f,g=s.f,v=0;v<h.length;v++){var y=h[v];!n(a,y)&&!(u&&n(u,y))&&m(a,y,g(l,y))}}}),7750:((r,e,t)=>{var n=t(4117),i=TypeError;r.exports=function(s){if(n(s))throw new i("Can't call method on "+s);return s}}),7751:((r,e,t)=>{var n=t(4576),i=t(4901),s=function(o){return i(o)?o:void 0};r.exports=function(o,a){return arguments.length<2?s(n[o]):n[o]&&n[o][a]}}),7811:(r=>{r.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"}),7936:((r,e,t)=>{var n=t(6518),i=t(5636);i&&n({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return i(this,arguments.length?arguments[0]:void 0,!1)}})}),8004:((r,e,t)=>{var n=t(6518),i=t(9039),s=t(8750),o=t(4916),a=!o("intersection",function(l){return l.size===2&&l.has(1)&&l.has(2)})||i(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});n({target:"Set",proto:!0,real:!0,forced:a},{intersection:s})}),8014:((r,e,t)=>{var n=t(1291),i=Math.min;r.exports=function(s){var o=n(s);return o>0?i(o,9007199254740991):0}}),8100:((r,e,t)=>{var n=t(6518),i=t(5636);i&&n({target:"ArrayBuffer",proto:!0},{transfer:function(){return i(this,arguments.length?arguments[0]:void 0,!0)}})}),8111:((r,e,t)=>{var n=t(6518),i=t(4576),s=t(679),o=t(8551),a=t(4901),l=t(2787),u=t(2106),h=t(4659),m=t(9039),g=t(9297),v=t(8227),y=t(7657).IteratorPrototype,A=t(3724),x=t(6395),b="constructor",w="Iterator",T=v("toStringTag"),k=TypeError,I=i[w],M=x||!a(I)||I.prototype!==y||!m(function(){I({})}),L=function(){if(s(this,y),l(this)===y)throw new k("Abstract class Iterator not directly constructable")},j=function(B,z){A?u(y,B,{configurable:!0,get:function(){return z},set:function(Z){if(o(this),this===y)throw new k("You can't redefine this property");g(this,B)?this[B]=Z:h(this,B,Z)}}):y[B]=z};g(y,T)||j(T,w),(M||!g(y,b)||y[b]===Object)&&j(b,L),L.prototype=y,n({global:!0,constructor:!0,forced:M},{Iterator:L})}),8227:((r,e,t)=>{var n=t(4576),i=t(5745),s=t(9297),o=t(3392),a=t(4495),l=t(7040),u=n.Symbol,h=i("wks"),m=l?u.for||u:u&&u.withoutSetter||o;r.exports=function(g){return s(h,g)||(h[g]=a&&s(u,g)?u[g]:m("Symbol."+g)),h[g]}}),8235:((r,e,t)=>{var n=t(9504),i=t(9297),s=SyntaxError,o=parseInt,a=String.fromCharCode,l=n("".charAt),u=n("".slice),h=n(/./.exec),m={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},g=/^[\da-f]{4}$/i,v=/^[\u0000-\u001F]$/;r.exports=function(y,A){for(var x=!0,b="";A<y.length;){var w=l(y,A);if(w==="\\"){var T=u(y,A,A+2);if(i(m,T))b+=m[T],A+=2;else if(T==="\\u"){A+=2;var k=u(y,A,A+4);if(!h(g,k))throw new s("Bad Unicode escape at: "+A);b+=a(o(k,16)),A+=4}else throw new s('Unknown escape sequence: "'+T+'"')}else if(w==='"'){x=!1,A++;break}else{if(h(v,w))throw new s("Bad control character in string literal at: "+A);b+=w,A++}}if(x)throw new s("Unterminated string at: "+A);return{value:b,end:A}}}),8237:((r,e,t)=>{var n=t(6518),i=t(2652),s=t(9306),o=t(8551),a=t(1767),l=t(9539),u=t(4549),h=t(8745),m=t(9039),g=TypeError,v=m(function(){[].keys().reduce(function(){},void 0)}),y=!v&&u("reduce",g);n({target:"Iterator",proto:!0,real:!0,forced:v||y},{reduce:function(x){o(this);try{s(x)}catch(I){l(this,"throw",I)}var b=arguments.length<2,w=b?void 0:arguments[1];if(y)return h(y,this,b?[x]:[x,w]);var T=a(this),k=0;if(i(T,function(I){b?(b=!1,w=I):w=x(w,I,k),k++},{IS_RECORD:!0}),b)throw new g("Reduce of empty iterator with no initial value");return w}})}),8335:((r,e,t)=>{t(9112)}),8469:((r,e,t)=>{var n=t(9504),i=t(507),s=t(4402),o=s.Set,a=s.proto,l=n(a.forEach),u=n(a.keys),h=u(new o).next;r.exports=function(m,g,v){return v?i({iterator:u(m),next:h},g):l(m,g)}}),8480:((r,e,t)=>{var n=t(1828),i=t(8727),s=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(a){return n(a,s)}}),8527:((r,e,t)=>{var n=t(7080),i=t(4402).has,s=t(5170),o=t(3789),a=t(507),l=t(9539);r.exports=function(h){var m=n(this),g=o(h);if(s(m)<g.size)return!1;var v=g.getIterator();return a(v,function(y){if(!i(m,y))return l(v,"normal",!1)})!==!1}}),8551:((r,e,t)=>{var n=t(34),i=String,s=TypeError;r.exports=function(o){if(n(o))return o;throw new s(i(o)+" is not an object")}}),8574:((r,e,t)=>{var n=t(9504),i=Error,s=n("".replace),o=(function(u){return String(new i(u).stack)})("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,l=a.test(o);r.exports=function(u,h){if(l&&typeof u=="string"&&!i.prepareStackTrace)for(;h--;)u=s(u,a,"");return u}}),8622:((r,e,t)=>{var n=t(4576),i=t(4901),s=n.WeakMap;r.exports=i(s)&&/native code/.test(String(s))}),8646:((r,e,t)=>{var n=t(9565),i=t(8551),s=t(1767),o=t(851);r.exports=function(a,l){(!l||typeof a!="string")&&i(a);var u=o(a);return s(i(u!==void 0?n(u,a):a))}}),8686:((r,e,t)=>{var n=t(3724),i=t(9039);r.exports=n&&i(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})}),8721:((r,e,t)=>{var n=t(3724),i=t(9504),s=t(2106),o=URLSearchParams.prototype,a=i(o.forEach);n&&!("size"in o)&&s(o,"size",{get:function(){var u=0;return a(this,function(){u++}),u},configurable:!0,enumerable:!0})}),8727:(r=>{r.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}),8745:((r,e,t)=>{var n=t(616),i=Function.prototype,s=i.apply,o=i.call;r.exports=typeof Reflect=="object"&&Reflect.apply||(n?o.bind(s):function(){return o.apply(s,arguments)})}),8750:((r,e,t)=>{var n=t(7080),i=t(4402),s=t(5170),o=t(3789),a=t(8469),l=t(507),u=i.Set,h=i.add,m=i.has;r.exports=function(v){var y=n(this),A=o(v),x=new u;return s(y)>A.size?l(A.getIterator(),function(b){m(y,b)&&h(x,b)}):a(y,function(b){A.includes(b)&&h(x,b)}),x}}),8773:((r,e)=>{var t={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!t.call({1:2},1);e.f=i?function(o){var a=n(this,o);return!!a&&a.enumerable}:t}),8981:((r,e,t)=>{var n=t(7750),i=Object;r.exports=function(s){return i(n(s))}}),9039:(r=>{r.exports=function(e){try{return!!e()}catch{return!0}}}),9112:((r,e,t)=>{var n=t(6518),i=t(3724),s=t(4576),o=t(7751),a=t(9504),l=t(9565),u=t(4901),h=t(34),m=t(4376),g=t(9297),v=t(655),y=t(6198),A=t(4659),x=t(9039),b=t(8235),w=t(4495),T=s.JSON,k=s.Number,I=s.SyntaxError,M=T&&T.parse,L=o("Object","keys"),j=Object.getOwnPropertyDescriptor,B=a("".charAt),z=a("".slice),Z=a(/./.exec),$=a([].push),U=/^\d$/,Y=/^[1-9]$/,ee=/^[\d-]$/,X=/^[\t\n\r ]$/,re=0,G=1,J=function(se,F){se=v(se);var te=new ce(se,0),ge=te.parse(),oe=ge.value,pe=te.skip(X,ge.end);if(pe<se.length)throw new I('Unexpected extra character: "'+B(se,pe)+'" after the parsed data at: '+pe);return u(F)?ne({"":oe},"",F,ge):oe},ne=function(se,F,te,ge){var oe=se[F],pe=ge&&oe===ge.value,Be=pe&&typeof ge.source=="string"?{source:ge.source}:{},Fe,ye,_e,de,Ae;if(h(oe)){var nt=m(oe),at=pe?ge.nodes:nt?[]:{};if(nt)for(Fe=at.length,_e=y(oe),de=0;de<_e;de++)W(oe,de,ne(oe,""+de,te,de<Fe?at[de]:void 0));else for(ye=L(oe),_e=y(ye),de=0;de<_e;de++)Ae=ye[de],W(oe,Ae,ne(oe,Ae,te,g(at,Ae)?at[Ae]:void 0))}return l(te,se,F,oe,Be)},W=function(se,F,te){if(i){var ge=j(se,F);if(ge&&!ge.configurable)return}te===void 0?delete se[F]:A(se,F,te)},V=function(se,F,te,ge){this.value=se,this.end=F,this.source=te,this.nodes=ge},ce=function(se,F){this.source=se,this.index=F};ce.prototype={fork:function(se){return new ce(this.source,se)},parse:function(){var se=this.source,F=this.skip(X,this.index),te=this.fork(F),ge=B(se,F);if(Z(ee,ge))return te.number();switch(ge){case"{":return te.object();case"[":return te.array();case'"':return te.string();case"t":return te.keyword(!0);case"f":return te.keyword(!1);case"n":return te.keyword(null)}throw new I('Unexpected character: "'+ge+'" at: '+F)},node:function(se,F,te,ge,oe){return new V(F,ge,se?null:z(this.source,te,ge),oe)},object:function(){for(var se=this.source,F=this.index+1,te=!1,ge={},oe={};F<se.length;){if(F=this.until(['"',"}"],F),B(se,F)==="}"&&!te){F++;break}var pe=this.fork(F).string(),Be=pe.value;F=pe.end,F=this.until([":"],F)+1,F=this.skip(X,F),pe=this.fork(F).parse(),A(oe,Be,pe),A(ge,Be,pe.value),F=this.until([",","}"],pe.end);var Fe=B(se,F);if(Fe===",")te=!0,F++;else if(Fe==="}"){F++;break}}return this.node(G,ge,this.index,F,oe)},array:function(){for(var se=this.source,F=this.index+1,te=!1,ge=[],oe=[];F<se.length;){if(F=this.skip(X,F),B(se,F)==="]"&&!te){F++;break}var pe=this.fork(F).parse();if($(oe,pe),$(ge,pe.value),F=this.until([",","]"],pe.end),B(se,F)===",")te=!0,F++;else if(B(se,F)==="]"){F++;break}}return this.node(G,ge,this.index,F,oe)},string:function(){var se=this.index,F=b(this.source,this.index+1);return this.node(re,F.value,se,F.end)},number:function(){var se=this.source,F=this.index,te=F;if(B(se,te)==="-"&&te++,B(se,te)==="0")te++;else if(Z(Y,B(se,te)))te=this.skip(U,te+1);else throw new I("Failed to parse number at: "+te);if(B(se,te)==="."&&(te=this.skip(U,te+1)),B(se,te)==="e"||B(se,te)==="E"){te++,(B(se,te)==="+"||B(se,te)==="-")&&te++;var ge=te;if(te=this.skip(U,te),ge===te)throw new I("Failed to parse number's exponent value at: "+te)}return this.node(re,k(z(se,F,te)),F,te)},keyword:function(se){var F=""+se,te=this.index,ge=te+F.length;if(z(this.source,te,ge)!==F)throw new I("Failed to parse value at: "+te);return this.node(re,se,te,ge)},skip:function(se,F){for(var te=this.source;F<te.length&&Z(se,B(te,F));F++);return F},until:function(se,F){F=this.skip(X,F);for(var te=B(this.source,F),ge=0;ge<se.length;ge++)if(se[ge]===te)return F;throw new I('Unexpected character: "'+te+'" at: '+F)}};var ue=x(function(){var se="9007199254740993",F;return M(se,function(te,ge,oe){F=oe.source}),F!==se}),ve=w&&!x(function(){return 1/M("-0 	")!==-1/0});n({target:"JSON",stat:!0,forced:ue},{parse:function(F,te){return ve&&!u(te)?M(F):J(F,te)}})}),9143:((r,e,t)=>{var n=t(4576),i=t(9504),s=t(3972),o=t(3463),a=t(9297),l=t(2804),u=t(944),h=t(5169),m=l.c2i,g=l.c2iUrl,v=n.SyntaxError,y=n.TypeError,A=i("".charAt),x=function(T,k){for(var I=T.length;k<I;k++){var M=A(T,k);if(M!==" "&&M!=="	"&&M!==`
`&&M!=="\f"&&M!=="\r")break}return k},b=function(T,k,I){var M=T.length;M<4&&(T+=M===2?"AA":"A");var L=(k[A(T,0)]<<18)+(k[A(T,1)]<<12)+(k[A(T,2)]<<6)+k[A(T,3)],j=[L>>16&255,L>>8&255,L&255];if(M===2){if(I&&j[1]!==0)throw new v("Extra bits");return[j[0]]}if(M===3){if(I&&j[2]!==0)throw new v("Extra bits");return[j[0],j[1]]}return j},w=function(T,k,I){for(var M=k.length,L=0;L<M;L++)T[I+L]=k[L];return I+M};r.exports=function(T,k,I,M){o(T),s(k);var L=u(k)==="base64"?m:g,j=k?k.lastChunkHandling:void 0;if(j===void 0&&(j="loose"),j!=="loose"&&j!=="strict"&&j!=="stop-before-partial")throw new y("Incorrect `lastChunkHandling` option");I&&h(I.buffer);var B=T.length,z=I||[],Z=0,$=0,U="",Y=0;if(M)for(;;){if(Y=x(T,Y),Y===B){if(U.length>0){if(j==="stop-before-partial")break;if(j==="loose"){if(U.length===1)throw new v("Malformed padding: exactly one additional character");Z=w(z,b(U,L,!1),Z)}else throw new v("Missing padding")}$=B;break}var ee=A(T,Y);if(++Y,ee==="="){if(U.length<2)throw new v("Padding is too early");if(Y=x(T,Y),U.length===2){if(Y===B){if(j==="stop-before-partial")break;throw new v("Malformed padding: only one =")}A(T,Y)==="="&&(++Y,Y=x(T,Y))}if(Y<B)throw new v("Unexpected character after padding");Z=w(z,b(U,L,j==="strict"),Z),$=B;break}if(!a(L,ee))throw new v("Unexpected character");var X=M-Z;if(X===1&&U.length===2||X===2&&U.length===3||(U+=ee,U.length===4&&(Z=w(z,b(U,L,!1),Z),U="",$=Y,Z===M)))break}return{bytes:z,read:$,written:Z}}}),9286:((r,e,t)=>{var n=t(4402),i=t(8469),s=n.Set,o=n.add;r.exports=function(a){var l=new s;return i(a,function(u){o(l,u)}),l}}),9297:((r,e,t)=>{var n=t(9504),i=t(8981),s=n({}.hasOwnProperty);r.exports=Object.hasOwn||function(a,l){return s(i(a),l)}}),9306:((r,e,t)=>{var n=t(4901),i=t(6823),s=TypeError;r.exports=function(o){if(n(o))return o;throw new s(i(o)+" is not a function")}}),9314:((r,e,t)=>{var n=t(6518),i=t(9565),s=t(8551),o=t(1767),a=t(4149),l=t(9590),u=t(9539),h=t(9462),m=t(684),g=t(4549),v=t(6395),y=!v&&!m("drop",0),A=!v&&!y&&g("drop",RangeError),x=v||y||A,b=h(function(){for(var w=this.iterator,T=this.next,k,I;this.remaining;)if(this.remaining--,k=s(i(T,w)),I=this.done=!!k.done,I)return;if(k=s(i(T,w)),I=this.done=!!k.done,!I)return k.value});n({target:"Iterator",proto:!0,real:!0,forced:x},{drop:function(T){s(this);var k;try{k=l(a(+T))}catch(I){u(this,"throw",I)}return A?i(A,this,k):new b(o(this),{remaining:k})}})}),9429:((r,e,t)=>{var n=t(4576),i=t(6193);r.exports=function(s){if(i){try{return n.process.getBuiltinModule(s)}catch{}try{return Function('return require("'+s+'")')()}catch{}}}}),9432:((r,e,t)=>{t(5213)}),9433:((r,e,t)=>{var n=t(4576),i=Object.defineProperty;r.exports=function(s,o){try{i(n,s,{value:o,configurable:!0,writable:!0})}catch{n[s]=o}return o}}),9462:((r,e,t)=>{var n=t(9565),i=t(2360),s=t(6699),o=t(6279),a=t(8227),l=t(1181),u=t(5966),h=t(7657).IteratorPrototype,m=t(2529),g=t(9539),v=t(1385),y=a("toStringTag"),A="IteratorHelper",x="WrapForValidIterator",b="normal",w="throw",T=l.set,k=function(L){var j=l.getterFor(L?x:A);return o(i(h),{next:function(){var z=j(this);if(L)return z.nextHandler();if(z.done)return m(void 0,!0);try{var Z=z.nextHandler();return z.returnHandlerResult?Z:m(Z,z.done)}catch($){throw z.done=!0,$}},return:function(){var B=j(this),z=B.iterator;if(B.done=!0,L){var Z=u(z,"return");return Z?n(Z,z):m(void 0,!0)}if(B.inner)try{g(B.inner.iterator,b)}catch($){return g(z,w,$)}if(B.openIters)try{v(B.openIters,b)}catch($){return g(z,w,$)}return z&&g(z,b),m(void 0,!0)}})},I=k(!0),M=k(!1);s(M,y,"Iterator Helper"),r.exports=function(L,j,B){var z=function($,U){U?(U.iterator=$.iterator,U.next=$.next):U=$,U.type=j?x:A,U.returnHandlerResult=!!B,U.nextHandler=L,U.counter=0,U.done=!1,T(this,U)};return z.prototype=j?I:M,z}}),9486:((r,e,t)=>{var n=t(6518),i=t(4576),s=t(9504),o=t(3972),a=t(4154),l=t(5169),u=t(2804),h=t(944),m=u.i2c,g=u.i2cUrl,v=s("".charAt),y=i.Uint8Array,A=!y||!y.prototype.toBase64||!(function(){try{var x=new y;x.toBase64(null)}catch{return!0}})();y&&n({target:"Uint8Array",proto:!0,forced:A},{toBase64:function(){var b=a(this),w=arguments.length?o(arguments[0]):void 0,T=h(w)==="base64"?m:g,k=!!w&&!!w.omitPadding;l(this.buffer);for(var I="",M=0,L=b.length,j,B=function(z){return v(T,j>>6*z&63)};M+2<L;M+=3)j=(b[M]<<16)+(b[M+1]<<8)+b[M+2],I+=B(3)+B(2)+B(1)+B(0);return M+2===L?(j=(b[M]<<16)+(b[M+1]<<8),I+=B(3)+B(2)+B(1)+(k?"":"=")):M+1===L&&(j=b[M]<<16,I+=B(3)+B(2)+(k?"":"==")),I}})}),9504:((r,e,t)=>{var n=t(616),i=Function.prototype,s=i.call,o=n&&i.bind.bind(s,s);r.exports=n?o:function(a){return function(){return s.apply(a,arguments)}}}),9519:((r,e,t)=>{var n=t(4576),i=t(2839),s=n.process,o=n.Deno,a=s&&s.versions||o&&o.version,l=a&&a.v8,u,h;l&&(u=l.split("."),h=u[0]>0&&u[0]<4?1:+(u[0]+u[1])),!h&&i&&(u=i.match(/Edge\/(\d+)/),(!u||u[1]>=74)&&(u=i.match(/Chrome\/(\d+)/),u&&(h=+u[1]))),r.exports=h}),9539:((r,e,t)=>{var n=t(9565),i=t(8551),s=t(5966);r.exports=function(o,a,l){var u,h;i(o);try{if(u=s(o,"return"),!u){if(a==="throw")throw l;return l}u=n(u,o)}catch(m){h=!0,u=m}if(a==="throw")throw l;if(h)throw u;return i(u),l}}),9565:((r,e,t)=>{var n=t(616),i=Function.prototype.call;r.exports=n?i.bind(i):function(){return i.apply(i,arguments)}}),9577:((r,e,t)=>{var n=t(9928),i=t(4644),s=t(1108),o=t(1291),a=t(5854),l=i.aTypedArray,u=i.getTypedArrayConstructor,h=i.exportTypedArrayMethod,m=(function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(v){return v===8}})(),g=m&&(function(){try{new Int8Array(1).with(-.5,1)}catch{return!0}})();h("with",function(v,y){var A=l(this),x=o(v),b=s(A)?a(y):+y;return n(A,u(A),x,b)},!m||g)}),9590:((r,e,t)=>{var n=t(1291),i=RangeError;r.exports=function(s){var o=n(s);if(o<0)throw new i("The argument can't be less than 0");return o}}),9617:((r,e,t)=>{var n=t(5397),i=t(5610),s=t(6198),o=function(a){return function(l,u,h){var m=n(l),g=s(m);if(g===0)return!a&&-1;var v=i(h,g),y;if(a&&u!==u){for(;g>v;)if(y=m[v++],y!==y)return!0}else for(;g>v;v++)if((a||v in m)&&m[v]===u)return a||v||0;return!a&&-1}};r.exports={includes:o(!0),indexOf:o(!1)}}),9631:((r,e,t)=>{t(9486)}),9797:((r,e,t)=>{t(4226)}),9835:(r=>{r.exports=function(e){try{var t=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return t.clear(),t.add(4),function(){return{done:!0}}}})}},i=t[e](n);return i.size===1&&i.values().next().value===4}catch{return!1}}}),9928:((r,e,t)=>{var n=t(6198),i=t(1291),s=RangeError;r.exports=function(o,a,l,u){var h=n(o),m=i(l),g=m<0?h+m:m;if(g>=h||g<0)throw new s("Incorrect index");for(var v=new a(h),y=0;y<h;y++)v[y]=y===g?u:o[y];return v}})},U2={};function Ge(r){var e=U2[r];if(e!==void 0)return e.exports;var t=U2[r]={exports:{}};return A6[r].call(t.exports,t,t.exports,Ge),t.exports}Ge.d=(r,e)=>{for(var t in e)Ge.o(e,t)&&!Ge.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})};Ge.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);Ge(4114);Ge(6573);Ge(8100);Ge(7936);Ge(8111);Ge(8237);Ge(1689);Ge(9577);Ge(4235);Ge(9432);Ge(1549);Ge(9797);Ge(9631);Ge(5623);Ge(4979);Ge(5781);const un=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),VT=[.001,0,0,.001,0,0],wT=1.35,ni={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ka={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},lv="pdfjs_internal_editor_",Ve={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},st={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},b6={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},qT={TRIANGLES:1,LATTICE:2},gr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},V0={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ur={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},cd={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},uA={ERRORS:0,WARNINGS:1,INFOS:5},cv={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Mg={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},x6={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let dA=uA.WARNINGS;function T6(r){Number.isInteger(r)&&(dA=r)}function w6(){return dA}function hA(r){dA>=uA.INFOS&&console.info(`Info: ${r}`)}function Ue(r){dA>=uA.WARNINGS&&console.warn(`Warning: ${r}`)}function kt(r){throw new Error(r)}function ot(r,e){r||kt(e)}function P6(r){switch(r==null?void 0:r.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function PO(r,e=null,t=null){if(!r)return null;if(t&&typeof r=="string"){if(t.addDefaultProtocol&&r.startsWith("www.")){const i=r.match(/\./g);(i==null?void 0:i.length)>=2&&(r=`http://${r}`)}if(t.tryConvertEncoding)try{r=M6(r)}catch{}}const n=e?URL.parse(r,e):URL.parse(r);return P6(n)?n:null}function EO(r,e,t=!1){const n=URL.parse(r);return n?(n.hash=e,n.href):t&&PO(r,"http://example.com")?r.split("#",1)[0]+`${e?`#${e}`:""}`:""}function $e(r,e,t,n=!1){return Object.defineProperty(r,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const _u=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class Z2 extends _u{constructor(e,t){super(e,"PasswordException"),this.code=t}}class PT extends _u{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class GT extends _u{constructor(e){super(e,"InvalidPDFException")}}class PC extends _u{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class E6 extends _u{constructor(e){super(e,"FormatError")}}class bl extends _u{constructor(e){super(e,"AbortException")}}function RO(r){(typeof r!="object"||(r==null?void 0:r.length)===void 0)&&kt("Invalid argument for bytesToString");const e=r.length,t=8192;if(e<t)return String.fromCharCode.apply(null,r);const n=[];for(let i=0;i<e;i+=t){const s=Math.min(i+t,e),o=r.subarray(i,s);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function ay(r){typeof r!="string"&&kt("Invalid argument for stringToBytes");const e=r.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=r.charCodeAt(n)&255;return t}function R6(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function I6(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function k6(){try{return new Function(""),!0}catch{return!1}}class Ar{static get isLittleEndian(){return $e(this,"isLittleEndian",I6())}static get isEvalSupported(){return $e(this,"isEvalSupported",k6())}static get isOffscreenCanvasSupported(){return $e(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return $e(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return $e(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return $e(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return $e(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return $e(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const ET=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));var qo,q0,KT;class we{static makeHexColor(e,t,n){return`#${ET[e]}${ET[t]}${ET[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const i=e[n],s=e[n+1];e[n]=i*t[0]+s*t[2]+t[4],e[n+1]=i*t[1]+s*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],u=t[5];for(let h=0;h<6;h+=2){const m=e[n+h],g=e[n+h+1];e[n+h]=m*i+g*o+l,e[n+h+1]=m*s+g*a+u}}static applyInverseTransform(e,t){const n=e[0],i=e[1],s=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/s,e[1]=(-n*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/s}static axialAlignedBoundingBox(e,t,n){const i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],u=t[5],h=e[0],m=e[1],g=e[2],v=e[3];let y=i*h+l,A=y,x=i*g+l,b=x,w=a*m+u,T=w,k=a*v+u,I=k;if(s!==0||o!==0){const M=s*h,L=s*g,j=o*m,B=o*v;y+=j,b+=j,x+=B,A+=B,w+=M,I+=M,k+=L,T+=L}n[0]=Math.min(n[0],y,x,A,b),n[1]=Math.min(n[1],w,k,T,I),n[2]=Math.max(n[2],y,x,A,b),n[3]=Math.max(n[3],w,k,T,I)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],i=e[1],s=e[2],o=e[3],a=n**2+i**2,l=n*s+i*o,u=s**2+o**2,h=(a+u)/2,m=Math.sqrt(h**2-(a*u-l**2));t[0]=Math.sqrt(h+m||1),t[1]=Math.sqrt(h-m||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>o?null:[n,s,i,o]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,i,s){s[0]=Math.min(s[0],e,n),s[1]=Math.min(s[1],t,i),s[2]=Math.max(s[2],e,n),s[3]=Math.max(s[3],t,i)}static bezierBoundingBox(e,t,n,i,s,o,a,l,u){u[0]=Math.min(u[0],e,a),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,a),u[3]=Math.max(u[3],t,l),_(this,qo,KT).call(this,e,n,s,a,t,i,o,l,3*(-e+3*(n-s)+a),6*(e-2*n+s),3*(n-e),u),_(this,qo,KT).call(this,e,n,s,a,t,i,o,l,3*(-t+3*(i-o)+l),6*(t-2*i+o),3*(i-t),u)}}qo=new WeakSet,q0=function(e,t,n,i,s,o,a,l,u,h){if(u<=0||u>=1)return;const m=1-u,g=u*u,v=g*u,y=m*(m*(m*e+3*u*t)+3*g*n)+v*i,A=m*(m*(m*s+3*u*o)+3*g*a)+v*l;h[0]=Math.min(h[0],y),h[1]=Math.min(h[1],A),h[2]=Math.max(h[2],y),h[3]=Math.max(h[3],A)},KT=function(e,t,n,i,s,o,a,l,u,h,m,g){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&_(this,qo,q0).call(this,e,t,n,i,s,o,a,l,-m/h,g);return}const v=h**2-4*m*u;if(v<0)return;const y=Math.sqrt(v),A=2*u;_(this,qo,q0).call(this,e,t,n,i,s,o,a,l,(-h+y)/A,g),_(this,qo,q0).call(this,e,t,n,i,s,o,a,l,(-h-y)/A,g)},N(we,qo);function M6(r){return decodeURIComponent(escape(r))}let RT=null,$2=null;function N6(r){return RT||(RT=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,$2=new Map([["","t"]])),r.replaceAll(RT,(e,t,n)=>t?t.normalize("NFKC"):$2.get(n))}function IO(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),RO(r)}const Sd="pdfjs_internal_id_";function L6(r,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,i,...s]=t;if(!r(n)&&!Number.isInteger(n)||!e(i))return!1;const o=s.length;let a=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;a=!1;break;default:return!1}for(const l of s)if(!(typeof l=="number"||a&&l===null))return!1;return!0}function dn(r,e,t){return Math.min(Math.max(r,e),t)}function kO(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(RO(r))}function _6(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):ay(atob(r))}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((e,t)=>e+t,0)});typeof AbortSignal.any!="function"&&(AbortSignal.any=function(r){const e=new AbortController,{signal:t}=e;for(const n of r)if(n.aborted)return e.abort(n.reason),t;for(const n of r)n.addEventListener("abort",()=>{e.abort(n.reason)},{signal:t});return t});Ge(1701);Ge(4603);Ge(7566);Ge(8721);class uv{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function i(s){var l;if(!s)return;let o=null;const a=s.name;if(a==="#text")o=s.value;else if(uv.shouldBuildText(a))(l=s==null?void 0:s.attributes)!=null&&l.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&t.push({str:o}),!!s.children)for(const u of s.children)i(u)}return i(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class MO{static setupStorage(e,t,n,i,s){const o=i.getValue(t,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),s==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?e.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",a=>{i.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),s==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of n.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const l=a.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:i,linkService:s}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[l,u]of Object.entries(o))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}a&&s.addLinkAttributes(e,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(e,o.dataId,t,n)}static render(e){var m,g;const t=e.annotationStorage,n=e.linkService,i=e.xfaHtml,s=e.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:s,linkService:n});const a=s!=="richText",l=e.div;if(l.append(o),e.viewport){const v=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=v}a&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const v=document.createTextNode(i.value);o.append(v),a&&uv.shouldBuildText(i.name)&&u.push(v)}return{textDivs:u}}const h=[[i,-1,o]];for(;h.length>0;){const[v,y,A]=h.at(-1);if(y+1===v.children.length){h.pop();continue}const x=v.children[++h.at(-1)[1]];if(x===null)continue;const{name:b}=x;if(b==="#text"){const T=document.createTextNode(x.value);u.push(T),A.append(T);continue}const w=(m=x==null?void 0:x.attributes)!=null&&m.xmlns?document.createElementNS(x.attributes.xmlns,b):document.createElement(b);if(A.append(w),x.attributes&&this.setAttributes({html:w,element:x,storage:t,intent:s,linkService:n}),((g=x.children)==null?void 0:g.length)>0)h.push([x,-1,w]);else if(x.value){const T=document.createTextNode(x.value);a&&uv.shouldBuildText(b)&&u.push(T),w.append(T)}}for(const v of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))v.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const so="http://www.w3.org/2000/svg",dc=class dc{};q(dc,"CSS",96),q(dc,"PDF",72),q(dc,"PDF_TO_CSS_UNITS",dc.CSS/dc.PDF);let xl=dc;async function ly(r,e="text"){if(Fg(r,document.baseURI)){const t=await fetch(r);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const i=new XMLHttpRequest;i.open("GET",r,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}class cy{constructor({viewBox:e,userUnit:t,scale:n,rotation:i,offsetX:s=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=i,this.offsetX=s,this.offsetY=o,n*=t;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,m,g,v;switch(i%=360,i<0&&(i+=360),i){case 180:h=-1,m=0,g=0,v=1;break;case 90:h=0,m=1,g=1,v=0;break;case 270:h=0,m=-1,g=-1,v=0;break;case 0:h=1,m=0,g=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(g=-g,v=-v);let y,A,x,b;h===0?(y=Math.abs(u-e[1])*n+s,A=Math.abs(l-e[0])*n+o,x=(e[3]-e[1])*n,b=(e[2]-e[0])*n):(y=Math.abs(l-e[0])*n+s,A=Math.abs(u-e[1])*n+o,x=(e[2]-e[0])*n,b=(e[3]-e[1])*n),this.transform=[h*n,m*n,g*n,v*n,y-h*n*l-g*n*u,A-m*n*l-v*n*u],this.width=x,this.height=b}get rawDims(){const e=this.viewBox;return $e(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new cy({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:s})}convertToViewportPoint(e,t){const n=[e,t];return we.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];we.applyTransform(t,this.transform);const n=[e[2],e[3]];return we.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return we.applyInverseTransform(n,this.transform),n}}class DP extends _u{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function pA(r){const e=r.length;let t=0;for(;t<e&&r[t].trim()==="";)t++;return r.substring(t,t+5).toLowerCase()==="data:"}function jP(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function O6(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function D6(r,e="document.pdf"){if(typeof r!="string")return e;if(pA(r))return Ue('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(a=>{try{return new URL(a)}catch{try{return new URL(decodeURIComponent(a))}catch{try{return new URL(a,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(a),"https://foo.bar")}catch{return null}}}}})(r);if(!n)return e;const i=a=>{try{let l=decodeURIComponent(a);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:a):l}catch{return a}},s=/\.pdf$/i,o=n.pathname.split("/").at(-1);if(s.test(o))return i(o);if(n.searchParams.size>0){const a=Array.from(n.searchParams.values()).reverse();for(const u of a)if(s.test(u))return i(u);const l=Array.from(n.searchParams.keys()).reverse();for(const u of l)if(s.test(u))return i(u)}if(n.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(l)return i(l[0])}return e}class H2{constructor(){q(this,"started",Object.create(null));q(this,"times",[])}time(e){e in this.started&&Ue(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ue(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:i,end:s}of this.times)e.push(`${n.padEnd(t)} ${s-i}ms
`);return e.join("")}}function Fg(r,e){const t=e?URL.parse(r,e):URL.parse(r);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Mi(r){r.preventDefault()}function nr(r){r.preventDefault(),r.stopPropagation()}function j6(r){console.log("Deprecated API usage: "+r)}var fv;class EC{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;p(this,fv)||E(this,fv,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=p(this,fv).exec(e);if(!t)return null;const n=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let m=parseInt(t[9],10)||0;return m=m>=0&&m<=59?m:0,u==="-"?(o+=h,a+=m):u==="+"&&(o-=h,a-=m),new Date(Date.UTC(n,i,s,o,a,l))}}fv=new WeakMap,N(EC,fv);function B6(r,{scale:e=1,rotation:t=0}){const{width:n,height:i}=r.attributes.style,s=[0,0,parseInt(n),parseInt(i)];return new cy({viewBox:s,userUnit:1,scale:e,rotation:t})}function uy(r){if(r.startsWith("#")){const e=parseInt(r.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(e=>parseInt(e)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ue(`Not a valid color format: "${r}"`),[0,0,0])}function z6(r){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of r.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;r.set(t,uy(n))}e.remove()}function Gt(r){const{a:e,b:t,c:n,d:i,e:s,f:o}=r.getTransform();return[e,t,n,i,s,o]}function ms(r){const{a:e,b:t,c:n,d:i,e:s,f:o}=r.getTransform().invertSelf();return[e,t,n,i,s,o]}function Iu(r,e,t=!1,n=!0){if(e instanceof cy){const{pageWidth:i,pageHeight:s}=e.rawDims,{style:o}=r,a=Ar.isCSSRoundSupported,l=`var(--total-scale-factor) * ${i}px`,u=`var(--total-scale-factor) * ${s}px`,h=a?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,m=a?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(o.width=h,o.height=m):(o.width=m,o.height=h)}n&&r.setAttribute("data-main-rotation",e.rotation)}class Ws{constructor(){const{pixelRatio:e}=Ws;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,i,s=-1){let o=1/0,a=1/0,l=1/0;n=Ws.capPixels(n,s),n>0&&(o=Math.sqrt(n/(e*t))),i!==-1&&(a=i/e,l=i/t);const u=Math.min(o,a,l);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const YT=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class F6{static get isDarkMode(){var e;return $e(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class W6{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),$e(this,"commentForegroundColor",uy(n))}}function U6(r,e,t,n){n=Math.min(Math.max(n??1,0),1);const i=255*(1-n);return r=Math.round(r*n+i),e=Math.round(e*n+i),t=Math.round(t*n+i),[r,e,t]}function V2(r,e){const t=r[0]/255,n=r[1]/255,i=r[2]/255,s=Math.max(t,n,i),o=Math.min(t,n,i),a=(s+o)/2;if(s===o)e[0]=e[1]=0;else{const l=s-o;switch(e[1]=a<.5?l/(s+o):l/(2-s-o),s){case t:e[0]=((n-i)/l+(n<i?6:0))*60;break;case n:e[0]=((i-t)/l+2)*60;break;case i:e[0]=((t-n)/l+4)*60;break}}e[2]=a}function XT(r,e){const t=r[0],n=r[1],i=r[2],s=(1-Math.abs(2*i-1))*n,o=s*(1-Math.abs(t/60%2-1)),a=i-s/2;switch(Math.floor(t/60)){case 0:e[0]=s+a,e[1]=o+a,e[2]=a;break;case 1:e[0]=o+a,e[1]=s+a,e[2]=a;break;case 2:e[0]=a,e[1]=s+a,e[2]=o+a;break;case 3:e[0]=a,e[1]=o+a,e[2]=s+a;break;case 4:e[0]=o+a,e[1]=a,e[2]=s+a;break;case 5:case 6:e[0]=s+a,e[1]=a,e[2]=o+a;break}}function q2(r){return r<=.03928?r/12.92:((r+.055)/1.055)**2.4}function G2(r,e,t){XT(r,t),t.map(q2);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];XT(e,t),t.map(q2);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>i?(n+.05)/(i+.05):(i+.05)/(n+.05)}const K2=new Map;function Z6(r,e){const t=r[0]+r[1]*256+r[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=K2.get(t);if(n)return n;const i=new Float32Array(9),s=i.subarray(0,3),o=i.subarray(3,6);V2(r,o);const a=i.subarray(6,9);V2(e,a);const l=a[2]<.5,u=l?12:4.5;if(o[2]=l?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),G2(o,a,s)<u){let h,m;l?(h=o[2],m=1):(h=0,m=o[2]);const g=.005;for(;m-h>g;){const v=o[2]=(h+m)/2;l===G2(o,a,s)<u?h=v:m=v}o[2]=l?m:h}return XT(o,s),n=we.makeHexColor(Math.round(s[0]*255),Math.round(s[1]*255),Math.round(s[2]*255)),K2.set(t,n),n}function NO({html:r,dir:e,className:t},n){const i=document.createDocumentFragment();if(typeof r=="string"){const s=document.createElement("p");s.dir=e||"auto";const o=r.split(/(?:\r\n?|\n)/);for(let a=0,l=o.length;a<l;++a){const u=o[a];s.append(document.createTextNode(u)),a<l-1&&s.append(document.createElement("br"))}i.append(s)}else MO.render({xfaHtml:r,div:i,intent:"richText"});i.firstElementChild.classList.add("richText",t),n.append(i)}function LO(r){const e=new Path2D;if(!r)return e;for(let t=0,n=r.length;t<n;)switch(r[t++]){case Mg.moveTo:e.moveTo(r[t++],r[t++]);break;case Mg.lineTo:e.lineTo(r[t++],r[t++]);break;case Mg.curveTo:e.bezierCurveTo(r[t++],r[t++],r[t++],r[t++],r[t++],r[t++]);break;case Mg.quadraticCurveTo:e.quadraticCurveTo(r[t++],r[t++],r[t++],r[t++]);break;case Mg.closePath:e.closePath();break;default:Ue(`Unrecognized drawing path operator: ${r[t-1]}`);break}return e}Ge(4972);Ge(4628);Ge(7642);Ge(8004);Ge(3853);Ge(5876);Ge(2475);Ge(5024);Ge(1698);Ge(9314);Ge(1148);Ge(3579);Ge(8335);var Ma,Na,vi,Si,mv,La,wd,Pd,gv,FC,_O,Ur,OO,DO,ud,Wg;const lo=class lo{constructor(e){N(this,Ur);N(this,Ma,null);N(this,Na,null);N(this,vi);N(this,Si,null);N(this,mv,null);N(this,La,null);N(this,wd,null);N(this,Pd,null);E(this,vi,e),p(lo,gv)||E(lo,gv,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=E(this,Ma,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=p(this,vi)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Mi,{signal:t}),e.addEventListener("pointerdown",_(lo,FC,_O),{signal:t}));const n=E(this,Si,document.createElement("div"));n.className="buttons",e.append(n);const i=p(this,vi).toolbarPosition;if(i){const{style:s}=e,o=p(this,vi)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return p(this,Ma)}hide(){var e;p(this,Ma).classList.add("hidden"),(e=p(this,Na))==null||e.hideDropdown()}show(){var e,t;p(this,Ma).classList.remove("hidden"),(e=p(this,mv))==null||e.shown(),(t=p(this,La))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=p(this,vi),n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",p(lo,gv)[e]),_(this,Ur,ud).call(this,n)&&n.addEventListener("click",i=>{t.delete()},{signal:t._signal}),p(this,Si).append(n)}async addAltText(e){const t=await e.render();_(this,Ur,ud).call(this,t),p(this,Si).append(t,p(this,Ur,Wg)),E(this,mv,e)}addComment(e,t=null){if(p(this,La))return;const n=e.renderForToolbar();if(!n)return;_(this,Ur,ud).call(this,n);const i=E(this,wd,p(this,Ur,Wg));t?(p(this,Si).insertBefore(n,t),p(this,Si).insertBefore(i,t)):p(this,Si).append(n,i),E(this,La,e),e.toolbar=this}addColorPicker(e){if(p(this,Na))return;E(this,Na,e);const t=e.renderButton();_(this,Ur,ud).call(this,t),p(this,Si).append(t,p(this,Ur,Wg))}async addEditSignatureButton(e){const t=E(this,Pd,await e.renderEditButton(p(this,vi)));_(this,Ur,ud).call(this,t),p(this,Si).append(t,p(this,Ur,Wg))}removeButton(e){var t,n;switch(e){case"comment":(t=p(this,La))==null||t.removeToolbarCommentButton(),E(this,La,null),(n=p(this,wd))==null||n.remove(),E(this,wd,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,n){if(!t&&e==="comment")return;const i=p(this,Si).querySelector(n);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){p(this,Pd)&&(p(this,Pd).title=e)}remove(){var e;p(this,Ma).remove(),(e=p(this,Na))==null||e.destroy(),E(this,Na,null)}};Ma=new WeakMap,Na=new WeakMap,vi=new WeakMap,Si=new WeakMap,mv=new WeakMap,La=new WeakMap,wd=new WeakMap,Pd=new WeakMap,gv=new WeakMap,FC=new WeakSet,_O=function(e){e.stopPropagation()},Ur=new WeakSet,OO=function(e){p(this,vi)._focusEventsAllowed=!1,nr(e)},DO=function(e){p(this,vi)._focusEventsAllowed=!0,nr(e)},ud=function(e){const t=p(this,vi)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",_(this,Ur,OO).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",_(this,Ur,DO).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Mi,{signal:t}),!0)},Wg=function(){const e=document.createElement("div");return e.className="divider",e},N(lo,FC),N(lo,gv,null);let JT=lo;var vv,fc,ho,Yo,jO,BO,QT;class $6{constructor(e){N(this,Yo);N(this,vv,null);N(this,fc,null);N(this,ho);E(this,ho,e)}show(e,t,n){const[i,s]=_(this,Yo,BO).call(this,t,n),{style:o}=p(this,fc)||E(this,fc,_(this,Yo,jO).call(this));e.append(p(this,fc)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){p(this,fc).remove()}}vv=new WeakMap,fc=new WeakMap,ho=new WeakMap,Yo=new WeakSet,jO=function(){const e=E(this,fc,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=p(this,ho)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Mi,{signal:t});const n=E(this,vv,document.createElement("div"));return n.className="buttons",e.append(n),p(this,ho).hasCommentManager()&&_(this,Yo,QT).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{p(this,ho).commentSelection("floating_button")}),_(this,Yo,QT).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{p(this,ho).highlightSelection("floating_button")}),e},BO=function(e,t){let n=0,i=0;for(const s of e){const o=s.y+s.height;if(o<n)continue;const a=s.x+(t?s.width:0);if(o>n){i=a,n=o;continue}t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,n]},QT=function(e,t,n,i){const s=document.createElement("button");s.classList.add("basic",e),s.tabIndex=0,s.setAttribute("data-l10n-id",t);const o=document.createElement("span");s.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",n);const a=p(this,ho)._signal;a instanceof AbortSignal&&!a.aborted&&(s.addEventListener("contextmenu",Mi,{signal:a}),s.addEventListener("click",i,{signal:a})),p(this,vv).append(s)};function zO(r,e,t){for(const n of t)e.addEventListener(n,r[n].bind(r))}var mc,gc,Ed,vc;const At=class At{static initializeAndAddPointerId(e){(p(At,gc)||E(At,gc,new Set)).add(e)}static setPointer(e,t){p(At,mc)||E(At,mc,t),p(At,vc)??E(At,vc,e)}static setTimeStamp(e){E(At,Ed,e)}static isSamePointerId(e){return p(At,mc)===e}static isSamePointerIdOrRemove(e){var t;return p(At,mc)===e?!0:((t=p(At,gc))==null||t.delete(e),!1)}static isSamePointerType(e){return p(At,vc)===e}static isInitializedAndDifferentPointerType(e){return p(At,vc)!==null&&!At.isSamePointerType(e)}static isSameTimeStamp(e){return p(At,Ed)===e}static isUsingMultiplePointers(){var e;return((e=p(At,gc))==null?void 0:e.size)>=1}static clearPointerType(){E(At,vc,null)}static clearPointerIds(){E(At,mc,NaN),E(At,gc,null)}static clearTimeStamp(){E(At,Ed,NaN)}};mc=new WeakMap,gc=new WeakMap,Ed=new WeakMap,vc=new WeakMap,N(At,mc,NaN),N(At,gc,null),N(At,Ed,NaN),N(At,vc,null);let Gr=At;var WC;class H6{constructor(){N(this,WC,0)}get id(){return`${lv}${mr(this,WC)._++}`}}WC=new WeakMap;var Rd,Sv,Kr,Id,G0;const GP=class GP{constructor(){N(this,Id);N(this,Rd,IO());N(this,Sv,0);N(this,Kr,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const s=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return $e(this,"_isSVGFittingCanvas",s)}async getFromFile(e){const{lastModified:t,name:n,size:i,type:s}=e;return _(this,Id,G0).call(this,`${t}_${n}_${i}_${s}`,e)}async getFromUrl(e){return _(this,Id,G0).call(this,e,e)}async getFromBlob(e,t){const n=await t;return _(this,Id,G0).call(this,e,n)}async getFromId(e){p(this,Kr)||E(this,Kr,new Map);const t=p(this,Kr).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){p(this,Kr)||E(this,Kr,new Map);let n=p(this,Kr).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${p(this,Rd)}_${mr(this,Sv)._++}`,refCounter:1,isSvg:!1},p(this,Kr).set(e,n),p(this,Kr).set(n.id,n),n}getSvgUrl(e){const t=p(this,Kr).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;p(this,Kr)||E(this,Kr,new Map);const t=p(this,Kr).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=s.convertToBlob()}(i=n.close)==null||i.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${p(this,Rd)}_`)}};Rd=new WeakMap,Sv=new WeakMap,Kr=new WeakMap,Id=new WeakSet,G0=async function(e,t){p(this,Kr)||E(this,Kr,new Map);let n=p(this,Kr).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${p(this,Rd)}_${mr(this,Sv)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(n.url=t,i=await ly(t,"blob")):t instanceof File?i=n.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const s=GP._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((u,h)=>{a.onload=()=>{n.bitmap=a,n.isSvg=!0,u()},o.onload=async()=>{const m=n.svgUrl=o.result;a.src=await s?`${m}#svgView(preserveAspectRatio(none))`:m},a.onerror=o.onerror=h});o.readAsDataURL(i),await l}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){Ue(i),n=null}return p(this,Kr).set(e,n),n&&p(this,Kr).set(n.id,n),n};let ew=GP;var or,_a,yv,qt;class V6{constructor(e=128){N(this,or,[]);N(this,_a,!1);N(this,yv);N(this,qt,-1);E(this,yv,e)}add({cmd:e,undo:t,post:n,mustExec:i,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(i&&e(),p(this,_a))return;const l={cmd:e,undo:t,post:n,type:s};if(p(this,qt)===-1){p(this,or).length>0&&(p(this,or).length=0),E(this,qt,0),p(this,or).push(l);return}if(o&&p(this,or)[p(this,qt)].type===s){a&&(l.undo=p(this,or)[p(this,qt)].undo),p(this,or)[p(this,qt)]=l;return}const u=p(this,qt)+1;u===p(this,yv)?p(this,or).splice(0,1):(E(this,qt,u),u<p(this,or).length&&p(this,or).splice(u)),p(this,or).push(l)}undo(){if(p(this,qt)===-1)return;E(this,_a,!0);const{undo:e,post:t}=p(this,or)[p(this,qt)];e(),t==null||t(),E(this,_a,!1),E(this,qt,p(this,qt)-1)}redo(){if(p(this,qt)<p(this,or).length-1){E(this,qt,p(this,qt)+1),E(this,_a,!0);const{cmd:e,post:t}=p(this,or)[p(this,qt)];e(),t==null||t(),E(this,_a,!1)}}hasSomethingToUndo(){return p(this,qt)!==-1}hasSomethingToRedo(){return p(this,qt)<p(this,or).length-1}cleanType(e){if(p(this,qt)!==-1){for(let t=p(this,qt);t>=0;t--)if(p(this,or)[t].type!==e){p(this,or).splice(t+1,p(this,qt)-t),E(this,qt,t);return}p(this,or).length=0,E(this,qt,-1)}}destroy(){E(this,or,null)}}or=new WeakMap,_a=new WeakMap,yv=new WeakMap,qt=new WeakMap;var UC,FO;class dy{constructor(e){N(this,UC);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Ar.platform;for(const[n,i,s={}]of e)for(const o of n){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(_(this,UC,FO).call(this,t));if(!n)return;const{callback:i,options:{bubbles:s=!1,args:o=[],checker:a=null}}=n;a&&!a(e,t)||(i.bind(e,...o,t)(),s||nr(t))}}UC=new WeakSet,FO=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const ZC=class ZC{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return z6(e),$e(this,"_colors",e)}convert(e){const t=uy(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,i]of this._colors)if(i.every((s,o)=>s===t[o]))return ZC._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?we.makeHexColor(...t):e}};q(ZC,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let tw=ZC;var kd,Bn,Md,Xt,Sr,Nd,yi,Ld,Ci,Yr,Oa,Da,_d,ja,Ss,Ai,Sc,Cv,Av,Od,bv,ys,Ba,Dd,za,Cs,$C,Fa,jd,xv,Wa,yc,Bd,Ua,Tv,dr,gt,po,Za,$a,wv,zd,Pv,Ha,As,fo,Ev,Rv,bi,Te,K0,rw,WO,UO,Ug,ZO,$O,HO,nw,VO,qO,GO,KO,sn,oo,YO,XO,iw,JO,Zg,sw;const Cd=class Cd{constructor(e,t,n,i,s,o,a,l,u,h,m,g,v,y,A,x){N(this,Te);N(this,kd,new AbortController);N(this,Bn,null);N(this,Md,null);N(this,Xt,new Map);N(this,Sr,new Map);N(this,Nd,null);N(this,yi,null);N(this,Ld,null);N(this,Ci,new V6);N(this,Yr,null);N(this,Oa,null);N(this,Da,null);N(this,_d,0);N(this,ja,new Set);N(this,Ss,null);N(this,Ai,null);N(this,Sc,new Set);q(this,"_editorUndoBar",null);N(this,Cv,!1);N(this,Av,!1);N(this,Od,!1);N(this,bv,null);N(this,ys,null);N(this,Ba,null);N(this,Dd,null);N(this,za,!1);N(this,Cs,null);N(this,$C,new H6);N(this,Fa,!1);N(this,jd,!1);N(this,xv,!1);N(this,Wa,null);N(this,yc,null);N(this,Bd,null);N(this,Ua,null);N(this,Tv,null);N(this,dr,Ve.NONE);N(this,gt,new Set);N(this,po,null);N(this,Za,null);N(this,$a,null);N(this,wv,null);N(this,zd,null);N(this,Pv,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});N(this,Ha,[0,0]);N(this,As,null);N(this,fo,null);N(this,Ev,null);N(this,Rv,null);N(this,bi,null);const b=this._signal=p(this,kd).signal;E(this,fo,e),E(this,Ev,t),E(this,Rv,n),E(this,Nd,i),E(this,Yr,s),E(this,Za,o),E(this,zd,l),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:b}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),a._on("setpreference",this.onSetPreference.bind(this),{signal:b}),a._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:b}),window.addEventListener("pointerdown",()=>{E(this,jd,!0)},{capture:!0,signal:b}),window.addEventListener("pointerup",()=>{E(this,jd,!1)},{capture:!0,signal:b}),_(this,Te,ZO).call(this),_(this,Te,KO).call(this),_(this,Te,nw).call(this),E(this,yi,l.annotationStorage),E(this,bv,l.filterFactory),E(this,$a,u),E(this,Dd,h||null),E(this,Cv,m),E(this,Av,g),E(this,Od,v),E(this,Tv,y||null),this.viewParameters={realScale:xl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=A||null,this._supportsPinchToZoom=x!==!1,s==null||s.setSidebarUiManager(this)}static get _keyboardManager(){const e=Cd.prototype,t=o=>p(o,fo).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),n=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return $e(this,"_keyboardManager",new dy([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&p(o,fo).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&p(o,fo).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}destroy(){var e,t,n,i,s,o,a,l,u;(e=p(this,bi))==null||e.resolve(),E(this,bi,null),(t=p(this,kd))==null||t.abort(),E(this,kd,null),this._signal=null;for(const h of p(this,Sr).values())h.destroy();p(this,Sr).clear(),p(this,Xt).clear(),p(this,Sc).clear(),(n=p(this,Ua))==null||n.clear(),E(this,Bn,null),p(this,gt).clear(),p(this,Ci).destroy(),(i=p(this,Nd))==null||i.destroy(),(s=p(this,Yr))==null||s.destroy(),(o=p(this,Za))==null||o.destroy(),(a=p(this,Cs))==null||a.hide(),E(this,Cs,null),(l=p(this,Bd))==null||l.destroy(),E(this,Bd,null),E(this,Md,null),p(this,ys)&&(clearTimeout(p(this,ys)),E(this,ys,null)),p(this,As)&&(clearTimeout(p(this,As)),E(this,As,null)),(u=this._editorUndoBar)==null||u.destroy(),E(this,zd,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return p(this,Tv)}get useNewAltTextFlow(){return p(this,Av)}get useNewAltTextWhenAddingImage(){return p(this,Od)}get hcmFilter(){return $e(this,"hcmFilter",p(this,$a)?p(this,bv).addHCMFilter(p(this,$a).foreground,p(this,$a).background):"none")}get direction(){return $e(this,"direction",getComputedStyle(p(this,fo)).direction)}get _highlightColors(){return $e(this,"_highlightColors",p(this,Dd)?new Map(p(this,Dd).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return $e(this,"highlightColors",null);const t=new Map,n=!!p(this,$a);for(const[i,s]of e){const o=i.endsWith("_HCM");if(n&&o){t.set(i.replace("_HCM",""),s);continue}!n&&!o&&t.set(i,s)}return $e(this,"highlightColors",t)}get highlightColorNames(){return $e(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),E(this,Da,e)}setMainHighlightColorPicker(e){E(this,Bd,e)}editAltText(e,t=!1){var n;(n=p(this,Nd))==null||n.editAltText(this,e,t)}hasCommentManager(){return!!p(this,Yr)}editComment(e,t,n,i){var s;(s=p(this,Yr))==null||s.showDialog(this,e,t,n,i)}selectComment(e,t){const n=p(this,Sr).get(e),i=n==null?void 0:n.getEditorByUID(t);i==null||i.toggleComment(!0,!0)}updateComment(e){var t;(t=p(this,Yr))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=p(this,Yr))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=p(this,Yr))==null||t.removeComments([e.uid])}toggleComment(e,t,n=void 0){var i;(i=p(this,Yr))==null||i.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){var n;return e&&((n=p(this,Yr))==null?void 0:n.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=p(this,Yr))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(p(this,Sr).has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),i=s=>{s.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await n}getSignature(e){var t;(t=p(this,Za))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return p(this,Za)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":E(this,Od,t);break}}onPageChanging({pageNumber:e}){E(this,_d,e-1)}focusMainContainer(){p(this,fo).focus()}findParent(e,t){for(const n of p(this,Sr).values()){const{x:i,y:s,width:o,height:a}=n.div.getBoundingClientRect();if(e>=i&&e<=i+o&&t>=s&&t<=s+a)return n}return null}disableUserSelect(e=!1){p(this,Ev).classList.toggle("noUserSelect",e)}addShouldRescale(e){p(this,Sc).add(e)}removeShouldRescale(e){p(this,Sc).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*xl.PDF_TO_CSS_UNITS;for(const n of p(this,Sc))n.onScaleChanging();(t=p(this,Da))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:o,focusOffset:a}=n,l=n.toString(),h=_(this,Te,K0).call(this,n).closest(".textLayer"),m=this.getSelectionBoxes(h);if(!m)return;n.empty();const g=_(this,Te,rw).call(this,h),v=p(this,dr)===Ve.NONE,y=()=>{const A=g==null?void 0:g.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:m,anchorNode:i,anchorOffset:s,focusNode:o,focusOffset:a,text:l});v&&this.showAllEditors("highlight",!0,!0),t&&(A==null||A.editComment())};if(v){this.switchToMode(Ve.HIGHLIGHT,y);return}y()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!p(this,yi))return null;const t=`${lv}${e}`,n=p(this,yi).getRawValue(t);return n&&p(this,yi).remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&p(this,yi)&&!p(this,yi).has(e.id)&&p(this,yi).setValue(e.id,e)}a11yAlert(e,t=null){const n=p(this,Rv);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,p(this,za)&&(E(this,za,!1),_(this,Te,Ug).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of p(this,gt))if(t.div.contains(e)){E(this,yc,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!p(this,yc))return;const[e,t]=p(this,yc);E(this,yc,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){_(this,Te,nw).call(this),this.setEditingState(!0)}removeEditListeners(){_(this,Te,VO).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of p(this,Ai))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of p(this,Ai))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=p(this,Bn))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of p(this,gt)){const s=i.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const o of p(this,Ai))if(o.isHandlingMimeForPasting(s.type)){o.paste(s,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(s){Ue(`paste: "${s.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const l of n){const u=await i.deserialize(l);if(!u)return;s.push(u)}const o=()=>{for(const l of s)_(this,Te,iw).call(this,l);_(this,Te,sw).call(this,s)},a=()=>{for(const l of s)l.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(s){Ue(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),p(this,dr)!==Ve.NONE&&!this.isEditorHandlingKeyboard&&Cd._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,p(this,za)&&(E(this,za,!1),_(this,Te,Ug).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(_(this,Te,$O).call(this),_(this,Te,qO).call(this),_(this,Te,sn).call(this,{isEditing:p(this,dr)!==Ve.NONE,isEmpty:_(this,Te,Zg).call(this),hasSomethingToUndo:p(this,Ci).hasSomethingToUndo(),hasSomethingToRedo:p(this,Ci).hasSomethingToRedo(),hasSelectedEditor:!1})):(_(this,Te,HO).call(this),_(this,Te,GO).call(this),_(this,Te,sn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!p(this,Ai)){E(this,Ai,e);for(const t of p(this,Ai))_(this,Te,oo).call(this,t.defaultPropertiesToUpdate)}}getId(){return p(this,$C).id}get currentLayer(){return p(this,Sr).get(p(this,_d))}getLayer(e){return p(this,Sr).get(e)}get currentPageIndex(){return p(this,_d)}addLayer(e){p(this,Sr).set(e.pageIndex,e),p(this,Fa)?e.enable():e.disable()}removeLayer(e){p(this,Sr).delete(e.pageIndex)}async updateMode(e,t=null,n=!1,i=!1,s=!1,o=!1){var a,l,u,h,m,g;if(p(this,dr)!==e&&!(p(this,bi)&&(await p(this,bi).promise,!p(this,bi)))){if(E(this,bi,Promise.withResolvers()),(a=p(this,Da))==null||a.commitOrRemove(),p(this,dr)===Ve.POPUP&&((l=p(this,Yr))==null||l.hideSidebar()),(u=p(this,Yr))==null||u.destroyPopup(),E(this,dr,e),e===Ve.NONE){this.setEditingState(!1),_(this,Te,XO).call(this);for(const v of p(this,Xt).values())v.hideStandaloneCommentButton();(h=this._editorUndoBar)==null||h.hide(),this.toggleComment(null),p(this,bi).resolve();return}for(const v of p(this,Xt).values())v.addStandaloneCommentButton();e===Ve.SIGNATURE&&await((m=p(this,Za))==null?void 0:m.loadSignatures()),n&&Gr.clearPointerType(),this.setEditingState(!0),await _(this,Te,YO).call(this),this.unselectAll();for(const v of p(this,Sr).values())v.updateMode(e);if(e===Ve.POPUP){p(this,Md)||E(this,Md,await p(this,zd).getAnnotationsByType(new Set(p(this,Ai).map(A=>A._editorType))));const v=new Set,y=[];for(const A of p(this,Xt).values()){const{annotationElementId:x,hasComment:b,deleted:w}=A;x&&v.add(x),b&&!w&&y.push(A.getData())}for(const A of p(this,Md)){const{id:x,popupRef:b,contentsObj:w}=A;b&&(w!=null&&w.str)&&!v.has(x)&&!p(this,ja).has(x)&&y.push(A)}(g=p(this,Yr))==null||g.showSidebar(y)}if(!t){i&&this.addNewEditorFromKeyboard(),p(this,bi).resolve();return}for(const v of p(this,Xt).values())v.uid===t?(this.setSelected(v),o?v.editComment():s?v.enterInEditMode():v.focus()):v.unselect();p(this,bi).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==p(this,dr)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(p(this,Ai)){switch(e){case st.CREATE:this.currentLayer.addNewEditor(t);return;case st.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(p(this,wv)||E(this,wv,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of p(this,gt))n.updateParams(e,t);else for(const n of p(this,Ai))n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var s;for(const o of p(this,Xt).values())o.editorType===e&&o.show(t);(((s=p(this,wv))==null?void 0:s.get(st.HIGHLIGHT_SHOW_ALL))??!0)!==t&&_(this,Te,oo).call(this,[[st.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(p(this,xv)!==e){E(this,xv,e);for(const t of p(this,Sr).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of p(this,Xt).values())t.pageIndex===e&&(yield t)}getEditor(e){return p(this,Xt).get(e)}addEditor(e){p(this,Xt).set(e.id,e)}removeEditor(e){var t,n;e.div.contains(document.activeElement)&&(p(this,ys)&&clearTimeout(p(this,ys)),E(this,ys,setTimeout(()=>{this.focusMainContainer(),E(this,ys,null)},0))),p(this,Xt).delete(e.id),e.annotationElementId&&((t=p(this,Ua))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!p(this,ja).has(e.annotationElementId))&&((n=p(this,yi))==null||n.remove(e.id))}addDeletedAnnotationElement(e){p(this,ja).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return p(this,ja).has(e)}removeDeletedAnnotationElement(e){p(this,ja).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){p(this,Bn)!==e&&(E(this,Bn,e),e&&_(this,Te,oo).call(this,e.propertiesToUpdate))}updateUI(e){p(this,Te,JO)===e&&_(this,Te,oo).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){_(this,Te,oo).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(p(this,gt).has(e)){p(this,gt).delete(e),e.unselect(),_(this,Te,sn).call(this,{hasSelectedEditor:this.hasSelection});return}p(this,gt).add(e),e.select(),_(this,Te,oo).call(this,e.propertiesToUpdate),_(this,Te,sn).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=p(this,Da))==null||t.commitOrRemove();for(const n of p(this,gt))n!==e&&n.unselect();p(this,gt).clear(),p(this,gt).add(e),e.select(),_(this,Te,oo).call(this,e.propertiesToUpdate),_(this,Te,sn).call(this,{hasSelectedEditor:!0})}isSelected(e){return p(this,gt).has(e)}get firstSelectedEditor(){return p(this,gt).values().next().value}unselect(e){e.unselect(),p(this,gt).delete(e),_(this,Te,sn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return p(this,gt).size!==0}get isEnterHandled(){return p(this,gt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;p(this,Ci).undo(),_(this,Te,sn).call(this,{hasSomethingToUndo:p(this,Ci).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:_(this,Te,Zg).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){p(this,Ci).redo(),_(this,Te,sn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:p(this,Ci).hasSomethingToRedo(),isEmpty:_(this,Te,Zg).call(this)})}addCommands(e){p(this,Ci).add(e),_(this,Te,sn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:_(this,Te,Zg).call(this)})}cleanUndoStack(e){p(this,Ci).cleanType(e)}delete(){var s;this.commitOrRemove();const e=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...p(this,gt)],n=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},i=()=>{for(const o of t)_(this,Te,iw).call(this,o)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=p(this,Bn))==null||e.commitOrRemove()}hasSomethingToControl(){return p(this,Bn)||this.hasSelection}selectAll(){for(const e of p(this,gt))e.commit();_(this,Te,sw).call(this,p(this,Xt).values())}unselectAll(){var e;if(!(p(this,Bn)&&(p(this,Bn).commitOrRemove(),p(this,dr)!==Ve.NONE))&&!((e=p(this,Da))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of p(this,gt))t.unselect();p(this,gt).clear(),_(this,Te,sn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;p(this,Ha)[0]+=e,p(this,Ha)[1]+=t;const[i,s]=p(this,Ha),o=[...p(this,gt)],a=1e3;p(this,As)&&clearTimeout(p(this,As)),E(this,As,setTimeout(()=>{E(this,As,null),p(this,Ha)[0]=p(this,Ha)[1]=0,this.addCommands({cmd:()=>{for(const l of o)p(this,Xt).has(l.id)&&(l.translateInPage(i,s),l.translationDone())},undo:()=>{for(const l of o)p(this,Xt).has(l.id)&&(l.translateInPage(-i,-s),l.translationDone())},mustExec:!1})},a));for(const l of o)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),E(this,Ss,new Map);for(const e of p(this,gt))p(this,Ss).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!p(this,Ss))return!1;this.disableUserSelect(!1);const e=p(this,Ss);E(this,Ss,null);let t=!1;for(const[{x:i,y:s,pageIndex:o},a]of e)a.newX=i,a.newY=s,a.newPageIndex=o,t||(t=i!==a.savedX||s!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const n=(i,s,o,a)=>{if(p(this,Xt).has(i.id)){const l=p(this,Sr).get(a);l?i._setParentAndPosition(l,s,o):(i.pageIndex=a,i.x=s,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:o,newPageIndex:a}]of e)n(i,s,o,a)},undo:()=>{for(const[i,{savedX:s,savedY:o,savedPageIndex:a}]of e)n(i,s,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(p(this,Ss))for(const n of p(this,Ss).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||p(this,gt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return p(this,Bn)===e}getActive(){return p(this,Bn)}getMode(){return p(this,dr)}isEditingMode(){return p(this,dr)!==Ve.NONE}get imageManager(){return $e(this,"imageManager",new ew)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:n,y:i,width:s,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(u,h,m,g)=>({x:(h-i)/o,y:1-(u+m-n)/s,width:g/o,height:m/s});break;case"180":a=(u,h,m,g)=>({x:1-(u+m-n)/s,y:1-(h+g-i)/o,width:m/s,height:g/o});break;case"270":a=(u,h,m,g)=>({x:1-(h+g-i)/o,y:(u-n)/s,width:g/o,height:m/s});break;default:a=(u,h,m,g)=>({x:(u-n)/s,y:(h-i)/o,width:m/s,height:g/o});break}const l=[];for(let u=0,h=t.rangeCount;u<h;u++){const m=t.getRangeAt(u);if(!m.collapsed)for(const{x:g,y:v,width:y,height:A}of m.getClientRects())y===0||A===0||l.push(a(g,v,y,A))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(p(this,Ld)||E(this,Ld,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=p(this,Ld))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=p(this,Ld))==null?void 0:i.get(e.data.id);if(!t)return;const n=p(this,yi).getRawValue(t);n&&(p(this,dr)===Ve.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){var s;const i=(s=p(this,Ua))==null?void 0:s.get(e);i&&(i.setCanvas(t,n),p(this,Ua).delete(e))}addMissingCanvas(e,t){(p(this,Ua)||E(this,Ua,new Map)).set(e,t)}};kd=new WeakMap,Bn=new WeakMap,Md=new WeakMap,Xt=new WeakMap,Sr=new WeakMap,Nd=new WeakMap,yi=new WeakMap,Ld=new WeakMap,Ci=new WeakMap,Yr=new WeakMap,Oa=new WeakMap,Da=new WeakMap,_d=new WeakMap,ja=new WeakMap,Ss=new WeakMap,Ai=new WeakMap,Sc=new WeakMap,Cv=new WeakMap,Av=new WeakMap,Od=new WeakMap,bv=new WeakMap,ys=new WeakMap,Ba=new WeakMap,Dd=new WeakMap,za=new WeakMap,Cs=new WeakMap,$C=new WeakMap,Fa=new WeakMap,jd=new WeakMap,xv=new WeakMap,Wa=new WeakMap,yc=new WeakMap,Bd=new WeakMap,Ua=new WeakMap,Tv=new WeakMap,dr=new WeakMap,gt=new WeakMap,po=new WeakMap,Za=new WeakMap,$a=new WeakMap,wv=new WeakMap,zd=new WeakMap,Pv=new WeakMap,Ha=new WeakMap,As=new WeakMap,fo=new WeakMap,Ev=new WeakMap,Rv=new WeakMap,bi=new WeakMap,Te=new WeakSet,K0=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},rw=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of p(this,Sr).values())if(n.hasTextLayer(e))return n;return null},WO=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=_(this,Te,K0).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(p(this,Cs)||E(this,Cs,new $6(this)),p(this,Cs).show(n,i,this.direction==="ltr"))},UO=function(){var s,o,a;const e=document.getSelection();if(!e||e.isCollapsed){p(this,po)&&((s=p(this,Cs))==null||s.hide(),E(this,po,null),_(this,Te,sn).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===p(this,po))return;const i=_(this,Te,K0).call(this,e).closest(".textLayer");if(!i){p(this,po)&&((o=p(this,Cs))==null||o.hide(),E(this,po,null),_(this,Te,sn).call(this,{hasSelectedText:!1}));return}if((a=p(this,Cs))==null||a.hide(),E(this,po,t),_(this,Te,sn).call(this,{hasSelectedText:!0}),!(p(this,dr)!==Ve.HIGHLIGHT&&p(this,dr)!==Ve.NONE)&&(p(this,dr)===Ve.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),E(this,za,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=p(this,dr)===Ve.HIGHLIGHT?_(this,Te,rw).call(this,i):null;if(l==null||l.toggleDrawing(),p(this,jd)){const u=new AbortController,h=this.combinedSignal(u),m=g=>{g.type==="pointerup"&&g.button!==0||(u.abort(),l==null||l.toggleDrawing(!0),g.type==="pointerup"&&_(this,Te,Ug).call(this,"main_toolbar"))};window.addEventListener("pointerup",m,{signal:h}),window.addEventListener("blur",m,{signal:h})}else l==null||l.toggleDrawing(!0),_(this,Te,Ug).call(this,"main_toolbar")}},Ug=function(e=""){p(this,dr)===Ve.HIGHLIGHT?this.highlightSelection(e):p(this,Cv)&&_(this,Te,WO).call(this)},ZO=function(){document.addEventListener("selectionchange",_(this,Te,UO).bind(this),{signal:this._signal})},$O=function(){if(p(this,Ba))return;E(this,Ba,new AbortController);const e=this.combinedSignal(p(this,Ba));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},HO=function(){var e;(e=p(this,Ba))==null||e.abort(),E(this,Ba,null)},nw=function(){if(p(this,Wa))return;E(this,Wa,new AbortController);const e=this.combinedSignal(p(this,Wa));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},VO=function(){var e;(e=p(this,Wa))==null||e.abort(),E(this,Wa,null)},qO=function(){if(p(this,Oa))return;E(this,Oa,new AbortController);const e=this.combinedSignal(p(this,Oa));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},GO=function(){var e;(e=p(this,Oa))==null||e.abort(),E(this,Oa,null)},KO=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},sn=function(e){Object.entries(e).some(([n,i])=>p(this,Pv)[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(p(this,Pv),e)}),p(this,dr)===Ve.HIGHLIGHT&&e.hasSelectedEditor===!1&&_(this,Te,oo).call(this,[[st.HIGHLIGHT_FREE,!0]]))},oo=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},YO=async function(){if(!p(this,Fa)){E(this,Fa,!0);const e=[];for(const t of p(this,Sr).values())e.push(t.enable());await Promise.all(e);for(const t of p(this,Xt).values())t.enable()}},XO=function(){if(this.unselectAll(),p(this,Fa)){E(this,Fa,!1);for(const e of p(this,Sr).values())e.disable();for(const e of p(this,Xt).values())e.disable()}},iw=function(e){const t=p(this,Sr).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},JO=function(){let e=null;for(e of p(this,gt));return e},Zg=function(){if(p(this,Xt).size===0)return!0;if(p(this,Xt).size===1)for(const e of p(this,Xt).values())return e.isEmpty();return!1},sw=function(e){for(const t of p(this,gt))t.unselect();p(this,gt).clear();for(const t of e)t.isEmpty()||(p(this,gt).add(t),t.select());_(this,Te,sn).call(this,{hasSelectedEditor:this.hasSelection})},q(Cd,"TRANSLATE_SMALL",1),q(Cd,"TRANSLATE_BIG",10);let ku=Cd;var wr,bs,$i,Fd,xs,zn,Wd,Ts,bn,mo,Cc,ws,Va,rs,$g,Y0;const on=class on{constructor(e){N(this,rs);N(this,wr,null);N(this,bs,!1);N(this,$i,null);N(this,Fd,null);N(this,xs,null);N(this,zn,null);N(this,Wd,!1);N(this,Ts,null);N(this,bn,null);N(this,mo,null);N(this,Cc,null);N(this,ws,!1);E(this,bn,e),E(this,ws,e._uiManager.useNewAltTextFlow),p(on,Va)||E(on,Va,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){on._l10n??(on._l10n=e)}async render(){const e=E(this,$i,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=E(this,Fd,document.createElement("span"));e.append(t),p(this,ws)?(e.classList.add("new"),e.setAttribute("data-l10n-id",p(on,Va).missing),t.setAttribute("data-l10n-id",p(on,Va)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=p(this,bn)._uiManager._signal;e.addEventListener("contextmenu",Mi,{signal:n}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:n});const i=s=>{s.preventDefault(),p(this,bn)._uiManager.editAltText(p(this,bn)),p(this,ws)&&p(this,bn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:p(this,rs,$g)}})};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(E(this,Wd,!0),i(s))},{signal:n}),await _(this,rs,Y0).call(this),e}finish(){p(this,$i)&&(p(this,$i).focus({focusVisible:p(this,Wd)}),E(this,Wd,!1))}isEmpty(){return p(this,ws)?p(this,wr)===null:!p(this,wr)&&!p(this,bs)}hasData(){return p(this,ws)?p(this,wr)!==null||!!p(this,mo):this.isEmpty()}get guessedText(){return p(this,mo)}async setGuessedText(e){p(this,wr)===null&&(E(this,mo,e),E(this,Cc,await on._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),_(this,rs,Y0).call(this))}toggleAltTextBadge(e=!1){var t;if(!p(this,ws)||p(this,wr)){(t=p(this,Ts))==null||t.remove(),E(this,Ts,null);return}if(!p(this,Ts)){const n=E(this,Ts,document.createElement("div"));n.className="noAltTextBadge",p(this,bn).div.append(n)}p(this,Ts).classList.toggle("hidden",!e)}serialize(e){let t=p(this,wr);return!e&&p(this,mo)===t&&(t=p(this,Cc)),{altText:t,decorative:p(this,bs),guessedText:p(this,mo),textWithDisclaimer:p(this,Cc)}}get data(){return{altText:p(this,wr),decorative:p(this,bs)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:i,cancel:s=!1}){n&&(E(this,mo,n),E(this,Cc,i)),!(p(this,wr)===e&&p(this,bs)===t)&&(s||(E(this,wr,e),E(this,bs,t)),_(this,rs,Y0).call(this))}toggle(e=!1){p(this,$i)&&(!e&&p(this,zn)&&(clearTimeout(p(this,zn)),E(this,zn,null)),p(this,$i).disabled=!e)}shown(){p(this,bn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:p(this,rs,$g)}})}destroy(){var e,t;(e=p(this,$i))==null||e.remove(),E(this,$i,null),E(this,Fd,null),E(this,xs,null),(t=p(this,Ts))==null||t.remove(),E(this,Ts,null)}};wr=new WeakMap,bs=new WeakMap,$i=new WeakMap,Fd=new WeakMap,xs=new WeakMap,zn=new WeakMap,Wd=new WeakMap,Ts=new WeakMap,bn=new WeakMap,mo=new WeakMap,Cc=new WeakMap,ws=new WeakMap,Va=new WeakMap,rs=new WeakSet,$g=function(){return p(this,wr)&&"added"||p(this,wr)===null&&this.guessedText&&"review"||"missing"},Y0=async function(){var i,s,o;const e=p(this,$i);if(!e)return;if(p(this,ws)){if(e.classList.toggle("done",!!p(this,wr)),e.setAttribute("data-l10n-id",p(on,Va)[p(this,rs,$g)]),(i=p(this,Fd))==null||i.setAttribute("data-l10n-id",p(on,Va)[`${p(this,rs,$g)}-label`]),!p(this,wr)){(s=p(this,xs))==null||s.remove();return}}else{if(!p(this,wr)&&!p(this,bs)){e.classList.remove("done"),(o=p(this,xs))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=p(this,xs);if(!t){E(this,xs,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${p(this,bn).id}`;const a=100,l=p(this,bn)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(p(this,zn)),E(this,zn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{E(this,zn,setTimeout(()=>{E(this,zn,null),p(this,xs).classList.add("show"),p(this,bn)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:l}),e.addEventListener("mouseleave",()=>{var u;p(this,zn)&&(clearTimeout(p(this,zn)),E(this,zn,null)),(u=p(this,xs))==null||u.classList.remove("show")},{signal:l})}p(this,bs)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=p(this,wr)),t.parentNode||e.append(t);const n=p(this,bn).getElementForAltText();n==null||n.setAttribute("aria-describedby",t.id)},N(on,Va,null),q(on,"_l10n",null);let RC=on;var Or,xi,Ac,Lt,Iv,bc,Hi,xc,Tc,wc,kv,ow;class L0{constructor(e){N(this,kv);N(this,Or,null);N(this,xi,null);N(this,Ac,!1);N(this,Lt,null);N(this,Iv,null);N(this,bc,null);N(this,Hi,null);N(this,xc,null);N(this,Tc,!1);N(this,wc,null);E(this,Lt,e)}renderForToolbar(){const e=E(this,xi,document.createElement("button"));return e.className="comment",_(this,kv,ow).call(this,e,!1)}renderForStandalone(){const e=E(this,Or,document.createElement("button"));e.className="annotationCommentButton";const t=p(this,Lt).commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(p(this,Lt)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=p(this,Lt).commentButtonColor;i&&(n.backgroundColor=i)}return _(this,kv,ow).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=p(this,Or)??p(this,xi))==null||e.focus()},0)}onUpdatedColor(){if(!p(this,Or))return;const e=p(this,Lt).commentButtonColor;e&&(p(this,Or).style.backgroundColor=e),p(this,Lt)._uiManager.updatePopupColor(p(this,Lt))}get commentButtonWidth(){var e;return(((e=p(this,Or))==null?void 0:e.getBoundingClientRect().width)??0)/p(this,Lt).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(p(this,wc))return p(this,wc);if(!p(this,Or))return null;const{x:e,y:t,height:n}=p(this,Or).getBoundingClientRect(),{x:i,y:s,width:o,height:a}=p(this,Lt).parent.boundingClientRect;return[(e-i)/o,(t+n-s)/a]}set commentPopupPositionInLayer(e){E(this,wc,e)}hasDefaultPopupPosition(){return p(this,wc)===null}removeStandaloneCommentButton(){var e;(e=p(this,Or))==null||e.remove(),E(this,Or,null)}removeToolbarCommentButton(){var e;(e=p(this,xi))==null||e.remove(),E(this,xi,null)}setCommentButtonStates({selected:e,hasPopup:t}){p(this,Or)&&(p(this,Or).classList.toggle("selected",e),p(this,Or).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let n,i;if(t)[n,i]=t;else{[n,i]=p(this,Lt).commentButtonPosition;const{width:h,height:m,x:g,y:v}=p(this,Lt);n=g+n*h,i=v+i*m}const s=p(this,Lt).parent.boundingClientRect,{x:o,y:a,width:l,height:u}=s;p(this,Lt)._uiManager.editComment(p(this,Lt),o+n*l,a+i*u,{...e,parentDimensions:s})}finish(){p(this,xi)&&(p(this,xi).focus({focusVisible:p(this,Ac)}),E(this,Ac,!1))}isDeleted(){return p(this,Tc)||p(this,Hi)===""}isEmpty(){return p(this,Hi)===null}hasBeenEdited(){return this.isDeleted()||p(this,Hi)!==p(this,Iv)}serialize(){return this.data}get data(){return{text:p(this,Hi),richText:p(this,bc),date:p(this,xc),deleted:this.isDeleted()}}set data(e){if(e!==p(this,Hi)&&E(this,bc,null),e===null){E(this,Hi,""),E(this,Tc,!0);return}E(this,Hi,e),E(this,xc,new Date),E(this,Tc,!1)}setInitialText(e,t=null){E(this,Iv,e),this.data=e,E(this,xc,null),E(this,bc,t)}shown(){}destroy(){var e,t;(e=p(this,xi))==null||e.remove(),E(this,xi,null),(t=p(this,Or))==null||t.remove(),E(this,Or,null),E(this,Hi,""),E(this,bc,null),E(this,xc,null),E(this,Lt,null),E(this,Ac,!1),E(this,Tc,!1)}}Or=new WeakMap,xi=new WeakMap,Ac=new WeakMap,Lt=new WeakMap,Iv=new WeakMap,bc=new WeakMap,Hi=new WeakMap,xc=new WeakMap,Tc=new WeakMap,wc=new WeakMap,kv=new WeakSet,ow=function(e,t){if(!p(this,Lt)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[p(this,Lt)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=p(this,Lt)._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",Mi,{signal:n}),t&&(e.addEventListener("focusin",s=>{p(this,Lt)._focusEventsAllowed=!1,nr(s)},{capture:!0,signal:n}),e.addEventListener("focusout",s=>{p(this,Lt)._focusEventsAllowed=!0,nr(s)},{capture:!0,signal:n})),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:n});const i=s=>{s.preventDefault(),e===p(this,xi)?this.edit():p(this,Lt).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(E(this,Ac,!0),i(s))},{signal:n}),e.addEventListener("pointerenter",()=>{p(this,Lt).toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{p(this,Lt).toggleComment(!1,!1)},{signal:n}),e};var Ud,Pc,Mv,Nv,Lv,_v,Ov,go,Ec,vo,Rc,So,Tl,QO,eD,tD;const KP=class KP{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:o=null,signal:a}){N(this,Tl);N(this,Ud);N(this,Pc,!1);N(this,Mv,null);N(this,Nv);N(this,Lv);N(this,_v);N(this,Ov);N(this,go,null);N(this,Ec);N(this,vo,null);N(this,Rc);N(this,So,null);E(this,Ud,e),E(this,Mv,n),E(this,Nv,t),E(this,Lv,i),E(this,_v,s),E(this,Ov,o),E(this,Rc,new AbortController),E(this,Ec,AbortSignal.any([a,p(this,Rc).signal])),e.addEventListener("touchstart",_(this,Tl,QO).bind(this),{passive:!1,signal:p(this,Ec)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ws.pixelRatio}destroy(){var e,t;(e=p(this,Rc))==null||e.abort(),E(this,Rc,null),(t=p(this,go))==null||t.abort(),E(this,go,null)}};Ud=new WeakMap,Pc=new WeakMap,Mv=new WeakMap,Nv=new WeakMap,Lv=new WeakMap,_v=new WeakMap,Ov=new WeakMap,go=new WeakMap,Ec=new WeakMap,vo=new WeakMap,Rc=new WeakMap,So=new WeakMap,Tl=new WeakSet,QO=function(e){var i,s,o;if((i=p(this,Nv))!=null&&i.call(this))return;if(e.touches.length===1){if(p(this,go))return;const a=E(this,go,new AbortController),l=AbortSignal.any([p(this,Ec),a.signal]),u=p(this,Ud),h={capture:!0,signal:l,passive:!1},m=g=>{var v;g.pointerType==="touch"&&((v=p(this,go))==null||v.abort(),E(this,go,null))};u.addEventListener("pointerdown",g=>{g.pointerType==="touch"&&(nr(g),m(g))},h),u.addEventListener("pointerup",m,h),u.addEventListener("pointercancel",m,h);return}if(!p(this,So)){E(this,So,new AbortController);const a=AbortSignal.any([p(this,Ec),p(this,So).signal]),l=p(this,Ud),u={signal:a,capture:!1,passive:!1};l.addEventListener("touchmove",_(this,Tl,eD).bind(this),u);const h=_(this,Tl,tD).bind(this);l.addEventListener("touchend",h,u),l.addEventListener("touchcancel",h,u),u.capture=!0,l.addEventListener("pointerdown",nr,u),l.addEventListener("pointermove",nr,u),l.addEventListener("pointercancel",nr,u),l.addEventListener("pointerup",nr,u),(s=p(this,Lv))==null||s.call(this)}if(nr(e),e.touches.length!==2||(o=p(this,Mv))!=null&&o.call(this)){E(this,vo,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),E(this,vo,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},eD=function(e){var k;if(!p(this,vo)||e.touches.length!==2)return;nr(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:i,screenY:s}=t,{screenX:o,screenY:a}=n,l=p(this,vo),{touch0X:u,touch0Y:h,touch1X:m,touch1Y:g}=l,v=m-u,y=g-h,A=o-i,x=a-s,b=Math.hypot(A,x)||1,w=Math.hypot(v,y)||1;if(!p(this,Pc)&&Math.abs(w-b)<=KP.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=i,l.touch0Y=s,l.touch1X=o,l.touch1Y=a,!p(this,Pc)){E(this,Pc,!0);return}const T=[(i+o)/2,(s+a)/2];(k=p(this,_v))==null||k.call(this,T,w,b)},tD=function(e){var t;e.touches.length>=2||(p(this,So)&&(p(this,So).abort(),E(this,So,null),(t=p(this,Ov))==null||t.call(this)),p(this,vo)&&(nr(e),E(this,vo,null),E(this,Pc,!1)))};let IC=KP;var Ic,Vi,Wt,Et,yo,Zd,qa,Dv,Dr,kc,Co,Ti,Ga,jv,Mc,Fn,Bv,Nc,Ao,Ps,$d,Hd,wi,Lc,zv,HC,ze,aw,Fv,lw,X0,rD,nD,cw,J0,uw,iD,sD,oD,dw,aD,hw,lD,cD,uD,pw,Hg;const He=class He{constructor(e){N(this,ze);N(this,Ic,null);N(this,Vi,null);N(this,Wt,null);N(this,Et,null);N(this,yo,null);N(this,Zd,!1);N(this,qa,null);N(this,Dv,"");N(this,Dr,null);N(this,kc,null);N(this,Co,null);N(this,Ti,null);N(this,Ga,null);N(this,jv,"");N(this,Mc,!1);N(this,Fn,null);N(this,Bv,!1);N(this,Nc,!1);N(this,Ao,!1);N(this,Ps,null);N(this,$d,0);N(this,Hd,0);N(this,wi,null);N(this,Lc,null);q(this,"isSelected",!1);q(this,"_isCopy",!1);q(this,"_editToolbar",null);q(this,"_initialOptions",Object.create(null));q(this,"_initialData",null);q(this,"_isVisible",!0);q(this,"_uiManager",null);q(this,"_focusEventsAllowed",!0);N(this,zv,!1);N(this,HC,He._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[s,o];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=He.prototype._resizeWithKeyboard,t=ku.TRANSLATE_SMALL,n=ku.TRANSLATE_BIG;return $e(this,"_resizerKeyboardManager",new dy([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],He.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return $e(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new q6({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(He._l10n??(He._l10n=e),He._l10nResizer||(He._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),He._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);He._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){kt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return p(this,zv)}set _isDraggable(e){var t;E(this,zv,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=p(this,HC)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(_(this,ze,Hg).call(this),(t=p(this,Ti))==null||t.remove(),E(this,Ti,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(p(this,Mc)?E(this,Mc,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[s,o]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/s,this.y=(t+i)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,i]=this.parentDimensions;this.setAt(e*n,t*i,this.width*n,this.height*i),this._onTranslated()}translate(e,t){_(this,ze,aw).call(this,this.parentDimensions,e,t)}translateInPage(e,t){p(this,Fn)||E(this,Fn,[this.x,this.y,this.width,this.height]),_(this,ze,aw).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){p(this,Fn)||E(this,Fn,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[i,s]}=this;if(this.x+=e/i,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:g}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,g)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[l,u]=this.getBaseTranslation();o+=l,a+=u;const{style:h}=n;h.left=`${(100*o).toFixed(2)}%`,h.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!p(this,Fn)&&(p(this,Fn)[0]!==this.x||p(this,Fn)[1]!==this.y)}get _hasBeenResized(){return!!p(this,Fn)&&(p(this,Fn)[2]!==this.width||p(this,Fn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=He,i=n/e,s=n/t;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,i]}=this;let{x:s,y:o,width:a,height:l}=this;if(a*=n,l*=i,s*=n,o*=i,this._mustFixPosition)switch(e){case 0:s=dn(s,0,n-a),o=dn(o,0,i-l);break;case 90:s=dn(s,0,n-l),o=dn(o,a,i);break;case 180:s=dn(s,a,n),o=dn(o,l,i);break;case 270:s=dn(s,l,n),o=dn(o,0,i-a);break}this.x=s/=n,this.y=o/=i;const[u,h]=this.getBaseTranslation();s+=u,o+=h,t.left=`${(100*s).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return _(n=He,Fv,lw).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return _(n=He,Fv,lw).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=p(this,Wt))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||p(this,Nc))return this._editToolbar;this._editToolbar=new JT(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=p(this,Wt))==null||t.destroy()}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return p(this,Wt)||(RC.initialize(He._l10n),E(this,Wt,new RC(this)),p(this,Ic)&&(p(this,Wt).data=p(this,Ic),E(this,Ic,null))),p(this,Wt)}get altTextData(){var e;return(e=p(this,Wt))==null?void 0:e.data}set altTextData(e){p(this,Wt)&&(p(this,Wt).data=e)}get guessedAltText(){var e;return(e=p(this,Wt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=p(this,Wt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=p(this,Wt))==null?void 0:t.serialize(e)}hasAltText(){return!!p(this,Wt)&&!p(this,Wt).isEmpty()}hasAltTextData(){var e;return((e=p(this,Wt))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=p(this,Et))==null||e.focusButton()}addCommentButton(){return this.canAddComment?p(this,Et)||E(this,Et,new L0(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(p(this,yo)){this._uiManager.isEditingMode()&&p(this,yo).classList.remove("hidden");return}this.hasComment&&(E(this,yo,p(this,Et).renderForStandalone()),this.div.append(p(this,yo)))}}removeStandaloneCommentButton(){p(this,Et).removeStandaloneCommentButton(),E(this,yo,null)}hideStandaloneCommentButton(){var e;(e=p(this,yo))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:n,deleted:i}}=p(this,Et);return{text:t,richText:e,date:n,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){p(this,Et)||E(this,Et,new L0(this)),p(this,Et).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(p(this,Et)||E(this,Et,new L0(this)),p(this,Et).setInitialText(e,n),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return(e=p(this,Et))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=p(this,Et))==null?void 0:e.isDeleted()}get hasComment(){return!!p(this,Et)&&!p(this,Et).isEmpty()&&!p(this,Et).isDeleted()}async editComment(e){p(this,Et)||E(this,Et,new L0(this)),p(this,Et).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){p(this,Et).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[s]=this.pageDimensions,[o]=this.pageTranslation,a=o+s+1,l=i-100,u=a+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[a,l,u,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){p(this,Et).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var o;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=p(this,Zd)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),_(this,ze,hw).call(this);const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),zO(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(p(this,Lc)||E(this,Lc,new IC({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:_(this,ze,iD).bind(this),onPinching:_(this,ze,sD).bind(this),onPinchEnd:_(this,ze,oD).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(o=this._uiManager._editorUndoBar)==null||o.hide(),e}pointerdown(e){const{isMac:t}=Ar.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(E(this,Mc,!0),this._isDraggable){_(this,ze,aD).call(this,e);return}_(this,ze,dw).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){p(this,Ps)&&clearTimeout(p(this,Ps)),E(this,Ps,setTimeout(()=>{var e;E(this,Ps,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const i=this.parentScale,[s,o]=this.pageDimensions,[a,l]=this.pageTranslation,u=e/i,h=t/i,m=this.x*s,g=this.y*o,v=this.width*s,y=this.height*o;switch(n){case 0:return[m+u+a,o-g-h-y+l,m+u+v+a,o-g-h+l];case 90:return[m+h+a,o-g+u+l,m+h+y+a,o-g+u+v+l];case 180:return[m-u-v+a,o-g+h+l,m-u+a,o-g+h+y+l];case 270:return[m-h-y+a,o-g-u-v+l,m-h+a,o-g-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,s,o]=e,a=s-n,l=o-i;switch(this.rotation){case 0:return[n,t-o,a,l];case 90:return[n,t-i,l,a];case 180:return[s,t-i,a,l];case 270:return[s,t-o,l,a];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&He._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=p(this,Et))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:i,deleted:s,richText:o},uid:a,pageIndex:l,creationDate:u,modificationDate:h}=this;return{id:a,pageIndex:l,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:u,modificationDate:n||h,popupRef:!s,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),E(this,Nc,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),E(this,Nc,!1),!0):!1}isInEditMode(){return p(this,Nc)}shouldGetKeyboardEvents(){return p(this,Ao)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:o}=window;return t<o&&i>0&&e<s&&n>0}rebuild(){_(this,ze,hw).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var n;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((n=this._initialData)==null?void 0:n.popupRef)||""}}static async deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,E(i,Ic,e.accessibilityData),i._isCopy=e.isCopy||!1;const[s,o]=i.pageDimensions,[a,l,u,h]=i.getRectInCurrentCoords(e.rect,o);return i.x=a/s,i.y=l/o,i.width=u/s,i.height=h/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,n;if((e=p(this,Ga))==null||e.abort(),E(this,Ga,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),p(this,Ps)&&(clearTimeout(p(this,Ps)),E(this,Ps,null)),_(this,ze,Hg).call(this),this.removeEditToolbar(),p(this,wi)){for(const i of p(this,wi).values())clearTimeout(i);E(this,wi,null)}this.parent=null,(t=p(this,Lc))==null||t.destroy(),E(this,Lc,null),(n=p(this,Ti))==null||n.remove(),E(this,Ti,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(_(this,ze,rD).call(this),p(this,Dr).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,i,s,o]=this.getPDFRect();return[He._round(n+(s-n)*e),He._round(i+(o-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return p(this,Et).commentPopupPositionInLayer}set commentPopupPosition(e){p(this,Et).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return p(this,Et).hasDefaultPopupPosition()}get commentButtonWidth(){return p(this,Et).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=p(this,Et))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),E(this,Co,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=p(this,Dr).children;if(!p(this,Vi)){E(this,Vi,Array.from(t));const o=_(this,ze,lD).bind(this),a=_(this,ze,cD).bind(this),l=this._uiManager._signal;for(const u of p(this,Vi)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:l}),u.addEventListener("blur",a,{signal:l}),u.addEventListener("focus",_(this,ze,uD).bind(this,h),{signal:l}),u.setAttribute("data-l10n-id",He._l10nResizer[h])}}const n=p(this,Vi)[0];let i=0;for(const o of t){if(o===n)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(p(this,Vi).length/4);if(s!==i){if(s<i)for(let a=0;a<i-s;a++)p(this,Dr).append(p(this,Dr).firstElementChild);else if(s>i)for(let a=0;a<s-i;a++)p(this,Dr).firstElementChild.before(p(this,Dr).lastElementChild);let o=0;for(const a of t){const u=p(this,Vi)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",He._l10nResizer[u])}}_(this,ze,pw).call(this,0),E(this,Ao,!0),p(this,Dr).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){p(this,Ao)&&_(this,ze,uw).call(this,p(this,jv),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){_(this,ze,Hg).call(this),this.div.focus()}select(){var e,t,n;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(t=this._editToolbar)==null||t.show(),(n=p(this,Wt))==null||n.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,n,i,s;this.isSelected&&(this.isSelected=!1,(e=p(this,Dr))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(s=p(this,Wt))==null||s.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return p(this,Bv)}set isEditing(e){E(this,Bv,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){p(this,wi)||E(this,wi,new Map);const{action:n}=e;let i=p(this,wi).get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),p(this,wi).delete(n),p(this,wi).size===0&&E(this,wi,null)},He._telemetryTimeout),p(this,wi).set(n,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),E(this,Zd,!1)}disable(){this.div&&(this.div.tabIndex=-1),E(this,Zd,!0)}updateFakeAnnotationElement(e){if(!p(this,Ti)&&!this.deleted){E(this,Ti,e.addFakeAnnotation(this));return}if(this.deleted){p(this,Ti).remove(),E(this,Ti,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&p(this,Ti).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Ic=new WeakMap,Vi=new WeakMap,Wt=new WeakMap,Et=new WeakMap,yo=new WeakMap,Zd=new WeakMap,qa=new WeakMap,Dv=new WeakMap,Dr=new WeakMap,kc=new WeakMap,Co=new WeakMap,Ti=new WeakMap,Ga=new WeakMap,jv=new WeakMap,Mc=new WeakMap,Fn=new WeakMap,Bv=new WeakMap,Nc=new WeakMap,Ao=new WeakMap,Ps=new WeakMap,$d=new WeakMap,Hd=new WeakMap,wi=new WeakMap,Lc=new WeakMap,zv=new WeakMap,HC=new WeakMap,ze=new WeakSet,aw=function([e,t],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Fv=new WeakSet,lw=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},X0=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},rD=function(){if(p(this,Dr))return;E(this,Dr,document.createElement("div")),p(this,Dr).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const i=document.createElement("div");p(this,Dr).append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",_(this,ze,nD).bind(this,n),{signal:t}),i.addEventListener("contextmenu",Mi,{signal:t}),i.tabIndex=-1}this.div.prepend(p(this,Dr))},nD=function(e,t){var h;t.preventDefault();const{isMac:n}=Ar.platform;if(t.button!==0||t.ctrlKey&&n)return;(h=p(this,Wt))==null||h.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,E(this,kc,[t.screenX,t.screenY]);const s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",_(this,ze,uw).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",nr,{passive:!1,signal:o}),window.addEventListener("contextmenu",Mi,{signal:o}),E(this,Co,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var m;s.abort(),this.parent.togglePointerEvents(!0),(m=p(this,Wt))==null||m.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=a,this.div.style.cursor=l,_(this,ze,J0).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},cw=function(e,t,n,i){this.width=n,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},J0=function(){if(!p(this,Co))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=p(this,Co);E(this,Co,null);const s=this.x,o=this.y,a=this.width,l=this.height;s===e&&o===t&&a===n&&l===i||this.addCommands({cmd:_(this,ze,cw).bind(this,s,o,a,l),undo:_(this,ze,cw).bind(this,e,t,n,i),mustExec:!0})},uw=function(e,t){const[n,i]=this.parentDimensions,s=this.x,o=this.y,a=this.width,l=this.height,u=He.MIN_SIZE/n,h=He.MIN_SIZE/i,m=_(this,ze,X0).call(this,this.rotation),g=(X,re)=>[m[0]*X+m[2]*re,m[1]*X+m[3]*re],v=_(this,ze,X0).call(this,360-this.rotation),y=(X,re)=>[v[0]*X+v[2]*re,v[1]*X+v[3]*re];let A,x,b=!1,w=!1;switch(e){case"topLeft":b=!0,A=(X,re)=>[0,0],x=(X,re)=>[X,re];break;case"topMiddle":A=(X,re)=>[X/2,0],x=(X,re)=>[X/2,re];break;case"topRight":b=!0,A=(X,re)=>[X,0],x=(X,re)=>[0,re];break;case"middleRight":w=!0,A=(X,re)=>[X,re/2],x=(X,re)=>[0,re/2];break;case"bottomRight":b=!0,A=(X,re)=>[X,re],x=(X,re)=>[0,0];break;case"bottomMiddle":A=(X,re)=>[X/2,re],x=(X,re)=>[X/2,0];break;case"bottomLeft":b=!0,A=(X,re)=>[0,re],x=(X,re)=>[X,0];break;case"middleLeft":w=!0,A=(X,re)=>[0,re/2],x=(X,re)=>[X,re/2];break}const T=A(a,l),k=x(a,l);let I=g(...k);const M=He._round(s+I[0]),L=He._round(o+I[1]);let j=1,B=1,z,Z;if(t.fromKeyboard)({deltaX:z,deltaY:Z}=t);else{const{screenX:X,screenY:re}=t,[G,J]=p(this,kc);[z,Z]=this.screenToPageTranslation(X-G,re-J),p(this,kc)[0]=X,p(this,kc)[1]=re}if([z,Z]=y(z/n,Z/i),b){const X=Math.hypot(a,l);j=B=Math.max(Math.min(Math.hypot(k[0]-T[0]-z,k[1]-T[1]-Z)/X,1/a,1/l),u/a,h/l)}else w?j=dn(Math.abs(k[0]-T[0]-z),u,1)/a:B=dn(Math.abs(k[1]-T[1]-Z),h,1)/l;const $=He._round(a*j),U=He._round(l*B);I=g(...x($,U));const Y=M-I[0],ee=L-I[1];p(this,Fn)||E(this,Fn,[this.x,this.y,this.width,this.height]),this.width=$,this.height=U,this.x=Y,this.y=ee,this.setDims(),this.fixAndSetPosition(),this._onResizing()},iD=function(){var e;E(this,Co,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=p(this,Wt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},sD=function(e,t,n){let s=.7*(n/t)+1-.7;if(s===1)return;const o=_(this,ze,X0).call(this,this.rotation),a=(M,L)=>[o[0]*M+o[2]*L,o[1]*M+o[3]*L],[l,u]=this.parentDimensions,h=this.x,m=this.y,g=this.width,v=this.height,y=He.MIN_SIZE/l,A=He.MIN_SIZE/u;s=Math.max(Math.min(s,1/g,1/v),y/g,A/v);const x=He._round(g*s),b=He._round(v*s);if(x===g&&b===v)return;p(this,Fn)||E(this,Fn,[h,m,g,v]);const w=a(g/2,v/2),T=He._round(h+w[0]),k=He._round(m+w[1]),I=a(x/2,b/2);this.x=T-I[0],this.y=k-I[1],this.width=x,this.height=b,this.setDims(),this.fixAndSetPosition(),this._onResizing()},oD=function(){var e;(e=p(this,Wt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),_(this,ze,J0).call(this)},dw=function(e){const{isMac:t}=Ar.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},aD=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:s},a=u=>{i.abort(),E(this,qa,null),E(this,Mc,!1),this._uiManager.endDragSession()||_(this,ze,dw).call(this,u),n&&this._onStopDragging()};t&&(E(this,$d,e.clientX),E(this,Hd,e.clientY),E(this,qa,e.pointerId),E(this,Dv,e.pointerType),window.addEventListener("pointermove",u=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:h,clientY:m,pointerId:g}=u;if(g!==p(this,qa)){nr(u);return}const[v,y]=this.screenToPageTranslation(h-p(this,$d),m-p(this,Hd));E(this,$d,h),E(this,Hd,m),this._uiManager.dragSelectedEditors(v,y)},o),window.addEventListener("touchmove",nr,o),window.addEventListener("pointerdown",u=>{u.pointerType===p(this,Dv)&&(p(this,Lc)||u.isPrimary)&&a(u),nr(u)},o));const l=u=>{if(!p(this,qa)||p(this,qa)===u.pointerId){a(u);return}nr(u)};window.addEventListener("pointerup",l,{signal:s}),window.addEventListener("blur",l,{signal:s})},hw=function(){if(p(this,Ga)||!this.div)return;E(this,Ga,new AbortController);const e=this._uiManager.combinedSignal(p(this,Ga));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},lD=function(e){He._resizerKeyboardManager.exec(this,e)},cD=function(e){var t;p(this,Ao)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==p(this,Dr)&&_(this,ze,Hg).call(this)},uD=function(e){E(this,jv,p(this,Ao)?e:"")},pw=function(e){if(p(this,Vi))for(const t of p(this,Vi))t.tabIndex=e},Hg=function(){E(this,Ao,!1),_(this,ze,pw).call(this,-1),_(this,ze,J0).call(this)},N(He,Fv),q(He,"_l10n",null),q(He,"_l10nResizer",null),q(He,"_borderLineWidth",-1),q(He,"_colorManager",new tw),q(He,"_zIndex",1),q(He,"_telemetryTimeout",1e3);let Ot=He;class q6 extends Ot{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Y2=3285377520,mi=4294901760,gs=65535;class dD{constructor(e){this.h1=e?e&4294967295:Y2,this.h2=e?e&4294967295:Y2}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let A=0,x=e.length;A<x;A++){const b=e.charCodeAt(A);b<=255?t[n++]=b:(t[n++]=b>>>8,t[n++]=b&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,s=n-i*4,o=new Uint32Array(t.buffer,0,i);let a=0,l=0,u=this.h1,h=this.h2;const m=3432918353,g=461845907,v=m&gs,y=g&gs;for(let A=0;A<i;A++)A&1?(a=o[A],a=a*m&mi|a*v&gs,a=a<<15|a>>>17,a=a*g&mi|a*y&gs,u^=a,u=u<<13|u>>>19,u=u*5+3864292196):(l=o[A],l=l*m&mi|l*v&gs,l=l<<15|l>>>17,l=l*g&mi|l*y&gs,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(a=0,s){case 3:a^=t[i*4+2]<<16;case 2:a^=t[i*4+1]<<8;case 1:a^=t[i*4],a=a*m&mi|a*v&gs,a=a<<15|a>>>17,a=a*g&mi|a*y&gs,i&1?u^=a:h^=a}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&mi|e*36045&gs,t=t*4283543511&mi|((t<<16|e>>>16)*2950163797&mi)>>>16,e^=t>>>1,e=e*444984403&mi|e*60499&gs,t=t*3301882366&mi|((t<<16|e>>>16)*3120437893&mi)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const fw=Object.freeze({map:null,hash:"",transfer:void 0});var _c,Oc,bo,jr,VC,hD;class BP{constructor(){N(this,VC);N(this,_c,!1);N(this,Oc,null);N(this,bo,null);N(this,jr,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=p(this,jr).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return p(this,jr).get(e)}remove(e){const t=p(this,jr).get(e);if(t!==void 0&&(t instanceof Ot&&p(this,bo).delete(t.annotationElementId),p(this,jr).delete(e),p(this,jr).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of p(this,jr).values())if(n instanceof Ot)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=p(this,jr).get(e);let i=!1;if(n!==void 0)for(const[s,o]of Object.entries(t))n[s]!==o&&(i=!0,n[s]=o);else i=!0,p(this,jr).set(e,t);i&&_(this,VC,hD).call(this),t instanceof Ot&&((p(this,bo)||E(this,bo,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return p(this,jr).has(e)}get size(){return p(this,jr).size}resetModified(){p(this,_c)&&(E(this,_c,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new pD(this)}get serializable(){if(p(this,jr).size===0)return fw;const e=new Map,t=new dD,n=[],i=Object.create(null);let s=!1;for(const[o,a]of p(this,jr)){const l=a instanceof Ot?a.serialize(!1,i):a;l&&(e.set(o,l),t.update(`${o}:${JSON.stringify(l)}`),s||(s=!!l.bitmap))}if(s)for(const o of e.values())o.bitmap&&n.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:fw}get editorStats(){let e=null;const t=new Map;let n=0,i=0;for(const s of p(this,jr).values()){if(!(s instanceof Ot)){s.popup&&(s.popup.deleted?i+=1:n+=1);continue}s.isCommentDeleted?i+=1:s.hasEditedComment&&(n+=1);const o=s.telemetryFinalData;if(!o)continue;const{type:a}=o;t.has(a)||t.set(a,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const l=e[a]||(e[a]=new Map);for(const[u,h]of Object.entries(o)){if(u==="type")continue;let m=l.get(u);m||(m=new Map,l.set(u,m));const g=m.get(h)??0;m.set(h,g+1)}}if((i>0||n>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:n}),!e)return null;for(const[s,o]of t)e[s]=o.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){E(this,Oc,null)}updateEditor(e,t){var i;const n=(i=p(this,bo))==null?void 0:i.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=p(this,bo))==null?void 0:t.get(e))||null}get modifiedIds(){if(p(this,Oc))return p(this,Oc);const e=[];if(p(this,bo))for(const t of p(this,bo).values())t.serialize()&&e.push(t.annotationElementId);return E(this,Oc,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return p(this,jr).entries()}}_c=new WeakMap,Oc=new WeakMap,bo=new WeakMap,jr=new WeakMap,VC=new WeakSet,hD=function(){p(this,_c)||(E(this,_c,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Wv;class pD extends BP{constructor(t){super();N(this,Wv);const{map:n,hash:i,transfer:s}=t.serializable,o=structuredClone(n,s?{transfer:s}:null);E(this,Wv,{map:o,hash:i,transfer:s})}get print(){kt("Should not call PrintAnnotationStorage.print")}get serializable(){return p(this,Wv)}get modifiedIds(){return $e(this,"modifiedIds",{ids:new Set,hash:""})}}Wv=new WeakMap;var Vd;class G6{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){N(this,Vd,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),p(this,Vd).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||p(this,Vd).has(e.loadedName))){if(ot(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:o}=e,a=new FontFace(i,s,o);this.addNativeFontFace(a);try{await a.load(),p(this,Vd).add(i),n==null||n(e)}catch{Ue(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}kt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw Ue(`Failed to load font '${n.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return $e(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return $e(this,"isSyncFontLoadingSupported",un||Ar.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(ot(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const s=n.shift();setTimeout(s.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:t,callback:e};return n.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return $e(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(k,I){return k.charCodeAt(I)<<24|k.charCodeAt(I+1)<<16|k.charCodeAt(I+2)<<8|k.charCodeAt(I+3)&255}function i(k,I,M,L){const j=k.substring(0,I),B=k.substring(I+M);return j+L+B}let s,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let u=0;function h(k,I){if(++u>30){Ue("Load test font never loaded."),I();return}if(l.font="30px "+k,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){I();return}setTimeout(h.bind(null,k,I))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let g=this._loadTestFont;g=i(g,976,m.length,m);const y=16,A=1482184792;let x=n(g,y);for(s=0,o=m.length-3;s<o;s+=4)x=x-A+n(m,s)|0;s<m.length&&(x=x-A+n(m+"XXX",s)|0),g=i(g,y,4,R6(x));const b=`url(data:font/opentype;base64,${btoa(g)});`,w=`@font-face {font-family:"${m}";src:${b}}`;this.insertRule(w);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const k of[e.loadedName,m]){const I=this._document.createElement("span");I.textContent="Hi",I.style.fontFamily=k,T.append(I)}this._document.body.append(T),h(m,()=>{T.remove(),t.complete()})}}Vd=new WeakMap;var bt;class K6{constructor(e,t=null,n,i){N(this,bt);this.compiledGlyphs=Object.create(null),E(this,bt,e),this._inspectFont=t,n&&Object.assign(this,n),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${kO(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let i;try{i=e.get(n)}catch(o){Ue(`getPathGenerator - ignoring character: "${o}".`)}const s=LO(i==null?void 0:i.path);return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=s}get black(){return p(this,bt).black}get bold(){return p(this,bt).bold}get disableFontFace(){return p(this,bt).disableFontFace??!1}set disableFontFace(e){$e(this,"disableFontFace",!!e)}get fontExtraProperties(){return p(this,bt).fontExtraProperties??!1}get isInvalidPDFjsFont(){return p(this,bt).isInvalidPDFjsFont}get isType3Font(){return p(this,bt).isType3Font}get italic(){return p(this,bt).italic}get missingFile(){return p(this,bt).missingFile}get remeasure(){return p(this,bt).remeasure}get vertical(){return p(this,bt).vertical}get ascent(){return p(this,bt).ascent}get defaultWidth(){return p(this,bt).defaultWidth}get descent(){return p(this,bt).descent}get bbox(){return p(this,bt).bbox}set bbox(e){$e(this,"bbox",e)}get fontMatrix(){return p(this,bt).fontMatrix}get fallbackName(){return p(this,bt).fallbackName}get loadedName(){return p(this,bt).loadedName}get mimetype(){return p(this,bt).mimetype}get name(){return p(this,bt).name}get data(){return p(this,bt).data}clearData(){p(this,bt).clearData()}get cssFontInfo(){return p(this,bt).cssFontInfo}get systemFontInfo(){return p(this,bt).systemFontInfo}get defaultVMetrics(){return p(this,bt).defaultVMetrics}}bt=new WeakMap;var qd,Gd,Uv,Kd,Q0;const Ad=class Ad{constructor(e){N(this,Kd);N(this,qd);N(this,Gd);N(this,Uv);E(this,qd,e),E(this,Gd,new DataView(p(this,qd))),E(this,Uv,new TextDecoder)}static write(e){const t=new TextEncoder,n={};let i=0;for(const u of Ad.strings){const h=t.encode(e[u]);n[u]=h,i+=4+h.length}const s=new ArrayBuffer(i),o=new Uint8Array(s),a=new DataView(s);let l=0;for(const u of Ad.strings){const h=n[u],m=h.length;a.setUint32(l,m),o.set(h,l+4),l+=4+m}return ot(l===s.byteLength,"CssFontInfo.write: Buffer overflow"),s}get fontFamily(){return _(this,Kd,Q0).call(this,0)}get fontWeight(){return _(this,Kd,Q0).call(this,1)}get italicAngle(){return _(this,Kd,Q0).call(this,2)}};qd=new WeakMap,Gd=new WeakMap,Uv=new WeakMap,Kd=new WeakSet,Q0=function(e){ot(e<Ad.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=p(this,Gd).getUint32(t)+4;const n=p(this,Gd).getUint32(t);return p(this,Uv).decode(new Uint8Array(p(this,qd),t+4,n))},q(Ad,"strings",["fontFamily","fontWeight","italicAngle"]);let kC=Ad;var Ka,Es,Dc,jc,Vg;const bd=class bd{constructor(e){N(this,jc);N(this,Ka);N(this,Es);N(this,Dc);E(this,Ka,e),E(this,Es,new DataView(p(this,Ka))),E(this,Dc,new TextDecoder)}static write(e){const t=new TextEncoder,n={};let i=0;for(const g of bd.strings){const v=t.encode(e[g]);n[g]=v,i+=4+v.length}i+=4;let s,o,a=1+i;e.style&&(s=t.encode(e.style.style),o=t.encode(e.style.weight),a+=4+s.length+4+o.length);const l=new ArrayBuffer(a),u=new Uint8Array(l),h=new DataView(l);let m=0;h.setUint8(m++,e.guessFallback?1:0),h.setUint32(m,0),m+=4,i=0;for(const g of bd.strings){const v=n[g],y=v.length;i+=4+y,h.setUint32(m,y),u.set(v,m+4),m+=4+y}return h.setUint32(m-i-4,i),e.style&&(h.setUint32(m,s.length),u.set(s,m+4),m+=4+s.length,h.setUint32(m,o.length),u.set(o,m+4),m+=4+o.length),ot(m<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(m)}get guessFallback(){return p(this,Es).getUint8(0)!==0}get css(){return _(this,jc,Vg).call(this,0)}get loadedName(){return _(this,jc,Vg).call(this,1)}get baseFontName(){return _(this,jc,Vg).call(this,2)}get src(){return _(this,jc,Vg).call(this,3)}get style(){let e=1;e+=4+p(this,Es).getUint32(e);const t=p(this,Es).getUint32(e),n=p(this,Dc).decode(new Uint8Array(p(this,Ka),e+4,t));e+=4+t;const i=p(this,Es).getUint32(e),s=p(this,Dc).decode(new Uint8Array(p(this,Ka),e+4,i));return{style:n,weight:s}}};Ka=new WeakMap,Es=new WeakMap,Dc=new WeakMap,jc=new WeakSet,Vg=function(e){ot(e<bd.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=p(this,Es).getUint32(t)+4;const n=p(this,Es).getUint32(t);return p(this,Dc).decode(new Uint8Array(p(this,Ka),t+4,n))},q(bd,"strings",["css","loadedName","baseFontName","src"]);let MC=bd;var Yd,Xd,Jd,Qd,Wn,Rs,Zv,xt,rr,Ui,eC,qg;const qe=class qe{constructor({data:e,extra:t}){N(this,rr);N(this,Rs);N(this,Zv);N(this,xt);E(this,Rs,e),E(this,Zv,new TextDecoder),E(this,xt,new DataView(p(this,Rs))),t&&Object.assign(this,t)}get black(){return _(this,rr,Ui).call(this,0)}get bold(){return _(this,rr,Ui).call(this,1)}get disableFontFace(){return _(this,rr,Ui).call(this,2)}get fontExtraProperties(){return _(this,rr,Ui).call(this,3)}get isInvalidPDFjsFont(){return _(this,rr,Ui).call(this,4)}get isType3Font(){return _(this,rr,Ui).call(this,5)}get italic(){return _(this,rr,Ui).call(this,6)}get missingFile(){return _(this,rr,Ui).call(this,7)}get remeasure(){return _(this,rr,Ui).call(this,8)}get vertical(){return _(this,rr,Ui).call(this,9)}get ascent(){return _(this,rr,eC).call(this,0)}get defaultWidth(){return _(this,rr,eC).call(this,1)}get descent(){return _(this,rr,eC).call(this,2)}get bbox(){let e=p(qe,Xd);if(p(this,xt).getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<4;i++)n.push(p(this,xt).getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=p(qe,Jd);if(p(this,xt).getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<6;i++)n.push(p(this,xt).getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=p(qe,Qd);if(p(this,xt).getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<3;i++)n.push(p(this,xt).getInt16(e,!0)),e+=2;return n}get fallbackName(){return _(this,rr,qg).call(this,0)}get loadedName(){return _(this,rr,qg).call(this,1)}get mimetype(){return _(this,rr,qg).call(this,2)}get name(){return _(this,rr,qg).call(this,3)}get data(){let e=p(qe,Wn);const t=p(this,xt).getUint32(e);e+=4+t;const n=p(this,xt).getUint32(e);e+=4+n;const i=p(this,xt).getUint32(e);e+=4+i;const s=p(this,xt).getUint32(e);if(s!==0)return new Uint8Array(p(this,Rs),e+4,s)}clearData(){let e=p(qe,Wn);const t=p(this,xt).getUint32(e);e+=4+t;const n=p(this,xt).getUint32(e);e+=4+n;const i=p(this,xt).getUint32(e);e+=4+i;const s=p(this,xt).getUint32(e);new Uint8Array(p(this,Rs),e+4,s).fill(0),p(this,xt).setUint32(e,0)}get cssFontInfo(){let e=p(qe,Wn);const t=p(this,xt).getUint32(e);e+=4+t;const n=p(this,xt).getUint32(e);e+=4+n;const i=p(this,xt).getUint32(e);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(p(this,Rs),e+4,i)),new kC(s.buffer)}get systemFontInfo(){let e=p(qe,Wn);const t=p(this,xt).getUint32(e);e+=4+t;const n=p(this,xt).getUint32(e);if(n===0)return null;const i=new Uint8Array(n);return i.set(new Uint8Array(p(this,Rs),e+4,n)),new MC(i.buffer)}static write(e){const t=e.systemFontInfo?MC.write(e.systemFontInfo):null,n=e.cssFontInfo?kC.write(e.cssFontInfo):null,i=new TextEncoder,s={};let o=0;for(const A of qe.strings)s[A]=i.encode(e[A]),o+=4+s[A].length;const a=p(qe,Wn)+4+o+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(a),u=new Uint8Array(l),h=new DataView(l);let m=0;const g=qe.bools.length;let v=0,y=0;for(let A=0;A<g;A++){const x=e[qe.bools[A]];v|=(x===void 0?0:x?2:1)<<y,y+=2,(y===8||A===g-1)&&(h.setUint8(m++,v),v=0,y=0)}ot(m===p(qe,Yd),"FontInfo.write: Boolean properties offset mismatch");for(const A of qe.numbers)h.setFloat64(m,e[A]),m+=8;if(ot(m===p(qe,Xd),"FontInfo.write: Number properties offset mismatch"),e.bbox){h.setUint8(m++,4);for(const A of e.bbox)h.setInt16(m,A,!0),m+=2}else h.setUint8(m++,0),m+=8;if(ot(m===p(qe,Jd),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){h.setUint8(m++,6);for(const A of e.fontMatrix)h.setFloat64(m,A,!0),m+=8}else h.setUint8(m++,0),m+=48;if(ot(m===p(qe,Qd),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){h.setUint8(m++,1);for(const A of e.defaultVMetrics)h.setInt16(m,A,!0),m+=2}else h.setUint8(m++,0),m+=6;ot(m===p(qe,Wn),"FontInfo.write: DefaultVMetrics properties offset mismatch"),h.setUint32(p(qe,Wn),0),m+=4;for(const A of qe.strings){const x=s[A],b=x.length;h.setUint32(m,b),u.set(x,m+4),m+=4+b}if(h.setUint32(p(qe,Wn),m-p(qe,Wn)-4),!t)h.setUint32(m,0),m+=4;else{const A=t.byteLength;h.setUint32(m,A),ot(m+4+A<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(t),m+4),m+=4+A}if(!n)h.setUint32(m,0),m+=4;else{const A=n.byteLength;h.setUint32(m,A),ot(m+4+A<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(n),m+4),m+=4+A}return e.data===void 0?(h.setUint32(m,0),m+=4):(h.setUint32(m,e.data.length),u.set(e.data,m+4),m+=4+e.data.length),ot(m<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(m)}};Yd=new WeakMap,Xd=new WeakMap,Jd=new WeakMap,Qd=new WeakMap,Wn=new WeakMap,Rs=new WeakMap,Zv=new WeakMap,xt=new WeakMap,rr=new WeakSet,Ui=function(e){ot(e<qe.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,i=p(this,xt).getUint8(t)>>n&3;return i===0?void 0:i===2},eC=function(e){return ot(e<qe.numbers.length,"Invalid number index"),p(this,xt).getFloat64(p(qe,Yd)+e*8)},qg=function(e){ot(e<qe.strings.length,"Invalid string index");let t=p(qe,Wn)+4;for(let s=0;s<e;s++)t+=p(this,xt).getUint32(t)+4;const n=p(this,xt).getUint32(t),i=new Uint8Array(n);return i.set(new Uint8Array(p(this,Rs),t+4,n)),p(this,Zv).decode(i)},q(qe,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),q(qe,"numbers",["ascent","defaultWidth","descent"]),q(qe,"strings",["fallbackName","loadedName","mimetype","name"]),N(qe,Yd,Math.ceil(qe.bools.length*2/8)),N(qe,Xd,p(qe,Yd)+qe.numbers.length*8),N(qe,Jd,p(qe,Xd)+1+8),N(qe,Qd,p(qe,Jd)+1+48),N(qe,Wn,p(qe,Qd)+1+6);let mw=qe;var $v,Hv,Vv,qv,Gv,Kv,Yv,Xv;const Nt=class Nt{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,n=null,i=[],s=[],o=[],a=[],l=null,u=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,n=e[2],o=e[3],t===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,l=e[1],i=e[2],s=e[3],a=e[4]||[],n=e[6],u=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const h=Math.floor(i.length/2),m=Math.floor(s.length/3),g=o.length,v=a.length;let y=0;for(const I of a)y+=1,y=Math.ceil(y/4)*4,y+=4+I.coords.length*4,y+=4+I.colors.length*4,I.verticesPerRow!==void 0&&(y+=4);const A=20+h*8+m*3+g*8+(n?16:0)+(u?3:0)+y,x=new ArrayBuffer(A),b=new DataView(x),w=new Uint8Array(x);b.setUint8(p(Nt,$v),t),b.setUint8(p(Nt,Hv),n?1:0),b.setUint8(p(Nt,Vv),u?1:0),b.setUint8(p(Nt,qv),l),b.setUint32(p(Nt,Gv),h,!0),b.setUint32(p(Nt,Kv),m,!0),b.setUint32(p(Nt,Yv),g,!0),b.setUint32(p(Nt,Xv),v,!0);let T=20;new Float32Array(x,T,h*2).set(i),T+=h*8,w.set(s,T),T+=m*3;for(const[I,M]of o)b.setFloat32(T,I,!0),T+=4,b.setUint32(T,parseInt(M.slice(1),16),!0),T+=4;if(n)for(const I of n)b.setFloat32(T,I,!0),T+=4;u&&(w.set(u,T),T+=3);for(let I=0;I<a.length;I++){const M=a[I];b.setUint8(T,M.type),T+=1,T=Math.ceil(T/4)*4,b.setUint32(T,M.coords.length,!0),T+=4,new Int32Array(x,T,M.coords.length).set(M.coords),T+=M.coords.length*4,b.setUint32(T,M.colors.length,!0),T+=4,new Int32Array(x,T,M.colors.length).set(M.colors),T+=M.colors.length*4,M.verticesPerRow!==void 0&&(b.setUint32(T,M.verticesPerRow,!0),T+=4)}return x}getIR(){const e=this.view,t=this.data[p(Nt,$v)],n=!!this.data[p(Nt,Hv)],i=!!this.data[p(Nt,Vv)],s=e.getUint32(p(Nt,Gv),!0),o=e.getUint32(p(Nt,Kv),!0),a=e.getUint32(p(Nt,Yv),!0),l=e.getUint32(p(Nt,Xv),!0);let u=20;const h=new Float32Array(this.buffer,u,s*2);u+=s*8;const m=new Uint8Array(this.buffer,u,o*3);u+=o*3;const g=[];for(let x=0;x<a;++x){const b=e.getFloat32(u,!0);u+=4;const w=e.getUint32(u,!0);u+=4,g.push([b,`#${w.toString(16).padStart(6,"0")}`])}let v=null;if(n){v=[];for(let x=0;x<4;++x)v.push(e.getFloat32(u,!0)),u+=4}let y=null;i&&(y=new Uint8Array(this.buffer,u,3),u+=3);const A=[];for(let x=0;x<l;++x){const b=e.getUint8(u);u+=1,u=Math.ceil(u/4)*4;const w=e.getUint32(u,!0);u+=4;const T=new Int32Array(this.buffer,u,w);u+=w*4;const k=e.getUint32(u,!0);u+=4;const I=new Int32Array(this.buffer,u,k);u+=k*4;const M={type:b,coords:T,colors:I};b===qT.LATTICE&&(M.verticesPerRow=e.getUint32(u,!0),u+=4),A.push(M)}if(t===1)return["RadialAxial","axial",v,g,Array.from(h.slice(0,2)),Array.from(h.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",v,g,[h[0],h[1]],[h[3],h[4]],h[2],h[5]];if(t===3){const x=this.data[p(Nt,qv)];let b=null;if(h.length>0){let w=h[0],T=h[0],k=h[1],I=h[1];for(let M=0;M<h.length;M+=2){const L=h[M],j=h[M+1];w=w>L?L:w,k=k>j?j:k,T=T<L?L:T,I=I<j?j:I}b=[w,k,T,I]}return["Mesh",x,h,m,A,b,v,y]}throw new Error(`Unsupported pattern kind: ${t}`)}};$v=new WeakMap,Hv=new WeakMap,Vv=new WeakMap,qv=new WeakMap,Gv=new WeakMap,Kv=new WeakMap,Yv=new WeakMap,Xv=new WeakMap,N(Nt,$v,0),N(Nt,Hv,1),N(Nt,Vv,2),N(Nt,qv,3),N(Nt,Gv,4),N(Nt,Kv,8),N(Nt,Yv,12),N(Nt,Xv,16);let gw=Nt;var eh;class Y6{constructor(e){N(this,eh);E(this,eh,e)}static write(e){let t,n;return Ar.isFloat16ArraySupported?(n=new ArrayBuffer(e.length*2),t=new Float16Array(n)):(n=new ArrayBuffer(e.length*4),t=new Float32Array(n)),t.set(e),n}get path(){return Ar.isFloat16ArraySupported?new Float16Array(p(this,eh)):new Float32Array(p(this,eh))}}eh=new WeakMap;function X6(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(un)return r;const e=URL.parse(r,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function J6(r){if(un&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return ay(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r==null?void 0:r.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function _0(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const vw=r=>typeof r=="object"&&Number.isInteger(r==null?void 0:r.num)&&r.num>=0&&Number.isInteger(r==null?void 0:r.gen)&&r.gen>=0,Q6=r=>typeof r=="object"&&typeof(r==null?void 0:r.name)=="string",eW=L6.bind(null,vw,Q6);var xo,qC;class tW{constructor(){N(this,xo,new Map);N(this,qC,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};p(this,qC).then(()=>{for(const[i]of p(this,xo))i.call(this,n)})}addEventListener(e,t,n=null){let i=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:s}=n;if(s.aborted){Ue("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);i=()=>s.removeEventListener("abort",o),s.addEventListener("abort",o)}p(this,xo).set(t,i)}removeEventListener(e,t){const n=p(this,xo).get(t);n==null||n(),p(this,xo).delete(t)}terminate(){for(const[,e]of p(this,xo))e==null||e();p(this,xo).clear()}}xo=new WeakMap,qC=new WeakMap;const O0={DATA:1,ERROR:2},cr={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function X2(){}function Cn(r){if(r instanceof bl||r instanceof GT||r instanceof Z2||r instanceof PC||r instanceof PT)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||kt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new bl(r.message);case"InvalidPDFException":return new GT(r.message);case"PasswordException":return new Z2(r.message,r.code);case"ResponseException":return new PC(r.message,r.status,r.missing);case"UnknownErrorException":return new PT(r.message,r.details)}return new PT(r.message,r.toString())}var th,ki,fD,mD,gD,tC;class Gg{constructor(e,t,n){N(this,ki);N(this,th,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",_(this,ki,fD).bind(this),{signal:p(this,th).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(o){s.reject(o)}return s.promise}sendWithStream(e,t,n,i){const s=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[s]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:e,streamId:s,data:t,desiredSize:u.desiredSize},i),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[s].pullCall=h,l.postMessage({sourceName:o,targetName:a,stream:cr.PULL,streamId:s,desiredSize:u.desiredSize}),h.promise},cancel:u=>{ot(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[s].cancelCall=h,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:cr.CANCEL,streamId:s,reason:Cn(u)}),h.promise}},n)}destroy(){var e;(e=p(this,th))==null||e.abort(),E(this,th,null)}}th=new WeakMap,ki=new WeakSet,fD=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){_(this,ki,gD).call(this,e);return}if(e.callback){const n=e.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===O0.DATA)i.resolve(e.data);else if(e.callback===O0.ERROR)i.reject(Cn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,i=e.sourceName,s=this.comObj;Promise.try(t,e.data).then(function(o){s.postMessage({sourceName:n,targetName:i,callback:O0.DATA,callbackId:e.callbackId,data:o})},function(o){s.postMessage({sourceName:n,targetName:i,callback:O0.ERROR,callbackId:e.callbackId,reason:Cn(o)})});return}if(e.streamId){_(this,ki,mD).call(this,e);return}t(e.data)},mD=function(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,s=this.comObj,o=this,a=this.actionHandler[e.action],l={enqueue(u,h=1,m){if(this.isCancelled)return;const g=this.desiredSize;this.desiredSize-=h,g>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:i,stream:cr.ENQUEUE,streamId:t,chunk:u},m)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:cr.CLOSE,streamId:t}),delete o.streamSinks[t])},error(u){ot(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:cr.ERROR,streamId:t,reason:Cn(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(a,e.data,l).then(function(){s.postMessage({sourceName:n,targetName:i,stream:cr.START_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:n,targetName:i,stream:cr.START_COMPLETE,streamId:t,reason:Cn(u)})})},gD=function(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,s=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case cr.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Cn(e.reason));break;case cr.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Cn(e.reason));break;case cr.PULL:if(!a){s.postMessage({sourceName:n,targetName:i,stream:cr.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||X2).then(function(){s.postMessage({sourceName:n,targetName:i,stream:cr.PULL_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:n,targetName:i,stream:cr.PULL_COMPLETE,streamId:t,reason:Cn(u)})});break;case cr.ENQUEUE:if(ot(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case cr.CLOSE:if(ot(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),_(this,ki,tC).call(this,o,t);break;case cr.ERROR:ot(o,"error should have stream controller"),o.controller.error(Cn(e.reason)),_(this,ki,tC).call(this,o,t);break;case cr.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Cn(e.reason)),_(this,ki,tC).call(this,o,t);break;case cr.CANCEL:if(!a)break;const l=Cn(e.reason);Promise.try(a.onCancel||X2,l).then(function(){s.postMessage({sourceName:n,targetName:i,stream:cr.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:n,targetName:i,stream:cr.CANCEL_COMPLETE,streamId:t,reason:Cn(u)})}),a.sinkCapability.reject(l),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},tC=async function(e,t){var n,i,s;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(i=e.pullCall)==null?void 0:i.promise,(s=e.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[t]};var Jv;class vD{constructor({enableHWA:e=!1}){N(this,Jv,!1);E(this,Jv,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!p(this,Jv)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){kt("Abstract method `_createCanvas` called.")}}Jv=new WeakMap;class rW extends vD{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class SD{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){kt("Abstract method `_fetch` called.")}}class J2 extends SD{async _fetch(e){const t=await ly(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):ay(t)}}Ge(2489);class yD{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,s){return"none"}destroy(e=!1){}}var Bc,rh,To,wo,Xr,zc,Fc,Ee,qr,Kg,dd,rC,hd,CD,Sw,pd,Yg,Xg,yw,Jg;class nW extends yD{constructor({docId:t,ownerDocument:n=globalThis.document}){super();N(this,Ee);N(this,Bc);N(this,rh);N(this,To);N(this,wo);N(this,Xr);N(this,zc);N(this,Fc,0);E(this,wo,t),E(this,Xr,n)}addFilter(t){if(!t)return"none";let n=p(this,Ee,qr).get(t);if(n)return n;const[i,s,o]=_(this,Ee,rC).call(this,t),a=t.length===1?i:`${i}${s}${o}`;if(n=p(this,Ee,qr).get(a),n)return p(this,Ee,qr).set(t,n),n;const l=`g_${p(this,wo)}_transfer_map_${mr(this,Fc)._++}`,u=_(this,Ee,hd).call(this,l);p(this,Ee,qr).set(t,u),p(this,Ee,qr).set(a,u);const h=_(this,Ee,pd).call(this,l);return _(this,Ee,Xg).call(this,i,s,o,h),u}addHCMFilter(t,n){var y;const i=`${t}-${n}`,s="base";let o=p(this,Ee,Kg).get(s);if((o==null?void 0:o.key)===i||(o?((y=o.filter)==null||y.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},p(this,Ee,Kg).set(s,o)),!t||!n))return o.url;const a=_(this,Ee,Jg).call(this,t);t=we.makeHexColor(...a);const l=_(this,Ee,Jg).call(this,n);if(n=we.makeHexColor(...l),p(this,Ee,dd).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return o.url;const u=new Array(256);for(let A=0;A<=255;A++){const x=A/255;u[A]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const h=u.join(","),m=`g_${p(this,wo)}_hcm_filter`,g=o.filter=_(this,Ee,pd).call(this,m);_(this,Ee,Xg).call(this,h,h,h,g),_(this,Ee,Sw).call(this,g);const v=(A,x)=>{const b=a[A]/255,w=l[A]/255,T=new Array(x+1);for(let k=0;k<=x;k++)T[k]=b+k/x*(w-b);return T.join(",")};return _(this,Ee,Xg).call(this,v(0,5),v(1,5),v(2,5),g),o.url=_(this,Ee,hd).call(this,m),o.url}addAlphaFilter(t){let n=p(this,Ee,qr).get(t);if(n)return n;const[i]=_(this,Ee,rC).call(this,[t]),s=`alpha_${i}`;if(n=p(this,Ee,qr).get(s),n)return p(this,Ee,qr).set(t,n),n;const o=`g_${p(this,wo)}_alpha_map_${mr(this,Fc)._++}`,a=_(this,Ee,hd).call(this,o);p(this,Ee,qr).set(t,a),p(this,Ee,qr).set(s,a);const l=_(this,Ee,pd).call(this,o);return _(this,Ee,yw).call(this,i,l),a}addLuminosityFilter(t){let n=p(this,Ee,qr).get(t||"luminosity");if(n)return n;let i,s;if(t?([i]=_(this,Ee,rC).call(this,[t]),s=`luminosity_${i}`):s="luminosity",n=p(this,Ee,qr).get(s),n)return p(this,Ee,qr).set(t,n),n;const o=`g_${p(this,wo)}_luminosity_map_${mr(this,Fc)._++}`,a=_(this,Ee,hd).call(this,o);p(this,Ee,qr).set(t,a),p(this,Ee,qr).set(s,a);const l=_(this,Ee,pd).call(this,o);return _(this,Ee,CD).call(this,l),t&&_(this,Ee,yw).call(this,i,l),a}addHighlightHCMFilter(t,n,i,s,o){var w;const a=`${n}-${i}-${s}-${o}`;let l=p(this,Ee,Kg).get(t);if((l==null?void 0:l.key)===a||(l?((w=l.filter)==null||w.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},p(this,Ee,Kg).set(t,l)),!n||!i))return l.url;const[u,h]=[n,i].map(_(this,Ee,Jg).bind(this));let m=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),g=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[v,y]=[s,o].map(_(this,Ee,Jg).bind(this));g<m&&([m,g,v,y]=[g,m,y,v]),p(this,Ee,dd).style.color="";const A=(T,k,I)=>{const M=new Array(256),L=(g-m)/I,j=T/255,B=(k-T)/(255*I);let z=0;for(let Z=0;Z<=I;Z++){const $=Math.round(m+Z*L),U=j+Z*B;for(let Y=z;Y<=$;Y++)M[Y]=U;z=$+1}for(let Z=z;Z<256;Z++)M[Z]=M[z-1];return M.join(",")},x=`g_${p(this,wo)}_hcm_${t}_filter`,b=l.filter=_(this,Ee,pd).call(this,x);return _(this,Ee,Sw).call(this,b),_(this,Ee,Xg).call(this,A(v[0],y[0],5),A(v[1],y[1],5),A(v[2],y[2],5),b),l.url=_(this,Ee,hd).call(this,x),l.url}destroy(t=!1){var n,i,s,o;t&&((n=p(this,zc))!=null&&n.size)||((i=p(this,To))==null||i.parentNode.parentNode.remove(),E(this,To,null),(s=p(this,rh))==null||s.clear(),E(this,rh,null),(o=p(this,zc))==null||o.clear(),E(this,zc,null),E(this,Fc,0))}}Bc=new WeakMap,rh=new WeakMap,To=new WeakMap,wo=new WeakMap,Xr=new WeakMap,zc=new WeakMap,Fc=new WeakMap,Ee=new WeakSet,qr=function(){return p(this,rh)||E(this,rh,new Map)},Kg=function(){return p(this,zc)||E(this,zc,new Map)},dd=function(){if(!p(this,To)){const t=p(this,Xr).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const i=p(this,Xr).createElementNS(so,"svg");i.setAttribute("width",0),i.setAttribute("height",0),E(this,To,p(this,Xr).createElementNS(so,"defs")),t.append(i),i.append(p(this,To)),p(this,Xr).body.append(t)}return p(this,To)},rC=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let g=0;g<256;g++)h[g]=u[g]/255;const m=h.join(",");return[m,m,m]}const[n,i,s]=t,o=new Array(256),a=new Array(256),l=new Array(256);for(let u=0;u<256;u++)o[u]=n[u]/255,a[u]=i[u]/255,l[u]=s[u]/255;return[o.join(","),a.join(","),l.join(",")]},hd=function(t){if(p(this,Bc)===void 0){E(this,Bc,"");const n=p(this,Xr).URL;n!==p(this,Xr).baseURI&&(pA(n)?Ue('#createUrl: ignore "data:"-URL for performance reasons.'):E(this,Bc,EO(n,"")))}return`url(${p(this,Bc)}#${t})`},CD=function(t){const n=p(this,Xr).createElementNS(so,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},Sw=function(t){const n=p(this,Xr).createElementNS(so,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},pd=function(t){const n=p(this,Xr).createElementNS(so,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),p(this,Ee,dd).append(n),n},Yg=function(t,n,i){const s=p(this,Xr).createElementNS(so,n);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),t.append(s)},Xg=function(t,n,i,s){const o=p(this,Xr).createElementNS(so,"feComponentTransfer");s.append(o),_(this,Ee,Yg).call(this,o,"feFuncR",t),_(this,Ee,Yg).call(this,o,"feFuncG",n),_(this,Ee,Yg).call(this,o,"feFuncB",i)},yw=function(t,n){const i=p(this,Xr).createElementNS(so,"feComponentTransfer");n.append(i),_(this,Ee,Yg).call(this,i,"feFuncA",t)},Jg=function(t){return p(this,Ee,dd).style.color=t,uy(getComputedStyle(p(this,Ee,dd)).getPropertyValue("color"))};class AD{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){kt("Abstract method `_fetch` called.")}}class Q2 extends AD{async _fetch(e){const t=await ly(e,"arraybuffer");return new Uint8Array(t)}}class bD{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){kt("Abstract method `_fetch` called.")}}class eL extends bD{async _fetch(e){const t=await ly(e,"arraybuffer");return new Uint8Array(t)}}var n_;if(un){let r;try{const e=process.getBuiltinModule("module").createRequire(import.meta.url);try{r=e("@napi-rs/canvas")}catch(t){Ue(`Cannot load "@napi-rs/canvas" package: "${t}".`)}}catch(e){Ue(`Cannot access the \`require\` function: "${e}".`)}globalThis.DOMMatrix||(r!=null&&r.DOMMatrix?globalThis.DOMMatrix=r.DOMMatrix:Ue("Cannot polyfill `DOMMatrix`, rendering may be broken.")),globalThis.ImageData||(r!=null&&r.ImageData?globalThis.ImageData=r.ImageData:Ue("Cannot polyfill `ImageData`, rendering may be broken.")),globalThis.Path2D||(r!=null&&r.Path2D?globalThis.Path2D=r.Path2D:Ue("Cannot polyfill `Path2D`, rendering may be broken.")),(n_=globalThis.navigator)!=null&&n_.language||(globalThis.navigator={language:"en-US",platform:"",userAgent:""})}async function zP(r){const t=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(t)}class iW extends yD{}class sW extends vD{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class oW extends SD{async _fetch(e){return zP(e)}}class aW extends AD{async _fetch(e){return zP(e)}}class lW extends bD{async _fetch(e){return zP(e)}}Ge(7588);const ad="__forcedDependency",{floor:tL,ceil:rL}=Math;function D0(r,e,t,n,i,s){r[e*4+0]=Math.min(r[e*4+0],t),r[e*4+1]=Math.min(r[e*4+1],n),r[e*4+2]=Math.max(r[e*4+2],i),r[e*4+3]=Math.max(r[e*4+3],s)}const Cw=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var nh,Ya;class cW{constructor(e,t){N(this,nh);N(this,Ya);E(this,nh,e),E(this,Ya,t)}get length(){return p(this,nh).length}isEmpty(e){return p(this,nh)[e]===Cw}minX(e){return p(this,Ya)[e*4+0]/256}minY(e){return p(this,Ya)[e*4+1]/256}maxX(e){return(p(this,Ya)[e*4+2]+1)/256}maxY(e){return(p(this,Ya)[e*4+3]+1)/256}}nh=new WeakMap,Ya=new WeakMap;const j0=(r,e)=>{if(!r)return;let t=r.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},r.set(e,t)),t};var xn,Tn,Wc,qi,Uc,Po,vt,Tt,Eo,wn,Qv,ih,Zc,$c,Ro,Jr,Is,eS,Aw;class uW{constructor(e,t,n=!1){N(this,eS);N(this,xn,{__proto__:null});N(this,Tn,{__proto__:null,transform:[],moveText:[],sameLineText:[],[ad]:[]});N(this,Wc,new Map);N(this,qi,[]);N(this,Uc,[]);N(this,Po,[[1,0,0,1,0,0]]);N(this,vt,[-1/0,-1/0,1/0,1/0]);N(this,Tt,new Float64Array([1/0,1/0,-1/0,-1/0]));N(this,Eo,-1);N(this,wn,new Set);N(this,Qv,new Map);N(this,ih,new Map);N(this,Zc);N(this,$c);N(this,Ro);N(this,Jr);N(this,Is);E(this,Zc,e.width),E(this,$c,e.height),_(this,eS,Aw).call(this,t),n&&E(this,Is,new Map)}growOperationsCount(e){e>=p(this,Jr).length&&_(this,eS,Aw).call(this,e,p(this,Jr))}save(e){return E(this,xn,{__proto__:p(this,xn)}),E(this,Tn,{__proto__:p(this,Tn),transform:{__proto__:p(this,Tn).transform},moveText:{__proto__:p(this,Tn).moveText},sameLineText:{__proto__:p(this,Tn).sameLineText},[ad]:{__proto__:p(this,Tn)[ad]}}),E(this,vt,{__proto__:p(this,vt)}),p(this,qi).push(e),this}restore(e){var i;const t=Object.getPrototypeOf(p(this,xn));if(t===null)return this;E(this,xn,t),E(this,Tn,Object.getPrototypeOf(p(this,Tn))),E(this,vt,Object.getPrototypeOf(p(this,vt)));const n=p(this,qi).pop();return n!==void 0&&((i=j0(p(this,Is),e))==null||i.dependencies.add(n),p(this,Jr)[e]=p(this,Jr)[n]),this}recordOpenMarker(e){return p(this,qi).push(e),this}getOpenMarker(){return p(this,qi).length===0?null:p(this,qi).at(-1)}recordCloseMarker(e){var n;const t=p(this,qi).pop();return t!==void 0&&((n=j0(p(this,Is),e))==null||n.dependencies.add(t),p(this,Jr)[e]=p(this,Jr)[t]),this}beginMarkedContent(e){return p(this,Uc).push(e),this}endMarkedContent(e){var n;const t=p(this,Uc).pop();return t!==void 0&&((n=j0(p(this,Is),e))==null||n.dependencies.add(t),p(this,Jr)[e]=p(this,Jr)[t]),this}pushBaseTransform(e){return p(this,Po).push(we.multiplyByDOMMatrix(p(this,Po).at(-1),e.getTransform())),this}popBaseTransform(){return p(this,Po).length>1&&p(this,Po).pop(),this}recordSimpleData(e,t){return p(this,xn)[e]=t,this}recordIncrementalData(e,t){return p(this,Tn)[e].push(t),this}resetIncrementalData(e,t){return p(this,Tn)[e].length=0,this}recordNamedData(e,t){return p(this,Wc).set(e,t),this}recordSimpleDataFromNamed(e,t,n){p(this,xn)[e]=p(this,Wc).get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(ad,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in p(this,xn)&&this.recordFutureForcedDependency(t,p(this,xn)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of p(this,wn))this.recordFutureForcedDependency(ad,e);return this}resetBBox(e){return p(this,Eo)!==e&&(E(this,Eo,e),p(this,Tt)[0]=1/0,p(this,Tt)[1]=1/0,p(this,Tt)[2]=-1/0,p(this,Tt)[3]=-1/0),this}recordClipBox(e,t,n,i,s,o){const a=we.multiplyByDOMMatrix(p(this,Po).at(-1),t.getTransform()),l=[1/0,1/0,-1/0,-1/0];we.axialAlignedBoundingBox([n,s,i,o],a,l);const u=we.intersect(p(this,vt),l);return u?(p(this,vt)[0]=u[0],p(this,vt)[1]=u[1],p(this,vt)[2]=u[2],p(this,vt)[3]=u[3]):(p(this,vt)[0]=p(this,vt)[1]=1/0,p(this,vt)[2]=p(this,vt)[3]=-1/0),this}recordBBox(e,t,n,i,s,o){const a=p(this,vt);if(a[0]===1/0)return this;const l=we.multiplyByDOMMatrix(p(this,Po).at(-1),t.getTransform());if(a[0]===-1/0)return we.axialAlignedBoundingBox([n,s,i,o],l,p(this,Tt)),this;const u=[1/0,1/0,-1/0,-1/0];return we.axialAlignedBoundingBox([n,s,i,o],l,u),p(this,Tt)[0]=Math.min(p(this,Tt)[0],Math.max(u[0],a[0])),p(this,Tt)[1]=Math.min(p(this,Tt)[1],Math.max(u[1],a[1])),p(this,Tt)[2]=Math.max(p(this,Tt)[2],Math.min(u[2],a[2])),p(this,Tt)[3]=Math.max(p(this,Tt)[3],Math.min(u[3],a[3])),this}recordCharacterBBox(e,t,n,i=1,s=0,o=0,a){const l=n.bbox;let u,h;if(l&&(u=l[2]!==l[0]&&l[3]!==l[1]&&p(this,ih).get(n),u!==!1&&(h=[0,0,0,0],we.axialAlignedBoundingBox(l,n.fontMatrix,h),(i!==1||s!==0||o!==0)&&we.scaleMinMax([i,0,0,-i,s,o],h),u)))return this.recordBBox(e,t,h[0],h[2],h[1],h[3]);if(!a)return this.recordFullPageBBox(e);const m=a();return l&&h&&u===void 0&&(u=h[0]<=s-m.actualBoundingBoxLeft&&h[2]>=s+m.actualBoundingBoxRight&&h[1]<=o-m.actualBoundingBoxAscent&&h[3]>=o+m.actualBoundingBoxDescent,p(this,ih).set(n,u),u)?this.recordBBox(e,t,h[0],h[2],h[1],h[3]):this.recordBBox(e,t,s-m.actualBoundingBoxLeft,s+m.actualBoundingBoxRight,o-m.actualBoundingBoxAscent,o+m.actualBoundingBoxDescent)}recordFullPageBBox(e){return p(this,Tt)[0]=Math.max(0,p(this,vt)[0]),p(this,Tt)[1]=Math.max(0,p(this,vt)[1]),p(this,Tt)[2]=Math.min(p(this,Zc),p(this,vt)[2]),p(this,Tt)[3]=Math.min(p(this,$c),p(this,vt)[3]),this}getSimpleIndex(e){return p(this,xn)[e]}recordDependencies(e,t){const n=p(this,wn),i=p(this,xn),s=p(this,Tn);for(const o of t)o in p(this,xn)?n.add(i[o]):o in s&&s[o].forEach(n.add,n);return this}recordNamedDependency(e,t){return p(this,Wc).has(t)&&p(this,wn).add(p(this,Wc).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[ad]),p(this,Is)){const n=j0(p(this,Is),e),{dependencies:i}=n;p(this,wn).forEach(i.add,i),p(this,qi).forEach(i.add,i),p(this,Uc).forEach(i.add,i),i.delete(e),n.isRenderingOperation=!0}if(p(this,Eo)===e){const n=tL(p(this,Tt)[0]*256/p(this,Zc)),i=tL(p(this,Tt)[1]*256/p(this,$c)),s=rL(p(this,Tt)[2]*256/p(this,Zc)),o=rL(p(this,Tt)[3]*256/p(this,$c));D0(p(this,Ro),e,n,i,s,o);for(const a of p(this,wn))a!==e&&D0(p(this,Ro),a,n,i,s,o);for(const a of p(this,qi))a!==e&&D0(p(this,Ro),a,n,i,s,o);for(const a of p(this,Uc))a!==e&&D0(p(this,Ro),a,n,i,s,o);t||(p(this,wn).clear(),E(this,Eo,-1))}return this}recordShowTextOperation(e,t=!1){const n=Array.from(p(this,wn));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of n)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return p(this,Eo)===e&&(E(this,Eo,-1),p(this,vt)[0]=Math.max(p(this,vt)[0],p(this,Tt)[0]),p(this,vt)[1]=Math.max(p(this,vt)[1],p(this,Tt)[1]),p(this,vt)[2]=Math.min(p(this,vt)[2],p(this,Tt)[2]),p(this,vt)[3]=Math.min(p(this,vt)[3],p(this,Tt)[3]),t||p(this,wn).clear()),this}_takePendingDependencies(){const e=p(this,wn);return E(this,wn,new Set),e}_extractOperation(e){const t=p(this,Qv).get(e);return p(this,Qv).delete(e),t}_pushPendingDependencies(e){for(const t of e)p(this,wn).add(t)}take(){return p(this,ih).clear(),new cW(p(this,Jr),p(this,Ro))}takeDebugMetadata(){return p(this,Is)}}xn=new WeakMap,Tn=new WeakMap,Wc=new WeakMap,qi=new WeakMap,Uc=new WeakMap,Po=new WeakMap,vt=new WeakMap,Tt=new WeakMap,Eo=new WeakMap,wn=new WeakMap,Qv=new WeakMap,ih=new WeakMap,Zc=new WeakMap,$c=new WeakMap,Ro=new WeakMap,Jr=new WeakMap,Is=new WeakMap,eS=new WeakSet,Aw=function(e,t){const n=new ArrayBuffer(e*4);E(this,Ro,new Uint8ClampedArray(n)),E(this,Jr,new Uint32Array(n)),t&&t.length>0?(p(this,Jr).set(t),p(this,Jr).fill(Cw,t.length)):p(this,Jr).fill(Cw)};var Rt,Jt,Gi,sh,oh;const YP=class YP{constructor(e,t,n){N(this,Rt);N(this,Jt);N(this,Gi);N(this,sh,0);N(this,oh,0);if(e instanceof YP&&p(e,Gi)===!!n)return e;E(this,Rt,e),E(this,Jt,t),E(this,Gi,!!n)}growOperationsCount(){throw new Error("Unreachable")}save(e){return mr(this,oh)._++,p(this,Rt).save(p(this,Jt)),this}restore(e){return p(this,oh)>0&&(p(this,Rt).restore(p(this,Jt)),mr(this,oh)._--),this}recordOpenMarker(e){return mr(this,sh)._++,this}getOpenMarker(){return p(this,sh)>0?p(this,Jt):p(this,Rt).getOpenMarker()}recordCloseMarker(e){return mr(this,sh)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return p(this,Rt).pushBaseTransform(e),this}popBaseTransform(){return p(this,Rt).popBaseTransform(),this}recordSimpleData(e,t){return p(this,Rt).recordSimpleData(e,p(this,Jt)),this}recordIncrementalData(e,t){return p(this,Rt).recordIncrementalData(e,p(this,Jt)),this}resetIncrementalData(e,t){return p(this,Rt).resetIncrementalData(e,p(this,Jt)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return p(this,Rt).recordSimpleDataFromNamed(e,t,p(this,Jt)),this}recordFutureForcedDependency(e,t){return p(this,Rt).recordFutureForcedDependency(e,p(this,Jt)),this}inheritSimpleDataAsFutureForcedDependencies(e){return p(this,Rt).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return p(this,Rt).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return p(this,Gi)||p(this,Rt).resetBBox(p(this,Jt)),this}recordClipBox(e,t,n,i,s,o){return p(this,Gi)||p(this,Rt).recordClipBox(p(this,Jt),t,n,i,s,o),this}recordBBox(e,t,n,i,s,o){return p(this,Gi)||p(this,Rt).recordBBox(p(this,Jt),t,n,i,s,o),this}recordCharacterBBox(e,t,n,i,s,o,a){return p(this,Gi)||p(this,Rt).recordCharacterBBox(p(this,Jt),t,n,i,s,o,a),this}recordFullPageBBox(e){return p(this,Gi)||p(this,Rt).recordFullPageBBox(p(this,Jt)),this}getSimpleIndex(e){return p(this,Rt).getSimpleIndex(e)}recordDependencies(e,t){return p(this,Rt).recordDependencies(p(this,Jt),t),this}recordNamedDependency(e,t){return p(this,Rt).recordNamedDependency(p(this,Jt),t),this}recordOperation(e){return p(this,Rt).recordOperation(p(this,Jt),!0),this}recordShowTextOperation(e){return p(this,Rt).recordShowTextOperation(p(this,Jt),!0),this}bboxToClipBoxDropOperation(e){return p(this,Gi)||p(this,Rt).bboxToClipBoxDropOperation(p(this,Jt),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};Rt=new WeakMap,Jt=new WeakMap,Gi=new WeakMap,sh=new WeakMap,oh=new WeakMap;let NC=YP;const gi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Fr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function bw(r,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,n),r.clip(i)}class FP{isModifyingCurrentTransform(){return!1}getPattern(){kt("Abstract method `getPattern` called.")}}class dW extends FP{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let n,i=this._p0,s=this._p1;if(t&&(i=i.slice(),s=s.slice(),we.applyTransform(i,t),we.applyTransform(s,t)),this._type==="axial")n=e.createLinearGradient(i[0],i[1],s[0],s[1]);else if(this._type==="radial"){let o=this._r0,a=this._r1;if(t){const l=new Float32Array(2);we.singularValueDecompose2dScale(t,l),o*=l[0],a*=l[0]}n=e.createRadialGradient(i[0],i[1],o,s[0],s[1],a)}for(const o of this._colorStops)n.addColorStop(o[0],o[1]);return n}getPattern(e,t,n,i){let s;if(i===Fr.STROKE||i===Fr.FILL){if(this.isOriginBased()){let g=we.transform(n,t.baseTransform);this.matrix&&(g=we.transform(g,this.matrix));const v=.001,y=Math.hypot(g[0],g[1]),A=Math.hypot(g[2],g[3]),x=(g[0]*g[2]+g[1]*g[3])/(y*A);if(Math.abs(x)<v)if(this.isRadial()){if(Math.abs(y-A)<v)return this._createGradient(e,g)}else return this._createGradient(e,g)}const o=t.current.getClippedPathBoundingBox(i,Gt(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,u=t.cachedCanvases.getCanvas("pattern",a,l),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-o[0],-o[1]),n=we.transform(n,[1,0,0,1,o[0],o[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),bw(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),s=e.createPattern(u.canvas,"no-repeat");const m=new DOMMatrix(n);s.setTransform(m)}else bw(e,this._bbox),s=this._createGradient(e);return s}}function IT(r,e,t,n,i,s,o,a){const l=e.coords,u=e.colors,h=r.data,m=r.width*4;let g;l[t+1]>l[n+1]&&(g=t,t=n,n=g,g=s,s=o,o=g),l[n+1]>l[i+1]&&(g=n,n=i,i=g,g=o,o=a,a=g),l[t+1]>l[n+1]&&(g=t,t=n,n=g,g=s,s=o,o=g);const v=(l[t]+e.offsetX)*e.scaleX,y=(l[t+1]+e.offsetY)*e.scaleY,A=(l[n]+e.offsetX)*e.scaleX,x=(l[n+1]+e.offsetY)*e.scaleY,b=(l[i]+e.offsetX)*e.scaleX,w=(l[i+1]+e.offsetY)*e.scaleY;if(y>=w)return;const T=u[s],k=u[s+1],I=u[s+2],M=u[o],L=u[o+1],j=u[o+2],B=u[a],z=u[a+1],Z=u[a+2],$=Math.round(y),U=Math.round(w);let Y,ee,X,re,G,J,ne,W;for(let V=$;V<=U;V++){if(V<x){const F=V<y?0:(y-V)/(y-x);Y=v-(v-A)*F,ee=T-(T-M)*F,X=k-(k-L)*F,re=I-(I-j)*F}else{let F;V>w?F=1:x===w?F=0:F=(x-V)/(x-w),Y=A-(A-b)*F,ee=M-(M-B)*F,X=L-(L-z)*F,re=j-(j-Z)*F}let ce;V<y?ce=0:V>w?ce=1:ce=(y-V)/(y-w),G=v-(v-b)*ce,J=T-(T-B)*ce,ne=k-(k-z)*ce,W=I-(I-Z)*ce;const ue=Math.round(Math.min(Y,G)),ve=Math.round(Math.max(Y,G));let se=m*V+ue*4;for(let F=ue;F<=ve;F++)ce=(Y-F)/(Y-G),ce<0?ce=0:ce>1&&(ce=1),h[se++]=ee-(ee-J)*ce|0,h[se++]=X-(X-ne)*ce|0,h[se++]=re-(re-W)*ce|0,h[se++]=255}}function hW(r,e,t){const n=e.coords,i=e.colors;let s,o;switch(e.type){case qT.LATTICE:const a=e.verticesPerRow,l=Math.floor(n.length/a)-1,u=a-1;for(s=0;s<l;s++){let h=s*a;for(let m=0;m<u;m++,h++)IT(r,t,n[h],n[h+1],n[h+a],i[h],i[h+1],i[h+a]),IT(r,t,n[h+a+1],n[h+1],n[h+a],i[h+a+1],i[h+1],i[h+a])}break;case qT.TRIANGLES:for(s=0,o=n.length;s<o;s+=3)IT(r,t,n[s],n[s+1],n[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class pW extends FP{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-a,h=Math.ceil(this._bounds[3])-l,m=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),g=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),v=u/m,y=h/g,A={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/v,scaleY:1/y},x=m+4,b=g+4,w=n.getCanvas("mesh",x,b),T=w.context,k=T.createImageData(m,g);if(t){const M=k.data;for(let L=0,j=M.length;L<j;L+=4)M[L]=t[0],M[L+1]=t[1],M[L+2]=t[2],M[L+3]=255}for(const M of this._figures)hW(k,M,A);return T.putImageData(k,2,2),{canvas:w.canvas,offsetX:a-2*v,offsetY:l-2*y,scaleX:v,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,i){bw(e,this._bbox);const s=new Float32Array(2);if(i===Fr.SHADING)we.singularValueDecompose2dScale(Gt(e),s);else if(this.matrix){we.singularValueDecompose2dScale(this.matrix,s);const[a,l]=s;we.singularValueDecompose2dScale(t.baseTransform,s),s[0]*=a,s[1]*=l}else we.singularValueDecompose2dScale(t.baseTransform,s);const o=this._createMeshCanvas(s,i===Fr.SHADING?null:this._background,t.cachedCanvases);return i!==Fr.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class fW extends FP{getPattern(){return"hotpink"}}function mW(r){switch(r[0]){case"RadialAxial":return new dW(r);case"Mesh":return new pW(r);case"Dummy":return new fW}throw new Error(`Unknown IR type: ${r[0]}`)}const nL={COLORED:1,UNCOLORED:2},GC=class GC{constructor(e,t,n,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e,t){var J,ne;const{bbox:n,operatorList:i,paintType:s,tilingType:o,color:a,canvasGraphicsFactory:l}=this;let{xstep:u,ystep:h}=this;u=Math.abs(u),h=Math.abs(h),hA("TilingType: "+o);const m=n[0],g=n[1],v=n[2],y=n[3],A=v-m,x=y-g,b=new Float32Array(2);we.singularValueDecompose2dScale(this.matrix,b);const[w,T]=b;we.singularValueDecompose2dScale(this.baseTransform,b);const k=w*b[0],I=T*b[1];let M=A,L=x,j=!1,B=!1;const z=Math.ceil(u*k),Z=Math.ceil(h*I),$=Math.ceil(A*k),U=Math.ceil(x*I);z>=$?M=u:j=!0,Z>=U?L=h:B=!0;const Y=this.getSizeAndScale(M,this.ctx.canvas.width,k),ee=this.getSizeAndScale(L,this.ctx.canvas.height,I),X=e.cachedCanvases.getCanvas("pattern",Y.size,ee.size),re=X.context,G=l.createCanvasGraphics(re,t);if(G.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(G,s,a),re.translate(-Y.scale*m,-ee.scale*g),G.transform(0,Y.scale,0,0,ee.scale,0,0),re.save(),(J=G.dependencyTracker)==null||J.save(),this.clipBbox(G,m,g,v,y),G.baseTransform=Gt(G.ctx),G.executeOperatorList(i),G.endDrawing(),(ne=G.dependencyTracker)==null||ne.restore(),re.restore(),j||B){const W=X.canvas;j&&(M=u),B&&(L=h);const V=this.getSizeAndScale(M,this.ctx.canvas.width,k),ce=this.getSizeAndScale(L,this.ctx.canvas.height,I),ue=V.size,ve=ce.size,se=e.cachedCanvases.getCanvas("pattern-workaround",ue,ve),F=se.context,te=j?Math.floor(A/u):0,ge=B?Math.floor(x/h):0;for(let oe=0;oe<=te;oe++)for(let pe=0;pe<=ge;pe++)F.drawImage(W,ue*oe,ve*pe,ue,ve,0,0,ue,ve);return{canvas:se.canvas,scaleX:V.scale,scaleY:ce.scale,offsetX:m,offsetY:g}}return{canvas:X.canvas,scaleX:Y.scale,scaleY:ee.scale,offsetX:m,offsetY:g}}getSizeAndScale(e,t,n){const i=Math.max(GC.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*n);return s>=i?s=i:n=s/e,{scale:n,size:s}}clipBbox(e,t,n,i,s){const o=i-t,a=s-n;e.ctx.rect(t,n,o,a),we.axialAlignedBoundingBox([t,n,i,s],Gt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const i=e.ctx,s=e.current;switch(t){case nL.COLORED:const{fillStyle:o,strokeStyle:a}=this.ctx;i.fillStyle=s.fillColor=o,i.strokeStyle=s.strokeColor=a;break;case nL.UNCOLORED:i.fillStyle=i.strokeStyle=n,s.fillColor=s.strokeColor=n;break;default:throw new E6(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,i,s){let o=n;i!==Fr.SHADING&&(o=we.transform(o,t.baseTransform),this.matrix&&(o=we.transform(o,this.matrix)));const a=this.createPatternCanvas(t,s);let l=new DOMMatrix(o);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);const u=e.createPattern(a.canvas,"repeat");return u.setTransform(l),u}};q(GC,"MAX_PATTERN_SIZE",3e3);let xw=GC;function gW({src:r,srcPos:e=0,dest:t,width:n,height:i,nonBlackColor:s=4294967295,inverseDecode:o=!1}){const a=Ar.isLittleEndian?4278190080:255,[l,u]=o?[s,a]:[a,s],h=n>>3,m=n&7,g=r.length;t=new Uint32Array(t.buffer);let v=0;for(let y=0;y<i;y++){for(const x=e+h;e<x;e++){const b=e<g?r[e]:255;t[v++]=b&128?u:l,t[v++]=b&64?u:l,t[v++]=b&32?u:l,t[v++]=b&16?u:l,t[v++]=b&8?u:l,t[v++]=b&4?u:l,t[v++]=b&2?u:l,t[v++]=b&1?u:l}if(m===0)continue;const A=e<g?r[e++]:255;for(let x=0;x<m;x++)t[v++]=A&1<<7-x?u:l}return{srcPos:e,destPos:v}}const iL=16,sL=100,vW=15,oL=10,Rn=16,kT=new DOMMatrix,ii=new Float32Array(2),yd=new Float32Array([1/0,1/0,-1/0,-1/0]);function SW(r,e){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){e.save(),this.__originalSave()},r.restore=function(){e.restore(),this.__originalRestore()},r.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},r.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},r.transform=function(t,n,i,s,o,a){e.transform(t,n,i,s,o,a),this.__originalTransform(t,n,i,s,o,a)},r.setTransform=function(t,n,i,s,o,a){e.setTransform(t,n,i,s,o,a),this.__originalSetTransform(t,n,i,s,o,a)},r.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},r.rotate=function(t){e.rotate(t),this.__originalRotate(t)},r.clip=function(t){e.clip(t),this.__originalClip(t)},r.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},r.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},r.bezierCurveTo=function(t,n,i,s,o,a){e.bezierCurveTo(t,n,i,s,o,a),this.__originalBezierCurveTo(t,n,i,s,o,a)},r.rect=function(t,n,i,s){e.rect(t,n,i,s),this.__originalRect(t,n,i,s)},r.closePath=function(){e.closePath(),this.__originalClosePath()},r.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class yW{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function B0(r,e,t,n,i,s,o,a,l,u){const[h,m,g,v,y,A]=Gt(r);if(m===0&&g===0){const w=o*h+y,T=Math.round(w),k=a*v+A,I=Math.round(k),M=(o+l)*h+y,L=Math.abs(Math.round(M)-T)||1,j=(a+u)*v+A,B=Math.abs(Math.round(j)-I)||1;return r.setTransform(Math.sign(h),0,0,Math.sign(v),T,I),r.drawImage(e,t,n,i,s,0,0,L,B),r.setTransform(h,m,g,v,y,A),[L,B]}if(h===0&&v===0){const w=a*g+y,T=Math.round(w),k=o*m+A,I=Math.round(k),M=(a+u)*g+y,L=Math.abs(Math.round(M)-T)||1,j=(o+l)*m+A,B=Math.abs(Math.round(j)-I)||1;return r.setTransform(0,Math.sign(m),Math.sign(g),0,T,I),r.drawImage(e,t,n,i,s,0,0,B,L),r.setTransform(h,m,g,v,y,A),[B,L]}r.drawImage(e,t,n,i,s,o,a,l,u);const x=Math.hypot(h,m),b=Math.hypot(g,v);return[x*l,b*u]}class aL{constructor(e,t,n){q(this,"alphaIsShape",!1);q(this,"fontSize",0);q(this,"fontSizeScale",1);q(this,"textMatrix",null);q(this,"textMatrixScale",1);q(this,"fontMatrix",VT);q(this,"leading",0);q(this,"x",0);q(this,"y",0);q(this,"lineX",0);q(this,"lineY",0);q(this,"charSpacing",0);q(this,"wordSpacing",0);q(this,"textHScale",1);q(this,"textRenderingMode",gr.FILL);q(this,"textRise",0);q(this,"fillColor","#000000");q(this,"strokeColor","#000000");q(this,"patternFill",!1);q(this,"patternStroke",!1);q(this,"fillAlpha",1);q(this,"strokeAlpha",1);q(this,"lineWidth",1);q(this,"activeSMask",null);q(this,"transferMaps","none");n==null||n(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=yd.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Fr.FILL,t=null){const n=this.minMax.slice();if(e===Fr.STROKE){t||kt("Stroke bounding box must include transform."),we.singularValueDecompose2dScale(t,ii);const i=ii[0]*this.lineWidth/2,s=ii[1]*this.lineWidth/2;n[0]-=i,n[1]-=s,n[2]+=i,n[3]+=s}return n}updateClipFromPath(){const e=we.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(yd,0)}getClippedPathBoundingBox(e=Fr.FILL,t=null){return we.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function lL(r,e){if(e instanceof ImageData){r.putImageData(e,0,0);return}const t=e.height,n=e.width,i=t%Rn,s=(t-i)/Rn,o=i===0?s:s+1,a=r.createImageData(n,Rn);let l=0,u;const h=e.data,m=a.data;let g,v,y,A;if(e.kind===V0.GRAYSCALE_1BPP){const x=h.byteLength,b=new Uint32Array(m.buffer,0,m.byteLength>>2),w=b.length,T=n+7>>3,k=4294967295,I=Ar.isLittleEndian?4278190080:255;for(g=0;g<o;g++){for(y=g<s?Rn:i,u=0,v=0;v<y;v++){const M=x-l;let L=0;const j=M>T?n:M*8-7,B=j&-8;let z=0,Z=0;for(;L<B;L+=8)Z=h[l++],b[u++]=Z&128?k:I,b[u++]=Z&64?k:I,b[u++]=Z&32?k:I,b[u++]=Z&16?k:I,b[u++]=Z&8?k:I,b[u++]=Z&4?k:I,b[u++]=Z&2?k:I,b[u++]=Z&1?k:I;for(;L<j;L++)z===0&&(Z=h[l++],z=128),b[u++]=Z&z?k:I,z>>=1}for(;u<w;)b[u++]=0;r.putImageData(a,0,g*Rn)}}else if(e.kind===V0.RGBA_32BPP){for(v=0,A=n*Rn*4,g=0;g<s;g++)m.set(h.subarray(l,l+A)),l+=A,r.putImageData(a,0,v),v+=Rn;g<o&&(A=n*i*4,m.set(h.subarray(l,l+A)),r.putImageData(a,0,v))}else if(e.kind===V0.RGB_24BPP)for(y=Rn,A=n*y,g=0;g<o;g++){for(g>=s&&(y=i,A=n*y),u=0,v=A;v--;)m[u++]=h[l++],m[u++]=h[l++],m[u++]=h[l++],m[u++]=255;r.putImageData(a,0,g*Rn)}else throw new Error(`bad image kind: ${e.kind}`)}function cL(r,e){if(e.bitmap){r.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,i=t%Rn,s=(t-i)/Rn,o=i===0?s:s+1,a=r.createImageData(n,Rn);let l=0;const u=e.data,h=a.data;for(let m=0;m<o;m++){const g=m<s?Rn:i;({srcPos:l}=gW({src:u,srcPos:l,dest:h,width:n,height:g,nonBlackColor:0})),r.putImageData(a,0,m*Rn)}}function Ng(r,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)r[n]!==void 0&&(e[n]=r[n]);r.setLineDash!==void 0&&(e.setLineDash(r.getLineDash()),e.lineDashOffset=r.lineDashOffset)}function z0(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:e}=r;e!=="none"&&e!==""&&(r.filter="none")}function uL(r,e){if(e)return!0;we.singularValueDecompose2dScale(r,ii);const t=Math.fround(Ws.pixelRatio*xl.PDF_TO_CSS_UNITS);return ii[0]<=t&&ii[1]<=t}const CW=["butt","round","square"],AW=["miter","round","bevel"],bW={},dL={};var ns,Tw,ww,Pw;const XP=class XP{constructor(e,t,n,i,s,{optionalContentConfig:o,markedContentStack:a=null},l,u,h){N(this,ns);this.ctx=e,this.current=new aL(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new yW(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=h??null}getObject(e,t,n=null){var i;return typeof t=="string"?((i=this.dependencyTracker)==null||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:i=null}){const s=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=a,n){const l=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Gt(this.compositeCtx))}this.ctx.save(),z0(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Gt(this.ctx)}executeOperatorList(e,t,n,i,s){var b;const o=e.argsArray,a=e.fnArray;let l=t||0;const u=o.length;if(u===l)return l;const h=u-l>oL&&typeof n=="function",m=h?Date.now()+vW:0;let g=0;const v=this.commonObjs,y=this.objs;let A,x;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,n),l;if(!s||s(l))if(A=a[l],x=o[l]??null,A!==cv.dependency)x===null?this[A](l):this[A](l,...x);else for(const w of x){(b=this.dependencyTracker)==null||b.recordNamedData(w,l);const T=w.startsWith("g_")?v:y;if(!T.has(w))return T.get(w,n),l}if(l++,l===u)return l;if(h&&++g>oL){if(Date.now()>m)return n(),l;g=0}}}endDrawing(){_(this,ns,Tw).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),_(this,ns,ww).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,i=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=n,l=i,u="prescale1",h,m;for(;s>2&&a>1||o>2&&l>1;){let g=a,v=l;s>2&&a>1&&(g=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),s/=a/g),o>2&&l>1&&(v=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/v),h=this.cachedCanvases.getCanvas(u,g,v),m=h.context,m.clearRect(0,0,g,v),m.drawImage(e,0,0,a,l,0,0,g,v),e=h.canvas,a=g,l=v,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e,t){var z,Z;const n=this.ctx,{width:i,height:s}=t,o=this.current.fillColor,a=this.current.patternFill,l=Gt(n);let u,h,m,g;if((t.bitmap||t.data)&&t.count>1){const $=t.bitmap||t.data.buffer;h=JSON.stringify(a?l:[l.slice(0,4),o]),u=this._cachedBitmapsMap.get($),u||(u=new Map,this._cachedBitmapsMap.set($,u));const U=u.get(h);if(U&&!a){const Y=Math.round(Math.min(l[0],l[2])+l[4]),ee=Math.round(Math.min(l[1],l[3])+l[5]);return(z=this.dependencyTracker)==null||z.recordDependencies(e,gi.transformAndFill),{canvas:U,offsetX:Y,offsetY:ee}}m=U}m||(g=this.cachedCanvases.getCanvas("maskCanvas",i,s),cL(g.context,t));let v=we.transform(l,[1/i,0,0,-1/s,0,0]);v=we.transform(v,[1,0,0,1,0,-s]);const y=yd.slice();we.axialAlignedBoundingBox([0,0,i,s],v,y);const[A,x,b,w]=y,T=Math.round(b-A)||1,k=Math.round(w-x)||1,I=this.cachedCanvases.getCanvas("fillCanvas",T,k),M=I.context,L=A,j=x;M.translate(-L,-j),M.transform(...v),m||(m=this._scaleImage(g.canvas,ms(M)),m=m.img,u&&a&&u.set(h,m)),M.imageSmoothingEnabled=uL(Gt(M),t.interpolate),B0(M,m,0,0,m.width,m.height,0,0,i,s),M.globalCompositeOperation="source-in";const B=we.transform(ms(M),[1,0,0,1,-L,-j]);return M.fillStyle=a?o.getPattern(n,this,B,Fr.FILL,e):o,M.fillRect(0,0,i,s),u&&!a&&(this.cachedCanvases.delete("fillCanvas"),u.set(h,I.canvas)),(Z=this.dependencyTracker)==null||Z.recordDependencies(e,gi.transformAndFill),{canvas:I.canvas,offsetX:Math.round(L),offsetY:Math.round(j)}}setLineWidth(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineCap",e),this.ctx.lineCap=CW[t]}setLineJoin(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineJoin",e),this.ctx.lineJoin=AW[t]}setMiterLimit(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var n,i,s,o,a;for(const[l,u]of t)switch(l){case"LW":this.setLineWidth(e,u);break;case"LC":this.setLineCap(e,u);break;case"LJ":this.setLineJoin(e,u);break;case"ML":this.setMiterLimit(e,u);break;case"D":this.setDash(e,u[0],u[1]);break;case"RI":this.setRenderingIntent(e,u);break;case"FL":this.setFlatness(e,u);break;case"Font":this.setFont(e,u[0],u[1]);break;case"CA":(n=this.dependencyTracker)==null||n.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=u;break;case"ca":(i=this.dependencyTracker)==null||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(s=this.dependencyTracker)==null||s.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=u;break;case"SMask":(o=this.dependencyTracker)==null||o.recordSimpleData("SMask",e),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(a=this.dependencyTracker)==null||a.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,n);this.suspendedCtx=this.ctx;const o=this.ctx=s.context;o.setTransform(this.suspendedCtx.getTransform()),Ng(this.suspendedCtx,o),SW(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ng(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){const s=i[0],o=i[1],a=i[2]-s,l=i[3]-o;a===0||l===0||(this.genericComposeSMask(t.context,n,a,l,t.subtype,t.backdrop,t.transferMap,s,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,s,o,a,l,u,h,m){let g=e.canvas,v=l-h,y=u-m;if(o)if(v<0||y<0||v+n>g.width||y+i>g.height){const x=this.cachedCanvases.getCanvas("maskExtension",n,i),b=x.context;b.drawImage(g,-v,-y),b.globalCompositeOperation="destination-atop",b.fillStyle=o,b.fillRect(0,0,n,i),b.globalCompositeOperation="source-over",g=x.canvas,v=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(v,y,n,i),e.clip(x),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(v,y,n,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const A=new Path2D;A.rect(l,u,n,i),t.clip(A),t.globalCompositeOperation="destination-in",t.drawImage(g,v,y,n,i,l,u,n,i),t.restore()}save(e){var n;this.inSMaskMode&&Ng(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(n=this.dependencyTracker)==null||n.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Ng(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,i,s,o,a){var l;(l=this.dependencyTracker)==null||l.recordIncrementalData("transform",e),this.ctx.transform(t,n,i,s,o,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,i){let[s]=n;if(!i){s||(s=n[0]=new Path2D),this[t](e,s);return}if(this.dependencyTracker!==null){const o=t===cv.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-o,i[2]+o,i[1]-o,i[3]+o).recordDependencies(e,["transform"])}s instanceof Path2D||(s=n[0]=LO(s)),we.axialAlignedBoundingBox(i,Gt(this.ctx),this.current.minMax),this[t](e,s),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){var o;const i=this.ctx,s=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const a=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=s.getPattern(i,this,ms(i),Fr.STROKE,e),a){const l=new Path2D;l.addPath(t,i.getTransform().invertSelf().multiplySelf(a)),t=l}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);(o=this.dependencyTracker)==null||o.recordDependencies(e,gi.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Fr.STROKE,Gt(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){var u,h,m;const i=this.ctx,s=this.current.fillColor,o=this.current.patternFill;let a=!1;if(o){const g=s.isModifyingCurrentTransform()?i.getTransform():null;if((u=this.dependencyTracker)==null||u.save(e),i.save(),i.fillStyle=s.getPattern(i,this,ms(i),Fr.FILL,e),g){const v=new Path2D;v.addPath(t,i.getTransform().invertSelf().multiplySelf(g)),t=v}a=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),(h=this.dependencyTracker)==null||h.recordDependencies(e,gi.fill),a&&(i.restore(),(m=this.dependencyTracker)==null||m.restore(e)),n&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var n;this.ctx.fill(t),(n=this.dependencyTracker)==null||n.recordDependencies(e,gi.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=bW}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=dL}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,s=n.getTransform().invertSelf();for(const{transform:o,x:a,y:l,fontSize:u,path:h}of t)h&&i.addPath(h,new DOMMatrix(o).preMultiplySelf(s).translate(a,l).scale(u,-u));n.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){var m,g;(m=this.dependencyTracker)==null||m.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=i.fontMatrix||VT,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Ue("Invalid font matrix for font "+t),n<0?(n=-n,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=n,i.isType3Font)return;const o=i.loadedName||"sans-serif",a=((g=i.systemFontInfo)==null?void 0:g.css)||`"${o}", ${i.fallbackName}`;let l="normal";i.black?l="900":i.bold&&(l="bold");const u=i.italic?"italic":"normal";let h=n;n<iL?h=iL:n>sL&&(h=sL),this.current.fontSizeScale=n/h,this.ctx.font=`${u} ${l} ${h}px ${a}`}setTextRenderingMode(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,n,i,s,o){var b,w,T,k;const a=this.ctx,l=this.current,u=l.font,h=l.textRenderingMode,m=l.fontSize/l.fontSizeScale,g=h&gr.FILL_STROKE_MASK,v=!!(h&gr.ADD_TO_PATH_FLAG),y=l.patternFill&&!u.missingFile,A=l.patternStroke&&!u.missingFile;let x;if((u.disableFontFace||v||y||A)&&!u.missingFile&&(x=u.getPathGenerator(this.commonObjs,t)),x&&(u.disableFontFace||y||A)){a.save(),a.translate(n,i),a.scale(m,-m),(b=this.dependencyTracker)==null||b.recordCharacterBBox(e,a,u);let I;if(g===gr.FILL||g===gr.FILL_STROKE)if(s){I=a.getTransform(),a.setTransform(...s);const M=_(this,ns,Pw).call(this,x,I,s);a.fill(M)}else a.fill(x);if(g===gr.STROKE||g===gr.FILL_STROKE)if(o){I||(I=a.getTransform()),a.setTransform(...o);const{a:M,b:L,c:j,d:B}=I,z=we.inverseTransform(o),Z=we.transform([M,L,j,B,0,0],z);we.singularValueDecompose2dScale(Z,ii),a.lineWidth*=Math.max(ii[0],ii[1])/m,a.stroke(_(this,ns,Pw).call(this,x,I,o))}else a.lineWidth/=m,a.stroke(x);a.restore()}else(g===gr.FILL||g===gr.FILL_STROKE)&&(a.fillText(t,n,i),(w=this.dependencyTracker)==null||w.recordCharacterBBox(e,a,u,m,n,i,()=>a.measureText(t))),(g===gr.STROKE||g===gr.FILL_STROKE)&&(this.dependencyTracker&&((T=this.dependencyTracker)==null||T.recordCharacterBBox(e,a,u,m,n,i,()=>a.measureText(t)).recordDependencies(e,gi.stroke)),a.strokeText(t,n,i));v&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Gt(a),x:n,y:i,fontSize:m,path:x}),(k=this.dependencyTracker)==null||k.recordCharacterBBox(e,a,u,m,n,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return $e(this,"isFontSubpixelAAEnabled",n)}showText(e,t){var Z,$,U,Y;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,gi.showText).resetBBox(e),this.current.textRenderingMode&gr.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,i=n.font;if(i.isType3Font){this.showType3Text(e,t),(Z=this.dependencyTracker)==null||Z.recordShowTextOperation(e);return}const s=n.fontSize;if(s===0){($=this.dependencyTracker)==null||$.recordOperation(e);return}const o=this.ctx,a=n.fontSizeScale,l=n.charSpacing,u=n.wordSpacing,h=n.fontDirection,m=n.textHScale*h,g=t.length,v=i.vertical,y=v?1:-1,A=i.defaultVMetrics,x=s*n.fontMatrix[0],b=n.textRenderingMode===gr.FILL&&!i.disableFontFace&&!n.patternFill;o.save(),n.textMatrix&&o.transform(...n.textMatrix),o.translate(n.x,n.y+n.textRise),h>0?o.scale(m,-1):o.scale(m,1);let w,T;const k=n.textRenderingMode&gr.FILL_STROKE_MASK,I=k===gr.FILL||k===gr.FILL_STROKE,M=k===gr.STROKE||k===gr.FILL_STROKE;if(I&&n.patternFill){o.save();const ee=n.fillColor.getPattern(o,this,ms(o),Fr.FILL,e);w=Gt(o),o.restore(),o.fillStyle=ee}if(M&&n.patternStroke){o.save();const ee=n.strokeColor.getPattern(o,this,ms(o),Fr.STROKE,e);T=Gt(o),o.restore(),o.strokeStyle=ee}let L=n.lineWidth;const j=n.textMatrixScale;if(j===0||L===0?M&&(L=this.getSinglePixelWidth()):L/=j,a!==1&&(o.scale(a,a),L/=a),o.lineWidth=L,i.isInvalidPDFjsFont){const ee=[];let X=0;for(const G of t)ee.push(G.unicode),X+=G.width;const re=ee.join("");if(o.fillText(re,0,0),this.dependencyTracker!==null){const G=o.measureText(re);this.dependencyTracker.recordBBox(e,this.ctx,-G.actualBoundingBoxLeft,G.actualBoundingBoxRight,-G.actualBoundingBoxAscent,G.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=X*x*m,o.restore(),this.compose();return}let B=0,z;for(z=0;z<g;++z){const ee=t[z];if(typeof ee=="number"){B+=y*ee*s/1e3;continue}let X=!1;const re=(ee.isSpace?u:0)+l,G=ee.fontChar,J=ee.accent;let ne,W,V=ee.width;if(v){const ve=ee.vmetric||A,se=-(ee.vmetric?ve[1]:V*.5)*x,F=ve[2]*x;V=ve?-ve[0]:V,ne=se/a,W=(B+F)/a}else ne=B/a,W=0;let ce;if(i.remeasure&&V>0){ce=o.measureText(G);const ve=ce.width*1e3/s*a;if(V<ve&&this.isFontSubpixelAAEnabled){const se=V/ve;X=!0,o.save(),o.scale(se,1),ne/=se}else V!==ve&&(ne+=(V-ve)/2e3*s/a)}if(this.contentVisible&&(ee.isInFont||i.missingFile)){if(b&&!J)o.fillText(G,ne,W),(U=this.dependencyTracker)==null||U.recordCharacterBBox(e,o,ce?{bbox:null}:i,s/a,ne,W,()=>ce??o.measureText(G));else if(this.paintChar(e,G,ne,W,w,T),J){const ve=ne+s*J.offset.x/a,se=W-s*J.offset.y/a;this.paintChar(e,J.fontChar,ve,se,w,T)}}const ue=v?V*x-re*h:V*x+re*h;B+=ue,X&&o.restore()}v?n.y-=B:n.x+=B*m,o.restore(),this.compose(),(Y=this.dependencyTracker)==null||Y.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,i=this.current,s=i.font,o=i.fontSize,a=i.fontDirection,l=s.vertical?1:-1,u=i.charSpacing,h=i.wordSpacing,m=i.textHScale*a,g=i.fontMatrix||VT,v=t.length,y=i.textRenderingMode===gr.INVISIBLE;let A,x,b,w;if(y||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),i.textMatrix&&n.transform(...i.textMatrix),n.translate(i.x,i.y+i.textRise),n.scale(m,a);const T=this.dependencyTracker;for(this.dependencyTracker=T?new NC(T,e):null,A=0;A<v;++A){if(x=t[A],typeof x=="number"){w=l*x*o/1e3,this.ctx.translate(w,0),i.x+=w*m;continue}const k=(x.isSpace?h:0)+u,I=s.charProcOperatorList[x.operatorListId];I?this.contentVisible&&(this.save(),n.scale(o,o),n.transform(...g),this.executeOperatorList(I),this.restore()):Ue(`Type3 character "${x.operatorListId}" is not available.`);const M=[x.width,0];we.applyTransform(M,g),b=M[0]*o+k,n.translate(b,0),i.x+=b*m}n.restore(),T&&(this.dependencyTracker=T)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,i,s,o,a){var u;const l=new Path2D;l.rect(i,s,o-i,a-s),this.ctx.clip(l),(u=this.dependencyTracker)==null||u.recordBBox(e,this.ctx,i,o,s,a).recordClipBox(e,this.ctx,i,o,s,a),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const i=this.baseTransform||Gt(this.ctx),s={createCanvasGraphics:(o,a)=>new XP(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new NC(this.dependencyTracker,a,!0):null)};n=new xw(t,this.ctx,s,i)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=mW(this.getObject(e,t)),this.cachedPatterns.set(t,i)),n&&(i.matrix=n),i}shadingFill(e,t){var o;if(!this.contentVisible)return;const n=this.ctx;this.save(e);const i=this._getPattern(e,t);n.fillStyle=i.getPattern(n,this,ms(n),Fr.SHADING,e);const s=ms(n);if(s){const{width:a,height:l}=n.canvas,u=yd.slice();we.axialAlignedBoundingBox([0,0,a,l],s,u);const[h,m,g,v]=u;this.ctx.fillRect(h,m,g-h,v-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(o=this.dependencyTracker)==null||o.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,gi.transform).recordDependencies(e,gi.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){kt("Should not call beginInlineImage")}beginImageData(){kt("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){var i;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Gt(this.ctx),n)){we.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[s,o,a,l]=n,u=new Path2D;u.rect(s,o,a-s,l-o),this.ctx.clip(u),(i=this.dependencyTracker)==null||i.recordClipBox(e,this.ctx,s,a,o,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var T;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||hA("TODO: Support non-isolated groups."),t.knockout&&Ue("Knockout groups not supported.");const i=Gt(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=yd.slice();we.axialAlignedBoundingBox(t.bbox,Gt(n),s);const o=[0,0,n.canvas.width,n.canvas.height];s=we.intersect(s,o)||[0,0,0,0];const a=Math.floor(s[0]),l=Math.floor(s[1]),u=Math.max(Math.ceil(s[2])-a,1),h=Math.max(Math.ceil(s[3])-l,1);this.current.startNewPathAndClipBox([0,0,u,h]);let m="groupAt"+this.groupLevel;t.smask&&(m+="_smask_"+this.smaskCounter++%2);const g=this.cachedCanvases.getCanvas(m,u,h),v=g.context;v.translate(-a,-l),v.transform(...i);let y=new Path2D;const[A,x,b,w]=t.bbox;if(y.rect(A,x,b-A,w-x),t.matrix){const k=new Path2D;k.addPath(y,new DOMMatrix(t.matrix)),y=k}v.clip(y),t.smask&&this.smaskStack.push({canvas:g.canvas,context:v,offsetX:a,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(a,l),n.save()),Ng(n,v),this.ctx=v,(T=this.dependencyTracker)==null||T.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){var s;if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,(s=this.dependencyTracker)==null||s.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=Gt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const a=yd.slice();we.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],o,a),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,n,i,s,o){if(_(this,ns,Tw).call(this),z0(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const a=n[2]-n[0],l=n[3]-n[1];if(o&&this.annotationCanvasMap){i=i.slice(),i[4]-=n[0],i[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=a,n[3]=l,we.singularValueDecompose2dScale(Gt(this.ctx),ii);const{viewportScale:u}=this,h=Math.ceil(a*this.outputScaleX*u),m=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(h,m);const{canvas:g,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(t,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(ii[0],0,0,-ii[1],0,l*ii[1]),z0(this.ctx)}else{z0(this.ctx),this.endPath(e);const u=new Path2D;u.rect(n[0],n[1],a,l),this.ctx.clip(u)}}this.current=new aL(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...s)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),_(this,ns,ww).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var a;if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const i=this.ctx,s=this._createMaskCanvas(e,t),o=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(o,s.offsetX,s.offsetY),(a=this.dependencyTracker)==null||a.resetBBox(e).recordBBox(e,this.ctx,s.offsetX,s.offsetX+o.width,s.offsetY,s.offsetY+o.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,i=0,s=0,o,a){var m,g,v;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const l=this.ctx;l.save();const u=Gt(l);l.transform(n,i,s,o,0,0);const h=this._createMaskCanvas(e,t);l.setTransform(1,0,0,1,h.offsetX-u[4],h.offsetY-u[5]),(m=this.dependencyTracker)==null||m.resetBBox(e);for(let y=0,A=a.length;y<A;y+=2){const x=we.transform(u,[n,i,s,o,a[y],a[y+1]]);l.drawImage(h.canvas,x[4],x[5]),(g=this.dependencyTracker)==null||g.recordBBox(e,this.ctx,x[4],x[4]+h.canvas.width,x[5],x[5]+h.canvas.height)}l.restore(),this.compose(),(v=this.dependencyTracker)==null||v.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var o,a,l;if(!this.contentVisible)return;const n=this.ctx,i=this.current.fillColor,s=this.current.patternFill;(o=this.dependencyTracker)==null||o.resetBBox(e).recordDependencies(e,gi.transformAndFill);for(const u of t){const{data:h,width:m,height:g,transform:v}=u,y=this.cachedCanvases.getCanvas("maskCanvas",m,g),A=y.context;A.save();const x=this.getObject(e,h,u);cL(A,x),A.globalCompositeOperation="source-in",A.fillStyle=s?i.getPattern(A,this,ms(n),Fr.FILL,e):i,A.fillRect(0,0,m,g),A.restore(),n.save(),n.transform(...v),n.scale(1,-1),B0(n,y.canvas,0,0,m,g,0,-1,1,1),(a=this.dependencyTracker)==null||a.recordBBox(e,n,0,m,0,g),n.restore()}this.compose(),(l=this.dependencyTracker)==null||l.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){Ue("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,i,s){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){Ue("Dependent image isn't ready yet");return}const a=o.width,l=o.height,u=[];for(let h=0,m=s.length;h<m;h+=2)u.push({transform:[n,0,0,i,s[h],s[h+1]],x:0,y:0,w:a,h:l});this.paintInlineImageXObjectGroup(e,o,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",n,i),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",s.canvas}paintInlineImageXObject(e,t){var u;if(!this.contentVisible)return;const n=t.width,i=t.height,s=this.ctx;this.save(e);const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none"),s.scale(1/n,-1/i);let a;if(t.bitmap)a=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)a=t;else{const m=this.cachedCanvases.getCanvas("inlineImage",n,i).context;lL(m,t),a=this.applyTransferMapsToCanvas(m)}const l=this._scaleImage(a,ms(s));s.imageSmoothingEnabled=uL(Gt(s),t.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,s,0,n,-i,0).recordDependencies(e,gi.imageXObject).recordOperation(e),B0(s,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,n,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){var o,a,l;if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const u=t.width,h=t.height,g=this.cachedCanvases.getCanvas("inlineImage",u,h).context;lL(g,t),s=this.applyTransferMapsToCanvas(g)}(o=this.dependencyTracker)==null||o.resetBBox(e);for(const u of n)i.save(),i.transform(...u.transform),i.scale(1,-1),B0(i,s,u.x,u.y,u.w,u.h,0,-1,1,1),(a=this.dependencyTracker)==null||a.recordBBox(e,i,0,1,-1,0),i.restore();(l=this.dependencyTracker)==null||l.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,gi.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){var n;(n=this.dependencyTracker)==null||n.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){var o,a;const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const s=this.ctx;this.pendingClip?(i||(this.pendingClip===dL?s.clip(t,"evenodd"):s.clip(t)),this.pendingClip=null,(o=this.dependencyTracker)==null||o.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(a=this.dependencyTracker)==null||a.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Gt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:s}=this.ctx.getTransform();let o,a;if(n===0&&i===0){const l=Math.abs(t),u=Math.abs(s);if(l===u)if(e===0)o=a=1/l;else{const h=l*e;o=a=h<1?1/h:1}else if(e===0)o=1/l,a=1/u;else{const h=l*e,m=u*e;o=h<1?1/h:1,a=m<1?1/m:1}}else{const l=Math.abs(t*s-n*i),u=Math.hypot(t,n),h=Math.hypot(i,s);if(e===0)o=h/l,a=u/l;else{const m=e*l;o=h>m?h/m:1,a=u>m?u/m:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:i}}=this,[s,o]=this.getScaleForStroking();if(s===o){n.lineWidth=(i||1)*s,n.stroke(e);return}const a=n.getLineDash();t&&n.save(),n.scale(s,o),kT.a=1/s,kT.d=1/o;const l=new Path2D;if(l.addPath(e,kT),a.length>0){const u=Math.max(s,o);n.setLineDash(a.map(h=>h/u)),n.lineDashOffset/=u}n.lineWidth=i||1,n.stroke(l),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};ns=new WeakSet,Tw=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ww=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Pw=function(e,t,n){const i=new Path2D;return i.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),i};let Td=XP;for(const r in cv)Td.prototype[r]!==void 0&&(Td.prototype[cv[r]]=Td.prototype[r]);var tS,rS;class Fs{static get workerPort(){return p(this,tS)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");E(this,tS,e)}static get workerSrc(){return p(this,rS)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");E(this,rS,e)}}tS=new WeakMap,rS=new WeakMap,N(Fs,tS,null),N(Fs,rS,"");var ah,nS;class xW{constructor({parsedData:e,rawData:t}){N(this,ah);N(this,nS);E(this,ah,e),E(this,nS,t)}getRaw(){return p(this,nS)}get(e){return p(this,ah).get(e)??null}[Symbol.iterator](){return p(this,ah).entries()}}ah=new WeakMap,nS=new WeakMap;const fd=Symbol("INTERNAL");var iS,sS,oS,lh;class TW{constructor(e,{name:t,intent:n,usage:i,rbGroups:s}){N(this,iS,!1);N(this,sS,!1);N(this,oS,!1);N(this,lh,!0);E(this,iS,!!(e&ni.DISPLAY)),E(this,sS,!!(e&ni.PRINT)),this.name=t,this.intent=n,this.usage=i,this.rbGroups=s}get visible(){if(p(this,oS))return p(this,lh);if(!p(this,lh))return!1;const{print:e,view:t}=this.usage;return p(this,iS)?(t==null?void 0:t.viewState)!=="OFF":p(this,sS)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==fd&&kt("Internal method `_setVisible` called."),E(this,oS,n),E(this,lh,t)}}iS=new WeakMap,sS=new WeakMap,oS=new WeakMap,lh=new WeakMap;var Xa,wt,ch,uh,aS,Ew;class wW{constructor(e,t=ni.DISPLAY){N(this,aS);N(this,Xa,null);N(this,wt,new Map);N(this,ch,null);N(this,uh,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,E(this,uh,e.order);for(const n of e.groups)p(this,wt).set(n.id,new TW(t,n));if(e.baseState==="OFF")for(const n of p(this,wt).values())n._setVisible(fd,!1);for(const n of e.on)p(this,wt).get(n)._setVisible(fd,!0);for(const n of e.off)p(this,wt).get(n)._setVisible(fd,!1);E(this,ch,this.getHash())}}isVisible(e){if(p(this,wt).size===0)return!0;if(!e)return hA("Optional content group not defined."),!0;if(e.type==="OCG")return p(this,wt).has(e.id)?p(this,wt).get(e.id).visible:(Ue(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return _(this,aS,Ew).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!p(this,wt).has(t))return Ue(`Optional content group not found: ${t}`),!0;if(p(this,wt).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!p(this,wt).has(t))return Ue(`Optional content group not found: ${t}`),!0;if(!p(this,wt).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!p(this,wt).has(t))return Ue(`Optional content group not found: ${t}`),!0;if(!p(this,wt).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!p(this,wt).has(t))return Ue(`Optional content group not found: ${t}`),!0;if(p(this,wt).get(t).visible)return!1}return!0}return Ue(`Unknown optional content policy ${e.policy}.`),!0}return Ue(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var s;const i=p(this,wt).get(e);if(!i){Ue(`Optional content group not found: ${e}`);return}if(n&&t&&i.rbGroups.length)for(const o of i.rbGroups)for(const a of o)a!==e&&((s=p(this,wt).get(a))==null||s._setVisible(fd,!1,!0));i._setVisible(fd,!!t,!0),E(this,Xa,null)}setOCGState({state:e,preserveRB:t}){let n;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const s=p(this,wt).get(i);if(s)switch(n){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!s.visible,t);break}}E(this,Xa,null)}get hasInitialVisibility(){return p(this,ch)===null||this.getHash()===p(this,ch)}getOrder(){return p(this,wt).size?p(this,uh)?p(this,uh).slice():[...p(this,wt).keys()]:null}getGroup(e){return p(this,wt).get(e)||null}getHash(){if(p(this,Xa)!==null)return p(this,Xa);const e=new dD;for(const[t,n]of p(this,wt))e.update(`${t}:${n.visible}`);return E(this,Xa,e.hexdigest())}[Symbol.iterator](){return p(this,wt).entries()}}Xa=new WeakMap,wt=new WeakMap,ch=new WeakMap,uh=new WeakMap,aS=new WeakSet,Ew=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let i=1;i<t;i++){const s=e[i];let o;if(Array.isArray(s))o=_(this,aS,Ew).call(this,s);else if(p(this,wt).has(s))o=p(this,wt).get(s).visible;else return Ue(`Optional content group not found: ${s}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"};class PW{constructor(e,{disableRange:t=!1,disableStream:n=!1}){ot(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(s==null?void 0:s.length)>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(n),!0)});ot(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,n,i,s;e.total===void 0?(n=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||n.call(t,{loaded:e.loaded}):(s=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||s.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){ot(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new EW(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new RW(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class EW{constructor(e,t,n=!1,i=null){this._stream=e,this._done=n||!1,this._filename=jP(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class RW{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function IW(r){let e=!0,t=n("filename\\*","i").exec(r);if(t){t=t[1];let h=a(t);return h=unescape(h),h=l(h),h=u(h),s(h)}if(t=o(r),t){const h=u(t);return s(h)}if(t=n("filename","i").exec(r),t){t=t[1];let h=a(t);return h=u(h),s(h)}function n(h,m){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function i(h,m){if(h){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const g=new TextDecoder(h,{fatal:!0}),v=ay(m);m=g.decode(v),e=!1}catch{}}return m}function s(h){return e&&/[\x80-\xff]/.test(h)&&(h=i("utf-8",h),e&&(h=i("iso-8859-1",h))),h}function o(h){const m=[];let g;const v=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(g=v.exec(h))!==null;){let[,A,x,b]=g;if(A=parseInt(A,10),A in m){if(A===0)break;continue}m[A]=[x,b]}const y=[];for(let A=0;A<m.length&&A in m;++A){let[x,b]=m[A];b=a(b),x&&(b=unescape(b),A===0&&(b=l(b))),y.push(b)}return y.join("")}function a(h){if(h.startsWith('"')){const m=h.slice(1).split('\\"');for(let g=0;g<m.length;++g){const v=m[g].indexOf('"');v!==-1&&(m[g]=m[g].slice(0,v),m.length=g+1),m[g]=m[g].replaceAll(/\\(.)/g,"$1")}h=m.join('"')}return h}function l(h){const m=h.indexOf("'");if(m===-1)return h;const g=h.slice(0,m),y=h.slice(m+1).replace(/^[^']*'/,"");return i(g,y)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,g,v,y){if(v==="q"||v==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,x){return String.fromCharCode(parseInt(x,16))}),i(g,y);try{y=atob(y)}catch{}return i(g,y)})}return""}function xD(r,e){const t=new Headers;if(!r||!e||typeof e!="object")return t;for(const n in e){const i=e[n];i!==void 0&&t.append(n,i)}return t}function fA(r){var e;return((e=URL.parse(r))==null?void 0:e.origin)??null}function TD({responseHeaders:r,isHttp:e,rangeChunkSize:t,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(r.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*t)||n||!e||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function wD(r){const e=r.get("Content-Disposition");if(e){let t=IW(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(jP(t))return t}return null}function hy(r,e){return new PC(`Unexpected server response (${r}) while retrieving PDF "${e}".`,r,r===404||r===0&&e.startsWith("file:"))}function PD(r){return r===200||r===206}function ED(r,e,t){return{method:"GET",headers:r,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function RD(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(Ue(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class kW{constructor(e){q(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=xD(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return ot(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new MW(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new NW(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class MW{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),i=t.url;fetch(i,ED(n,this._withCredentials,this._abortController)).then(s=>{if(e._responseOrigin=fA(s.url),!PD(s.status))throw hy(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const o=s.headers,{allowRangeRequests:a,suggestedLength:l}=TD({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=wD(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new bl("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:RD(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class NW{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${t}-${n-1}`);const o=i.url;fetch(o,ED(s,this._withCredentials,this._abortController)).then(a=>{const l=fA(a.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!PD(a.status))throw hy(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:RD(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const MT=200,NT=206;function LW(r){const e=r.response;return typeof e!="string"?e:ay(e).buffer}class _W{constructor({url:e,httpHeaders:t,withCredentials:n}){q(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=xD(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,o]of this.headers)t.setRequestHeader(s,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=NT):i.expectedStatus=MT,t.responseType="arraybuffer",ot(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var i;const n=this.pendingRequests[e];n&&((i=n.onProgress)==null||i.call(n,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){n.onError(i.status);return}const s=i.status||MT;if(!(s===MT&&n.expectedStatus===NT)&&s!==n.expectedStatus){n.onError(i.status);return}const a=LW(i);if(s===NT){const l=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);u?n.onDone({begin:parseInt(u[1],10),chunk:a}):(Ue('Missing or invalid "Content-Range" header.'),n.onError(0))}else a?n.onDone({begin:0,chunk:a}):n.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class OW{constructor(e){this._source=e,this._manager=new _W(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return ot(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new DW(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new jW(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class DW{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=fA(t.responseURL);const n=t.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[l,...u]=a.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:o}=TD({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=wD(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=hy(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class jW{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=fA((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=hy(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const BW=/^[a-z][a-z0-9\-+.]+:/i;function zW(r){if(BW.test(r))return new URL(r);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(r))}class FW{constructor(e){this.source=e,this.url=zW(e.url),ot(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return ot(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new WW(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new UW(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class WW{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=hy(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new bl("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class UW{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Lg=Symbol("INITIAL_DATA");var Un,lS,Rw;class ID{constructor(){N(this,lS);N(this,Un,Object.create(null))}get(e,t=null){if(t){const i=_(this,lS,Rw).call(this,e);return i.promise.then(()=>t(i.data)),null}const n=p(this,Un)[e];if(!n||n.data===Lg)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=p(this,Un)[e];return!!t&&t.data!==Lg}delete(e){const t=p(this,Un)[e];return!t||t.data===Lg?!1:(delete p(this,Un)[e],!0)}resolve(e,t=null){const n=_(this,lS,Rw).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in p(this,Un)){const{data:n}=p(this,Un)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}E(this,Un,Object.create(null))}*[Symbol.iterator](){for(const e in p(this,Un)){const{data:t}=p(this,Un)[e];t!==Lg&&(yield[e,t])}}}Un=new WeakMap,lS=new WeakSet,Rw=function(e){var t;return(t=p(this,Un))[e]||(t[e]={...Promise.withResolvers(),data:Lg})};const ZW=1e5,hL=30;var i_,Ja,Zn,cS,uS,Hc,Io,dS,hS,Vc,pS,dh,Qa,hh,fS,ph,qc,mS,gS,fh,Gc,vS,mh,gh,Xo,kD,MD,Iw,oi,nC,kw,ND,LD;const _r=class _r{constructor({textContentSource:e,container:t,viewport:n}){N(this,Xo);N(this,Ja,Promise.withResolvers());N(this,Zn,null);N(this,cS,!1);N(this,uS,!!((i_=globalThis.FontInspector)!=null&&i_.enabled));N(this,Hc,null);N(this,Io,null);N(this,dS,0);N(this,hS,0);N(this,Vc,null);N(this,pS,null);N(this,dh,0);N(this,Qa,0);N(this,hh,Object.create(null));N(this,fS,[]);N(this,ph,null);N(this,qc,[]);N(this,mS,new WeakMap);N(this,gS,null);var l;if(e instanceof ReadableStream)E(this,ph,e);else if(typeof e=="object")E(this,ph,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');E(this,Zn,E(this,pS,t)),E(this,Qa,n.scale*Ws.pixelRatio),E(this,dh,n.rotation),E(this,Io,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:o,pageY:a}=n.rawDims;E(this,gS,[1,0,0,-1,-o,a+s]),E(this,hS,i),E(this,dS,s),_(l=_r,oi,ND).call(l),t.style.setProperty("--min-font-size",p(_r,mh)),Iu(t,n),p(this,Ja).promise.finally(()=>{p(_r,gh).delete(this),E(this,Io,null),E(this,hh,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Ar.platform;return $e(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{p(this,Vc).read().then(({value:t,done:n})=>{if(n){p(this,Ja).resolve();return}p(this,Hc)??E(this,Hc,t.lang),Object.assign(p(this,hh),t.styles),_(this,Xo,kD).call(this,t.items),e()},p(this,Ja).reject)};return E(this,Vc,p(this,ph).getReader()),p(_r,gh).add(this),e(),p(this,Ja).promise}update({viewport:e,onBefore:t=null}){var s;const n=e.scale*Ws.pixelRatio,i=e.rotation;if(i!==p(this,dh)&&(t==null||t(),E(this,dh,i),Iu(p(this,pS),{rotation:i})),n!==p(this,Qa)){t==null||t(),E(this,Qa,n);const o={div:null,properties:null,ctx:_(s=_r,oi,nC).call(s,p(this,Hc))};for(const a of p(this,qc))o.properties=p(this,mS).get(a),o.div=a,_(this,Xo,Iw).call(this,o)}}cancel(){var t;const e=new bl("TextLayer task cancelled.");(t=p(this,Vc))==null||t.cancel(e).catch(()=>{}),E(this,Vc,null),p(this,Ja).reject(e)}get textDivs(){return p(this,qc)}get textContentItemsStr(){return p(this,fS)}static cleanup(){if(!(p(this,gh).size>0)){p(this,fh).clear();for(const{canvas:e}of p(this,Gc).values())e.remove();p(this,Gc).clear()}}};Ja=new WeakMap,Zn=new WeakMap,cS=new WeakMap,uS=new WeakMap,Hc=new WeakMap,Io=new WeakMap,dS=new WeakMap,hS=new WeakMap,Vc=new WeakMap,pS=new WeakMap,dh=new WeakMap,Qa=new WeakMap,hh=new WeakMap,fS=new WeakMap,ph=new WeakMap,qc=new WeakMap,mS=new WeakMap,gS=new WeakMap,fh=new WeakMap,Gc=new WeakMap,vS=new WeakMap,mh=new WeakMap,gh=new WeakMap,Xo=new WeakSet,kD=function(e){var i,s;if(p(this,cS))return;(s=p(this,Io)).ctx??(s.ctx=_(i=_r,oi,nC).call(i,p(this,Hc)));const t=p(this,qc),n=p(this,fS);for(const o of e){if(t.length>ZW){Ue("Ignoring additional textDivs for performance reasons."),E(this,cS,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=p(this,Zn);E(this,Zn,document.createElement("span")),p(this,Zn).classList.add("markedContent"),o.id&&p(this,Zn).setAttribute("id",`${o.id}`),a.append(p(this,Zn))}else o.type==="endMarkedContent"&&E(this,Zn,p(this,Zn).parentNode);continue}n.push(o.str),_(this,Xo,MD).call(this,o)}},MD=function(e){var y;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};p(this,qc).push(t);const i=we.transform(p(this,gS),e.transform);let s=Math.atan2(i[1],i[0]);const o=p(this,hh)[e.fontName];o.vertical&&(s+=Math.PI/2);let a=p(this,uS)&&o.fontSubstitution||o.fontFamily;a=_r.fontFamilyMap.get(a)||a;const l=Math.hypot(i[2],i[3]),u=l*_(y=_r,oi,LD).call(y,a,o,p(this,Hc));let h,m;s===0?(h=i[4],m=i[5]-u):(h=i[4]+u*Math.sin(s),m=i[5]-u*Math.cos(s));const g=t.style;g.left=`${(100*h/p(this,hS)).toFixed(2)}%`,g.top=`${(100*m/p(this,dS)).toFixed(2)}%`,g.setProperty("--font-height",`${l.toFixed(2)}px`),g.fontFamily=a,n.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,p(this,uS)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),s!==0&&(n.angle=s*(180/Math.PI));let v=!1;if(e.str.length>1)v=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const A=Math.abs(e.transform[0]),x=Math.abs(e.transform[3]);A!==x&&Math.max(A,x)/Math.min(A,x)>1.5&&(v=!0)}if(v&&(n.canvasWidth=o.vertical?e.height:e.width),p(this,mS).set(t,n),p(this,Io).div=t,p(this,Io).properties=n,_(this,Xo,Iw).call(this,p(this,Io)),n.hasText&&p(this,Zn).append(t),n.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),p(this,Zn).append(A)}},Iw=function(e){var o;const{div:t,properties:n,ctx:i}=e,{style:s}=t;if(n.canvasWidth!==0&&n.hasText){const{fontFamily:a}=s,{canvasWidth:l,fontSize:u}=n;_(o=_r,oi,kw).call(o,i,u*p(this,Qa),a);const{width:h}=i.measureText(t.textContent);h>0&&s.setProperty("--scale-x",l*p(this,Qa)/h)}n.angle!==0&&s.setProperty("--rotate",`${n.angle}deg`)},oi=new WeakSet,nC=function(e=null){let t=p(this,Gc).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),p(this,Gc).set(e,t),p(this,vS).set(t,{size:0,family:""})}return t},kw=function(e,t,n){const i=p(this,vS).get(e);t===i.size&&n===i.family||(e.font=`${t}px ${n}`,i.size=t,i.family=n)},ND=function(){if(p(this,mh)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),E(this,mh,e.getBoundingClientRect().height),e.remove()},LD=function(e,t,n){const i=p(this,fh).get(e);if(i)return i;const s=_(this,oi,nC).call(this,n);s.canvas.width=s.canvas.height=hL,_(this,oi,kw).call(this,s,hL,e);const o=s.measureText(""),a=o.fontBoundingBoxAscent,l=Math.abs(o.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let u=.8;return a?u=a/(a+l):(Ar.platform.isFirefox&&Ue("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),p(this,fh).set(e,u),u},N(_r,oi),N(_r,fh,new Map),N(_r,Gc,new Map),N(_r,vS,new WeakMap),N(_r,mh,null),N(_r,gh,new Set);let dv=_r;const $W=100;function _D(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const e=new Mw,{docId:t}=e,n=r.url?X6(r.url):null,i=r.data?J6(r.data):null,s=r.httpHeaders||null,o=r.withCredentials===!0,a=r.password??null,l=r.range instanceof OD?r.range:null,u=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let h=r.worker instanceof hv?r.worker:null;const m=r.verbosity,g=typeof r.docBaseUrl=="string"&&!pA(r.docBaseUrl)?r.docBaseUrl:null,v=_0(r.cMapUrl),y=r.cMapPacked!==!1,A=r.CMapReaderFactory||(un?oW:J2),x=_0(r.iccUrl),b=_0(r.standardFontDataUrl),w=r.StandardFontDataFactory||(un?aW:Q2),T=_0(r.wasmUrl),k=r.WasmFactory||(un?lW:eL),I=r.stopAtErrors!==!0,M=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,L=r.isEvalSupported!==!1,j=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!un,B=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!un&&(Ar.platform.isFirefox||!globalThis.chrome),z=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,Z=typeof r.disableFontFace=="boolean"?r.disableFontFace:un,$=r.fontExtraProperties===!0,U=r.enableXfa===!0,Y=r.ownerDocument||globalThis.document,ee=r.disableRange===!0,X=r.disableStream===!0,re=r.disableAutoFetch===!0,G=r.pdfBug===!0,J=r.CanvasFactory||(un?sW:rW),ne=r.FilterFactory||(un?iW:nW),W=r.enableHWA===!0,V=r.useWasm!==!1,ce=l?l.length:r.length??NaN,ue=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!un&&!Z,ve=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(A===J2&&w===Q2&&k===eL&&v&&b&&T&&Fg(v,document.baseURI)&&Fg(b,document.baseURI)&&Fg(T,document.baseURI)),se=null;T6(m);const F={canvasFactory:new J({ownerDocument:Y,enableHWA:W}),filterFactory:new ne({docId:t,ownerDocument:Y}),cMapReaderFactory:ve?null:new A({baseUrl:v,isCompressed:y}),standardFontDataFactory:ve?null:new w({baseUrl:b}),wasmFactory:ve?null:new k({baseUrl:T})};h||(h=hv.create({verbosity:m,port:Fs.workerPort}),e._worker=h);const te={docId:t,apiVersion:"5.4.530",data:i,password:a,disableAutoFetch:re,rangeChunkSize:u,length:ce,docBaseUrl:g,enableXfa:U,evaluatorOptions:{maxImageSize:M,disableFontFace:Z,ignoreErrors:I,isEvalSupported:L,isOffscreenCanvasSupported:j,isImageDecoderSupported:B,canvasMaxAreaInBytes:z,fontExtraProperties:$,useSystemFonts:ue,useWasm:V,useWorkerFetch:ve,cMapUrl:v,iccUrl:x,standardFontDataUrl:b,wasmUrl:T}},ge={ownerDocument:Y,pdfBug:G,styleElement:se,loadingParams:{disableAutoFetch:re,enableXfa:U}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const oe=h.messageHandler.sendWithPromise("GetDocRequest",te,i?[i.buffer]:null);let pe;if(l)pe=new PW(l,{disableRange:ee,disableStream:X});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");const Be=Fg(n)?kW:un?FW:OW;pe=new Be({url:n,length:ce,httpHeaders:s,withCredentials:o,rangeChunkSize:u,disableRange:ee,disableStream:X})}return oe.then(Be=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Fe=new Gg(t,Be,h.port),ye=new qW(Fe,e,pe,ge,F,W);e._transport=ye,Fe.send("Ready",null)})}).catch(e._capability.reject),e}var KC;const YC=class YC{constructor(){q(this,"_capability",Promise.withResolvers());q(this,"_transport",null);q(this,"_worker",null);q(this,"docId",`d${mr(YC,KC)._++}`);q(this,"destroyed",!1);q(this,"onPassword",null);q(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,n,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(s){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,s}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};KC=new WeakMap,N(YC,KC,0);let Mw=YC;var Kc,SS,yS,CS,AS;class OD{constructor(e,t,n=!1,i=null){N(this,Kc,Promise.withResolvers());N(this,SS,[]);N(this,yS,[]);N(this,CS,[]);N(this,AS,[]);this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(e){p(this,AS).push(e)}addProgressListener(e){p(this,CS).push(e)}addProgressiveReadListener(e){p(this,yS).push(e)}addProgressiveDoneListener(e){p(this,SS).push(e)}onDataRange(e,t){for(const n of p(this,AS))n(e,t)}onDataProgress(e,t){p(this,Kc).promise.then(()=>{for(const n of p(this,CS))n(e,t)})}onDataProgressiveRead(e){p(this,Kc).promise.then(()=>{for(const t of p(this,yS))t(e)})}onDataProgressiveDone(){p(this,Kc).promise.then(()=>{for(const e of p(this,SS))e()})}transportReady(){p(this,Kc).resolve()}requestDataRange(e,t){kt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Kc=new WeakMap,SS=new WeakMap,yS=new WeakMap,CS=new WeakMap,AS=new WeakMap;class HW{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return $e(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var ko,Yc,Qg;class VW{constructor(e,t,n,i=!1){N(this,Yc);N(this,ko,!1);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new H2:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new ID,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:s=!1}={}){return new cy({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return $e(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:i="display",annotationMode:s=ka.ENABLE,transform:o=null,background:a=null,optionalContentConfigPromise:l=null,annotationCanvasMap:u=null,pageColors:h=null,printAnnotationStorage:m=null,isEditing:g=!1,recordOperations:v=!1,operationsFilter:y=null}){var B,z,Z;(B=this._stats)==null||B.time("Overall");const A=this._transport.getRenderingIntent(i,s,m,g),{renderingIntent:x,cacheKey:b}=A;E(this,ko,!1),l||(l=this._transport.getOptionalContentConfig(x));let w=this._intentStates.get(b);w||(w=Object.create(null),this._intentStates.set(b,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const T=!!(x&ni.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(z=this._stats)==null||z.time("Page Request"),this._pumpOperatorList(A));const k=!!(this._pdfBug&&((Z=globalThis.StepperManager)!=null&&Z.enabled)),I=!this.recordedBBoxes&&(v||k),M=$=>{var U,Y;if(w.renderTasks.delete(L),I){const ee=(U=L.gfx)==null?void 0:U.dependencyTracker.take();ee&&(L.stepper&&L.stepper.setOperatorBBoxes(ee,L.gfx.dependencyTracker.takeDebugMetadata()),v&&(this.recordedBBoxes=ee))}T&&E(this,ko,!0),_(this,Yc,Qg).call(this),$?(L.capability.reject($),this._abortOperatorList({intentState:w,reason:$ instanceof Error?$:new Error($)})):L.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(Y=globalThis.Stats)!=null&&Y.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},L=new Nw({callback:M,params:{canvas:t,canvasContext:e,dependencyTracker:I?new uW(t,w.operatorList.length,k):null,viewport:n,transform:o,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:h,enableHWA:this._transport.enableHWA,operationsFilter:y});(w.renderTasks||(w.renderTasks=new Set)).add(L);const j=L.task;return Promise.all([w.displayReadyCapability.promise,l]).then(([$,U])=>{var Y;if(this.destroyed){M();return}if((Y=this._stats)==null||Y.time("Rendering"),!(U.renderingIntent&x))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");L.initializeGraphics({transparency:$,optionalContentConfig:U}),L.operatorListChanged()}).catch(M),j}getOperatorList({intent:e="display",annotationMode:t=ka.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){var u;function s(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const o=this._transport.getRenderingIntent(e,t,n,i,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>uv.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,i){function s(){o.read().then(function({value:l,done:u}){if(u){n(a);return}a.lang??(a.lang=l.lang),Object.assign(a.styles,l.styles),a.items.push(...l.items),s()},i)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),E(this,ko,!1),Promise.all(e)}cleanup(e=!1){E(this,ko,!0);const t=_(this,Yc,Qg).call(this);return e&&t&&this._stats&&(this._stats=new H2),t}_startRenderPage(e,t){var i,s;const n=this._intentStates.get(t);n&&((i=this._stats)==null||i.timeEnd("Page Request"),(s=n.displayReadyCapability)==null||s.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&_(this,Yc,Qg).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:i}){const{map:s,transfer:o}=n,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:i},o).getReader(),u=this._intentStates.get(t);u.streamReader=l;const h=()=>{l.read().then(({value:m,done:g})=>{if(g){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,u),h())},m=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const g of u.renderTasks)g.operatorListChanged();_(this,Yc,Qg).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(m);else if(u.opListReadCapability)u.opListReadCapability.reject(m);else throw m}})};h()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof DP){let i=$W;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new bl(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}ko=new WeakMap,Yc=new WeakSet,Qg=function(){if(!p(this,ko)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),E(this,ko,!1),!0};var el,Ki,Mo,Xc,XC,Jc,Qc,hn,iC,DD,jD,ev,vh,sC;const Ft=class Ft{constructor({name:e=null,port:t=null,verbosity:n=w6()}={}){N(this,hn);N(this,el,Promise.withResolvers());N(this,Ki,null);N(this,Mo,null);N(this,Xc,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(p(Ft,Qc).has(t))throw new Error("Cannot use more than one PDFWorker per port.");p(Ft,Qc).set(t,this),_(this,hn,DD).call(this,t)}else _(this,hn,jD).call(this)}get promise(){return p(this,el).promise}get port(){return p(this,Mo)}get messageHandler(){return p(this,Ki)}destroy(){var e,t;this.destroyed=!0,(e=p(this,Xc))==null||e.terminate(),E(this,Xc,null),p(Ft,Qc).delete(p(this,Mo)),E(this,Mo,null),(t=p(this,Ki))==null||t.destroy(),E(this,Ki,null)}static create(e){const t=p(this,Qc).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ft(e)}static get workerSrc(){if(Fs.workerSrc)return Fs.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return $e(this,"_setupFakeWorkerGlobal",(async()=>p(this,vh,sC)?p(this,vh,sC):(await import(this.workerSrc)).WorkerMessageHandler)())}};el=new WeakMap,Ki=new WeakMap,Mo=new WeakMap,Xc=new WeakMap,XC=new WeakMap,Jc=new WeakMap,Qc=new WeakMap,hn=new WeakSet,iC=function(){p(this,el).resolve(),p(this,Ki).send("configure",{verbosity:this.verbosity})},DD=function(e){E(this,Mo,e),E(this,Ki,new Gg("main","worker",e)),p(this,Ki).on("ready",()=>{}),_(this,hn,iC).call(this)},jD=function(){if(p(Ft,Jc)||p(Ft,vh,sC)){_(this,hn,ev).call(this);return}let{workerSrc:e}=Ft;try{Ft._isSameOrigin(window.location,e)||(e=Ft._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Gg("main","worker",t),i=()=>{s.abort(),n.destroy(),t.terminate(),this.destroyed?p(this,el).reject(new Error("Worker was destroyed")):_(this,hn,ev).call(this)},s=new AbortController;t.addEventListener("error",()=>{p(this,Xc)||i()},{signal:s.signal}),n.on("test",a=>{if(s.abort(),this.destroyed||!a){i();return}E(this,Ki,n),E(this,Mo,t),E(this,Xc,t),_(this,hn,iC).call(this)}),n.on("ready",a=>{if(s.abort(),this.destroyed){i();return}try{o()}catch{_(this,hn,ev).call(this)}});const o=()=>{const a=new Uint8Array;n.send("test",a,[a.buffer])};o();return}catch{hA("The worker has been disabled.")}_(this,hn,ev).call(this)},ev=function(){p(Ft,Jc)||(Ue("Setting up fake worker."),E(Ft,Jc,!0)),Ft._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){p(this,el).reject(new Error("Worker was destroyed"));return}const t=new tW;E(this,Mo,t);const n=`fake${mr(Ft,XC)._++}`,i=new Gg(n+"_worker",n,t);e.setup(i,t),E(this,Ki,new Gg(n,n+"_worker",t)),_(this,hn,iC).call(this)}).catch(e=>{p(this,el).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},vh=new WeakSet,sC=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},N(Ft,vh),N(Ft,XC,0),N(Ft,Jc,!1),N(Ft,Qc,new WeakMap),un&&(E(Ft,Jc,!0),Fs.workerSrc||(Fs.workerSrc="./pdf.worker.mjs")),Ft._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const i=new URL(t,n);return n.origin===i.origin},Ft._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Ft.fromPort=e=>{if(j6("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Ft.create(e)};let hv=Ft;var No,ks,Sh,yh,Lo,eu,tv;class qW{constructor(e,t,n,i,s,o){N(this,eu);N(this,No,new Map);N(this,ks,new Map);N(this,Sh,new Map);N(this,yh,new Map);N(this,Lo,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new ID,this.fontLoader=new G6({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}get annotationStorage(){return $e(this,"annotationStorage",new BP)}getRenderingIntent(e,t=ka.ENABLE,n=null,i=!1,s=!1){let o=ni.DISPLAY,a=fw;switch(e){case"any":o=ni.ANY;break;case"display":break;case"print":o=ni.PRINT;break;default:Ue(`getRenderingIntent - invalid intent: ${e}`)}const l=o&ni.PRINT&&n instanceof pD?n:this.annotationStorage;switch(t){case ka.DISABLE:o+=ni.ANNOTATIONS_DISABLE;break;case ka.ENABLE:break;case ka.ENABLE_FORMS:o+=ni.ANNOTATIONS_FORMS;break;case ka.ENABLE_STORAGE:o+=ni.ANNOTATIONS_STORAGE,a=l.serializable;break;default:Ue(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(o+=ni.IS_EDITING),s&&(o+=ni.OPLIST);const{ids:u,hash:h}=l.modifiedIds,m=[o,a.hash,h];return{renderingIntent:o,cacheKey:m.join("_"),annotationStorageSerializable:a,modifiedIds:u}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=p(this,Lo))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of p(this,ks).values())e.push(i._destroy());p(this,ks).clear(),p(this,Sh).clear(),p(this,yh).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,s;this.commonObjs.clear(),this.fontLoader.clear(),p(this,No).clear(),this.filterFactory.destroy(),dv.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new bl("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,i)=>{ot(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){i.close();return}ot(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async n=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:o}=this._fullReader;return(!i||!s)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:o}}),e.on("GetRangeReader",(n,i)=>{ot(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(n.begin,n.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:o,done:a}){if(a){i.close();return}ot(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{s.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new HW(n,this))}),e.on("DocException",n=>{t._capability.reject(Cn(n))}),e.on("PasswordRequest",n=>{E(this,Lo,Promise.withResolvers());try{if(!t.onPassword)throw Cn(n);const i=s=>{s instanceof Error?p(this,Lo).reject(s):p(this,Lo).resolve({password:s})};t.onPassword(i,n.code)}catch(i){p(this,Lo).reject(i)}return p(this,Lo).promise}),e.on("DataLoaded",n=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;p(this,ks).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,i,s])=>{var o;if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":if("error"in s){const g=s.error;Ue(`Error during font loading: ${g}`),this.commonObjs.resolve(n,g);break}const a=new mw(s),l=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(g,v)=>globalThis.FontInspector.fontAdded(g,v):null,u=new K6(a,l,s.extra,s.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(n,u)});break;case"CopyLocalImage":const{imageRef:h}=s;ot(h,"The imageRef must be defined.");for(const g of p(this,ks).values())for(const[,v]of g.objs)if((v==null?void 0:v.ref)===h)return v.dataLen?(this.commonObjs.resolve(n,structuredClone(v)),v.dataLen):null;break;case"FontPath":this.commonObjs.resolve(n,new Y6(s));break;case"Image":this.commonObjs.resolve(n,s);break;case"Pattern":const m=new gw(s);this.commonObjs.resolve(n,m.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([n,i,s,o])=>{var l;if(this.destroyed)return;const a=p(this,ks).get(i);if(!a.objs.has(n)){if(a._intentStates.size===0){(l=o==null?void 0:o.bitmap)==null||l.close();return}switch(s){case"Image":case"Pattern":a.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",n=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[n.type];if(!i)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Ue("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=this._fullReader)==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=p(this,Sh).get(t);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&p(this,yh).set(s.refStr,e);const o=new VW(t,s,this,this._params.pdfBug);return p(this,ks).set(t,o),o});return p(this,Sh).set(t,i),i}getPageIndex(e){return vw(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return _(this,eu,tv).call(this,"GetFieldObjects")}hasJSActions(){return _(this,eu,tv).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return _(this,eu,tv).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return _(this,eu,tv).call(this,"GetOptionalContentConfig").then(t=>new wW(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=p(this,No).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(i=>{var s,o;return{info:i[0],metadata:i[1]?new xW(i[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null,hasStructTree:i[2]}});return p(this,No).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of p(this,ks).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),p(this,No).clear(),this.filterFactory.destroy(!0),dv.cleanup()}}cachedPageNumber(e){if(!vw(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return p(this,yh).get(t)??null}}No=new WeakMap,ks=new WeakMap,Sh=new WeakMap,yh=new WeakMap,Lo=new WeakMap,eu=new WeakSet,tv=function(e,t=null){const n=p(this,No).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return p(this,No).set(e,i),i};var tl;class GW{constructor(e){N(this,tl,null);q(this,"onContinue",null);q(this,"onError",null);E(this,tl,e)}get promise(){return p(this,tl).capability.promise}cancel(e=0){p(this,tl).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=p(this,tl).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=p(this,tl);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}tl=new WeakMap;var rl,tu;const hc=class hc{constructor({callback:e,params:t,objs:n,commonObjs:i,annotationCanvasMap:s,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:m=!1,pageColors:g=null,enableHWA:v=!1,operationsFilter:y=null}){N(this,rl,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=m,this.pageColors=g,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new GW(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=v,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=y}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var l,u;if(this.cancelled)return;if(this._canvas){if(p(hc,tu).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");p(hc,tu).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:i,background:s,dependencyTracker:o}=this.params,a=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Td(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:i,viewport:n,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null,t=0){var n,i,s;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),p(this,rl)&&(window.cancelAnimationFrame(p(this,rl)),E(this,rl,null)),p(hc,tu).delete(this._canvas),e||(e=new DP(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(s=(i=this.task).onError)==null||s.call(i,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?E(this,rl,window.requestAnimationFrame(()=>{E(this,rl,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),p(hc,tu).delete(this._canvas),this.callback())))}};rl=new WeakMap,tu=new WeakMap,N(hc,tu,new WeakSet);let Nw=hc;const KW="5.4.530",YW="50cc4adac";var $n,ru,Ch,yr,bS,Ah,_o,xS,nl,Yi,TS,Pt,Lw,_w,Ow,ac,BD,Ia;const An=class An{constructor({editor:e=null,uiManager:t=null}){N(this,Pt);N(this,$n,null);N(this,ru,null);N(this,Ch);N(this,yr,null);N(this,bS,!1);N(this,Ah,!1);N(this,_o,null);N(this,xS);N(this,nl,null);N(this,Yi,null);var n,i;e?(E(this,Ah,!1),E(this,_o,e)):E(this,Ah,!0),E(this,Yi,(e==null?void 0:e._uiManager)||t),E(this,xS,p(this,Yi)._eventBus),E(this,Ch,((n=e==null?void 0:e.color)==null?void 0:n.toUpperCase())||((i=p(this,Yi))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),p(An,TS)||E(An,TS,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return $e(this,"_keyboardManager",new dy([[["Escape","mac+Escape"],An.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],An.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],An.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],An.prototype._moveToPrevious],[["Home","mac+Home"],An.prototype._moveToBeginning],[["End","mac+End"],An.prototype._moveToEnd]]))}renderButton(){const e=E(this,$n,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",p(this,_o)&&(e.ariaControls=`${p(this,_o).id}_colorpicker_dropdown`);const t=p(this,Yi)._signal;e.addEventListener("click",_(this,Pt,ac).bind(this),{signal:t}),e.addEventListener("keydown",_(this,Pt,Ow).bind(this),{signal:t});const n=E(this,ru,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=p(this,Ch),e.append(n),e}renderMainDropdown(){const e=E(this,yr,_(this,Pt,Lw).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===p(this,$n)){_(this,Pt,ac).call(this,e);return}const t=e.target.getAttribute("data-color");t&&_(this,Pt,_w).call(this,t,e)}_moveToNext(e){var t,n;if(!p(this,Pt,Ia)){_(this,Pt,ac).call(this,e);return}if(e.target===p(this,$n)){(t=p(this,yr).firstElementChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=p(this,yr))==null?void 0:t.firstElementChild)||e.target===p(this,$n)){p(this,Pt,Ia)&&this._hideDropdownFromKeyboard();return}p(this,Pt,Ia)||_(this,Pt,ac).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!p(this,Pt,Ia)){_(this,Pt,ac).call(this,e);return}(t=p(this,yr).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!p(this,Pt,Ia)){_(this,Pt,ac).call(this,e);return}(t=p(this,yr).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=p(this,yr))==null||e.classList.add("hidden"),p(this,$n).ariaExpanded="false",(t=p(this,nl))==null||t.abort(),E(this,nl,null)}_hideDropdownFromKeyboard(){var e;if(!p(this,Ah)){if(!p(this,Pt,Ia)){(e=p(this,_o))==null||e.unselect();return}this.hideDropdown(),p(this,$n).focus({preventScroll:!0,focusVisible:p(this,bS)})}}updateColor(e){if(p(this,ru)&&(p(this,ru).style.backgroundColor=e),!p(this,yr))return;const t=p(this,Yi).highlightColors.values();for(const n of p(this,yr).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=p(this,$n))==null||e.remove(),E(this,$n,null),E(this,ru,null),(t=p(this,yr))==null||t.remove(),E(this,yr,null)}};$n=new WeakMap,ru=new WeakMap,Ch=new WeakMap,yr=new WeakMap,bS=new WeakMap,Ah=new WeakMap,_o=new WeakMap,xS=new WeakMap,nl=new WeakMap,Yi=new WeakMap,TS=new WeakMap,Pt=new WeakSet,Lw=function(){const e=document.createElement("div"),t=p(this,Yi)._signal;e.addEventListener("contextmenu",Mi,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),p(this,_o)&&(e.id=`${p(this,_o).id}_colorpicker_dropdown`);for(const[n,i]of p(this,Yi).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=n,s.setAttribute("data-l10n-id",p(An,TS)[n]);const o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=i,s.ariaSelected=i===p(this,Ch),s.addEventListener("click",_(this,Pt,_w).bind(this,i),{signal:t}),e.append(s)}return e.addEventListener("keydown",_(this,Pt,Ow).bind(this),{signal:t}),e},_w=function(e,t){t.stopPropagation(),p(this,xS).dispatch("switchannotationeditorparams",{source:this,type:st.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},Ow=function(e){An._keyboardManager.exec(this,e)},ac=function(e){if(p(this,Pt,Ia)){this.hideDropdown();return}if(E(this,bS,e.detail===0),p(this,nl)||(E(this,nl,new AbortController),window.addEventListener("pointerdown",_(this,Pt,BD).bind(this),{signal:p(this,Yi).combinedSignal(p(this,nl))})),p(this,$n).ariaExpanded="true",p(this,yr)){p(this,yr).classList.remove("hidden");return}const t=E(this,yr,_(this,Pt,Lw).call(this));p(this,$n).append(t)},BD=function(e){var t;(t=p(this,yr))!=null&&t.contains(e.target)||this.hideDropdown()},Ia=function(){return p(this,yr)&&!p(this,yr).classList.contains("hidden")},N(An,TS,null);let LC=An;var Ms,wS,bh,PS;const pc=class pc{constructor(e){N(this,Ms,null);N(this,wS,null);N(this,bh,null);E(this,wS,e),E(this,bh,e._uiManager),p(pc,PS)||E(pc,PS,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(p(this,Ms))return p(this,Ms);const{editorType:e,colorType:t,color:n}=p(this,wS),i=E(this,Ms,document.createElement("input"));return i.type="color",i.value=n||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",p(pc,PS)[e]),i.addEventListener("input",()=>{p(this,bh).updateParams(t,i.value)},{signal:p(this,bh)._signal}),i}update(e){p(this,Ms)&&(p(this,Ms).value=e)}destroy(){var e;(e=p(this,Ms))==null||e.remove(),E(this,Ms,null)}hideDropdown(){}};Ms=new WeakMap,wS=new WeakMap,bh=new WeakMap,PS=new WeakMap,N(pc,PS,null);let _C=pc;Ge(116);Ge(531);function pL(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function _g(r){return Math.max(0,Math.min(255,255*r))}class fL{static CMYK_G([e,t,n,i]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=_g(e),[e,e,e]}static G_HTML([e]){const t=pL(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(_g)}static RGB_HTML(e){return`#${e.map(pL).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,n+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,n,i]){return[_g(1-Math.min(1,e+i)),_g(1-Math.min(1,n+i)),_g(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const i=1-e,s=1-t,o=1-n,a=Math.min(i,s,o);return["CMYK",i,s,o,a]}}class XW{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){kt("Abstract method `_createSVG` called.")}}class OC extends XW{_createSVG(e){return document.createElementNS(so,e)}}const JW=9,Mu=new WeakSet,QW=new Date().getTimezoneOffset()*60*1e3;class LT{static create(e){switch(e.data.annotationType){case ur.LINK:return new WP(e);case ur.TEXT:return new tU(e);case ur.WIDGET:switch(e.data.fieldType){case"Tx":return new rU(e);case"Btn":return e.data.radioButton?new WD(e):e.data.checkBox?new iU(e):new sU(e);case"Ch":return new oU(e);case"Sig":return new nU(e)}return new Ou(e);case ur.POPUP:return new jw(e);case ur.FREETEXT:return new VD(e);case ur.LINE:return new lU(e);case ur.SQUARE:return new cU(e);case ur.CIRCLE:return new uU(e);case ur.POLYLINE:return new qD(e);case ur.CARET:return new hU(e);case ur.INK:return new UP(e);case ur.POLYGON:return new dU(e);case ur.HIGHLIGHT:return new GD(e);case ur.UNDERLINE:return new pU(e);case ur.SQUIGGLY:return new fU(e);case ur.STRIKEOUT:return new mU(e);case ur.STAMP:return new KD(e);case ur.FILEATTACHMENT:return new gU(e);default:return new Kt(e)}}}var nu,xh,Pi,ES,Dw;const JP=class JP{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){N(this,ES);N(this,nu,null);N(this,xh,!1);N(this,Pi,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return JP._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var n;const{data:e}=this,t=(n=this.annotationStorage)==null?void 0:n.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var a;const e=(a=this.annotationStorage)==null?void 0:a.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:i}=this.data;let s=-1/0,o=-1/0;if((t==null?void 0:t.length)>=8){for(let l=0;l<t.length;l+=8)t[l+1]>o?(o=t[l+1],s=t[l+2]):t[l+1]===o&&(s=Math.max(s,t[l+2]));return[s,o]}if((n==null?void 0:n.length)>=1){for(const l of n)for(let u=0,h=l.length;u<h;u+=2)l[u+1]>o?(o=l[u+1],s=l[u]):l[u+1]===o&&(s=Math.max(s,l[u]));if(s!==1/0)return[s,o]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-s)/n,e[1]=100*(e[1]-o)/i,e}get commentText(){var t,n,i;const{data:e}=this;return((n=(t=this.annotationStorage.getRawValue(`${lv}${e.id}`))==null?void 0:t.popup)==null?void 0:n.contents)||((i=e.contentsObj)==null?void 0:i.str)||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${lv}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=p(this,Pi))==null?void 0:e.popup)||this.popup)==null||t.remove(),E(this,Pi,this.popup=null)}updateEdited(e){var s;if(!this.container)return;e.rect&&(p(this,nu)||E(this,nu,{rect:this.data.rect.slice(0)}));const{rect:t,popup:n}=e;t&&_(this,ES,Dw).call(this,t);let i=((s=p(this,Pi))==null?void 0:s.popup)||this.popup;!i&&(n!=null&&n.text)&&(this._createPopup(n),i=p(this,Pi).popup),i&&(i.updateEdited(e),n!=null&&n.deleted&&(i.remove(),E(this,Pi,null),this.popup=null))}resetEdited(){var e;p(this,nu)&&(_(this,ES,Dw).call(this,p(this,nu).rect),(e=p(this,Pi))==null||e.popup.resetEdited(),E(this,nu,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),!(this instanceof Ou)&&!(this instanceof WP)&&(s.tabIndex=0);const{style:o}=s;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof jw){const{rotation:A}=t;return!t.hasOwnCanvas&&A!==0&&this.setRotation(A,s),s}const{width:a,height:l}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const A=t.borderStyle.horizontalCornerRadius,x=t.borderStyle.verticalCornerRadius;if(A>0||x>0){const w=`calc(${A}px * var(--total-scale-factor)) / calc(${x}px * var(--total-scale-factor))`;o.borderRadius=w}else if(this instanceof WD){const w=`calc(${a}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;o.borderRadius=w}switch(t.borderStyle.style){case cd.SOLID:o.borderStyle="solid";break;case cd.DASHED:o.borderStyle="dashed";break;case cd.BEVELED:Ue("Unimplemented border style: beveled");break;case cd.INSET:Ue("Unimplemented border style: inset");break;case cd.UNDERLINE:o.borderBottomStyle="solid";break}const b=t.borderColor||null;b?(E(this,xh,!0),o.borderColor=we.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):o.borderWidth=0}const u=we.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:h,pageHeight:m,pageX:g,pageY:v}=i.rawDims;o.left=`${100*(u[0]-g)/h}%`,o.top=`${100*(u[1]-v)/m}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(o.width=`${100*a/h}%`,o.height=`${100*l/m}%`):this.setRotation(y,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:o}=this;e%180!==0&&([s,o]=[o,s]),t.style.width=`${100*s/n}%`,t.style.height=`${100*o/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,i)=>{const s=i.detail[t],o=s[0],a=s.slice(1);i.target.style[n]=fL[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[n]:fL[`${o}_rgb`](a)})};return $e(this,"_commonActions",{display:t=>{const{display:n}=t.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail)){const s=e[i]||n[i];s==null||s(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,s]of Object.entries(t)){const o=n[i];if(o){const a={detail:{[i]:s},target:e};o(a),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,s]=this.data.rect.map(A=>Math.fround(A));if(e.length===8){const[A,x,b,w]=e.subarray(2,6);if(i===A&&s===x&&t===b&&n===w)return}const{style:o}=this.container;let a;if(p(this,xh)){const{borderColor:A,borderWidth:x}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const l=i-t,u=s-n,{svgFactory:h}=this,m=h.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const g=h.createElement("defs");m.append(g);const v=h.createElement("clipPath"),y=`clippath_${this.data.id}`;v.setAttribute("id",y),v.setAttribute("clipPathUnits","objectBoundingBox"),g.append(v);for(let A=2,x=e.length;A<x;A+=8){const b=e[A],w=e[A+1],T=e[A+2],k=e[A+3],I=h.createElement("rect"),M=(T-t)/l,L=(s-w)/u,j=(b-T)/l,B=(w-k)/u;I.setAttribute("x",M),I.setAttribute("y",L),I.setAttribute("width",j),I.setAttribute("height",B),v.append(I),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${M}" y="${L}" width="${j}" height="${B}"/>`)}p(this,xh)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(m),this.container.style.clipPath=`url(#${y})`}_createPopup(e=null){const{data:t}=this;let n,i;e?(n={str:e.text},i=e.date):(n=t.contentsObj,i=t.modificationDate),E(this,Pi,new jw({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(p(this,Pi)||this.popup||this.data.popupRef)}get extraPopupElement(){return p(this,Pi)}render(){kt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:s,id:o,exportValues:a}of i){if(s===-1||o===t)continue;const l=typeof a=="string"?a:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!Mu.has(u)){Ue(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:l,domElement:u})}return n}for(const i of document.getElementsByName(e)){const{exportValue:s}=i,o=i.getAttribute("data-element-id");o!==t&&Mu.has(i)&&n.push({id:o,exportValue:s,domElement:i})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};nu=new WeakMap,xh=new WeakMap,Pi=new WeakMap,ES=new WeakSet,Dw=function(e){const{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:a,pageY:l}}}}=this;n==null||n.splice(0,4,...e),t.left=`${100*(e[0]-a)/s}%`,t.top=`${100*(o-e[3]+l)/o}%`,i===0?(t.width=`${100*(e[2]-e[0])/s}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(i)};let Kt=JP;class eU extends Kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var si,lc,zD,FD;class WP extends Kt{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});N(this,si);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(n.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),s=!0):t.attachment?(_(this,si,zD).call(this,i,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(_(this,si,FD).call(this,i,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=i,this.container.append(i)),this.container}_bindLink(t,n,i=""){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&_(this,si,lc).call(this),i&&(t.title=i)}_bindNamedAction(t,n,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),i&&(t.title=i),_(this,si,lc).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(n.actions)){const o=i.get(s);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:s}}),!1})}n.overlaidText&&(t.title=n.overlaidText),t.onclick||(t.onclick=()=>!1),_(this,si,lc).call(this)}_bindResetFormAction(t,n){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),_(this,si,lc).call(this),!this._fieldObjects){Ue('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var m;i==null||i();const{fields:s,refs:o,include:a}=n,l=[];if(s.length!==0||o.length!==0){const g=new Set(o);for(const v of s){const y=this._fieldObjects[v]||[];for(const{id:A}of y)g.add(A)}for(const v of Object.values(this._fieldObjects))for(const y of v)g.has(y.id)===a&&l.push(y)}else for(const g of Object.values(this._fieldObjects))l.push(...g);const u=this.annotationStorage,h=[];for(const g of l){const{id:v}=g;switch(h.push(v),g.type){case"text":{const A=g.defaultValue||"";u.setValue(v,{value:A});break}case"checkbox":case"radiobutton":{const A=g.defaultValue===g.exportValues;u.setValue(v,{value:A});break}case"combobox":case"listbox":{const A=g.defaultValue||"";u.setValue(v,{value:A});break}default:continue}const y=document.querySelector(`[data-element-id="${v}"]`);if(y){if(!Mu.has(y)){Ue(`_bindResetFormAction - element not allowed: ${v}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}si=new WeakSet,lc=function(){this.container.setAttribute("data-internal-link","")},zD=function(t,n,i="",s=null){t.href=this.linkService.getAnchorUrl(""),n.description?t.title=n.description:i&&(t.title=i),t.onclick=()=>{var o;return(o=this.downloadManager)==null||o.openOrDownloadData(n.content,n.filename,s),!1},_(this,si,lc).call(this)},FD=function(t,n,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),i&&(t.title=i),_(this,si,lc).call(this)};class tU extends Kt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class Ou extends Kt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Ar.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,s){n.includes("mouse")?e.addEventListener(n,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(n,o=>{var a;if(n==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}s&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o)}}))})}_setEventListeners(e,t,n,i){var s,o,a;for(const[l,u]of n)(u==="Action"||(s=this.data.actions)!=null&&s[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,u,i),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":we.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||JW,s=e.style;let o;const a=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a),h=Math.round(u/(wT*i))||1,m=u/h;o=Math.min(i,l(m/wT))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(i,l(u/wT))}s.fontSize=`calc(${o}px * var(--total-scale-factor))`,s.color=we.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class rU extends Ou{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,i){const s=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=n),s.setValue(o.id,{[i]:n})}render(){var i,s;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let u=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=u??a,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",u??a),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Mu.add(n),this.contentElement=n,n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:m,datetimeType:g,timeStep:v}=this.data,y=!!g&&this.enableScripting;m&&(n.title=m),this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",x=>{e.setValue(t,{value:x.target.value}),this.setPropertyOnSiblings(n,"value",x.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",x=>{const b=this.data.defaultFieldValue??"";n.value=h.userValue=b,h.formattedValue=null});let A=x=>{const{formattedValue:b}=h;b!=null&&(x.target.value=b),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",b=>{var T;if(h.focused)return;const{target:w}=b;if(y&&(w.type=g,v&&(w.step=v)),h.userValue){const k=h.userValue;if(y)if(g==="time"){const I=new Date(k),M=[I.getHours(),I.getMinutes(),I.getSeconds()];w.value=M.map(L=>L.toString().padStart(2,"0")).join(":")}else w.value=new Date(k-QW).toISOString().split(g==="date"?"T":".",1)[0];else w.value=k}h.lastCommittedValue=w.value,h.commitKey=1,(T=this.data.actions)!=null&&T.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const w={value(T){h.userValue=T.detail.value??"",y||e.setValue(t,{value:h.userValue.toString()}),T.target.value=h.userValue},formattedValue(T){const{formattedValue:k}=T.detail;h.formattedValue=k,k!=null&&T.target!==document.activeElement&&(T.target.value=k);const I={formattedValue:k};y&&(I.value=k),e.setValue(t,I)},selRange(T){T.target.setSelectionRange(...T.detail.selRange)},charLimit:T=>{var L;const{charLimit:k}=T.detail,{target:I}=T;if(k===0){I.removeAttribute("maxLength");return}I.setAttribute("maxLength",k);let M=h.userValue;!M||M.length<=k||(M=M.slice(0,k),I.value=h.userValue=M,e.setValue(t,{value:M}),(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:M,willCommit:!0,commitKey:1,selStart:I.selectionStart,selEnd:I.selectionEnd}}))}};this._dispatchEventFromSandbox(w,b)}),n.addEventListener("keydown",b=>{var k;h.commitKey=1;let w=-1;if(b.key==="Escape"?w=0:b.key==="Enter"&&!this.data.multiLine?w=2:b.key==="Tab"&&(h.commitKey=3),w===-1)return;const{value:T}=b.target;h.lastCommittedValue!==T&&(h.lastCommittedValue=T,h.userValue=T,(k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,willCommit:!0,commitKey:w,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const x=A;A=null,n.addEventListener("blur",b=>{var k,I;if(!h.focused||!b.relatedTarget)return;(k=this.data.actions)!=null&&k.Blur||(h.focused=!1);const{target:w}=b;let{value:T}=w;if(y){if(T&&g==="time"){const M=T.split(":").map(L=>parseInt(L,10));T=new Date(2e3,0,1,M[0],M[1],M[2]||0).valueOf(),w.step=""}else T.includes("T")||(T=`${T}T00:00`),T=new Date(T).valueOf();w.type="text"}h.userValue=T,h.lastCommittedValue!==T&&((I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,willCommit:!0,commitKey:h.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}})),x(b)}),(s=this.data.actions)!=null&&s.Keystroke&&n.addEventListener("beforeinput",b=>{var B;h.lastCommittedValue=null;const{data:w,target:T}=b,{value:k,selectionStart:I,selectionEnd:M}=T;let L=I,j=M;switch(b.inputType){case"deleteWordBackward":{const z=k.substring(0,I).match(/\w*[^\w]*$/);z&&(L-=z[0].length);break}case"deleteWordForward":{const z=k.substring(I).match(/^[^\w]*\w*/);z&&(j+=z[0].length);break}case"deleteContentBackward":I===M&&(L-=1);break;case"deleteContentForward":I===M&&(j+=1);break}b.preventDefault(),(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,change:w||"",willCommit:!1,selStart:L,selEnd:j}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(A&&n.addEventListener("blur",A),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${b}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class nU extends Ou{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class iU extends Ou{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Mu.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=0,s.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const u of this._getElementsByName(a,n)){const h=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(n,{value:l})}),s.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{const a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(n,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class WD extends Ou{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(const o of this._getElementsByName(t.fieldName,n))e.setValue(o.id,{value:!1});const s=document.createElement("input");if(Mu.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const u of this._getElementsByName(a,n))e.setValue(u.id,{value:!1});e.setValue(n,{value:l})}),s.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;s.addEventListener("updatefromsandbox",a=>{const l={value:u=>{const h=o===u.detail.value;for(const m of this._getElementsByName(u.target.name)){const g=h&&m.id===n;m.domElement&&(m.domElement.checked=g),e.setValue(m.id,{value:g})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class sU extends WP{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class oU extends Ou{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Mu.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",h=>{const m=this.data.defaultFieldValue;for(const g of i.options)g.selected=g.value===m});for(const h of this.data.options){const m=document.createElement("option");m.textContent=h.displayValue,m.value=h.exportValue,n.value.includes(h.exportValue)&&(m.setAttribute("selected",!0),s=!1),i.append(m)}let o=null;if(s){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),i.prepend(h),o=()=>{h.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const a=h=>{const m=h?"value":"textContent",{options:g,multiple:v}=i;return v?Array.prototype.filter.call(g,y=>y.selected).map(y=>y[m]):g.selectedIndex===-1?null:g[g.selectedIndex][m]};let l=a(!1);const u=h=>{const m=h.target.options;return Array.prototype.map.call(m,g=>({displayValue:g.textContent,exportValue:g.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",h=>{const m={value(g){o==null||o();const v=g.detail.value,y=new Set(Array.isArray(v)?v:[v]);for(const A of i.options)A.selected=y.has(A.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(g){i.multiple=!0},remove(g){const v=i.options,y=g.detail.remove;v[y].selected=!1,i.remove(y),v.length>0&&Array.prototype.findIndex.call(v,x=>x.selected)===-1&&(v[0].selected=!0),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},clear(g){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(g){const{index:v,displayValue:y,exportValue:A}=g.detail.insert,x=i.children[v],b=document.createElement("option");b.textContent=y,b.value=A,x?x.before(b):i.append(b),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},items(g){const{items:v}=g.detail;for(;i.length!==0;)i.remove(0);for(const y of v){const{displayValue:A,exportValue:x}=y,b=document.createElement("option");b.textContent=A,b.value=x,i.append(b)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},indices(g){const v=new Set(g.detail.indices);for(const y of g.target.options)y.selected=v.has(y.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(g){g.target.disabled=!g.detail.editable}};this._dispatchEventFromSandbox(m,h)}),i.addEventListener("input",h=>{var v;const m=a(!0),g=a(!1);e.setValue(t,{value:m}),h.preventDefault(),(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:g,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):i.addEventListener("input",function(h){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var RS,Bw;class jw extends Kt{constructor(t){const{data:n,elements:i,parent:s}=t,o=!!s._commentManager;super(t,{isRenderable:!o&&Kt._hasPopupData(n)});N(this,RS);if(this.elements=i,o&&Kt._hasPopupData(n)){const a=this.popup=_(this,RS,Bw).call(this);for(const l of i)l.popup=a}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const n=this.popup=_(this,RS,Bw).call(this),i=[];for(const s of this.elements)s.popup=n,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${Sd}${s}`).join(",")),this.container}}RS=new WeakSet,Bw=function(){return new aU({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var Hn,il,JC,QC,Th,wh,Qt,Ns,sl,iu,Ph,Eh,Ls,Vn,Oo,Do,er,jo,ol,IS,Bo,Rh,su,al,Pr,ll,Ye,oC,zw,Fw,Ww,aC,Uw,UD,ZD,$D,HD,lC,cC,Zw;class aU{constructor({container:e,color:t,elements:n,titleObj:i,modificationDate:s,contentsObj:o,richText:a,parent:l,rect:u,parentRect:h,open:m,commentManager:g=null}){N(this,Ye);N(this,Hn,null);N(this,il,_(this,Ye,$D).bind(this));N(this,JC,_(this,Ye,Zw).bind(this));N(this,QC,_(this,Ye,cC).bind(this));N(this,Th,_(this,Ye,lC).bind(this));N(this,wh,null);N(this,Qt,null);N(this,Ns,null);N(this,sl,null);N(this,iu,null);N(this,Ph,null);N(this,Eh,null);N(this,Ls,!1);N(this,Vn,null);N(this,Oo,null);N(this,Do,null);N(this,er,null);N(this,jo,null);N(this,ol,null);N(this,IS,null);N(this,Bo,null);N(this,Rh,null);N(this,su,null);N(this,al,!1);N(this,Pr,null);N(this,ll,null);E(this,Qt,e),E(this,Rh,i),E(this,Ns,o),E(this,Bo,a),E(this,Ph,l),E(this,wh,t),E(this,IS,u),E(this,Eh,h),E(this,iu,n),E(this,Hn,g),E(this,Pr,n[0]),E(this,sl,EC.toDateObject(s)),this.trigger=n.flatMap(v=>v.getElementsToTriggerPopup()),g||(_(this,Ye,oC).call(this),p(this,Qt).hidden=!0,m&&_(this,Ye,lC).call(this))}renderCommentButton(){if(p(this,er)){p(this,er).parentNode||p(this,Pr).container.after(p(this,er));return}if(p(this,jo)||_(this,Ye,zw).call(this),!p(this,jo))return;const{signal:e}=E(this,Oo,new AbortController),t=p(this,Pr).hasOwnCommentButton,n=()=>{p(this,Hn).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{p(this,Hn).toggleCommentPopup(this,!1,!0,!t)},s=()=>{p(this,Hn).toggleCommentPopup(this,!1,!1)};if(t){E(this,er,p(this,Pr).container);for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",p(this,il),{signal:e}),o.addEventListener("click",n,{signal:e}),o.addEventListener("pointerenter",i,{signal:e}),o.addEventListener("pointerleave",s,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=E(this,er,document.createElement("button"));o.className="annotationCommentButton";const a=p(this,Pr).container;o.style.zIndex=a.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),_(this,Ye,Ww).call(this),_(this,Ye,Fw).call(this),o.addEventListener("keydown",p(this,il),{signal:e}),o.addEventListener("click",n,{signal:e}),o.addEventListener("pointerenter",i,{signal:e}),o.addEventListener("pointerleave",s,{signal:e}),a.after(o)}}get commentButtonColor(){const{color:e,opacity:t}=p(this,Pr).commentData;return e?p(this,Ph)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=p(this,er))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:i,modificationDate:s}=p(this,Pr).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:i,modificationDate:s}}get elementBeforePopup(){return p(this,er)}get comment(){return p(this,ll)||E(this,ll,p(this,Pr).commentText),p(this,ll)}set comment(e){e!==this.comment&&(p(this,Pr).commentText=E(this,ll,e))}focus(){var e;(e=p(this,Pr).container)==null||e.focus()}get parentBoundingClientRect(){return p(this,Pr).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){p(this,er)&&(p(this,er).classList.toggle("selected",e),p(this,er).ariaExpanded=t)}setSelectedCommentButton(e){p(this,er).classList.toggle("selected",e)}get commentPopupPosition(){if(p(this,ol))return p(this,ol);const{x:e,y:t,height:n}=p(this,er).getBoundingClientRect(),{x:i,y:s,width:o,height:a}=p(this,Pr).layer.getBoundingClientRect();return[(e-i)/o,(t+n-s)/a]}set commentPopupPosition(e){E(this,ol,e)}hasDefaultPopupPosition(){return p(this,ol)===null}get commentButtonPosition(){return p(this,jo)}get commentButtonWidth(){return p(this,er).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=p(this,ol)||this.commentButtonPosition.map(u=>u/100),i=this.parentBoundingClientRect,{x:s,y:o,width:a,height:l}=i;p(this,Hn).showDialog(null,this,s+t*a,o+n*l,{...e,parentDimensions:i})}render(){var n,i;if(p(this,Vn))return;const e=E(this,Vn,document.createElement("div"));if(e.className="popup",p(this,wh)){const s=e.style.outlineColor=we.makeHexColor(...p(this,wh));e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const t=document.createElement("span");if(t.className="header",(n=p(this,Rh))!=null&&n.str){const s=document.createElement("span");s.className="title",t.append(s),{dir:s.dir,str:s.textContent}=p(this,Rh)}if(e.append(t),p(this,sl)){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:p(this,sl).valueOf()})),s.dateTime=p(this,sl).toISOString(),t.append(s)}NO({html:p(this,Ye,aC)||p(this,Ns).str,dir:(i=p(this,Ns))==null?void 0:i.dir,className:"popupContent"},e),p(this,Qt).append(e)}updateEdited({rect:e,popup:t,deleted:n}){var i;if(p(this,Hn)){n?(this.remove(),E(this,ll,null)):t&&(t.deleted?this.remove():(_(this,Ye,Ww).call(this),E(this,ll,t.text))),e&&(E(this,jo,null),_(this,Ye,zw).call(this),_(this,Ye,Fw).call(this));return}if(n||t!=null&&t.deleted){this.remove();return}_(this,Ye,oC).call(this),p(this,su)||E(this,su,{contentsObj:p(this,Ns),richText:p(this,Bo)}),e&&E(this,Do,null),t&&t.text&&(E(this,Bo,_(this,Ye,ZD).call(this,t.text)),E(this,sl,EC.toDateObject(t.date)),E(this,Ns,null)),(i=p(this,Vn))==null||i.remove(),E(this,Vn,null)}resetEdited(){var e;p(this,su)&&({contentsObj:mr(this,Ns)._,richText:mr(this,Bo)._}=p(this,su),E(this,su,null),(e=p(this,Vn))==null||e.remove(),E(this,Vn,null),E(this,Do,null))}remove(){var e,t,n;if((e=p(this,Oo))==null||e.abort(),E(this,Oo,null),(t=p(this,Vn))==null||t.remove(),E(this,Vn,null),E(this,al,!1),E(this,Ls,!1),(n=p(this,er))==null||n.remove(),E(this,er,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){E(this,al,this.isVisible),p(this,al)&&(p(this,Qt).hidden=!0)}maybeShow(){p(this,Hn)||(_(this,Ye,oC).call(this),p(this,al)&&(p(this,Vn)||_(this,Ye,cC).call(this),E(this,al,!1),p(this,Qt).hidden=!1))}get isVisible(){return p(this,Hn)?!1:p(this,Qt).hidden===!1}}Hn=new WeakMap,il=new WeakMap,JC=new WeakMap,QC=new WeakMap,Th=new WeakMap,wh=new WeakMap,Qt=new WeakMap,Ns=new WeakMap,sl=new WeakMap,iu=new WeakMap,Ph=new WeakMap,Eh=new WeakMap,Ls=new WeakMap,Vn=new WeakMap,Oo=new WeakMap,Do=new WeakMap,er=new WeakMap,jo=new WeakMap,ol=new WeakMap,IS=new WeakMap,Bo=new WeakMap,Rh=new WeakMap,su=new WeakMap,al=new WeakMap,Pr=new WeakMap,ll=new WeakMap,Ye=new WeakSet,oC=function(){var t;if(p(this,Oo))return;E(this,Oo,new AbortController);const{signal:e}=p(this,Oo);for(const n of this.trigger)n.addEventListener("click",p(this,Th),{signal:e}),n.addEventListener("pointerenter",p(this,QC),{signal:e}),n.addEventListener("pointerleave",p(this,JC),{signal:e}),n.classList.add("popupTriggerArea");for(const n of p(this,iu))(t=n.container)==null||t.addEventListener("keydown",p(this,il),{signal:e})},zw=function(){const e=p(this,iu).find(t=>t.hasCommentButton);e&&E(this,jo,e._normalizePoint(e.commentButtonPosition))},Fw=function(){if(p(this,Pr).extraPopupElement&&!p(this,Pr).editor)return;p(this,er)||this.renderCommentButton();const[e,t]=p(this,jo),{style:n}=p(this,er);n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`},Ww=function(){p(this,Pr).extraPopupElement||(p(this,er)||this.renderCommentButton(),p(this,er).style.backgroundColor=this.commentButtonColor||"")},aC=function(){const e=p(this,Bo),t=p(this,Ns);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&p(this,Bo).html||null},Uw=function(){var e,t,n;return((n=(t=(e=p(this,Ye,aC))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},UD=function(){var e,t,n;return((n=(t=(e=p(this,Ye,aC))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},ZD=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:p(this,Ye,UD),fontSize:p(this,Ye,Uw)?`calc(${p(this,Ye,Uw)}px * var(--total-scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:i});return n},$D=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&p(this,Ls))&&_(this,Ye,lC).call(this)},HD=function(){if(p(this,Do)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:s}}}=p(this,Ph);let o=!!p(this,Eh),a=o?p(this,Eh):p(this,IS);for(const y of p(this,iu))if(!a||we.intersect(y.data.rect,a)!==null){a=y.data.rect,o=!0;break}const l=we.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),h=o?a[2]-a[0]+5:0,m=l[0]+h,g=l[1];E(this,Do,[100*(m-i)/t,100*(g-s)/n]);const{style:v}=p(this,Qt);v.left=`${p(this,Do)[0]}%`,v.top=`${p(this,Do)[1]}%`},lC=function(){if(p(this,Hn)){p(this,Hn).toggleCommentPopup(this,!1);return}E(this,Ls,!p(this,Ls)),p(this,Ls)?(_(this,Ye,cC).call(this),p(this,Qt).addEventListener("click",p(this,Th)),p(this,Qt).addEventListener("keydown",p(this,il))):(_(this,Ye,Zw).call(this),p(this,Qt).removeEventListener("click",p(this,Th)),p(this,Qt).removeEventListener("keydown",p(this,il)))},cC=function(){p(this,Vn)||this.render(),this.isVisible?p(this,Ls)&&p(this,Qt).classList.add("focused"):(_(this,Ye,HD).call(this),p(this,Qt).hidden=!1,p(this,Qt).style.zIndex=parseInt(p(this,Qt).style.zIndex)+1e3)},Zw=function(){p(this,Qt).classList.remove("focused"),!(p(this,Ls)||!this.isVisible)&&(p(this,Qt).hidden=!0,p(this,Qt).style.zIndex=parseInt(p(this,Qt).style.zIndex)-1e3)};class VD extends Kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ve.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var kS;class lU extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});N(this,kS,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:n,height:i}=this,s=this.svgFactory.create(n,i,!0),o=E(this,kS,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return p(this,kS)}addHighlightArea(){this.container.classList.add("highlightArea")}}kS=new WeakMap;var MS;class cU extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});N(this,MS,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:n,height:i}=this,s=this.svgFactory.create(n,i,!0),o=t.borderStyle.width,a=E(this,MS,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",n-o),a.setAttribute("height",i-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return p(this,MS)}addHighlightArea(){this.container.classList.add("highlightArea")}}MS=new WeakMap;var NS;class uU extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});N(this,NS,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:n,height:i}=this,s=this.svgFactory.create(n,i,!0),o=t.borderStyle.width,a=E(this,NS,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",n/2),a.setAttribute("cy",i/2),a.setAttribute("rx",n/2-o/2),a.setAttribute("ry",i/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return p(this,NS)}addHighlightArea(){this.container.classList.add("highlightArea")}}NS=new WeakMap;var LS;class qD extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});N(this,LS,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:i,popupRef:s},width:o,height:a}=this;if(!n)return this.container;const l=this.svgFactory.create(o,a,!0);let u=[];for(let m=0,g=n.length;m<g;m+=2){const v=n[m]-t[0],y=t[3]-n[m+1];u.push(`${v},${y}`)}u=u.join(" ");const h=E(this,LS,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",i.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return p(this,LS)}addHighlightArea(){this.container.classList.add("highlightArea")}}LS=new WeakMap;class dU extends qD{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class hU extends Kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var _S,ou,OS,$w;class UP extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});N(this,OS);N(this,_S,null);N(this,ou,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ve.HIGHLIGHT:Ve.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:i,borderStyle:s,popupRef:o}}=this,{transform:a,width:l,height:u}=_(this,OS,$w).call(this,n,t),h=this.svgFactory.create(l,u,!0),m=E(this,_S,this.svgFactory.createElement("svg:g"));h.append(m),m.setAttribute("stroke-width",s.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",a);for(let g=0,v=i.length;g<v;g++){const y=this.svgFactory.createElement(this.svgElementName);p(this,ou).push(y),y.setAttribute("points",i[g].join(",")),m.append(y)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:i,rect:s}=t,o=p(this,_S);if(n>=0&&o.setAttribute("stroke-width",n||1),i)for(let a=0,l=p(this,ou).length;a<l;a++)p(this,ou)[a].setAttribute("points",i[a].join(","));if(s){const{transform:a,width:l,height:u}=_(this,OS,$w).call(this,this.data.rotation,s);o.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return p(this,ou)}addHighlightArea(){this.container.classList.add("highlightArea")}}_S=new WeakMap,ou=new WeakMap,OS=new WeakSet,$w=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class GD extends Kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ve.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class pU extends Kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class fU extends Kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class mU extends Kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class KD extends Kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ve.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var DS,jS,Hw;class gU extends Kt{constructor(t){var i;super(t,{isRenderable:!0});N(this,jS);N(this,DS,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let i;n.hasAppearance||n.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),i.addEventListener("dblclick",_(this,jS,Hw).bind(this)),E(this,DS,i);const{isMac:s}=Ar.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&_(this,jS,Hw).call(this)}),!n.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return p(this,DS)}addHighlightArea(){this.container.classList.add("highlightArea")}}DS=new WeakMap,jS=new WeakSet,Hw=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var au,lu,Ih,cl,BS,cu,qn,zS,Go,uC,qw;const QP=class QP{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:i,page:s,viewport:o,structTreeLayer:a,commentManager:l,linkService:u,annotationStorage:h}){N(this,Go);N(this,au,null);N(this,lu,null);N(this,Ih,null);N(this,cl,new Map);N(this,BS,null);N(this,cu,null);N(this,qn,[]);N(this,zS,!1);this.div=e,E(this,au,t),E(this,lu,n),E(this,BS,a||null),E(this,cu,u||null),E(this,Ih,h||new BP),this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=l||null}hasEditableAnnotations(){return p(this,cl).size>0}async render(e){var a;const{annotations:t}=e,n=this.div;Iu(n,this.viewport);const i=new Map,s=[],o={data:null,layer:n,linkService:p(this,cu),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new OC,annotationStorage:p(this,Ih),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const u=l.annotationType===ur.POPUP;if(u){const g=i.get(l.id);if(!g)continue;if(!this._commentManager){s.push(l);continue}o.elements=g}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;o.data=l;const h=LT.create(o);if(!h.isRenderable)continue;if(!u&&(p(this,qn).push(h),l.popupRef)){const g=i.get(l.popupRef);g?g.push(h):i.set(l.popupRef,[h])}const m=h.render();l.hidden&&(m.style.visibility="hidden"),h._isEditable&&(p(this,cl).set(h.data.id,h),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(h))}await _(this,Go,uC).call(this);for(const l of s){const u=o.elements=i.get(l.id);o.data=l;const h=LT.create(o);if(!h.isRenderable)continue;const m=h.render();h.contentElement.id=`${Sd}${l.id}`,l.hidden&&(m.style.visibility="hidden"),u.at(-1).container.after(m)}_(this,Go,qw).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:p(this,cu),svgFactory:new OC,parent:this};for(const n of e){n.borderStyle||(n.borderStyle=QP._defaultBorderStyle),t.data=n;const i=LT.create(t);i.isRenderable&&(i.render(),i.contentElement.id=`${Sd}${n.id}`,p(this,qn).push(i))}await _(this,Go,uC).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Iu(t,{rotation:e.rotation}),_(this,Go,qw).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(p(this,cl).values())}getEditableAnnotation(e){return p(this,cl).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:i}=e,s=new eU({data:{id:n,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:p(this,cu),annotationStorage:p(this,Ih)});return s.render(),s.contentElement.id=`${Sd}${n}`,s.createOrUpdatePopup(),p(this,qn).push(s),s}removeAnnotation(e){var i;const t=p(this,qn).findIndex(s=>s.data.id===e);if(t<0)return;const[n]=p(this,qn).splice(t,1);(i=p(this,au))==null||i.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);_(this,Go,uC).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return $e(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:cd.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};au=new WeakMap,lu=new WeakMap,Ih=new WeakMap,cl=new WeakMap,BS=new WeakMap,cu=new WeakMap,qn=new WeakMap,zS=new WeakMap,Go=new WeakSet,uC=async function(){var n,i,s;if(p(this,qn).length===0)return;this.div.replaceChildren();const e=[];if(!p(this,zS)){E(this,zS,!0);for(const{contentElement:o,data:{id:a}}of p(this,qn)){const l=o.id=`${Sd}${a}`;e.push((n=p(this,BS))==null?void 0:n.getAriaAttributes(l).then(u=>{if(u)for(const[h,m]of u)o.setAttribute(h,m)}))}}p(this,qn).sort(({data:{rect:[o,a,l,u]}},{data:{rect:[h,m,g,v]}})=>{if(o===l&&a===u)return 1;if(h===g&&m===v)return-1;const y=u,A=a,x=(a+u)/2,b=v,w=m,T=(m+v)/2;if(x>=b&&T<=A)return-1;if(T>=y&&x<=w)return 1;const k=(o+l)/2,I=(h+g)/2;return k-I});const t=document.createDocumentFragment();for(const o of p(this,qn))t.append(o.container),this._commentManager?(s=((i=o.extraPopupElement)==null?void 0:i.popup)||o.popup)==null||s.renderCommentButton():o.extraPopupElement&&t.append(o.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),p(this,au))for(const o of p(this,qn))p(this,au).addPointerInTextLayer(o.contentElement,!1)},qw=function(){var t;if(!p(this,lu))return;const e=this.div;for(const[n,i]of p(this,lu)){const s=e.querySelector(`[data-annotation-id="${n}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:o}=s;o?o.nodeName==="CANVAS"?o.replaceWith(i):o.classList.contains("annotationContent")?o.after(i):o.before(i):s.append(i);const a=p(this,cl).get(n);a&&(a._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(n,s.id,i),a._hasNoCanvas=!1):a.canvas=i)}p(this,lu).clear()};let Vw=QP;const F0=/\r\n?|\n/g;var Gn,FS,uu,Kn,hr,YD,XD,JD,dC,Ko,hC,pC,QD,Kw,ej;const Bt=class Bt extends Ot{constructor(t){super({...t,name:"freeTextEditor"});N(this,hr);N(this,Gn,"");N(this,FS,`${this.id}-editor`);N(this,uu,null);N(this,Kn);q(this,"_colorPicker",null);this.color=t.color||Bt._defaultColor||Ot._defaultLineColor,E(this,Kn,t.fontSize||Bt._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=Bt.prototype,n=o=>o.isEmpty(),i=ku.TRANSLATE_SMALL,s=ku.TRANSLATE_BIG;return $e(this,"_keyboardManager",new dy([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:n}]]))}static initialize(t,n){Ot.initialize(t,n);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case st.FREETEXT_SIZE:Bt._defaultFontSize=n;break;case st.FREETEXT_COLOR:Bt._defaultColor=n;break}}updateParams(t,n){switch(t){case st.FREETEXT_SIZE:_(this,hr,YD).call(this,n);break;case st.FREETEXT_COLOR:_(this,hr,XD).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[st.FREETEXT_SIZE,Bt._defaultFontSize],[st.FREETEXT_COLOR,Bt._defaultColor||Ot._defaultLineColor]]}get propertiesToUpdate(){return[[st.FREETEXT_SIZE,p(this,Kn)],[st.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new _C(this)),[["colorPicker",this._colorPicker]]}get colorType(){return st.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-Bt._internalPadding*t,-(Bt._internalPadding+p(this,Kn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),E(this,uu,new AbortController);const t=this._uiManager.combinedSignal(p(this,uu));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",p(this,FS)),this._isDraggable=!0,(t=p(this,uu))==null||t.abort(),E(this,uu,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=p(this,Gn),n=E(this,Gn,_(this,hr,JD).call(this).trimEnd());if(t===n)return;const i=s=>{if(E(this,Gn,s),!s){this.remove();return}_(this,hr,pC).call(this),this._uiManager.rebuild(this),_(this,hr,dC).call(this)};this.addCommands({cmd:()=>{i(n)},undo:()=>{i(t)},mustExec:!1}),_(this,hr,dC).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Bt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,n;(this._isCopy||this.annotationElementId)&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",p(this,FS)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${p(this,Kn)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[h,m]=this.pageDimensions,[g,v]=this.pageTranslation;let y,A;switch(this.rotation){case 0:y=t+(a[0]-g)/h,A=n+this.height-(a[1]-v)/m;break;case 90:y=t+(a[0]-g)/h,A=n-(a[1]-v)/m,[l,u]=[u,-l];break;case 180:y=t-this.width+(a[0]-g)/h,A=n-(a[1]-v)/m,[l,u]=[-l,-u];break;case 270:y=t+(a[0]-g-this.height*m)/h,A=n+(a[1]-v-this.width*h)/m,[l,u]=[-u,l];break}this.setAt(y*s,A*o,l,u)}else this._moveAfterPaste(t,n);_(this,hr,pC).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var y,A,x;const n=t.clipboardData||window.clipboardData,{types:i}=n;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const s=_(y=Bt,Ko,Kw).call(y,n.getData("text")||"").replaceAll(F0,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!s.includes(`
`)){a.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:l,startOffset:u}=a,h=[],m=[];if(l.nodeType===Node.TEXT_NODE){const b=l.parentElement;if(m.push(l.nodeValue.slice(u).replaceAll(F0,"")),b!==this.editorDiv){let w=h;for(const T of this.editorDiv.childNodes){if(T===b){w=m;continue}w.push(_(A=Bt,Ko,hC).call(A,T))}}h.push(l.nodeValue.slice(0,u).replaceAll(F0,""))}else if(l===this.editorDiv){let b=h,w=0;for(const T of this.editorDiv.childNodes)w++===u&&(b=m),b.push(_(x=Bt,Ko,hC).call(x,T))}E(this,Gn,`${h.join(`
`)}${s}${m.join(`
`)}`),_(this,hr,pC).call(this);const g=new Range;let v=Math.sumPrecise(h.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const w=b.nodeValue.length;if(v<=w){g.setStart(b,v),g.setEnd(b,v);break}v-=w}o.removeAllRanges(),o.addRange(g)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Bt._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,n,i){var a;let s=null;if(t instanceof VD){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:h,rotation:m,id:g,popupRef:v,richText:y,contentsObj:A,creationDate:x,modificationDate:b},textContent:w,textPosition:T,parent:{page:{pageNumber:k}}}=t;if(!w||w.length===0)return null;s=t={annotationType:Ve.FREETEXT,color:Array.from(u),fontSize:l,value:w.join(`
`),position:T,pageIndex:k-1,rect:h.slice(0),rotation:m,annotationElementId:g,id:g,deleted:!1,popupRef:v,comment:(A==null?void 0:A.str)||null,richText:y,creationDate:x,modificationDate:b}}const o=await super.deserialize(t,n,i);return E(o,Kn,t.fontSize),o.color=we.makeHexColor(...t.color),E(o,Gn,_(a=Bt,Ko,Kw).call(a,t.value)),o._initialData=s,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Ot._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:n,fontSize:p(this,Kn),value:_(this,hr,QD).call(this)});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!_(this,hr,ej).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(!n)return null;const{style:i}=n;i.fontSize=`calc(${p(this,Kn)}px * var(--total-scale-factor))`,i.color=this.color,n.replaceChildren();for(const s of p(this,Gn).split(`
`)){const o=document.createElement("div");o.append(s?document.createTextNode(s):document.createElement("br")),n.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:p(this,Gn)}}),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Gn=new WeakMap,FS=new WeakMap,uu=new WeakMap,Kn=new WeakMap,hr=new WeakSet,YD=function(t){const n=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-p(this,Kn))*this.parentScale),E(this,Kn,s),_(this,hr,dC).call(this)},i=p(this,Kn);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},XD=function(t){const n=s=>{this.color=s,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},JD=function(){var i;const t=[];this.editorDiv.normalize();let n=null;for(const s of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(_(i=Bt,Ko,hC).call(i,s)),n=s);return t.join(`
`)},dC=function(){const[t,n]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,a=o.style.display,l=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/n):(this.width=i.height/t,this.height=i.width/n),this.fixAndSetPosition()},Ko=new WeakSet,hC=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(F0,"")},pC=function(){if(this.editorDiv.replaceChildren(),!!p(this,Gn))for(const t of p(this,Gn).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},QD=function(){return p(this,Gn).replaceAll(""," ")},Kw=function(t){return t.replaceAll(" ","")},ej=function(t){const{value:n,fontSize:i,color:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==n||t.fontSize!==i||t.color.some((a,l)=>a!==s[l])||t.pageIndex!==o},N(Bt,Ko),q(Bt,"_freeTextDefaultContent",""),q(Bt,"_internalPadding",0),q(Bt,"_defaultColor",null),q(Bt,"_defaultFontSize",10),q(Bt,"_type","freetext"),q(Bt,"_editorType",Ve.FREETEXT);let Gw=Bt;class Re{toSVGPath(){kt("Abstract method `toSVGPath` must be implemented.")}get box(){kt("Abstract getter `box` must be implemented.")}serialize(e,t){kt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,i,s,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a]*i,o[a+1]=n+e[a+1]*s;return o}static _rescaleAndSwap(e,t,n,i,s,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a+1]*i,o[a+1]=n+e[a]*s;return o}static _translate(e,t,n,i){i||(i=new Float32Array(e.length));for(let s=0,o=e.length;s<o;s+=2)i[s]=t+e[s],i[s+1]=n+e[s+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,i,s){switch(s){case 90:return[1-t/n,e/i];case 180:return[1-e/n,1-t/i];case 270:return[t/n,1-e/i];default:return[e/n,t/i]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,i,s,o){return[(e+5*n)/6,(t+5*i)/6,(5*n+s)/6,(5*i+o)/6,(n+s)/2,(i+o)/2]}}q(Re,"PRECISION",1e-4);var Yn,Xi,kh,Mh,_s,Je,du,hu,WS,US,Nh,Lh,ul,ZS,eA,tA,Cr,rv,tj,rj,nj,ij,sj,oj;const co=class co{constructor({x:e,y:t},n,i,s,o,a=0){N(this,Cr);N(this,Yn);N(this,Xi,[]);N(this,kh);N(this,Mh);N(this,_s,[]);N(this,Je,new Float32Array(18));N(this,du);N(this,hu);N(this,WS);N(this,US);N(this,Nh);N(this,Lh);N(this,ul,[]);E(this,Yn,n),E(this,Lh,s*i),E(this,Mh,o),p(this,Je).set([NaN,NaN,NaN,NaN,e,t],6),E(this,kh,a),E(this,US,p(co,ZS)*i),E(this,WS,p(co,tA)*i),E(this,Nh,i),p(this,ul).push(e,t)}isEmpty(){return isNaN(p(this,Je)[8])}add({x:e,y:t}){var B;E(this,du,e),E(this,hu,t);const[n,i,s,o]=p(this,Yn);let[a,l,u,h]=p(this,Je).subarray(8,12);const m=e-u,g=t-h,v=Math.hypot(m,g);if(v<p(this,WS))return!1;const y=v-p(this,US),A=y/v,x=A*m,b=A*g;let w=a,T=l;a=u,l=h,u+=x,h+=b,(B=p(this,ul))==null||B.push(e,t);const k=-b/y,I=x/y,M=k*p(this,Lh),L=I*p(this,Lh);return p(this,Je).set(p(this,Je).subarray(2,8),0),p(this,Je).set([u+M,h+L],4),p(this,Je).set(p(this,Je).subarray(14,18),12),p(this,Je).set([u-M,h-L],16),isNaN(p(this,Je)[6])?(p(this,_s).length===0&&(p(this,Je).set([a+M,l+L],2),p(this,_s).push(NaN,NaN,NaN,NaN,(a+M-n)/s,(l+L-i)/o),p(this,Je).set([a-M,l-L],14),p(this,Xi).push(NaN,NaN,NaN,NaN,(a-M-n)/s,(l-L-i)/o)),p(this,Je).set([w,T,a,l,u,h],6),!this.isEmpty()):(p(this,Je).set([w,T,a,l,u,h],6),Math.abs(Math.atan2(T-l,w-a)-Math.atan2(b,x))<Math.PI/2?([a,l,u,h]=p(this,Je).subarray(2,6),p(this,_s).push(NaN,NaN,NaN,NaN,((a+u)/2-n)/s,((l+h)/2-i)/o),[a,l,w,T]=p(this,Je).subarray(14,18),p(this,Xi).push(NaN,NaN,NaN,NaN,((w+a)/2-n)/s,((T+l)/2-i)/o),!0):([w,T,a,l,u,h]=p(this,Je).subarray(0,6),p(this,_s).push(((w+5*a)/6-n)/s,((T+5*l)/6-i)/o,((5*a+u)/6-n)/s,((5*l+h)/6-i)/o,((a+u)/2-n)/s,((l+h)/2-i)/o),[u,h,a,l,w,T]=p(this,Je).subarray(12,18),p(this,Xi).push(((w+5*a)/6-n)/s,((T+5*l)/6-i)/o,((5*a+u)/6-n)/s,((5*l+h)/6-i)/o,((a+u)/2-n)/s,((l+h)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=p(this,_s),t=p(this,Xi);if(isNaN(p(this,Je)[6])&&!this.isEmpty())return _(this,Cr,tj).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);_(this,Cr,nj).call(this,n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return _(this,Cr,rj).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,i,s,o){return new aj(e,t,n,i,s,o)}getOutlines(){var m;const e=p(this,_s),t=p(this,Xi),n=p(this,Je),[i,s,o,a]=p(this,Yn),l=new Float32Array((((m=p(this,ul))==null?void 0:m.length)??0)+2);for(let g=0,v=l.length-2;g<v;g+=2)l[g]=(p(this,ul)[g]-i)/o,l[g+1]=(p(this,ul)[g+1]-s)/a;if(l[l.length-2]=(p(this,du)-i)/o,l[l.length-1]=(p(this,hu)-s)/a,isNaN(n[6])&&!this.isEmpty())return _(this,Cr,ij).call(this,l);const u=new Float32Array(p(this,_s).length+24+p(this,Xi).length);let h=e.length;for(let g=0;g<h;g+=2){if(isNaN(e[g])){u[g]=u[g+1]=NaN;continue}u[g]=e[g],u[g+1]=e[g+1]}h=_(this,Cr,oj).call(this,u,h);for(let g=t.length-6;g>=6;g-=6)for(let v=0;v<6;v+=2){if(isNaN(t[g+v])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[g+v],u[h+1]=t[g+v+1],h+=2}return _(this,Cr,sj).call(this,u,h),this.newFreeDrawOutline(u,l,p(this,Yn),p(this,Nh),p(this,kh),p(this,Mh))}};Yn=new WeakMap,Xi=new WeakMap,kh=new WeakMap,Mh=new WeakMap,_s=new WeakMap,Je=new WeakMap,du=new WeakMap,hu=new WeakMap,WS=new WeakMap,US=new WeakMap,Nh=new WeakMap,Lh=new WeakMap,ul=new WeakMap,ZS=new WeakMap,eA=new WeakMap,tA=new WeakMap,Cr=new WeakSet,rv=function(){const e=p(this,Je).subarray(4,6),t=p(this,Je).subarray(16,18),[n,i,s,o]=p(this,Yn);return[(p(this,du)+(e[0]-t[0])/2-n)/s,(p(this,hu)+(e[1]-t[1])/2-i)/o,(p(this,du)+(t[0]-e[0])/2-n)/s,(p(this,hu)+(t[1]-e[1])/2-i)/o]},tj=function(){const[e,t,n,i]=p(this,Yn),[s,o,a,l]=_(this,Cr,rv).call(this);return`M${(p(this,Je)[2]-e)/n} ${(p(this,Je)[3]-t)/i} L${(p(this,Je)[4]-e)/n} ${(p(this,Je)[5]-t)/i} L${s} ${o} L${a} ${l} L${(p(this,Je)[16]-e)/n} ${(p(this,Je)[17]-t)/i} L${(p(this,Je)[14]-e)/n} ${(p(this,Je)[15]-t)/i} Z`},rj=function(e){const t=p(this,Xi);e.push(`L${t[4]} ${t[5]} Z`)},nj=function(e){const[t,n,i,s]=p(this,Yn),o=p(this,Je).subarray(4,6),a=p(this,Je).subarray(16,18),[l,u,h,m]=_(this,Cr,rv).call(this);e.push(`L${(o[0]-t)/i} ${(o[1]-n)/s} L${l} ${u} L${h} ${m} L${(a[0]-t)/i} ${(a[1]-n)/s}`)},ij=function(e){const t=p(this,Je),[n,i,s,o]=p(this,Yn),[a,l,u,h]=_(this,Cr,rv).call(this),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(t[2]-n)/s,(t[3]-i)/o,NaN,NaN,NaN,NaN,(t[4]-n)/s,(t[5]-i)/o,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-n)/s,(t[17]-i)/o,NaN,NaN,NaN,NaN,(t[14]-n)/s,(t[15]-i)/o],0),this.newFreeDrawOutline(m,e,p(this,Yn),p(this,Nh),p(this,kh),p(this,Mh))},sj=function(e,t){const n=p(this,Xi);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},oj=function(e,t){const n=p(this,Je).subarray(4,6),i=p(this,Je).subarray(16,18),[s,o,a,l]=p(this,Yn),[u,h,m,g]=_(this,Cr,rv).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-s)/a,(n[1]-o)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,m,g,NaN,NaN,NaN,NaN,(i[0]-s)/a,(i[1]-o)/l],t),t+=24},N(co,ZS,8),N(co,eA,2),N(co,tA,p(co,ZS)+p(co,eA));let DC=co;var _h,pu,zo,$S,Xn,HS,ar,rA,lj;class aj extends Re{constructor(t,n,i,s,o,a){super();N(this,rA);N(this,_h);N(this,pu,new Float32Array(4));N(this,zo);N(this,$S);N(this,Xn);N(this,HS);N(this,ar);E(this,ar,t),E(this,Xn,n),E(this,_h,i),E(this,HS,s),E(this,zo,o),E(this,$S,a),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],_(this,rA,lj).call(this,a);const[l,u,h,m]=p(this,pu);for(let g=0,v=t.length;g<v;g+=2)t[g]=(t[g]-l)/h,t[g+1]=(t[g+1]-u)/m;for(let g=0,v=n.length;g<v;g+=2)n[g]=(n[g]-l)/h,n[g+1]=(n[g+1]-u)/m}toSVGPath(){const t=[`M${p(this,ar)[4]} ${p(this,ar)[5]}`];for(let n=6,i=p(this,ar).length;n<i;n+=6){if(isNaN(p(this,ar)[n])){t.push(`L${p(this,ar)[n+4]} ${p(this,ar)[n+5]}`);continue}t.push(`C${p(this,ar)[n]} ${p(this,ar)[n+1]} ${p(this,ar)[n+2]} ${p(this,ar)[n+3]} ${p(this,ar)[n+4]} ${p(this,ar)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,i,s],o){const a=i-t,l=s-n;let u,h;switch(o){case 0:u=Re._rescale(p(this,ar),t,s,a,-l),h=Re._rescale(p(this,Xn),t,s,a,-l);break;case 90:u=Re._rescaleAndSwap(p(this,ar),t,n,a,l),h=Re._rescaleAndSwap(p(this,Xn),t,n,a,l);break;case 180:u=Re._rescale(p(this,ar),i,n,-a,l),h=Re._rescale(p(this,Xn),i,n,-a,l);break;case 270:u=Re._rescaleAndSwap(p(this,ar),i,s,-a,-l),h=Re._rescaleAndSwap(p(this,Xn),i,s,-a,-l);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return p(this,pu)}newOutliner(t,n,i,s,o,a=0){return new DC(t,n,i,s,o,a)}getNewOutline(t,n){const[i,s,o,a]=p(this,pu),[l,u,h,m]=p(this,_h),g=o*h,v=a*m,y=i*h+l,A=s*m+u,x=this.newOutliner({x:p(this,Xn)[0]*g+y,y:p(this,Xn)[1]*v+A},p(this,_h),p(this,HS),t,p(this,$S),n??p(this,zo));for(let b=2;b<p(this,Xn).length;b+=2)x.add({x:p(this,Xn)[b]*g+y,y:p(this,Xn)[b+1]*v+A});return x.getOutlines()}}_h=new WeakMap,pu=new WeakMap,zo=new WeakMap,$S=new WeakMap,Xn=new WeakMap,HS=new WeakMap,ar=new WeakMap,rA=new WeakSet,lj=function(t){const n=p(this,ar);let i=n[4],s=n[5];const o=[i,s,i,s];let a=i,l=s,u=i,h=s;const m=t?Math.max:Math.min,g=new Float32Array(4);for(let y=6,A=n.length;y<A;y+=6){const x=n[y+4],b=n[y+5];isNaN(n[y])?(we.pointBoundingBox(x,b,o),l>b?(a=x,l=b):l===b&&(a=m(a,x)),h<b?(u=x,h=b):h===b&&(u=m(u,x))):(g[0]=g[1]=1/0,g[2]=g[3]=-1/0,we.bezierBoundingBox(i,s,...n.slice(y,y+6),g),we.rectBoundingBox(g[0],g[1],g[2],g[3],o),l>g[1]?(a=g[0],l=g[1]):l===g[1]&&(a=m(a,g[0])),h<g[3]?(u=g[2],h=g[3]):h===g[3]&&(u=m(u,g[2]))),i=x,s=b}const v=p(this,pu);v[0]=o[0]-p(this,zo),v[1]=o[1]-p(this,zo),v[2]=o[2]-o[0]+2*p(this,zo),v[3]=o[3]-o[1]+2*p(this,zo),this.firstPoint=[a,l],this.lastPoint=[u,h]};var VS,qS,GS,dl,Ji,pn,cj,fC,uj,dj,Xw;class Yw{constructor(e,t=0,n=0,i=!0){N(this,pn);N(this,VS);N(this,qS);N(this,GS);N(this,dl,[]);N(this,Ji,[]);const s=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:A,y:x,width:b,height:w}of e){const T=Math.floor((A-t)/o)*o,k=Math.ceil((A+b+t)/o)*o,I=Math.floor((x-t)/o)*o,M=Math.ceil((x+w+t)/o)*o,L=[T,I,M,!0],j=[k,I,M,!1];p(this,dl).push(L,j),we.rectBoundingBox(T,I,k,M,s)}const a=s[2]-s[0]+2*n,l=s[3]-s[1]+2*n,u=s[0]-n,h=s[1]-n;let m=i?-1/0:1/0,g=1/0;const v=p(this,dl).at(i?-1:-2),y=[v[0],v[2]];for(const A of p(this,dl)){const[x,b,w,T]=A;!T&&i?b<g?(g=b,m=x):b===g&&(m=Math.max(m,x)):T&&!i&&(b<g?(g=b,m=x):b===g&&(m=Math.min(m,x))),A[0]=(x-u)/a,A[1]=(b-h)/l,A[2]=(w-h)/l}E(this,VS,new Float32Array([u,h,a,l])),E(this,qS,[m,g]),E(this,GS,y)}getOutlines(){p(this,dl).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of p(this,dl))t[3]?(e.push(..._(this,pn,Xw).call(this,t)),_(this,pn,uj).call(this,t)):(_(this,pn,dj).call(this,t),e.push(..._(this,pn,Xw).call(this,t)));return _(this,pn,cj).call(this,e)}}VS=new WeakMap,qS=new WeakMap,GS=new WeakMap,dl=new WeakMap,Ji=new WeakMap,pn=new WeakSet,cj=function(e){const t=[],n=new Set;for(const o of e){const[a,l,u]=o;t.push([a,l,o],[a,u,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const l=t[o][2],u=t[o+1][2];l.push(u),u.push(l),n.add(l),n.add(u)}const i=[];let s;for(;n.size>0;){const o=n.values().next().value;let[a,l,u,h,m]=o;n.delete(o);let g=a,v=l;for(s=[a,u],i.push(s);;){let y;if(n.has(h))y=h;else if(n.has(m))y=m;else break;n.delete(y),[a,l,u,h,m]=y,g!==a&&(s.push(g,v,a,v===l?l:u),g=a),v=v===l?u:l}s.push(g,v)}return new vU(i,p(this,VS),p(this,qS),p(this,GS))},fC=function(e){const t=p(this,Ji);let n=0,i=t.length-1;for(;n<=i;){const s=n+i>>1,o=t[s][0];if(o===e)return s;o<e?n=s+1:i=s-1}return i+1},uj=function([,e,t]){const n=_(this,pn,fC).call(this,e);p(this,Ji).splice(n,0,[e,t])},dj=function([,e,t]){const n=_(this,pn,fC).call(this,e);for(let i=n;i<p(this,Ji).length;i++){const[s,o]=p(this,Ji)[i];if(s!==e)break;if(s===e&&o===t){p(this,Ji).splice(i,1);return}}for(let i=n-1;i>=0;i--){const[s,o]=p(this,Ji)[i];if(s!==e)break;if(s===e&&o===t){p(this,Ji).splice(i,1);return}}},Xw=function(e){const[t,n,i]=e,s=[[t,n,i]],o=_(this,pn,fC).call(this,i);for(let a=0;a<o;a++){const[l,u]=p(this,Ji)[a];for(let h=0,m=s.length;h<m;h++){const[,g,v]=s[h];if(!(u<=g||v<=l)){if(g>=l){if(v>u)s[h][1]=u;else{if(m===1)return[];s.splice(h,1),h--,m--}continue}s[h][2]=l,v>u&&s.push([t,u,v])}}}return s};var KS,Oh;class vU extends Re{constructor(t,n,i,s){super();N(this,KS);N(this,Oh);E(this,Oh,t),E(this,KS,n),this.firstPoint=i,this.lastPoint=s}toSVGPath(){const t=[];for(const n of p(this,Oh)){let[i,s]=n;t.push(`M${i} ${s}`);for(let o=2;o<n.length;o+=2){const a=n[o],l=n[o+1];a===i?(t.push(`V${l}`),s=l):l===s&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,n,i,s],o){const a=[],l=i-t,u=s-n;for(const h of p(this,Oh)){const m=new Array(h.length);for(let g=0;g<h.length;g+=2)m[g]=t+h[g]*l,m[g+1]=s-h[g+1]*u;a.push(m)}return a}get box(){return p(this,KS)}get classNamesForOutlining(){return["highlightOutline"]}}KS=new WeakMap,Oh=new WeakMap;class Jw extends DC{newFreeDrawOutline(e,t,n,i,s,o){return new SU(e,t,n,i,s,o)}}class SU extends aj{newOutliner(e,t,n,i,s,o=0){return new Jw(e,t,n,i,s,o)}}var Dh,YS,Fo,fu,XS,Pn,JS,QS,mu,Jn,Qn,Br,jh,Bh,Qr,zh,Ei,ey,Ke,Qw,mC,hj,pj,fj,eP,cc,Ii,md,mj,gC,vC,gj,vj,Sj,yj,Cj;const pt=class pt extends Ot{constructor(t){super({...t,name:"highlightEditor"});N(this,Ke);N(this,Dh,null);N(this,YS,0);N(this,Fo);N(this,fu,null);N(this,XS,null);N(this,Pn,null);N(this,JS,null);N(this,QS,0);N(this,mu,null);N(this,Jn,null);N(this,Qn,null);N(this,Br,!1);N(this,jh,null);N(this,Bh,null);N(this,Qr,null);N(this,zh,"");N(this,Ei);N(this,ey,"");this.color=t.color||pt._defaultColor,E(this,Ei,t.thickness||pt._defaultThickness),this.opacity=t.opacity||pt._defaultOpacity,E(this,Fo,t.boxes||null),E(this,ey,t.methodOfCreation||""),E(this,zh,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(E(this,Br,!0),_(this,Ke,mC).call(this,t),_(this,Ke,cc).call(this)):p(this,Fo)&&(E(this,Dh,t.anchorNode),E(this,YS,t.anchorOffset),E(this,JS,t.focusNode),E(this,QS,t.focusOffset),_(this,Ke,Qw).call(this),_(this,Ke,cc).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=pt.prototype;return $e(this,"_keyboardManager",new dy([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:p(this,Br)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:p(this,Ei),methodOfCreation:p(this,ey)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var i;Ot.initialize(t,n),pt._defaultColor||(pt._defaultColor=((i=n.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case st.HIGHLIGHT_COLOR:pt._defaultColor=n;break;case st.HIGHLIGHT_THICKNESS:pt._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return p(this,Bh)}get commentButtonPosition(){return p(this,jh)}updateParams(t,n){switch(t){case st.HIGHLIGHT_COLOR:_(this,Ke,hj).call(this,n);break;case st.HIGHLIGHT_THICKNESS:_(this,Ke,pj).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[st.HIGHLIGHT_COLOR,pt._defaultColor],[st.HIGHLIGHT_THICKNESS,pt._defaultThickness]]}get propertiesToUpdate(){return[[st.HIGHLIGHT_COLOR,this.color||pt._defaultColor],[st.HIGHLIGHT_THICKNESS,p(this,Ei)||pt._defaultThickness],[st.HIGHLIGHT_FREE,p(this,Br)]]}onUpdatedColor(){var t,n;(t=this.parent)==null||t.drawLayer.updateProperties(p(this,Qn),{root:{fill:this.color,"fill-opacity":this.opacity}}),(n=p(this,XS))==null||n.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",E(this,XS,new LC({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(_(this,Ke,vC).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,_(this,Ke,vC).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){_(this,Ke,eP).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(_(this,Ke,cc).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let n=!1;this.parent&&!t?_(this,Ke,eP).call(this):t&&(_(this,Ke,cc).call(this,t),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var s,o,a;const{drawLayer:n}=this.parent;let i;p(this,Br)?(t=(t-this.rotation+360)%360,i=_(s=pt,Ii,md).call(s,p(this,Jn).box,t)):i=_(o=pt,Ii,md).call(o,[this.x,this.y,this.width,this.height],t),n.updateProperties(p(this,Qn),{bbox:i,root:{"data-main-rotation":t}}),n.updateProperties(p(this,Qr),{bbox:_(a=pt,Ii,md).call(a,p(this,Pn).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();p(this,zh)&&(t.setAttribute("aria-label",p(this,zh)),t.setAttribute("role","mark")),p(this,Br)?t.classList.add("free"):this.div.addEventListener("keydown",_(this,Ke,mj).bind(this),{signal:this._uiManager._signal});const n=E(this,mu,document.createElement("div"));return t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=p(this,fu),this.setDims(),zO(this,p(this,mu),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(p(this,Qr),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(p(this,Qr),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:_(this,Ke,gC).call(this,!0);break;case 1:case 3:_(this,Ke,gC).call(this,!1);break}}select(){var t;super.select(),p(this,Qr)&&((t=this.parent)==null||t.drawLayer.updateProperties(p(this,Qr),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),p(this,Qr)&&((t=this.parent)==null||t.drawLayer.updateProperties(p(this,Qr),{rootClass:{selected:!1}}),p(this,Br)||_(this,Ke,gC).call(this,!1))}get _mustFixPosition(){return!p(this,Br)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(p(this,Qn),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(p(this,Qr),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:i,x:s,y:o}){const{x:a,y:l,width:u,height:h}=i.getBoundingClientRect(),m=new AbortController,g=t.combinedSignal(m),v=y=>{m.abort(),_(this,Ii,yj).call(this,t,y)};window.addEventListener("blur",v,{signal:g}),window.addEventListener("pointerup",v,{signal:g}),window.addEventListener("pointerdown",nr,{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",Mi,{signal:g}),i.addEventListener("pointermove",_(this,Ii,Sj).bind(this,t),{signal:g}),this._freeHighlight=new Jw({x:s,y:o},[a,l,u,h],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,i){var A,x,b,w;let s=null;if(t instanceof GD){const{data:{quadPoints:T,rect:k,rotation:I,id:M,color:L,opacity:j,popupRef:B,richText:z,contentsObj:Z,creationDate:$,modificationDate:U},parent:{page:{pageNumber:Y}}}=t;s=t={annotationType:Ve.HIGHLIGHT,color:Array.from(L),opacity:j,quadPoints:T,boxes:null,pageIndex:Y-1,rect:k.slice(0),rotation:I,annotationElementId:M,id:M,deleted:!1,popupRef:B,richText:z,comment:(Z==null?void 0:Z.str)||null,creationDate:$,modificationDate:U}}else if(t instanceof UP){const{data:{inkLists:T,rect:k,rotation:I,id:M,color:L,borderStyle:{rawWidth:j},popupRef:B,richText:z,contentsObj:Z,creationDate:$,modificationDate:U},parent:{page:{pageNumber:Y}}}=t;s=t={annotationType:Ve.HIGHLIGHT,color:Array.from(L),thickness:j,inkLists:T,boxes:null,pageIndex:Y-1,rect:k.slice(0),rotation:I,annotationElementId:M,id:M,deleted:!1,popupRef:B,richText:z,comment:(Z==null?void 0:Z.str)||null,creationDate:$,modificationDate:U}}const{color:o,quadPoints:a,inkLists:l,opacity:u}=t,h=await super.deserialize(t,n,i);h.color=we.makeHexColor(...o),h.opacity=u||1,l&&E(h,Ei,t.thickness),h._initialData=s,t.comment&&h.setCommentData(t);const[m,g]=h.pageDimensions,[v,y]=h.pageTranslation;if(a){const T=E(h,Fo,[]);for(let k=0;k<a.length;k+=8)T.push({x:(a[k]-v)/m,y:1-(a[k+1]-y)/g,width:(a[k+2]-a[k])/m,height:(a[k+1]-a[k+5])/g});_(A=h,Ke,Qw).call(A),_(x=h,Ke,cc).call(x),h.rotate(h.rotation)}else if(l){E(h,Br,!0);const T=l[0],k={x:T[0]-v,y:g-(T[1]-y)},I=new Jw(k,[0,0,m,g],1,p(h,Ei)/2,!0,.001);for(let j=0,B=T.length;j<B;j+=2)k.x=T[j]-v,k.y=g-(T[j+1]-y),I.add(k);const{id:M,clipPathId:L}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:I.toSVGPath()}},!0,!0);_(b=h,Ke,mC).call(b,{highlightOutlines:I.getOutlines(),highlightId:M,clipPathId:L}),_(w=h,Ke,cc).call(w),h.rotate(h.parentRotation)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=Ot._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:n,opacity:this.opacity,thickness:p(this,Ei),quadPoints:_(this,Ke,gj).call(this),outlines:_(this,Ke,vj).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!_(this,Ke,Cj).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Dh=new WeakMap,YS=new WeakMap,Fo=new WeakMap,fu=new WeakMap,XS=new WeakMap,Pn=new WeakMap,JS=new WeakMap,QS=new WeakMap,mu=new WeakMap,Jn=new WeakMap,Qn=new WeakMap,Br=new WeakMap,jh=new WeakMap,Bh=new WeakMap,Qr=new WeakMap,zh=new WeakMap,Ei=new WeakMap,ey=new WeakMap,Ke=new WeakSet,Qw=function(){const t=new Yw(p(this,Fo),.001);E(this,Jn,t.getOutlines()),[this.x,this.y,this.width,this.height]=p(this,Jn).box;const n=new Yw(p(this,Fo),.0025,.001,this._uiManager.direction==="ltr");E(this,Pn,n.getOutlines());const{firstPoint:i}=p(this,Jn);E(this,jh,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:s}=p(this,Pn);E(this,Bh,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},mC=function({highlightOutlines:t,highlightId:n,clipPathId:i}){var g,v;if(E(this,Jn,t),E(this,Pn,t.getNewOutline(p(this,Ei)/2+1.5,.0025)),n>=0)E(this,Qn,n),E(this,fu,i),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),E(this,Qr,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:p(this,Pn).box,path:{d:p(this,Pn).toSVGPath()}},!0));else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(p(this,Qn),{bbox:_(g=pt,Ii,md).call(g,p(this,Jn).box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(p(this,Qr),{bbox:_(v=pt,Ii,md).call(v,p(this,Pn).box,y),path:{d:p(this,Pn).toSVGPath()}})}const[o,a,l,u]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=l,this.height=u;break;case 90:{const[y,A]=this.parentDimensions;this.x=a,this.y=1-o,this.width=l*A/y,this.height=u*y/A;break}case 180:this.x=1-o,this.y=1-a,this.width=l,this.height=u;break;case 270:{const[y,A]=this.parentDimensions;this.x=1-a,this.y=o,this.width=l*A/y,this.height=u*y/A;break}}const{firstPoint:h}=t;E(this,jh,[(h[0]-o)/l,(h[1]-a)/u]);const{lastPoint:m}=p(this,Pn);E(this,Bh,[(m[0]-o)/l,(m[1]-a)/u])},hj=function(t){const n=(o,a)=>{this.color=o,this.opacity=a,this.onUpdatedColor()},i=this.color,s=this.opacity;this.addCommands({cmd:n.bind(this,t,pt._defaultOpacity),undo:n.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},pj=function(t){const n=p(this,Ei),i=s=>{E(this,Ei,s),_(this,Ke,fj).call(this,s)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},fj=function(t){p(this,Br)&&(_(this,Ke,mC).call(this,{highlightOutlines:p(this,Jn).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},eP=function(){p(this,Qn)===null||!this.parent||(this.parent.drawLayer.remove(p(this,Qn)),E(this,Qn,null),this.parent.drawLayer.remove(p(this,Qr)),E(this,Qr,null))},cc=function(t=this.parent){p(this,Qn)===null&&({id:mr(this,Qn)._,clipPathId:mr(this,fu)._}=t.drawLayer.draw({bbox:p(this,Jn).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:p(this,Br)},path:{d:p(this,Jn).toSVGPath()}},!1,!0),E(this,Qr,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:p(this,Br)},bbox:p(this,Pn).box,path:{d:p(this,Pn).toSVGPath()}},p(this,Br))),p(this,mu)&&(p(this,mu).style.clipPath=p(this,fu)))},Ii=new WeakSet,md=function([t,n,i,s],o){switch(o){case 90:return[1-n-s,t,s,i];case 180:return[1-t-i,1-n-s,i,s];case 270:return[n,1-t-i,s,i]}return[t,n,i,s]},mj=function(t){pt._keyboardManager.exec(this,t)},gC=function(t){if(!p(this,Dh))return;const n=window.getSelection();t?n.setPosition(p(this,Dh),p(this,YS)):n.setPosition(p(this,JS),p(this,QS))},vC=function(){return p(this,Br)?this.rotation:0},gj=function(){if(p(this,Br))return null;const[t,n]=this.pageDimensions,[i,s]=this.pageTranslation,o=p(this,Fo),a=new Float32Array(o.length*8);let l=0;for(const{x:u,y:h,width:m,height:g}of o){const v=u*t+i,y=(1-h)*n+s;a[l]=a[l+4]=v,a[l+1]=a[l+3]=y,a[l+2]=a[l+6]=v+m*t,a[l+5]=a[l+7]=y-g*n,l+=8}return a},vj=function(t){return p(this,Jn).serialize(t,_(this,Ke,vC).call(this))},Sj=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},yj=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Cj=function(t){const{color:n}=this._initialData;return this.hasEditedComment||t.color.some((i,s)=>i!==n[s])},N(pt,Ii),q(pt,"_defaultColor",null),q(pt,"_defaultOpacity",1),q(pt,"_defaultThickness",12),q(pt,"_type","highlight"),q(pt,"_editorType",Ve.HIGHLIGHT),q(pt,"_freeHighlightId",-1),q(pt,"_freeHighlight",null),q(pt,"_freeHighlightClipId","");let jC=pt;var gu;class Aj{constructor(){N(this,gu,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){p(this,gu)[e]=t}toSVGProperties(){const e=p(this,gu);return E(this,gu,Object.create(null)),{root:e}}reset(){E(this,gu,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){kt("Not implemented")}}gu=new WeakMap;var ei,Fh,Er,vu,Su,ut,tP,rP,nP,nv,bj,SC,iv,gd;const it=class it extends Ot{constructor(t){super(t);N(this,ut);N(this,ei,null);N(this,Fh);q(this,"_colorPicker",null);q(this,"_drawId",null);E(this,Fh,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(_(this,ut,tP).call(this,t),_(this,ut,nv).call(this))}static _mergeSVGProperties(t,n){const i=new Set(Object.keys(t));for(const[s,o]of Object.entries(n))i.has(s)?Object.assign(t[s],o):t[s]=o;return t}static getDefaultDrawingOptions(t){kt("Not implemented")}static get typesMap(){kt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,n),this._currentParent&&(p(it,Er).updateProperty(i,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)t.push([i,n[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[i,s]of this.constructor.typesMap)t.push([i,n[s]]);return t}_updateProperty(t,n,i){const s=this._drawingOptions,o=s[n],a=l=>{var h;s.updateProperty(n,l);const u=p(this,ei).updateProperty(n,l);u&&_(this,ut,iv).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,it._mergeSVGProperties(p(this,ei).getPathResizingSVGProperties(_(this,ut,SC).call(this)),{bbox:_(this,ut,gd).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,it._mergeSVGProperties(p(this,ei).getPathResizedSVGProperties(_(this,ut,SC).call(this)),{bbox:_(this,ut,gd).call(this)}))}_onTranslating(t,n){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:_(this,ut,gd).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,it._mergeSVGProperties(p(this,ei).getPathTranslatedSVGProperties(_(this,ut,SC).call(this),this.parentDimensions),{bbox:_(this,ut,gd).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,p(this,Fh)&&(E(this,Fh,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){_(this,ut,nP).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(_(this,ut,nv).call(this),_(this,ut,iv).call(this,p(this,ei).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),_(this,ut,nP).call(this)):t&&(this._uiManager.addShouldRescale(this),_(this,ut,nv).call(this,t),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,it._mergeSVGProperties({bbox:_(this,ut,gd).call(this)},p(this,ei).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&_(this,ut,iv).call(this,p(this,ei).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,n;this._isCopy&&(t=this.x,n=this.y);const i=super.render();i.classList.add("draw");const s=document.createElement("div");return i.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,n),i}static createDrawerInstance(t,n,i,s,o){kt("Not implemented")}static startDrawing(t,n,i,s){var x;const{target:o,offsetX:a,offsetY:l,pointerId:u,pointerType:h}=s;if(Gr.isInitializedAndDifferentPointerType(h))return;const{viewport:{rotation:m}}=t,{width:g,height:v}=o.getBoundingClientRect(),y=E(it,vu,new AbortController),A=t.combinedSignal(y);if(Gr.setPointer(h,u),window.addEventListener("pointerup",b=>{Gr.isSamePointerIdOrRemove(b.pointerId)&&this._endDraw(b)},{signal:A}),window.addEventListener("pointercancel",b=>{Gr.isSamePointerIdOrRemove(b.pointerId)&&this._currentParent.endDrawingSession()},{signal:A}),window.addEventListener("pointerdown",b=>{Gr.isSamePointerType(b.pointerType)&&(Gr.initializeAndAddPointerId(b.pointerId),p(it,Er).isCancellable()&&(p(it,Er).removeLastElement(),p(it,Er).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",Mi,{signal:A}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),o.addEventListener("touchmove",b=>{Gr.isSameTimeStamp(b.timeStamp)&&nr(b)},{signal:A}),t.toggleDrawing(),(x=n._editorUndoBar)==null||x.hide(),p(it,Er)){t.drawLayer.updateProperties(this._currentDrawId,p(it,Er).startNew(a,l,g,v,m));return}n.updateUIForDefaultProperties(this),E(it,Er,this.createDrawerInstance(a,l,g,v,m)),E(it,Su,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(p(it,Su).toSVGProperties(),p(it,Er).defaultSVGProperties),!0,!1)}static _drawMove(t){if(Gr.isSameTimeStamp(t.timeStamp),!p(it,Er))return;const{offsetX:n,offsetY:i,pointerId:s}=t;if(Gr.isSamePointerId(s)){if(Gr.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,p(it,Er).add(n,i)),Gr.setTimeStamp(t.timeStamp),nr(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,E(it,Er,null),E(it,Su,null),Gr.clearTimeStamp()),p(it,vu)&&(p(it,vu).abort(),E(it,vu,null),Gr.clearPointerIds())}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,p(it,Er).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=p(it,Er),s=this._currentDrawId,o=i.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(s,i.setLastElement(o))},undo:()=>{n.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:st.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(st.DRAW_STEP),!p(it,Er).isEmpty()){const{pageDimensions:[i,s],scale:o}=n,a=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:p(it,Er).getOutlines(i*o,s*o,o,this._INNER_MARGIN),drawingOptions:p(it,Su),mustBeCommitted:!t});return this._cleanup(!0),a}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,i,s,o,a){kt("Not implemented")}static async deserialize(t,n,i){var m,g;const{rawDims:{pageWidth:s,pageHeight:o,pageX:a,pageY:l}}=n.viewport,u=this.deserializeDraw(a,l,s,o,this._INNER_MARGIN,t),h=await super.deserialize(t,n,i);return h.createDrawingOptions(t),_(m=h,ut,tP).call(m,{drawOutlines:u}),_(g=h,ut,nv).call(g),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[n,i]=this.pageTranslation,[s,o]=this.pageDimensions;return p(this,ei).serialize([n,i,s,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};ei=new WeakMap,Fh=new WeakMap,Er=new WeakMap,vu=new WeakMap,Su=new WeakMap,ut=new WeakSet,tP=function({drawOutlines:t,drawId:n,drawingOptions:i}){E(this,ei,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=_(this,ut,rP).call(this,t,this.parent),_(this,ut,iv).call(this,t.box)},rP=function(t,n){const{id:i}=n.drawLayer.draw(it._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},nP=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},nv=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=_(this,ut,rP).call(this,p(this,ei),t)}},bj=function([t,n,i,s]){const{parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[n,1-t,i*(a/o),s*(o/a)];case 180:return[1-t,1-n,i,s];case 270:return[1-n,t,i*(a/o),s*(o/a)];default:return[t,n,i,s]}},SC=function(){const{x:t,y:n,width:i,height:s,parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[1-n,t,i*(o/a),s*(a/o)];case 180:return[1-t,1-n,i,s];case 270:return[n,1-t,i*(o/a),s*(a/o)];default:return[t,n,i,s]}},iv=function(t){[this.x,this.y,this.width,this.height]=_(this,ut,bj).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},gd=function(){const{x:t,y:n,width:i,height:s,rotation:o,parentRotation:a,parentDimensions:[l,u]}=this;switch((o*4+a)/90){case 1:return[1-n-s,t,s,i];case 2:return[1-t-i,1-n-s,i,s];case 3:return[n,1-t-i,s,i];case 4:return[t,n-i*(l/u),s*(u/l),i*(l/u)];case 5:return[1-n,t,i*(l/u),s*(u/l)];case 6:return[1-t-s*(u/l),1-n,s*(u/l),i*(l/u)];case 7:return[n-i*(l/u),1-t-s*(u/l),i*(l/u),s*(u/l)];case 8:return[t-i,n-s,i,s];case 9:return[1-n,t-i,s,i];case 10:return[1-t,1-n,i,s];case 11:return[n-s,1-t,s,i];case 12:return[t-s*(u/l),n,s*(u/l),i*(l/u)];case 13:return[1-n-i*(l/u),t-s*(u/l),i*(l/u),s*(u/l)];case 14:return[1-t,1-n-i*(l/u),s*(u/l),i*(l/u)];case 15:return[n,1-t,i*(l/u),s*(u/l)];default:return[t,n,i,s]}},q(it,"_currentDrawId",-1),q(it,"_currentParent",null),N(it,Er,null),N(it,vu,null),N(it,Su,null),q(it,"_INNER_MARGIN",3);let BC=it;var Os,Rr,Ir,yu,Wh,an,zr,Ri,Cu,Au,bu,Uh,yC;class yU{constructor(e,t,n,i,s,o){N(this,Uh);N(this,Os,new Float64Array(6));N(this,Rr);N(this,Ir);N(this,yu);N(this,Wh);N(this,an);N(this,zr,"");N(this,Ri,0);N(this,Cu,new py);N(this,Au);N(this,bu);E(this,Au,n),E(this,bu,i),E(this,yu,s),E(this,Wh,o),[e,t]=_(this,Uh,yC).call(this,e,t);const a=E(this,Rr,[NaN,NaN,NaN,NaN,e,t]);E(this,an,[e,t]),E(this,Ir,[{line:a,points:p(this,an)}]),p(this,Os).set(a,0)}updateProperty(e,t){e==="stroke-width"&&E(this,Wh,t)}isEmpty(){return!p(this,Ir)||p(this,Ir).length===0}isCancellable(){return p(this,an).length<=10}add(e,t){[e,t]=_(this,Uh,yC).call(this,e,t);const[n,i,s,o]=p(this,Os).subarray(2,6),a=e-s,l=t-o;return Math.hypot(p(this,Au)*a,p(this,bu)*l)<=2?null:(p(this,an).push(e,t),isNaN(n)?(p(this,Os).set([s,o,e,t],2),p(this,Rr).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(p(this,Os)[0])&&p(this,Rr).splice(6,6),p(this,Os).set([n,i,s,o,e,t],0),p(this,Rr).push(...Re.createBezierPoints(n,i,s,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(p(this,an).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,i,s){E(this,Au,n),E(this,bu,i),E(this,yu,s),[e,t]=_(this,Uh,yC).call(this,e,t);const o=E(this,Rr,[NaN,NaN,NaN,NaN,e,t]);E(this,an,[e,t]);const a=p(this,Ir).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),p(this,Ir).push({line:o,points:p(this,an)}),p(this,Os).set(o,0),E(this,Ri,0),this.toSVGPath(),null}getLastElement(){return p(this,Ir).at(-1)}setLastElement(e){return p(this,Ir)?(p(this,Ir).push(e),E(this,Rr,e.line),E(this,an,e.points),E(this,Ri,0),{path:{d:this.toSVGPath()}}):p(this,Cu).setLastElement(e)}removeLastElement(){if(!p(this,Ir))return p(this,Cu).removeLastElement();p(this,Ir).pop(),E(this,zr,"");for(let e=0,t=p(this,Ir).length;e<t;e++){const{line:n,points:i}=p(this,Ir)[e];E(this,Rr,n),E(this,an,i),E(this,Ri,0),this.toSVGPath()}return{path:{d:p(this,zr)}}}toSVGPath(){const e=Re.svgRound(p(this,Rr)[4]),t=Re.svgRound(p(this,Rr)[5]);if(p(this,an).length===2)return E(this,zr,`${p(this,zr)} M ${e} ${t} Z`),p(this,zr);if(p(this,an).length<=6){const i=p(this,zr).lastIndexOf("M");E(this,zr,`${p(this,zr).slice(0,i)} M ${e} ${t}`),E(this,Ri,6)}if(p(this,an).length===4){const i=Re.svgRound(p(this,Rr)[10]),s=Re.svgRound(p(this,Rr)[11]);return E(this,zr,`${p(this,zr)} L ${i} ${s}`),E(this,Ri,12),p(this,zr)}const n=[];p(this,Ri)===0&&(n.push(`M ${e} ${t}`),E(this,Ri,6));for(let i=p(this,Ri),s=p(this,Rr).length;i<s;i+=6){const[o,a,l,u,h,m]=p(this,Rr).slice(i,i+6).map(Re.svgRound);n.push(`C${o} ${a} ${l} ${u} ${h} ${m}`)}return E(this,zr,p(this,zr)+n.join(" ")),E(this,Ri,p(this,Rr).length),p(this,zr)}getOutlines(e,t,n,i){const s=p(this,Ir).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),p(this,Cu).build(p(this,Ir),e,t,n,p(this,yu),p(this,Wh),i),E(this,Os,null),E(this,Rr,null),E(this,Ir,null),E(this,zr,null),p(this,Cu)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Os=new WeakMap,Rr=new WeakMap,Ir=new WeakMap,yu=new WeakMap,Wh=new WeakMap,an=new WeakMap,zr=new WeakMap,Ri=new WeakMap,Cu=new WeakMap,Au=new WeakMap,bu=new WeakMap,Uh=new WeakSet,yC=function(e,t){return Re._normalizePoint(e,t,p(this,Au),p(this,bu),p(this,yu))};var ln,ty,ry,ti,Ds,js,Zh,$h,xu,Wr,ao,xj,Tj,wj;class py extends Re{constructor(){super(...arguments);N(this,Wr);N(this,ln);N(this,ty,0);N(this,ry);N(this,ti);N(this,Ds);N(this,js);N(this,Zh);N(this,$h);N(this,xu)}build(t,n,i,s,o,a,l){E(this,Ds,n),E(this,js,i),E(this,Zh,s),E(this,$h,o),E(this,xu,a),E(this,ry,l??0),E(this,ti,t),_(this,Wr,Tj).call(this)}get thickness(){return p(this,xu)}setLastElement(t){return p(this,ti).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return p(this,ti).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of p(this,ti)){if(t.push(`M${Re.svgRound(n[4])} ${Re.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12&&isNaN(n[6])){t.push(`L${Re.svgRound(n[10])} ${Re.svgRound(n[11])}`);continue}for(let i=6,s=n.length;i<s;i+=6){const[o,a,l,u,h,m]=n.subarray(i,i+6).map(Re.svgRound);t.push(`C${o} ${a} ${l} ${u} ${h} ${m}`)}}return t.join("")}serialize([t,n,i,s],o){const a=[],l=[],[u,h,m,g]=_(this,Wr,xj).call(this);let v,y,A,x,b,w,T,k,I;switch(p(this,$h)){case 0:I=Re._rescale,v=t,y=n+s,A=i,x=-s,b=t+u*i,w=n+(1-h-g)*s,T=t+(u+m)*i,k=n+(1-h)*s;break;case 90:I=Re._rescaleAndSwap,v=t,y=n,A=i,x=s,b=t+h*i,w=n+u*s,T=t+(h+g)*i,k=n+(u+m)*s;break;case 180:I=Re._rescale,v=t+i,y=n,A=-i,x=s,b=t+(1-u-m)*i,w=n+h*s,T=t+(1-u)*i,k=n+(h+g)*s;break;case 270:I=Re._rescaleAndSwap,v=t+i,y=n+s,A=-i,x=-s,b=t+(1-h-g)*i,w=n+(1-u-m)*s,T=t+(1-h)*i,k=n+(1-u)*s;break}for(const{line:M,points:L}of p(this,ti))a.push(I(M,v,y,A,x,o?new Array(M.length):null)),l.push(I(L,v,y,A,x,o?new Array(L.length):null));return{lines:a,points:l,rect:[b,w,T,k]}}static deserialize(t,n,i,s,o,{paths:{lines:a,points:l},rotation:u,thickness:h}){const m=[];let g,v,y,A,x;switch(u){case 0:x=Re._rescale,g=-t/i,v=n/s+1,y=1/i,A=-1/s;break;case 90:x=Re._rescaleAndSwap,g=-n/s,v=-t/i,y=1/s,A=1/i;break;case 180:x=Re._rescale,g=t/i+1,v=-n/s,y=-1/i,A=1/s;break;case 270:x=Re._rescaleAndSwap,g=n/s+1,v=t/i+1,y=-1/s,A=-1/i;break}if(!a){a=[];for(const w of l){const T=w.length;if(T===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(T===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const k=new Float32Array(3*(T-2));a.push(k);let[I,M,L,j]=w.subarray(0,4);k.set([NaN,NaN,NaN,NaN,I,M],0);for(let B=4;B<T;B+=2){const z=w[B],Z=w[B+1];k.set(Re.createBezierPoints(I,M,L,j,z,Z),(B-2)*3),[I,M,L,j]=[L,j,z,Z]}}}for(let w=0,T=a.length;w<T;w++)m.push({line:x(a[w].map(k=>k??NaN),g,v,y,A),points:x(l[w].map(k=>k??NaN),g,v,y,A)});const b=new this.prototype.constructor;return b.build(m,i,s,1,u,h,o),b}get box(){return p(this,ln)}updateProperty(t,n){return t==="stroke-width"?_(this,Wr,wj).call(this,n):null}updateParentDimensions([t,n],i){const[s,o]=_(this,Wr,ao).call(this);E(this,Ds,t),E(this,js,n),E(this,Zh,i);const[a,l]=_(this,Wr,ao).call(this),u=a-s,h=l-o,m=p(this,ln);return m[0]-=u,m[1]-=h,m[2]+=2*u,m[3]+=2*h,m}updateRotation(t){return E(this,ty,t),{path:{transform:this.rotationTransform}}}get viewBox(){return p(this,ln).map(Re.svgRound).join(" ")}get defaultProperties(){const[t,n]=p(this,ln);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Re.svgRound(t)} ${Re.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=p(this,ln);let i=0,s=0,o=0,a=0,l=0,u=0;switch(p(this,ty)){case 90:s=n/t,o=-t/n,l=t;break;case 180:i=-1,a=-1,l=t,u=n;break;case 270:s=-n/t,o=t/n,u=n;break;default:return""}return`matrix(${i} ${s} ${o} ${a} ${Re.svgRound(l)} ${Re.svgRound(u)})`}getPathResizingSVGProperties([t,n,i,s]){const[o,a]=_(this,Wr,ao).call(this),[l,u,h,m]=p(this,ln);if(Math.abs(h-o)<=Re.PRECISION||Math.abs(m-a)<=Re.PRECISION){const x=t+i/2-(l+h/2),b=n+s/2-(u+m/2);return{path:{"transform-origin":`${Re.svgRound(t)} ${Re.svgRound(n)}`,transform:`${this.rotationTransform} translate(${x} ${b})`}}}const g=(i-2*o)/(h-2*o),v=(s-2*a)/(m-2*a),y=h/i,A=m/s;return{path:{"transform-origin":`${Re.svgRound(l)} ${Re.svgRound(u)}`,transform:`${this.rotationTransform} scale(${y} ${A}) translate(${Re.svgRound(o)} ${Re.svgRound(a)}) scale(${g} ${v}) translate(${Re.svgRound(-o)} ${Re.svgRound(-a)})`}}}getPathResizedSVGProperties([t,n,i,s]){const[o,a]=_(this,Wr,ao).call(this),l=p(this,ln),[u,h,m,g]=l;if(l[0]=t,l[1]=n,l[2]=i,l[3]=s,Math.abs(m-o)<=Re.PRECISION||Math.abs(g-a)<=Re.PRECISION){const b=t+i/2-(u+m/2),w=n+s/2-(h+g/2);for(const{line:T,points:k}of p(this,ti))Re._translate(T,b,w,T),Re._translate(k,b,w,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Re.svgRound(t)} ${Re.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(i-2*o)/(m-2*o),y=(s-2*a)/(g-2*a),A=-v*(u+o)+t+o,x=-y*(h+a)+n+a;if(v!==1||y!==1||A!==0||x!==0)for(const{line:b,points:w}of p(this,ti))Re._rescale(b,A,x,v,y,b),Re._rescale(w,A,x,v,y,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Re.svgRound(t)} ${Re.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],i){const[s,o]=i,a=p(this,ln),l=t-a[0],u=n-a[1];if(p(this,Ds)===s&&p(this,js)===o)for(const{line:h,points:m}of p(this,ti))Re._translate(h,l,u,h),Re._translate(m,l,u,m);else{const h=p(this,Ds)/s,m=p(this,js)/o;E(this,Ds,s),E(this,js,o);for(const{line:g,points:v}of p(this,ti))Re._rescale(g,l,u,h,m,g),Re._rescale(v,l,u,h,m,v);a[2]*=h,a[3]*=m}return a[0]=t,a[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Re.svgRound(t)} ${Re.svgRound(n)}`}}}get defaultSVGProperties(){const t=p(this,ln);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Re.svgRound(t[0])} ${Re.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}ln=new WeakMap,ty=new WeakMap,ry=new WeakMap,ti=new WeakMap,Ds=new WeakMap,js=new WeakMap,Zh=new WeakMap,$h=new WeakMap,xu=new WeakMap,Wr=new WeakSet,ao=function(t=p(this,xu)){const n=p(this,ry)+t/2*p(this,Zh);return p(this,$h)%180===0?[n/p(this,Ds),n/p(this,js)]:[n/p(this,js),n/p(this,Ds)]},xj=function(){const[t,n,i,s]=p(this,ln),[o,a]=_(this,Wr,ao).call(this,0);return[t+o,n+a,i-2*o,s-2*a]},Tj=function(){const t=E(this,ln,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of p(this,ti)){if(s.length<=12){for(let l=4,u=s.length;l<u;l+=6)we.pointBoundingBox(s[l],s[l+1],t);continue}let o=s[4],a=s[5];for(let l=6,u=s.length;l<u;l+=6){const[h,m,g,v,y,A]=s.subarray(l,l+6);we.bezierBoundingBox(o,a,h,m,g,v,y,A,t),o=y,a=A}}const[n,i]=_(this,Wr,ao).call(this);t[0]=dn(t[0]-n,0,1),t[1]=dn(t[1]-i,0,1),t[2]=dn(t[2]+n,0,1),t[3]=dn(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},wj=function(t){const[n,i]=_(this,Wr,ao).call(this);E(this,xu,t);const[s,o]=_(this,Wr,ao).call(this),[a,l]=[s-n,o-i],u=p(this,ln);return u[0]-=a,u[1]-=l,u[2]+=2*a,u[3]+=2*l,u};class mA extends Aj{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Ot._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new mA(this._viewParameters);return e.updateAll(this),e}}var nA,Pj;const xd=class xd extends BC{constructor(t){super({...t,name:"inkEditor"});N(this,nA);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,n){Ot.initialize(t,n),this._defaultDrawingOptions=new mA(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return $e(this,"typesMap",new Map([[st.INK_THICKNESS,"stroke-width"],[st.INK_COLOR,"stroke"],[st.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,i,s,o){return new yU(t,n,i,s,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,i,s,o,a){return py.deserialize(t,n,i,s,o,a)}static async deserialize(t,n,i){let s=null;if(t instanceof UP){const{data:{inkLists:a,rect:l,rotation:u,id:h,color:m,opacity:g,borderStyle:{rawWidth:v},popupRef:y,richText:A,contentsObj:x,creationDate:b,modificationDate:w},parent:{page:{pageNumber:T}}}=t;s=t={annotationType:Ve.INK,color:Array.from(m),thickness:v,opacity:g,paths:{points:a},boxes:null,pageIndex:T-1,rect:l.slice(0),rotation:u,annotationElementId:h,id:h,deleted:!1,popupRef:y,richText:A,comment:(x==null?void 0:x.str)||null,creationDate:b,modificationDate:w}}const o=await super.deserialize(t,n,i);return o._initialData=s,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new _C(this)),[["colorPicker",this._colorPicker]]}get colorType(){return st.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:i}=this;n.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:i}){this._drawingOptions=xd.getDefaultDrawingOptions({stroke:we.makeHexColor(...t),"stroke-width":n,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":o,"stroke-width":a}}=this,l=Object.assign(super.serialize(t),{color:Ot._colorManager.convert(s),opacity:o,thickness:a,paths:{lines:n,points:i}});return this.addComment(l),t?(l.isCopy=!0,l):this.annotationElementId&&!_(this,nA,Pj).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:n,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:n,popup:this.comment}),null}};nA=new WeakSet,Pj=function(t){const{color:n,thickness:i,opacity:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((a,l)=>a!==n[l])||t.thickness!==i||t.opacity!==s||t.pageIndex!==o},q(xd,"_type","ink"),q(xd,"_editorType",Ve.INK),q(xd,"_defaultDrawingOptions",null);let iP=xd;class sP extends py{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const W0=8,Og=3;var Tu,ft,oP,Qi,Ej,Rj,aP,CC,Ij,kj,Mj,lP,cP,Nj;class Vo{static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:i},s,o,a,l){let u=new OffscreenCanvas(1,1),h=u.getContext("2d",{alpha:!1});const m=200,g=h.font=`${n} ${i} ${m}px ${t}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:y,actualBoundingBoxAscent:A,actualBoundingBoxDescent:x,fontBoundingBoxAscent:b,fontBoundingBoxDescent:w,width:T}=h.measureText(e),k=1.5,I=Math.ceil(Math.max(Math.abs(v)+Math.abs(y)||0,T)*k),M=Math.ceil(Math.max(Math.abs(A)+Math.abs(x)||m,Math.abs(b)+Math.abs(w)||m)*k);u=new OffscreenCanvas(I,M),h=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=g,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,I,M),h.fillStyle="black",h.fillText(e,I*(k-1)/2,M*(3-k)/2);const L=_(this,ft,lP).call(this,h.getImageData(0,0,I,M).data),j=_(this,ft,Mj).call(this,L),B=_(this,ft,cP).call(this,j),z=_(this,ft,aP).call(this,L,I,M,B);return this.processDrawnLines({lines:{curves:z,width:I,height:M},pageWidth:s,pageHeight:o,rotation:a,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,n,i,s){const[o,a,l]=_(this,ft,Nj).call(this,e),[u,h]=_(this,ft,kj).call(this,o,a,l,Math.hypot(a,l)*p(this,Tu).sigmaSFactor,p(this,Tu).sigmaR,p(this,Tu).kernelSize),m=_(this,ft,cP).call(this,h),g=_(this,ft,aP).call(this,u,a,l,m);return this.processDrawnLines({lines:{curves:g,width:a,height:l},pageWidth:t,pageHeight:n,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:s,mustSmooth:o,areContours:a}){i%180!==0&&([t,n]=[n,t]);const{curves:l,width:u,height:h}=e,m=e.thickness??0,g=[],v=Math.min(t/u,n/h),y=v/t,A=v/n,x=[];for(const{points:w}of l){const T=o?_(this,ft,Ij).call(this,w):w;if(!T)continue;x.push(T);const k=T.length,I=new Float32Array(k),M=new Float32Array(3*(k===2?2:k-2));if(g.push({line:M,points:I}),k===2){I[0]=T[0]*y,I[1]=T[1]*A,M.set([NaN,NaN,NaN,NaN,I[0],I[1]],0);continue}let[L,j,B,z]=T;L*=y,j*=A,B*=y,z*=A,I.set([L,j,B,z],0),M.set([NaN,NaN,NaN,NaN,L,j],0);for(let Z=4;Z<k;Z+=2){const $=I[Z]=T[Z]*y,U=I[Z+1]=T[Z+1]*A;M.set(Re.createBezierPoints(L,j,B,z,$,U),(Z-2)*3),[L,j,B,z]=[B,z,$,U]}}if(g.length===0)return null;const b=a?new sP:new py;return b.build(g,t,n,1,i,a?0:m,s),{outline:b,newCurves:x,areContours:a,thickness:m,width:u,height:h}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:i,height:s}){let o=1/0,a=-1/0,l=0;for(const T of e){l+=T.length;for(let k=2,I=T.length;k<I;k++){const M=T[k]-T[k-2];o=Math.min(o,M),a=Math.max(a,M)}}let u;o>=-128&&a<=127?u=Int8Array:o>=-32768&&a<=32767?u=Int16Array:u=Int32Array;const h=e.length,m=W0+Og*h,g=new Uint32Array(m);let v=0;g[v++]=m*Uint32Array.BYTES_PER_ELEMENT+(l-2*h)*u.BYTES_PER_ELEMENT,g[v++]=0,g[v++]=i,g[v++]=s,g[v++]=t?0:1,g[v++]=Math.max(0,Math.floor(n??0)),g[v++]=h,g[v++]=u.BYTES_PER_ELEMENT;for(const T of e)g[v++]=T.length-2,g[v++]=T[0],g[v++]=T[1];const y=new CompressionStream("deflate-raw"),A=y.writable.getWriter();await A.ready,A.write(g);const x=u.prototype.constructor;for(const T of e){const k=new x(T.length-2);for(let I=2,M=T.length;I<M;I++)k[I-2]=T[I]-T[I-2];A.write(k)}A.close();const b=await new Response(y.readable).arrayBuffer(),w=new Uint8Array(b);return kO(w)}static async decompressSignature(e){try{const t=_6(e),{readable:n,writable:i}=new DecompressionStream("deflate-raw"),s=i.getWriter();await s.ready,s.write(t).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let o=null,a=0;for await(const T of n)o||(o=new Uint8Array(new Uint32Array(T.buffer,0,4)[0])),o.set(T,a),a+=T.length;const l=new Uint32Array(o.buffer,0,o.length>>2),u=l[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const h=l[2],m=l[3],g=l[4]===0,v=l[5],y=l[6],A=l[7],x=[],b=(W0+Og*y)*Uint32Array.BYTES_PER_ELEMENT;let w;switch(A){case Int8Array.BYTES_PER_ELEMENT:w=new Int8Array(o.buffer,b);break;case Int16Array.BYTES_PER_ELEMENT:w=new Int16Array(o.buffer,b);break;case Int32Array.BYTES_PER_ELEMENT:w=new Int32Array(o.buffer,b);break}a=0;for(let T=0;T<y;T++){const k=l[Og*T+W0],I=new Float32Array(k+2);x.push(I);for(let M=0;M<Og-1;M++)I[M]=l[Og*T+W0+M+1];for(let M=0;M<k;M++)I[M+2]=I[M]+w[a++]}return{areContours:g,thickness:v,outlines:x,width:h,height:m}}catch(t){return Ue(`decompressSignature: ${t}`),null}}}Tu=new WeakMap,ft=new WeakSet,oP=function(e,t,n,i){return n-=e,i-=t,n===0?i>0?0:4:n===1?i+6:2-i},Qi=new WeakMap,Ej=function(e,t,n,i,s,o,a){const l=_(this,ft,oP).call(this,n,i,s,o);for(let u=0;u<8;u++){const h=(-u+l-a+16)%8,m=p(this,Qi)[2*h],g=p(this,Qi)[2*h+1];if(e[(n+m)*t+(i+g)]!==0)return h}return-1},Rj=function(e,t,n,i,s,o,a){const l=_(this,ft,oP).call(this,n,i,s,o);for(let u=0;u<8;u++){const h=(u+l+a+16)%8,m=p(this,Qi)[2*h],g=p(this,Qi)[2*h+1];if(e[(n+m)*t+(i+g)]!==0)return h}return-1},aP=function(e,t,n,i){const s=e.length,o=new Int32Array(s);for(let h=0;h<s;h++)o[h]=e[h]<=i?1:0;for(let h=1;h<n-1;h++)o[h*t]=o[h*t+t-1]=0;for(let h=0;h<t;h++)o[h]=o[t*n-1-h]=0;let a=1,l;const u=[];for(let h=1;h<n-1;h++){l=1;for(let m=1;m<t-1;m++){const g=h*t+m,v=o[g];if(v===0)continue;let y=h,A=m;if(v===1&&o[g-1]===0)a+=1,A-=1;else if(v>=1&&o[g+1]===0)a+=1,A+=1,v>1&&(l=v);else{v!==1&&(l=Math.abs(v));continue}const x=[m,h],b=A===m+1,w={isHole:b,points:x,id:a,parent:0};u.push(w);let T;for(const Z of u)if(Z.id===l){T=Z;break}T?T.isHole?w.parent=b?T.parent:l:w.parent=b?l:T.parent:w.parent=b?l:0;const k=_(this,ft,Ej).call(this,o,t,h,m,y,A,0);if(k===-1){o[g]=-a,o[g]!==1&&(l=Math.abs(o[g]));continue}let I=p(this,Qi)[2*k],M=p(this,Qi)[2*k+1];const L=h+I,j=m+M;y=L,A=j;let B=h,z=m;for(;;){const Z=_(this,ft,Rj).call(this,o,t,B,z,y,A,1);I=p(this,Qi)[2*Z],M=p(this,Qi)[2*Z+1];const $=B+I,U=z+M;x.push(U,$);const Y=B*t+z;if(o[Y+1]===0?o[Y]=-a:o[Y]===1&&(o[Y]=a),$===h&&U===m&&B===L&&z===j){o[g]!==1&&(l=Math.abs(o[g]));break}else y=B,A=z,B=$,z=U}}}return u},CC=function(e,t,n,i){if(n-t<=4){for(let L=t;L<n-2;L+=2)i.push(e[L],e[L+1]);return}const s=e[t],o=e[t+1],a=e[n-4]-s,l=e[n-3]-o,u=Math.hypot(a,l),h=a/u,m=l/u,g=h*o-m*s,v=l/a,y=1/u,A=Math.atan(v),x=Math.cos(A),b=Math.sin(A),w=y*(Math.abs(x)+Math.abs(b)),T=y*(1-w+w**2),k=Math.max(Math.atan(Math.abs(b+x)*T),Math.atan(Math.abs(b-x)*T));let I=0,M=t;for(let L=t+2;L<n-2;L+=2){const j=Math.abs(g-h*e[L+1]+m*e[L]);j>I&&(M=L,I=j)}I>(u*k)**2?(_(this,ft,CC).call(this,e,t,M+2,i),_(this,ft,CC).call(this,e,M,n,i)):i.push(s,o)},Ij=function(e){const t=[],n=e.length;return _(this,ft,CC).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t},kj=function(e,t,n,i,s,o){const a=new Float32Array(o**2),l=-2*i**2,u=o>>1;for(let A=0;A<o;A++){const x=(A-u)**2;for(let b=0;b<o;b++)a[A*o+b]=Math.exp((x+(b-u)**2)/l)}const h=new Float32Array(256),m=-2*s**2;for(let A=0;A<256;A++)h[A]=Math.exp(A**2/m);const g=e.length,v=new Uint8Array(g),y=new Uint32Array(256);for(let A=0;A<n;A++)for(let x=0;x<t;x++){const b=A*t+x,w=e[b];let T=0,k=0;for(let M=0;M<o;M++){const L=A+M-u;if(!(L<0||L>=n))for(let j=0;j<o;j++){const B=x+j-u;if(B<0||B>=t)continue;const z=e[L*t+B],Z=a[M*o+j]*h[Math.abs(z-w)];T+=z*Z,k+=Z}}const I=v[b]=Math.round(T/k);y[I]++}return[v,y]},Mj=function(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t},lP=function(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let i=-1/0,s=1/0;for(let a=0,l=n.length;a<l;a++){const u=n[a]=e[a<<2];i=Math.max(i,u),s=Math.min(s,u)}const o=255/(i-s);for(let a=0,l=n.length;a<l;a++)n[a]=(n[a]-s)*o;return n},cP=function(e){let t,n=-1/0,i=-1/0;const s=e.findIndex(l=>l!==0);let o=s,a=s;for(t=s;t<256;t++){const l=e[t];l>n&&(t-o>i&&(i=t-o,a=t-1),n=l,o=t)}for(t=a-1;t>=0&&!(e[t]>e[t+1]);t--);return t},Nj=function(e){const t=e,{width:n,height:i}=e,{maxDim:s}=p(this,Tu);let o=n,a=i;if(n>s||i>s){let g=n,v=i,y=Math.log2(Math.max(n,i)/s);const A=Math.floor(y);y=y===A?A-1:A;for(let b=0;b<y;b++){o=Math.ceil(g/2),a=Math.ceil(v/2);const w=new OffscreenCanvas(o,a);w.getContext("2d").drawImage(e,0,0,g,v,0,0,o,a),g=o,v=a,e!==t&&e.close(),e=w.transferToImageBitmap()}const x=Math.min(s/o,s/a);o=Math.round(o*x),a=Math.round(a*x)}const u=new OffscreenCanvas(o,a).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,o,a),u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,o,a);const h=u.getImageData(0,0,o,a).data;return[_(this,ft,lP).call(this,h),o,a]},N(Vo,ft),N(Vo,Tu,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),N(Vo,Qi,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class ZP extends Aj{constructor(){super(),super.updateProperties({fill:Ot._defaultLineColor,"stroke-width":0})}clone(){const e=new ZP;return e.updateAll(this),e}}class $P extends mA{constructor(e){super(e),super.updateProperties({stroke:Ot._defaultLineColor,"stroke-width":1})}clone(){const e=new $P(this._viewParameters);return e.updateAll(this),e}}var hl,Bs,pl,wu;const jn=class jn extends BC{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});N(this,hl,!1);N(this,Bs,null);N(this,pl,null);N(this,wu,null);this._willKeepAspectRatio=!0,E(this,pl,t.signatureData||null),E(this,Bs,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,n){Ot.initialize(t,n),this._defaultDrawingOptions=new ZP,this._defaultDrawnSignatureOptions=new $P(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return $e(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!p(this,Bs)}}static computeTelemetryFinalData(t){const n=t.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,n;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,n=this.y),super.render(),this._drawId===null)if(p(this,pl)){const{lines:s,mustSmooth:o,areContours:a,description:l,uuid:u,heightInPage:h}=p(this,pl),{rawDims:{pageWidth:m,pageHeight:g},rotation:v}=this.parent.viewport,y=Vo.processDrawnLines({lines:s,pageWidth:m,pageHeight:g,rotation:v,innerMargin:jn._INNER_MARGIN,mustSmooth:o,areContours:a});this.addSignature(y,h,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:p(this,Bs)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,n)),this.div}setUuid(t){E(this,wu,t),this.addEditToolbar()}getUuid(){return p(this,wu)}get description(){return p(this,Bs)}set description(t){E(this,Bs,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:n,thickness:i,width:s,height:o}=p(this,pl),a=Math.max(s,o),l=Vo.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:s,height:o},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,n,i,s){const{x:o,y:a}=this,{outline:l}=E(this,pl,t);E(this,hl,l instanceof sP),this.description=i;let u;p(this,hl)?u=jn.getDefaultDrawingOptions():(u=jn._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[,h]=this.pageDimensions;let m=n/h;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(),this.x=o,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:n,pageHeight:i},rotation:s}=this.parent.viewport;return Vo.process(t,n,i,s,jn._INNER_MARGIN)}getFromText(t,n){const{rawDims:{pageWidth:i,pageHeight:s},rotation:o}=this.parent.viewport;return Vo.extractContoursFromText(t,n,i,s,o,jn._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:n,pageHeight:i},rotation:s}=this.parent.viewport;return Vo.processDrawnLines({lines:t,pageWidth:n,pageHeight:i,rotation:s,innerMargin:jn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:n}){t?this._drawingOptions=jn.getDefaultDrawingOptions():(this._drawingOptions=jn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:n,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:p(this,hl),color:[0,0,0],thickness:p(this,hl)?0:s});return this.addComment(o),t?(o.paths={lines:n,points:i},o.uuid=p(this,wu),o.isCopy=!0):o.lines=n,p(this,Bs)&&(o.accessibilityData={type:"Figure",alt:p(this,Bs)}),o}static deserializeDraw(t,n,i,s,o,a){return a.areContours?sP.deserialize(t,n,i,s,o,a):py.deserialize(t,n,i,s,o,a)}static async deserialize(t,n,i){var o;const s=await super.deserialize(t,n,i);return E(s,hl,t.areContours),s.description=((o=t.accessibilityData)==null?void 0:o.alt)||"",E(s,wu,t.uuid),s}};hl=new WeakMap,Bs=new WeakMap,pl=new WeakMap,wu=new WeakMap,q(jn,"_type","signature"),q(jn,"_editorType",Ve.SIGNATURE),q(jn,"_defaultDrawingOptions",null);let uP=jn;var Ut,kr,fl,Wo,ml,Hh,Uo,Pu,zs,ri,Vh,dt,sv,ov,AC,bC,xC,hP,TC,Lj;class dP extends Ot{constructor(t){super({...t,name:"stampEditor"});N(this,dt);N(this,Ut,null);N(this,kr,null);N(this,fl,null);N(this,Wo,null);N(this,ml,null);N(this,Hh,"");N(this,Uo,null);N(this,Pu,!1);N(this,zs,null);N(this,ri,!1);N(this,Vh,!1);E(this,Wo,t.bitmapUrl),E(this,ml,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,n){Ot.initialize(t,n)}static isHandlingMimeForPasting(t){return YT.includes(t)}static paste(t,n){n.pasteEditor({mode:Ve.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:s,width:o,height:a,channels:s.length/(o*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),n&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;p(this,kr)&&(E(this,Ut,null),this._uiManager.imageManager.deleteId(p(this,kr)),(t=p(this,Uo))==null||t.remove(),E(this,Uo,null),p(this,zs)&&(clearTimeout(p(this,zs)),E(this,zs,null))),super.remove()}rebuild(){if(!this.parent){p(this,kr)&&_(this,dt,AC).call(this);return}super.rebuild(),this.div!==null&&(p(this,kr)&&p(this,Uo)===null&&_(this,dt,AC).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(p(this,fl)||p(this,Ut)||p(this,Wo)||p(this,ml)||p(this,kr)||p(this,Pu))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;return this._isCopy&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.createAltText(),p(this,Pu)||(p(this,Ut)?_(this,dt,bC).call(this):_(this,dt,AC).call(this)),this._isCopy&&this._moveAfterPaste(t,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,n){const{id:i,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,n);n.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(E(this,kr,i),s&&E(this,Ut,s),E(this,Pu,!1),_(this,dt,bC).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;p(this,zs)!==null&&clearTimeout(p(this,zs)),E(this,zs,setTimeout(()=>{E(this,zs,null),_(this,dt,hP).call(this)},200))}copyCanvas(t,n,i=!1){t||(t=224);const{width:s,height:o}=p(this,Ut),a=new Ws;let l=p(this,Ut),u=s,h=o,m=null;if(n){if(s>n||o>n){const L=Math.min(n/s,n/o);u=Math.floor(s*L),h=Math.floor(o*L)}m=document.createElement("canvas");const v=m.width=Math.ceil(u*a.sx),y=m.height=Math.ceil(h*a.sy);p(this,ri)||(l=_(this,dt,xC).call(this,v,y));const A=m.getContext("2d");A.filter=this._uiManager.hcmFilter;let x="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":F6.isDarkMode&&(x="#8f8f9d",b="#42414d");const w=15,T=w*a.sx,k=w*a.sy,I=new OffscreenCanvas(T*2,k*2),M=I.getContext("2d");M.fillStyle=x,M.fillRect(0,0,T*2,k*2),M.fillStyle=b,M.fillRect(0,0,T,k),M.fillRect(T,k,T,k),A.fillStyle=A.createPattern(I,"repeat"),A.fillRect(0,0,v,y),A.drawImage(l,0,0,l.width,l.height,0,0,v,y)}let g=null;if(i){let v,y;if(a.symmetric&&l.width<t&&l.height<t)v=l.width,y=l.height;else if(l=p(this,Ut),s>t||o>t){const b=Math.min(t/s,t/o);v=Math.floor(s*b),y=Math.floor(o*b),p(this,ri)||(l=_(this,dt,xC).call(this,v,y))}const x=new OffscreenCanvas(v,y).getContext("2d",{willReadFrequently:!0});x.drawImage(l,0,0,l.width,l.height,0,0,v,y),g={width:v,height:y,data:x.getImageData(0,0,v,y).data}}return{canvas:m,width:u,height:h,imageData:g}}static async deserialize(t,n,i){var x;let s=null,o=!1;if(t instanceof KD){const{data:{rect:b,rotation:w,id:T,structParent:k,popupRef:I,richText:M,contentsObj:L,creationDate:j,modificationDate:B},container:z,parent:{page:{pageNumber:Z}},canvas:$}=t;let U,Y;$?(delete t.canvas,{id:U,bitmap:Y}=i.imageManager.getFromCanvas(z.id,$),$.remove()):(o=!0,t._hasNoCanvas=!0);const ee=((x=await n._structTree.getAriaAttributes(`${Sd}${T}`))==null?void 0:x.get("aria-label"))||"";s=t={annotationType:Ve.STAMP,bitmapId:U,bitmap:Y,pageIndex:Z-1,rect:b.slice(0),rotation:w,annotationElementId:T,id:T,deleted:!1,accessibilityData:{decorative:!1,altText:ee},isSvg:!1,structParent:k,popupRef:I,richText:M,comment:(L==null?void 0:L.str)||null,creationDate:j,modificationDate:B}}const a=await super.deserialize(t,n,i),{rect:l,bitmap:u,bitmapUrl:h,bitmapId:m,isSvg:g,accessibilityData:v}=t;o?(i.addMissingCanvas(t.id,a),E(a,Pu,!0)):m&&i.imageManager.isValidId(m)?(E(a,kr,m),u&&E(a,Ut,u)):E(a,Wo,h),E(a,ri,g);const[y,A]=a.pageDimensions;return a.width=(l[2]-l[0])/y,a.height=(l[3]-l[1])/A,v&&(a.altTextData=v),a._initialData=s,t.comment&&a.setCommentData(t),E(a,Vh,!!s),a}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:p(this,kr),isSvg:p(this,ri)});if(this.addComment(i),t)return i.bitmapUrl=_(this,dt,TC).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const l=_(this,dt,Lj).call(this,i);return l.isSame?null:(l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(n===null)return i;n.stamps||(n.stamps=new Map);const a=p(this,ri)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!n.stamps.has(p(this,kr)))n.stamps.set(p(this,kr),{area:a,serialized:i}),i.bitmap=_(this,dt,TC).call(this,!1);else if(p(this,ri)){const l=n.stamps.get(p(this,kr));a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=_(this,dt,TC).call(this,!1))}return i}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Ut=new WeakMap,kr=new WeakMap,fl=new WeakMap,Wo=new WeakMap,ml=new WeakMap,Hh=new WeakMap,Uo=new WeakMap,Pu=new WeakMap,zs=new WeakMap,ri=new WeakMap,Vh=new WeakMap,dt=new WeakSet,sv=function(t,n=!1){if(!t){this.remove();return}E(this,Ut,t.bitmap),n||(E(this,kr,t.id),E(this,ri,t.isSvg)),t.file&&E(this,Hh,t.file.name),_(this,dt,bC).call(this)},ov=function(){if(E(this,fl,null),this._uiManager.enableWaiting(!1),!!p(this,Uo)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&p(this,Ut)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&p(this,Ut)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},AC=function(){if(p(this,kr)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(p(this,kr)).then(i=>_(this,dt,sv).call(this,i,!0)).finally(()=>_(this,dt,ov).call(this));return}if(p(this,Wo)){const i=p(this,Wo);E(this,Wo,null),this._uiManager.enableWaiting(!0),E(this,fl,this._uiManager.imageManager.getFromUrl(i).then(s=>_(this,dt,sv).call(this,s)).finally(()=>_(this,dt,ov).call(this)));return}if(p(this,ml)){const i=p(this,ml);E(this,ml,null),this._uiManager.enableWaiting(!0),E(this,fl,this._uiManager.imageManager.getFromFile(i).then(s=>_(this,dt,sv).call(this,s)).finally(()=>_(this,dt,ov).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=YT.join(",");const n=this._uiManager._signal;E(this,fl,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),_(this,dt,sv).call(this,s)}i()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:n})}).finally(()=>_(this,dt,ov).call(this))),t.click()},bC=function(){var u;const{div:t}=this;let{width:n,height:i}=p(this,Ut);const[s,o]=this.pageDimensions,a=.75;if(this.width)n=this.width*s,i=this.height*o;else if(n>a*s||i>a*o){const h=Math.min(a*s/n,a*o/i);n*=h,i*=h}this._uiManager.enableWaiting(!1);const l=E(this,Uo,document.createElement("canvas"));l.setAttribute("role","img"),this.addContainer(l),this.width=n/s,this.height=i/o,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),_(this,dt,hP).call(this),p(this,Vh)||(this.parent.addUndoableEditor(this),E(this,Vh,!0)),this._reportTelemetry({action:"inserted_image"}),p(this,Hh)&&this.div.setAttribute("aria-description",p(this,Hh)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},xC=function(t,n){const{width:i,height:s}=p(this,Ut);let o=i,a=s,l=p(this,Ut);for(;o>2*t||a>2*n;){const u=o,h=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*n&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const m=new OffscreenCanvas(o,a);m.getContext("2d").drawImage(l,0,0,u,h,0,0,o,a),l=m.transferToImageBitmap()}return l},hP=function(){const[t,n]=this.parentDimensions,{width:i,height:s}=this,o=new Ws,a=Math.ceil(i*t*o.sx),l=Math.ceil(s*n*o.sy),u=p(this,Uo);if(!u||u.width===a&&u.height===l)return;u.width=a,u.height=l;const h=p(this,ri)?p(this,Ut):_(this,dt,xC).call(this,a,l),m=u.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(h,0,0,h.width,h.height,0,0,a,l)},TC=function(t){if(t){if(p(this,ri)){const s=this._uiManager.imageManager.getSvgUrl(p(this,kr));if(s)return s}const n=document.createElement("canvas");return{width:n.width,height:n.height}=p(this,Ut),n.getContext("2d").drawImage(p(this,Ut),0,0),n.toDataURL()}if(p(this,ri)){const[n,i]=this.pageDimensions,s=Math.round(this.width*n*xl.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*xl.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(s,o);return a.getContext("2d").drawImage(p(this,Ut),0,0,p(this,Ut).width,p(this,Ut).height,0,0,s,o),a.transferToImageBitmap()}return structuredClone(p(this,Ut))},Lj=function(t){var a;const{pageIndex:n,accessibilityData:{altText:i}}=this._initialData,s=t.pageIndex===n,o=(((a=t.accessibilityData)==null?void 0:a.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&o,isSameAltText:o}},q(dP,"_type","stamp"),q(dP,"_editorType",Ve.STAMP);var Eu,qh,gl,vl,Zo,En,Sl,Gh,Kh,es,$o,Mr,Ho,yl,Yh,Ne,Cl,It,fP,_j,vs,mP,gP,wC;const Zi=class Zi{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:i,accessibilityManager:s,annotationLayer:o,drawLayer:a,textLayer:l,viewport:u,l10n:h}){N(this,It);N(this,Eu);N(this,qh,!1);N(this,gl,null);N(this,vl,null);N(this,Zo,null);N(this,En,new Map);N(this,Sl,!1);N(this,Gh,!1);N(this,Kh,!1);N(this,es,null);N(this,$o,null);N(this,Mr,null);N(this,Ho,null);N(this,yl,null);N(this,Yh,-1);N(this,Ne);const m=[...p(Zi,Cl).values()];if(!Zi._initialized){Zi._initialized=!0;for(const g of m)g.initialize(h,e)}e.registerEditorTypes(m),E(this,Ne,e),this.pageIndex=t,this.div=n,E(this,Eu,s),E(this,gl,o),this.viewport=u,E(this,Mr,l),this.drawLayer=a,this._structTree=i,p(this,Ne).addLayer(this)}get isEmpty(){return p(this,En).size===0}get isInvisible(){return this.isEmpty&&p(this,Ne).getMode()===Ve.NONE}updateToolbar(e){p(this,Ne).updateToolbar(e)}updateMode(e=p(this,Ne).getMode()){switch(_(this,It,wC).call(this),e){case Ve.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ve.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ve.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Ve.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of p(Zi,Cl).values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=p(this,Mr))==null?void 0:t.div)}setEditingState(e){p(this,Ne).setEditingState(e)}addCommands(e){p(this,Ne).addCommands(e)}cleanUndoStack(e){p(this,Ne).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=p(this,gl))==null||t.togglePointerEvents(e)}async enable(){var n;E(this,Kh,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(n=p(this,yl))==null||n.abort(),E(this,yl,null);const e=new Set;for(const i of p(this,It,fP))i.enableEditing(),i.show(!0),i.annotationElementId&&(p(this,Ne).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const t=p(this,gl);if(t)for(const i of t.getEditableAnnotations()){if(i.hide(),p(this,Ne).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}E(this,Kh,!1),p(this,Ne)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var i;if(E(this,Gh,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),p(this,Mr)&&!p(this,yl)){E(this,yl,new AbortController);const s=p(this,Ne).combinedSignal(p(this,yl));p(this,Mr).div.addEventListener("pointerdown",o=>{const{clientX:l,clientY:u,timeStamp:h}=o,m=p(this,Yh);if(h-m>500){E(this,Yh,h);return}E(this,Yh,-1);const{classList:g}=this.div;g.toggle("getElements",!0);const v=document.elementsFromPoint(l,u);if(g.toggle("getElements",!1),!this.div.contains(v[0]))return;let y;const A=new RegExp(`^${lv}[0-9]+$`);for(const b of v)if(A.test(b.id)){y=b.id;break}if(!y)return;const x=p(this,En).get(y);(x==null?void 0:x.annotationElementId)===null&&(o.stopPropagation(),o.preventDefault(),x.dblclick(o))},{signal:s,capture:!0})}const e=p(this,gl),t=[];if(e){const s=new Map,o=new Map;for(const l of p(this,It,fP)){if(l.disableEditing(),!l.annotationElementId){t.push(l);continue}if(l.serialize()!==null){s.set(l.annotationElementId,l);continue}else o.set(l.annotationElementId,l);(i=this.getEditableAnnotation(l.annotationElementId))==null||i.show(),l.remove()}const a=e.getEditableAnnotations();for(const l of a){const{id:u}=l.data;if(p(this,Ne).isDeletedAnnotationElement(u)){l.updateEdited({deleted:!0});continue}let h=o.get(u);if(h){h.resetAnnotationElement(l),h.show(!1),l.show();continue}h=s.get(u),h&&(p(this,Ne).addChangedExistingAnnotation(h),h.renderAnnotationElement(l)&&h.show(!1)),l.show()}}_(this,It,wC).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of p(Zi,Cl).values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),E(this,Gh,!1)}getEditableAnnotation(e){var t;return((t=p(this,gl))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){p(this,Ne).getActive()!==e&&p(this,Ne).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=p(this,Mr))!=null&&e.div&&!p(this,Ho)){E(this,Ho,new AbortController);const t=p(this,Ne).combinedSignal(p(this,Ho));p(this,Mr).div.addEventListener("pointerdown",_(this,It,_j).bind(this),{signal:t}),p(this,Mr).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=p(this,Mr))!=null&&e.div&&p(this,Ho)&&(p(this,Ho).abort(),E(this,Ho,null),p(this,Mr).div.classList.remove("highlighting"))}enableClick(){if(p(this,vl))return;E(this,vl,new AbortController);const e=p(this,Ne).combinedSignal(p(this,vl));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=p(this,vl))==null||e.abort(),E(this,vl,null)}attach(e){p(this,En).set(e.id,e);const{annotationElementId:t}=e;t&&p(this,Ne).isDeletedAnnotationElement(t)&&p(this,Ne).removeDeletedAnnotationElement(e)}detach(e){var t;p(this,En).delete(e.id),(t=p(this,Eu))==null||t.removePointerInTextLayer(e.contentDiv),!p(this,Gh)&&e.annotationElementId&&p(this,Ne).addDeletedAnnotationElement(e)}remove(e){this.detach(e),p(this,Ne).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(p(this,Ne).addDeletedAnnotationElement(e),Ot.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),p(this,Ne).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!p(this,Kh)),p(this,Ne).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!p(this,Zo)&&(e._focusEventsAllowed=!1,E(this,Zo,setTimeout(()=>{E(this,Zo,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:p(this,Ne)._signal}),t.focus())},0))),e._structTreeParentId=(n=p(this,Eu))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of p(this,En).values())if(t.uid===e)return t;return null}getNextId(){return p(this,Ne).getId()}combinedSignal(e){return p(this,Ne).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=p(this,It,vs))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await p(this,Ne).updateMode(e.mode);const{offsetX:n,offsetY:i}=_(this,It,gP).call(this),s=this.getNextId(),o=_(this,It,mP).call(this,{parent:this,id:s,x:n,y:i,uiManager:p(this,Ne),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=p(Zi,Cl).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,p(this,Ne)))||null}createAndAddNewEditor(e,t,n={}){const i=this.getNextId(),s=_(this,It,mP).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:p(this,Ne),isCentered:t,...n});return s&&this.add(s),s}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(_(this,It,gP).call(this),!0,e)}setSelected(e){p(this,Ne).setSelected(e)}toggleSelected(e){p(this,Ne).toggleSelected(e)}unselect(e){p(this,Ne).unselect(e)}pointerup(e){var i;const{isMac:t}=Ar.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!p(this,Sl)||(E(this,Sl,!1),(i=p(this,It,vs))!=null&&i.isDrawer&&p(this,It,vs).supportMultipleDrawings))return;if(!p(this,qh)){E(this,qh,!0);return}const n=p(this,Ne).getMode();if(n===Ve.STAMP||n===Ve.SIGNATURE){p(this,Ne).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(p(this,Ne).getMode()===Ve.HIGHLIGHT&&this.enableTextSelection(),p(this,Sl)){E(this,Sl,!1);return}const{isMac:t}=Ar.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(E(this,Sl,!0),(i=p(this,It,vs))!=null&&i.isDrawer){this.startDrawingSession(e);return}const n=p(this,Ne).getActive();E(this,qh,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),p(this,es)){p(this,It,vs).startDrawing(this,p(this,Ne),!1,e);return}p(this,Ne).setCurrentDrawingSession(this),E(this,es,new AbortController);const t=p(this,Ne).combinedSignal(p(this,es));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(E(this,$o,null),this.commitOrRemove())},{signal:t}),p(this,It,vs).startDrawing(this,p(this,Ne),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&E(this,$o,t);return}p(this,$o)&&setTimeout(()=>{var t;(t=p(this,$o))==null||t.focus(),E(this,$o,null)},0)}endDrawingSession(e=!1){return p(this,es)?(p(this,Ne).setCurrentDrawingSession(null),p(this,es).abort(),E(this,es,null),E(this,$o,null),p(this,It,vs).endDrawing(e)):null}findNewParent(e,t,n){const i=p(this,Ne).findParent(t,n);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return p(this,es)?(this.endDrawingSession(),!0):!1}onScaleChanging(){p(this,es)&&p(this,It,vs).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=p(this,Ne).getActive())==null?void 0:e.parent)===this&&(p(this,Ne).commitOrRemove(),p(this,Ne).setActiveEditor(null)),p(this,Zo)&&(clearTimeout(p(this,Zo)),E(this,Zo,null));for(const n of p(this,En).values())(t=p(this,Eu))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,p(this,En).clear(),p(this,Ne).removeLayer(this)}render({viewport:e}){this.viewport=e,Iu(this.div,e);for(const t of p(this,Ne).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){p(this,Ne).commitOrRemove(),_(this,It,wC).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,Iu(this.div,{rotation:n}),t!==n)for(const i of p(this,En).values())i.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return p(this,Ne).viewParameters.realScale}};Eu=new WeakMap,qh=new WeakMap,gl=new WeakMap,vl=new WeakMap,Zo=new WeakMap,En=new WeakMap,Sl=new WeakMap,Gh=new WeakMap,Kh=new WeakMap,es=new WeakMap,$o=new WeakMap,Mr=new WeakMap,Ho=new WeakMap,yl=new WeakMap,Yh=new WeakMap,Ne=new WeakMap,Cl=new WeakMap,It=new WeakSet,fP=function(){return p(this,En).size!==0?p(this,En).values():p(this,Ne).getEditors(this.pageIndex)},_j=function(e){p(this,Ne).unselectAll();const{target:t}=e;if(t===p(this,Mr).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&p(this,Mr).div.contains(t)){const{isMac:n}=Ar.platform;if(e.button!==0||e.ctrlKey&&n)return;p(this,Ne).showAllEditors("highlight",!0,!0),p(this,Mr).div.classList.add("free"),this.toggleDrawing(),jC.startHighlighting(this,p(this,Ne).direction==="ltr",{target:p(this,Mr).div,x:e.x,y:e.y}),p(this,Mr).div.addEventListener("pointerup",()=>{p(this,Mr).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:p(this,Ne)._signal}),e.preventDefault()}},vs=function(){return p(Zi,Cl).get(p(this,Ne).getMode())},mP=function(e){const t=p(this,It,vs);return t?new t.prototype.constructor(e):null},gP=function(){const{x:e,y:t,width:n,height:i}=this.boundingClientRect,s=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+n),l=Math.min(window.innerHeight,t+i),u=(s+a)/2-e,h=(o+l)/2-t,[m,g]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:m,offsetY:g}},wC=function(){for(const e of p(this,En).values())e.isEmpty()&&e.remove()},q(Zi,"_initialized",!1),N(Zi,Cl,new Map([Gw,iP,dP,jC,uP].map(e=>[e._editorType,e])));let pP=Zi;var ts,cn,Ru,ny,iA,Oj,Us,SP,Dj,yP;const vr=class vr{constructor({pageIndex:e}){N(this,Us);N(this,ts,null);N(this,cn,new Map);N(this,Ru,new Map);this.pageIndex=e}setParent(e){if(!p(this,ts)){E(this,ts,e);return}if(p(this,ts)!==e){if(p(this,cn).size>0)for(const t of p(this,cn).values())t.remove(),e.append(t);E(this,ts,e)}}static get _svgFactory(){return $e(this,"_svgFactory",new OC)}draw(e,t=!1,n=!1){const i=mr(vr,ny)._++,s=_(this,Us,SP).call(this),o=vr._svgFactory.createElement("defs");s.append(o);const a=vr._svgFactory.createElement("path");o.append(a);const l=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t&&p(this,Ru).set(i,a);const u=n?_(this,Us,Dj).call(this,o,l):null,h=vr._svgFactory.createElement("use");return s.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(s,e),p(this,cn).set(i,s),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const n=mr(vr,ny)._++,i=_(this,Us,SP).call(this),s=vr._svgFactory.createElement("defs");i.append(s);const o=vr._svgFactory.createElement("path");s.append(o);const a=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const m=vr._svgFactory.createElement("mask");s.append(m),l=`mask_p${this.pageIndex}_${n}`,m.setAttribute("id",l),m.setAttribute("maskUnits","objectBoundingBox");const g=vr._svgFactory.createElement("rect");m.append(g),g.setAttribute("width","1"),g.setAttribute("height","1"),g.setAttribute("fill","white");const v=vr._svgFactory.createElement("use");m.append(v),v.setAttribute("href",`#${a}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const u=vr._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${a}`),l&&u.setAttribute("mask",`url(#${l})`);const h=u.cloneNode();return i.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(i,e),p(this,cn).set(n,i),n}finalizeDraw(e,t){p(this,Ru).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:n,bbox:i,rootClass:s,path:o}=t,a=typeof e=="number"?p(this,cn).get(e):e;if(a){if(n&&_(this,Us,yP).call(this,a,n),i&&_(l=vr,iA,Oj).call(l,a,i),s){const{classList:u}=a;for(const[h,m]of Object.entries(s))u.toggle(h,m)}if(o){const h=a.firstElementChild.firstElementChild;_(this,Us,yP).call(this,h,o)}}}updateParent(e,t){if(t===this)return;const n=p(this,cn).get(e);n&&(p(t,ts).append(n),p(this,cn).delete(e),p(t,cn).set(e,n))}remove(e){p(this,Ru).delete(e),p(this,ts)!==null&&(p(this,cn).get(e).remove(),p(this,cn).delete(e))}destroy(){E(this,ts,null);for(const e of p(this,cn).values())e.remove();p(this,cn).clear(),p(this,Ru).clear()}};ts=new WeakMap,cn=new WeakMap,Ru=new WeakMap,ny=new WeakMap,iA=new WeakSet,Oj=function(e,[t,n,i,s]){const{style:o}=e;o.top=`${100*n}%`,o.left=`${100*t}%`,o.width=`${100*i}%`,o.height=`${100*s}%`},Us=new WeakSet,SP=function(){const e=vr._svgFactory.create(1,1,!0);return p(this,ts).append(e),e.setAttribute("aria-hidden",!0),e},Dj=function(e,t){const n=vr._svgFactory.createElement("clipPath");e.append(n);const i=`clip_${t}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const s=vr._svgFactory.createElement("use");return n.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),i},yP=function(e,t){for(const[n,i]of Object.entries(t))i===null?e.removeAttribute(n):e.setAttribute(n,i)},N(vr,iA),N(vr,ny,0);let vP=vr;globalThis._pdfjsTestingUtils={HighlightOutliner:Yw};globalThis.pdfjsLib={AbortException:bl,AnnotationEditorLayer:pP,AnnotationEditorParamsType:st,AnnotationEditorType:Ve,AnnotationEditorUIManager:ku,AnnotationLayer:Vw,AnnotationMode:ka,AnnotationType:ur,applyOpacity:U6,build:YW,ColorPicker:LC,createValidAbsoluteUrl:PO,CSSConstants:W6,DOMSVGFactory:OC,DrawLayer:vP,FeatureTest:Ar,fetchData:ly,findContrastColor:Z6,getDocument:_D,getFilenameFromUrl:O6,getPdfFilenameFromUrl:D6,getRGB:uy,getUuid:IO,getXfaPageViewport:B6,GlobalWorkerOptions:Fs,ImageKind:V0,InvalidPDFException:GT,isDataScheme:pA,isPdfFile:jP,isValidExplicitDest:eW,MathClamp:dn,noContextMenu:Mi,normalizeUnicode:N6,OPS:cv,OutputScale:Ws,PasswordResponses:x6,PDFDataRangeTransport:OD,PDFDateString:EC,PDFWorker:hv,PermissionFlag:b6,PixelsPerInch:xl,RenderingCancelledException:DP,renderRichText:NO,ResponseException:PC,setLayerDimensions:Iu,shadow:$e,SignatureExtractor:Vo,stopEvent:nr,SupportedImageMimeTypes:YT,TextLayer:dv,TouchManager:IC,updateUrlHash:EO,Util:we,VerbosityLevel:uA,version:KW,XfaLayer:MO};function CU(r){return new Worker("/AzureVoicePlayground/assets/pdf.worker-C5jlnIh9.js",{name:r==null?void 0:r.name})}Fs.workerPort=new CU;function AU(r){const e=r.toLowerCase();return e.endsWith(".pdf")||e.includes(".pdf?")}async function bU(r){try{const e=await _D({data:r}).promise;let t="";const n=Math.min(e.numPages,20);console.log("PDF has",e.numPages,"pages, extracting up to",n);for(let i=1;i<=n;i++){const a=(await(await e.getPage(i)).getTextContent()).items.map(l=>l.str).join(" ");t+=a+`
`}return t.replace(/\s+/g," ").trim().substring(0,1e5)}catch(e){throw new Error(`Failed to extract PDF content: ${e instanceof Error?e.message:"Unknown error"}`)}}function xU(r){var s;const t=new DOMParser().parseFromString(r,"text/html");return t.querySelectorAll("script, style, nav, header, footer, aside").forEach(o=>o.remove()),(((s=t.body)==null?void 0:s.textContent)||"").replace(/\s+/g," ").trim().substring(0,1e5)}async function TU(r){let e;try{const t=await fetch(r);if(!t.ok)throw new Error(`Failed to fetch URL: ${t.status}`);const n=t.headers.get("content-type")||"",i=AU(r)||n.includes("application/pdf");if(console.log("=== URL FETCH INFO ==="),console.log("URL:",r),console.log("Content-Type:",n),console.log("Is PDF:",i),i){const s=await t.arrayBuffer();e=await bU(s)}else{const s=await t.text();e=xU(s)}}catch(t){throw new Error(`Failed to fetch URL content: ${t instanceof Error?t.message:"Unknown error"}`)}return console.log("Content length:",e.length,"characters"),console.log("--- Content Preview (first 2000 chars) ---"),console.log(e.substring(0,2e3)),console.log("--- End Preview ---"),e.length>2e3&&console.log("... [truncated, total",e.length,"characters]"),console.log("================================="),e}async function wU(r,e){var A,x,b;const t=await TU(e.url);if(!t||t.length<50)throw new Error("Could not extract enough content from the URL");const n=e.speakers.join(", "),i=e.language||"English",s=e.speakers[0]||"speaker1",o=e.speakers[1]||"speaker2",a=i==="Chinese"?'"", "", "", "", "", "", ""':i==="Japanese"?'"", "", "", "", ""':i==="Korean"?'"", "", "", "", ""':'"yeah", "right", "oh", "mm-hmm", "I see", "exactly", "uh-huh"',l=`You are a podcast script writer. Your task is to create an engaging, natural-sounding podcast dialogue script based on the provided content.

Rules:
1. Write in ${i}
2. Use exactly these speaker names: ${n}
3. Format each line as "speakername: dialog text" (lowercase speaker name, colon, then the text)

Script style guidelines:
- Start with a friendly greeting and introduction to the topic
- Break down the content into conversational exchanges
- ${s} (first speaker) typically leads, asks questions, and drives the conversation
- ${o} (second speaker) provides answers, explanations, and insights
- **Use backchanneling as separate lines** to show active listening and engagement:
  - Use expressions like: ${a}
  - Insert these as **separate lines** by the listener during longer explanations
  - Example format:
    ${s}: So the framework has three main components...
    ${o}: 
    ${s}: First, they use something called LoRA...
    ${o}: 
- Add 3-5 backchanneling turns throughout the conversation to create natural interaction
- End with key takeaways and a friendly goodbye
- Make it sound natural and engaging, like a real podcast conversation
- Keep the script between 15-30 lines total
- Do not include any stage directions, actions, or parenthetical notes - only dialog text`,u=`Create a podcast script discussing the following content:

${t}

Remember:
- Use speakers: ${n}
- Format: speakername: dialog text
- Include 3-5 backchanneling responses (short acknowledgments like ${a}) as separate lines
- Make it conversational and engaging`,h=[{role:"system",content:l},{role:"user",content:u}],m=`${r.endpoint}/openai/deployments/${r.deploymentName}/chat/completions?api-version=2024-02-15-preview`,g=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json","api-key":r.apiKey},body:JSON.stringify({messages:h,max_tokens:2e3,temperature:.7})});if(!g.ok){const w=await g.text();throw new Error(`Azure OpenAI API error: ${g.status} - ${w}`)}const y=(b=(x=(A=(await g.json()).choices)==null?void 0:A[0])==null?void 0:x.message)==null?void 0:b.content;if(!y)throw new Error("No script generated from Azure OpenAI");return y.trim()}const PU=`ava: Welcome to Tech Talk! I'm your host, and today we're diving into artificial intelligence.
andrew: Thanks for having me! AI is such a fascinating topic these days.
ava: Absolutely! Can you explain what makes modern AI so powerful?
andrew: Of course! The key is deep learning, which allows computers to learn patterns from massive amounts of data.
ava: That sounds incredible. What are some practical applications?
andrew: We see AI everywhere now - voice assistants, recommendation systems, autonomous vehicles, and more.`;function EU({settings:r,onSettingsChange:e,isConfigured:t,history:n,addToHistory:i,removeFromHistory:s,clearHistory:o}){const{enableMAIVoices:a}=_P(),[l,u]=O.useState(PU),[h,m]=O.useState({female:"ava",male:"andrew",display:"Ava & Andrew"}),[g,v]=O.useState(!1),[y,A]=O.useState(!1),[x,b]=O.useState("en-US"),[w,T]=O.useState(null),k=O.useRef(null),I=O.useRef(null),[M,L]=O.useState(()=>localStorage.getItem("podcast_url")||""),[j,B]=O.useState(!1),[z,Z]=O.useState(""),[$,U]=O.useState(!1),[Y,ee]=O.useState(()=>localStorage.getItem("aoai_endpoint")||""),[X,re]=O.useState(()=>localStorage.getItem("aoai_apikey")||""),[G,J]=O.useState(()=>localStorage.getItem("aoai_deployment")||"gpt-5");O.useEffect(()=>{localStorage.setItem("podcast_url",M)},[M]);const{state:ne,error:W,audioData:V,synthesize:ce,pause:ue,resume:ve,stop:se}=y6({apiKey:r.apiKey,region:r.region}),te=["eastus","southeastasia","westeurope"].includes(r.region.toLowerCase()),ge=de=>{if(b(de),de&&h){const Ae=wa(h);if(Ae){const nt=TT.find(at=>at.locale===de);if(nt){const at=W2(nt,Ae.speakers);u(at)}}}};O.useEffect(()=>{if(h&&x){const de=wa(h);if(de){const Ae=TT.find(nt=>nt.locale===x);if(Ae){const nt=W2(Ae,de.speakers);u(nt)}}}},[h,x]),O.useEffect(()=>{if(V&&V!==k.current&&h){k.current=V;const de=wa(h);lA(V).then(Ae=>{i({timestamp:Date.now(),text:l,voice:(de==null?void 0:de.displayName)||h.display,region:r.region,audioData:V,duration:Ae})}).catch(Ae=>{console.error("Failed to get audio duration:",Ae);const nt=V.byteLength*8/48e3;i({timestamp:Date.now(),text:l,voice:(de==null?void 0:de.displayName)||h.display,region:r.region,audioData:V,duration:nt})})}},[V,l,h,r.region,i]);const oe=()=>{if(h){const de=wa(h);de&&ce(l,de.voiceName,de.locale,de.speakers)}},pe=()=>{localStorage.setItem("aoai_endpoint",Y),localStorage.setItem("aoai_apikey",X),localStorage.setItem("aoai_deployment",G),U(!1)},Be=async()=>{if(!M.trim()){Z("Please enter a URL");return}if(!Y||!X){Z("Please configure Azure OpenAI settings first"),U(!0);return}if(!h){Z("Please select a speaker pair first");return}B(!0),Z("");try{const de={endpoint:Y,apiKey:X,deploymentName:G},Ae=wa(h);if(!Ae)throw new Error("Failed to get voice details");const at=(x||Ae.locale||"en-US").split("-")[0].toLowerCase(),yt={zh:"Chinese",ja:"Japanese",ko:"Korean",de:"German",fr:"French",es:"Spanish",pt:"Portuguese",it:"Italian",en:"English"}[at]||"English",li=await wU(de,{url:M,speakers:Ae.speakers,language:yt});u(li),b("")}catch(de){Z(de instanceof Error?de.message:"Failed to generate script")}finally{B(!1)}},Fe=de=>{const Ae=new Blob([de.audioData],{type:"audio/mpeg"}),nt=URL.createObjectURL(Ae),at=document.createElement("a");at.href=nt,at.download=`multitalker-${de.voice}-${Date.now()}.mp3`,document.body.appendChild(at),at.click(),document.body.removeChild(at),URL.revokeObjectURL(nt)},ye=de=>{if(w===de.id&&I.current){I.current.pause(),I.current=null,T(null);return}I.current&&(I.current.pause(),I.current=null);const Ae=new Blob([de.audioData],{type:"audio/mpeg"}),nt=URL.createObjectURL(Ae),at=new Audio(nt);I.current=at,T(de.id),at.play(),at.onended=()=>{URL.revokeObjectURL(nt),T(null),I.current=null},at.onerror=()=>{URL.revokeObjectURL(nt),T(null),I.current=null}},_e=ne;return f.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[f.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 shadow-md",children:[f.jsx("h1",{className:"text-3xl font-bold",children:"Multi Talker"}),f.jsx("p",{className:"text-purple-100 mt-1",children:"Create multi-speaker dialog content with AI-powered voices"})]}),f.jsxs("div",{className:"flex-1 flex flex-col gap-4 p-6 overflow-y-auto",children:[t&&!te&&f.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx("svg",{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-amber-800",children:"Region Not Supported"}),f.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Multi Talker is currently only available in the following regions:"}),f.jsxs("ul",{className:"text-sm text-amber-700 mt-2 list-disc list-inside",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"East US"})," (eastus)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"West Europe"})," (westeurope)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Southeast Asia"})," (southeastasia)"]})]}),f.jsxs("p",{className:"text-sm text-amber-700 mt-2",children:["Your current region is ",f.jsx("strong",{children:r.region}),". Please update your region in the sidebar settings."]})]})]})}),(!t||te)&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"border border-purple-200 rounded-lg p-4 bg-purple-50",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("label",{className:"text-sm font-medium text-purple-700",children:"Generate Script from URL"}),f.jsxs("button",{onClick:()=>U(!$),className:"text-xs text-purple-600 hover:text-purple-800 underline",children:[$?"Hide":"Configure"," Azure OpenAI"]})]}),$&&f.jsxs("div",{className:"mb-3 p-3 bg-white border border-purple-200 rounded-md space-y-2",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Endpoint"}),f.jsx("input",{type:"text",value:Y,onChange:de=>ee(de.target.value),placeholder:"https://your-resource.openai.azure.com",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-purple-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"API Key"}),f.jsx("input",{type:"password",value:X,onChange:de=>re(de.target.value),placeholder:"Enter API key",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-purple-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Deployment Name"}),f.jsx("input",{type:"text",value:G,onChange:de=>J(de.target.value),placeholder:"gpt-5",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-purple-500"})]}),f.jsx("button",{onClick:pe,className:"px-3 py-1 text-xs font-medium text-white bg-purple-600 rounded hover:bg-purple-700",children:"Save Config"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"url",value:M,onChange:de=>L(de.target.value),placeholder:"Enter URL to generate podcast script from...",className:"flex-1 px-3 py-2 border border-purple-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",disabled:j}),f.jsx("button",{onClick:Be,disabled:j||!M.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:j?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Generating..."]}):"Generate Script"})]}),z&&f.jsx("p",{className:"mt-2 text-xs text-red-600",children:z})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Podcast Script Preset:"}),f.jsxs("select",{value:x,onChange:de=>ge(de.target.value),className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",disabled:ne==="synthesizing"||ne==="playing",children:[f.jsx("option",{value:"",children:"-- Select a preset --"}),TT.map(de=>f.jsx("option",{value:de.locale,children:de.language},de.locale))]}),x&&f.jsx("button",{onClick:()=>{b("")},className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear"})]}),f.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:g?"SSML Preview":"Dialog Text"}),h&&!g&&(()=>{const de=wa(h);return de?f.jsxs("div",{className:"text-xs text-gray-500",children:["Format: ",f.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"speaker: text"})," | Speakers: ",de.speakers.map((Ae,nt)=>f.jsx("code",{className:"bg-purple-100 text-purple-700 px-1 rounded mx-0.5",children:Ae},Ae))]}):null})()]}),f.jsx("textarea",{value:(()=>{if(g&&h){const de=wa(h);return de?wO(l,de.voiceName,de.locale,de.speakers):l}return l})(),onChange:de=>!g&&u(de.target.value),placeholder:`Enter dialog text with speaker prefixes:
speaker1: Hello!
speaker2: Hi there!`,className:`flex-1 w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm resize-none ${g?"bg-gray-900 text-green-400":""}`,disabled:ne==="synthesizing"||ne==="playing",readOnly:g}),f.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[f.jsxs("div",{className:"text-xs text-gray-500",children:[l.split(`
`).filter(de=>de.trim()).length," lines | ",l.length," characters"]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>v(!g),disabled:!h||!l,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Show Plain Text":"Show SSML"}),f.jsx("button",{onClick:()=>u(""),disabled:!l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Clear Text"})]})]})]}),f.jsx("div",{className:"border-t border-gray-200 pt-4",children:f.jsx(uO,{state:_e,error:W,audioData:V,hasText:l.trim().length>0,isConfigured:t&&h!==null,onPlay:oe,onPause:ue,onResume:ve,onStop:se})})]})]}),f.jsxs("div",{className:"border-t border-gray-200 bg-gray-50",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-gray-100",onClick:()=>A(!y),children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Synthesis History"}),n.length>0&&f.jsx("span",{className:"px-2 py-1 text-xs font-medium text-white bg-purple-600 rounded-full",children:n.length})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[n.length>0&&f.jsx("button",{onClick:de=>{de.stopPropagation(),window.confirm("Clear all history?")&&o()},className:"px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors",children:"Clear All"}),f.jsx("svg",{className:`w-5 h-5 text-gray-600 transform transition-transform ${y?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]}),y&&f.jsx("div",{className:"max-h-64 overflow-y-auto",children:n.length===0?f.jsx("div",{className:"px-4 py-8 text-center text-gray-500 text-sm",children:"No synthesis history yet"}):f.jsx("div",{className:"divide-y divide-gray-200",children:n.map(de=>f.jsxs("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-100",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"text-sm font-medium text-gray-800 truncate",children:de.voice}),f.jsxs("div",{className:"text-xs text-gray-500",children:[new Date(de.timestamp).toLocaleTimeString()," |"," ",de.duration.toFixed(1),"s |"," ",de.text.substring(0,50),"..."]})]}),f.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[f.jsx("button",{onClick:()=>ye(de),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md transition-colors",title:w===de.id?"Pause":"Play",children:w===de.id?f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),f.jsx("button",{onClick:()=>Fe(de),className:"p-2 text-gray-600 hover:bg-gray-200 rounded-full",title:"Download",children:f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})}),f.jsx("button",{onClick:()=>s(de.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-full",title:"Delete",children:f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]},de.id))})})]}),f.jsxs("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3 flex items-center justify-between",children:[f.jsx("p",{className:"text-xs text-gray-600",children:"Multi Talker uses Azure Speech Service with DragonHDV2.4Neural model."}),f.jsx(dO,{text:l,selectedVoice:(()=>{const de=wa(h);return(de==null?void 0:de.displayName)||""})(),region:r.region,audioData:V})]})]}),f.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-hidden",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Speaker Pair Selection"}),f.jsx("div",{className:"flex-1 min-h-0",children:f.jsx(C6,{selectedPair:h,onPairChange:m})})]})]})}const mL=[{tier:"pro",id:"gpt-realtime"},{tier:"pro",id:"gpt-4o"},{tier:"pro",id:"gpt-4.1"},{tier:"pro",id:"gpt-5"},{tier:"pro",id:"gpt-5-chat"},{tier:"basic",id:"gpt-realtime-mini"},{tier:"basic",id:"gpt-4o-mini"},{tier:"basic",id:"gpt-4.1-mini"},{tier:"basic",id:"gpt-5-mini"},{tier:"lite",id:"gpt-5-nano"},{tier:"lite",id:"phi4-mm-realtime"},{tier:"lite",id:"phi4-mini"}],RU=[{code:"en",label:"English"},{code:"zh",label:""},{code:"ja",label:""},{code:"ko",label:""},{code:"fr",label:"Franais"},{code:"de",label:"Deutsch"},{code:"es",label:"Espaol"},{code:"it",label:"Italiano"},{code:"pt",label:"Portugus"},{code:"ru",label:""},{code:"ar",label:""},{code:"hi",label:""},{code:"id",label:"Bahasa Indonesia"},{code:"vi",label:"Ting Vit"},{code:"th",label:""},{code:"tr",label:"Trke"},{code:"nl",label:"Nederlands"},{code:"sv",label:"Svenska"},{code:"no",label:"Norsk"},{code:"da",label:"Dansk"},{code:"fi",label:"Suomi"},{code:"pl",label:"Polski"},{code:"cs",label:"etina"},{code:"hu",label:"Magyar"},{code:"ro",label:"Romn"},{code:"el",label:""},{code:"he",label:""}],_T={endpoint:"",apiKey:"",model:"gpt-4.1-mini",targetLanguage:"en",asrModel:"azure-speech",asrLanguages:"",voiceProvider:"azure-standard",voiceName:"en-US-AvaMultilingualNeural",prompt:"",turnDetectionType:"azure_semantic_vad",threshold:.5,prefixPaddingInMs:300,silenceDurationInMs:200,speechDurationInMs:80,removeFillerWords:!1,eouModel:"semantic_detection_v1",eouThresholdLevel:"default",eouTimeoutInMs:1e3};function ld(r){return["You are a simultaneous interpreter.",`Target language: ${r}.`,"","Rules:","1) Translate sentence by sentence (output each sentence as it completes).","2) Keep context consistent across turns (pronouns, terms, tone, references).","3) Preserve meaning faithfully; do not add explanations or extra content.","4) Keep proper nouns, numbers, and code as-is unless a standard translation is obvious.","5) Output translation text only."].join(`
`)}function gL(r){const t=(r.asrModel==="azure-speech"?"azure_semantic_vad":r.turnDetectionType)==="server_vad"?{type:"server_vad",threshold:r.threshold,prefixPaddingInMs:r.prefixPaddingInMs,silenceDurationInMs:r.silenceDurationInMs,createResponse:!0,interruptResponse:!1}:{type:"azure_semantic_vad",threshold:r.threshold,prefixPaddingInMs:r.prefixPaddingInMs,silenceDurationInMs:r.silenceDurationInMs,speechDurationInMs:r.speechDurationInMs,removeFillerWords:r.removeFillerWords,createResponse:!0,interruptResponse:!1},n=r.asrLanguages.split(",").map(i=>i.trim()).filter(Boolean).join(",");return{model:r.model,modalities:["audio","text"],instructions:r.prompt,inputAudioFormat:"pcm16",inputAudioSamplingRate:16e3,outputAudioFormat:"pcm16",turnDetection:t,inputAudioTranscription:r.asrModel==="azure-speech"?{model:"azure-speech",language:n||void 0}:{model:r.asrModel},voice:r.voiceProvider==="openai"?{type:"openai",name:r.voiceName}:{type:"azure-standard",name:r.voiceName}}}function vL(r){if(!r)return 24e3;const e=r.toLowerCase();return e==="pcm16"?24e3:e==="pcm16-16000hz"?16e3:e==="pcm16-8000hz"?8e3:24e3}function IU(r){const e=new Int16Array(r.length);for(let t=0;t<r.length;t++){const n=Math.max(-1,Math.min(1,r[t]??0));e[t]=n<0?n*32768:n*32767}return e}function kU(r){return new Uint8Array(r.buffer)}function MU(r){const e=new DataView(r.buffer,r.byteOffset,r.byteLength),t=Math.floor(r.byteLength/2),n=new Float32Array(t);for(let i=0;i<t;i++){const s=e.getInt16(i*2,!0);n[i]=s/32768}return n}class NU{constructor(e,t){q(this,"mediaStream");q(this,"audioContext");q(this,"processor");q(this,"source");q(this,"config");q(this,"callbacks");this.config=e,this.callbacks=t}async start(){this.callbacks.onState("starting");try{this.mediaStream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=new AudioContext({sampleRate:this.config.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.mediaStream),this.processor=this.audioContext.createScriptProcessor(this.config.bufferSize,1,1),this.processor.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0),n=IU(t),i=kU(n),s=n.length/this.config.sampleRate;this.callbacks.onChunk(i,s)},this.source.connect(this.processor),this.processor.connect(this.audioContext.destination),this.callbacks.onState("started")}catch(e){const t=e instanceof Error?e.message:String(e);this.callbacks.onState("error",t),await this.stop()}}async stop(){var e,t,n,i;this.callbacks.onState("stopping");try{(e=this.processor)==null||e.disconnect(),(t=this.source)==null||t.disconnect(),this.processor=void 0,this.source=void 0,await((n=this.audioContext)==null?void 0:n.close()),this.audioContext=void 0,(i=this.mediaStream)==null||i.getTracks().forEach(s=>s.stop()),this.mediaStream=void 0}finally{this.callbacks.onState("stopped")}}}class jj{constructor(e){q(this,"_key");if(!e)throw new Error("key must be a non-empty string");this._key=e}get key(){return this._key}update(e){this._key=e}}function LU(r,e){switch(e){case"utf-8":return _U(r);case"base64":return Bj(r);case"base64url":return OU(r);case"hex":return DU(r)}}function _U(r){return new TextEncoder().encode(r)}function Bj(r){return new Uint8Array([...atob(r)].map(e=>e.charCodeAt(0)))}function OU(r){const e=r.replace(/-/g,"+").replace(/_/g,"/");return Bj(e)}const SL=new Set("0123456789abcdefABCDEF");function DU(r){const e=new Uint8Array(r.length/2);for(let t=0;t<r.length/2;++t){const n=r[2*t],i=r[2*t+1];if(!SL.has(n)||!SL.has(i))return e.slice(0,t);e[t]=parseInt(`${n}${i}`,16)}return e}function jU(r,e){return LU(r,e)}function BU(r){return{code:r.code,message:r.message,param:r.param,type:r.type,eventId:r.event_id}}function zU(r){return{token:r.token,logprob:r.logprob,bytes:r.bytes.map(e=>e)}}function FU(r){return{type:r.type,event_id:r.eventId}}function WU(r){switch(r.type){case"session.update":return UU(r);case"session.avatar.connect":return W9(r);case"input_audio.turn.start":return U9(r);case"input_audio.turn.append":return Z9(r);case"input_audio.turn.end":return $9(r);case"input_audio.turn.cancel":return H9(r);case"input_audio.clear":return V9(r);case"input_audio_buffer.append":return q9(r);case"input_audio_buffer.commit":return G9(r);case"input_audio_buffer.clear":return K9(r);case"conversation.item.create":return Y9(r);case"conversation.item.truncate":return uZ(r);case"conversation.item.delete":return dZ(r);case"response.create":return hZ(r);case"response.cancel":return fZ(r);case"conversation.item.retrieve":return mZ(r);default:return FU(r)}}var uo;(function(r){r.SessionUpdate="session.update",r.InputAudioBufferAppend="input_audio_buffer.append",r.InputAudioBufferCommit="input_audio_buffer.commit",r.InputAudioBufferClear="input_audio_buffer.clear",r.InputAudioTurnStart="input_audio.turn.start",r.InputAudioTurnAppend="input_audio.turn.append",r.InputAudioTurnEnd="input_audio.turn.end",r.InputAudioTurnCancel="input_audio.turn.cancel",r.InputAudioClear="input_audio.clear",r.ConversationItemCreate="conversation.item.create",r.ConversationItemRetrieve="conversation.item.retrieve",r.ConversationItemTruncate="conversation.item.truncate",r.ConversationItemDelete="conversation.item.delete",r.ResponseCreate="response.create",r.ResponseCancel="response.cancel",r.SessionAvatarConnect="session.avatar.connect",r.McpApprovalResponse="mcp_approval_response"})(uo||(uo={}));function UU(r){return{type:r.type,event_id:r.eventId,session:ZU(r.session)}}function ZU(r){return{model:r.model,modalities:r.modalities?r.modalities.map(e=>e):r.modalities,animation:r.animation?$U(r.animation):r.animation,voice:r.voice?r.voice:r.voice,instructions:r.instructions,input_audio_sampling_rate:r.inputAudioSamplingRate,input_audio_format:r.inputAudioFormat,output_audio_format:r.outputAudioFormat,turn_detection:r.turnDetection?GU(r.turnDetection):r.turnDetection,input_audio_noise_reduction:r.inputAudioNoiseReduction?h9(r.inputAudioNoiseReduction):r.inputAudioNoiseReduction,input_audio_echo_cancellation:r.inputAudioEchoCancellation?f9(r.inputAudioEchoCancellation):r.inputAudioEchoCancellation,avatar:r.avatar?g9(r.avatar):r.avatar,input_audio_transcription:r.inputAudioTranscription?k9(r.inputAudioTranscription):r.inputAudioTranscription,output_audio_timestamp_types:r.outputAudioTimestampTypes?r.outputAudioTimestampTypes.map(e=>e):r.outputAudioTimestampTypes,tools:r.tools?zj(r.tools):r.tools,tool_choice:r.toolChoice?r.toolChoice:r.toolChoice,temperature:r.temperature,max_response_output_tokens:r.maxResponseOutputTokens?r.maxResponseOutputTokens:r.maxResponseOutputTokens}}var yL;(function(r){r.Text="text",r.Audio="audio",r.Animation="animation",r.Avatar="avatar"})(yL||(yL={}));function $U(r){return{model_name:r.modelName,outputs:r.outputs?r.outputs.map(e=>e):r.outputs}}function HU(r){return{modelName:r.model_name,outputs:r.outputs?r.outputs.map(e=>e):r.outputs}}var CL;(function(r){r.Blendshapes="blendshapes",r.VisemeId="viseme_id"})(CL||(CL={}));var AL;(function(r){r.Alloy="alloy",r.Ash="ash",r.Ballad="ballad",r.Coral="coral",r.Echo="echo",r.Sage="sage",r.Shimmer="shimmer",r.Verse="verse",r.Marin="marin",r.Cedar="cedar"})(AL||(AL={}));var bL;(function(r){r.AzureCustom="azure-custom",r.AzureStandard="azure-standard",r.AzurePersonal="azure-personal"})(bL||(bL={}));var xL;(function(r){r.DragonLatestNeural="DragonLatestNeural",r.PhoenixLatestNeural="PhoenixLatestNeural",r.PhoenixV2Neural="PhoenixV2Neural"})(xL||(xL={}));var TL;(function(r){r.Pcm16="pcm16",r.G711Ulaw="g711_ulaw",r.G711Alaw="g711_alaw"})(TL||(TL={}));var wL;(function(r){r.Pcm16="pcm16",r.Pcm168000Hz="pcm16-8000hz",r.Pcm1616000Hz="pcm16-16000hz",r.G711Ulaw="g711_ulaw",r.G711Alaw="g711_alaw"})(wL||(wL={}));function VU(r){return{type:r.type}}function qU(r){return{type:r.type}}function GU(r){switch(r.type){case"server_vad":return YU(r);case"azure_semantic_vad":return o9(r);case"azure_semantic_vad_en":return l9(r);case"azure_semantic_vad_multilingual":return u9(r);default:return VU(r)}}function KU(r){switch(r.type){case"server_vad":return XU(r);case"azure_semantic_vad":return a9(r);case"azure_semantic_vad_en":return c9(r);case"azure_semantic_vad_multilingual":return d9(r);default:return qU(r)}}var PL;(function(r){r.ServerVad="server_vad",r.AzureSemanticVad="azure_semantic_vad",r.AzureSemanticVadEn="azure_semantic_vad_en",r.AzureSemanticVadMultilingual="azure_semantic_vad_multilingual"})(PL||(PL={}));function YU(r){return{type:r.type,threshold:r.threshold,prefix_padding_ms:r.prefixPaddingInMs,silence_duration_ms:r.silenceDurationInMs,end_of_utterance_detection:r.endOfUtteranceDetection?gA(r.endOfUtteranceDetection):r.endOfUtteranceDetection,auto_truncate:r.autoTruncate,create_response:r.createResponse,interrupt_response:r.interruptResponse}}function XU(r){return{type:r.type,threshold:r.threshold,prefixPaddingInMs:r.prefix_padding_ms,silenceDurationInMs:r.silence_duration_ms,endOfUtteranceDetection:r.end_of_utterance_detection?vA(r.end_of_utterance_detection):r.end_of_utterance_detection,autoTruncate:r.auto_truncate,createResponse:r.create_response,interruptResponse:r.interrupt_response}}function JU(r){return{model:r.model}}function QU(r){return{model:r.model}}function gA(r){switch(r.model){case"semantic_detection_v1":return e9(r);case"semantic_detection_v1_en":return r9(r);case"semantic_detection_v1_multilingual":return i9(r);default:return JU(r)}}function vA(r){switch(r.model){case"semantic_detection_v1":return t9(r);case"semantic_detection_v1_en":return n9(r);case"semantic_detection_v1_multilingual":return s9(r);default:return QU(r)}}function e9(r){return{model:r.model,threshold_level:r.thresholdLevel,timeout_ms:r.timeoutInMs}}function t9(r){return{model:r.model,thresholdLevel:r.threshold_level,timeoutInMs:r.timeout_ms}}var EL;(function(r){r.Low="low",r.Medium="medium",r.High="high",r.Default="default"})(EL||(EL={}));function r9(r){return{model:r.model,threshold_level:r.thresholdLevel,timeout_ms:r.timeoutInMs}}function n9(r){return{model:r.model,thresholdLevel:r.threshold_level,timeoutInMs:r.timeout_ms}}function i9(r){return{model:r.model,threshold_level:r.thresholdLevel,timeout_ms:r.timeoutInMs}}function s9(r){return{model:r.model,thresholdLevel:r.threshold_level,timeoutInMs:r.timeout_ms}}function o9(r){return{type:r.type,threshold:r.threshold,prefix_padding_ms:r.prefixPaddingInMs,silence_duration_ms:r.silenceDurationInMs,end_of_utterance_detection:r.endOfUtteranceDetection?gA(r.endOfUtteranceDetection):r.endOfUtteranceDetection,speech_duration_ms:r.speechDurationInMs,remove_filler_words:r.removeFillerWords,languages:r.languages?r.languages.map(e=>e):r.languages,auto_truncate:r.autoTruncate,create_response:r.createResponse,interrupt_response:r.interruptResponse}}function a9(r){return{type:r.type,threshold:r.threshold,prefixPaddingInMs:r.prefix_padding_ms,silenceDurationInMs:r.silence_duration_ms,endOfUtteranceDetection:r.end_of_utterance_detection?vA(r.end_of_utterance_detection):r.end_of_utterance_detection,speechDurationInMs:r.speech_duration_ms,removeFillerWords:r.remove_filler_words,languages:r.languages?r.languages.map(e=>e):r.languages,autoTruncate:r.auto_truncate,createResponse:r.create_response,interruptResponse:r.interrupt_response}}function l9(r){return{type:r.type,threshold:r.threshold,prefix_padding_ms:r.prefixPaddingInMs,silence_duration_ms:r.silenceDurationInMs,end_of_utterance_detection:r.endOfUtteranceDetection?gA(r.endOfUtteranceDetection):r.endOfUtteranceDetection,speech_duration_ms:r.speechDurationInMs,remove_filler_words:r.removeFillerWords,auto_truncate:r.autoTruncate,create_response:r.createResponse,interrupt_response:r.interruptResponse}}function c9(r){return{type:r.type,threshold:r.threshold,prefixPaddingInMs:r.prefix_padding_ms,silenceDurationInMs:r.silence_duration_ms,endOfUtteranceDetection:r.end_of_utterance_detection?vA(r.end_of_utterance_detection):r.end_of_utterance_detection,speechDurationInMs:r.speech_duration_ms,removeFillerWords:r.remove_filler_words,autoTruncate:r.auto_truncate,createResponse:r.create_response,interruptResponse:r.interrupt_response}}function u9(r){return{type:r.type,threshold:r.threshold,prefix_padding_ms:r.prefixPaddingInMs,silence_duration_ms:r.silenceDurationInMs,end_of_utterance_detection:r.endOfUtteranceDetection?gA(r.endOfUtteranceDetection):r.endOfUtteranceDetection,speech_duration_ms:r.speechDurationInMs,remove_filler_words:r.removeFillerWords,languages:r.languages?r.languages.map(e=>e):r.languages,auto_truncate:r.autoTruncate,create_response:r.createResponse,interrupt_response:r.interruptResponse}}function d9(r){return{type:r.type,threshold:r.threshold,prefixPaddingInMs:r.prefix_padding_ms,silenceDurationInMs:r.silence_duration_ms,endOfUtteranceDetection:r.end_of_utterance_detection?vA(r.end_of_utterance_detection):r.end_of_utterance_detection,speechDurationInMs:r.speech_duration_ms,removeFillerWords:r.remove_filler_words,languages:r.languages?r.languages.map(e=>e):r.languages,autoTruncate:r.auto_truncate,createResponse:r.create_response,interruptResponse:r.interrupt_response}}function h9(r){return{type:r.type}}function p9(r){return{type:r.type}}function f9(r){return{type:r.type}}function m9(r){return{type:r.type}}function g9(r){return{type:r.type,ice_servers:r.iceServers?S9(r.iceServers):r.iceServers,character:r.character,style:r.style,model:r.model,customized:r.customized,video:r.video?b9(r.video):r.video,output_protocol:r.outputProtocol}}function v9(r){return{type:r.type,iceServers:r.ice_servers?y9(r.ice_servers):r.ice_servers,character:r.character,style:r.style,model:r.model,customized:r.customized,video:r.video?x9(r.video):r.video,outputProtocol:r.output_protocol}}var RL;(function(r){r.VideoAvatar="video-avatar",r.PhotoAvatar="photo-avatar"})(RL||(RL={}));function S9(r){return r.map(e=>C9(e))}function y9(r){return r.map(e=>A9(e))}function C9(r){return{urls:r.urls.map(e=>e),username:r.username,credential:r.credential}}function A9(r){return{urls:r.urls.map(e=>e),username:r.username,credential:r.credential}}var IL;(function(r){r.Vasa1="vasa-1"})(IL||(IL={}));function b9(r){return{bitrate:r.bitrate,codec:r.codec,crop:r.crop?T9(r.crop):r.crop,resolution:r.resolution?P9(r.resolution):r.resolution,background:r.background?R9(r.background):r.background,gop_size:r.gopSize}}function x9(r){return{bitrate:r.bitrate,codec:r.codec,crop:r.crop?w9(r.crop):r.crop,resolution:r.resolution?E9(r.resolution):r.resolution,background:r.background?I9(r.background):r.background,gopSize:r.gop_size}}function T9(r){return{top_left:r.topLeft.map(e=>e),bottom_right:r.bottomRight.map(e=>e)}}function w9(r){return{topLeft:r.top_left.map(e=>e),bottomRight:r.bottom_right.map(e=>e)}}function P9(r){return{width:r.width,height:r.height}}function E9(r){return{width:r.width,height:r.height}}function R9(r){return{color:r.color,image_url:r.imageUrl}}function I9(r){return{color:r.color,imageUrl:r.image_url}}var kL;(function(r){r.Webrtc="webrtc",r.Websocket="websocket"})(kL||(kL={}));function k9(r){return{model:r.model,language:r.language,custom_speech:r.customSpeech,phrase_list:r.phraseList?r.phraseList.map(e=>e):r.phraseList}}function M9(r){return{model:r.model,language:r.language,customSpeech:r.custom_speech?Object.fromEntries(Object.entries(r.custom_speech).map(([e,t])=>[e,t])):r.custom_speech,phraseList:r.phrase_list?r.phrase_list.map(e=>e):r.phrase_list}}var ML;(function(r){r.Word="word"})(ML||(ML={}));function zj(r){return r.map(e=>O9(e))}function N9(r){return r.map(e=>D9(e))}function L9(r){return{type:r.type}}function _9(r){return{type:r.type}}function O9(r){switch(r.type){case"function":return j9(r);case"mcp":return z9(r);default:return L9(r)}}function D9(r){switch(r.type){case"function":return B9(r);case"mcp":return F9(r);default:return _9(r)}}var NL;(function(r){r.Function="function",r.Mcp="mcp"})(NL||(NL={}));function j9(r){return{type:r.type,name:r.name,description:r.description,parameters:r.parameters}}function B9(r){return{type:r.type,name:r.name,description:r.description,parameters:r.parameters}}function z9(r){return{type:r.type,server_label:r.serverLabel,server_url:r.serverUrl,authorization:r.authorization,headers:r.headers,allowed_tools:r.allowedTools?r.allowedTools.map(e=>e):r.allowedTools,require_approval:r.requireApproval?r.requireApproval:r.requireApproval}}function F9(r){return{type:r.type,serverLabel:r.server_label,serverUrl:r.server_url,authorization:r.authorization,headers:r.headers?Object.fromEntries(Object.entries(r.headers).map(([e,t])=>[e,t])):r.headers,allowedTools:r.allowed_tools?r.allowed_tools.map(e=>e):r.allowed_tools,requireApproval:r.require_approval?r.require_approval:r.require_approval}}var LL;(function(r){r.Never="never",r.Always="always"})(LL||(LL={}));var _L;(function(r){r.Auto="auto",r.None="none",r.Required="required"})(_L||(_L={}));function W9(r){return{type:r.type,event_id:r.eventId,client_sdp:r.clientSdp}}function U9(r){return{type:r.type,event_id:r.eventId,turn_id:r.turnId}}function Z9(r){return{type:r.type,event_id:r.eventId,turn_id:r.turnId,audio:r.audio}}function $9(r){return{type:r.type,event_id:r.eventId,turn_id:r.turnId}}function H9(r){return{type:r.type,event_id:r.eventId,turn_id:r.turnId}}function V9(r){return{type:r.type,event_id:r.eventId}}function q9(r){return{type:r.type,event_id:r.eventId,audio:r.audio}}function G9(r){return{type:r.type,event_id:r.eventId}}function K9(r){return{type:r.type,event_id:r.eventId}}function Y9(r){return{type:r.type,event_id:r.eventId,previous_item_id:r.previousItemId,item:r.item?Fj(r.item):r.item}}function X9(r){return{type:r.type,id:r.id}}function Fj(r){switch(r.type){case"message":return Q9(r);case"function_call":return aZ(r);case"function_call_output":return lZ(r);case"mcp_approval_response":return cZ(r);default:return X9(r)}}var OL;(function(r){r.Message="message",r.FunctionCall="function_call",r.FunctionCallOutput="function_call_output",r.McpListTools="mcp_list_tools",r.McpCall="mcp_call",r.McpApprovalRequest="mcp_approval_request",r.McpApprovalResponse="mcp_approval_response"})(OL||(OL={}));function J9(r){return{type:r.type,id:r.id,role:r.role,content:SA(r.content),status:r.status}}function Q9(r){switch(r.role){case"assistant":return Wj(r);case"system":return sZ(r);case"user":return oZ(r);default:return J9(r)}}var DL;(function(r){r.System="system",r.User="user",r.Assistant="assistant"})(DL||(DL={}));function SA(r){return r.map(e=>tZ(e))}function eZ(r){return{type:r.type}}function tZ(r){switch(r.type){case"input_text":return rZ(r);case"input_audio":return nZ(r);case"text":return iZ(r);default:return eZ(r)}}var jL;(function(r){r.InputText="input_text",r.InputAudio="input_audio",r.InputImage="input_image",r.Text="text",r.Audio="audio"})(jL||(jL={}));function rZ(r){return{type:r.type,text:r.text}}function nZ(r){return{type:r.type,audio:r.audio,transcript:r.transcript}}function iZ(r){return{type:r.type,text:r.text}}var BL;(function(r){r.Completed="completed",r.Incomplete="incomplete"})(BL||(BL={}));function Wj(r){return{type:r.type,role:r.role,content:SA(r.content),status:r.status,id:r.id}}function sZ(r){return{type:r.type,role:r.role,content:SA(r.content),status:r.status,id:r.id}}function oZ(r){return{type:r.type,role:r.role,content:SA(r.content),status:r.status,id:r.id}}function aZ(r){return{type:r.type,id:r.id,name:r.name,call_id:r.callId,arguments:r.arguments,status:r.status}}function lZ(r){return{type:r.type,id:r.id,call_id:r.callId,output:r.output,status:r.status}}function cZ(r){return{type:r.type,id:r.id,approval_request_id:r.approvalRequestId,approve:r.approve}}function uZ(r){return{type:r.type,event_id:r.eventId,item_id:r.itemId,content_index:r.contentIndex,audio_end_ms:r.audioEndInMs}}function dZ(r){return{type:r.type,event_id:r.eventId,item_id:r.itemId}}function hZ(r){return{type:r.type,event_id:r.eventId,response:r.response?pZ(r.response):r.response,additional_instructions:r.additionalInstructions}}function pZ(r){return{commit:r.commit,cancel_previous:r.cancelPrevious,append_input_items:r.appendInputItems?zL(r.appendInputItems):r.appendInputItems,input_items:r.inputItems?zL(r.inputItems):r.inputItems,modalities:r.modalities?r.modalities.map(e=>e):r.modalities,instructions:r.instructions,voice:r.voice?r.voice:r.voice,output_audio_format:r.outputAudioFormat,tools:r.tools?zj(r.tools):r.tools,tool_choice:r.toolChoice,temperature:r.temperature,max_output_tokens:r.maxOutputTokens?r.maxOutputTokens:r.maxOutputTokens,pre_generated_assistant_message:r.preGeneratedAssistantMessage?Wj(r.preGeneratedAssistantMessage):r.preGeneratedAssistantMessage}}function zL(r){return r.map(e=>Fj(e))}function fZ(r){return{type:r.type,event_id:r.eventId,response_id:r.responseId}}function mZ(r){return{type:r.type,event_id:r.eventId,item_id:r.itemId}}function Uj(r){return{id:r.id,object:r.object,status:r.status,statusDetails:r.status_details?vZ(r.status_details):r.status_details,output:r.output?AZ(r.output):r.output,usage:r.usage?zZ(r.usage):r.usage,conversationId:r.conversation_id,voice:r.voice?r.voice:r.voice,modalities:r.modalities?r.modalities.map(e=>e):r.modalities,outputAudioFormat:r.output_audio_format,temperature:r.temperature,maxOutputTokens:r.max_output_tokens?r.max_output_tokens:r.max_output_tokens}}var FL;(function(r){r.Completed="completed",r.Cancelled="cancelled",r.Failed="failed",r.Incomplete="incomplete",r.InProgress="in_progress"})(FL||(FL={}));function gZ(r){return{type:r.type}}function vZ(r){switch(r.type){case"cancelled":return SZ(r);case"incomplete":return yZ(r);case"failed":return CZ(r);default:return gZ(r)}}function SZ(r){return{type:r.type,reason:r.reason}}function yZ(r){return{type:r.type,reason:r.reason}}function CZ(r){return{type:r.type,error:r.error}}function AZ(r){return r.map(e=>fy(e))}function bZ(r){return{type:r.type,id:r.id,object:r.object}}function fy(r){switch(r.type){case"message":return xZ(r);case"function_call":return MZ(r);case"function_call_output":return NZ(r);case"mcp_list_tools":return LZ(r);case"mcp_call":return DZ(r);case"mcp_approval_request":return jZ(r);case"mcp_approval_response":return BZ(r);default:return bZ(r)}}function xZ(r){return{type:r.type,id:r.id,object:r.object,role:r.role,content:TZ(r.content),status:r.status}}function TZ(r){return r.map(e=>HP(e))}function wZ(r){return{type:r.type}}function HP(r){switch(r.type){case"input_image":return PZ(r);case"input_text":return EZ(r);case"input_audio":return RZ(r);case"text":return IZ(r);case"audio":return kZ(r);default:return wZ(r)}}function PZ(r){return{type:r.type,url:r.url,detail:r.detail}}var WL;(function(r){r.Auto="auto",r.Low="low",r.High="high"})(WL||(WL={}));function EZ(r){return{type:r.type,text:r.text}}function RZ(r){return{type:r.type,transcript:r.transcript}}function IZ(r){return{type:r.type,text:r.text}}function kZ(r){return{type:r.type,transcript:r.transcript}}var UL;(function(r){r.InProgress="in_progress",r.Completed="completed",r.Incomplete="incomplete"})(UL||(UL={}));function MZ(r){return{type:r.type,id:r.id,object:r.object,name:r.name,callId:r.call_id,arguments:r.arguments,status:r.status}}function NZ(r){return{type:r.type,id:r.id,object:r.object,callId:r.call_id,output:r.output}}function LZ(r){return{type:r.type,id:r.id,object:r.object,tools:_Z(r.tools),serverLabel:r.server_label}}function _Z(r){return r.map(e=>OZ(e))}function OZ(r){return{name:r.name,description:r.description,inputSchema:r.input_schema,annotations:r.annotations}}function DZ(r){return{type:r.type,id:r.id,object:r.object,approvalRequestId:r.approval_request_id,arguments:r.arguments,serverLabel:r.server_label,name:r.name,output:r.output,error:r.error}}function jZ(r){return{type:r.type,id:r.id,object:r.object,arguments:r.arguments,name:r.name,serverLabel:r.server_label}}function BZ(r){return{type:r.type,id:r.id,object:r.object,approvalRequestId:r.approval_request_id,approve:r.approve,reason:r.reason}}function zZ(r){return{totalTokens:r.total_tokens,inputTokens:r.input_tokens,outputTokens:r.output_tokens,inputTokenDetails:FZ(r.input_token_details),outputTokenDetails:UZ(r.output_token_details)}}function FZ(r){return{cachedTokens:r.cached_tokens,textTokens:r.text_tokens,audioTokens:r.audio_tokens,imageTokens:r.image_tokens,cachedTokensDetails:WZ(r.cached_tokens_details)}}function WZ(r){return{textTokens:r.text_tokens,audioTokens:r.audio_tokens,imageTokens:r.image_tokens}}function UZ(r){return{textTokens:r.text_tokens,audioTokens:r.audio_tokens}}function ZZ(r){return{type:r.type,eventId:r.event_id}}function $Z(r){switch(r.type){case"error":return HZ(r);case"session.created":return qZ(r);case"session.updated":return KZ(r);case"session.avatar.connecting":return YZ(r);case"input_audio_buffer.committed":return XZ(r);case"input_audio_buffer.cleared":return JZ(r);case"input_audio_buffer.speech_started":return QZ(r);case"input_audio_buffer.speech_stopped":return e7(r);case"conversation.item.created":return t7(r);case"conversation.item.input_audio_transcription.completed":return r7(r);case"conversation.item.input_audio_transcription.failed":return n7(r);case"conversation.item.truncated":return i7(r);case"conversation.item.deleted":return s7(r);case"response.created":return o7(r);case"response.done":return a7(r);case"response.output_item.added":return l7(r);case"response.output_item.done":return c7(r);case"response.content_part.added":return u7(r);case"response.content_part.done":return d7(r);case"response.text.delta":return h7(r);case"response.text.done":return p7(r);case"response.audio_transcript.delta":return f7(r);case"response.audio_transcript.done":return m7(r);case"response.audio.delta":return g7(r);case"response.audio.done":return v7(r);case"response.animation_blendshapes.delta":return S7(r);case"response.animation_blendshapes.done":return y7(r);case"response.audio_timestamp.delta":return C7(r);case"response.audio_timestamp.done":return A7(r);case"response.animation_viseme.delta":return b7(r);case"response.animation_viseme.done":return x7(r);case"conversation.item.input_audio_transcription.delta":return T7(r);case"conversation.item.retrieved":return P7(r);case"response.function_call_arguments.delta":return E7(r);case"response.function_call_arguments.done":return R7(r);case"mcp_list_tools.in_progress":return I7(r);case"mcp_list_tools.completed":return k7(r);case"mcp_list_tools.failed":return M7(r);case"response.mcp_call_arguments.delta":return N7(r);case"response.mcp_call_arguments.done":return L7(r);case"response.mcp_call.in_progress":return _7(r);case"response.mcp_call.completed":return O7(r);case"response.mcp_call.failed":return D7(r);default:return ZZ(r)}}var pv;(function(r){r.Error="error",r.SessionAvatarConnecting="session.avatar.connecting",r.SessionCreated="session.created",r.SessionUpdated="session.updated",r.ConversationItemInputAudioTranscriptionCompleted="conversation.item.input_audio_transcription.completed",r.ConversationItemInputAudioTranscriptionDelta="conversation.item.input_audio_transcription.delta",r.ConversationItemInputAudioTranscriptionFailed="conversation.item.input_audio_transcription.failed",r.ConversationItemCreated="conversation.item.created",r.ConversationItemRetrieved="conversation.item.retrieved",r.ConversationItemTruncated="conversation.item.truncated",r.ConversationItemDeleted="conversation.item.deleted",r.InputAudioBufferCommitted="input_audio_buffer.committed",r.InputAudioBufferCleared="input_audio_buffer.cleared",r.InputAudioBufferSpeechStarted="input_audio_buffer.speech_started",r.InputAudioBufferSpeechStopped="input_audio_buffer.speech_stopped",r.ResponseCreated="response.created",r.ResponseDone="response.done",r.ResponseOutputItemAdded="response.output_item.added",r.ResponseOutputItemDone="response.output_item.done",r.ResponseContentPartAdded="response.content_part.added",r.ResponseContentPartDone="response.content_part.done",r.ResponseTextDelta="response.text.delta",r.ResponseTextDone="response.text.done",r.ResponseAudioTranscriptDelta="response.audio_transcript.delta",r.ResponseAudioTranscriptDone="response.audio_transcript.done",r.ResponseAudioDelta="response.audio.delta",r.ResponseAudioDone="response.audio.done",r.ResponseAnimationBlendshapesDelta="response.animation_blendshapes.delta",r.ResponseAnimationBlendshapesDone="response.animation_blendshapes.done",r.ResponseAudioTimestampDelta="response.audio_timestamp.delta",r.ResponseAudioTimestampDone="response.audio_timestamp.done",r.ResponseAnimationVisemeDelta="response.animation_viseme.delta",r.ResponseAnimationVisemeDone="response.animation_viseme.done",r.ResponseFunctionCallArgumentsDelta="response.function_call_arguments.delta",r.ResponseFunctionCallArgumentsDone="response.function_call_arguments.done",r.McpListToolsInProgress="mcp_list_tools.in_progress",r.McpListToolsCompleted="mcp_list_tools.completed",r.McpListToolsFailed="mcp_list_tools.failed",r.ResponseMcpCallArgumentsDelta="response.mcp_call_arguments.delta",r.ResponseMcpCallArgumentsDone="response.mcp_call_arguments.done",r.McpApprovalRequest="mcp_approval_request",r.McpApprovalResponse="mcp_approval_response",r.ResponseMcpCallInProgress="response.mcp_call.in_progress",r.ResponseMcpCallCompleted="response.mcp_call.completed",r.ResponseMcpCallFailed="response.mcp_call.failed"})(pv||(pv={}));function HZ(r){return{type:r.type,eventId:r.event_id,error:VZ(r.error)}}function VZ(r){return{type:r.type,code:r.code,message:r.message,param:r.param,eventId:r.event_id}}function qZ(r){return{type:r.type,eventId:r.event_id,session:Zj(r.session)}}function Zj(r){return{model:r.model,modalities:r.modalities?r.modalities.map(e=>e):r.modalities,animation:r.animation?HU(r.animation):r.animation,voice:r.voice?r.voice:r.voice,instructions:r.instructions,inputAudioSamplingRate:r.input_audio_sampling_rate,inputAudioFormat:r.input_audio_format,outputAudioFormat:r.output_audio_format,turnDetection:r.turn_detection?KU(r.turn_detection):r.turn_detection,inputAudioNoiseReduction:r.input_audio_noise_reduction?p9(r.input_audio_noise_reduction):r.input_audio_noise_reduction,inputAudioEchoCancellation:r.input_audio_echo_cancellation?m9(r.input_audio_echo_cancellation):r.input_audio_echo_cancellation,avatar:r.avatar?v9(r.avatar):r.avatar,inputAudioTranscription:r.input_audio_transcription?M9(r.input_audio_transcription):r.input_audio_transcription,outputAudioTimestampTypes:r.output_audio_timestamp_types?r.output_audio_timestamp_types.map(e=>e):r.output_audio_timestamp_types,tools:r.tools?N9(r.tools):r.tools,toolChoice:r.tool_choice?r.tool_choice:r.tool_choice,temperature:r.temperature,maxResponseOutputTokens:r.max_response_output_tokens?r.max_response_output_tokens:r.max_response_output_tokens,agent:r.agent?GZ(r.agent):r.agent,id:r.id}}function GZ(r){return{type:r.type,name:r.name,description:r.description,agentId:r.agent_id,threadId:r.thread_id}}function KZ(r){return{type:r.type,eventId:r.event_id,session:Zj(r.session)}}function YZ(r){return{type:r.type,eventId:r.event_id,serverSdp:r.server_sdp}}function XZ(r){return{type:r.type,eventId:r.event_id,previousItemId:r.previous_item_id,itemId:r.item_id}}function JZ(r){return{type:r.type,eventId:r.event_id}}function QZ(r){return{type:r.type,eventId:r.event_id,audioStartInMs:r.audio_start_ms,itemId:r.item_id}}function e7(r){return{type:r.type,eventId:r.event_id,audioEndInMs:r.audio_end_ms,itemId:r.item_id}}function t7(r){return{type:r.type,eventId:r.event_id,previousItemId:r.previous_item_id,item:r.item?fy(r.item):r.item}}function r7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id,contentIndex:r.content_index,transcript:r.transcript}}function n7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id,contentIndex:r.content_index,error:BU(r.error)}}function i7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id,contentIndex:r.content_index,audioEndInMs:r.audio_end_ms}}function s7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id}}function o7(r){return{type:r.type,eventId:r.event_id,response:Uj(r.response)}}function a7(r){return{type:r.type,eventId:r.event_id,response:Uj(r.response)}}function l7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,outputIndex:r.output_index,item:r.item?fy(r.item):r.item}}function c7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,outputIndex:r.output_index,item:r.item?fy(r.item):r.item}}function u7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index,part:HP(r.part)}}function d7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index,part:HP(r.part)}}function h7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index,delta:r.delta}}function p7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index,text:r.text}}function f7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index,delta:r.delta}}function m7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index,transcript:r.transcript}}function g7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index,delta:typeof r.delta=="string"?jU(r.delta,"base64"):r.delta}}function v7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index}}function S7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index,frames:r.frames,frameIndex:r.frame_index}}function y7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index}}function C7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index,audioOffsetInMs:r.audio_offset_ms,audioDurationInMs:r.audio_duration_ms,text:r.text,timestampType:r.timestamp_type}}function A7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index}}function b7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index,audioOffsetInMs:r.audio_offset_ms,visemeId:r.viseme_id}}function x7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,contentIndex:r.content_index}}function T7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id,contentIndex:r.content_index,delta:r.delta,logprobs:r.logprobs?w7(r.logprobs):r.logprobs}}function w7(r){return r.map(e=>zU(e))}function P7(r){return{type:r.type,eventId:r.event_id,item:r.item?fy(r.item):r.item}}function E7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,callId:r.call_id,delta:r.delta}}function R7(r){return{type:r.type,eventId:r.event_id,responseId:r.response_id,itemId:r.item_id,outputIndex:r.output_index,callId:r.call_id,arguments:r.arguments,name:r.name}}function I7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id}}function k7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id}}function M7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id}}function N7(r){return{type:r.type,eventId:r.event_id,delta:r.delta,itemId:r.item_id,responseId:r.response_id,outputIndex:r.output_index,obfuscation:r.obfuscation}}function L7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id,responseId:r.response_id,outputIndex:r.output_index,arguments:r.arguments}}function _7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id,outputIndex:r.output_index}}function O7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id,outputIndex:r.output_index}}function D7(r){return{type:r.type,eventId:r.event_id,itemId:r.item_id,outputIndex:r.output_index}}var St;(function(r){r.ConnectionFailed="CONNECTION_FAILED",r.ConnectionTimeout="CONNECTION_TIMEOUT",r.ConnectionLost="CONNECTION_LOST",r.AlreadyConnected="ALREADY_CONNECTED",r.NotConnected="NOT_CONNECTED",r.WebSocketError="WEBSOCKET_ERROR",r.AuthenticationFailed="AUTHENTICATION_FAILED",r.InvalidCredentials="INVALID_CREDENTIALS",r.Unauthorized="UNAUTHORIZED",r.Forbidden="FORBIDDEN",r.InvalidMessage="INVALID_MESSAGE",r.MessageTooLarge="MESSAGE_TOO_LARGE",r.ProtocolError="PROTOCOL_ERROR",r.BufferOverflow="BUFFER_OVERFLOW",r.OperationCancelled="OPERATION_CANCELLED",r.InvalidState="INVALID_STATE"})(St||(St={}));class lt extends Error{constructor(t,n,i="websocket",s=!1,o){super(t);q(this,"code");q(this,"context");q(this,"recoverable");q(this,"cause");q(this,"timestamp");this.name="VoiceLiveConnectionError",this.code=n,this.context=i,this.recoverable=s,this.cause=o,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,lt),Object.defineProperty(this,"message",{enumerable:!0}),Object.defineProperty(this,"name",{enumerable:!0}),Object.defineProperty(this,"stack",{enumerable:!0})}}class Dg extends lt{constructor(e,t,n){super(e,t,"authentication",!1,n),this.name="VoiceLiveAuthenticationError"}}function j7(r,e){switch(r){case 1e3:return new lt("WebSocket connection closed normally",St.ConnectionLost,"websocket_close",!1);case 1001:case 1006:return new lt(`WebSocket connection lost: ${e||"Abnormal closure"}`,St.ConnectionLost,"websocket_close",!0);case 1008:return new lt(`WebSocket policy violation: ${e}`,St.WebSocketError,"websocket_close",!1);case 1011:return new lt(`WebSocket server error: ${e}`,St.WebSocketError,"websocket_close",!0);default:return new lt(`WebSocket closed with code ${r}: ${e}`,St.ConnectionLost,"websocket_close",!0)}}function ZL(r){if(r instanceof lt)return r;if(r instanceof Error){if(r.message.includes("timeout"))return new lt(`Connection timeout: ${r.message}`,St.ConnectionTimeout,"connection",!0,r);if(r.message.includes("ECONNREFUSED")||r.message.includes("ENOTFOUND"))return new lt(`Connection failed: ${r.message}`,St.ConnectionFailed,"connection",!0,r)}return new lt(`Unknown connection error: ${r instanceof Error?r.message:String(r)}`,St.ConnectionFailed,"connection",!0,r instanceof Error?r:new Error(String(r)))}function B7(...r){if(r.length>0){const e=String(r[0]);e.includes(":error")?console.error(...r):e.includes(":warning")?console.warn(...r):e.includes(":info")?console.info(...r):e.includes(":verbose")?console.debug(...r):console.debug(...r)}}var $L={};const HL=typeof process<"u"&&$L&&$L.DEBUG||void 0;let $j,CP=[],AP=[];const zC=[];HL&&VP(HL);const vd=Object.assign(r=>Hj(r),{enable:VP,enabled:qP,disable:z7,log:B7});function VP(r){$j=r,CP=[],AP=[];const e=r.split(",").map(t=>t.trim());for(const t of e)t.startsWith("-")?AP.push(t.substring(1)):CP.push(t);for(const t of zC)t.enabled=qP(t.namespace)}function qP(r){if(r.endsWith("*"))return!0;for(const e of AP)if(VL(r,e))return!1;for(const e of CP)if(VL(r,e))return!0;return!1}function VL(r,e){if(e.indexOf("*")===-1)return r===e;let t=e;if(e.indexOf("**")!==-1){const g=[];let v="";for(const y of e)y==="*"&&v==="*"||(v=y,g.push(y));t=g.join("")}let n=0,i=0;const s=t.length,o=r.length;let a=-1,l=-1;for(;n<o&&i<s;)if(t[i]==="*"){if(a=i,i++,i===s)return!0;for(;r[n]!==t[i];)if(n++,n===o)return!1;l=n,n++,i++;continue}else if(t[i]===r[n])i++,n++;else if(a>=0){if(i=a+1,n=l+1,n===o)return!1;for(;r[n]!==t[i];)if(n++,n===o)return!1;l=n,n++,i++;continue}else return!1;const u=n===r.length,h=i===t.length,m=i===t.length-1&&t[i]==="*";return u&&(h||m)}function z7(){const r=$j||"";return VP(""),r}function Hj(r){const e=Object.assign(t,{enabled:qP(r),destroy:F7,log:vd.log,namespace:r,extend:W7});function t(...n){e.enabled&&(n.length>0&&(n[0]=`${r} ${n[0]}`),e.log(...n))}return zC.push(e),e}function F7(){const r=zC.indexOf(this);return r>=0?(zC.splice(r,1),!0):!1}function W7(r){const e=Hj(`${this.namespace}:${r}`);return e.log=this.log,e}var qL={};const bP=["verbose","info","warning","error"],GL={verbose:400,info:300,warning:200,error:100};function KL(r,e){e.log=(...t)=>{r.log(...t)}}function YL(r){return bP.includes(r)}function Vj(r){const e=new Set,t=typeof process<"u"&&qL&&qL[r.logLevelEnvVarName]||void 0;let n;const i=vd(r.namespace);i.log=(...h)=>{vd.log(...h)};function s(h){if(h&&!YL(h))throw new Error(`Unknown log level '${h}'. Acceptable values: ${bP.join(",")}`);n=h;const m=[];for(const g of e)o(g)&&m.push(g.namespace);vd.enable(m.join(","))}t&&(YL(t)?s(t):console.error(`${r.logLevelEnvVarName} set to unknown log level '${t}'; logging is not enabled. Acceptable values: ${bP.join(", ")}.`));function o(h){return!!(n&&GL[h.level]<=GL[n])}function a(h,m){const g=Object.assign(h.extend(m),{level:m});if(KL(h,g),o(g)){const v=vd.disable();vd.enable(v+","+g.namespace)}return e.add(g),g}function l(){return n}function u(h){const m=i.extend(h);return KL(i,m),{error:a(m,"error"),warning:a(m,"warning"),info:a(m,"info"),verbose:a(m,"verbose")}}return{setLogLevel:s,getLogLevel:l,createClientLogger:u,logger:i}}Vj({logLevelEnvVarName:"TYPESPEC_RUNTIME_LOG_LEVEL",namespace:"typeSpecRuntime"});const U7=Vj({logLevelEnvVarName:"AZURE_LOG_LEVEL",namespace:"azure"});function Z7(r){return U7.createClientLogger(r)}const tt=Z7("ai-voicelive");var tr;(function(r){r.Disconnected="disconnected",r.Connecting="connecting",r.Connected="connected",r.Disconnecting="disconnecting"})(tr||(tr={}));class $7{constructor(e,t,n={}){q(this,"_websocketFactory");q(this,"_options");q(this,"_eventHandlers");q(this,"_state",tr.Disconnected);q(this,"_previousState",tr.Disconnected);q(this,"_websocket");q(this,"_abortController");this._websocketFactory=e,this._options=t,this._eventHandlers=n}async connect(e){if(this._state!==tr.Connected){if(this._state===tr.Connecting)throw new lt("Connection attempt already in progress",St.InvalidState);this._setState(tr.Connecting),this._abortController=new AbortController,e&&(e.aborted?this._abortController.abort():e.addEventListener("abort",()=>{var t;(t=this._abortController)==null||t.abort()}));try{this._websocket=this._websocketFactory(),this._setupWebSocketHandlers(),await this._websocket.connect(this._options.endpoint,this._options.protocols,this._abortController.signal),this._setState(tr.Connected)}catch(t){throw this._setState(tr.Disconnected),t instanceof lt?t:new lt(`Failed to connect: ${t instanceof Error?t.message:"Unknown error"}`,St.ConnectionFailed,"connection_attempt",!0,t instanceof Error?t:new Error(String(t)))}}}async disconnect(e){var t;if(this._state!==tr.Disconnected){(t=this._abortController)==null||t.abort(),this._setState(tr.Disconnecting);try{this._websocket&&await this._websocket.disconnect(1e3,"Client disconnect")}finally{this._setState(tr.Disconnected)}}}async send(e,t){if(!this._websocket||this._state!==tr.Connected)throw new lt("Cannot send message: WebSocket not connected",St.NotConnected);return this._websocket.send(e,t)}_setupWebSocketHandlers(){this._websocket&&(tt.info("Setting up WebSocket event handlers"),this._websocket.onOpen(()=>{tt.info("WebSocket connection opened")}),this._websocket.onClose((e,t)=>{this._handleConnectionLost(e,t)}),this._websocket.onError(e=>{this._handleConnectionError(e)}),this._websocket.onMessage(e=>{var t,n;(n=(t=this._eventHandlers).onMessage)==null||n.call(t,e)}))}_handleConnectionLost(e,t){var i,s;if(this._state===tr.Disconnecting){this._setState(tr.Disconnected);return}this._setState(tr.Disconnected);let n;e===1e3?n=new lt("WebSocket connection closed unexpectedly",St.ConnectionLost,"connection_lost"):n=j7(e,t),(s=(i=this._eventHandlers).onError)==null||s.call(i,n)}_handleConnectionError(e){var n,i;const t=new lt(`WebSocket error: ${e.message}`,St.WebSocketError,"websocket_error",!0,e);(i=(n=this._eventHandlers).onError)==null||i.call(n,t)}_setState(e){var t,n;this._state!==e&&(this._previousState=this._state,this._state=e,(n=(t=this._eventHandlers).onStateChange)==null||n.call(t,e,this._previousState))}get state(){return this._state}get isConnected(){return this._state===tr.Connected}updateEventHandlers(e){Object.assign(this._eventHandlers,e)}}var xP;(function(r){r[r.Connecting=0]="Connecting",r[r.Open=1]="Open",r[r.Closing=2]="Closing",r[r.Closed=3]="Closed"})(xP||(xP={}));class H7{constructor(e={}){q(this,"_ws");q(this,"_url");q(this,"_options");q(this,"_onOpen");q(this,"_onClose");q(this,"_onMessage");q(this,"_onError");this._options={connectionTimeoutInMs:3e4,maxMessageSize:1024*1024,...e}}async connect(e,t,n){if(this._ws&&this._ws.readyState!==WebSocket.CLOSED)throw new lt("WebSocket is already connected or connecting",St.AlreadyConnected);return new Promise((i,s)=>{const o=setTimeout(()=>{s(new lt(`WebSocket connection timeout after ${this._options.connectionTimeoutInMs}ms`,St.ConnectionTimeout))},this._options.connectionTimeoutInMs),a=()=>{clearTimeout(o),this._ws&&this._ws.close(),s(new lt("WebSocket connection aborted",St.OperationCancelled))};if(n){if(n.aborted){a();return}n.addEventListener("abort",a)}try{const l=this._addHeadersToUrl(e,this._options.headers);this._ws=new WebSocket(l,t),this._ws.binaryType="arraybuffer",this._url=e,this._ws.addEventListener("open",()=>{var u;clearTimeout(o),n&&n.removeEventListener("abort",a),(u=this._onOpen)==null||u.call(this),i()}),this._ws.addEventListener("close",u=>{var h;clearTimeout(o),n&&n.removeEventListener("abort",a),(h=this._onClose)==null||h.call(this,u.code,u.reason)}),this._ws.addEventListener("message",u=>{var h,m;if(typeof u.data=="string")(h=this._onMessage)==null||h.call(this,u.data);else if(u.data instanceof ArrayBuffer)(m=this._onMessage)==null||m.call(this,u.data);else if(u.data instanceof Blob){const g=new FileReader;g.onload=()=>{var v;g.result instanceof ArrayBuffer&&((v=this._onMessage)==null||v.call(this,g.result))},g.onerror=()=>{var v;(v=this._onError)==null||v.call(this,new lt("Failed to read blob data",St.WebSocketError,"blob_read"))},g.readAsArrayBuffer(u.data)}}),this._ws.addEventListener("error",()=>{var h;clearTimeout(o),n&&n.removeEventListener("abort",a);const u=new lt("WebSocket connection failed",St.WebSocketError,"websocket_connection",!0);(h=this._onError)==null||h.call(this,u),s(u)})}catch(l){clearTimeout(o),n&&n.removeEventListener("abort",a),s(new lt(`Failed to create WebSocket: ${l instanceof Error?l.message:"Unknown error"}`,St.ConnectionFailed,"websocket_creation",!1,l instanceof Error?l:new Error(String(l))))}})}async disconnect(e=1e3,t){if(!(!this._ws||this._ws.readyState===WebSocket.CLOSED))return new Promise(n=>{const i=()=>{n()};this._ws.readyState===WebSocket.CLOSING?this._ws.addEventListener("close",i,{once:!0}):(this._ws.addEventListener("close",i,{once:!0}),this._ws.close(e,t))})}async send(e,t){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)throw new lt("WebSocket is not connected",St.NotConnected);if(t!=null&&t.aborted)throw new lt("Send operation aborted",St.OperationCancelled);return new Promise((n,i)=>{const s=()=>{i(new lt("Send operation aborted",St.OperationCancelled))};t&&t.addEventListener("abort",s,{once:!0});try{this._ws.send(e),t&&t.removeEventListener("abort",s),n()}catch(o){t&&t.removeEventListener("abort",s),i(new lt(`Failed to send WebSocket message: ${o instanceof Error?o.message:"Unknown error"}`,St.WebSocketError,"message_send",!0,o instanceof Error?o:new Error(String(o))))}})}onOpen(e){this._onOpen=e}onClose(e){this._onClose=e}onMessage(e){this._onMessage=e}onError(e){this._onError=e}get isConnected(){var e;return((e=this._ws)==null?void 0:e.readyState)===WebSocket.OPEN}get readyState(){return this._ws?this._ws.readyState:xP.Closed}get url(){return this._url}_addHeadersToUrl(e,t){if(!t||Object.keys(t).length===0)return e;const n=new URL(e);for(const[i,s]of Object.entries(t)){const o=i.toLowerCase();if(o==="authorization")n.searchParams.set("authorization",s);else if(o==="api-key")n.searchParams.set("api-key",s);else if(o==="x-ms-client-request-id")n.searchParams.set("client-request-id",s);else{if(o==="user-agent")continue;n.searchParams.set(`h-${o}`,s)}}return n.toString()}}class V7{create(e){return new H7(e)}}class q7{parseIncomingMessage(e){try{let t;e instanceof ArrayBuffer?t=new TextDecoder().decode(e):t=e;const n=JSON.parse(t);return this._isServerEvent(n)?{type:"server",event:$Z(n),raw:e}:this._isClientEvent(n)?{type:"client",event:n,raw:e}:null}catch(t){return tt.error("Failed to parse incoming message:",t),{type:"server",event:{type:pv.Error,error:{type:"error",code:"MessageParsingError",message:"Failed to parse incoming message data. "+(t instanceof Error?t.message:String(t))}},raw:e}}}serializeOutgoingMessage(e){return JSON.stringify(WU(e))}_isServerEvent(e){return e&&typeof e.type=="string"&&this._isValidServerEventType(e.type)}_isClientEvent(e){return e&&typeof e.type=="string"&&this._isValidClientEventType(e.type)}_isValidServerEventType(e){return Object.values(pv).includes(e)}_isValidClientEventType(e){return Object.values(uo).includes(e)}}function G7(r){return"key"in r&&typeof r.key=="string"}class K7{constructor(e,t){q(this,"_accessToken");q(this,"_scope");q(this,"_tokenRefreshBuffer",300*1e3);q(this,"_credential");q(this,"_isApiKey");this._credential=e,this._isApiKey=G7(e),this._scope=t||"https://cognitiveservices.azure.com/.default",tt.info("CredentialHandler initialized",{credentialType:this._isApiKey?"KeyCredential":"TokenCredential",scope:this._scope})}async getAccessToken(){if(this._isApiKey){const t=this._credential;return tt.info("Using API key for authentication"),t.key}const e=this._credential;if(this._accessToken&&this._isTokenValid(this._accessToken))return this._accessToken.token;try{tt.info("Acquiring new access token",{scope:this._scope});const t=await e.getToken(this._scope);if(!t)throw new Dg("Failed to acquire access token - credential returned null",St.AuthenticationFailed);return this._accessToken=t,tt.info("Successfully acquired access token",{expiresAt:new Date(this._accessToken.expiresOnTimestamp)}),this._accessToken.token}catch(t){throw tt.error("Failed to obtain access token",{error:t,scope:this._scope}),t instanceof Dg?t:new Dg(`Failed to obtain access token: ${t instanceof Error?t.message:"Unknown error"}`,St.AuthenticationFailed,t instanceof Error?t:new Error(String(t)))}}async getWebSocketUrl(e,t,n){const i=await this.getAccessToken(),s=new URL(e);return s.protocol=s.protocol==="https:"?"wss:":"ws:",s.pathname="/voice-live/realtime",s.searchParams.set("api-version",t),n&&s.searchParams.set("model",n),this._isApiKey&&s.searchParams.set("api-key",i),s.toString()}async getAuthHeaders(){const e=await this.getAccessToken(),t={"X-MS-Client-Request-ID":this._generateRequestId(),"User-Agent":"Azure-Voice-Live-SDK-JS/1.0.0"};return this._isApiKey?t["api-key"]=e:t.Authorization=`Bearer ${e}`,t}get credentialType(){return this._isApiKey?"key":"token"}get isApiKey(){return this._isApiKey}updateApiKey(e){if(!this._isApiKey)throw new Dg("Cannot update API key on TokenCredential",St.InvalidCredentials);const t=this._credential;if("update"in t&&typeof t.update=="function")t.update(e),tt.info("API key updated");else throw new Dg("KeyCredential does not support key updates",St.InvalidCredentials)}_isTokenValid(e){const t=e.expiresOnTimestamp,n=Date.now();return t>n+this._tokenRefreshBuffer}_generateRequestId(){return`${Date.now()}-${Math.random().toString(36).substring(2,11)}`}}class Y7{constructor(e,t){q(this,"_isActive",!0);q(this,"_handlers");q(this,"_subscriptionId");this._handlers=e,this._subscriptionId=t}get isActive(){return this._isActive}get subscriptionId(){return this._subscriptionId}async close(){this._isActive&&(this._isActive=!1,tt.info("VoiceLive subscription closed",{subscriptionId:this._subscriptionId}))}async processConnectionEvent(e,t,n){var i,s,o,a,l,u;if(this._isActive)try{switch(e){case"connected":await((s=(i=this._handlers).onConnected)==null?void 0:s.call(i,t,n));break;case"disconnected":await((a=(o=this._handlers).onDisconnected)==null?void 0:a.call(o,t,n));break;case"error":await((u=(l=this._handlers).onError)==null?void 0:u.call(l,t,n));break}}catch(h){tt.error(`Error in ${e} handler`,{error:h,subscriptionId:this._subscriptionId})}}async processServerEvent(e,t){var n,i,s,o,a,l,u,h,m,g,v,y,A,x,b,w,T,k,I,M,L,j,B,z,Z,$,U,Y,ee,X,re,G,J,ne,W,V,ce,ue,ve,se,F,te,ge,oe,pe,Be,Fe,ye,_e,de,Ae,nt,at,be,yt,li,ss,os,as,he,Qe,Ct,en,ls,cs,Du,Pl,El,ju,ta,ra,na;if(this._isActive)try{switch(await((i=(n=this._handlers).onServerEvent)==null?void 0:i.call(n,e,t)),e.type){case"session.created":await((o=(s=this._handlers).onSessionCreated)==null?void 0:o.call(s,e,t));break;case"session.updated":await((l=(a=this._handlers).onSessionUpdated)==null?void 0:l.call(a,e,t));break;case"session.avatar.connecting":await((h=(u=this._handlers).onSessionAvatarConnecting)==null?void 0:h.call(u,e,t));break;case"input_audio_buffer.committed":await((g=(m=this._handlers).onInputAudioBufferCommitted)==null?void 0:g.call(m,e,t));break;case"input_audio_buffer.cleared":await((y=(v=this._handlers).onInputAudioBufferCleared)==null?void 0:y.call(v,e,t));break;case"input_audio_buffer.speech_started":await((x=(A=this._handlers).onInputAudioBufferSpeechStarted)==null?void 0:x.call(A,e,t));break;case"input_audio_buffer.speech_stopped":await((w=(b=this._handlers).onInputAudioBufferSpeechStopped)==null?void 0:w.call(b,e,t));break;case"conversation.item.created":await((k=(T=this._handlers).onConversationItemCreated)==null?void 0:k.call(T,e,t));break;case"conversation.item.input_audio_transcription.completed":await((M=(I=this._handlers).onConversationItemInputAudioTranscriptionCompleted)==null?void 0:M.call(I,e,t));break;case"conversation.item.input_audio_transcription.failed":await((j=(L=this._handlers).onConversationItemInputAudioTranscriptionFailed)==null?void 0:j.call(L,e,t));break;case"conversation.item.input_audio_transcription.delta":await((z=(B=this._handlers).onConversationItemInputAudioTranscriptionDelta)==null?void 0:z.call(B,e,t));break;case"conversation.item.truncated":await(($=(Z=this._handlers).onConversationItemTruncated)==null?void 0:$.call(Z,e,t));break;case"conversation.item.deleted":await((Y=(U=this._handlers).onConversationItemDeleted)==null?void 0:Y.call(U,e,t));break;case"conversation.item.retrieved":await((X=(ee=this._handlers).onConversationItemRetrieved)==null?void 0:X.call(ee,e,t));break;case"response.created":await((G=(re=this._handlers).onResponseCreated)==null?void 0:G.call(re,e,t));break;case"response.done":await((ne=(J=this._handlers).onResponseDone)==null?void 0:ne.call(J,e,t));break;case"response.output_item.added":await((V=(W=this._handlers).onResponseOutputItemAdded)==null?void 0:V.call(W,e,t));break;case"response.output_item.done":await((ue=(ce=this._handlers).onResponseOutputItemDone)==null?void 0:ue.call(ce,e,t));break;case"response.content_part.added":await((se=(ve=this._handlers).onResponseContentPartAdded)==null?void 0:se.call(ve,e,t));break;case"response.content_part.done":await((te=(F=this._handlers).onResponseContentPartDone)==null?void 0:te.call(F,e,t));break;case"response.text.delta":await((oe=(ge=this._handlers).onResponseTextDelta)==null?void 0:oe.call(ge,e,t));break;case"response.text.done":await((Be=(pe=this._handlers).onResponseTextDone)==null?void 0:Be.call(pe,e,t));break;case"response.audio.delta":await((ye=(Fe=this._handlers).onResponseAudioDelta)==null?void 0:ye.call(Fe,e,t));break;case"response.audio.done":await((de=(_e=this._handlers).onResponseAudioDone)==null?void 0:de.call(_e,e,t));break;case"response.audio_transcript.delta":await((nt=(Ae=this._handlers).onResponseAudioTranscriptDelta)==null?void 0:nt.call(Ae,e,t));break;case"response.audio_transcript.done":await((be=(at=this._handlers).onResponseAudioTranscriptDone)==null?void 0:be.call(at,e,t));break;case"response.animation_blendshapes.delta":await((li=(yt=this._handlers).onResponseAnimationBlendshapeDelta)==null?void 0:li.call(yt,e,t));break;case"response.animation_blendshapes.done":await((os=(ss=this._handlers).onResponseAnimationBlendshapeDone)==null?void 0:os.call(ss,e,t));break;case"response.animation_viseme.delta":await((he=(as=this._handlers).onResponseAnimationVisemeDelta)==null?void 0:he.call(as,e,t));break;case"response.animation_viseme.done":await((Ct=(Qe=this._handlers).onResponseAnimationVisemeDone)==null?void 0:Ct.call(Qe,e,t));break;case"response.audio_timestamp.delta":await((ls=(en=this._handlers).onResponseAudioTimestampDelta)==null?void 0:ls.call(en,e,t));break;case"response.audio_timestamp.done":await((Du=(cs=this._handlers).onResponseAudioTimestampDone)==null?void 0:Du.call(cs,e,t));break;case"response.function_call_arguments.delta":await((El=(Pl=this._handlers).onResponseFunctionCallArgumentsDelta)==null?void 0:El.call(Pl,e,t));break;case"response.function_call_arguments.done":await((ta=(ju=this._handlers).onResponseFunctionCallArgumentsDone)==null?void 0:ta.call(ju,e,t));break;case"error":await((na=(ra=this._handlers).onServerError)==null?void 0:na.call(ra,e,t));break}}catch(Rl){tt.error(`Error in server event handler for ${e.type}`,{error:Rl,eventType:e.type,subscriptionId:this._subscriptionId})}}}class X7{constructor(){q(this,"_subscriptions",new Map);q(this,"_nextSubscriptionId",1)}createSubscription(e){const t=`sub_${this._nextSubscriptionId++}`,n=new Y7(e,t);return this._subscriptions.set(t,n),tt.info("VoiceLive subscription created",{subscriptionId:t}),n}removeSubscription(e){this._subscriptions.delete(e),tt.info("VoiceLive subscription removed",{subscriptionId:e})}async processConnectionEvent(e,t,n){const i=Array.from(this._subscriptions.values()).filter(s=>s.isActive);await Promise.allSettled(i.map(s=>s.processConnectionEvent(e,t,n)))}async processServerEvent(e,t){const n=Array.from(this._subscriptions.values()).filter(i=>i.isActive);await Promise.allSettled(n.map(i=>i.processServerEvent(e,t)))}async closeAll(){const e=Array.from(this._subscriptions.values());await Promise.allSettled(e.map(t=>t.close())),this._subscriptions.clear()}get activeCount(){return Array.from(this._subscriptions.values()).filter(e=>e.isActive).length}}class J7{constructor(e,t,n,i,s={}){q(this,"_endpoint");q(this,"_credentialHandler");q(this,"_options");q(this,"_messageParser");q(this,"_model");q(this,"_apiVersion");q(this,"_connectionManager");q(this,"_sessionId");q(this,"_activeTurnId");q(this,"_disposed",!1);q(this,"_subscriptionManager");this._endpoint=this._normalizeEndpoint(e),this._credentialHandler=new K7(t),this._options=this._buildDefaultOptions(s),this._messageParser=new q7,this._model=i,this._apiVersion=n,this._subscriptionManager=new X7,tt.info("VoiceLiveSession created",{endpoint:this._endpoint,model:this._model,apiVersion:n,enableDebugLogging:this._options.enableDebugLogging})}async connect(e={}){if(this._ensureNotDisposed(),this.isConnected){tt.info("VoiceLiveSession already connected");return}try{tt.info("Connecting to Voice Live service",{endpoint:this._endpoint,model:this._model});const t=await this._credentialHandler.getWebSocketUrl(this._endpoint,this._apiVersion,this._model),n=await this._credentialHandler.getAuthHeaders(),i=new V7;this._connectionManager=new $7(()=>i.create({headers:{...n},connectionTimeoutInMs:this._options.connectionTimeoutInMs,compression:!0}),{endpoint:t,connectionTimeout:e.timeoutInMs||this._options.connectionTimeoutInMs}),this._setupConnectionEventHandlers(),await this._connectionManager.connect(e.abortSignal),tt.info("Successfully connected to Voice Live service")}catch(t){throw tt.error("Failed to connect to Voice Live service",{error:t}),t instanceof lt?t:ZL(t)}}async disconnect(){if(this._connectionManager){tt.info("Disconnecting from Voice Live service");try{await this._connectionManager.disconnect()}catch(e){tt.error("Error during disconnect",{error:e})}finally{this._connectionManager=void 0,this._sessionId=void 0,this._activeTurnId=void 0,tt.info("Disconnected from Voice Live service")}}}subscribe(e){return this._ensureNotDisposed(),tt.info("Creating VoiceLive session subscription"),this._subscriptionManager.createSubscription(e)}async sendEvent(e,t={}){this._ensureConnected(),await this._sendEvent(e,t)}async updateSession(e,t={}){this._ensureConnected();const n={type:uo.SessionUpdate,session:e,eventId:this._generateEventId()};await this._sendEvent(n,t)}async sendAudio(e,t={}){this._ensureConnected();const n=this._arrayBufferToBase64(e);if(t.turnId){const i={type:uo.InputAudioTurnAppend,audio:n,turnId:t.turnId,eventId:this._generateEventId()};await this._sendEvent(i,t)}else{const i={type:uo.InputAudioBufferAppend,audio:n,eventId:this._generateEventId()};await this._sendEvent(i,t)}}async startAudioTurn(e={}){this._ensureConnected();const t=e.turnId||this._generateTurnId();this._activeTurnId=t;const n={type:uo.InputAudioTurnStart,turnId:t,eventId:this._generateEventId()};return await this._sendEvent(n,e),t}async endAudioTurn(e,t={}){this._ensureConnected();const n=e||this._activeTurnId;if(!n)throw new lt("No active audio turn to end","INVALID_STATE");const i={type:uo.InputAudioTurnEnd,turnId:n,eventId:this._generateEventId()};await this._sendEvent(i,t),n===this._activeTurnId&&(this._activeTurnId=void 0)}async addConversationItem(e,t={}){this._ensureConnected();const n={type:uo.ConversationItemCreate,item:e,eventId:this._generateEventId()};await this._sendEvent(n,t)}get isConnected(){var e;return((e=this._connectionManager)==null?void 0:e.isConnected)||!1}get connectionState(){var e;return((e=this._connectionManager)==null?void 0:e.state)||tr.Disconnected}get sessionId(){return this._sessionId}get activeTurnId(){return this._activeTurnId}async dispose(){if(!this._disposed){tt.info("Disposing VoiceLiveSession");try{await this._subscriptionManager.closeAll(),await this.disconnect()}catch(e){tt.error("Error during session disposal",{error:e})}finally{this._disposed=!0,tt.info("VoiceLiveSession disposed")}}}_buildDefaultOptions(e){return{connectionTimeoutInMs:e.connectionTimeoutInMs||3e4,enableDebugLogging:e.enableDebugLogging??!1}}_normalizeEndpoint(e){return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`https://${e}`),e.replace(/\/$/,"")}_setupConnectionEventHandlers(){this._connectionManager&&this._connectionManager.updateEventHandlers({onStateChange:(e,t)=>{tt.info("Connection state changed",{state:e,previousState:t}),e===tr.Connected&&t===tr.Connecting?this._notifyConnectionEvent("connected",{connectionId:`conn_${Date.now()}`,timestamp:new Date}):e===tr.Disconnected&&t===tr.Connected&&(this._notifyConnectionEvent("disconnected",{code:1006,reason:"Connection lost during session",wasClean:!1,timestamp:new Date}),this._markSessionAsDead("Connection lost during session - session is permanently unusable"))},onMessage:e=>{this._handleIncomingMessage(e)},onError:e=>{tt.error("Connection error - marking session as dead",{error:e}),this._notifyConnectionEvent("error",{error:e,context:"WebSocket connection error",recoverable:!1,timestamp:new Date}),this._markSessionAsDead(`Connection error: ${e.message}`)}})}_markSessionAsDead(e){this._disposed||(tt.error("Session marked as permanently dead",{reason:e}),this._disposed=!0,this._connectionManager=void 0,this._sessionId=void 0,this._activeTurnId=void 0)}_handleIncomingMessage(e){try{tt.info("Message received",{type:typeof e,size:typeof e=="string"?e.length:e.byteLength});const t=this._messageParser.parseIncomingMessage(e);t&&t.type==="server"&&this._handleServerEvent(t.event)}catch(t){tt.error("Error handling incoming message",{error:t})}}_handleServerEvent(e){var t;e.type===pv.SessionCreated&&((t=e.session)!=null&&t.id)&&(this._sessionId=e.session.id,tt.info("Session created",{sessionId:this._sessionId})),this._notifyServerEvent(e)}_notifyConnectionEvent(e,t){const n={endpoint:this._endpoint,sessionId:this._sessionId,timestamp:new Date,model:this._model};this._subscriptionManager.processConnectionEvent(e,t,n).catch(i=>{tt.error("Error processing connection event in handlers",{eventType:e,error:i})})}_notifyServerEvent(e){if(!this._sessionId)return;const t={endpoint:this._endpoint,sessionId:this._sessionId,timestamp:new Date,model:this._model,conversationId:void 0};this._subscriptionManager.processServerEvent(e,t).catch(n=>{tt.error("Error processing server event in handlers",{eventType:e.type,error:n})})}async _sendEvent(e,t){var n;if(!((n=this._connectionManager)!=null&&n.isConnected))throw new lt("Not connected to Voice Live service","NOT_CONNECTED");try{const i=this._messageParser.serializeOutgoingMessage(e);await this._connectionManager.send(i,t.abortSignal),tt.info("Sent event",{type:e.type,eventId:e.eventId})}catch(i){throw i instanceof lt?i:ZL(i)}}_ensureConnected(){if(this._ensureNotDisposed(),!this.isConnected)throw new lt("Must be connected to Voice Live service","NOT_CONNECTED")}_ensureNotDisposed(){if(this._disposed)throw new lt("Session is permanently dead and cannot be used. Create a new session to continue.","SESSION_DEAD")}_generateEventId(){return`evt_${Date.now()}_${Math.random().toString(36).substring(2,11)}`}_generateTurnId(){return`turn_${Date.now()}_${Math.random().toString(36).substring(2,11)}`}_arrayBufferToBase64(e){const t=e instanceof ArrayBuffer?new Uint8Array(e):e;let n="";for(let i=0;i<t.byteLength;i++)n+=String.fromCharCode(t[i]);return btoa(n)}}class qj{constructor(e,t,n={}){q(this,"_endpoint");q(this,"_credential");q(this,"_options");this._endpoint=this._normalizeEndpoint(e),this._credential=t,this._options=this._buildDefaultOptions(n),tt.info("VoiceLiveClient created",{endpoint:this._endpoint,apiVersion:this._options.apiVersion})}createSession(e,t){const n=typeof e=="string"?e:e.model;if(!n)throw new Error("Model name is required. Provide either a model string or RequestSession with model property.");const i={...this._options.defaultSessionOptions,...t},s=new J7(this._endpoint,this._credential,this._options.apiVersion,n,i);return typeof e!="string"&&(s._initialSessionConfig=e),tt.info("VoiceLiveSession created",{model:n}),s}async startSession(e,t){const n=this.createSession(e,t);return await n.connect(),typeof e!="string"&&await n.updateSession(e),n}get endpoint(){return this._endpoint}get apiVersion(){return this._options.apiVersion}_buildDefaultOptions(e){return{apiVersion:e.apiVersion||"2025-10-01",defaultSessionOptions:e.defaultSessionOptions||{}}}_normalizeEndpoint(e){return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`https://${e}`),e.replace(/\/$/,"")}}class Gj{constructor(){q(this,"audioContext");q(this,"analyser");q(this,"dataArray");q(this,"nextStartTime",0);q(this,"sources",[]);q(this,"animationFrameId",null);q(this,"onVolume",null);this.audioContext=new AudioContext,this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2048,this.analyser.smoothingTimeConstant=.85,this.analyser.connect(this.audioContext.destination),this.dataArray=new Uint8Array(this.analyser.frequencyBinCount)}setVolumeCallback(e){this.onVolume=e}async resume(){this.audioContext.state==="closed"&&(this.audioContext=new AudioContext,this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2048,this.analyser.smoothingTimeConstant=.85,this.analyser.connect(this.audioContext.destination),this.dataArray=new Uint8Array(this.analyser.frequencyBinCount)),this.audioContext.state!=="running"&&await this.audioContext.resume()}startVolumeMonitoring(){if(this.animationFrameId!==null)return;const e=()=>{this.analyser.getByteFrequencyData(this.dataArray);let t=0;for(let i=0;i<this.dataArray.length;i++)t+=this.dataArray[i];const n=t/this.dataArray.length;this.onVolume&&this.onVolume(n),this.sources.length>0?this.animationFrameId=requestAnimationFrame(e):(this.animationFrameId=null,this.onVolume&&this.onVolume(0))};this.animationFrameId=requestAnimationFrame(e)}enqueuePcm16(e,t=16e3){const n=MU(e),i=this.audioContext.createBuffer(1,n.length,t);i.getChannelData(0).set(n);const s=this.audioContext.createBufferSource();s.buffer=i,s.connect(this.analyser);const o=this.audioContext.currentTime;this.nextStartTime<o&&(this.nextStartTime=o);const a=this.nextStartTime;this.nextStartTime+=i.duration,s.onended=()=>{this.sources=this.sources.filter(l=>l!==s)},this.sources.push(s),s.start(a),this.startVolumeMonitoring()}stop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null);for(const e of this.sources)try{e.stop()}catch{}this.sources=[],this.nextStartTime=0,this.onVolume&&this.onVolume(0)}}const Q7={turns:0,sessionStartMs:0,inputAudioSeconds:0,cachedAudioSeconds:0,outputAudioSeconds:0,inputTextTokens:0,cachedTextTokens:0,outputTextTokens:0,inputAudioTokens:0,cachedAudioTokens:0,outputAudioTokens:0,startLatencies:[],endLatencies:[]};function e$(r,e){const t=r.inputAudioTokens+e.inputTokenDetails.audioTokens,n=r.outputAudioTokens+e.outputTokenDetails.audioTokens;return{...r,inputTextTokens:r.inputTextTokens+e.inputTokenDetails.textTokens,inputAudioTokens:t,inputAudioSeconds:t/10,cachedTextTokens:r.cachedTextTokens+e.inputTokenDetails.cachedTokensDetails.textTokens,cachedAudioTokens:r.cachedAudioTokens+e.inputTokenDetails.cachedTokensDetails.audioTokens,outputTextTokens:r.outputTextTokens+e.outputTokenDetails.textTokens,outputAudioTokens:n,outputAudioSeconds:n/20}}function t$(r,e){if(r.length===0)return 0;const t=[...r].sort((i,s)=>i-s),n=Math.ceil(e/100*t.length)-1;return t[Math.max(0,n)]}function XL(r){return r.length===0?0:r.reduce((e,t)=>e+t,0)/r.length}const r$={pro:{text:{inputText:5.5,cachedText:2.75,outputText:22,inputAudio:17,cachedAudio:2.75,outputAudio:38},"azure-standard":{inputText:5.5,cachedText:2.75,outputText:22,inputAudio:17,cachedAudio:2.75,outputAudio:38},"native-audio":{inputText:5.5,cachedText:2.75,outputText:22,inputAudio:44,cachedAudio:2.75,outputAudio:88}},standard:{text:{inputText:.66,cachedText:.33,outputText:2.64,inputAudio:15,cachedAudio:.33,outputAudio:33},"azure-standard":{inputText:.66,cachedText:.33,outputText:2.64,inputAudio:15,cachedAudio:.33,outputAudio:33},"native-audio":{inputText:.66,cachedText:.33,outputText:2.64,inputAudio:11,cachedAudio:.33,outputAudio:22}},lite:{text:{inputText:.11,cachedText:.04,outputText:.44,inputAudio:15,cachedAudio:.04,outputAudio:33},"azure-standard":{inputText:.11,cachedText:.04,outputText:.44,inputAudio:15,cachedAudio:.04,outputAudio:33},"native-audio":{inputText:.11,cachedText:.04,outputText:.44,inputAudio:4,cachedAudio:.04,outputAudio:8}}};function n$(r,e="standard",t="azure-standard"){const n=t==="openai"?"native-audio":"azure-standard",i=r$[e][n],s=r.inputTextTokens/1e6*i.inputText,o=r.cachedTextTokens/1e6*i.cachedText,a=r.outputTextTokens/1e6*i.outputText,l=r.inputAudioTokens/1e6*i.inputAudio,u=r.cachedAudioTokens/1e6*i.cachedAudio,h=r.outputAudioTokens/1e6*i.outputAudio;return s+o+a+l+u+h}class i${constructor(e){q(this,"client");q(this,"session");q(this,"subscription");q(this,"state",{isConnected:!1,isMicOn:!1,logs:[],turns:[],totals:Q7});q(this,"turnMap",new Map);q(this,"pcmPlayer",new Gj);q(this,"outputSampleRateHz",24e3);q(this,"currentSpeechStartMs",0);q(this,"currentSpeechStopMs",0);q(this,"events");this.events=e}get snapshot(){return this.state}setState(e){this.state={...this.state,...e},this.events.onState(this.state)}log(e,t){const n={id:`${Date.now()}_${Math.random().toString(16).slice(2)}`,ts:Date.now(),level:e,text:t},i=[...this.state.logs,n].slice(-2e3);this.setState({logs:i})}async connect(e){if(this.state.isConnected)return;if(!e.endpoint.trim())throw new Error("Missing endpoint");if(!e.apiKey.trim())throw new Error("Missing API key");this.log("info","Connecting"),this.client=new qj(e.endpoint.trim(),new jj(e.apiKey.trim()),{apiVersion:"2025-10-01",defaultSessionOptions:{enableDebugLogging:!1}});const t=gL(e);this.outputSampleRateHz=vL(t.outputAudioFormat),this.session=await this.client.startSession(t,{connectionTimeoutInMs:3e4}),await this.pcmPlayer.resume();const n={onConnected:async(i,s)=>{console.log("[VoiceLive Event] onConnected",{args:i,context:s}),this.log("info",`Connected (sessionId=${s.sessionId??"n/a"})`)},onDisconnected:async i=>{console.log("[VoiceLive Event] onDisconnected",i),this.log("info",`Disconnected (code=${i.code} reason=${i.reason})`)},onServerError:async i=>{console.log("[VoiceLive Event] onServerError",i),this.log("error",`Server error: ${i.error.message}`)},onConversationItemInputAudioTranscriptionDelta:async i=>{console.log("[VoiceLive Event] onConversationItemInputAudioTranscriptionDelta",i),i.delta&&this.log("input",i.delta)},onConversationItemInputAudioTranscriptionCompleted:async i=>{console.log("[VoiceLive Event] onConversationItemInputAudioTranscriptionCompleted",i),this.log("input",` ${i.transcript}`)},onInputAudioBufferSpeechStarted:async()=>{console.log("[VoiceLive Event] onInputAudioBufferSpeechStarted"),this.currentSpeechStartMs=Date.now(),this.log("info","Speech detected")},onInputAudioBufferSpeechStopped:async()=>{console.log("[VoiceLive Event] onInputAudioBufferSpeechStopped"),this.currentSpeechStopMs=Date.now(),this.log("info","Speech stopped")},onResponseCreated:async i=>{console.log("[VoiceLive Event] onResponseCreated",i);const s=i.response.id??`resp_${Date.now()}`,o={responseId:s,startedAtMs:Date.now(),speechStartedAtMs:this.currentSpeechStartMs,speechStoppedAtMs:this.currentSpeechStopMs};this.turnMap.set(s,{metrics:o,textBuffer:""}),this.log("info",`Response created (${s})`)},onResponseTextDelta:async i=>{console.log("[VoiceLive Event] onResponseTextDelta",i);const s=this.turnMap.get(i.responseId);s&&(s.metrics.firstTextDeltaAtMs||(s.metrics.firstTextDeltaAtMs=Date.now(),s.metrics.firstTokenLatencyMs=s.metrics.firstTextDeltaAtMs-s.metrics.startedAtMs),s.textBuffer+=i.delta,this.turnMap.set(i.responseId,s),this.events.onState(this.state))},onResponseTextDone:async i=>{console.log("[VoiceLive Event] onResponseTextDone",i);const s=i.responseId,o=this.turnMap.get(s),a=(i.text??"").trim();a&&(o&&(o.textBuffer=a,o.ttsLogged=!0,this.turnMap.set(s,o)),this.log("output",` ${a}`))},onResponseAudioDelta:async i=>{console.log("[VoiceLive Event] onResponseAudioDelta",{...i,delta:i.delta instanceof Uint8Array?`Uint8Array(${i.delta.length})`:i.delta});const s=i.delta;if(s instanceof Uint8Array){const o=this.turnMap.get(i.responseId);if(o&&!o.metrics.firstAudioDeltaAtMs){const a=Date.now();o.metrics.firstAudioDeltaAtMs=a,o.metrics.speechStartedAtMs&&(o.metrics.startLatencyMs=a-o.metrics.speechStartedAtMs),o.metrics.speechStoppedAtMs&&(o.metrics.endLatencyMs=a-o.metrics.speechStoppedAtMs),this.turnMap.set(i.responseId,o)}this.pcmPlayer.enqueuePcm16(s,this.outputSampleRateHz)}},onResponseDone:async i=>{console.log("[VoiceLive Event] onResponseDone",i);const s=i.response.id??"unknown",o=this.turnMap.get(s),a=Date.now();if(o){o.metrics.finishedAtMs=a,o.metrics.latencyMs=a-o.metrics.startedAtMs,o.metrics.assistantText=o.textBuffer.trim(),o.metrics.usage=i.response.usage;const l=[...this.state.turns,o.metrics];let u={...this.state.totals};if(u.turns=u.turns+1,o.metrics.startLatencyMs&&(u.startLatencies=[...u.startLatencies,o.metrics.startLatencyMs]),o.metrics.endLatencyMs&&(u.endLatencies=[...u.endLatencies,o.metrics.endLatencyMs]),i.response.usage&&(u=e$(u,i.response.usage),u.cachedAudioSeconds=u.cachedAudioTokens/10),this.setState({turns:l,totals:u}),this.log("info",`Turn latency: ${o.metrics.latencyMs??0}ms; first-token: ${o.metrics.firstTokenLatencyMs??0}ms`),!o.ttsLogged){let h="(no text)";if(i.response.output&&i.response.output.length>0){const m=i.response.output[0];if(m!=null&&m.content&&Array.isArray(m.content)){const g=m.content.find(v=>v.type==="audio"&&v.transcript);g!=null&&g.transcript&&(h=g.transcript)}}this.log("output",` ${h}`)}i.response.usage&&this.log("info",`Usage: in=${i.response.usage.inputTokens} out=${i.response.usage.outputTokens} total=${i.response.usage.totalTokens}`)}else this.log("info",`Response done (${s})`);this.turnMap.delete(s)},onError:async i=>{console.log("[VoiceLive Event] onError",i),this.log("error",`${i.context}: ${i.error.message}`)}};this.subscription=this.session.subscribe(n),await this.session.updateSession(t),this.setState({isConnected:!0,totals:{...this.state.totals,sessionStartMs:Date.now()}}),this.log("info",`Session configured (model=${e.model})`)}async disconnect(){var e,t;this.setState({isMicOn:!1});try{this.pcmPlayer.stop(),await((e=this.subscription)==null?void 0:e.close()),this.subscription=void 0,await((t=this.session)==null?void 0:t.dispose()),this.session=void 0,this.client=void 0}finally{this.turnMap.clear(),this.setState({isConnected:!1}),this.log("info","Disconnected")}}async applyConfig(e){if(!this.session)throw new Error("Not connected");const t=gL(e);this.outputSampleRateHz=vL(t.outputAudioFormat),await this.session.updateSession(t),this.log("info","Session updated")}async sendText(e){if(!this.session)throw new Error("Not connected");const t=e.trim();t&&(this.log("user",t),await this.session.addConversationItem({type:"message",role:"user",content:[{type:"input_text",text:t}]}),await this.session.sendEvent({type:"response.create",response:{modalities:["text","audio"]}}))}async sendMicPcmChunk(e){this.session&&await this.session.sendAudio(e)}}function JL(r){return Number.isFinite(r)?r<1e3?`${r.toFixed(0)}ms`:`${(r/1e3).toFixed(2)}s`:"-"}function s$({endpoint:r,apiKey:e}){var ss,os,as;const[t,n]=O.useState(()=>{var Qe;const he=localStorage.getItem("voicelive.translator.config");if(!he){const Ct={..._T};return Ct.prompt=ld(Ct.targetLanguage),Ct}try{const Ct=JSON.parse(he),en={..._T,...Ct};return en.prompt=(Qe=en.prompt)!=null&&Qe.trim()?en.prompt:ld(en.targetLanguage),en}catch{const Ct={..._T};return Ct.prompt=ld(Ct.targetLanguage),Ct}}),[i,s]=O.useState(""),[o,a]=O.useState(!1),[l,u]=O.useState(!1),[h,m]=O.useState([]),[g,v]=O.useState(!1),[y,A]=O.useState(!1),[x,b]=O.useState(()=>0),[w,T]=O.useState(()=>0),[k,I]=O.useState(()=>0),[M,L]=O.useState(()=>0),[j,B]=O.useState(()=>0),[z,Z]=O.useState(()=>0),[$,U]=O.useState(()=>0),[Y,ee]=O.useState(()=>0),[X,re]=O.useState(()=>0),[G,J]=O.useState(()=>0),[ne,W]=O.useState(()=>0),[V,ce]=O.useState(()=>[]),[ue,ve]=O.useState(()=>[]),se=O.useRef(null),F=O.useRef(null),te=O.useRef(null),ge=O.useRef(t.targetLanguage);se.current||(se.current=new i$({onState:he=>{a(he.isConnected),m(he.logs),b(he.totals.turns),T(he.totals.sessionStartMs),I(he.totals.inputAudioSeconds),L(he.totals.inputAudioTokens),B(he.totals.cachedAudioSeconds),Z(he.totals.cachedAudioTokens),U(he.totals.outputAudioSeconds),ee(he.totals.outputAudioTokens),re(he.totals.inputTextTokens),J(he.totals.cachedTextTokens),W(he.totals.outputTextTokens),ce(he.totals.startLatencies),ve(he.totals.endLatencies)}}));const oe=se.current;O.useEffect(()=>{localStorage.setItem("voicelive.translator.config",JSON.stringify(t))},[t]),O.useEffect(()=>()=>{const he=se.current;he!=null&&he.snapshot.isConnected&&(console.log("[VoiceLive Translator] Disconnecting on unmount"),he.disconnect().catch(console.error))},[]),O.useEffect(()=>{const he=ge.current;if(he===t.targetLanguage)return;const Qe=ld(he);t.prompt.trim()===Qe.trim()&&n(Ct=>({...Ct,prompt:ld(Ct.targetLanguage)})),ge.current=t.targetLanguage},[t.targetLanguage,t.prompt]),O.useEffect(()=>{const he=te.current;he&&(he.scrollTop=he.scrollHeight)},[h.length]);const pe=w>0?(Date.now()-w)/1e3:0,Be=V.length>0?XL(V):0,Fe=V.length>0?t$(V,90):0;ue.length>0&&XL(ue);const ye=O.useMemo(()=>{const he=mL.find(Qe=>Qe.id===t.model);return!he||he.tier==="basic"?"standard":he.tier},[t.model]),_e=n$({inputAudioTokens:M,cachedAudioTokens:z,outputAudioTokens:Y,inputTextTokens:X,cachedTextTokens:G,outputTextTokens:ne},ye,t.voiceProvider),de=pe>0?_e/pe:0,Ae=O.useMemo(()=>g?h:h.filter(he=>he.level!=="info"),[h,g]),nt=O.useMemo(()=>{var Qe;const he={};for(const Ct of mL)he[Qe=Ct.tier]??(he[Qe]=[]),he[Ct.tier].push(Ct.id);return he},[]);async function at(){s("Connecting");try{await oe.connect({...t,endpoint:r,apiKey:e}),s("Connected"),await yt()}catch(he){s(he instanceof Error?he.message:String(he))}}async function be(){s("Disconnecting");try{await li(),await oe.disconnect(),s("Disconnected")}catch(he){s(he instanceof Error?he.message:String(he))}}async function yt(){if(!l){if(!oe.snapshot.isConnected){s("Connect first");return}F.current=new NU({sampleRate:16e3,bufferSize:4096},{onChunk:he=>{oe.sendMicPcmChunk(he)},onState:(he,Qe)=>{he==="started"&&u(!0),he==="stopped"&&u(!1),he==="error"&&s(Qe??"Mic error")}}),await F.current.start()}}async function li(){if(!F.current){u(!1);return}await F.current.stop(),F.current=null,u(!1)}return f.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[f.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[f.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 shadow-md",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold",children:"Voice Live Translator"}),f.jsx("p",{className:"text-blue-100 mt-1",children:"Real-time voice translation powered by Azure Voice Live"})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${o?"bg-green-500/20 text-green-100":"bg-white/20 text-white/80"}`,children:[f.jsx("span",{className:`w-2 h-2 rounded-full ${o?"bg-green-400":"bg-white/60"}`}),o?"Connected":"Disconnected"]}),l&&f.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium bg-red-500/20 text-red-100",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-red-400 animate-pulse"}),"Recording"]})]})]})}),f.jsx("div",{className:"bg-white border-b border-gray-200 p-4",children:f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3",children:[f.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Turns"}),f.jsx("p",{className:"text-sm font-semibold text-gray-900",children:x})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Session"}),f.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[pe.toFixed(1),"s"]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Cost"}),f.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["$",_e.toFixed(4)]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Cost/sec"}),f.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["$",de.toFixed(5)]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Avg Latency"}),f.jsx("p",{className:"text-sm font-semibold text-gray-900",children:JL(Be)})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"P90 Latency"}),f.jsx("p",{className:"text-sm font-semibold text-gray-900",children:JL(Fe)})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Input Audio"}),f.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[k.toFixed(1),"s"]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Output Audio"}),f.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[$.toFixed(1),"s"]})]})]})}),f.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden p-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("h2",{className:"font-medium text-gray-900",children:"Conversation Log"}),f.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[f.jsx("input",{type:"checkbox",checked:g,onChange:he=>v(he.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Show INFO"]})]}),f.jsxs("div",{ref:te,className:"flex-1 overflow-y-auto bg-gray-900 rounded-lg p-4 font-mono text-sm",children:[Ae.map(he=>f.jsxs("div",{className:"flex gap-2 py-0.5",children:[f.jsx("span",{className:"text-gray-500 shrink-0",children:new Date(he.ts).toLocaleTimeString()}),f.jsx("span",{className:`shrink-0 w-14 ${he.level==="error"?"text-red-400":he.level==="input"?"text-blue-400":he.level==="output"?"text-green-400":he.level==="user"?"text-yellow-400":"text-gray-400"}`,children:he.level.toUpperCase()}),f.jsx("span",{className:"text-gray-100 break-all",children:he.text})]},he.id)),Ae.length===0&&f.jsx("p",{className:"text-gray-500 text-center py-8",children:"No logs yet. Click Start to begin translation."})]})]}),f.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:f.jsx("div",{className:"flex items-center justify-between",children:f.jsx("p",{className:"text-xs text-gray-600",children:i||"Ready to translate"})})})]}),f.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-y-auto",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuration"}),f.jsxs("div",{className:"space-y-4 flex-1",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model"}),f.jsxs("select",{value:t.model,onChange:he=>n(Qe=>({...Qe,model:he.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("optgroup",{label:"Voice Live Pro",children:(ss=nt.pro)==null?void 0:ss.map(he=>f.jsx("option",{value:he,children:he},he))}),f.jsx("optgroup",{label:"Voice Live Basic",children:(os=nt.basic)==null?void 0:os.map(he=>f.jsx("option",{value:he,children:he},he))}),f.jsx("optgroup",{label:"Voice Live Lite",children:(as=nt.lite)==null?void 0:as.map(he=>f.jsx("option",{value:he,children:he},he))})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Language"}),f.jsx("select",{value:t.targetLanguage,onChange:he=>n(Qe=>({...Qe,targetLanguage:he.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:RU.map(he=>f.jsxs("option",{value:he.code,children:[he.label," (",he.code,")"]},he.code))})]}),f.jsx("div",{className:"pt-2",children:o?f.jsxs("button",{onClick:be,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M6 6h12v12H6z"})}),"Stop"]}):f.jsxs("button",{onClick:at,disabled:!r||!e,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Translation"]})}),o&&f.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-md ${l?"bg-green-50 border border-green-200":"bg-gray-100 border border-gray-200"}`,children:[f.jsx("svg",{className:`w-5 h-5 ${l?"text-green-600":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),f.jsx("span",{className:`text-sm font-medium ${l?"text-green-700":"text-gray-500"}`,children:l?"Microphone active":"Microphone off"})]}),f.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[f.jsxs("button",{onClick:()=>A(!y),className:"flex items-center justify-between w-full text-sm font-medium text-gray-700",children:[f.jsx("span",{children:"Advanced Settings"}),f.jsx("svg",{className:`w-5 h-5 transition-transform ${y?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),y&&f.jsxs("div",{className:"mt-4 space-y-4",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prompt"}),f.jsx("button",{onClick:()=>n(he=>({...he,prompt:ld(he.targetLanguage)})),className:"text-xs text-blue-600 hover:text-blue-800",children:"Reset"})]}),f.jsx("textarea",{value:t.prompt,onChange:he=>n(Qe=>({...Qe,prompt:he.target.value})),rows:6,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ASR Model"}),f.jsxs("select",{value:t.asrModel,onChange:he=>n(Qe=>({...Qe,asrModel:he.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"azure-speech",children:"azure-speech"}),f.jsx("option",{value:"gpt-4o-mini-transcribe",children:"gpt-4o-mini-transcribe"}),f.jsx("option",{value:"gpt-4o-transcribe",children:"gpt-4o-transcribe"}),f.jsx("option",{value:"whisper-1",children:"whisper-1"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ASR Languages"}),f.jsx("input",{type:"text",value:t.asrLanguages,onChange:he=>n(Qe=>({...Qe,asrLanguages:he.target.value})),placeholder:"en,zh or en-US,zh-CN",disabled:t.asrModel!=="azure-speech",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Voice Provider"}),f.jsxs("select",{value:t.voiceProvider,onChange:he=>{const Qe=he.target.value;n(Ct=>({...Ct,voiceProvider:Qe,voiceName:Qe==="openai"?"alloy":"en-US-AvaMultilingualNeural"}))},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"openai",children:"OpenAI"}),f.jsx("option",{value:"azure-standard",children:"Azure Neural"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Voice"}),f.jsx("select",{value:t.voiceName,onChange:he=>n(Qe=>({...Qe,voiceName:he.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:t.voiceProvider==="openai"?f.jsxs(f.Fragment,{children:[f.jsx("option",{value:"alloy",children:"Alloy (OpenAI)"}),f.jsx("option",{value:"echo",children:"Echo (OpenAI)"}),f.jsx("option",{value:"fable",children:"Fable (OpenAI)"}),f.jsx("option",{value:"nova",children:"Nova (OpenAI)"}),f.jsx("option",{value:"shimmer",children:"Shimmer (OpenAI)"})]}):f.jsxs(f.Fragment,{children:[f.jsx("option",{value:"en-US-AvaMultilingualNeural",children:"Ava (Female, conversational)"}),f.jsx("option",{value:"en-US-Ava:DragonHDLatestNeural",children:"Ava HD (Female, friendly)"}),f.jsx("option",{value:"en-US-AndrewMultilingualNeural",children:"Andrew (Male, conversational)"}),f.jsx("option",{value:"en-US-GuyMultilingualNeural",children:"Guy (Male, professional)"}),f.jsx("option",{value:"zh-CN-XiaochenMultilingualNeural",children:"Xiaochen (Female, assistant)"})]})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Turn Detection"}),f.jsxs("select",{value:t.turnDetectionType,onChange:he=>n(Qe=>({...Qe,turnDetectionType:he.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"server_vad",children:"server_vad"}),f.jsx("option",{value:"azure_semantic_vad",children:"azure_semantic_vad"})]})]})]})]})]})]})]})}const o$={enabled:!1,type:"video",character:"lisa",style:"casual-sitting",customized:!1},OT={endpoint:"",apiKey:"",model:"gpt-realtime",instructions:`You are a helpful and friendly AI assistant. Be concise and natural in your responses.

Please only respond in English.

Before calling weather, say something to acknowledge in A FEW words.`,voice:"en-us-ava:DragonHDLatestNeural",recognitionLanguage:"auto",turnDetectionType:"server_vad",removeFillerWords:!1,useNoiseSuppression:!1,useEchoCancellation:!1,temperature:.9,avatar:{...o$},enableFunctionCalling:!0,functions:{enableDateTime:!0,enableWeatherForecast:!0}},a$=[{id:"gpt-realtime",name:"GPT Realtime"},{id:"gpt-realtime-mini",name:"GPT Realtime Mini"},{id:"gpt-4o",name:"GPT-4o"},{id:"gpt-4o-mini",name:"GPT-4o Mini"},{id:"gpt-4.1",name:"GPT-4.1"},{id:"gpt-4.1-mini",name:"GPT-4.1 Mini"},{id:"gpt-5-chat",name:"GPT-5"},{id:"gpt-5-mini",name:"GPT-5 Mini"}],l$=[{code:"auto",name:"Auto Detect"},{code:"en-US",name:"English (US)"},{code:"en-GB",name:"English (UK)"},{code:"zh-CN",name:"Chinese (Simplified)"},{code:"zh-TW",name:"Chinese (Traditional)"},{code:"ja-JP",name:"Japanese"},{code:"ko-KR",name:"Korean"},{code:"de-DE",name:"German"},{code:"fr-FR",name:"French"},{code:"es-ES",name:"Spanish (Spain)"},{code:"es-MX",name:"Spanish (Mexico)"},{code:"it-IT",name:"Italian"},{code:"pt-BR",name:"Portuguese (Brazil)"},{code:"hi-IN",name:"Hindi"}],QL=[{id:"en-us-ava:DragonHDLatestNeural",name:"Ava (DragonHD)"},{id:"en-us-andrew:DragonHDLatestNeural",name:"Andrew (DragonHD)"},{id:"en-us-emma:DragonHDLatestNeural",name:"Emma (DragonHD)"},{id:"en-us-steffan:DragonHDLatestNeural",name:"Steffan (DragonHD)"},{id:"zh-cn-xiaochen:DragonHDLatestNeural",name:"Xiaochen (DragonHD)"},{id:"ja-jp-masaru:DragonHDLatestNeural",name:"Masaru (DragonHD)"},{id:"de-DE-Seraphina:DragonHDLatestNeural",name:"Seraphina (DragonHD)"},{id:"en-US-AvaMultilingualNeural",name:"Ava Multilingual"},{id:"en-US-AndrewMultilingualNeural",name:"Andrew Multilingual"},{id:"en-US-EmmaMultilingualNeural",name:"Emma Multilingual"},{id:"en-US-BrianMultilingualNeural",name:"Brian Multilingual"},{id:"zh-CN-XiaoxiaoMultilingualNeural",name:"Xiaoxiao Multilingual"},{id:"en-us-phoebe:MAI-Voice-1",name:"Phoebe (MAI)"},{id:"en-us-benjamin:MAI-Voice-1",name:"Benjamin (MAI)"},{id:"alloy",name:"Alloy (OpenAI)"},{id:"ash",name:"Ash (OpenAI)"},{id:"ballad",name:"Ballad (OpenAI)"},{id:"coral",name:"Coral (OpenAI)"},{id:"echo",name:"Echo (OpenAI)"},{id:"sage",name:"Sage (OpenAI)"},{id:"shimmer",name:"Shimmer (OpenAI)"},{id:"verse",name:"Verse (OpenAI)"}];function Kj(r=!1){return r?QL:QL.filter(e=>!e.id.includes(":MAI-Voice-"))}Kj(!1);const U0=[{id:"lisa-casual-sitting",name:"Lisa (Casual Sitting)",character:"lisa",style:"casual-sitting"},{id:"harry-business",name:"Harry (Business)",character:"harry",style:"business"},{id:"harry-casual",name:"Harry (Casual)",character:"harry",style:"casual"},{id:"harry-youthful",name:"Harry (Youthful)",character:"harry",style:"youthful"},{id:"jeff-business",name:"Jeff (Business)",character:"jeff",style:"business"},{id:"jeff-formal",name:"Jeff (Formal)",character:"jeff",style:"formal"},{id:"lori-casual",name:"Lori (Casual)",character:"lori",style:"casual"},{id:"lori-formal",name:"Lori (Formal)",character:"lori",style:"formal"},{id:"lori-graceful",name:"Lori (Graceful)",character:"lori",style:"graceful"},{id:"max-business",name:"Max (Business)",character:"max",style:"business"},{id:"max-casual",name:"Max (Casual)",character:"max",style:"casual"},{id:"max-formal",name:"Max (Formal)",character:"max",style:"formal"},{id:"meg-business",name:"Meg (Business)",character:"meg",style:"business"},{id:"meg-casual",name:"Meg (Casual)",character:"meg",style:"casual"},{id:"meg-formal",name:"Meg (Formal)",character:"meg",style:"formal"}],e_=[{id:"adrian",name:"Adrian"},{id:"amara",name:"Amara"},{id:"amira",name:"Amira"},{id:"anika",name:"Anika"},{id:"bianca",name:"Bianca"},{id:"camila",name:"Camila"},{id:"carlos",name:"Carlos"},{id:"clara",name:"Clara"},{id:"darius",name:"Darius"},{id:"diego",name:"Diego"},{id:"elise",name:"Elise"},{id:"farhan",name:"Farhan"},{id:"faris",name:"Faris"},{id:"gabrielle",name:"Gabrielle"},{id:"hyejin",name:"Hyejin"},{id:"imran",name:"Imran"},{id:"isabella",name:"Isabella"},{id:"layla",name:"Layla"},{id:"ling",name:"Ling"},{id:"liwei",name:"Liwei"},{id:"marcus",name:"Marcus"},{id:"matteo",name:"Matteo"},{id:"rahul",name:"Rahul"},{id:"rana",name:"Rana"},{id:"ren",name:"Ren"},{id:"riya",name:"Riya"},{id:"sakura",name:"Sakura"},{id:"simone",name:"Simone"},{id:"zayd",name:"Zayd"},{id:"zoe",name:"Zoe"}];function t_(){return`${Date.now()}_${Math.random().toString(16).slice(2)}`}class c${constructor(e){q(this,"client");q(this,"session");q(this,"subscription");q(this,"pcmPlayer",new Gj);q(this,"peerConnection");q(this,"avatarConfig");q(this,"pendingIceServers");q(this,"state",{isConnected:!1,isRecording:!1,isSpeaking:!1,isAvatarConnected:!1,messages:[],statusText:"",sessionId:""});q(this,"currentResponseText","");q(this,"currentResponseId","");q(this,"currentResponseMessageId","");q(this,"currentFunctionCallName","");q(this,"currentFunctionCallArgs","");q(this,"currentFunctionCallId","");q(this,"pendingFunctionResult",null);q(this,"currentUserTranscript","");q(this,"currentUserMessageId","");q(this,"isResponseInProgress",!1);q(this,"events");this.events=e}get snapshot(){return this.state}setPlaybackVolumeCallback(e){this.pcmPlayer.setVolumeCallback(e)}setState(e){this.state={...this.state,...e},this.events.onState(this.state)}addMessage(e,t){const n={id:t_(),type:e,content:t,timestamp:Date.now()};return this.setState({messages:[...this.state.messages,n]}),n.id}updateLastMessage(e){console.log("[VoiceLive Chat] Updating last message with:",e);const t=[...this.state.messages];if(t.length>0){const n=t[t.length-1];console.log("[VoiceLive Chat] Last message type:",n.type),t[t.length-1]={...n,content:e},this.setState({messages:t})}else console.warn("[VoiceLive Chat] No messages to update!")}updateMessageById(e,t){const n=[...this.state.messages],i=n.findIndex(s=>s.id===e);i!==-1?(n[i]={...n[i],content:t},this.setState({messages:n})):console.warn("[VoiceLive Chat] Message not found:",e)}async sendPendingFunctionResult(){if(this.pendingFunctionResult&&this.session){console.log("[VoiceLive Chat] Sending pending function result to server...");const{callId:e,output:t}=this.pendingFunctionResult;this.pendingFunctionResult=null,await this.session.addConversationItem({type:"function_call_output",callId:e,output:t}),console.log("[VoiceLive Chat] Triggering response for function result..."),await this.session.sendEvent({type:"response.create",response:{modalities:["text","audio"]}})}}buildAvatarConfig(e){if(!e.enabled||e.type==="none")return;const t={codec:"h264"};return e.customized&&e.customAvatarName?e.type==="photo"?{type:"photo-avatar",model:"vasa-1",character:e.customAvatarName,customized:!0,video:t}:{type:"video-avatar",character:e.customAvatarName,customized:!0,video:t}:e.type==="photo"?{type:"photo-avatar",model:"vasa-1",character:e.character,customized:!1,video:t}:{type:"video-avatar",character:e.character,style:e.style,customized:!1,video:t}}buildSessionConfig(e){const t=!e.voice.includes("-")&&!e.voice.includes(":"),n=this.buildAvatarConfig(e.avatar),i=["text","audio"];n&&i.push("avatar");const o=e.model.includes("gpt-5")?1:e.temperature,a=[];return e.enableFunctionCalling&&(e.functions.enableDateTime&&a.push({type:"function",name:"getCurrentDateTime",description:"Get the current date and time in ISO 8601 format with timezone information",parameters:{type:"object",properties:{},required:[]}}),e.functions.enableWeatherForecast&&a.push({type:"function",name:"getWeatherForecast",description:"Get a detailed 7-day weather forecast for the user's location. This is a long-running operation that takes about 10 seconds to fetch comprehensive weather data.",parameters:{type:"object",properties:{},required:[]}})),{modalities:i,model:e.model,instructions:e.instructions,voice:t?e.voice:{name:e.voice,type:"azure-standard"},inputAudioFormat:"pcm16",outputAudioFormat:"pcm16",inputAudioTranscription:{model:e.model.includes("gpt")&&e.model.includes("realtime")?"whisper-1":"azure-speech",language:e.recognitionLanguage==="auto"?void 0:e.recognitionLanguage},turnDetection:{type:e.turnDetectionType,removeFillerWords:e.removeFillerWords},temperature:o,inputAudioNoiseReduction:e.useNoiseSuppression?{type:"azure_deep_noise_suppression"}:void 0,inputAudioEchoCancellation:e.useEchoCancellation?{type:"server_echo_cancellation"}:void 0,avatar:n,tools:a.length>0?a:void 0}}async initPeerConnectionWithIceServers(e){var i;console.log("[VoiceLive Chat] initPeerConnectionWithIceServers called"),console.log("[VoiceLive Chat] ICE servers count:",e.length),this.peerConnection=new RTCPeerConnection({iceServers:e}),console.log("[VoiceLive Chat] RTCPeerConnection created"),this.peerConnection.ontrack=s=>{console.log("[VoiceLive Chat] ontrack event - track kind:",s.track.kind,"streams:",s.streams.length),this.events.onAvatarTrack&&this.events.onAvatarTrack(s)},this.peerConnection.oniceconnectionstatechange=()=>{var s,o,a,l;console.log("[VoiceLive Chat] ICE connection state:",(s=this.peerConnection)==null?void 0:s.iceConnectionState),((o=this.peerConnection)==null?void 0:o.iceConnectionState)==="connected"?this.setState({isAvatarConnected:!0,statusText:"Avatar connected"}):(((a=this.peerConnection)==null?void 0:a.iceConnectionState)==="disconnected"||((l=this.peerConnection)==null?void 0:l.iceConnectionState)==="failed")&&this.setState({isAvatarConnected:!1})},this.peerConnection.onconnectionstatechange=()=>{var s;console.log("[VoiceLive Chat] Connection state:",(s=this.peerConnection)==null?void 0:s.connectionState)},this.peerConnection.onsignalingstatechange=()=>{var s;console.log("[VoiceLive Chat] Signaling state:",(s=this.peerConnection)==null?void 0:s.signalingState)},this.peerConnection.addTransceiver("video",{direction:"sendrecv"}),this.peerConnection.addTransceiver("audio",{direction:"sendrecv"}),console.log("[VoiceLive Chat] Transceivers added"),this.peerConnection.createDataChannel("eventChannel"),console.log("[VoiceLive Chat] Data channel created"),this.peerConnection.addEventListener("datachannel",s=>{const o=s.channel;console.log("[VoiceLive Chat] Data channel received:",o.label),o.onmessage=a=>{console.log("[VoiceLive Chat] WebRTC data channel message:",a.data)},o.onclose=()=>{console.log("[VoiceLive Chat] Data channel closed")}}),console.log("[VoiceLive Chat] Creating offer...");const t=await this.peerConnection.createOffer();console.log("[VoiceLive Chat] Offer created, type:",t.type),await this.peerConnection.setLocalDescription(t),console.log("[VoiceLive Chat] Local description set"),console.log("[VoiceLive Chat] Waiting for ICE gathering..."),await new Promise(s=>{var o;((o=this.peerConnection)==null?void 0:o.iceGatheringState)==="complete"?(console.log("[VoiceLive Chat] ICE gathering already complete"),s()):(this.peerConnection.onicegatheringstatechange=()=>{var a,l;console.log("[VoiceLive Chat] ICE gathering state:",(a=this.peerConnection)==null?void 0:a.iceGatheringState),((l=this.peerConnection)==null?void 0:l.iceGatheringState)==="complete"&&s()},setTimeout(()=>{console.log("[VoiceLive Chat] ICE gathering timeout (2s)"),s()},2e3))});const n=this.peerConnection.localDescription;if(console.log("[VoiceLive Chat] Local description:",n==null?void 0:n.type,"SDP length:",(i=n==null?void 0:n.sdp)==null?void 0:i.length),n&&this.session){const s=btoa(JSON.stringify(n));console.log("[VoiceLive Chat] Sending client SDP (base64 encoded), length:",s.length);const o={type:"session.avatar.connect",clientSdp:s};await this.session.sendEvent(o),console.log("[VoiceLive Chat] Client SDP sent successfully")}else console.error("[VoiceLive Chat] Cannot send SDP - no local description or session")}async handleServerSdpAnswer(e){if(!this.peerConnection){console.error("[VoiceLive Chat] No peer connection when receiving server SDP");return}try{const t=new RTCSessionDescription(JSON.parse(atob(e)));console.log("[VoiceLive Chat] Setting remote description (answer)"),await this.peerConnection.setRemoteDescription(t),console.log("[VoiceLive Chat] Remote description set successfully")}catch(t){throw console.error("[VoiceLive Chat] Failed to set remote description:",t),t}}closePeerConnection(){this.peerConnection&&(this.peerConnection.close(),this.peerConnection=void 0,this.setState({isAvatarConnected:!1}))}async executeFunction(e,t){if(console.log("[VoiceLive Chat] Executing function:",e,"with args:",t),e==="getCurrentDateTime"){const n=new Date,i={datetime:n.toISOString(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,timestamp:n.getTime()};return JSON.stringify(i)}if(e==="getWeatherForecast"){console.log("[VoiceLive Chat] Starting weather forecast fetch (10 second operation)...");const n=Date.now();await new Promise(o=>setTimeout(o,1e4));const i=Date.now();console.log(`[VoiceLive Chat] Weather forecast completed. Actual time: ${i-n}ms`);const s={location:"Seattle, WA",current:{temperature:52,condition:"Partly Cloudy",humidity:65,windSpeed:12},forecast:[{day:"Today",high:55,low:48,condition:"Partly Cloudy",precipitation:20},{day:"Tomorrow",high:58,low:50,condition:"Sunny",precipitation:5},{day:"Wednesday",high:60,low:52,condition:"Sunny",precipitation:0},{day:"Thursday",high:57,low:49,condition:"Cloudy",precipitation:30},{day:"Friday",high:54,low:47,condition:"Rainy",precipitation:75},{day:"Saturday",high:56,low:48,condition:"Partly Cloudy",precipitation:40},{day:"Sunday",high:59,low:51,condition:"Sunny",precipitation:10}],fetchedAt:new Date().toISOString()};return JSON.stringify(s)}return JSON.stringify({error:"Unknown function"})}async connect(e){if(this.state.isConnected)return;if(!e.endpoint.trim())throw new Error("Missing endpoint");if(!e.apiKey.trim())throw new Error("Missing API key");this.avatarConfig=e.avatar,this.setState({statusText:"Connecting..."}),this.client=new qj(e.endpoint.trim(),new jj(e.apiKey.trim()),{apiVersion:"2025-05-01-preview",defaultSessionOptions:{enableDebugLogging:!1}});const t=this.buildSessionConfig(e);console.log("[VoiceLive Chat] Session config:",JSON.stringify(t,null,2)),this.session=this.client.createSession(e.model,{connectionTimeoutInMs:3e4}),console.log("[VoiceLive Chat] Session created, subscribing to handlers...");const n={onConnected:async(i,s)=>{console.log("[VoiceLive Chat] Connected",{sessionId:s.sessionId,ctx:s}),this.setState({statusText:"Connected"})},onDisconnected:async i=>{console.log("[VoiceLive Chat] Disconnected",i),this.closePeerConnection(),this.setState({statusText:`Disconnected: ${i.reason}`})},onServerError:async i=>{console.error("[VoiceLive Chat] Server error",i.error),console.error("[VoiceLive Chat] Error details:",JSON.stringify(i.error,null,2)),this.addMessage("error",`Server Error: ${i.error.message}`),this.setState({statusText:`Error: ${i.error.message}`})},onSessionCreated:async i=>{console.log("[VoiceLive Chat] Session created",JSON.stringify(i.session,null,2));const s=i.session.id||"";console.log("[VoiceLive Chat] Extracted session ID:",s),s&&this.setState({sessionId:s}),i.session.avatar&&console.log("[VoiceLive Chat] Avatar in created session:",JSON.stringify(i.session.avatar,null,2))},onSessionUpdated:async i=>{if(console.log("[VoiceLive Chat] Session updated",JSON.stringify(i.session,null,2)),i.session.avatar){console.log("[VoiceLive Chat] Avatar configured in session:",JSON.stringify(i.session.avatar,null,2));const s=i.session.avatar.iceServers;if(console.log("[VoiceLive Chat] ICE servers from avatar:",s),s&&Array.isArray(s))if(console.log("[VoiceLive Chat] Received ICE servers:",JSON.stringify(s,null,2)),s.every(o=>typeof o=="object"&&o.urls)){console.log("[VoiceLive Chat] ICE servers valid, initializing peer connection...");try{await this.initPeerConnectionWithIceServers(s),console.log("[VoiceLive Chat] Peer connection initialized successfully")}catch(o){console.error("[VoiceLive Chat] Failed to init peer connection:",o),this.addMessage("error",`Avatar setup failed: ${o}`)}}else console.error("[VoiceLive Chat] Invalid ICE servers format:",s);else console.log("[VoiceLive Chat] No ICE servers in avatar config yet")}else console.log("[VoiceLive Chat] No avatar in session update")},onSessionAvatarConnecting:async i=>{var s,o;console.log("[VoiceLive Chat] Avatar connecting event received"),console.log("[VoiceLive Chat] Server SDP length:",(s=i.serverSdp)==null?void 0:s.length),console.log("[VoiceLive Chat] Server SDP preview:",(o=i.serverSdp)==null?void 0:o.substring(0,100));try{await this.handleServerSdpAnswer(i.serverSdp),console.log("[VoiceLive Chat] Server SDP handled successfully")}catch(a){console.error("[VoiceLive Chat] Failed to handle server SDP:",a),this.addMessage("error",`Avatar connection failed: ${a}`)}},onConversationItemInputAudioTranscriptionDelta:async i=>{console.log("[VoiceLive Chat] User transcription delta:",i.delta),this.currentUserMessageId||(this.currentUserMessageId=this.addMessage("user","")),this.currentUserTranscript+=i.delta,this.updateMessageById(this.currentUserMessageId,this.currentUserTranscript)},onConversationItemInputAudioTranscriptionCompleted:async i=>{var s;console.log("[VoiceLive Chat] Transcription completed",i.transcript),!this.currentUserMessageId&&((s=i.transcript)!=null&&s.trim())&&this.addMessage("user",i.transcript),this.currentUserTranscript="",this.currentUserMessageId=""},onInputAudioBufferSpeechStarted:async()=>{console.log("[VoiceLive Chat] Speech started - interrupting playback"),this.pcmPlayer.stop(),this.setState({isSpeaking:!0})},onInputAudioBufferSpeechStopped:async()=>{console.log("[VoiceLive Chat] Speech stopped"),this.setState({isSpeaking:!1})},onResponseCreated:async i=>{console.log("[VoiceLive Chat] Response created",i),this.isResponseInProgress=!0,this.currentResponseId=i.response.id??t_(),this.currentResponseText="",this.currentResponseMessageId="",this.currentFunctionCallName="",this.currentFunctionCallArgs="",this.currentFunctionCallId=""},onResponseTextDelta:async i=>{console.log("[VoiceLive Chat] Text delta:",i.delta),this.currentResponseMessageId||(this.currentResponseMessageId=this.addMessage("assistant","")),this.currentResponseText+=i.delta,this.updateMessageById(this.currentResponseMessageId,this.currentResponseText)},onResponseTextDone:async i=>{console.log("[VoiceLive Chat] Response text done",i)},onResponseFunctionCallArgumentsDelta:async i=>{console.log("[VoiceLive Chat] Function call arguments delta",i),this.currentFunctionCallArgs+=i.delta,this.currentFunctionCallId=i.callId},onResponseFunctionCallArgumentsDone:async i=>{console.log("[VoiceLive Chat] Function call arguments done",i),this.addMessage("assistant",` Calling ${i.name}()...`),this.executeFunction(i.name,i.arguments).then(async s=>{console.log("[VoiceLive Chat] Function result:",s),this.addMessage("status",` ${i.name}() completed`),this.pendingFunctionResult={callId:i.callId,output:s},this.isResponseInProgress?console.log("[VoiceLive Chat] Response in progress, waiting for onResponseDone to send function result..."):(console.log("[VoiceLive Chat] No response in progress, sending function result immediately..."),await this.sendPendingFunctionResult())}).catch(s=>{console.error("[VoiceLive Chat] Function execution error:",s),this.addMessage("error",`Function error: ${s.message}`)}),this.currentFunctionCallName="",this.currentFunctionCallArgs="",this.currentFunctionCallId=""},onResponseAudioDelta:async i=>{var s;if(!((s=this.avatarConfig)!=null&&s.enabled)){const o=i.delta;o instanceof Uint8Array&&this.pcmPlayer.enqueuePcm16(o,24e3)}},onResponseAudioTranscriptDelta:async i=>{console.log("[VoiceLive Chat] Audio transcript delta:",i.delta),this.currentResponseMessageId||(this.currentResponseMessageId=this.addMessage("assistant","")),this.currentResponseText+=i.delta,this.updateMessageById(this.currentResponseMessageId,this.currentResponseText)},onResponseAudioTranscriptDone:async i=>{console.log("[VoiceLive Chat] Audio transcript done",i)},onResponseDone:async i=>{var s;if(console.log("[VoiceLive Chat] Response done",i),this.isResponseInProgress=!1,i.response.status==="failed"){const o=i.response.statusDetails,a=((s=o==null?void 0:o.error)==null?void 0:s.message)||"Response failed";console.error("[VoiceLive Chat] Response failed:",o),this.addMessage("error",`Response Error: ${a}`),this.setState({statusText:`Error: ${a}`}),this.currentResponseText="",this.currentResponseId="";return}if(!this.currentResponseText.trim()&&i.response.output&&i.response.output.length>0){const o=i.response.output[0];if(o!=null&&o.content&&Array.isArray(o.content)){const a=o.content.find(l=>l.type==="audio"&&l.transcript||l.type==="text");a!=null&&a.transcript?this.updateLastMessage(a.transcript):a!=null&&a.text&&this.updateLastMessage(a.text)}}this.currentResponseText="",this.currentResponseId="",this.pendingFunctionResult&&(console.log("[VoiceLive Chat] Response complete, sending pending function result..."),await this.sendPendingFunctionResult())},onError:async i=>{console.log("[VoiceLive Chat] Error",i),this.addMessage("error",`${i.context}: ${i.error.message}`)}};this.subscription=this.session.subscribe(n),console.log("[VoiceLive Chat] Handlers subscribed, connecting...");try{await this.session.connect(),console.log("[VoiceLive Chat] WebSocket connected, sending session config..."),await this.session.updateSession(t),console.log("[VoiceLive Chat] Session config sent successfully")}catch(i){throw console.error("[VoiceLive Chat] Failed to connect or update session:",i),i}e.avatar.enabled||await this.pcmPlayer.resume(),this.setState({isConnected:!0,statusText:e.avatar.enabled?"Connecting avatar...":"Ready"})}async disconnect(){var e,t;this.setState({isRecording:!1,isSpeaking:!1});try{this.closePeerConnection(),this.pcmPlayer.stop(),await((e=this.subscription)==null?void 0:e.close()),this.subscription=void 0,await((t=this.session)==null?void 0:t.dispose()),this.session=void 0,this.client=void 0}finally{this.setState({isConnected:!1,isAvatarConnected:!1,statusText:"Disconnected"})}}async sendText(e){if(!this.session)throw new Error("Not connected");const t=e.trim();t&&(this.addMessage("user",t),await this.session.addConversationItem({type:"message",role:"user",content:[{type:"input_text",text:t}]}),await this.session.sendEvent({type:"response.create",response:{modalities:["text","audio"]}}))}async sendAudio(e){!this.session||!this.session.isConnected||await this.session.sendAudio(e)}clearMessages(){this.setState({messages:[]})}}class u${constructor(){q(this,"context");q(this,"workletNode",null);q(this,"stream",null);q(this,"source",null);q(this,"sampleRate",24e3);q(this,"nextPlayTime",0);q(this,"isPlaying",!1);q(this,"playbackQueue",[]);q(this,"analysisNode",null);q(this,"dataArray",null);q(this,"animationFrameId",null);q(this,"circleElement",null);this.context=new AudioContext({sampleRate:this.sampleRate})}async initialize(){this.context.state==="closed"&&(this.context=new AudioContext({sampleRate:this.sampleRate})),await this.context.audioWorklet.addModule("/AzureVoicePlayground/audio-processor.js"),this.analysisNode=this.context.createAnalyser(),this.analysisNode.fftSize=2048,this.analysisNode.smoothingTimeConstant=.85,this.dataArray=new Uint8Array(this.analysisNode.frequencyBinCount)}getSampleRate(){return this.sampleRate}setCircleElement(e){this.circleElement=e}async startRecording(e){try{this.workletNode||await this.initialize(),this.stream=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:this.sampleRate,echoCancellation:!0,noiseSuppression:!0}}),await this.context.resume(),this.source=this.context.createMediaStreamSource(this.stream),this.workletNode=new AudioWorkletNode(this.context,"audio-recorder-processor"),this.workletNode.port.onmessage=t=>{if(t.data.eventType==="audio"){const n=t.data.audioData,i=new Int16Array(n.length);for(let o=0;o<n.length;o++){const a=Math.max(-1,Math.min(1,n[o]));i[o]=a<0?a*32768:a*32767}const s=new Uint8Array(i.buffer);e(s)}},this.source.connect(this.workletNode),this.analysisNode&&this.circleElement&&(this.source.connect(this.analysisNode),this.startAnimation("record")),this.workletNode.connect(this.context.destination),this.workletNode.port.postMessage({command:"START_RECORDING"})}catch(t){throw console.error("Error starting recording:",t),t}}stopRecording(){!this.workletNode||!this.source||!this.stream||(this.workletNode.port.postMessage({command:"STOP_RECORDING"}),this.workletNode.disconnect(),this.source.disconnect(),this.stream.getTracks().forEach(e=>e.stop()),this.workletNode=null,this.source=null,this.stream=null,this.stopAnimation())}startStreamingPlayback(){this.isPlaying=!0,this.nextPlayTime=this.context.currentTime}stopStreamingPlayback(){this.isPlaying=!1,this.playbackQueue.forEach(e=>e.stop()),this.playbackQueue=[]}playChunk(e,t){if(!this.isPlaying)return;const n=new Int16Array(e.buffer),i=new Float32Array(n.length);for(let l=0;l<n.length;l++)i[l]=n[l]/(n[l]<0?32768:32767);const s=this.context.createBuffer(1,i.length,this.sampleRate);s.getChannelData(0).set(i);const o=this.context.createBufferSource();o.buffer=s,o.connect(this.context.destination),this.analysisNode&&this.circleElement&&(o.connect(this.analysisNode),this.startAnimation("play"));const a=s.length/this.sampleRate;this.nextPlayTime<this.context.currentTime&&(this.nextPlayTime=this.context.currentTime),o.start(this.nextPlayTime),this.playbackQueue.push(o),o.onended=()=>{t==null||t();const l=this.playbackQueue.indexOf(o);l>-1&&this.playbackQueue.splice(l,1),this.playbackQueue.length===0&&this.stream&&this.circleElement&&this.startAnimation("record")},this.nextPlayTime+=a}startAnimation(e){this.stopAnimation();const t=()=>{if(!this.analysisNode||!this.dataArray||!this.circleElement)return;this.analysisNode.getByteFrequencyData(this.dataArray);const n=Array.from(this.dataArray).reduce((i,s)=>i+s,0)/this.dataArray.length;this.updateCircle(n,e),this.animationFrameId=requestAnimationFrame(t)};t()}stopAnimation(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}updateCircle(e,t){if(!this.circleElement)return;const i=120+e*.8,s=Math.min(e/128,1);let o;if(t==="record"){const a=160+s*20,l=180+s*30,u=60+s*40,h=70-s*20;o=`linear-gradient(135deg, hsl(${a}, ${u}%, ${h}%), hsl(${l}, ${u}%, ${h}%))`}else{const a=260+s*20,l=300+s*30,u=60+s*40,h=70-s*20;o=`linear-gradient(135deg, hsl(${a}, ${u}%, ${h}%), hsl(${l}, ${u}%, ${h}%))`}this.circleElement.style.background=o,this.circleElement.style.width=`${i}px`,this.circleElement.style.height=`${i}px`,this.circleElement.style.boxShadow=`0 0 ${20+s*30}px rgba(${t==="record"?"20, 184, 166":"168, 85, 247"}, ${.3+s*.4})`}async close(){this.stopAnimation(),this.stopRecording(),this.stopStreamingPlayback(),await this.context.close()}}function d$({endpoint:r,apiKey:e}){const{enableMAIVoices:t}=_P(),n=Kj(t),[i,s]=O.useState(()=>{const F=localStorage.getItem("voicelive.chat.config");if(!F)return{...OT};try{const te=JSON.parse(F);return{...OT,...te}}catch{return{...OT}}}),[o,a]=O.useState(!1),[l,u]=O.useState(!1),[h,m]=O.useState(!1),[g,v]=O.useState(!1),[y,A]=O.useState(!1),[x,b]=O.useState([]),[w,T]=O.useState(""),[k,I]=O.useState(""),[M,L]=O.useState(""),[j,B]=O.useState(!1),[z,Z]=O.useState(null),$=O.useRef(null),U=O.useRef(null),Y=O.useRef(null),ee=O.useRef(null),X=O.useRef(null),re=O.useCallback(F=>{console.log("[Playground] Received avatar track:",F.track.kind,"streams:",F.streams.length),F.track.kind==="video"&&F.streams[0]&&(console.log("[Playground] Setting avatar video stream"),Z(F.streams[0]))},[]);O.useEffect(()=>{X.current&&z&&(console.log("[Playground] Attaching stream to video element"),X.current.srcObject=z)},[z]),$.current||($.current=new c$({onState:F=>{console.log("[Playground] State update received, sessionId:",F.sessionId),a(F.isConnected),u(F.isRecording),m(F.isSpeaking),A(F.isAvatarConnected),b(F.messages),T(F.statusText),I(F.sessionId)},onAvatarTrack:re}));const G=$.current;O.useEffect(()=>{localStorage.setItem("voicelive.chat.config",JSON.stringify(i))},[i]),O.useEffect(()=>()=>{const F=$.current,te=U.current;F!=null&&F.snapshot.isConnected&&(console.log("[VoiceLive Chat] Disconnecting on unmount"),F.disconnect().catch(console.error)),te&&te.close().catch(console.error)},[]),O.useEffect(()=>{var F;(F=Y.current)==null||F.scrollIntoView({behavior:"smooth"})},[x.length]),O.useEffect(()=>{U.current&&ee.current&&U.current.setCircleElement(ee.current)},[]);const J=O.useCallback(F=>{if(v(F>0),!ee.current)return;const ge=120+F*.8,oe=Math.min(F/128,1),pe=260+oe*20,Be=300+oe*30,Fe=60+oe*40,ye=70-oe*20,_e=`linear-gradient(135deg, hsl(${pe}, ${Fe}%, ${ye}%), hsl(${Be}, ${Fe}%, ${ye}%))`;ee.current.style.background=_e,ee.current.style.width=`${ge}px`,ee.current.style.height=`${ge}px`,ee.current.style.boxShadow=`0 0 ${20+oe*30}px rgba(168, 85, 247, ${.3+oe*.4})`},[]);O.useEffect(()=>(G.setPlaybackVolumeCallback(J),()=>{G.setPlaybackVolumeCallback(null)}),[G,J]);async function ne(){if(!o){T("Connecting...");try{await G.connect({...i,endpoint:r,apiKey:e}),T("Connected"),await V()}catch(F){const te=F instanceof Error?F.message:String(F);console.error("[Playground] Connection error:",te),T(`Error: ${te}`)}}}async function W(){T("Disconnecting...");try{await ce(),await G.disconnect(),Z(null),T("Disconnected")}catch(F){T(F instanceof Error?F.message:String(F))}}async function V(){if(!l){if(!G.snapshot.isConnected){T("Connect first");return}U.current||(U.current=new u$,ee.current&&U.current.setCircleElement(ee.current));try{await U.current.startRecording(F=>{G.sendAudio(F)}),u(!0)}catch(F){T(F instanceof Error?F.message:String(F))}}}async function ce(){if(U.current)try{U.current.stopRecording(),u(!1)}catch(F){console.error("Error stopping recording:",F)}}async function ue(){if(M.trim()){if(!o){T("Connect first");return}try{await G.sendText(M),L("")}catch(F){T(F instanceof Error?F.message:String(F))}}}function ve(){G.clearMessages(),b([])}function se(F){switch(F){case"user":return"bg-blue-100 text-blue-900 ml-auto";case"assistant":return"bg-gray-100 text-gray-900 mr-auto";case"status":return"bg-yellow-100 text-yellow-800 mx-auto";case"error":return"bg-red-100 text-red-800 mx-auto";default:return"bg-gray-100 text-gray-900"}}return f.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[f.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[f.jsx("div",{className:"bg-gradient-to-r from-teal-600 to-cyan-600 text-white p-6 shadow-md",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold",children:"Voice Live Chat"}),f.jsx("p",{className:"text-teal-100 mt-1",children:"Real-time voice conversation with AI"})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${o?"bg-green-500/20 text-green-100":"bg-white/20 text-white/80"}`,children:[f.jsx("span",{className:`w-2 h-2 rounded-full ${o?"bg-green-400":"bg-white/60"}`}),o?"Connected":"Disconnected"]}),l&&f.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium bg-red-500/20 text-red-100",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-red-400 animate-pulse"}),"Recording"]})]})]})}),!i.avatar.enabled&&f.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center py-4 bg-white border-b border-gray-100",style:{height:"200px"},children:[f.jsx("div",{ref:ee,className:"rounded-full transition-all duration-150 ease-out flex items-center justify-center",style:{width:"120px",height:"120px",backgroundColor:"#e5e7eb"},children:g?f.jsx("svg",{className:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})}):f.jsx("svg",{className:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),!o&&f.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Click Start to begin conversation"})]}),i.avatar.enabled&&f.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center py-4 bg-white border-b border-gray-100",style:{height:"480px"},children:[f.jsx("div",{className:"rounded-lg overflow-hidden bg-gray-900 flex items-center justify-center",style:{width:"400px",height:"400px"},children:z?f.jsx("video",{ref:X,autoPlay:!0,playsInline:!0,muted:!1,style:{width:"100%",height:"100%",objectFit:"cover"}}):f.jsxs("div",{className:"text-gray-400 text-center",children:[f.jsx("svg",{className:"w-16 h-16 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),f.jsx("p",{children:o?"Connecting avatar...":"Avatar will appear here"})]})}),y&&f.jsxs("span",{className:"mt-2 inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:[f.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),"Avatar Connected"]})]}),o&&f.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:f.jsxs("p",{className:"text-xs font-mono text-gray-500",children:["Session: ",k||"Loading..."]})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-white",children:x.length===0?f.jsx("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:f.jsx("p",{className:"text-sm",children:"Speak naturally and the AI will respond"})}):f.jsxs(f.Fragment,{children:[x.map(F=>f.jsxs("div",{className:`max-w-[80%] px-4 py-2 rounded-lg ${se(F.type)}`,children:[f.jsx("p",{className:"whitespace-pre-wrap",children:F.content}),f.jsx("p",{className:"text-xs opacity-60 mt-1",children:new Date(F.timestamp).toLocaleTimeString()})]},F.id)),f.jsx("div",{ref:Y})]})}),f.jsxs("div",{className:"bg-gray-50 border-t border-gray-200 p-4",children:[f.jsxs("div",{className:"flex gap-2 mb-2",children:[f.jsx("input",{type:"text",value:M,onChange:F=>L(F.target.value),onKeyDown:F=>{F.key==="Enter"&&!F.shiftKey&&(F.preventDefault(),ue())},placeholder:"Type a message (or just speak)...",disabled:!o,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed"}),f.jsx("button",{onClick:ue,disabled:!o||!M.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})}),f.jsx("button",{onClick:ve,disabled:x.length===0,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Clear chat",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),f.jsx("p",{className:"text-xs text-gray-500",children:w||"Ready"})]})]}),f.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-y-auto",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuration"}),f.jsxs("div",{className:"space-y-4 flex-1",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model"}),f.jsx("select",{value:i.model,onChange:F=>s(te=>({...te,model:F.target.value})),disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:a$.map(F=>f.jsx("option",{value:F.id,children:F.name},F.id))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Voice"}),f.jsx("select",{value:i.voice,onChange:F=>s(te=>({...te,voice:F.target.value})),disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:n.map(F=>f.jsx("option",{value:F.id,children:F.name},F.id))})]}),!i.model.includes("realtime")&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recognition Language"}),f.jsx("select",{value:i.recognitionLanguage,onChange:F=>s(te=>({...te,recognitionLanguage:F.target.value})),disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:l$.map(F=>f.jsx("option",{value:F.code,children:F.name},F.code))})]}),f.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[f.jsxs("label",{className:"flex items-center gap-2 mb-3",children:[f.jsx("input",{type:"checkbox",checked:i.enableFunctionCalling,onChange:F=>s(te=>({...te,enableFunctionCalling:F.target.checked})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Function Calling"})]}),i.enableFunctionCalling&&f.jsxs("div",{className:"space-y-2 pl-6",children:[f.jsxs("label",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"checkbox",checked:i.functions.enableDateTime,onChange:F=>s(te=>({...te,functions:{...te.functions,enableDateTime:F.target.checked}})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsx("span",{className:"text-xs text-gray-700",children:"getCurrentDateTime()"})]}),f.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Get current date, time, and timezone"}),f.jsxs("label",{className:"flex items-center gap-2 mt-2",children:[f.jsx("input",{type:"checkbox",checked:i.functions.enableWeatherForecast,onChange:F=>s(te=>({...te,functions:{...te.functions,enableWeatherForecast:F.target.checked}})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsx("span",{className:"text-xs text-gray-700",children:"getWeatherForecast()"})]}),f.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Get 7-day weather forecast (10s delay)"})]})]}),f.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[f.jsxs("label",{className:"flex items-center gap-2 mb-3",children:[f.jsx("input",{type:"checkbox",checked:i.avatar.enabled,onChange:F=>s(te=>({...te,avatar:{...te.avatar,enabled:F.target.checked}})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Avatar"})]}),i.avatar.enabled&&f.jsxs("div",{className:"space-y-3 pl-1",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Avatar Type"}),f.jsxs("select",{value:i.avatar.type,onChange:F=>s(te=>({...te,avatar:{...te.avatar,type:F.target.value,character:F.target.value==="photo"?e_[0].id:U0[0].character,style:F.target.value==="video"?U0[0].style:void 0}})),disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[f.jsx("option",{value:"video",children:"Video Avatar"}),f.jsx("option",{value:"photo",children:"Photo Avatar (VASA-1)"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:i.avatar.type==="photo"?"Photo Avatar":"Video Avatar"}),f.jsx("select",{value:i.avatar.type==="photo"?i.avatar.character:`${i.avatar.character}-${i.avatar.style}`,onChange:F=>{if(i.avatar.type==="photo")s(te=>({...te,avatar:{...te.avatar,character:F.target.value,style:void 0}}));else{const te=U0.find(ge=>ge.id===F.target.value);te&&s(ge=>({...ge,avatar:{...ge.avatar,character:te.character,style:te.style}}))}},disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:i.avatar.type==="photo"?e_.map(F=>f.jsx("option",{value:F.id,children:F.name},F.id)):U0.map(F=>f.jsx("option",{value:F.id,children:F.name},F.id))})]})]})]}),f.jsx("div",{className:"pt-2",children:o?f.jsxs("button",{onClick:W,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M6 6h12v12H6z"})}),"Stop"]}):f.jsxs("button",{onClick:ne,disabled:!r||!e,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Conversation"]})}),o&&f.jsx("div",{className:"pt-2",children:f.jsxs("button",{onClick:l?ce:V,className:`w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-md transition-colors ${l?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),l?"Mute Microphone":"Unmute Microphone"]})}),o&&h&&f.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-md",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),f.jsx("span",{className:"text-sm text-blue-700",children:"Speaking detected..."})]}),f.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[f.jsxs("button",{onClick:()=>B(!j),className:"flex items-center justify-between w-full text-sm font-medium text-gray-700",children:[f.jsx("span",{children:"Advanced Settings"}),f.jsx("svg",{className:`w-5 h-5 transition-transform ${j?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),j&&f.jsxs("div",{className:"mt-4 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"System Instructions"}),f.jsx("textarea",{value:i.instructions,onChange:F=>s(te=>({...te,instructions:F.target.value})),disabled:o,rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",placeholder:"You are a helpful assistant..."})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Turn Detection"}),f.jsxs("select",{value:i.turnDetectionType,onChange:F=>s(te=>({...te,turnDetectionType:F.target.value})),disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[f.jsx("option",{value:"server_vad",children:"Server VAD"}),f.jsx("option",{value:"azure_semantic_vad",children:"Azure Semantic VAD"})]})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Temperature: ",i.temperature.toFixed(1)]}),f.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:i.temperature,onChange:F=>s(te=>({...te,temperature:parseFloat(F.target.value)})),disabled:o,className:"w-full"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"checkbox",checked:i.removeFillerWords,onChange:F=>s(te=>({...te,removeFillerWords:F.target.checked})),disabled:o||i.turnDetectionType!=="azure_semantic_vad",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsx("span",{className:"text-sm text-gray-700",children:"Remove filler words"})]}),f.jsxs("label",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"checkbox",checked:i.useNoiseSuppression,onChange:F=>s(te=>({...te,useNoiseSuppression:F.target.checked})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsx("span",{className:"text-sm text-gray-700",children:"Noise suppression"})]}),f.jsxs("label",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"checkbox",checked:i.useEchoCancellation,onChange:F=>s(te=>({...te,useEchoCancellation:F.target.checked})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsx("span",{className:"text-sm text-gray-700",children:"Echo cancellation"})]})]})]})]})]})]})]})}function h$({settings:r}){const[e,t]=O.useState("audio"),[n,i]=O.useState(()=>{const oe=localStorage.getItem("voicecreation.config");if(!oe)return{...xT};try{return{...xT,...JSON.parse(oe)}}catch{return{...xT}}}),[s,o]=O.useState(null),[a,l]=O.useState(null),[u,h]=O.useState(!1),[m,g]=O.useState(""),[v,y]=O.useState(null),[A,x]=O.useState(""),[b,w]=O.useState([]),[T,k]=O.useState([]),[I,M]=O.useState(!1),[L,j]=O.useState(null),[B,z]=O.useState(`Hello, this is my personal voice speaking.
I can speak different languages.


Hola, esta es mi voz personal.
Bonjour, ceci est ma voix personnelle.`),[Z,$]=O.useState("DragonLatestNeural"),[U,Y]=O.useState(!1),[ee,X]=O.useState(null),[re,G]=O.useState(!1),J=O.useRef(null),ne=r.apiKey&&r.region,V=["eastus","eastus2","westeurope","southeastasia","swedencentral"].includes(r.region.toLowerCase()),ce={apiKey:r.apiKey,region:r.region};O.useEffect(()=>{localStorage.setItem("voicecreation.config",JSON.stringify(n))},[n]);const ue=O.useCallback(async()=>{if(ne){M(!0);try{const[oe,pe]=await Promise.all([lO(ce,n.projectId),pF(ce,n.projectId)]);w(oe),k(pe)}catch(oe){console.error("Failed to load voices:",oe)}finally{M(!1)}}},[ne,r.apiKey,r.region,n.projectId]);O.useEffect(()=>{ue()},[ue]);const ve=async()=>{await dF(ce,n.projectId)||await hF(ce,n.projectId)},se=async()=>{if(!s||!a||!n.voiceTalentName||!n.voiceName){y("Please complete all steps and provide a voice name");return}h(!0),y(null);try{g("Creating project..."),await ve();const oe=`consent-${Date.now()}`;if(g("Uploading consent..."),await mF(ce,{projectId:n.projectId,consentId:oe,voiceTalentName:n.voiceTalentName,companyName:n.companyName,audioFile:s,locale:n.locale}),g("Verifying consent..."),(await CF(ce,oe)).status==="Failed")throw new Error("Consent verification failed. Please ensure the audio clearly states the consent statement.");const Be=n.voiceName.trim().replace(/\s+/g,"-").toLowerCase();if(g("Creating personal voice..."),await SF(ce,{projectId:n.projectId,personalVoiceId:Be,consentId:oe,audioFiles:[a]}),g("Training voice model..."),(await AF(ce,Be)).status==="Failed")throw new Error("Voice creation failed. Please try with a different audio sample. Ensure it is the same person as the consent audio.");g("Voice created successfully!"),await ue(),setTimeout(()=>{g("")},3e3)}catch(oe){console.error("Voice creation failed:",oe);let pe="Voice creation failed";oe instanceof Error&&(oe.message.includes("409")?pe="A voice with this name already exists. Please use a different voice name.":pe=oe.message),y(pe),g("")}finally{h(!1)}},F=async oe=>{if(confirm(`Delete voice "${oe.id}"? This cannot be undone.`))try{await yF(ce,oe.id);try{await gF(ce,oe.consentId)}catch{}await ue(),(L==null?void 0:L.id)===oe.id&&j(null)}catch(pe){console.error("Failed to delete voice:",pe),alert("Failed to delete voice")}},te=async()=>{if(!(!L||!B.trim())){Y(!0),X(null);try{const oe=await bF(ce,B,L.speakerProfileId,n.locale,Z),pe=new Blob([oe],{type:"audio/mp3"}),Be=URL.createObjectURL(pe);J.current&&(J.current.src=Be,await J.current.play())}catch(oe){console.error("Synthesis failed:",oe),X(oe instanceof Error?oe.message:"Synthesis failed")}finally{Y(!1)}}},ge=()=>`I ${n.voiceTalentName||"[your name]"} am aware that recordings of my voice will be used by ${n.companyName} to create and use a synthetic version of my voice.`;return f.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[f.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"bg-gradient-to-r from-emerald-600 to-teal-600 text-white p-6 shadow-md",children:[f.jsx("h1",{className:"text-3xl font-bold",children:"Voice Creation"}),f.jsx("p",{className:"text-emerald-100 mt-1",children:"Create your custom AI voice from audio samples or text prompt"})]}),f.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:ne?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex-[3] min-h-0 border-b border-gray-200 flex flex-col",children:[f.jsxs("div",{className:"flex border-b border-gray-200 bg-gray-50 flex-shrink-0",children:[f.jsx("button",{onClick:()=>t("audio"),className:`flex-1 px-4 py-2 text-sm font-medium transition-colors ${e==="audio"?"text-emerald-600 border-b-2 border-emerald-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),"Audio Based"]})}),f.jsx("button",{onClick:()=>t("text-prompt"),className:`flex-1 px-4 py-2 text-sm font-medium transition-colors ${e==="text-prompt"?"text-emerald-600 border-b-2 border-emerald-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Text Prompt"]})})]}),f.jsx("div",{className:"flex-1 min-h-0 p-4 overflow-hidden",children:e==="audio"?f.jsx("div",{className:"h-full flex flex-col gap-3",children:V?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-md px-3 py-2 flex items-center gap-2 text-sm flex-shrink-0",children:[f.jsx("svg",{className:"w-4 h-4 text-amber-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),f.jsxs("span",{className:"text-amber-800",children:["Audio-based voice creation requires gating approval."," ",f.jsx("a",{href:"https://learn.microsoft.com/en-us/azure/ai-services/speech-service/custom-neural-voice",target:"_blank",rel:"noopener noreferrer",className:"text-amber-700 underline hover:text-amber-900 font-medium",children:"Learn more and apply for access"})]})]}),f.jsxs("div",{className:"flex gap-4 items-end flex-shrink-0",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Voice Name ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",value:n.voiceName,onChange:oe=>i(pe=>({...pe,voiceName:oe.target.value})),placeholder:"my-custom-voice",className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500"})]}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Your Name ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",value:n.voiceTalentName,onChange:oe=>i(pe=>({...pe,voiceTalentName:oe.target.value})),placeholder:"John Doe",className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500"})]}),f.jsxs("div",{className:"w-32",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Language"}),f.jsx("select",{value:n.locale,onChange:oe=>i(pe=>({...pe,locale:oe.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500",children:_2.map(oe=>f.jsx("option",{value:oe.code,children:oe.name},oe.code))})]})]}),f.jsxs("div",{className:"flex-1 min-h-0 max-h-[250px] grid grid-cols-2 gap-3 overflow-auto",children:[f.jsxs("div",{className:"flex flex-col rounded-lg border border-gray-200 bg-white p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-shrink-0",children:[f.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${s?"bg-emerald-500 text-white":"bg-gray-200 text-gray-600"}`,children:s?"":"1"}),f.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Consent"})]}),f.jsxs("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded text-xs flex-shrink-0",children:[f.jsx("p",{className:"text-blue-800 font-medium",children:"Read aloud:"}),f.jsxs("p",{className:"text-blue-900 italic mt-0.5 line-clamp-2",children:['"',ge(),'"']})]}),f.jsx("div",{className:"flex-shrink-0",children:f.jsx(HT,{onRecordingComplete:o,maxDuration:30,minDuration:3,disabled:u})})]}),f.jsxs("div",{className:"flex flex-col rounded-lg border border-gray-200 bg-white p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-shrink-0",children:[f.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${a?"bg-emerald-500 text-white":"bg-gray-200 text-gray-600"}`,children:a?"":"2"}),f.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Voice Sample"})]}),f.jsxs("div",{className:"text-xs text-gray-600 mb-2 flex-shrink-0 space-y-1",children:[f.jsx("p",{className:"font-medium",children:"Recording Guidelines (5-90 seconds):"}),f.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-gray-500",children:[f.jsx("li",{children:"Record in a quiet environment with minimal background noise"}),f.jsx("li",{children:"Speak naturally in the style you want for your voice"}),f.jsx("li",{children:"Maintain consistent volume and microphone distance"})]})]}),f.jsx("div",{className:"flex-shrink-0",children:f.jsx(HT,{onRecordingComplete:l,maxDuration:90,minDuration:5,disabled:u})})]})]}),f.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[f.jsx("button",{onClick:se,disabled:u||!a||!s||!n.voiceTalentName.trim()||!n.voiceName.trim(),className:"px-4 py-2 bg-emerald-600 text-white text-sm rounded-lg hover:bg-emerald-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium",children:u?"Creating...":"Create My Voice"}),v&&f.jsx("p",{className:"text-sm text-red-600",children:v}),u&&m&&f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("svg",{className:"w-4 h-4 animate-spin text-emerald-600",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),f.jsx("p",{className:"text-sm text-emerald-700",children:m})]})]})]}):f.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx("svg",{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-amber-800",children:"Region Not Supported"}),f.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Audio-based voice creation is currently only available in the following regions:"}),f.jsxs("ul",{className:"text-sm text-amber-700 mt-2 list-disc list-inside",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"East US"})," (eastus)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"East US 2"})," (eastus2)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"West Europe"})," (westeurope)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Southeast Asia"})," (southeastasia)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Sweden Central"})," (swedencentral)"]})]}),f.jsxs("p",{className:"text-sm text-amber-700 mt-2",children:["Your current region is ",f.jsx("strong",{children:r.region}),". Please update your region in the sidebar settings."]})]})]})})}):f.jsxs("div",{className:"h-full flex flex-col gap-3",children:[f.jsxs("div",{className:"flex gap-4 items-end flex-shrink-0",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Voice Name"}),f.jsx("input",{type:"text",value:n.voiceName,onChange:oe=>i(pe=>({...pe,voiceName:oe.target.value})),placeholder:"my-custom-voice",className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500"})]}),f.jsxs("div",{className:"w-32",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Language"}),f.jsx("select",{value:n.locale,onChange:oe=>i(pe=>({...pe,locale:oe.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500",children:_2.map(oe=>f.jsx("option",{value:oe.code,children:oe.name},oe.code))})]})]}),f.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[f.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Voice Description ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("textarea",{value:A,onChange:oe=>x(oe.target.value),placeholder:"e.g., A warm, friendly female voice with a slight British accent. Middle-aged, calm and professional tone, suitable for audiobooks and narration.",className:"flex-1 min-h-[80px] w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 resize-none"})]}),f.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[f.jsx("button",{disabled:!A.trim()||u,className:"px-4 py-1.5 bg-emerald-600 text-white text-sm rounded hover:bg-emerald-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium",children:"Generate Voice"}),f.jsx("span",{className:"text-xs text-amber-600",children:"This feature is in development (coming soon)"})]})]})})]}),f.jsx("div",{className:"flex-[2] min-h-0 p-4 bg-gray-50 flex flex-col",children:f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 flex-1 min-h-0 flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3 flex-shrink-0",children:[f.jsx("h2",{className:"text-sm font-semibold text-gray-800",children:"Test Voice"}),L&&f.jsxs("span",{className:"text-xs text-gray-500",children:["Using: ",f.jsx("span",{className:"font-medium text-gray-700",children:L.id})]})]}),L?f.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[f.jsxs("div",{className:"flex gap-3 items-end flex-shrink-0",children:[f.jsxs("div",{className:"w-36",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Model"}),f.jsx("select",{value:Z,onChange:oe=>$(oe.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500",children:fO.map(oe=>f.jsx("option",{value:oe.id,children:oe.name},oe.id))})]}),f.jsx("button",{onClick:te,disabled:U||!B.trim(),className:"flex items-center gap-2 px-4 py-1.5 bg-emerald-600 text-white text-sm rounded hover:bg-emerald-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium",children:U?f.jsxs(f.Fragment,{children:[f.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Synthesizing..."]}):f.jsxs(f.Fragment,{children:[f.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M8 5v14l11-7z"})}),"Speak"]})}),f.jsxs("button",{onClick:()=>G(!re),className:`flex items-center gap-1.5 px-3 py-1.5 text-sm rounded border ${re?"bg-gray-100 border-gray-400 text-gray-700":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"SSML"]}),f.jsxs("button",{onClick:()=>{const oe=av(B,L.speakerProfileId,n.locale,Z),pe=`
Voice Name: ${L.id}
Speaker Name: ${n.voiceTalentName}
Model: ${Z}
Language: ${n.locale}

Test Text:
${B}

SSML:
${oe}

[Please attach the audio file if available]
                            `.trim(),Be=encodeURIComponent(`Personal Voice Feedback - ${L.id}`),Fe=encodeURIComponent(pe),ye=`mailto:ttsvoicefeedback@microsoft.com?subject=${Be}&body=${Fe}`;navigator.clipboard&&navigator.clipboard.writeText(oe),window.open(ye,"_blank")},className:"flex items-center gap-1.5 px-3 py-1.5 text-sm rounded border bg-green-600 border-green-600 text-white hover:bg-green-700",title:"Send feedback email",children:[f.jsxs("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:[f.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),f.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),"Feedback"]}),ee&&f.jsx("span",{className:"text-xs text-red-600",children:ee})]}),f.jsxs("div",{className:"flex-1 min-h-0 flex gap-3",children:[f.jsx("div",{className:`flex-1 min-h-0 ${re?"w-1/2":"w-full"}`,children:f.jsx("textarea",{value:B,onChange:oe=>z(oe.target.value),placeholder:"Enter text to speak...",className:"w-full h-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 resize-none"})}),re&&f.jsx("div",{className:"flex-1 min-h-0 w-1/2",children:f.jsx("pre",{className:"w-full h-full px-2 py-1.5 bg-gray-900 text-gray-100 rounded text-xs font-mono overflow-auto whitespace-pre-wrap",children:av(B,L.speakerProfileId,n.locale,Z)})})]}),f.jsx("audio",{ref:J,className:"hidden"})]}):f.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:f.jsxs("div",{className:"text-center",children:[f.jsx("svg",{className:"w-10 h-10 mx-auto mb-2 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})}),f.jsx("p",{className:"text-sm",children:"Select a voice from the panel to test"})]})})]})})]}):f.jsx("div",{className:"flex items-center justify-center h-full",children:f.jsxs("div",{className:"text-center text-gray-500",children:[f.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),f.jsx("p",{className:"text-lg",children:"Please configure your Azure API key and region"})]})})})]}),f.jsx("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 flex flex-col overflow-hidden",children:f.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"My Voices"}),f.jsx("button",{onClick:ue,disabled:I||!ne,className:"p-2 text-gray-500 hover:text-gray-700 disabled:opacity-50",title:"Refresh",children:f.jsx("svg",{className:`w-5 h-5 ${I?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),b.length===0?f.jsxs("div",{className:"text-center text-gray-500 py-8",children:[f.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),f.jsx("p",{children:"No voices created yet"}),f.jsx("p",{className:"text-sm mt-1",children:"Create your first voice above"})]}):f.jsx("div",{className:"space-y-2",children:b.map(oe=>f.jsx("div",{onClick:()=>oe.status==="Succeeded"&&j(oe),className:`p-3 rounded-lg border cursor-pointer transition-colors ${(L==null?void 0:L.id)===oe.id?"border-emerald-500 bg-emerald-50":"border-gray-200 bg-white hover:border-gray-300"} ${oe.status!=="Succeeded"?"opacity-60 cursor-not-allowed":""}`,children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),f.jsx("span",{className:"font-medium text-gray-800 text-sm",children:oe.id})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${oe.status==="Succeeded"?"bg-green-100 text-green-700":oe.status==="Failed"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:oe.status}),f.jsx("button",{onClick:pe=>{pe.stopPropagation(),F(oe)},className:"p-1 text-gray-400 hover:text-red-600",title:"Delete voice",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},oe.id))})]})})]})}const p$=[".mp4"],f$=5;function m$({onFileSelected:r,onUploadComplete:e,disabled:t=!1,maxSizeGB:n=f$,acceptedFormats:i=p$}){const[s,o]=O.useState(!1),[a,l]=O.useState(null),[u,h]=O.useState(null),[m,g]=O.useState(null),[v,y]=O.useState(null),A=O.useRef(null),x=O.useRef(null),b=n*1024*1024*1024;O.useEffect(()=>()=>{u&&URL.revokeObjectURL(u)},[u]);const w=O.useCallback($=>{var Y;const U="."+((Y=$.name.split(".").pop())==null?void 0:Y.toLowerCase());return i.includes(U)?$.size>b?`File too large. Maximum size: ${n}GB`:null:`Invalid file format. Accepted formats: ${i.join(", ")}`},[i,b,n]),T=O.useCallback($=>{const U=w($);if(U){g(U);return}g(null),l($),u&&URL.revokeObjectURL(u);const Y=URL.createObjectURL($);h(Y),r($)},[w,r,u]),k=O.useCallback($=>{$.preventDefault(),t||o(!0)},[t]),I=O.useCallback($=>{$.preventDefault(),o(!1)},[]),M=O.useCallback($=>{if($.preventDefault(),o(!1),t)return;const U=$.dataTransfer.files;U.length>0&&T(U[0])},[t,T]),L=O.useCallback($=>{const U=$.target.files;U&&U.length>0&&T(U[0])},[T]),j=O.useCallback(()=>{!t&&A.current&&A.current.click()},[t]),B=O.useCallback(()=>{if(x.current){const $=x.current.duration,U=Math.floor($/60),Y=Math.floor($%60);y(`${U}:${Y.toString().padStart(2,"0")}`)}},[]),z=O.useCallback(()=>{l(null),u&&URL.revokeObjectURL(u),h(null),y(null),g(null),A.current&&(A.current.value="")},[u]),Z=$=>$<1024?$+" B":$<1024*1024?($/1024).toFixed(1)+" KB":$<1024*1024*1024?($/(1024*1024)).toFixed(1)+" MB":($/(1024*1024*1024)).toFixed(2)+" GB";return f.jsxs("div",{className:"space-y-4",children:[a?f.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[f.jsx("div",{className:"bg-black aspect-video",children:f.jsx("video",{ref:x,src:u||void 0,className:"w-full h-full",controls:!0,onLoadedMetadata:B})}),f.jsxs("div",{className:"p-4 bg-gray-50 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("svg",{className:"h-8 w-8 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-medium text-gray-900 truncate max-w-xs",children:a.name}),f.jsxs("p",{className:"text-xs text-gray-500",children:[Z(a.size),v&&`  ${v}`]})]})]}),f.jsx("button",{onClick:z,disabled:t,className:"text-gray-400 hover:text-gray-600 disabled:opacity-50",children:f.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}):f.jsxs("div",{onClick:j,onDragOver:k,onDragLeave:I,onDrop:M,className:`
            border-2 border-dashed rounded-lg p-8 text-center cursor-pointer
            transition-colors duration-200
            ${s?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:border-gray-400"}
            ${t?"opacity-50 cursor-not-allowed":""}
          `,children:[f.jsx("input",{ref:A,type:"file",accept:i.join(","),onChange:L,className:"hidden",disabled:t}),f.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),f.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[f.jsx("span",{className:"font-medium text-indigo-600",children:"Click to upload"})," or drag and drop"]}),f.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["MP4 video files up to ",n,"GB"]})]}),m&&f.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-3",children:m})]})}const Jh="2024-05-20-preview";function Qh(r){return`https://${r}.api.cognitive.microsoft.com/videotranslation`}function ep(r,e){const t={"Ocp-Apim-Subscription-Key":r,"Content-Type":"application/json"};return e&&(t["Operation-Id"]=e),t}async function tp(r){var e,t;if(!r.ok){let n=`API Error: ${r.status} ${r.statusText}`;try{const i=await r.json();console.error("API Error Response:",i),(e=i.error)!=null&&e.message?n=i.error.message:i.message?n=i.message:(t=i.error)!=null&&t.code&&(n=`${i.error.code}: ${JSON.stringify(i.error)}`)}catch{}throw new Error(n)}return r.status===204?{}:r.json()}async function g$(r,e){const t=`${Qh(r.region)}/translations/${e.translationId}?api-version=${Jh}`,n={targetLocale:e.input.targetLocale,voiceKind:e.input.voiceKind};e.input.videoFileUrl!==void 0&&(n.videoFileUrl=e.input.videoFileUrl),e.input.audioFileUrl!==void 0&&(n.audioFileUrl=e.input.audioFileUrl),e.input.sourceLocale!==void 0&&e.input.sourceLocale!==""&&(n.sourceLocale=e.input.sourceLocale),e.input.speakerCount!==void 0&&(n.speakerCount=e.input.speakerCount),e.input.subtitleMaxCharCountPerSegment!==void 0&&(n.subtitleMaxCharCountPerSegment=e.input.subtitleMaxCharCountPerSegment),e.input.exportSubtitleInVideo!==void 0&&(n.exportSubtitleInVideo=e.input.exportSubtitleInVideo),e.input.enableLipSync!==void 0&&(n.enableLipSync=e.input.enableLipSync);const i={input:n};e.displayName!==void 0&&(i.displayName=e.displayName),e.description!==void 0&&(i.description=e.description);const s=crypto.randomUUID(),o=await fetch(t,{method:"PUT",headers:ep(r.apiKey,s),body:JSON.stringify(i)}),a=o.headers.get("Operation-Location")||"";return{translation:await tp(o),operationLocation:a}}async function Yj(r,e){const t=`${Qh(r.region)}/translations/${e}?api-version=${Jh}`,n=await fetch(t,{method:"GET",headers:ep(r.apiKey)});return tp(n)}async function v$(r,e){const t=`${Qh(r.region)}/translations?api-version=${Jh}`,n=await fetch(t,{method:"GET",headers:ep(r.apiKey)});return tp(n)}async function S$(r,e){const t=`${Qh(r.region)}/translations/${e}?api-version=${Jh}`,n=await fetch(t,{method:"DELETE",headers:ep(r.apiKey)});await tp(n)}async function y$(r,e,t){var h,m,g,v;const n=`${Qh(r.region)}/translations/${e}/iterations/${t.iterationId}?api-version=${Jh}`,i={};((h=t.input)==null?void 0:h.speakerCount)!==void 0&&(i.speakerCount=t.input.speakerCount),((m=t.input)==null?void 0:m.exportSubtitleInVideo)!==void 0&&(i.exportSubtitleInVideo=t.input.exportSubtitleInVideo),((g=t.input)==null?void 0:g.subtitleMaxCharCountPerSegment)!==void 0&&(i.subtitleMaxCharCountPerSegment=t.input.subtitleMaxCharCountPerSegment),((v=t.input)==null?void 0:v.webvttFile)!==void 0&&(i.webvttFile=t.input.webvttFile);const s={input:i};t.description!==void 0&&(s.description=t.description),console.log("Creating iteration with body:",JSON.stringify(s));const o=crypto.randomUUID(),a=await fetch(n,{method:"PUT",headers:ep(r.apiKey,o),body:JSON.stringify(s)}),l=a.headers.get("Operation-Location")||"";return{iteration:await tp(a),operationLocation:l}}async function C$(r,e,t){const n=`${Qh(r.region)}/translations/${e}/iterations/${t}?api-version=${Jh}`,i=await fetch(n,{method:"GET",headers:ep(r.apiKey)});return tp(i)}async function A$(r,e,t,n=36e5,i=5e3){const s=Date.now();for(;Date.now()-s<n;){const o=await Yj(r,e);if(t&&t(o),o.status==="Succeeded"||o.status==="Failed"||o.status==="Canceled")return o;await new Promise(a=>setTimeout(a,i))}throw new Error("Translation timed out")}async function b$(r,e,t,n,i=36e5,s=5e3){const o=Date.now();for(;Date.now()-o<i;){const a=await C$(r,e,t);if(n&&n(a),a.status==="Succeeded"||a.status==="Failed"||a.status==="Canceled")return a;await new Promise(l=>setTimeout(l,s))}throw new Error("Iteration timed out")}const Xj="video-translation-history";function x$(){try{const r=localStorage.getItem(Xj);return r?JSON.parse(r):[]}catch{return[]}}function Z0(r){localStorage.setItem(Xj,JSON.stringify(r))}function T$({apiKey:r,region:e}){const[t,n]=O.useState("idle"),[i,s]=O.useState({step:0,totalSteps:4,message:""}),[o,a]=O.useState(null),[l,u]=O.useState(null),[h,m]=O.useState(null),[g,v]=O.useState([]),[y,A]=O.useState(x$),x=O.useRef(!1),b=O.useCallback(()=>({region:e,apiKey:r}),[e,r]),w=O.useCallback($=>{const U={...$,id:crypto.randomUUID()};return A(Y=>{const ee=[U,...Y].slice(0,50);return Z0(ee),ee}),U.id},[]),T=O.useCallback(($,U)=>{A(Y=>{const ee=Y.map(X=>X.id===$?{...X,...U}:X);return Z0(ee),ee})},[]),k=O.useCallback($=>{A(U=>{const Y=U.filter(ee=>ee.id!==$);return Z0(Y),Y})},[]),I=O.useCallback(()=>{A([]),Z0([])},[]),M=O.useCallback(async($,U,Y)=>{var G,J,ne,W;x.current=!1,a(null),n("creating"),s({step:1,totalSteps:4,message:"Creating translation..."});const ee=crypto.randomUUID(),X=crypto.randomUUID(),re=w({translationId:ee,displayName:Y||`Translation ${new Date().toLocaleString()}`,sourceLocale:U.sourceLocale||"auto",targetLocale:U.targetLocale,voiceKind:U.voiceKind,status:"Running",createdAt:new Date().toISOString(),videoUrl:$});try{const V=b(),{translation:ce}=await g$(V,{translationId:ee,displayName:Y||`Translation ${new Date().toLocaleString()}`,input:{videoFileUrl:$,sourceLocale:U.sourceLocale||void 0,targetLocale:U.targetLocale,voiceKind:U.voiceKind,speakerCount:U.speakerCount,subtitleMaxCharCountPerSegment:U.subtitleMaxCharCountPerSegment,exportSubtitleInVideo:U.exportSubtitleInVideo,enableLipSync:U.enableLipSync}});if(u(ce),s({step:1,totalSteps:4,message:"Translation created, waiting for processing...",translationId:ee}),x.current){n("cancelled"),T(re,{status:"Canceled"});return}n("processing"),s({step:2,totalSteps:4,message:"Processing video...",translationId:ee});const ue=await A$(V,ee,F=>{if(u(F),s({step:2,totalSteps:4,message:`Processing video... (${F.status})`,translationId:ee}),console.log("Translation status:",F.status,F),x.current)throw new Error("Cancelled")});if(ue.status==="Failed")throw new Error(ue.failureReason||"Translation failed");if(x.current){n("cancelled"),T(re,{status:"Canceled"});return}n("iterating"),s({step:3,totalSteps:4,message:"Creating iteration...",translationId:ee});const{iteration:ve}=await y$(V,ee,{iterationId:X});m(ve),s({step:3,totalSteps:4,message:"Generating translated video...",translationId:ee,iterationId:X});const se=await b$(V,ee,X,F=>{if(m(F),s({step:3,totalSteps:4,message:`Generating translated video... (${F.status})`,translationId:ee,iterationId:X}),console.log("Iteration status:",F.status,F),x.current)throw new Error("Cancelled")});if(se.status==="Failed")throw new Error(se.failureReason||"Iteration failed");return n("completed"),s({step:4,totalSteps:4,message:"Translation completed!",translationId:ee,iterationId:X}),m(se),T(re,{status:"Succeeded",completedAt:new Date().toISOString(),resultVideoUrl:(G=se.result)==null?void 0:G.translatedVideoFileUrl,sourceSubtitleUrl:(J=se.result)==null?void 0:J.sourceLocaleSubtitleWebvttFileUrl,targetSubtitleUrl:(ne=se.result)==null?void 0:ne.targetLocaleSubtitleWebvttFileUrl,metadataUrl:(W=se.result)==null?void 0:W.metadataJsonWebvttFileUrl}),se}catch(V){const ce=V instanceof Error?V.message:"Unknown error occurred";ce==="Cancelled"?(n("cancelled"),T(re,{status:"Canceled"})):(a(ce),n("error"),T(re,{status:"Failed",error:ce}))}},[b,w,T]),L=O.useCallback(()=>{x.current=!0},[]),j=O.useCallback(async()=>{try{const $=b(),U=await v$($);return v(U.value),U.value}catch($){const U=$ instanceof Error?$.message:"Failed to load translations";return a(U),[]}},[b]),B=O.useCallback(async $=>{try{const U=b(),Y=await Yj(U,$);return u(Y),Y}catch(U){const Y=U instanceof Error?U.message:"Failed to refresh translation";return a(Y),null}},[b]),z=O.useCallback(async $=>{try{const U=b();return await S$(U,$),v(Y=>Y.filter(ee=>ee.id!==$)),!0}catch(U){const Y=U instanceof Error?U.message:"Failed to delete translation";return a(Y),!1}},[b]),Z=O.useCallback(()=>{n("idle"),s({step:0,totalSteps:4,message:""}),a(null),u(null),m(null),x.current=!1},[]);return{status:t,progress:i,error:o,currentTranslation:l,currentIteration:h,translations:g,history:y,startTranslation:M,cancelTranslation:L,loadTranslations:j,refreshTranslation:B,deleteTranslation:z,reset:Z,removeFromHistory:k,clearHistory:I}}const Jj=[{code:"",label:"Auto-detect"},{code:"en-US",label:"English (US)"},{code:"en-GB",label:"English (UK)"},{code:"zh-CN",label:"Chinese (Simplified)"},{code:"zh-TW",label:"Chinese (Traditional)"},{code:"ja-JP",label:"Japanese"},{code:"ko-KR",label:"Korean"},{code:"es-ES",label:"Spanish (Spain)"},{code:"es-MX",label:"Spanish (Mexico)"},{code:"fr-FR",label:"French (France)"},{code:"de-DE",label:"German"},{code:"it-IT",label:"Italian"},{code:"pt-BR",label:"Portuguese (Brazil)"},{code:"pt-PT",label:"Portuguese (Portugal)"},{code:"ru-RU",label:"Russian"},{code:"ar-SA",label:"Arabic (Saudi Arabia)"},{code:"hi-IN",label:"Hindi"},{code:"th-TH",label:"Thai"},{code:"vi-VN",label:"Vietnamese"},{code:"id-ID",label:"Indonesian"},{code:"ms-MY",label:"Malay"},{code:"nl-NL",label:"Dutch"},{code:"pl-PL",label:"Polish"},{code:"tr-TR",label:"Turkish"},{code:"sv-SE",label:"Swedish"},{code:"da-DK",label:"Danish"},{code:"fi-FI",label:"Finnish"},{code:"nb-NO",label:"Norwegian"},{code:"uk-UA",label:"Ukrainian"},{code:"cs-CZ",label:"Czech"},{code:"he-IL",label:"Hebrew"}],w$=Jj.filter(r=>r.code!==""),P$=["centralus","eastus","japaneast","northcentralus","southcentralus","southeastasia","westcentralus","westeurope","westus","westus2","westus3"],Qj="video-translation-config";function E$(){try{const r=localStorage.getItem(Qj);return r?JSON.parse(r):{}}catch{return{}}}function R$(r){localStorage.setItem(Qj,JSON.stringify(r))}function I$({settings:r,isConfigured:e}){const[t,n]=O.useState("upload"),[i,s]=O.useState(null),[o,a]=O.useState(""),[l,u]=O.useState(null),[h,m]=O.useState(!1),[g,v]=O.useState(null),[y,A]=O.useState(xO),[x,b]=O.useState(!1),w=E$(),[T,k]=O.useState(w.sourceLocale||""),[I,M]=O.useState(w.targetLocale||"en-US"),[L,j]=O.useState(w.voiceKind||"PlatformVoice"),[B,z]=O.useState(w.enableLipSync||!1),[Z,$]=O.useState(w.exportSubtitleInVideo||!1),[U,Y]=O.useState(w.speakerCount),[ee,X]=O.useState(w.subtitleMaxCharCountPerSegment),[re,G]=O.useState(!1),[J,ne]=O.useState(!1),{status:W,progress:V,error:ce,currentIteration:ue,history:ve,startTranslation:se,cancelTranslation:F,reset:te,removeFromHistory:ge,clearHistory:oe}=T$({apiKey:r.apiKey,region:r.region});O.useEffect(()=>{R$({sourceLocale:T,targetLocale:I,voiceKind:L,enableLipSync:B,exportSubtitleInVideo:Z,speakerCount:U,subtitleMaxCharCountPerSegment:ee})},[T,I,L,B,Z,U,ee]),O.useEffect(()=>{TO(y)},[y]);const pe=O.useCallback(be=>{s(be),u(null),v(null)},[]),Be=O.useCallback(async()=>{if(!i)return;const be=bO(y);if(be){v(be),b(!0);return}m(!0),v(null);try{const yt=await AO(i,y);u(yt)}catch(yt){v(yt instanceof Error?yt.message:"Failed to upload video")}finally{m(!1)}},[i,y]),Fe=O.useCallback(async()=>{let be="";if(t==="upload"){if(!l){v("Please upload the video to blob storage first");return}be=l}else{if(!o.trim()){v("Please enter a video URL");return}be=o.trim()}await se(be,{sourceLocale:T,targetLocale:I,voiceKind:L,enableLipSync:B,exportSubtitleInVideo:Z,speakerCount:U,subtitleMaxCharCountPerSegment:ee})},[t,l,o,T,I,L,B,Z,U,ee,se]),ye=O.useCallback(()=>{te(),s(null),u(null),a(""),v(null)},[te]),_e=be=>{switch(be){case"completed":return"text-green-600";case"error":return"text-red-600";case"cancelled":return"text-yellow-600";default:return"text-blue-600"}},de=be=>new Date(be).toLocaleString(),Ae=["creating","processing","iterating","uploading"].includes(W),nt=P$.includes(r.region.toLowerCase()),at=e&&nt&&!Ae&&(t==="upload"&&l||t==="url"&&o.trim());return e?f.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[f.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-6",children:[f.jsx("h1",{className:"text-2xl font-bold",children:"Video Translation"}),f.jsx("p",{className:"text-indigo-100 mt-1",children:"Translate videos into different languages with AI-powered voice dubbing"})]}),f.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[f.jsx("div",{className:"flex-1 overflow-auto p-6",children:f.jsxs("div",{className:"space-y-6",children:[e&&!nt&&f.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx("svg",{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-amber-800",children:"Region Not Supported"}),f.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Video Translation is currently only available in the following regions:"}),f.jsxs("ul",{className:"text-sm text-amber-700 mt-2 list-disc list-inside grid grid-cols-2 gap-x-4",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Central US"})," (centralus)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"East US"})," (eastus)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Japan East"})," (japaneast)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"North Central US"})," (northcentralus)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"South Central US"})," (southcentralus)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Southeast Asia"})," (southeastasia)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"West Central US"})," (westcentralus)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"West Europe"})," (westeurope)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"West US"})," (westus)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"West US 2"})," (westus2)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"West US 3"})," (westus3)"]})]}),f.jsxs("p",{className:"text-sm text-amber-700 mt-2",children:["Your current region: ",f.jsx("strong",{children:r.region}),". Please change your region in the sidebar settings."]})]})]})}),f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[f.jsxs("button",{onClick:()=>b(!x),className:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-gray-50",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("svg",{className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})}),f.jsx("span",{className:"font-medium text-gray-700",children:"Blob Storage Configuration"}),y.accountName&&f.jsx("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-0.5 rounded",children:"Configured"})]}),f.jsx("svg",{className:`h-5 w-5 text-gray-400 transform transition-transform ${x?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),x&&f.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t",children:[f.jsxs("div",{className:"pt-3",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Storage Account Name"}),f.jsx("input",{type:"text",value:y.accountName,onChange:be=>A({...y,accountName:be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"mystorageaccount"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Container Name"}),f.jsx("input",{type:"text",value:y.containerName,onChange:be=>A({...y,containerName:be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"videos"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SAS Token"}),f.jsx("input",{type:"password",value:y.sasToken,onChange:be=>A({...y,sasToken:be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"?sv=2021-06-08&ss=b..."})]})]})]}),f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[f.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Video Source"}),f.jsxs("div",{className:"flex space-x-4 mb-4",children:[f.jsx("button",{onClick:()=>n("upload"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${t==="upload"?"bg-indigo-100 text-indigo-700":"text-gray-600 hover:bg-gray-100"}`,children:"Upload from Local"}),f.jsx("button",{onClick:()=>n("url"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${t==="url"?"bg-indigo-100 text-indigo-700":"text-gray-600 hover:bg-gray-100"}`,children:"From URL"})]}),t==="upload"?f.jsxs("div",{className:"space-y-4",children:[f.jsx(m$,{onFileSelected:pe,disabled:Ae}),i&&!l&&f.jsx("button",{onClick:Be,disabled:h||Ae,className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:h?f.jsxs(f.Fragment,{children:[f.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),f.jsx("span",{children:"Uploading to Blob..."})]}):f.jsxs(f.Fragment,{children:[f.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),f.jsx("span",{children:"Upload to Blob Storage"})]})}),l&&f.jsxs("div",{className:"flex items-center space-x-2 text-sm text-green-600 bg-green-50 p-3 rounded-md",children:[f.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),f.jsx("span",{children:"Video uploaded to blob storage"})]})]}):f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Video URL"}),f.jsx("input",{type:"url",value:o,onChange:be=>a(be.target.value),placeholder:"https://example.com/video.mp4",disabled:Ae,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"})]}),f.jsx("p",{className:"text-xs text-gray-500",children:"Enter a direct URL to an MP4 video file. The URL must be publicly accessible."})]}),g&&f.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-3",children:g})]}),f.jsxs("div",{className:"flex space-x-4",children:[f.jsxs("button",{onClick:Fe,disabled:!at,className:"flex-1 px-6 py-3 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[f.jsxs("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),f.jsx("span",{children:"Start Translation"})]}),Ae&&f.jsx("button",{onClick:F,className:"px-6 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700",children:"Cancel"})]}),W!=="idle"&&f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[f.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Translation Progress"}),V.translationId&&f.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["Translation ID: ",f.jsx("code",{className:"bg-gray-100 px-2 py-0.5 rounded",children:V.translationId})]}),f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[f.jsx("span",{className:_e(W),children:V.message}),f.jsxs("span",{children:[Math.round(V.step/V.totalSteps*100),"%"]})]}),f.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:f.jsx("div",{className:`h-full transition-all duration-500 ${W==="error"?"bg-red-500":W==="completed"?"bg-green-500":"bg-indigo-500"}`,style:{width:`${V.step/V.totalSteps*100}%`}})})]}),f.jsx("div",{className:"space-y-2",children:["Upload video to blob","Create translation","Generate translated video","Download results"].map((be,yt)=>f.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[V.step>yt+1?f.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):V.step===yt+1&&Ae?f.jsxs("svg",{className:"animate-spin h-5 w-5 text-indigo-500",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):f.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-gray-300"}),f.jsxs("span",{className:V.step>yt?"text-gray-900":"text-gray-400",children:[yt+1,". ",be]})]},yt))}),ce&&f.jsx("div",{className:"mt-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-3",children:ce})]}),W==="completed"&&(ue==null?void 0:ue.result)&&f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[f.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Results"}),f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Translated Video"}),ue.result.translatedVideoFileUrl?f.jsxs("div",{className:"space-y-3",children:[f.jsx("video",{src:ue.result.translatedVideoFileUrl,controls:!0,className:"w-full max-h-[480px] rounded-lg bg-black object-contain"}),f.jsxs("a",{href:ue.result.translatedVideoFileUrl,download:!0,className:"inline-flex items-center space-x-2 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm",children:[f.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),f.jsx("span",{children:"Download Video"})]})]}):f.jsx("p",{className:"text-sm text-gray-500",children:"Video not available"})]}),f.jsxs("div",{className:"border-t pt-4",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Subtitles & Metadata"}),f.jsxs("div",{className:"flex flex-wrap gap-4",children:[ue.result.sourceLocaleSubtitleWebvttFileUrl&&f.jsxs("a",{href:ue.result.sourceLocaleSubtitleWebvttFileUrl,download:!0,className:"flex items-center space-x-2 text-sm text-indigo-600 hover:text-indigo-800 bg-indigo-50 px-3 py-2 rounded-md",children:[f.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),f.jsx("span",{children:"Source Subtitles (WebVTT)"})]}),ue.result.targetLocaleSubtitleWebvttFileUrl&&f.jsxs("a",{href:ue.result.targetLocaleSubtitleWebvttFileUrl,download:!0,className:"flex items-center space-x-2 text-sm text-indigo-600 hover:text-indigo-800 bg-indigo-50 px-3 py-2 rounded-md",children:[f.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),f.jsx("span",{children:"Target Subtitles (WebVTT)"})]}),ue.result.metadataJsonWebvttFileUrl&&f.jsxs("a",{href:ue.result.metadataJsonWebvttFileUrl,download:!0,className:"flex items-center space-x-2 text-sm text-indigo-600 hover:text-indigo-800 bg-indigo-50 px-3 py-2 rounded-md",children:[f.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),f.jsx("span",{children:"Metadata JSON"})]})]})]}),f.jsx("div",{className:"mt-4 pt-4 border-t",children:f.jsx("button",{onClick:ye,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded-md hover:bg-gray-50",children:"Start New Translation"})})]}),f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[f.jsxs("button",{onClick:()=>ne(!J),className:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-gray-50",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("svg",{className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),f.jsx("span",{className:"font-medium text-gray-700",children:"Translation History"}),f.jsxs("span",{className:"text-xs text-gray-500",children:["(",ve.length,")"]})]}),f.jsx("svg",{className:`h-5 w-5 text-gray-400 transform transition-transform ${J?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),J&&f.jsx("div",{className:"border-t",children:ve.length===0?f.jsx("p",{className:"p-4 text-sm text-gray-500 text-center",children:"No translation history yet"}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"max-h-64 overflow-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"bg-gray-50 sticky top-0",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-2 text-left text-gray-600",children:"Name"}),f.jsx("th",{className:"px-4 py-2 text-left text-gray-600",children:"Source"}),f.jsx("th",{className:"px-4 py-2 text-left text-gray-600",children:"Target"}),f.jsx("th",{className:"px-4 py-2 text-left text-gray-600",children:"Status"}),f.jsx("th",{className:"px-4 py-2 text-left text-gray-600",children:"Created"}),f.jsx("th",{className:"px-4 py-2 text-right text-gray-600",children:"Actions"})]})}),f.jsx("tbody",{className:"divide-y",children:ve.map(be=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-4 py-2 truncate max-w-[150px]",title:be.displayName,children:be.displayName||be.translationId.slice(0,8)}),f.jsx("td",{className:"px-4 py-2",children:be.sourceLocale||"Auto"}),f.jsx("td",{className:"px-4 py-2",children:be.targetLocale}),f.jsx("td",{className:"px-4 py-2",children:f.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${be.status==="Succeeded"?"bg-green-100 text-green-800":be.status==="Failed"?"bg-red-100 text-red-800":be.status==="Running"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:be.status})}),f.jsx("td",{className:"px-4 py-2 text-gray-500",children:de(be.createdAt)}),f.jsx("td",{className:"px-4 py-2 text-right",children:f.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[be.resultVideoUrl&&f.jsx("a",{href:be.resultVideoUrl,download:!0,className:"text-indigo-600 hover:text-indigo-800",title:"Download video",children:f.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),f.jsx("button",{onClick:()=>ge(be.id),className:"text-red-600 hover:text-red-800",title:"Remove from history",children:f.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},be.id))})]})}),f.jsx("div",{className:"p-2 border-t bg-gray-50",children:f.jsx("button",{onClick:oe,className:"text-sm text-red-600 hover:text-red-800",children:"Clear All History"})})]})})]})]})}),f.jsxs("div",{className:"w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 overflow-auto",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Translation Settings"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Language"}),f.jsx("select",{value:T,onChange:be=>k(be.target.value),disabled:Ae,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100",children:Jj.map(be=>f.jsx("option",{value:be.code,children:be.label},be.code))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Language"}),f.jsx("select",{value:I,onChange:be=>M(be.target.value),disabled:Ae,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100",children:w$.map(be=>f.jsx("option",{value:be.code,children:be.label},be.code))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Voice Type"}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"flex items-center",children:[f.jsx("input",{type:"radio",value:"PlatformVoice",checked:L==="PlatformVoice",onChange:be=>j(be.target.value),disabled:Ae,className:"mr-2"}),f.jsx("span",{className:"text-sm text-gray-700",children:"Platform Voice (Standard)"})]}),f.jsxs("label",{className:"flex items-center",children:[f.jsx("input",{type:"radio",value:"PersonalVoice",checked:L==="PersonalVoice",onChange:be=>j(be.target.value),disabled:Ae,className:"mr-2"}),f.jsx("span",{className:"text-sm text-gray-700",children:"Personal Voice"})]})]})]}),f.jsxs("div",{className:"border-t pt-4",children:[f.jsxs("button",{onClick:()=>G(!re),className:"flex items-center space-x-2 text-sm text-gray-600 hover:text-gray-900 w-full",children:[f.jsx("svg",{className:`h-4 w-4 transform transition-transform ${re?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),f.jsx("span",{children:"Advanced Options"})]}),re&&f.jsxs("div",{className:"mt-4 space-y-4",children:[f.jsxs("label",{className:"flex items-center",children:[f.jsx("input",{type:"checkbox",checked:B,onChange:be=>z(be.target.checked),disabled:Ae,className:"mr-2"}),f.jsx("span",{className:"text-sm text-gray-700",children:"Enable Lip Sync"})]}),f.jsxs("label",{className:"flex items-center",children:[f.jsx("input",{type:"checkbox",checked:Z,onChange:be=>$(be.target.checked),disabled:Ae,className:"mr-2"}),f.jsx("span",{className:"text-sm text-gray-700",children:"Burn Subtitles in Video"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Speaker Count"}),f.jsx("input",{type:"number",min:"1",max:"10",value:U||"",onChange:be=>Y(be.target.value?parseInt(be.target.value):void 0),placeholder:"Auto-detect",disabled:Ae,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subtitle Max Chars"}),f.jsx("input",{type:"number",min:"10",max:"100",value:ee||"",onChange:be=>X(be.target.value?parseInt(be.target.value):void 0),placeholder:"Default",disabled:Ae,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"})]})]})]})]})]})]})]}):f.jsx("div",{className:"p-8",children:f.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[f.jsx("h3",{className:"text-lg font-medium text-yellow-800 mb-2",children:"Configuration Required"}),f.jsx("p",{className:"text-yellow-700",children:"Please configure your Azure Speech API key and region in the settings panel to use Video Translation."})]})})}const DT=1*1024*1024,r_=50*1024*1024;function k$({onContentChange:r,disabled:e=!1}){const[t,n]=O.useState("text"),[i,s]=O.useState(""),[o,a]=O.useState(""),[l,u]=O.useState(null),[h,m]=O.useState(!1),[g,v]=O.useState(null),y=O.useRef(null),A=z=>{if(v(null),!z){r(null);return}if(z.type==="text"&&z.text&&z.text.length>DT){v(`Text is too long. Maximum ${(DT/1024/1024).toFixed(0)}MB allowed.`);return}if(z.type==="file"&&z.file){if(z.file.size>r_){v(`File is too large. Maximum ${(r_/1024/1024).toFixed(0)}MB allowed.`);return}const Z=z.file.name.toLowerCase();if(!Z.endsWith(".pdf")&&!Z.endsWith(".txt")){v("Only PDF and TXT files are supported.");return}}if(z.type==="url"&&z.url)try{new URL(z.url)}catch{v("Please enter a valid URL.");return}r(z)},x=z=>{s(z),z.trim()?A({type:"text",text:z.trim()}):A(null)},b=z=>{a(z),z.trim()?A({type:"url",url:z.trim()}):A(null)},w=z=>{u(z),A({type:"file",file:z,fileName:z.name})},T=z=>{var $;const Z=($=z.target.files)==null?void 0:$[0];Z&&w(Z)},k=z=>{z.preventDefault(),z.stopPropagation(),z.type==="dragenter"||z.type==="dragover"?m(!0):z.type==="dragleave"&&m(!1)},I=z=>{var $;z.preventDefault(),z.stopPropagation(),m(!1);const Z=($=z.dataTransfer.files)==null?void 0:$[0];Z&&w(Z)},M=()=>{u(null),y.current&&(y.current.value=""),A(null)},L=z=>{n(z),v(null),r(null)},B=t==="text"&&i?i.substring(0,200)+(i.length>200?"...":""):t==="url"&&o?o:t==="file"&&l?`${l.name} (${(l.size/1024).toFixed(1)} KB)`:null;return f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Content Source"}),f.jsxs("div",{className:"flex border-b border-gray-200",children:[f.jsx("button",{onClick:()=>L("text"),disabled:e,className:`px-4 py-2 text-sm font-medium transition-colors ${t==="text"?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-500 hover:text-gray-700"} ${e?"opacity-50 cursor-not-allowed":""}`,children:"Text Input"}),f.jsx("button",{onClick:()=>L("url"),disabled:e,className:`px-4 py-2 text-sm font-medium transition-colors ${t==="url"?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-500 hover:text-gray-700"} ${e?"opacity-50 cursor-not-allowed":""}`,children:"URL"}),f.jsx("button",{onClick:()=>L("file"),disabled:e,className:`px-4 py-2 text-sm font-medium transition-colors ${t==="file"?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-500 hover:text-gray-700"} ${e?"opacity-50 cursor-not-allowed":""}`,children:"File Upload"})]}),f.jsxs("div",{className:"mt-3",children:[t==="text"&&f.jsxs("div",{children:[f.jsx("textarea",{value:i,onChange:z=>x(z.target.value),disabled:e,placeholder:"Paste your text content here (up to 1MB)...",className:"w-full h-48 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed resize-none"}),f.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[i.length.toLocaleString()," / ",DT.toLocaleString()," characters"]})]}),t==="url"&&f.jsxs("div",{children:[f.jsx("input",{type:"url",value:o,onChange:z=>b(z.target.value),disabled:e,placeholder:"https://example.com/document.pdf",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed"}),f.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Enter a public URL to a PDF or HTML document"})]}),t==="file"&&f.jsxs("div",{children:[l?f.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),f.jsxs("div",{children:[f.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.name}),f.jsxs("div",{className:"text-xs text-gray-500",children:[(l.size/1024).toFixed(1)," KB"]})]})]}),f.jsx("button",{onClick:M,disabled:e,className:"text-red-600 hover:text-red-800 disabled:opacity-50",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}):f.jsxs("div",{onDragEnter:k,onDragLeave:k,onDragOver:k,onDrop:I,onClick:()=>{var z;return!e&&((z=y.current)==null?void 0:z.click())},className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${h?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:border-indigo-400 hover:bg-gray-50"} ${e?"opacity-50 cursor-not-allowed":""}`,children:[f.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),f.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[f.jsx("span",{className:"font-medium text-indigo-600",children:"Click to upload"})," or drag and drop"]}),f.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"PDF or TXT files up to 50MB"})]}),f.jsx("input",{ref:y,type:"file",accept:".pdf,.txt",onChange:T,disabled:e,className:"hidden"})]})]}),g&&f.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-md",children:[f.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),f.jsx("div",{className:"text-sm text-red-800",children:g})]}),B&&!g&&f.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md",children:[f.jsx("div",{className:"text-xs text-blue-600 font-medium mb-1",children:"Selected Content:"}),f.jsx("div",{className:"text-sm text-blue-800 break-all",children:B})]})]})}const M$=[{female:"ava",male:"andrew",display:"Ava & Andrew"},{female:"ava",male:"brian",display:"Ava & Brian"},{female:"ava",male:"davis",display:"Ava & Davis"},{female:"ava",male:"steffan",display:"Ava & Steffan"},{female:"ada",male:"andrew",display:"Ada & Andrew"},{female:"ada",male:"brian",display:"Ada & Brian"},{female:"ada",male:"davis",display:"Ada & Davis"},{female:"ada",male:"steffan",display:"Ada & Steffan"},{female:"emma",male:"andrew",display:"Emma & Andrew"},{female:"emma",male:"brian",display:"Emma & Brian"},{female:"emma",male:"davis",display:"Emma & Davis"},{female:"emma",male:"steffan",display:"Emma & Steffan"},{female:"jane",male:"andrew",display:"Jane & Andrew"},{female:"jane",male:"brian",display:"Jane & Brian"},{female:"jane",male:"davis",display:"Jane & Davis"},{female:"jane",male:"steffan",display:"Jane & Steffan"}];function N$({locale:r,selectedPair:e,onPairChange:t,disabled:n=!1}){const[i,s]=O.useState(""),o=O.useMemo(()=>M$,[]),a=O.useMemo(()=>{if(!i)return o;const l=i.toLowerCase();return o.filter(u=>u.display.toLowerCase().includes(l)||u.female.toLowerCase().includes(l)||u.male.toLowerCase().includes(l))},[o,i]);return f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Voice Pair"}),f.jsx("input",{type:"text",placeholder:"Search voice pairs...",value:i,onChange:l=>s(l.target.value),disabled:n,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed"}),e&&f.jsxs("div",{className:"p-2 bg-purple-50 border border-purple-200 rounded-md",children:[f.jsx("div",{className:"text-xs text-purple-600 font-medium",children:"Selected:"}),f.jsx("div",{className:"text-sm text-purple-800",children:e.display}),f.jsxs("div",{className:"text-xs text-purple-600 mt-0.5",children:["Female: ",e.female," | Male: ",e.male]})]}),f.jsxs("div",{className:"border border-gray-200 rounded-md max-h-64 overflow-y-auto",children:[a.length===0&&f.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:i?"No voice pairs found matching search":"No voice pairs available"}),a.map((l,u)=>f.jsx("button",{onClick:()=>t(l),disabled:n,className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${(e==null?void 0:e.female)===l.female&&(e==null?void 0:e.male)===l.male?"bg-purple-50 border-l-4 border-l-purple-600":"hover:bg-gray-50"} ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("span",{className:"text-sm font-medium text-gray-800",children:l.display})}),f.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Female: ",f.jsx("span",{className:"text-pink-600 font-medium",children:l.female})," | Male: ",f.jsxs("span",{className:"text-blue-600 font-medium",children:[" ",l.male]})]})]}),(e==null?void 0:e.female)===l.female&&(e==null?void 0:e.male)===l.male&&f.jsx("svg",{className:"w-5 h-5 text-purple-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]})},`${l.female}-${l.male}`))]}),f.jsxs("div",{className:"text-xs text-gray-500",children:[a.length," voice pair",a.length!==1?"s":""," available",i&&` (filtered from ${o.length})`]})]})}function L$(r,e){return r?{voiceName:"en-us-multitalker-set1:DragonHDV2.4Neural",speakerNames:`${r.female},${r.male}`}:null}const e4="2026-01-01-preview";function t4(r){return`https://${r}.api.cognitive.microsoft.com/podcast`}function r4(r,e){const t={"Ocp-Apim-Subscription-Key":r,"Content-Type":"application/json"};return e&&(t["Operation-Id"]=e),t}async function n4(r){var e,t;if(!r.ok){let n=`API Error: ${r.status} ${r.statusText}`;try{const i=await r.json();console.error("Podcast API Error Response:",i),(e=i.error)!=null&&e.message?n=i.error.message:i.message?n=i.message:(t=i.error)!=null&&t.code&&(n=`${i.error.code}: ${JSON.stringify(i.error)}`)}catch{}throw new Error(n)}return r.status===204?{}:r.json()}async function _$(r){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{const s=n.result.split(",")[1];e(s)},n.onerror=t,n.readAsDataURL(r)})}async function O$(r){if(r.type==="text")return{kind:"PlainText",text:r.text,fileFormat:"Txt"};if(r.type==="url"){const e=r.url.toLowerCase(),t=e.endsWith(".pdf")||e.includes(".pdf?");return{kind:"AzureStorageBlobPublicUrl",url:r.url,fileFormat:t?"Pdf":"Txt"}}if(r.type==="file"&&r.file){const e=await _$(r.file),t=r.file.type==="application/pdf"||r.file.name.toLowerCase().endsWith(".pdf");return{kind:"FileBase64",base64Text:e,fileFormat:t?"Pdf":"Txt"}}throw new Error("Invalid content source")}async function D$(r,e){const t=`${t4(r.region)}/generations/${e.generationId}?api-version=${e4}`,n=crypto.randomUUID(),i={locale:e.locale,host:e.host,content:e.content};e.displayName!==void 0&&(i.displayName=e.displayName),e.scriptGeneration!==void 0&&(i.scriptGeneration=e.scriptGeneration),e.tts!==void 0&&(i.tts=e.tts),console.log("Creating podcast generation:",e.generationId),console.log("Request body:",JSON.stringify(i,null,2));const s=await fetch(t,{method:"PUT",headers:r4(r.apiKey,n),body:JSON.stringify(i)}),o=await n4(s),a=s.headers.get("Operation-Location")||"";return{generation:o,operationLocation:a}}async function j$(r,e){const t=`${t4(r.region)}/generations/${e}?api-version=${e4}`,n=await fetch(t,{method:"GET",headers:r4(r.apiKey)});return n4(n)}async function B$(r,e,t,n=1800*1e3,i=3e3){const s=Date.now();for(;Date.now()-s<n;){const o=await j$(r,e);if(t&&t(o),o.status==="Succeeded")return console.log("Generation succeeded:",e),o;if(o.status==="Failed"){const a=o.failureReason||"Generation failed";throw console.error("Generation failed:",a),new Error(a)}console.log(`Generation ${e} status: ${o.status}`),await new Promise(a=>setTimeout(a,i))}throw new Error(`Generation timed out after ${n/1e3} seconds`)}function z$(){return crypto.randomUUID()}function F$({apiKey:r,region:e}){const[t,n]=O.useState("idle"),[i,s]=O.useState({step:0,totalSteps:5,message:""}),[o,a]=O.useState(null),[l,u]=O.useState(null),h=O.useRef(!1),m=O.useCallback(()=>({region:e,apiKey:r}),[e,r]),g=O.useCallback(async(A,x,b,w,T)=>{var k,I,M;try{a(null),n("creating"),s({step:1,totalSteps:5,message:"Preparing content..."}),h.current=!1,console.log("Starting podcast generation with config:",x);const L=m(),j=z$(),B=await O$(A);if(h.current){n("cancelled");return}s({step:2,totalSteps:5,message:"Creating generation..."}),n("creating");const z={generationId:j,locale:x.locale,host:x.hostType,displayName:`Podcast ${new Date().toLocaleString()}`,content:B,scriptGeneration:{style:x.style,length:x.length,additionalInstructions:x.additionalInstructions||void 0},tts:x.hostType==="TwoHosts"&&b&&w?{voiceName:b,multiTalkerVoiceSpeakerNames:w}:void 0};console.log("Creating generation with params:",z);const{generation:Z}=await D$(L,z);if(h.current){n("cancelled");return}s({step:3,totalSteps:5,message:"Generating script..."}),n("processing");const $=await B$(L,j,U=>{if(h.current)throw new Error("Cancelled by user");U.status==="Running"&&s({step:4,totalSteps:5,message:"Converting to audio..."}),u(U)},1800*1e3,3e3);if(h.current){n("cancelled");return}if(s({step:5,totalSteps:5,message:"Completed!"}),n("completed"),u($),T&&((k=$.output)!=null&&k.audioFileUrl)){const U=A.type==="text"?((I=A.text)==null?void 0:I.substring(0,100))||"":A.type==="url"?A.url||"":((M=A.file)==null?void 0:M.name)||"";T({generationId:$.id,timestamp:Date.now(),displayName:$.displayName||"Podcast",locale:$.locale,hostType:$.host,voiceName:b,style:x.style,length:x.length,status:$.status,audioUrl:$.output.audioFileUrl,contentPreview:U})}return $}catch(L){const j=L instanceof Error?L.message:"Unknown error occurred";throw console.error("Podcast generation failed:",L),j.includes("Cancelled")?(n("cancelled"),a("Generation cancelled")):(n("error"),a(j)),L}},[m]),v=O.useCallback(()=>{console.log("Cancelling podcast generation"),h.current=!0,n("cancelled"),s({step:0,totalSteps:5,message:"Cancelled"})},[]),y=O.useCallback(()=>{n("idle"),s({step:0,totalSteps:5,message:""}),a(null),u(null),h.current=!1},[]);return{status:t,progress:i,error:o,currentGeneration:l,startGeneration:g,cancelGeneration:v,reset:y}}async function W$(r){return new Promise((e,t)=>{const n=new Image;n.crossOrigin="anonymous",n.onload=()=>e(n),n.onerror=i=>t(new Error(`Failed to load image: ${i}`)),n.src=r})}function U$(r,e,t,n){const i=r.getContext("2d");if(!i)return;const s=n||["#667eea","#764ba2","#f093fb"],o=i.createLinearGradient(0,0,e,t);s.length===2?(o.addColorStop(0,s[0]),o.addColorStop(1,s[1])):s.length===3?(o.addColorStop(0,s[0]),o.addColorStop(.5,s[1]),o.addColorStop(1,s[2])):s.forEach((a,l)=>{o.addColorStop(l/(s.length-1),a)}),i.fillStyle=o,i.fillRect(0,0,e,t),i.fillStyle="rgba(255, 255, 255, 0.03)";for(let a=0;a<1e3;a++){const l=Math.random()*e,u=Math.random()*t,h=Math.random()*2;i.fillRect(l,u,h,h)}}function Z$(r,e,t){U$(r,e,t,["#667eea","#764ba2","#f093fb"])}class $${constructor(e){q(this,"canvas");q(this,"ctx");q(this,"audioElement");q(this,"audioContext",null);q(this,"mediaRecorder",null);q(this,"recordedChunks",[]);q(this,"isRecording",!1);q(this,"backgroundImage",null);q(this,"backgroundImageUrl",null);q(this,"audioBlobUrl",null);this.options=e;const t=e.width||1280,n=e.height||720;this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=n;const i=this.canvas.getContext("2d");if(!i)throw new Error("Failed to get canvas 2D context");this.ctx=i,this.audioElement=new Audio}async fetchBingImageUrl(){try{const n=Math.floor(Math.random()*7),i=await fetch(`https://bing.biturl.top/?resolution=1280&format=json&index=${n}&mkt=en-US`);if(i.ok){const s=await i.json();if(s.url)return console.log("Using Bing image (Method 1 - wallpaper API):",s.url),s.url}}catch(n){console.warn("Method 1 (wallpaper API) failed:",n)}try{const n="https://api.allorigins.win/raw?url=",i=encodeURIComponent("https://www.bing.com/HPImageArchive.aspx?format=js&idx=0&n=1&mkt=en-US"),s=await fetch(`${n}${i}`);if(s.ok){const o=await s.json();if(o.images&&o.images.length>0){const a=`https://www.bing.com${o.images[0].url}`;return console.log("Using Bing image (Method 2 - CORS proxy):",a),a}}}catch(n){console.warn("Method 2 (CORS proxy) failed:",n)}const e=["https://www.bing.com/th?id=OHR.NaplesBasilica_EN-US0488733664_1920x1080.jpg","https://www.bing.com/th?id=OHR.AuroraReine_EN-US9682343142_1920x1080.jpg","https://www.bing.com/th?id=OHR.LicancaburVolcano_EN-US9749384708_1920x1080.jpg","https://www.bing.com/th?id=OHR.SnowdoniaSnow_EN-US9892342479_1920x1080.jpg","https://www.bing.com/th?id=OHR.RedRocksArches_EN-US0089294623_1920x1080.jpg"],t=e[Math.floor(Math.random()*e.length)];return console.log("Using fallback Bing image:",t),t}initializeAudioContext(){this.audioContext||(this.audioContext=new AudioContext)}async drawBackground(){try{this.backgroundImageUrl||(this.backgroundImageUrl=await this.fetchBingImageUrl()),this.backgroundImage||(this.backgroundImage=await W$(this.backgroundImageUrl));const e=this.backgroundImage,t=Math.max(this.canvas.width/e.width,this.canvas.height/e.height),n=(this.canvas.width-e.width*t)/2,i=(this.canvas.height-e.height*t)/2;this.ctx.drawImage(e,n,i,e.width*t,e.height*t)}catch(e){console.warn("Failed to load image, using fallback gradient:",e),Z$(this.canvas,this.canvas.width,this.canvas.height)}}async generate(){var e,t;try{console.log("Fetching audio from:",this.options.audioUrl);const i="https://api.allorigins.win/raw?url="+encodeURIComponent(this.options.audioUrl);console.log("Fetching via proxy:",i);const s=await fetch(i);if(!s.ok)throw new Error(`Failed to fetch audio via proxy: ${s.status} ${s.statusText}`);const o=await s.blob(),a=URL.createObjectURL(o);this.audioBlobUrl=a,this.audioElement=new Audio,this.audioElement.src=a,await this.audioElement.load(),await new Promise(y=>{this.audioElement.addEventListener("loadedmetadata",y,{once:!0})}),this.initializeAudioContext(),await this.drawBackground();const l=this.canvas.captureStream(1),u=this.audioContext.createMediaStreamDestination(),h=this.audioContext.createMediaElementSource(this.audioElement);h.connect(u),h.connect(this.audioContext.destination);const m=new MediaStream([...l.getVideoTracks(),...u.stream.getAudioTracks()]),g=["video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/webm"];let v="";for(const y of g)if(MediaRecorder.isTypeSupported(y)){v=y;break}if(!v)throw new Error("No supported video MIME type found");this.mediaRecorder=new MediaRecorder(m,{mimeType:v,videoBitsPerSecond:5e5}),this.recordedChunks=[],this.mediaRecorder.ondataavailable=y=>{y.data.size>0&&this.recordedChunks.push(y.data)},this.mediaRecorder.onstop=()=>{var A,x;const y=new Blob(this.recordedChunks,{type:v});(x=(A=this.options).onComplete)==null||x.call(A,y),this.cleanup()},this.isRecording=!0,this.mediaRecorder.start(),this.audioElement.play(),this.audioElement.addEventListener("timeupdate",()=>{var A,x;const y=this.audioElement.duration>0?this.audioElement.currentTime/this.audioElement.duration:0;(x=(A=this.options).onProgress)==null||x.call(A,y)}),this.audioElement.addEventListener("ended",()=>{this.stop()},{once:!0})}catch(n){console.error("Video generation error:",n),(t=(e=this.options).onError)==null||t.call(e,n),this.cleanup()}}stop(){this.isRecording=!1,this.mediaRecorder&&this.mediaRecorder.state!=="inactive"&&this.mediaRecorder.stop(),this.audioElement.pause()}cleanup(){this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.audioBlobUrl&&(URL.revokeObjectURL(this.audioBlobUrl),this.audioBlobUrl=null)}cancel(){this.stop(),this.cleanup()}}const H$=["eastus","westeurope","southeastasia"],V$=[{code:"en-US",label:"English (US)"},{code:"zh-CN",label:"Chinese (Simplified)"},{code:"ja-JP",label:"Japanese"},{code:"ko-KR",label:"Korean"},{code:"es-ES",label:"Spanish (Spain)"},{code:"fr-FR",label:"French (France)"},{code:"de-DE",label:"German"},{code:"it-IT",label:"Italian"},{code:"pt-BR",label:"Portuguese (Brazil)"}],q$=[{value:"OneHost",label:"Single Host",description:"One narrator guides the podcast"},{value:"TwoHosts",label:"Two Hosts",description:"Conversational format with two speakers"}],G$=[{value:"Default",label:"Default"},{value:"Professional",label:"Professional"},{value:"Casual",label:"Casual"}],K$=[{value:"VeryShort",label:"Very Short",description:"~1 min"},{value:"Short",label:"Short",description:"~3 min"},{value:"Medium",label:"Medium",description:"~5 min"},{value:"Long",label:"Long",description:"~10 min"},{value:"VeryLong",label:"Very Long",description:"~15+ min"}],i4="podcast-agent-config";function Y$(){try{const r=localStorage.getItem(i4);return r?JSON.parse(r):{}}catch{return{}}}function X$(r){localStorage.setItem(i4,JSON.stringify(r))}function J$({settings:r,isConfigured:e,history:t,addToHistory:n,removeFromHistory:i,clearHistory:s}){var Fe;const o=Y$(),[a,l]=O.useState(null),[u,h]=O.useState(o.locale||"en-US"),[m,g]=O.useState(o.hostType||"TwoHosts"),[v,y]=O.useState(o.voicePair||null),[A,x]=O.useState(o.style||"Default"),[b,w]=O.useState(o.length||"Medium"),[T,k]=O.useState(o.additionalInstructions||""),[I,M]=O.useState(!1),[L,j]=O.useState(!1),[B,z]=O.useState(0),[Z,$]=O.useState(null),[U,Y]=O.useState(null),ee=O.useRef(null),{status:X,progress:re,error:G,currentGeneration:J,startGeneration:ne,cancelGeneration:W,reset:V}=F$({apiKey:r.apiKey,region:r.region});O.useEffect(()=>{X$({locale:u,hostType:m,style:A,length:b,additionalInstructions:T,voicePair:v||void 0})},[u,m,A,b,T,v]),O.useEffect(()=>{y(null)},[u,m]);const ce=O.useCallback(async()=>{if(!a)return;const ye={locale:u,hostType:m,style:A,length:b,additionalInstructions:T.trim()||void 0},_e=m==="TwoHosts"?L$(v):null,de=_e==null?void 0:_e.voiceName,Ae=_e==null?void 0:_e.speakerNames;await ne(a,ye,de,Ae,n)},[a,u,m,A,b,T,v,ne,n]),ue=O.useCallback(()=>{V(),l(null)},[V]),ve=O.useCallback(ye=>{ye.audioUrl&&window.open(ye.audioUrl,"_blank")},[]),se=O.useCallback(async()=>{var ye;if((ye=J==null?void 0:J.output)!=null&&ye.audioFileUrl)try{j(!0),z(0),$(null),Y(null);const _e=J.displayName||"AI Podcast",de=new $$({audioUrl:J.output.audioFileUrl,podcastTitle:_e,width:1280,height:720,onProgress:Ae=>{z(Ae)},onComplete:Ae=>{Y(Ae),j(!1),console.log("Video generation completed!",Ae)},onError:Ae=>{$(Ae.message),j(!1),console.error("Video generation error:",Ae)}});ee.current=de,await de.generate()}catch(_e){const de=_e instanceof Error?_e.message:"Unknown error occurred";$(de),j(!1)}},[J]),F=O.useCallback(()=>{ee.current&&(ee.current.cancel(),ee.current=null),j(!1),z(0)},[]),te=O.useCallback(()=>{if(!U)return;const ye=URL.createObjectURL(U),_e=document.createElement("a");_e.href=ye,_e.download=`podcast-${Date.now()}.webm`,document.body.appendChild(_e),_e.click(),document.body.removeChild(_e),URL.revokeObjectURL(ye)},[U]),ge=ye=>new Date(ye).toLocaleString(),oe=["uploading","creating","processing"].includes(X),pe=H$.includes(r.region.toLowerCase()),Be=e&&pe&&!oe&&a!==null&&(m==="OneHost"||m==="TwoHosts"&&v!==null);return e?f.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[f.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6",children:[f.jsx("h1",{className:"text-2xl font-bold",children:"Podcast Agent"}),f.jsx("p",{className:"text-purple-100 mt-1",children:"Generate AI podcasts from your content with natural conversational speech"})]}),f.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[f.jsx("div",{className:"flex-1 overflow-auto p-6",children:f.jsxs("div",{className:"space-y-6",children:[e&&!pe&&f.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx("svg",{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-amber-800",children:"Region Not Supported"}),f.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Podcast Agent is currently only available in the following regions:"}),f.jsxs("ul",{className:"text-sm text-amber-700 mt-2 list-disc list-inside",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"East US"})," (eastus)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"West Europe"})," (westeurope)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Southeast Asia"})," (southeastasia)"]})]}),f.jsxs("p",{className:"text-sm text-amber-700 mt-2",children:["Your current region: ",f.jsx("strong",{children:r.region}),". Please change your region in the sidebar settings."]})]})]})}),f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[f.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Content Source"}),f.jsx(k$,{onContentChange:l,disabled:oe})]}),f.jsxs("div",{className:"flex space-x-3",children:[f.jsx("button",{onClick:ce,disabled:!Be,className:"flex-1 px-6 py-3 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium flex items-center justify-center space-x-2",children:oe?f.jsxs(f.Fragment,{children:[f.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),f.jsx("span",{children:"Generating..."})]}):f.jsxs(f.Fragment,{children:[f.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),f.jsx("span",{children:"Generate Podcast"})]})}),oe&&f.jsx("button",{onClick:W,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 font-medium",children:"Cancel"}),X!=="idle"&&!oe&&f.jsx("button",{onClick:ue,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 font-medium",children:"Reset"})]}),oe&&f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[f.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[f.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),f.jsx("span",{className:"text-sm font-medium text-blue-900",children:re.message})]}),f.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:f.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${re.step/re.totalSteps*100}%`}})}),f.jsxs("div",{className:"mt-2 text-xs text-blue-700",children:["Step ",re.step," of ",re.totalSteps]})]}),G&&f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium text-red-800",children:"Generation Failed"}),f.jsx("p",{className:"text-sm text-red-700 mt-1",children:G})]})]})}),X==="completed"&&((Fe=J==null?void 0:J.output)==null?void 0:Fe.audioFileUrl)&&f.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[f.jsx("h3",{className:"font-medium text-green-900 mb-3",children:"Podcast Generated Successfully!"}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("audio",{controls:!0,className:"w-full",src:J.output.audioFileUrl,children:"Your browser does not support the audio element."}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("a",{href:J.output.audioFileUrl,download:!0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm font-medium",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),f.jsx("span",{children:"Download Audio"})]}),f.jsxs("button",{onClick:se,disabled:L,className:"inline-flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),f.jsx("span",{children:"Generate Video"})]})]})]})]}),L&&f.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("h3",{className:"font-medium text-purple-900",children:"Generating Video..."}),f.jsx("button",{onClick:F,className:"text-sm text-purple-700 hover:text-purple-900 font-medium",children:"Cancel"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"w-full bg-purple-200 rounded-full h-2",children:f.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${B*100}%`}})}),f.jsxs("div",{className:"text-xs text-purple-700",children:[Math.round(B*100),"% complete"]}),f.jsx("div",{className:"text-xs text-purple-600",children:"This may take as long as the audio duration. The video is being recorded in real-time."})]})]}),Z&&f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium text-red-800",children:"Video Generation Failed"}),f.jsx("p",{className:"text-sm text-red-700 mt-1",children:Z})]})]})}),U&&!L&&f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[f.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"Video Generated Successfully!"}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("video",{controls:!0,className:"w-full rounded",src:URL.createObjectURL(U),children:"Your browser does not support the video element."}),f.jsxs("button",{onClick:te,className:"inline-flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm font-medium",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),f.jsx("span",{children:"Download Video (WebM)"})]}),f.jsxs("div",{className:"text-xs text-blue-600",children:["Video size: ",(U.size/1024/1024).toFixed(2)," MB"]})]})]})]})}),f.jsx("div",{className:"w-96 border-l border-gray-200 overflow-auto p-6",children:f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{children:f.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Podcast Configuration"})}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language"}),f.jsx("select",{value:u,onChange:ye=>h(ye.target.value),disabled:oe,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:V$.map(ye=>f.jsx("option",{value:ye.code,children:ye.label},ye.code))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Host Type"}),f.jsx("div",{className:"space-y-2",children:q$.map(ye=>f.jsxs("label",{className:`flex items-start p-3 border rounded-md cursor-pointer transition-colors ${m===ye.value?"border-purple-600 bg-purple-50":"border-gray-200 hover:border-purple-300"} ${oe?"opacity-50 cursor-not-allowed":""}`,children:[f.jsx("input",{type:"radio",value:ye.value,checked:m===ye.value,onChange:_e=>g(_e.target.value),disabled:oe,className:"mt-1 h-4 w-4 text-purple-600 focus:ring-purple-500"}),f.jsxs("div",{className:"ml-3",children:[f.jsx("div",{className:"text-sm font-medium text-gray-900",children:ye.label}),f.jsx("div",{className:"text-xs text-gray-500",children:ye.description})]})]},ye.value))})]}),m==="TwoHosts"&&f.jsx(N$,{locale:u,selectedPair:v,onPairChange:y,disabled:oe}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Style"}),f.jsx("select",{value:A,onChange:ye=>x(ye.target.value),disabled:oe,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:G$.map(ye=>f.jsx("option",{value:ye.value,children:ye.label},ye.value))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Length"}),f.jsx("select",{value:b,onChange:ye=>w(ye.target.value),disabled:oe,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:K$.map(ye=>f.jsxs("option",{value:ye.value,children:[ye.label," ",ye.description]},ye.value))})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Additional Instructions",f.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(optional)"})]}),f.jsx("textarea",{value:T,onChange:ye=>k(ye.target.value),disabled:oe,placeholder:"e.g., Focus on technical details, use casual tone, include examples...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed resize-none"}),f.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[T.length," / 1000 characters"]})]})]})})]}),f.jsxs("div",{className:"border-t border-gray-200",children:[f.jsxs("button",{onClick:()=>M(!I),className:"w-full px-6 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),f.jsx("span",{className:"font-medium text-gray-700",children:"Generation History"}),f.jsxs("span",{className:"text-xs text-gray-500",children:["(",t.length,")"]})]}),f.jsx("svg",{className:`w-5 h-5 text-gray-400 transform transition-transform ${I?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),I&&f.jsx("div",{className:"max-h-96 overflow-auto bg-white",children:t.length===0?f.jsxs("div",{className:"p-8 text-center text-gray-500",children:[f.jsx("p",{children:"No podcast generations yet"}),f.jsx("p",{className:"text-sm mt-1",children:"Your generated podcasts will appear here"})]}):f.jsxs("div",{children:[f.jsxs("div",{className:"px-6 py-3 border-b border-gray-200 flex justify-between items-center",children:[f.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t.length," generation",t.length!==1?"s":""]}),f.jsx("button",{onClick:s,className:"text-xs text-red-600 hover:text-red-800 font-medium",children:"Clear All"})]}),f.jsx("div",{className:"divide-y divide-gray-200",children:t.map(ye=>f.jsx("div",{className:"p-4 hover:bg-gray-50",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[f.jsx("span",{className:"text-sm font-medium text-gray-900",children:ye.displayName}),f.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${ye.status==="Succeeded"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ye.status})]}),f.jsxs("div",{className:"text-xs text-gray-500 space-y-0.5",children:[f.jsxs("div",{children:[ye.locale,"  ",ye.hostType,"  ",ye.style,"  ",ye.length]}),ye.voiceName&&f.jsxs("div",{className:"truncate",children:["Voice: ",ye.voiceName]}),f.jsx("div",{children:ge(ye.timestamp)}),f.jsxs("div",{className:"truncate italic",children:['"',ye.contentPreview,'"']})]})]}),f.jsxs("div",{className:"ml-3 flex space-x-2",children:[ye.audioUrl&&f.jsx("button",{onClick:()=>ve(ye),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Play",children:f.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),f.jsx("button",{onClick:()=>i(ye.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",title:"Remove",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},ye.id))})]})})]})]}):f.jsx("div",{className:"p-8",children:f.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[f.jsx("h3",{className:"text-lg font-medium text-yellow-800 mb-2",children:"Configuration Required"}),f.jsx("p",{className:"text-yellow-700",children:"Please configure your Azure Speech API key and region in the settings panel to use Podcast Agent."})]})})}const Q$="gemini-2.5-flash-native-audio-preview-12-2025",eH=24e3;class tH{constructor(e){q(this,"ws",null);q(this,"config");q(this,"productData","");this.config=e}setProductData(e){this.productData=e}async connect(){const e=`wss://generativelanguage.googleapis.com/ws/google.ai.generativelanguage.v1alpha.GenerativeService.BidiGenerateContent?key=${this.config.apiKey}`;return this.config.onStatusChange("connecting"),new Promise((t,n)=>{try{this.ws=new WebSocket(e),this.ws.onopen=()=>{console.log("[Gemini] WebSocket connected"),this.sendSetup(),this.config.onStatusChange("connected"),t()},this.ws.onmessage=i=>{this.handleMessage(i.data)},this.ws.onerror=i=>{console.error("[Gemini] WebSocket error:",i),this.config.onError("WebSocket connection error"),this.config.onStatusChange("error"),n(i)},this.ws.onclose=i=>{console.log("[Gemini] WebSocket closed:",i.code,i.reason),this.config.onStatusChange("disconnected")}}catch(i){this.config.onError(`Failed to connect: ${i}`),this.config.onStatusChange("error"),n(i)}})}sendSetup(){const e=this.config.enableProductLookup?[{function_declarations:[{name:"get_product_inventory",description:"Retrieves the full product catalog including SKUs, sizes, colors, and prices. Use this when the user asks about products, inventory, prices, or availability.",parameters:{type:"object",properties:{},required:[]}}]}]:[],t=this.config.interruptionSensitivity||"medium";let n,i,s;switch(t){case"low":n=1,i=1,s=800;break;case"high":n=3,i=3,s=300;break;case"medium":default:n=2,i=2,s=500;break}const o=this.config.systemPrompt||(this.config.enableProductLookup?`You are a helpful voice assistant. You help customers find products.

When asked about products, use the get_product_inventory tool to retrieve the product catalog. Be conversational and helpful.

Keep your responses concise and natural for voice interaction. Focus on the most relevant information.`:`You are a helpful voice assistant for testing Gemini Live API integration with Azure TTS Playground.

Keep your responses concise and natural for voice interaction.`),a={setup:{model:`models/${Q$}`,...e.length>0&&{tools:e},generation_config:{response_modalities:["AUDIO"],speech_config:{voice_config:{prebuilt_voice_config:{voice_name:"Zephyr"}}}},realtime_input_config:{automatic_activity_detection:{disabled:!1,start_of_speech_sensitivity:n,end_of_speech_sensitivity:i,prefix_padding_ms:20,silence_duration_ms:s}},input_audio_transcription:{},output_audio_transcription:{},system_instruction:{parts:[{text:o}]}}};console.log("[Gemini] Sending setup message with sensitivity:",t),this.send(a)}async handleMessage(e){var t;try{let n;e instanceof Blob?n=await e.text():n=e;const i=JSON.parse(n);if(i.toolCall){const s=i.toolCall.functionCalls||[];for(const o of s)await this.handleToolCall(o);return}if(i.serverContent){if(i.serverContent.interrupted){console.log("[Gemini] Generation was interrupted by user"),this.config.onInterrupted();return}if(i.serverContent.inputTranscription){const o=i.serverContent.inputTranscription.text;o&&this.config.onInputTranscript(o)}if(i.serverContent.outputTranscription){const o=i.serverContent.outputTranscription.text;o&&this.config.onOutputTranscript(o)}const s=((t=i.serverContent.modelTurn)==null?void 0:t.parts)||[];for(const o of s)if(!o.thought&&(o.text&&this.config.onOutputTranscript(o.text),o.inlineData)){const a=o.inlineData.data,l=this.base64ToArrayBuffer(a);this.config.onAudioData(l)}i.serverContent.turnComplete&&this.config.onTurnComplete()}}catch(n){console.error("[Gemini] Error parsing message:",n)}}async handleToolCall(e){console.log("[Gemini] Tool call received:",e.name),this.config.onToolCall(e.name);let t;e.name==="get_product_inventory"?t=this.productData||"No product data available. Please enable product lookup.":t=`Unknown tool: ${e.name}`;const n={tool_response:{function_responses:[{id:e.id,name:e.name,response:{result:t}}]}};this.send(n)}sendAudio(e){if(!this.ws||this.ws.readyState!==WebSocket.OPEN)return;const t=this.arrayBufferToBase64(e),n={realtime_input:{media_chunks:[{mime_type:`audio/pcm;rate=${eH}`,data:t}]}};this.send(n)}sendText(e){if(!this.ws||this.ws.readyState!==WebSocket.OPEN)return;const t={client_content:{turns:[{role:"user",parts:[{text:e}]}],turn_complete:!0}};this.send(t)}send(e){this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify(e))}disconnect(){this.ws&&(this.ws.close(),this.ws=null),this.config.onStatusChange("disconnected")}base64ToArrayBuffer(e){const t=atob(e),n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n.buffer}arrayBufferToBase64(e){const t=new Uint8Array(e);let n="";for(let i=0;i<t.length;i++)n+=String.fromCharCode(t[i]);return btoa(n)}}const jg=24e3,rH=4096;class nH{constructor(){q(this,"recordingContext");q(this,"playbackContext");q(this,"mediaStream",null);q(this,"sourceNode",null);q(this,"processorNode",null);q(this,"analyserNode",null);q(this,"playbackAnalyser",null);q(this,"onAudioData",null);q(this,"isRecording",!1);q(this,"playbackQueue",[]);q(this,"nextPlayTime",0);q(this,"isPlaybackStarted",!1);q(this,"circleElement",null);q(this,"animationFrameId",null);q(this,"dataArray",null);q(this,"currentAnimationType",null);this.recordingContext=new AudioContext({sampleRate:jg}),this.playbackContext=new AudioContext({sampleRate:jg})}setCircleElement(e){this.circleElement=e}async startRecording(e){this.onAudioData=e;try{this.mediaStream=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:jg,channelCount:1,echoCancellation:!0,noiseSuppression:!0}}),this.recordingContext.state==="suspended"&&await this.recordingContext.resume(),this.sourceNode=this.recordingContext.createMediaStreamSource(this.mediaStream),this.analyserNode=this.recordingContext.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.7,this.analyserNode.minDecibels=-90,this.analyserNode.maxDecibels=-10,this.dataArray=new Uint8Array(this.analyserNode.frequencyBinCount),this.processorNode=this.recordingContext.createScriptProcessor(rH,1,1),this.processorNode.onaudioprocess=t=>{if(!this.isRecording||!this.onAudioData)return;const n=t.inputBuffer.getChannelData(0),i=new Int16Array(n.length);for(let s=0;s<n.length;s++){const o=Math.max(-1,Math.min(1,n[s]));i[s]=o<0?o*32768:o*32767}this.onAudioData(i.buffer)},this.sourceNode.connect(this.analyserNode),this.analyserNode.connect(this.processorNode),this.processorNode.connect(this.recordingContext.destination),this.isRecording=!0,this.circleElement&&this.startAnimation("record"),console.log("[Gemini Audio] Recording started")}catch(t){throw console.error("[Gemini Audio] Error starting recording:",t),t}}stopRecording(){this.isRecording=!1,this.processorNode&&(this.processorNode.disconnect(),this.processorNode=null),this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=null),this.mediaStream&&(this.mediaStream.getTracks().forEach(e=>e.stop()),this.mediaStream=null),this.stopAnimation(),console.log("[Gemini Audio] Recording stopped")}queueAudioForPlayback(e){try{this.playbackContext.state==="suspended"&&this.playbackContext.resume();const t=new Int16Array(e),n=new Float32Array(t.length);for(let l=0;l<t.length;l++)n[l]=t[l]/32768;const i=this.playbackContext.createBuffer(1,n.length,jg);i.getChannelData(0).set(n);const s=this.playbackContext.createBufferSource();s.buffer=i,this.playbackAnalyser||(this.playbackAnalyser=this.playbackContext.createAnalyser(),this.playbackAnalyser.fftSize=2048,this.playbackAnalyser.smoothingTimeConstant=.7,this.playbackAnalyser.minDecibels=-90,this.playbackAnalyser.maxDecibels=-10),s.connect(this.playbackAnalyser),this.playbackAnalyser.connect(this.playbackContext.destination),this.circleElement&&this.startAnimation("play");const o=this.playbackContext.currentTime;this.isPlaybackStarted||(this.nextPlayTime=o+.05,this.isPlaybackStarted=!0),this.nextPlayTime<o&&(this.nextPlayTime=o+.01),s.start(this.nextPlayTime),this.playbackQueue.push(s),s.onended=()=>{const l=this.playbackQueue.indexOf(s);l>-1&&this.playbackQueue.splice(l,1),this.playbackQueue.length===0&&this.mediaStream&&this.circleElement&&this.startAnimation("record")};const a=n.length/jg;this.nextPlayTime+=a}catch(t){console.error("[Gemini Audio] Error queuing audio:",t)}}startAnimation(e){if(this.currentAnimationType===e&&this.animationFrameId)return;this.stopAnimation(),this.currentAnimationType=e;const t=()=>{const n=e==="record"?this.analyserNode:this.playbackAnalyser;if(!n||!this.circleElement){console.warn("[Gemini Audio] Animation stopped - missing analyser or circle");return}(!this.dataArray||this.dataArray.length!==n.frequencyBinCount)&&(this.dataArray=new Uint8Array(n.frequencyBinCount)),n.getByteFrequencyData(this.dataArray);const i=Array.from(this.dataArray).reduce((s,o)=>s+o,0)/this.dataArray.length;this.updateCircle(i,e),this.animationFrameId=requestAnimationFrame(t)};console.log("[Gemini Audio] Starting animation:",e),t()}stopAnimation(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.currentAnimationType=null}updateCircle(e,t){if(!this.circleElement)return;const s=Math.min(120+e*3,200),o=Math.min(e/128,1);let a;if(t==="record"){const l=160+o*20,u=180+o*30,h=60+o*40,m=70-o*20;a=`linear-gradient(135deg, hsl(${l}, ${h}%, ${m}%), hsl(${u}, ${h}%, ${m}%))`}else{const l=260+o*20,u=300+o*30,h=60+o*40,m=70-o*20;a=`linear-gradient(135deg, hsl(${l}, ${h}%, ${m}%), hsl(${u}, ${h}%, ${m}%))`}this.circleElement.style.background=a,this.circleElement.style.width=`${s}px`,this.circleElement.style.height=`${s}px`,this.circleElement.style.boxShadow=`0 0 ${20+o*30}px rgba(${t==="record"?"20, 184, 166":"168, 85, 247"}, ${.3+o*.4})`}resetPlayback(){this.stopAnimation(),this.playbackQueue.forEach(e=>{try{e.stop()}catch{}}),this.playbackQueue=[],this.isPlaybackStarted=!1,this.nextPlayTime=0}stopPlayback(){console.log("[Gemini Audio] Stopping audio playback due to interruption"),this.stopAnimation(),this.playbackQueue.forEach(e=>{try{e.stop()}catch{}}),this.playbackQueue=[],this.isPlaybackStarted=!1,this.nextPlayTime=0,this.mediaStream&&this.circleElement&&this.startAnimation("record")}cleanup(){this.stopRecording(),this.resetPlayback(),this.recordingContext&&this.recordingContext.state!=="closed"&&this.recordingContext.close(),this.playbackContext&&this.playbackContext.state!=="closed"&&this.playbackContext.close()}}const iH=`
Zava Shop SKU Inventory (Expanded)
ZavaCore Field Premium
Product Name
Product Style
SKU
Size
Color
Price
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Long  Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
LS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel Women's
Athletic Apparel
ZCPTW-:S-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Sorts Mens
Athletic Shorts
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPSM
AS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Shorts Women's
Athletic Shorts
Small Trim
$89
ZavaCore Premium Athletic Apparel Women's
Athletic Apparel
ZCPSW
AS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts
Athletic Shorts
ZCPTS-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Shorts Youth
Athletic Shorts
Small Trim
$89
ZavaCore Premium Athletic Apparel Youth
Athletic Apparel
ZCPSY
AS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Pants Mens
Athletic Pants
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPPM
AP
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Pants Women's
Athletic Pants
Small Trim
$89
ZavaCore Premium Athletic Apparel Women's
Athletic Apparel
ZCPPW
AP
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Pants Youth
Athletic Pants
Small Trim
$89
ZavaCore Premium Athletic Apparel Youth
Athletic Apparel
ZCPPY
AP
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Women's
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Women's
Athletic Apparel
ZCETW
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Elite Pants Mens
Athletic Pants
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCEPM
AP
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Field Elite
Product Name
Product Style
SKU
Size
Color
Price
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Elite Athletic Apparel Men's
Athletic Apparel
ZCETM
SS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Youth
Short Sleeve
Small Trim
$89
ZavaCore Elite Athletic Apparel Youth
Athletic Apparel
ZCETY
SS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Elite Athletic Apparel Men's
Athletic Apparel
ZCETM
SS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Womens
Long Sleeve
Small Trim
$89
ZavaCore Elite Athletic Apparel Women's
Athletic Apparel
ZCPTW
LS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel Women's
Athletic Apparel
ZCETW-:S-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Youth
Long Sleeve
Small Trim
$89
ZavaCore Elite Athletic Apparel Youth
Athletic Apparel
ZCETY
LS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Sorts Mens
Athletic Shorts
Small Trim
$89
ZavaCore Elite Athletic Apparel Men's
Athletic Apparel
ZCESM
AS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Shorts Women's
Athletic Shorts
Small Trim
$89
ZavaCore Elite Athletic Apparel Women's
Athletic Apparel
ZCESW
AS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts
Athletic Shorts
ZCETS-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Shorts Youth
Athletic Shorts
Small Trim
$89
ZavaCore Elite Athletic Apparel Youth
Athletic Apparel
ZCPSY
AS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Pants Women's
Athletic Pants
Small Trim
$89
ZavaCore Elite Athletic Apparel Women's
Athletic Apparel
ZCEPW
AP
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Pants Youth
Athletic Pants
Small Trim
$89
ZavaCore Elite Athletic Apparel Youth
Athletic Apparel
ZCEPY
AP
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89

`;function sH({}){const[r,e]=O.useState(()=>localStorage.getItem("gemini-api-key")||""),[t,n]=O.useState("disconnected"),[i,s]=O.useState(!1),[o,a]=O.useState(!1),[l,u]=O.useState([]),[h,m]=O.useState(""),[g,v]=O.useState(!1),[y,A]=O.useState("medium"),[x,b]=O.useState(""),[w,T]=O.useState(null),k=O.useRef(null),I=O.useRef(null),M=O.useRef(null),L=O.useRef(null),j=O.useRef({inputTranscript:"",outputTranscript:"",inputMessageId:null,outputMessageId:null});O.useEffect(()=>{r&&localStorage.setItem("gemini-api-key",r)},[r]),O.useEffect(()=>{var J;(J=M.current)==null||J.scrollIntoView({behavior:"smooth"})},[l.length]),O.useEffect(()=>()=>{k.current&&k.current.disconnect(),I.current&&I.current.cleanup()},[]),O.useEffect(()=>{I.current&&L.current&&I.current.setCircleElement(L.current)},[]);const B=O.useCallback(J=>{u(ne=>[...ne,J])},[]),z=O.useCallback((J,ne)=>{u(W=>W.map(V=>V.id===J?{...V,content:ne}:V))},[]);async function Z(){if(!r.trim()){T("Please enter a Gemini API key");return}k.current&&k.current.disconnect(),I.current&&I.current.cleanup(),j.current={inputTranscript:"",outputTranscript:"",inputMessageId:null,outputMessageId:null};const J=new nH;I.current=J,L.current&&J.setCircleElement(L.current);const ne=new tH({apiKey:r,enableProductLookup:g,interruptionSensitivity:y,systemPrompt:x.trim()||void 0,onAudioData:W=>{J.queueAudioForPlayback(W)},onInputTranscript:W=>{const V=j.current;if(V.inputTranscript+=W,V.inputMessageId)z(V.inputMessageId,V.inputTranscript);else{const ce=crypto.randomUUID();V.inputMessageId=ce,B({id:ce,type:"user",content:V.inputTranscript,timestamp:new Date})}},onOutputTranscript:W=>{const V=j.current;if(V.inputTranscript&&(V.inputTranscript="",V.inputMessageId=null),V.outputTranscript+=W,V.outputMessageId)z(V.outputMessageId,V.outputTranscript);else{const ce=crypto.randomUUID();V.outputMessageId=ce,B({id:ce,type:"assistant",content:V.outputTranscript,timestamp:new Date})}},onToolCall:W=>{j.current.outputTranscript="",j.current.outputMessageId=null,B({id:crypto.randomUUID(),type:"system",content:`Calling function: ${W}`,timestamp:new Date})},onTurnComplete:()=>{j.current={inputTranscript:"",outputTranscript:"",inputMessageId:null,outputMessageId:null}},onInterrupted:()=>{J.stopPlayback(),j.current.outputTranscript="",j.current.outputMessageId=null,B({id:crypto.randomUUID(),type:"system",content:"[Interrupted]",timestamp:new Date})},onError:W=>{T(W)},onStatusChange:W=>{n(W),W==="disconnected"&&(j.current={inputTranscript:"",outputTranscript:"",inputMessageId:null,outputMessageId:null})}});g&&ne.setProductData(iH),k.current=ne;try{T(null),await ne.connect(),await U()}catch(W){T(`Connection failed: ${W}`)}}async function $(){I.current&&I.current.stopRecording(),k.current&&k.current.disconnect(),s(!1)}async function U(){if(!(!I.current||!k.current))try{await I.current.startRecording(J=>{var ne;(ne=k.current)==null||ne.sendAudio(J)}),s(!0),T(null)}catch(J){T(`Microphone access failed: ${J}`)}}function Y(){I.current&&I.current.stopRecording(),s(!1)}function ee(){i?Y():U()}function X(){!h.trim()||!k.current||t!=="connected"||(B({id:crypto.randomUUID(),type:"user",content:h,timestamp:new Date}),k.current.sendText(h),m(""))}function re(){j.current={inputTranscript:"",outputTranscript:"",inputMessageId:null,outputMessageId:null},u([])}function G(J){switch(J){case"user":return"bg-blue-100 text-blue-900 ml-auto";case"assistant":return"bg-gray-100 text-gray-900 mr-auto";case"system":return"bg-yellow-100 text-yellow-800 mx-auto text-xs";default:return"bg-gray-100 text-gray-900"}}return f.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[f.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[f.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 shadow-md",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold",children:"Gemini Live"}),f.jsx("p",{className:"text-purple-100 mt-1",children:"Real-time voice conversation with Gemini AI"})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${t==="connected"?"bg-green-500/20 text-green-100":"bg-white/20 text-white/80"}`,children:[f.jsx("span",{className:`w-2 h-2 rounded-full ${t==="connected"?"bg-green-400":"bg-white/60"}`}),t.charAt(0).toUpperCase()+t.slice(1)]}),i&&f.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium bg-red-500/20 text-red-100",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-red-400 animate-pulse"}),"Recording"]})]})]})}),f.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center py-8 bg-white border-b border-gray-100",style:{height:"320px"},children:[f.jsx("div",{ref:L,className:"rounded-full transition-all duration-150 ease-out flex items-center justify-center",style:{width:"120px",height:"120px",backgroundColor:"#e5e7eb"},children:o?f.jsx("svg",{className:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})}):f.jsx("svg",{className:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),t!=="connected"&&f.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Click Connect to begin conversation"})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-white",children:l.length===0?f.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[f.jsx("p",{className:"text-sm",children:"Connect and speak to start chatting with Gemini"}),g&&f.jsx("p",{className:"text-xs mt-2 text-gray-500",children:'Try asking: "What products do you have?"'})]}):f.jsxs(f.Fragment,{children:[l.map(J=>f.jsxs("div",{className:`max-w-[80%] px-4 py-2 rounded-lg ${G(J.type)}`,children:[f.jsx("p",{className:"whitespace-pre-wrap",children:J.content}),f.jsx("p",{className:"text-xs opacity-60 mt-1",children:J.timestamp.toLocaleTimeString()})]},J.id)),f.jsx("div",{ref:M})]})}),f.jsxs("div",{className:"bg-gray-50 border-t border-gray-200 p-4",children:[f.jsxs("div",{className:"flex gap-2 mb-2",children:[f.jsx("input",{type:"text",value:h,onChange:J=>m(J.target.value),onKeyDown:J=>{J.key==="Enter"&&!J.shiftKey&&(J.preventDefault(),X())},placeholder:"Type a message (or just speak)...",disabled:t!=="connected",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed"}),f.jsx("button",{onClick:X,disabled:t!=="connected"||!h.trim(),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})}),f.jsx("button",{onClick:re,disabled:l.length===0,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Clear chat",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),w&&f.jsx("p",{className:"text-xs text-red-600",children:w})]})]}),f.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-y-auto",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuration"}),f.jsxs("div",{className:"space-y-4 flex-1",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gemini API Key"}),f.jsx("input",{type:"password",value:r,onChange:J=>e(J.target.value),disabled:t==="connected",placeholder:"Enter your API key",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100"}),f.jsx("a",{href:"https://aistudio.google.com/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-purple-600 hover:text-purple-700 underline mt-1 inline-block",children:"Get API key"})]}),f.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[f.jsxs("label",{className:"flex items-center gap-2 mb-2",children:[f.jsx("input",{type:"checkbox",checked:g,onChange:J=>v(J.target.checked),disabled:t==="connected",className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),f.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Product Lookup"})]}),f.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Allows Gemini to look up product information when asked"})]}),f.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interruption Sensitivity"}),f.jsxs("select",{value:y,onChange:J=>A(J.target.value),disabled:t==="connected",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100",children:[f.jsx("option",{value:"low",children:"Low - Less likely to interrupt"}),f.jsx("option",{value:"medium",children:"Medium - Balanced"}),f.jsx("option",{value:"high",children:"High - More responsive"})]}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How easily Gemini gets interrupted when you speak"})]}),f.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"System Prompt"}),f.jsxs("select",{onChange:J=>{J.target.value!=="custom"&&b(J.target.value)},disabled:t==="connected",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100 mb-2",children:[f.jsx("option",{value:"",children:"Default (based on product lookup setting)"}),f.jsx("option",{value:`You are a helpful and friendly AI assistant. Be concise and natural in your responses.\r
\r
Please only respond in English.`,children:"Voice Live Default"}),f.jsx("option",{value:`You are a helpful voice assistant. You help customers find products.\r
\r
When asked about products, use the get_product_inventory tool to retrieve the product catalog. Be conversational and helpful.\r
\r
Keep your responses concise and natural for voice interaction. Focus on the most relevant information.`,children:"Gemini Product Assistant"}),f.jsx("option",{value:`You are a helpful voice assistant for testing Gemini Live API integration with Azure TTS Playground.\r
\r
Keep your responses concise and natural for voice interaction.`,children:"Gemini Testing Assistant"}),f.jsx("option",{value:"custom",children:"Custom (edit below)"})]}),f.jsx("textarea",{value:x,onChange:J=>b(J.target.value),disabled:t==="connected",placeholder:"Leave empty for default prompt",rows:6,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100 resize-none font-mono"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select a preset or write custom instructions for Gemini's behavior"})]}),f.jsx("div",{className:"pt-2",children:t!=="connected"?f.jsxs("button",{onClick:Z,disabled:!r.trim()||t==="connecting",className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M8 5v14l11-7z"})}),t==="connecting"?"Connecting...":"Connect"]}):f.jsxs("button",{onClick:$,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M6 6h12v12H6z"})}),"Disconnect"]})}),t==="connected"&&f.jsx("div",{className:"pt-2",children:f.jsxs("button",{onClick:ee,className:`w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-md transition-colors ${i?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),i?"Mute Microphone":"Unmute Microphone"]})}),f.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[f.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"About"}),f.jsx("p",{className:"text-xs text-gray-600",children:"This playground demonstrates Gemini Live API integration with real-time voice conversation and optional function calling capabilities."})]})]})]})]})}const s4=["text-to-speech","speech-to-text","voice-changer","multi-talker","voice-creation","video-translation","voice-live-chat","voice-live-translator","podcast-agent","gemini-live"];function oH(){const r=window.location.hash.slice(1);return r&&s4.includes(r)?r:"text-to-speech"}function aH(){const{settings:r,updateSettings:e,isConfigured:t}=m3(),[n,i]=O.useState(oH),o=new URLSearchParams(window.location.search).has("geminilive");O.useEffect(()=>{window.location.hash=n},[n]),O.useEffect(()=>{const v=()=>{const y=window.location.hash.slice(1);y&&s4.includes(y)&&i(y)};return window.addEventListener("hashchange",v),()=>window.removeEventListener("hashchange",v)},[]);const a=g3(),l=v3(),u=S3(),h=y3(),m=b3(),g=()=>{switch(n){case"text-to-speech":return f.jsx(kF,{settings:r,onSettingsChange:e,isConfigured:t,history:a.history,addToHistory:a.addToHistory,removeFromHistory:a.removeFromHistory,clearHistory:a.clearHistory});case"speech-to-text":return f.jsx(h6,{settings:r,onSettingsChange:e,isConfigured:t,history:h.history,addToHistory:h.addToHistory,removeFromHistory:h.removeFromHistory,clearHistory:h.clearHistory});case"voice-changer":return f.jsx(S6,{settings:r,onSettingsChange:e,isConfigured:t,history:l.history,addToHistory:l.addToHistory,removeFromHistory:l.removeFromHistory,clearHistory:l.clearHistory});case"multi-talker":return f.jsx(EU,{settings:r,onSettingsChange:e,isConfigured:t,history:u.history,addToHistory:u.addToHistory,removeFromHistory:u.removeFromHistory,clearHistory:u.clearHistory});case"voice-creation":return f.jsx(h$,{settings:r});case"video-translation":return f.jsx(I$,{settings:r,isConfigured:t});case"voice-live-chat":return f.jsx(d$,{endpoint:r.voiceLiveEndpoint||"",apiKey:r.voiceLiveApiKey||""});case"voice-live-translator":return f.jsx(s$,{endpoint:r.voiceLiveEndpoint||"",apiKey:r.voiceLiveApiKey||""});case"podcast-agent":return f.jsx(J$,{settings:r,isConfigured:t,history:m.history,addToHistory:m.addToHistory,removeFromHistory:m.removeFromHistory,clearHistory:m.clearHistory});case"gemini-live":return f.jsx(sH,{});default:return null}};return f.jsxs("div",{className:"h-screen flex overflow-hidden bg-white",children:[f.jsx(w3,{activeMode:n,onModeChange:i,settings:r,onSettingsChange:e,geminiLiveEnabled:o}),g()]})}h3.createRoot(document.getElementById("root")).render(f.jsx(o_.StrictMode,{children:f.jsx(aH,{})}));
