var J3=Object.defineProperty;var c_=n=>{throw TypeError(n)};var X3=(n,e,t)=>e in n?J3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var q=(n,e,t)=>X3(n,typeof e!="symbol"?e+"":e,t),tx=(n,e,t)=>e.has(n)||c_("Cannot "+t);var f=(n,e,t)=>(tx(n,e,"read from private field"),t?t.call(n):e.get(n)),L=(n,e,t)=>e.has(n)?c_("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),_=(n,e,t,r)=>(tx(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),B=(n,e,t)=>(tx(n,e,"access private method"),t);var An=(n,e,t,r)=>({set _(i){_(n,e,i,t)},get _(){return f(n,e,r)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function uB(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Q3(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var nx={exports:{}},mf={},rx={exports:{}},rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u_;function e5(){if(u_)return rt;u_=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),h=Symbol.iterator;function m($){return $===null||typeof $!="object"?null:($=h&&$[h]||$["@@iterator"],typeof $=="function"?$:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,T={};function E($,J,de){this.props=$,this.context=J,this.refs=T,this.updater=de||v}E.prototype.isReactComponent={},E.prototype.setState=function($,J){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,J,"setState")},E.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function x(){}x.prototype=E.prototype;function P($,J,de){this.props=$,this.context=J,this.refs=T,this.updater=de||v}var b=P.prototype=new x;b.constructor=P,C(b,E.prototype),b.isPureReactComponent=!0;var I=Array.isArray,M=Object.prototype.hasOwnProperty,N={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function j($,J,de){var me,Te={},le=null,se=null;if(J!=null)for(me in J.ref!==void 0&&(se=J.ref),J.key!==void 0&&(le=""+J.key),J)M.call(J,me)&&!D.hasOwnProperty(me)&&(Te[me]=J[me]);var ie=arguments.length-2;if(ie===1)Te.children=de;else if(1<ie){for(var Se=Array(ie),re=0;re<ie;re++)Se[re]=arguments[re+2];Te.children=Se}if($&&$.defaultProps)for(me in ie=$.defaultProps,ie)Te[me]===void 0&&(Te[me]=ie[me]);return{$$typeof:n,type:$,key:le,ref:se,props:Te,_owner:N.current}}function F($,J){return{$$typeof:n,type:$.type,key:J,ref:$.ref,props:$.props,_owner:$._owner}}function z($){return typeof $=="object"&&$!==null&&$.$$typeof===n}function W($){var J={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(de){return J[de]})}var H=/\/+/g;function V($,J){return typeof $=="object"&&$!==null&&$.key!=null?W(""+$.key):J.toString(36)}function K($,J,de,me,Te){var le=typeof $;(le==="undefined"||le==="boolean")&&($=null);var se=!1;if($===null)se=!0;else switch(le){case"string":case"number":se=!0;break;case"object":switch($.$$typeof){case n:case e:se=!0}}if(se)return se=$,Te=Te(se),$=me===""?"."+V(se,0):me,I(Te)?(de="",$!=null&&(de=$.replace(H,"$&/")+"/"),K(Te,J,de,"",function(re){return re})):Te!=null&&(z(Te)&&(Te=F(Te,de+(!Te.key||se&&se.key===Te.key?"":(""+Te.key).replace(H,"$&/")+"/")+$)),J.push(Te)),1;if(se=0,me=me===""?".":me+":",I($))for(var ie=0;ie<$.length;ie++){le=$[ie];var Se=me+V(le,ie);se+=K(le,J,de,Se,Te)}else if(Se=m($),typeof Se=="function")for($=Se.call($),ie=0;!(le=$.next()).done;)le=le.value,Se=me+V(le,ie++),se+=K(le,J,de,Se,Te);else if(le==="object")throw J=String($),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.");return se}function ee($,J,de){if($==null)return $;var me=[],Te=0;return K($,me,"","",function(le){return J.call(de,le,Te++)}),me}function G($){if($._status===-1){var J=$._result;J=J(),J.then(function(de){($._status===0||$._status===-1)&&($._status=1,$._result=de)},function(de){($._status===0||$._status===-1)&&($._status=2,$._result=de)}),$._status===-1&&($._status=0,$._result=J)}if($._status===1)return $._result.default;throw $._result}var X={current:null},Y={transition:null},ce={ReactCurrentDispatcher:X,ReactCurrentBatchConfig:Y,ReactCurrentOwner:N};function ae(){throw Error("act(...) is not supported in production builds of React.")}return rt.Children={map:ee,forEach:function($,J,de){ee($,function(){J.apply(this,arguments)},de)},count:function($){var J=0;return ee($,function(){J++}),J},toArray:function($){return ee($,function(J){return J})||[]},only:function($){if(!z($))throw Error("React.Children.only expected to receive a single React element child.");return $}},rt.Component=E,rt.Fragment=t,rt.Profiler=i,rt.PureComponent=P,rt.StrictMode=r,rt.Suspense=l,rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ce,rt.act=ae,rt.cloneElement=function($,J,de){if($==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+$+".");var me=C({},$.props),Te=$.key,le=$.ref,se=$._owner;if(J!=null){if(J.ref!==void 0&&(le=J.ref,se=N.current),J.key!==void 0&&(Te=""+J.key),$.type&&$.type.defaultProps)var ie=$.type.defaultProps;for(Se in J)M.call(J,Se)&&!D.hasOwnProperty(Se)&&(me[Se]=J[Se]===void 0&&ie!==void 0?ie[Se]:J[Se])}var Se=arguments.length-2;if(Se===1)me.children=de;else if(1<Se){ie=Array(Se);for(var re=0;re<Se;re++)ie[re]=arguments[re+2];me.children=ie}return{$$typeof:n,type:$.type,key:Te,ref:le,props:me,_owner:se}},rt.createContext=function($){return $={$$typeof:o,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},$.Provider={$$typeof:s,_context:$},$.Consumer=$},rt.createElement=j,rt.createFactory=function($){var J=j.bind(null,$);return J.type=$,J},rt.createRef=function(){return{current:null}},rt.forwardRef=function($){return{$$typeof:a,render:$}},rt.isValidElement=z,rt.lazy=function($){return{$$typeof:u,_payload:{_status:-1,_result:$},_init:G}},rt.memo=function($,J){return{$$typeof:c,type:$,compare:J===void 0?null:J}},rt.startTransition=function($){var J=Y.transition;Y.transition={};try{$()}finally{Y.transition=J}},rt.unstable_act=ae,rt.useCallback=function($,J){return X.current.useCallback($,J)},rt.useContext=function($){return X.current.useContext($)},rt.useDebugValue=function(){},rt.useDeferredValue=function($){return X.current.useDeferredValue($)},rt.useEffect=function($,J){return X.current.useEffect($,J)},rt.useId=function(){return X.current.useId()},rt.useImperativeHandle=function($,J,de){return X.current.useImperativeHandle($,J,de)},rt.useInsertionEffect=function($,J){return X.current.useInsertionEffect($,J)},rt.useLayoutEffect=function($,J){return X.current.useLayoutEffect($,J)},rt.useMemo=function($,J){return X.current.useMemo($,J)},rt.useReducer=function($,J,de){return X.current.useReducer($,J,de)},rt.useRef=function($){return X.current.useRef($)},rt.useState=function($){return X.current.useState($)},rt.useSyncExternalStore=function($,J,de){return X.current.useSyncExternalStore($,J,de)},rt.useTransition=function(){return X.current.useTransition()},rt.version="18.3.1",rt}var d_;function WP(){return d_||(d_=1,rx.exports=e5()),rx.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h_;function t5(){if(h_)return mf;h_=1;var n=WP(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var u,h={},m=null,v=null;c!==void 0&&(m=""+c),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(v=l.ref);for(u in l)r.call(l,u)&&!s.hasOwnProperty(u)&&(h[u]=l[u]);if(a&&a.defaultProps)for(u in l=a.defaultProps,l)h[u]===void 0&&(h[u]=l[u]);return{$$typeof:e,type:a,key:m,ref:v,props:h,_owner:i.current}}return mf.Fragment=t,mf.jsx=o,mf.jsxs=o,mf}var p_;function n5(){return p_||(p_=1,nx.exports=t5()),nx.exports}var g=n5(),O=WP();const dB=uB(O);var sC={},ix={exports:{}},Rr={},sx={exports:{}},ox={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f_;function r5(){return f_||(f_=1,(function(n){function e(Y,ce){var ae=Y.length;Y.push(ce);e:for(;0<ae;){var $=ae-1>>>1,J=Y[$];if(0<i(J,ce))Y[$]=ce,Y[ae]=J,ae=$;else break e}}function t(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var ce=Y[0],ae=Y.pop();if(ae!==ce){Y[0]=ae;e:for(var $=0,J=Y.length,de=J>>>1;$<de;){var me=2*($+1)-1,Te=Y[me],le=me+1,se=Y[le];if(0>i(Te,ae))le<J&&0>i(se,Te)?(Y[$]=se,Y[le]=ae,$=le):(Y[$]=Te,Y[me]=ae,$=me);else if(le<J&&0>i(se,ae))Y[$]=se,Y[le]=ae,$=le;else break e}}return ce}function i(Y,ce){var ae=Y.sortIndex-ce.sortIndex;return ae!==0?ae:Y.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,m=3,v=!1,C=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(Y){for(var ce=t(c);ce!==null;){if(ce.callback===null)r(c);else if(ce.startTime<=Y)r(c),ce.sortIndex=ce.expirationTime,e(l,ce);else break;ce=t(c)}}function I(Y){if(T=!1,b(Y),!C)if(t(l)!==null)C=!0,G(M);else{var ce=t(c);ce!==null&&X(I,ce.startTime-Y)}}function M(Y,ce){C=!1,T&&(T=!1,x(j),j=-1),v=!0;var ae=m;try{for(b(ce),h=t(l);h!==null&&(!(h.expirationTime>ce)||Y&&!W());){var $=h.callback;if(typeof $=="function"){h.callback=null,m=h.priorityLevel;var J=$(h.expirationTime<=ce);ce=n.unstable_now(),typeof J=="function"?h.callback=J:h===t(l)&&r(l),b(ce)}else r(l);h=t(l)}if(h!==null)var de=!0;else{var me=t(c);me!==null&&X(I,me.startTime-ce),de=!1}return de}finally{h=null,m=ae,v=!1}}var N=!1,D=null,j=-1,F=5,z=-1;function W(){return!(n.unstable_now()-z<F)}function H(){if(D!==null){var Y=n.unstable_now();z=Y;var ce=!0;try{ce=D(!0,Y)}finally{ce?V():(N=!1,D=null)}}else N=!1}var V;if(typeof P=="function")V=function(){P(H)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,ee=K.port2;K.port1.onmessage=H,V=function(){ee.postMessage(null)}}else V=function(){E(H,0)};function G(Y){D=Y,N||(N=!0,V())}function X(Y,ce){j=E(function(){Y(n.unstable_now())},ce)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_continueExecution=function(){C||v||(C=!0,G(M))},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(Y){switch(m){case 1:case 2:case 3:var ce=3;break;default:ce=m}var ae=m;m=ce;try{return Y()}finally{m=ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Y,ce){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var ae=m;m=Y;try{return ce()}finally{m=ae}},n.unstable_scheduleCallback=function(Y,ce,ae){var $=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?$+ae:$):ae=$,Y){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=ae+J,Y={id:u++,callback:ce,priorityLevel:Y,startTime:ae,expirationTime:J,sortIndex:-1},ae>$?(Y.sortIndex=ae,e(c,Y),t(l)===null&&Y===t(c)&&(T?(x(j),j=-1):T=!0,X(I,ae-$))):(Y.sortIndex=J,e(l,Y),C||v||(C=!0,G(M))),Y},n.unstable_shouldYield=W,n.unstable_wrapCallback=function(Y){var ce=m;return function(){var ae=m;m=ce;try{return Y.apply(this,arguments)}finally{m=ae}}}})(ox)),ox}var m_;function i5(){return m_||(m_=1,sx.exports=r5()),sx.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g_;function s5(){if(g_)return Rr;g_=1;var n=WP(),e=i5();function t(d){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+d,y=1;y<arguments.length;y++)p+="&args[]="+encodeURIComponent(arguments[y]);return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(d,p){o(d,p),o(d+"Capture",p)}function o(d,p){for(i[d]=p,d=0;d<p.length;d++)r.add(p[d])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u={},h={};function m(d){return l.call(h,d)?!0:l.call(u,d)?!1:c.test(d)?h[d]=!0:(u[d]=!0,!1)}function v(d,p,y,w){if(y!==null&&y.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return w?!1:y!==null?!y.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function C(d,p,y,w){if(p===null||typeof p>"u"||v(d,p,y,w))return!0;if(w)return!1;if(y!==null)switch(y.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function T(d,p,y,w,R,k,U){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=w,this.attributeNamespace=R,this.mustUseProperty=y,this.propertyName=d,this.type=p,this.sanitizeURL=k,this.removeEmptyString=U}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){E[d]=new T(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var p=d[0];E[p]=new T(p,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){E[d]=new T(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){E[d]=new T(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){E[d]=new T(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){E[d]=new T(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){E[d]=new T(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){E[d]=new T(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){E[d]=new T(d,5,!1,d.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function P(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var p=d.replace(x,P);E[p]=new T(p,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var p=d.replace(x,P);E[p]=new T(p,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var p=d.replace(x,P);E[p]=new T(p,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){E[d]=new T(d,1,!1,d.toLowerCase(),null,!1,!1)}),E.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){E[d]=new T(d,1,!1,d.toLowerCase(),null,!0,!0)});function b(d,p,y,w){var R=E.hasOwnProperty(p)?E[p]:null;(R!==null?R.type!==0:w||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(C(p,y,R,w)&&(y=null),w||R===null?m(p)&&(y===null?d.removeAttribute(p):d.setAttribute(p,""+y)):R.mustUseProperty?d[R.propertyName]=y===null?R.type===3?!1:"":y:(p=R.attributeName,w=R.attributeNamespace,y===null?d.removeAttribute(p):(R=R.type,y=R===3||R===4&&y===!0?"":""+y,w?d.setAttributeNS(w,p,y):d.setAttribute(p,y))))}var I=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,M=Symbol.for("react.element"),N=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),z=Symbol.for("react.provider"),W=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),X=Symbol.for("react.offscreen"),Y=Symbol.iterator;function ce(d){return d===null||typeof d!="object"?null:(d=Y&&d[Y]||d["@@iterator"],typeof d=="function"?d:null)}var ae=Object.assign,$;function J(d){if($===void 0)try{throw Error()}catch(y){var p=y.stack.trim().match(/\n( *(at )?)/);$=p&&p[1]||""}return`
`+$+d}var de=!1;function me(d,p){if(!d||de)return"";de=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(he){var w=he}Reflect.construct(d,[],p)}else{try{p.call()}catch(he){w=he}d.call(p.prototype)}else{try{throw Error()}catch(he){w=he}d()}}catch(he){if(he&&w&&typeof he.stack=="string"){for(var R=he.stack.split(`
`),k=w.stack.split(`
`),U=R.length-1,Z=k.length-1;1<=U&&0<=Z&&R[U]!==k[Z];)Z--;for(;1<=U&&0<=Z;U--,Z--)if(R[U]!==k[Z]){if(U!==1||Z!==1)do if(U--,Z--,0>Z||R[U]!==k[Z]){var Q=`
`+R[U].replace(" at new "," at ");return d.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",d.displayName)),Q}while(1<=U&&0<=Z);break}}}finally{de=!1,Error.prepareStackTrace=y}return(d=d?d.displayName||d.name:"")?J(d):""}function Te(d){switch(d.tag){case 5:return J(d.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 2:case 15:return d=me(d.type,!1),d;case 11:return d=me(d.type.render,!1),d;case 1:return d=me(d.type,!0),d;default:return""}}function le(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case D:return"Fragment";case N:return"Portal";case F:return"Profiler";case j:return"StrictMode";case V:return"Suspense";case K:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case W:return(d.displayName||"Context")+".Consumer";case z:return(d._context.displayName||"Context")+".Provider";case H:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case ee:return p=d.displayName||null,p!==null?p:le(d.type)||"Memo";case G:p=d._payload,d=d._init;try{return le(d(p))}catch{}}return null}function se(d){var p=d.type;switch(d.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=p.render,d=d.displayName||d.name||"",p.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(p);case 8:return p===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function ie(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Se(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function re(d){var p=Se(d)?"checked":"value",y=Object.getOwnPropertyDescriptor(d.constructor.prototype,p),w=""+d[p];if(!d.hasOwnProperty(p)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var R=y.get,k=y.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return R.call(this)},set:function(U){w=""+U,k.call(this,U)}}),Object.defineProperty(d,p,{enumerable:y.enumerable}),{getValue:function(){return w},setValue:function(U){w=""+U},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function pe(d){d._valueTracker||(d._valueTracker=re(d))}function ne(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var y=p.getValue(),w="";return d&&(w=Se(d)?d.checked?"true":"false":d.value),d=w,d!==y?(p.setValue(d),!0):!1}function ve(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function ge(d,p){var y=p.checked;return ae({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:y??d._wrapperState.initialChecked})}function Ie(d,p){var y=p.defaultValue==null?"":p.defaultValue,w=p.checked!=null?p.checked:p.defaultChecked;y=ie(p.value!=null?p.value:y),d._wrapperState={initialChecked:w,initialValue:y,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function fe(d,p){p=p.checked,p!=null&&b(d,"checked",p,!1)}function xe(d,p){fe(d,p);var y=ie(p.value),w=p.type;if(y!=null)w==="number"?(y===0&&d.value===""||d.value!=y)&&(d.value=""+y):d.value!==""+y&&(d.value=""+y);else if(w==="submit"||w==="reset"){d.removeAttribute("value");return}p.hasOwnProperty("value")?Ge(d,p.type,y):p.hasOwnProperty("defaultValue")&&Ge(d,p.type,ie(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(d.defaultChecked=!!p.defaultChecked)}function $e(d,p,y){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var w=p.type;if(!(w!=="submit"&&w!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+d._wrapperState.initialValue,y||p===d.value||(d.value=p),d.defaultValue=p}y=d.name,y!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,y!==""&&(d.name=y)}function Ge(d,p,y){(p!=="number"||ve(d.ownerDocument)!==d)&&(y==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+y&&(d.defaultValue=""+y))}var be=Array.isArray;function gt(d,p,y,w){if(d=d.options,p){p={};for(var R=0;R<y.length;R++)p["$"+y[R]]=!0;for(y=0;y<d.length;y++)R=p.hasOwnProperty("$"+d[y].value),d[y].selected!==R&&(d[y].selected=R),R&&w&&(d[y].defaultSelected=!0)}else{for(y=""+ie(y),p=null,R=0;R<d.length;R++){if(d[R].value===y){d[R].selected=!0,w&&(d[R].defaultSelected=!0);return}p!==null||d[R].disabled||(p=d[R])}p!==null&&(p.selected=!0)}}function vi(d,p){if(p.dangerouslySetInnerHTML!=null)throw Error(t(91));return ae({},p,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function Ss(d,p){var y=p.value;if(y==null){if(y=p.children,p=p.defaultValue,y!=null){if(p!=null)throw Error(t(92));if(be(y)){if(1<y.length)throw Error(t(93));y=y[0]}p=y}p==null&&(p=""),y=p}d._wrapperState={initialValue:ie(y)}}function Cs(d,p){var y=ie(p.value),w=ie(p.defaultValue);y!=null&&(y=""+y,y!==d.value&&(d.value=y),p.defaultValue==null&&d.defaultValue!==y&&(d.defaultValue=y)),w!=null&&(d.defaultValue=""+w)}function As(d){var p=d.textContent;p===d._wrapperState.initialValue&&p!==""&&p!==null&&(d.value=p)}function ye(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function st(d,p){return d==null||d==="http://www.w3.org/1999/xhtml"?ye(p):d==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var wt,lr=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,y,w,R){MSApp.execUnsafeLocalFunction(function(){return d(p,y,w,R)})}:d})(function(d,p){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=p;else{for(wt=wt||document.createElement("div"),wt.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=wt.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;p.firstChild;)d.appendChild(p.firstChild)}});function Ts(d,p){if(p){var y=d.firstChild;if(y&&y===d.lastChild&&y.nodeType===3){y.nodeValue=p;return}}d.textContent=p}var Es={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rd=["Webkit","ms","Moz","O"];Object.keys(Es).forEach(function(d){rd.forEach(function(p){p=p+d.charAt(0).toUpperCase()+d.substring(1),Es[p]=Es[d]})});function Hl(d,p,y){return p==null||typeof p=="boolean"||p===""?"":y||typeof p!="number"||p===0||Es.hasOwnProperty(d)&&Es[d]?(""+p).trim():p+"px"}function Zl(d,p){d=d.style;for(var y in p)if(p.hasOwnProperty(y)){var w=y.indexOf("--")===0,R=Hl(y,p[y],w);y==="float"&&(y="cssFloat"),w?d.setProperty(y,R):d[y]=R}}var id=ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ya(d,p){if(p){if(id[d]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(t(137,d));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(t(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(t(61))}if(p.style!=null&&typeof p.style!="object")throw Error(t(62))}}function Sa(d,p){if(d.indexOf("-")===-1)return typeof p.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ca=null;function ql(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var kp=null,oo=null,Aa=null;function YS(d){if(d=Qp(d)){if(typeof kp!="function")throw Error(t(280));var p=d.stateNode;p&&(p=C0(p),kp(d.stateNode,d.type,p))}}function JS(d){oo?Aa?Aa.push(d):Aa=[d]:oo=d}function RR(){if(oo){var d=oo,p=Aa;if(Aa=oo=null,YS(d),p)for(d=0;d<p.length;d++)YS(p[d])}}function IR(d,p){return d(p)}function _R(){}var yT=!1;function kR(d,p,y){if(yT)return d(p,y);yT=!0;try{return IR(d,p,y)}finally{yT=!1,(oo!==null||Aa!==null)&&(_R(),RR())}}function Mp(d,p){var y=d.stateNode;if(y===null)return null;var w=C0(y);if(w===null)return null;y=w[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(d=d.type,w=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!w;break e;default:d=!1}if(d)return null;if(y&&typeof y!="function")throw Error(t(231,p,typeof y));return y}var ST=!1;if(a)try{var Np={};Object.defineProperty(Np,"passive",{get:function(){ST=!0}}),window.addEventListener("test",Np,Np),window.removeEventListener("test",Np,Np)}catch{ST=!1}function rz(d,p,y,w,R,k,U,Z,Q){var he=Array.prototype.slice.call(arguments,3);try{p.apply(y,he)}catch(Ae){this.onError(Ae)}}var Lp=!1,XS=null,QS=!1,CT=null,iz={onError:function(d){Lp=!0,XS=d}};function sz(d,p,y,w,R,k,U,Z,Q){Lp=!1,XS=null,rz.apply(iz,arguments)}function oz(d,p,y,w,R,k,U,Z,Q){if(sz.apply(this,arguments),Lp){if(Lp){var he=XS;Lp=!1,XS=null}else throw Error(t(198));QS||(QS=!0,CT=he)}}function Gl(d){var p=d,y=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,(p.flags&4098)!==0&&(y=p.return),d=p.return;while(d)}return p.tag===3?y:null}function MR(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function NR(d){if(Gl(d)!==d)throw Error(t(188))}function az(d){var p=d.alternate;if(!p){if(p=Gl(d),p===null)throw Error(t(188));return p!==d?null:d}for(var y=d,w=p;;){var R=y.return;if(R===null)break;var k=R.alternate;if(k===null){if(w=R.return,w!==null){y=w;continue}break}if(R.child===k.child){for(k=R.child;k;){if(k===y)return NR(R),d;if(k===w)return NR(R),p;k=k.sibling}throw Error(t(188))}if(y.return!==w.return)y=R,w=k;else{for(var U=!1,Z=R.child;Z;){if(Z===y){U=!0,y=R,w=k;break}if(Z===w){U=!0,w=R,y=k;break}Z=Z.sibling}if(!U){for(Z=k.child;Z;){if(Z===y){U=!0,y=k,w=R;break}if(Z===w){U=!0,w=k,y=R;break}Z=Z.sibling}if(!U)throw Error(t(189))}}if(y.alternate!==w)throw Error(t(190))}if(y.tag!==3)throw Error(t(188));return y.stateNode.current===y?d:p}function LR(d){return d=az(d),d!==null?DR(d):null}function DR(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var p=DR(d);if(p!==null)return p;d=d.sibling}return null}var OR=e.unstable_scheduleCallback,BR=e.unstable_cancelCallback,lz=e.unstable_shouldYield,cz=e.unstable_requestPaint,un=e.unstable_now,uz=e.unstable_getCurrentPriorityLevel,AT=e.unstable_ImmediatePriority,FR=e.unstable_UserBlockingPriority,e0=e.unstable_NormalPriority,dz=e.unstable_LowPriority,jR=e.unstable_IdlePriority,t0=null,xs=null;function hz(d){if(xs&&typeof xs.onCommitFiberRoot=="function")try{xs.onCommitFiberRoot(t0,d,void 0,(d.current.flags&128)===128)}catch{}}var Vi=Math.clz32?Math.clz32:mz,pz=Math.log,fz=Math.LN2;function mz(d){return d>>>=0,d===0?32:31-(pz(d)/fz|0)|0}var n0=64,r0=4194304;function Dp(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function i0(d,p){var y=d.pendingLanes;if(y===0)return 0;var w=0,R=d.suspendedLanes,k=d.pingedLanes,U=y&268435455;if(U!==0){var Z=U&~R;Z!==0?w=Dp(Z):(k&=U,k!==0&&(w=Dp(k)))}else U=y&~R,U!==0?w=Dp(U):k!==0&&(w=Dp(k));if(w===0)return 0;if(p!==0&&p!==w&&(p&R)===0&&(R=w&-w,k=p&-p,R>=k||R===16&&(k&4194240)!==0))return p;if((w&4)!==0&&(w|=y&16),p=d.entangledLanes,p!==0)for(d=d.entanglements,p&=w;0<p;)y=31-Vi(p),R=1<<y,w|=d[y],p&=~R;return w}function gz(d,p){switch(d){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vz(d,p){for(var y=d.suspendedLanes,w=d.pingedLanes,R=d.expirationTimes,k=d.pendingLanes;0<k;){var U=31-Vi(k),Z=1<<U,Q=R[U];Q===-1?((Z&y)===0||(Z&w)!==0)&&(R[U]=gz(Z,p)):Q<=p&&(d.expiredLanes|=Z),k&=~Z}}function TT(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function UR(){var d=n0;return n0<<=1,(n0&4194240)===0&&(n0=64),d}function ET(d){for(var p=[],y=0;31>y;y++)p.push(d);return p}function Op(d,p,y){d.pendingLanes|=p,p!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,p=31-Vi(p),d[p]=y}function yz(d,p){var y=d.pendingLanes&~p;d.pendingLanes=p,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=p,d.mutableReadLanes&=p,d.entangledLanes&=p,p=d.entanglements;var w=d.eventTimes;for(d=d.expirationTimes;0<y;){var R=31-Vi(y),k=1<<R;p[R]=0,w[R]=-1,d[R]=-1,y&=~k}}function xT(d,p){var y=d.entangledLanes|=p;for(d=d.entanglements;y;){var w=31-Vi(y),R=1<<w;R&p|d[w]&p&&(d[w]|=p),y&=~R}}var At=0;function zR(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var WR,wT,VR,$R,HR,bT=!1,s0=[],Ta=null,Ea=null,xa=null,Bp=new Map,Fp=new Map,wa=[],Sz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ZR(d,p){switch(d){case"focusin":case"focusout":Ta=null;break;case"dragenter":case"dragleave":Ea=null;break;case"mouseover":case"mouseout":xa=null;break;case"pointerover":case"pointerout":Bp.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fp.delete(p.pointerId)}}function jp(d,p,y,w,R,k){return d===null||d.nativeEvent!==k?(d={blockedOn:p,domEventName:y,eventSystemFlags:w,nativeEvent:k,targetContainers:[R]},p!==null&&(p=Qp(p),p!==null&&wT(p)),d):(d.eventSystemFlags|=w,p=d.targetContainers,R!==null&&p.indexOf(R)===-1&&p.push(R),d)}function Cz(d,p,y,w,R){switch(p){case"focusin":return Ta=jp(Ta,d,p,y,w,R),!0;case"dragenter":return Ea=jp(Ea,d,p,y,w,R),!0;case"mouseover":return xa=jp(xa,d,p,y,w,R),!0;case"pointerover":var k=R.pointerId;return Bp.set(k,jp(Bp.get(k)||null,d,p,y,w,R)),!0;case"gotpointercapture":return k=R.pointerId,Fp.set(k,jp(Fp.get(k)||null,d,p,y,w,R)),!0}return!1}function qR(d){var p=Kl(d.target);if(p!==null){var y=Gl(p);if(y!==null){if(p=y.tag,p===13){if(p=MR(y),p!==null){d.blockedOn=p,HR(d.priority,function(){VR(y)});return}}else if(p===3&&y.stateNode.current.memoizedState.isDehydrated){d.blockedOn=y.tag===3?y.stateNode.containerInfo:null;return}}}d.blockedOn=null}function o0(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var y=RT(d.domEventName,d.eventSystemFlags,p[0],d.nativeEvent);if(y===null){y=d.nativeEvent;var w=new y.constructor(y.type,y);Ca=w,y.target.dispatchEvent(w),Ca=null}else return p=Qp(y),p!==null&&wT(p),d.blockedOn=y,!1;p.shift()}return!0}function GR(d,p,y){o0(d)&&y.delete(p)}function Az(){bT=!1,Ta!==null&&o0(Ta)&&(Ta=null),Ea!==null&&o0(Ea)&&(Ea=null),xa!==null&&o0(xa)&&(xa=null),Bp.forEach(GR),Fp.forEach(GR)}function Up(d,p){d.blockedOn===p&&(d.blockedOn=null,bT||(bT=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Az)))}function zp(d){function p(R){return Up(R,d)}if(0<s0.length){Up(s0[0],d);for(var y=1;y<s0.length;y++){var w=s0[y];w.blockedOn===d&&(w.blockedOn=null)}}for(Ta!==null&&Up(Ta,d),Ea!==null&&Up(Ea,d),xa!==null&&Up(xa,d),Bp.forEach(p),Fp.forEach(p),y=0;y<wa.length;y++)w=wa[y],w.blockedOn===d&&(w.blockedOn=null);for(;0<wa.length&&(y=wa[0],y.blockedOn===null);)qR(y),y.blockedOn===null&&wa.shift()}var sd=I.ReactCurrentBatchConfig,a0=!0;function Tz(d,p,y,w){var R=At,k=sd.transition;sd.transition=null;try{At=1,PT(d,p,y,w)}finally{At=R,sd.transition=k}}function Ez(d,p,y,w){var R=At,k=sd.transition;sd.transition=null;try{At=4,PT(d,p,y,w)}finally{At=R,sd.transition=k}}function PT(d,p,y,w){if(a0){var R=RT(d,p,y,w);if(R===null)HT(d,p,w,l0,y),ZR(d,w);else if(Cz(R,d,p,y,w))w.stopPropagation();else if(ZR(d,w),p&4&&-1<Sz.indexOf(d)){for(;R!==null;){var k=Qp(R);if(k!==null&&WR(k),k=RT(d,p,y,w),k===null&&HT(d,p,w,l0,y),k===R)break;R=k}R!==null&&w.stopPropagation()}else HT(d,p,w,null,y)}}var l0=null;function RT(d,p,y,w){if(l0=null,d=ql(w),d=Kl(d),d!==null)if(p=Gl(d),p===null)d=null;else if(y=p.tag,y===13){if(d=MR(p),d!==null)return d;d=null}else if(y===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null);return l0=d,null}function KR(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(uz()){case AT:return 1;case FR:return 4;case e0:case dz:return 16;case jR:return 536870912;default:return 16}default:return 16}}var ba=null,IT=null,c0=null;function YR(){if(c0)return c0;var d,p=IT,y=p.length,w,R="value"in ba?ba.value:ba.textContent,k=R.length;for(d=0;d<y&&p[d]===R[d];d++);var U=y-d;for(w=1;w<=U&&p[y-w]===R[k-w];w++);return c0=R.slice(d,1<w?1-w:void 0)}function u0(d){var p=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function d0(){return!0}function JR(){return!1}function jr(d){function p(y,w,R,k,U){this._reactName=y,this._targetInst=R,this.type=w,this.nativeEvent=k,this.target=U,this.currentTarget=null;for(var Z in d)d.hasOwnProperty(Z)&&(y=d[Z],this[Z]=y?y(k):k[Z]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?d0:JR,this.isPropagationStopped=JR,this}return ae(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var y=this.nativeEvent;y&&(y.preventDefault?y.preventDefault():typeof y.returnValue!="unknown"&&(y.returnValue=!1),this.isDefaultPrevented=d0)},stopPropagation:function(){var y=this.nativeEvent;y&&(y.stopPropagation?y.stopPropagation():typeof y.cancelBubble!="unknown"&&(y.cancelBubble=!0),this.isPropagationStopped=d0)},persist:function(){},isPersistent:d0}),p}var od={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_T=jr(od),Wp=ae({},od,{view:0,detail:0}),xz=jr(Wp),kT,MT,Vp,h0=ae({},Wp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:LT,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Vp&&(Vp&&d.type==="mousemove"?(kT=d.screenX-Vp.screenX,MT=d.screenY-Vp.screenY):MT=kT=0,Vp=d),kT)},movementY:function(d){return"movementY"in d?d.movementY:MT}}),XR=jr(h0),wz=ae({},h0,{dataTransfer:0}),bz=jr(wz),Pz=ae({},Wp,{relatedTarget:0}),NT=jr(Pz),Rz=ae({},od,{animationName:0,elapsedTime:0,pseudoElement:0}),Iz=jr(Rz),_z=ae({},od,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),kz=jr(_z),Mz=ae({},od,{data:0}),QR=jr(Mz),Nz={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lz={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dz={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Oz(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=Dz[d])?!!p[d]:!1}function LT(){return Oz}var Bz=ae({},Wp,{key:function(d){if(d.key){var p=Nz[d.key]||d.key;if(p!=="Unidentified")return p}return d.type==="keypress"?(d=u0(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Lz[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:LT,charCode:function(d){return d.type==="keypress"?u0(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?u0(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Fz=jr(Bz),jz=ae({},h0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),eI=jr(jz),Uz=ae({},Wp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:LT}),zz=jr(Uz),Wz=ae({},od,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vz=jr(Wz),$z=ae({},h0,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Hz=jr($z),Zz=[9,13,27,32],DT=a&&"CompositionEvent"in window,$p=null;a&&"documentMode"in document&&($p=document.documentMode);var qz=a&&"TextEvent"in window&&!$p,tI=a&&(!DT||$p&&8<$p&&11>=$p),nI=" ",rI=!1;function iI(d,p){switch(d){case"keyup":return Zz.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sI(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var ad=!1;function Gz(d,p){switch(d){case"compositionend":return sI(p);case"keypress":return p.which!==32?null:(rI=!0,nI);case"textInput":return d=p.data,d===nI&&rI?null:d;default:return null}}function Kz(d,p){if(ad)return d==="compositionend"||!DT&&iI(d,p)?(d=YR(),c0=IT=ba=null,ad=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return tI&&p.locale!=="ko"?null:p.data;default:return null}}var Yz={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oI(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p==="input"?!!Yz[d.type]:p==="textarea"}function aI(d,p,y,w){JS(w),p=v0(p,"onChange"),0<p.length&&(y=new _T("onChange","change",null,y,w),d.push({event:y,listeners:p}))}var Hp=null,Zp=null;function Jz(d){wI(d,0)}function p0(d){var p=hd(d);if(ne(p))return d}function Xz(d,p){if(d==="change")return p}var lI=!1;if(a){var OT;if(a){var BT="oninput"in document;if(!BT){var cI=document.createElement("div");cI.setAttribute("oninput","return;"),BT=typeof cI.oninput=="function"}OT=BT}else OT=!1;lI=OT&&(!document.documentMode||9<document.documentMode)}function uI(){Hp&&(Hp.detachEvent("onpropertychange",dI),Zp=Hp=null)}function dI(d){if(d.propertyName==="value"&&p0(Zp)){var p=[];aI(p,Zp,d,ql(d)),kR(Jz,p)}}function Qz(d,p,y){d==="focusin"?(uI(),Hp=p,Zp=y,Hp.attachEvent("onpropertychange",dI)):d==="focusout"&&uI()}function e3(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return p0(Zp)}function t3(d,p){if(d==="click")return p0(p)}function n3(d,p){if(d==="input"||d==="change")return p0(p)}function r3(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var $i=typeof Object.is=="function"?Object.is:r3;function qp(d,p){if($i(d,p))return!0;if(typeof d!="object"||d===null||typeof p!="object"||p===null)return!1;var y=Object.keys(d),w=Object.keys(p);if(y.length!==w.length)return!1;for(w=0;w<y.length;w++){var R=y[w];if(!l.call(p,R)||!$i(d[R],p[R]))return!1}return!0}function hI(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function pI(d,p){var y=hI(d);d=0;for(var w;y;){if(y.nodeType===3){if(w=d+y.textContent.length,d<=p&&w>=p)return{node:y,offset:p-d};d=w}e:{for(;y;){if(y.nextSibling){y=y.nextSibling;break e}y=y.parentNode}y=void 0}y=hI(y)}}function fI(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?fI(d,p.parentNode):"contains"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function mI(){for(var d=window,p=ve();p instanceof d.HTMLIFrameElement;){try{var y=typeof p.contentWindow.location.href=="string"}catch{y=!1}if(y)d=p.contentWindow;else break;p=ve(d.document)}return p}function FT(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||p==="textarea"||d.contentEditable==="true")}function i3(d){var p=mI(),y=d.focusedElem,w=d.selectionRange;if(p!==y&&y&&y.ownerDocument&&fI(y.ownerDocument.documentElement,y)){if(w!==null&&FT(y)){if(p=w.start,d=w.end,d===void 0&&(d=p),"selectionStart"in y)y.selectionStart=p,y.selectionEnd=Math.min(d,y.value.length);else if(d=(p=y.ownerDocument||document)&&p.defaultView||window,d.getSelection){d=d.getSelection();var R=y.textContent.length,k=Math.min(w.start,R);w=w.end===void 0?k:Math.min(w.end,R),!d.extend&&k>w&&(R=w,w=k,k=R),R=pI(y,k);var U=pI(y,w);R&&U&&(d.rangeCount!==1||d.anchorNode!==R.node||d.anchorOffset!==R.offset||d.focusNode!==U.node||d.focusOffset!==U.offset)&&(p=p.createRange(),p.setStart(R.node,R.offset),d.removeAllRanges(),k>w?(d.addRange(p),d.extend(U.node,U.offset)):(p.setEnd(U.node,U.offset),d.addRange(p)))}}for(p=[],d=y;d=d.parentNode;)d.nodeType===1&&p.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof y.focus=="function"&&y.focus(),y=0;y<p.length;y++)d=p[y],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var s3=a&&"documentMode"in document&&11>=document.documentMode,ld=null,jT=null,Gp=null,UT=!1;function gI(d,p,y){var w=y.window===y?y.document:y.nodeType===9?y:y.ownerDocument;UT||ld==null||ld!==ve(w)||(w=ld,"selectionStart"in w&&FT(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Gp&&qp(Gp,w)||(Gp=w,w=v0(jT,"onSelect"),0<w.length&&(p=new _T("onSelect","select",null,p,y),d.push({event:p,listeners:w}),p.target=ld)))}function f0(d,p){var y={};return y[d.toLowerCase()]=p.toLowerCase(),y["Webkit"+d]="webkit"+p,y["Moz"+d]="moz"+p,y}var cd={animationend:f0("Animation","AnimationEnd"),animationiteration:f0("Animation","AnimationIteration"),animationstart:f0("Animation","AnimationStart"),transitionend:f0("Transition","TransitionEnd")},zT={},vI={};a&&(vI=document.createElement("div").style,"AnimationEvent"in window||(delete cd.animationend.animation,delete cd.animationiteration.animation,delete cd.animationstart.animation),"TransitionEvent"in window||delete cd.transitionend.transition);function m0(d){if(zT[d])return zT[d];if(!cd[d])return d;var p=cd[d],y;for(y in p)if(p.hasOwnProperty(y)&&y in vI)return zT[d]=p[y];return d}var yI=m0("animationend"),SI=m0("animationiteration"),CI=m0("animationstart"),AI=m0("transitionend"),TI=new Map,EI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pa(d,p){TI.set(d,p),s(p,[d])}for(var WT=0;WT<EI.length;WT++){var VT=EI[WT],o3=VT.toLowerCase(),a3=VT[0].toUpperCase()+VT.slice(1);Pa(o3,"on"+a3)}Pa(yI,"onAnimationEnd"),Pa(SI,"onAnimationIteration"),Pa(CI,"onAnimationStart"),Pa("dblclick","onDoubleClick"),Pa("focusin","onFocus"),Pa("focusout","onBlur"),Pa(AI,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),l3=new Set("cancel close invalid load scroll toggle".split(" ").concat(Kp));function xI(d,p,y){var w=d.type||"unknown-event";d.currentTarget=y,oz(w,p,void 0,d),d.currentTarget=null}function wI(d,p){p=(p&4)!==0;for(var y=0;y<d.length;y++){var w=d[y],R=w.event;w=w.listeners;e:{var k=void 0;if(p)for(var U=w.length-1;0<=U;U--){var Z=w[U],Q=Z.instance,he=Z.currentTarget;if(Z=Z.listener,Q!==k&&R.isPropagationStopped())break e;xI(R,Z,he),k=Q}else for(U=0;U<w.length;U++){if(Z=w[U],Q=Z.instance,he=Z.currentTarget,Z=Z.listener,Q!==k&&R.isPropagationStopped())break e;xI(R,Z,he),k=Q}}}if(QS)throw d=CT,QS=!1,CT=null,d}function zt(d,p){var y=p[JT];y===void 0&&(y=p[JT]=new Set);var w=d+"__bubble";y.has(w)||(bI(p,d,2,!1),y.add(w))}function $T(d,p,y){var w=0;p&&(w|=4),bI(y,d,w,p)}var g0="_reactListening"+Math.random().toString(36).slice(2);function Yp(d){if(!d[g0]){d[g0]=!0,r.forEach(function(y){y!=="selectionchange"&&(l3.has(y)||$T(y,!1,d),$T(y,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[g0]||(p[g0]=!0,$T("selectionchange",!1,p))}}function bI(d,p,y,w){switch(KR(p)){case 1:var R=Tz;break;case 4:R=Ez;break;default:R=PT}y=R.bind(null,p,y,d),R=void 0,!ST||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(R=!0),w?R!==void 0?d.addEventListener(p,y,{capture:!0,passive:R}):d.addEventListener(p,y,!0):R!==void 0?d.addEventListener(p,y,{passive:R}):d.addEventListener(p,y,!1)}function HT(d,p,y,w,R){var k=w;if((p&1)===0&&(p&2)===0&&w!==null)e:for(;;){if(w===null)return;var U=w.tag;if(U===3||U===4){var Z=w.stateNode.containerInfo;if(Z===R||Z.nodeType===8&&Z.parentNode===R)break;if(U===4)for(U=w.return;U!==null;){var Q=U.tag;if((Q===3||Q===4)&&(Q=U.stateNode.containerInfo,Q===R||Q.nodeType===8&&Q.parentNode===R))return;U=U.return}for(;Z!==null;){if(U=Kl(Z),U===null)return;if(Q=U.tag,Q===5||Q===6){w=k=U;continue e}Z=Z.parentNode}}w=w.return}kR(function(){var he=k,Ae=ql(y),Ee=[];e:{var Ce=TI.get(d);if(Ce!==void 0){var Me=_T,Oe=d;switch(d){case"keypress":if(u0(y)===0)break e;case"keydown":case"keyup":Me=Fz;break;case"focusin":Oe="focus",Me=NT;break;case"focusout":Oe="blur",Me=NT;break;case"beforeblur":case"afterblur":Me=NT;break;case"click":if(y.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Me=XR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Me=bz;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Me=zz;break;case yI:case SI:case CI:Me=Iz;break;case AI:Me=Vz;break;case"scroll":Me=xz;break;case"wheel":Me=Hz;break;case"copy":case"cut":case"paste":Me=kz;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Me=eI}var Be=(p&4)!==0,dn=!Be&&d==="scroll",oe=Be?Ce!==null?Ce+"Capture":null:Ce;Be=[];for(var te=he,ue;te!==null;){ue=te;var we=ue.stateNode;if(ue.tag===5&&we!==null&&(ue=we,oe!==null&&(we=Mp(te,oe),we!=null&&Be.push(Jp(te,we,ue)))),dn)break;te=te.return}0<Be.length&&(Ce=new Me(Ce,Oe,null,y,Ae),Ee.push({event:Ce,listeners:Be}))}}if((p&7)===0){e:{if(Ce=d==="mouseover"||d==="pointerover",Me=d==="mouseout"||d==="pointerout",Ce&&y!==Ca&&(Oe=y.relatedTarget||y.fromElement)&&(Kl(Oe)||Oe[ao]))break e;if((Me||Ce)&&(Ce=Ae.window===Ae?Ae:(Ce=Ae.ownerDocument)?Ce.defaultView||Ce.parentWindow:window,Me?(Oe=y.relatedTarget||y.toElement,Me=he,Oe=Oe?Kl(Oe):null,Oe!==null&&(dn=Gl(Oe),Oe!==dn||Oe.tag!==5&&Oe.tag!==6)&&(Oe=null)):(Me=null,Oe=he),Me!==Oe)){if(Be=XR,we="onMouseLeave",oe="onMouseEnter",te="mouse",(d==="pointerout"||d==="pointerover")&&(Be=eI,we="onPointerLeave",oe="onPointerEnter",te="pointer"),dn=Me==null?Ce:hd(Me),ue=Oe==null?Ce:hd(Oe),Ce=new Be(we,te+"leave",Me,y,Ae),Ce.target=dn,Ce.relatedTarget=ue,we=null,Kl(Ae)===he&&(Be=new Be(oe,te+"enter",Oe,y,Ae),Be.target=ue,Be.relatedTarget=dn,we=Be),dn=we,Me&&Oe)t:{for(Be=Me,oe=Oe,te=0,ue=Be;ue;ue=ud(ue))te++;for(ue=0,we=oe;we;we=ud(we))ue++;for(;0<te-ue;)Be=ud(Be),te--;for(;0<ue-te;)oe=ud(oe),ue--;for(;te--;){if(Be===oe||oe!==null&&Be===oe.alternate)break t;Be=ud(Be),oe=ud(oe)}Be=null}else Be=null;Me!==null&&PI(Ee,Ce,Me,Be,!1),Oe!==null&&dn!==null&&PI(Ee,dn,Oe,Be,!0)}}e:{if(Ce=he?hd(he):window,Me=Ce.nodeName&&Ce.nodeName.toLowerCase(),Me==="select"||Me==="input"&&Ce.type==="file")var je=Xz;else if(oI(Ce))if(lI)je=n3;else{je=e3;var ze=Qz}else(Me=Ce.nodeName)&&Me.toLowerCase()==="input"&&(Ce.type==="checkbox"||Ce.type==="radio")&&(je=t3);if(je&&(je=je(d,he))){aI(Ee,je,y,Ae);break e}ze&&ze(d,Ce,he),d==="focusout"&&(ze=Ce._wrapperState)&&ze.controlled&&Ce.type==="number"&&Ge(Ce,"number",Ce.value)}switch(ze=he?hd(he):window,d){case"focusin":(oI(ze)||ze.contentEditable==="true")&&(ld=ze,jT=he,Gp=null);break;case"focusout":Gp=jT=ld=null;break;case"mousedown":UT=!0;break;case"contextmenu":case"mouseup":case"dragend":UT=!1,gI(Ee,y,Ae);break;case"selectionchange":if(s3)break;case"keydown":case"keyup":gI(Ee,y,Ae)}var We;if(DT)e:{switch(d){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else ad?iI(d,y)&&(qe="onCompositionEnd"):d==="keydown"&&y.keyCode===229&&(qe="onCompositionStart");qe&&(tI&&y.locale!=="ko"&&(ad||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&ad&&(We=YR()):(ba=Ae,IT="value"in ba?ba.value:ba.textContent,ad=!0)),ze=v0(he,qe),0<ze.length&&(qe=new QR(qe,d,null,y,Ae),Ee.push({event:qe,listeners:ze}),We?qe.data=We:(We=sI(y),We!==null&&(qe.data=We)))),(We=qz?Gz(d,y):Kz(d,y))&&(he=v0(he,"onBeforeInput"),0<he.length&&(Ae=new QR("onBeforeInput","beforeinput",null,y,Ae),Ee.push({event:Ae,listeners:he}),Ae.data=We))}wI(Ee,p)})}function Jp(d,p,y){return{instance:d,listener:p,currentTarget:y}}function v0(d,p){for(var y=p+"Capture",w=[];d!==null;){var R=d,k=R.stateNode;R.tag===5&&k!==null&&(R=k,k=Mp(d,y),k!=null&&w.unshift(Jp(d,k,R)),k=Mp(d,p),k!=null&&w.push(Jp(d,k,R))),d=d.return}return w}function ud(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function PI(d,p,y,w,R){for(var k=p._reactName,U=[];y!==null&&y!==w;){var Z=y,Q=Z.alternate,he=Z.stateNode;if(Q!==null&&Q===w)break;Z.tag===5&&he!==null&&(Z=he,R?(Q=Mp(y,k),Q!=null&&U.unshift(Jp(y,Q,Z))):R||(Q=Mp(y,k),Q!=null&&U.push(Jp(y,Q,Z)))),y=y.return}U.length!==0&&d.push({event:p,listeners:U})}var c3=/\r\n?/g,u3=/\u0000|\uFFFD/g;function RI(d){return(typeof d=="string"?d:""+d).replace(c3,`
`).replace(u3,"")}function y0(d,p,y){if(p=RI(p),RI(d)!==p&&y)throw Error(t(425))}function S0(){}var ZT=null,qT=null;function GT(d,p){return d==="textarea"||d==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var KT=typeof setTimeout=="function"?setTimeout:void 0,d3=typeof clearTimeout=="function"?clearTimeout:void 0,II=typeof Promise=="function"?Promise:void 0,h3=typeof queueMicrotask=="function"?queueMicrotask:typeof II<"u"?function(d){return II.resolve(null).then(d).catch(p3)}:KT;function p3(d){setTimeout(function(){throw d})}function YT(d,p){var y=p,w=0;do{var R=y.nextSibling;if(d.removeChild(y),R&&R.nodeType===8)if(y=R.data,y==="/$"){if(w===0){d.removeChild(R),zp(p);return}w--}else y!=="$"&&y!=="$?"&&y!=="$!"||w++;y=R}while(y);zp(p)}function Ra(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return d}function _I(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var y=d.data;if(y==="$"||y==="$!"||y==="$?"){if(p===0)return d;p--}else y==="/$"&&p++}d=d.previousSibling}return null}var dd=Math.random().toString(36).slice(2),ws="__reactFiber$"+dd,Xp="__reactProps$"+dd,ao="__reactContainer$"+dd,JT="__reactEvents$"+dd,f3="__reactListeners$"+dd,m3="__reactHandles$"+dd;function Kl(d){var p=d[ws];if(p)return p;for(var y=d.parentNode;y;){if(p=y[ao]||y[ws]){if(y=p.alternate,p.child!==null||y!==null&&y.child!==null)for(d=_I(d);d!==null;){if(y=d[ws])return y;d=_I(d)}return p}d=y,y=d.parentNode}return null}function Qp(d){return d=d[ws]||d[ao],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function hd(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(t(33))}function C0(d){return d[Xp]||null}var XT=[],pd=-1;function Ia(d){return{current:d}}function Wt(d){0>pd||(d.current=XT[pd],XT[pd]=null,pd--)}function Ot(d,p){pd++,XT[pd]=d.current,d.current=p}var _a={},Yn=Ia(_a),Er=Ia(!1),Yl=_a;function fd(d,p){var y=d.type.contextTypes;if(!y)return _a;var w=d.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===p)return w.__reactInternalMemoizedMaskedChildContext;var R={},k;for(k in y)R[k]=p[k];return w&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=p,d.__reactInternalMemoizedMaskedChildContext=R),R}function xr(d){return d=d.childContextTypes,d!=null}function A0(){Wt(Er),Wt(Yn)}function kI(d,p,y){if(Yn.current!==_a)throw Error(t(168));Ot(Yn,p),Ot(Er,y)}function MI(d,p,y){var w=d.stateNode;if(p=p.childContextTypes,typeof w.getChildContext!="function")return y;w=w.getChildContext();for(var R in w)if(!(R in p))throw Error(t(108,se(d)||"Unknown",R));return ae({},y,w)}function T0(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||_a,Yl=Yn.current,Ot(Yn,d),Ot(Er,Er.current),!0}function NI(d,p,y){var w=d.stateNode;if(!w)throw Error(t(169));y?(d=MI(d,p,Yl),w.__reactInternalMemoizedMergedChildContext=d,Wt(Er),Wt(Yn),Ot(Yn,d)):Wt(Er),Ot(Er,y)}var lo=null,E0=!1,QT=!1;function LI(d){lo===null?lo=[d]:lo.push(d)}function g3(d){E0=!0,LI(d)}function ka(){if(!QT&&lo!==null){QT=!0;var d=0,p=At;try{var y=lo;for(At=1;d<y.length;d++){var w=y[d];do w=w(!0);while(w!==null)}lo=null,E0=!1}catch(R){throw lo!==null&&(lo=lo.slice(d+1)),OR(AT,ka),R}finally{At=p,QT=!1}}return null}var md=[],gd=0,x0=null,w0=0,yi=[],Si=0,Jl=null,co=1,uo="";function Xl(d,p){md[gd++]=w0,md[gd++]=x0,x0=d,w0=p}function DI(d,p,y){yi[Si++]=co,yi[Si++]=uo,yi[Si++]=Jl,Jl=d;var w=co;d=uo;var R=32-Vi(w)-1;w&=~(1<<R),y+=1;var k=32-Vi(p)+R;if(30<k){var U=R-R%5;k=(w&(1<<U)-1).toString(32),w>>=U,R-=U,co=1<<32-Vi(p)+R|y<<R|w,uo=k+d}else co=1<<k|y<<R|w,uo=d}function eE(d){d.return!==null&&(Xl(d,1),DI(d,1,0))}function tE(d){for(;d===x0;)x0=md[--gd],md[gd]=null,w0=md[--gd],md[gd]=null;for(;d===Jl;)Jl=yi[--Si],yi[Si]=null,uo=yi[--Si],yi[Si]=null,co=yi[--Si],yi[Si]=null}var Ur=null,zr=null,$t=!1,Hi=null;function OI(d,p){var y=Ei(5,null,null,0);y.elementType="DELETED",y.stateNode=p,y.return=d,p=d.deletions,p===null?(d.deletions=[y],d.flags|=16):p.push(y)}function BI(d,p){switch(d.tag){case 5:var y=d.type;return p=p.nodeType!==1||y.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(d.stateNode=p,Ur=d,zr=Ra(p.firstChild),!0):!1;case 6:return p=d.pendingProps===""||p.nodeType!==3?null:p,p!==null?(d.stateNode=p,Ur=d,zr=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(y=Jl!==null?{id:co,overflow:uo}:null,d.memoizedState={dehydrated:p,treeContext:y,retryLane:1073741824},y=Ei(18,null,null,0),y.stateNode=p,y.return=d,d.child=y,Ur=d,zr=null,!0):!1;default:return!1}}function nE(d){return(d.mode&1)!==0&&(d.flags&128)===0}function rE(d){if($t){var p=zr;if(p){var y=p;if(!BI(d,p)){if(nE(d))throw Error(t(418));p=Ra(y.nextSibling);var w=Ur;p&&BI(d,p)?OI(w,y):(d.flags=d.flags&-4097|2,$t=!1,Ur=d)}}else{if(nE(d))throw Error(t(418));d.flags=d.flags&-4097|2,$t=!1,Ur=d}}}function FI(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Ur=d}function b0(d){if(d!==Ur)return!1;if(!$t)return FI(d),$t=!0,!1;var p;if((p=d.tag!==3)&&!(p=d.tag!==5)&&(p=d.type,p=p!=="head"&&p!=="body"&&!GT(d.type,d.memoizedProps)),p&&(p=zr)){if(nE(d))throw jI(),Error(t(418));for(;p;)OI(d,p),p=Ra(p.nextSibling)}if(FI(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(t(317));e:{for(d=d.nextSibling,p=0;d;){if(d.nodeType===8){var y=d.data;if(y==="/$"){if(p===0){zr=Ra(d.nextSibling);break e}p--}else y!=="$"&&y!=="$!"&&y!=="$?"||p++}d=d.nextSibling}zr=null}}else zr=Ur?Ra(d.stateNode.nextSibling):null;return!0}function jI(){for(var d=zr;d;)d=Ra(d.nextSibling)}function vd(){zr=Ur=null,$t=!1}function iE(d){Hi===null?Hi=[d]:Hi.push(d)}var v3=I.ReactCurrentBatchConfig;function ef(d,p,y){if(d=y.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(y._owner){if(y=y._owner,y){if(y.tag!==1)throw Error(t(309));var w=y.stateNode}if(!w)throw Error(t(147,d));var R=w,k=""+d;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===k?p.ref:(p=function(U){var Z=R.refs;U===null?delete Z[k]:Z[k]=U},p._stringRef=k,p)}if(typeof d!="string")throw Error(t(284));if(!y._owner)throw Error(t(290,d))}return d}function P0(d,p){throw d=Object.prototype.toString.call(p),Error(t(31,d==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":d))}function UI(d){var p=d._init;return p(d._payload)}function zI(d){function p(oe,te){if(d){var ue=oe.deletions;ue===null?(oe.deletions=[te],oe.flags|=16):ue.push(te)}}function y(oe,te){if(!d)return null;for(;te!==null;)p(oe,te),te=te.sibling;return null}function w(oe,te){for(oe=new Map;te!==null;)te.key!==null?oe.set(te.key,te):oe.set(te.index,te),te=te.sibling;return oe}function R(oe,te){return oe=ja(oe,te),oe.index=0,oe.sibling=null,oe}function k(oe,te,ue){return oe.index=ue,d?(ue=oe.alternate,ue!==null?(ue=ue.index,ue<te?(oe.flags|=2,te):ue):(oe.flags|=2,te)):(oe.flags|=1048576,te)}function U(oe){return d&&oe.alternate===null&&(oe.flags|=2),oe}function Z(oe,te,ue,we){return te===null||te.tag!==6?(te=KE(ue,oe.mode,we),te.return=oe,te):(te=R(te,ue),te.return=oe,te)}function Q(oe,te,ue,we){var je=ue.type;return je===D?Ae(oe,te,ue.props.children,we,ue.key):te!==null&&(te.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===G&&UI(je)===te.type)?(we=R(te,ue.props),we.ref=ef(oe,te,ue),we.return=oe,we):(we=J0(ue.type,ue.key,ue.props,null,oe.mode,we),we.ref=ef(oe,te,ue),we.return=oe,we)}function he(oe,te,ue,we){return te===null||te.tag!==4||te.stateNode.containerInfo!==ue.containerInfo||te.stateNode.implementation!==ue.implementation?(te=YE(ue,oe.mode,we),te.return=oe,te):(te=R(te,ue.children||[]),te.return=oe,te)}function Ae(oe,te,ue,we,je){return te===null||te.tag!==7?(te=oc(ue,oe.mode,we,je),te.return=oe,te):(te=R(te,ue),te.return=oe,te)}function Ee(oe,te,ue){if(typeof te=="string"&&te!==""||typeof te=="number")return te=KE(""+te,oe.mode,ue),te.return=oe,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case M:return ue=J0(te.type,te.key,te.props,null,oe.mode,ue),ue.ref=ef(oe,null,te),ue.return=oe,ue;case N:return te=YE(te,oe.mode,ue),te.return=oe,te;case G:var we=te._init;return Ee(oe,we(te._payload),ue)}if(be(te)||ce(te))return te=oc(te,oe.mode,ue,null),te.return=oe,te;P0(oe,te)}return null}function Ce(oe,te,ue,we){var je=te!==null?te.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return je!==null?null:Z(oe,te,""+ue,we);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case M:return ue.key===je?Q(oe,te,ue,we):null;case N:return ue.key===je?he(oe,te,ue,we):null;case G:return je=ue._init,Ce(oe,te,je(ue._payload),we)}if(be(ue)||ce(ue))return je!==null?null:Ae(oe,te,ue,we,null);P0(oe,ue)}return null}function Me(oe,te,ue,we,je){if(typeof we=="string"&&we!==""||typeof we=="number")return oe=oe.get(ue)||null,Z(te,oe,""+we,je);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case M:return oe=oe.get(we.key===null?ue:we.key)||null,Q(te,oe,we,je);case N:return oe=oe.get(we.key===null?ue:we.key)||null,he(te,oe,we,je);case G:var ze=we._init;return Me(oe,te,ue,ze(we._payload),je)}if(be(we)||ce(we))return oe=oe.get(ue)||null,Ae(te,oe,we,je,null);P0(te,we)}return null}function Oe(oe,te,ue,we){for(var je=null,ze=null,We=te,qe=te=0,_n=null;We!==null&&qe<ue.length;qe++){We.index>qe?(_n=We,We=null):_n=We.sibling;var vt=Ce(oe,We,ue[qe],we);if(vt===null){We===null&&(We=_n);break}d&&We&&vt.alternate===null&&p(oe,We),te=k(vt,te,qe),ze===null?je=vt:ze.sibling=vt,ze=vt,We=_n}if(qe===ue.length)return y(oe,We),$t&&Xl(oe,qe),je;if(We===null){for(;qe<ue.length;qe++)We=Ee(oe,ue[qe],we),We!==null&&(te=k(We,te,qe),ze===null?je=We:ze.sibling=We,ze=We);return $t&&Xl(oe,qe),je}for(We=w(oe,We);qe<ue.length;qe++)_n=Me(We,oe,qe,ue[qe],we),_n!==null&&(d&&_n.alternate!==null&&We.delete(_n.key===null?qe:_n.key),te=k(_n,te,qe),ze===null?je=_n:ze.sibling=_n,ze=_n);return d&&We.forEach(function(Ua){return p(oe,Ua)}),$t&&Xl(oe,qe),je}function Be(oe,te,ue,we){var je=ce(ue);if(typeof je!="function")throw Error(t(150));if(ue=je.call(ue),ue==null)throw Error(t(151));for(var ze=je=null,We=te,qe=te=0,_n=null,vt=ue.next();We!==null&&!vt.done;qe++,vt=ue.next()){We.index>qe?(_n=We,We=null):_n=We.sibling;var Ua=Ce(oe,We,vt.value,we);if(Ua===null){We===null&&(We=_n);break}d&&We&&Ua.alternate===null&&p(oe,We),te=k(Ua,te,qe),ze===null?je=Ua:ze.sibling=Ua,ze=Ua,We=_n}if(vt.done)return y(oe,We),$t&&Xl(oe,qe),je;if(We===null){for(;!vt.done;qe++,vt=ue.next())vt=Ee(oe,vt.value,we),vt!==null&&(te=k(vt,te,qe),ze===null?je=vt:ze.sibling=vt,ze=vt);return $t&&Xl(oe,qe),je}for(We=w(oe,We);!vt.done;qe++,vt=ue.next())vt=Me(We,oe,qe,vt.value,we),vt!==null&&(d&&vt.alternate!==null&&We.delete(vt.key===null?qe:vt.key),te=k(vt,te,qe),ze===null?je=vt:ze.sibling=vt,ze=vt);return d&&We.forEach(function(Y3){return p(oe,Y3)}),$t&&Xl(oe,qe),je}function dn(oe,te,ue,we){if(typeof ue=="object"&&ue!==null&&ue.type===D&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case M:e:{for(var je=ue.key,ze=te;ze!==null;){if(ze.key===je){if(je=ue.type,je===D){if(ze.tag===7){y(oe,ze.sibling),te=R(ze,ue.props.children),te.return=oe,oe=te;break e}}else if(ze.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===G&&UI(je)===ze.type){y(oe,ze.sibling),te=R(ze,ue.props),te.ref=ef(oe,ze,ue),te.return=oe,oe=te;break e}y(oe,ze);break}else p(oe,ze);ze=ze.sibling}ue.type===D?(te=oc(ue.props.children,oe.mode,we,ue.key),te.return=oe,oe=te):(we=J0(ue.type,ue.key,ue.props,null,oe.mode,we),we.ref=ef(oe,te,ue),we.return=oe,oe=we)}return U(oe);case N:e:{for(ze=ue.key;te!==null;){if(te.key===ze)if(te.tag===4&&te.stateNode.containerInfo===ue.containerInfo&&te.stateNode.implementation===ue.implementation){y(oe,te.sibling),te=R(te,ue.children||[]),te.return=oe,oe=te;break e}else{y(oe,te);break}else p(oe,te);te=te.sibling}te=YE(ue,oe.mode,we),te.return=oe,oe=te}return U(oe);case G:return ze=ue._init,dn(oe,te,ze(ue._payload),we)}if(be(ue))return Oe(oe,te,ue,we);if(ce(ue))return Be(oe,te,ue,we);P0(oe,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,te!==null&&te.tag===6?(y(oe,te.sibling),te=R(te,ue),te.return=oe,oe=te):(y(oe,te),te=KE(ue,oe.mode,we),te.return=oe,oe=te),U(oe)):y(oe,te)}return dn}var yd=zI(!0),WI=zI(!1),R0=Ia(null),I0=null,Sd=null,sE=null;function oE(){sE=Sd=I0=null}function aE(d){var p=R0.current;Wt(R0),d._currentValue=p}function lE(d,p,y){for(;d!==null;){var w=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,w!==null&&(w.childLanes|=p)):w!==null&&(w.childLanes&p)!==p&&(w.childLanes|=p),d===y)break;d=d.return}}function Cd(d,p){I0=d,sE=Sd=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&p)!==0&&(wr=!0),d.firstContext=null)}function Ci(d){var p=d._currentValue;if(sE!==d)if(d={context:d,memoizedValue:p,next:null},Sd===null){if(I0===null)throw Error(t(308));Sd=d,I0.dependencies={lanes:0,firstContext:d}}else Sd=Sd.next=d;return p}var Ql=null;function cE(d){Ql===null?Ql=[d]:Ql.push(d)}function VI(d,p,y,w){var R=p.interleaved;return R===null?(y.next=y,cE(p)):(y.next=R.next,R.next=y),p.interleaved=y,ho(d,w)}function ho(d,p){d.lanes|=p;var y=d.alternate;for(y!==null&&(y.lanes|=p),y=d,d=d.return;d!==null;)d.childLanes|=p,y=d.alternate,y!==null&&(y.childLanes|=p),y=d,d=d.return;return y.tag===3?y.stateNode:null}var Ma=!1;function uE(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $I(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function po(d,p){return{eventTime:d,lane:p,tag:0,payload:null,callback:null,next:null}}function Na(d,p,y){var w=d.updateQueue;if(w===null)return null;if(w=w.shared,(pt&2)!==0){var R=w.pending;return R===null?p.next=p:(p.next=R.next,R.next=p),w.pending=p,ho(d,y)}return R=w.interleaved,R===null?(p.next=p,cE(w)):(p.next=R.next,R.next=p),w.interleaved=p,ho(d,y)}function _0(d,p,y){if(p=p.updateQueue,p!==null&&(p=p.shared,(y&4194240)!==0)){var w=p.lanes;w&=d.pendingLanes,y|=w,p.lanes=y,xT(d,y)}}function HI(d,p){var y=d.updateQueue,w=d.alternate;if(w!==null&&(w=w.updateQueue,y===w)){var R=null,k=null;if(y=y.firstBaseUpdate,y!==null){do{var U={eventTime:y.eventTime,lane:y.lane,tag:y.tag,payload:y.payload,callback:y.callback,next:null};k===null?R=k=U:k=k.next=U,y=y.next}while(y!==null);k===null?R=k=p:k=k.next=p}else R=k=p;y={baseState:w.baseState,firstBaseUpdate:R,lastBaseUpdate:k,shared:w.shared,effects:w.effects},d.updateQueue=y;return}d=y.lastBaseUpdate,d===null?y.firstBaseUpdate=p:d.next=p,y.lastBaseUpdate=p}function k0(d,p,y,w){var R=d.updateQueue;Ma=!1;var k=R.firstBaseUpdate,U=R.lastBaseUpdate,Z=R.shared.pending;if(Z!==null){R.shared.pending=null;var Q=Z,he=Q.next;Q.next=null,U===null?k=he:U.next=he,U=Q;var Ae=d.alternate;Ae!==null&&(Ae=Ae.updateQueue,Z=Ae.lastBaseUpdate,Z!==U&&(Z===null?Ae.firstBaseUpdate=he:Z.next=he,Ae.lastBaseUpdate=Q))}if(k!==null){var Ee=R.baseState;U=0,Ae=he=Q=null,Z=k;do{var Ce=Z.lane,Me=Z.eventTime;if((w&Ce)===Ce){Ae!==null&&(Ae=Ae.next={eventTime:Me,lane:0,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null});e:{var Oe=d,Be=Z;switch(Ce=p,Me=y,Be.tag){case 1:if(Oe=Be.payload,typeof Oe=="function"){Ee=Oe.call(Me,Ee,Ce);break e}Ee=Oe;break e;case 3:Oe.flags=Oe.flags&-65537|128;case 0:if(Oe=Be.payload,Ce=typeof Oe=="function"?Oe.call(Me,Ee,Ce):Oe,Ce==null)break e;Ee=ae({},Ee,Ce);break e;case 2:Ma=!0}}Z.callback!==null&&Z.lane!==0&&(d.flags|=64,Ce=R.effects,Ce===null?R.effects=[Z]:Ce.push(Z))}else Me={eventTime:Me,lane:Ce,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},Ae===null?(he=Ae=Me,Q=Ee):Ae=Ae.next=Me,U|=Ce;if(Z=Z.next,Z===null){if(Z=R.shared.pending,Z===null)break;Ce=Z,Z=Ce.next,Ce.next=null,R.lastBaseUpdate=Ce,R.shared.pending=null}}while(!0);if(Ae===null&&(Q=Ee),R.baseState=Q,R.firstBaseUpdate=he,R.lastBaseUpdate=Ae,p=R.shared.interleaved,p!==null){R=p;do U|=R.lane,R=R.next;while(R!==p)}else k===null&&(R.shared.lanes=0);nc|=U,d.lanes=U,d.memoizedState=Ee}}function ZI(d,p,y){if(d=p.effects,p.effects=null,d!==null)for(p=0;p<d.length;p++){var w=d[p],R=w.callback;if(R!==null){if(w.callback=null,w=y,typeof R!="function")throw Error(t(191,R));R.call(w)}}}var tf={},bs=Ia(tf),nf=Ia(tf),rf=Ia(tf);function ec(d){if(d===tf)throw Error(t(174));return d}function dE(d,p){switch(Ot(rf,p),Ot(nf,d),Ot(bs,tf),d=p.nodeType,d){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:st(null,"");break;default:d=d===8?p.parentNode:p,p=d.namespaceURI||null,d=d.tagName,p=st(p,d)}Wt(bs),Ot(bs,p)}function Ad(){Wt(bs),Wt(nf),Wt(rf)}function qI(d){ec(rf.current);var p=ec(bs.current),y=st(p,d.type);p!==y&&(Ot(nf,d),Ot(bs,y))}function hE(d){nf.current===d&&(Wt(bs),Wt(nf))}var Gt=Ia(0);function M0(d){for(var p=d;p!==null;){if(p.tag===13){var y=p.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||y.data==="$?"||y.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var pE=[];function fE(){for(var d=0;d<pE.length;d++)pE[d]._workInProgressVersionPrimary=null;pE.length=0}var N0=I.ReactCurrentDispatcher,mE=I.ReactCurrentBatchConfig,tc=0,Kt=null,Sn=null,Rn=null,L0=!1,sf=!1,of=0,y3=0;function Jn(){throw Error(t(321))}function gE(d,p){if(p===null)return!1;for(var y=0;y<p.length&&y<d.length;y++)if(!$i(d[y],p[y]))return!1;return!0}function vE(d,p,y,w,R,k){if(tc=k,Kt=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,N0.current=d===null||d.memoizedState===null?T3:E3,d=y(w,R),sf){k=0;do{if(sf=!1,of=0,25<=k)throw Error(t(301));k+=1,Rn=Sn=null,p.updateQueue=null,N0.current=x3,d=y(w,R)}while(sf)}if(N0.current=B0,p=Sn!==null&&Sn.next!==null,tc=0,Rn=Sn=Kt=null,L0=!1,p)throw Error(t(300));return d}function yE(){var d=of!==0;return of=0,d}function Ps(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rn===null?Kt.memoizedState=Rn=d:Rn=Rn.next=d,Rn}function Ai(){if(Sn===null){var d=Kt.alternate;d=d!==null?d.memoizedState:null}else d=Sn.next;var p=Rn===null?Kt.memoizedState:Rn.next;if(p!==null)Rn=p,Sn=d;else{if(d===null)throw Error(t(310));Sn=d,d={memoizedState:Sn.memoizedState,baseState:Sn.baseState,baseQueue:Sn.baseQueue,queue:Sn.queue,next:null},Rn===null?Kt.memoizedState=Rn=d:Rn=Rn.next=d}return Rn}function af(d,p){return typeof p=="function"?p(d):p}function SE(d){var p=Ai(),y=p.queue;if(y===null)throw Error(t(311));y.lastRenderedReducer=d;var w=Sn,R=w.baseQueue,k=y.pending;if(k!==null){if(R!==null){var U=R.next;R.next=k.next,k.next=U}w.baseQueue=R=k,y.pending=null}if(R!==null){k=R.next,w=w.baseState;var Z=U=null,Q=null,he=k;do{var Ae=he.lane;if((tc&Ae)===Ae)Q!==null&&(Q=Q.next={lane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),w=he.hasEagerState?he.eagerState:d(w,he.action);else{var Ee={lane:Ae,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null};Q===null?(Z=Q=Ee,U=w):Q=Q.next=Ee,Kt.lanes|=Ae,nc|=Ae}he=he.next}while(he!==null&&he!==k);Q===null?U=w:Q.next=Z,$i(w,p.memoizedState)||(wr=!0),p.memoizedState=w,p.baseState=U,p.baseQueue=Q,y.lastRenderedState=w}if(d=y.interleaved,d!==null){R=d;do k=R.lane,Kt.lanes|=k,nc|=k,R=R.next;while(R!==d)}else R===null&&(y.lanes=0);return[p.memoizedState,y.dispatch]}function CE(d){var p=Ai(),y=p.queue;if(y===null)throw Error(t(311));y.lastRenderedReducer=d;var w=y.dispatch,R=y.pending,k=p.memoizedState;if(R!==null){y.pending=null;var U=R=R.next;do k=d(k,U.action),U=U.next;while(U!==R);$i(k,p.memoizedState)||(wr=!0),p.memoizedState=k,p.baseQueue===null&&(p.baseState=k),y.lastRenderedState=k}return[k,w]}function GI(){}function KI(d,p){var y=Kt,w=Ai(),R=p(),k=!$i(w.memoizedState,R);if(k&&(w.memoizedState=R,wr=!0),w=w.queue,AE(XI.bind(null,y,w,d),[d]),w.getSnapshot!==p||k||Rn!==null&&Rn.memoizedState.tag&1){if(y.flags|=2048,lf(9,JI.bind(null,y,w,R,p),void 0,null),In===null)throw Error(t(349));(tc&30)!==0||YI(y,p,R)}return R}function YI(d,p,y){d.flags|=16384,d={getSnapshot:p,value:y},p=Kt.updateQueue,p===null?(p={lastEffect:null,stores:null},Kt.updateQueue=p,p.stores=[d]):(y=p.stores,y===null?p.stores=[d]:y.push(d))}function JI(d,p,y,w){p.value=y,p.getSnapshot=w,QI(p)&&e1(d)}function XI(d,p,y){return y(function(){QI(p)&&e1(d)})}function QI(d){var p=d.getSnapshot;d=d.value;try{var y=p();return!$i(d,y)}catch{return!0}}function e1(d){var p=ho(d,1);p!==null&&Ki(p,d,1,-1)}function t1(d){var p=Ps();return typeof d=="function"&&(d=d()),p.memoizedState=p.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:af,lastRenderedState:d},p.queue=d,d=d.dispatch=A3.bind(null,Kt,d),[p.memoizedState,d]}function lf(d,p,y,w){return d={tag:d,create:p,destroy:y,deps:w,next:null},p=Kt.updateQueue,p===null?(p={lastEffect:null,stores:null},Kt.updateQueue=p,p.lastEffect=d.next=d):(y=p.lastEffect,y===null?p.lastEffect=d.next=d:(w=y.next,y.next=d,d.next=w,p.lastEffect=d)),d}function n1(){return Ai().memoizedState}function D0(d,p,y,w){var R=Ps();Kt.flags|=d,R.memoizedState=lf(1|p,y,void 0,w===void 0?null:w)}function O0(d,p,y,w){var R=Ai();w=w===void 0?null:w;var k=void 0;if(Sn!==null){var U=Sn.memoizedState;if(k=U.destroy,w!==null&&gE(w,U.deps)){R.memoizedState=lf(p,y,k,w);return}}Kt.flags|=d,R.memoizedState=lf(1|p,y,k,w)}function r1(d,p){return D0(8390656,8,d,p)}function AE(d,p){return O0(2048,8,d,p)}function i1(d,p){return O0(4,2,d,p)}function s1(d,p){return O0(4,4,d,p)}function o1(d,p){if(typeof p=="function")return d=d(),p(d),function(){p(null)};if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function a1(d,p,y){return y=y!=null?y.concat([d]):null,O0(4,4,o1.bind(null,p,d),y)}function TE(){}function l1(d,p){var y=Ai();p=p===void 0?null:p;var w=y.memoizedState;return w!==null&&p!==null&&gE(p,w[1])?w[0]:(y.memoizedState=[d,p],d)}function c1(d,p){var y=Ai();p=p===void 0?null:p;var w=y.memoizedState;return w!==null&&p!==null&&gE(p,w[1])?w[0]:(d=d(),y.memoizedState=[d,p],d)}function u1(d,p,y){return(tc&21)===0?(d.baseState&&(d.baseState=!1,wr=!0),d.memoizedState=y):($i(y,p)||(y=UR(),Kt.lanes|=y,nc|=y,d.baseState=!0),p)}function S3(d,p){var y=At;At=y!==0&&4>y?y:4,d(!0);var w=mE.transition;mE.transition={};try{d(!1),p()}finally{At=y,mE.transition=w}}function d1(){return Ai().memoizedState}function C3(d,p,y){var w=Ba(d);if(y={lane:w,action:y,hasEagerState:!1,eagerState:null,next:null},h1(d))p1(p,y);else if(y=VI(d,p,y,w),y!==null){var R=ur();Ki(y,d,w,R),f1(y,p,w)}}function A3(d,p,y){var w=Ba(d),R={lane:w,action:y,hasEagerState:!1,eagerState:null,next:null};if(h1(d))p1(p,R);else{var k=d.alternate;if(d.lanes===0&&(k===null||k.lanes===0)&&(k=p.lastRenderedReducer,k!==null))try{var U=p.lastRenderedState,Z=k(U,y);if(R.hasEagerState=!0,R.eagerState=Z,$i(Z,U)){var Q=p.interleaved;Q===null?(R.next=R,cE(p)):(R.next=Q.next,Q.next=R),p.interleaved=R;return}}catch{}finally{}y=VI(d,p,R,w),y!==null&&(R=ur(),Ki(y,d,w,R),f1(y,p,w))}}function h1(d){var p=d.alternate;return d===Kt||p!==null&&p===Kt}function p1(d,p){sf=L0=!0;var y=d.pending;y===null?p.next=p:(p.next=y.next,y.next=p),d.pending=p}function f1(d,p,y){if((y&4194240)!==0){var w=p.lanes;w&=d.pendingLanes,y|=w,p.lanes=y,xT(d,y)}}var B0={readContext:Ci,useCallback:Jn,useContext:Jn,useEffect:Jn,useImperativeHandle:Jn,useInsertionEffect:Jn,useLayoutEffect:Jn,useMemo:Jn,useReducer:Jn,useRef:Jn,useState:Jn,useDebugValue:Jn,useDeferredValue:Jn,useTransition:Jn,useMutableSource:Jn,useSyncExternalStore:Jn,useId:Jn,unstable_isNewReconciler:!1},T3={readContext:Ci,useCallback:function(d,p){return Ps().memoizedState=[d,p===void 0?null:p],d},useContext:Ci,useEffect:r1,useImperativeHandle:function(d,p,y){return y=y!=null?y.concat([d]):null,D0(4194308,4,o1.bind(null,p,d),y)},useLayoutEffect:function(d,p){return D0(4194308,4,d,p)},useInsertionEffect:function(d,p){return D0(4,2,d,p)},useMemo:function(d,p){var y=Ps();return p=p===void 0?null:p,d=d(),y.memoizedState=[d,p],d},useReducer:function(d,p,y){var w=Ps();return p=y!==void 0?y(p):p,w.memoizedState=w.baseState=p,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:p},w.queue=d,d=d.dispatch=C3.bind(null,Kt,d),[w.memoizedState,d]},useRef:function(d){var p=Ps();return d={current:d},p.memoizedState=d},useState:t1,useDebugValue:TE,useDeferredValue:function(d){return Ps().memoizedState=d},useTransition:function(){var d=t1(!1),p=d[0];return d=S3.bind(null,d[1]),Ps().memoizedState=d,[p,d]},useMutableSource:function(){},useSyncExternalStore:function(d,p,y){var w=Kt,R=Ps();if($t){if(y===void 0)throw Error(t(407));y=y()}else{if(y=p(),In===null)throw Error(t(349));(tc&30)!==0||YI(w,p,y)}R.memoizedState=y;var k={value:y,getSnapshot:p};return R.queue=k,r1(XI.bind(null,w,k,d),[d]),w.flags|=2048,lf(9,JI.bind(null,w,k,y,p),void 0,null),y},useId:function(){var d=Ps(),p=In.identifierPrefix;if($t){var y=uo,w=co;y=(w&~(1<<32-Vi(w)-1)).toString(32)+y,p=":"+p+"R"+y,y=of++,0<y&&(p+="H"+y.toString(32)),p+=":"}else y=y3++,p=":"+p+"r"+y.toString(32)+":";return d.memoizedState=p},unstable_isNewReconciler:!1},E3={readContext:Ci,useCallback:l1,useContext:Ci,useEffect:AE,useImperativeHandle:a1,useInsertionEffect:i1,useLayoutEffect:s1,useMemo:c1,useReducer:SE,useRef:n1,useState:function(){return SE(af)},useDebugValue:TE,useDeferredValue:function(d){var p=Ai();return u1(p,Sn.memoizedState,d)},useTransition:function(){var d=SE(af)[0],p=Ai().memoizedState;return[d,p]},useMutableSource:GI,useSyncExternalStore:KI,useId:d1,unstable_isNewReconciler:!1},x3={readContext:Ci,useCallback:l1,useContext:Ci,useEffect:AE,useImperativeHandle:a1,useInsertionEffect:i1,useLayoutEffect:s1,useMemo:c1,useReducer:CE,useRef:n1,useState:function(){return CE(af)},useDebugValue:TE,useDeferredValue:function(d){var p=Ai();return Sn===null?p.memoizedState=d:u1(p,Sn.memoizedState,d)},useTransition:function(){var d=CE(af)[0],p=Ai().memoizedState;return[d,p]},useMutableSource:GI,useSyncExternalStore:KI,useId:d1,unstable_isNewReconciler:!1};function Zi(d,p){if(d&&d.defaultProps){p=ae({},p),d=d.defaultProps;for(var y in d)p[y]===void 0&&(p[y]=d[y]);return p}return p}function EE(d,p,y,w){p=d.memoizedState,y=y(w,p),y=y==null?p:ae({},p,y),d.memoizedState=y,d.lanes===0&&(d.updateQueue.baseState=y)}var F0={isMounted:function(d){return(d=d._reactInternals)?Gl(d)===d:!1},enqueueSetState:function(d,p,y){d=d._reactInternals;var w=ur(),R=Ba(d),k=po(w,R);k.payload=p,y!=null&&(k.callback=y),p=Na(d,k,R),p!==null&&(Ki(p,d,R,w),_0(p,d,R))},enqueueReplaceState:function(d,p,y){d=d._reactInternals;var w=ur(),R=Ba(d),k=po(w,R);k.tag=1,k.payload=p,y!=null&&(k.callback=y),p=Na(d,k,R),p!==null&&(Ki(p,d,R,w),_0(p,d,R))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var y=ur(),w=Ba(d),R=po(y,w);R.tag=2,p!=null&&(R.callback=p),p=Na(d,R,w),p!==null&&(Ki(p,d,w,y),_0(p,d,w))}};function m1(d,p,y,w,R,k,U){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(w,k,U):p.prototype&&p.prototype.isPureReactComponent?!qp(y,w)||!qp(R,k):!0}function g1(d,p,y){var w=!1,R=_a,k=p.contextType;return typeof k=="object"&&k!==null?k=Ci(k):(R=xr(p)?Yl:Yn.current,w=p.contextTypes,k=(w=w!=null)?fd(d,R):_a),p=new p(y,k),d.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=F0,d.stateNode=p,p._reactInternals=d,w&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=R,d.__reactInternalMemoizedMaskedChildContext=k),p}function v1(d,p,y,w){d=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(y,w),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(y,w),p.state!==d&&F0.enqueueReplaceState(p,p.state,null)}function xE(d,p,y,w){var R=d.stateNode;R.props=y,R.state=d.memoizedState,R.refs={},uE(d);var k=p.contextType;typeof k=="object"&&k!==null?R.context=Ci(k):(k=xr(p)?Yl:Yn.current,R.context=fd(d,k)),R.state=d.memoizedState,k=p.getDerivedStateFromProps,typeof k=="function"&&(EE(d,p,k,y),R.state=d.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(p=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),p!==R.state&&F0.enqueueReplaceState(R,R.state,null),k0(d,y,R,w),R.state=d.memoizedState),typeof R.componentDidMount=="function"&&(d.flags|=4194308)}function Td(d,p){try{var y="",w=p;do y+=Te(w),w=w.return;while(w);var R=y}catch(k){R=`
Error generating stack: `+k.message+`
`+k.stack}return{value:d,source:p,stack:R,digest:null}}function wE(d,p,y){return{value:d,source:null,stack:y??null,digest:p??null}}function bE(d,p){try{console.error(p.value)}catch(y){setTimeout(function(){throw y})}}var w3=typeof WeakMap=="function"?WeakMap:Map;function y1(d,p,y){y=po(-1,y),y.tag=3,y.payload={element:null};var w=p.value;return y.callback=function(){H0||(H0=!0,zE=w),bE(d,p)},y}function S1(d,p,y){y=po(-1,y),y.tag=3;var w=d.type.getDerivedStateFromError;if(typeof w=="function"){var R=p.value;y.payload=function(){return w(R)},y.callback=function(){bE(d,p)}}var k=d.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(y.callback=function(){bE(d,p),typeof w!="function"&&(Da===null?Da=new Set([this]):Da.add(this));var U=p.stack;this.componentDidCatch(p.value,{componentStack:U!==null?U:""})}),y}function C1(d,p,y){var w=d.pingCache;if(w===null){w=d.pingCache=new w3;var R=new Set;w.set(p,R)}else R=w.get(p),R===void 0&&(R=new Set,w.set(p,R));R.has(y)||(R.add(y),d=j3.bind(null,d,p,y),p.then(d,d))}function A1(d){do{var p;if((p=d.tag===13)&&(p=d.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return d;d=d.return}while(d!==null);return null}function T1(d,p,y,w,R){return(d.mode&1)===0?(d===p?d.flags|=65536:(d.flags|=128,y.flags|=131072,y.flags&=-52805,y.tag===1&&(y.alternate===null?y.tag=17:(p=po(-1,1),p.tag=2,Na(y,p,1))),y.lanes|=1),d):(d.flags|=65536,d.lanes=R,d)}var b3=I.ReactCurrentOwner,wr=!1;function cr(d,p,y,w){p.child=d===null?WI(p,null,y,w):yd(p,d.child,y,w)}function E1(d,p,y,w,R){y=y.render;var k=p.ref;return Cd(p,R),w=vE(d,p,y,w,k,R),y=yE(),d!==null&&!wr?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~R,fo(d,p,R)):($t&&y&&eE(p),p.flags|=1,cr(d,p,w,R),p.child)}function x1(d,p,y,w,R){if(d===null){var k=y.type;return typeof k=="function"&&!GE(k)&&k.defaultProps===void 0&&y.compare===null&&y.defaultProps===void 0?(p.tag=15,p.type=k,w1(d,p,k,w,R)):(d=J0(y.type,null,w,p,p.mode,R),d.ref=p.ref,d.return=p,p.child=d)}if(k=d.child,(d.lanes&R)===0){var U=k.memoizedProps;if(y=y.compare,y=y!==null?y:qp,y(U,w)&&d.ref===p.ref)return fo(d,p,R)}return p.flags|=1,d=ja(k,w),d.ref=p.ref,d.return=p,p.child=d}function w1(d,p,y,w,R){if(d!==null){var k=d.memoizedProps;if(qp(k,w)&&d.ref===p.ref)if(wr=!1,p.pendingProps=w=k,(d.lanes&R)!==0)(d.flags&131072)!==0&&(wr=!0);else return p.lanes=d.lanes,fo(d,p,R)}return PE(d,p,y,w,R)}function b1(d,p,y){var w=p.pendingProps,R=w.children,k=d!==null?d.memoizedState:null;if(w.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ot(xd,Wr),Wr|=y;else{if((y&1073741824)===0)return d=k!==null?k.baseLanes|y:y,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:d,cachePool:null,transitions:null},p.updateQueue=null,Ot(xd,Wr),Wr|=d,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=k!==null?k.baseLanes:y,Ot(xd,Wr),Wr|=w}else k!==null?(w=k.baseLanes|y,p.memoizedState=null):w=y,Ot(xd,Wr),Wr|=w;return cr(d,p,R,y),p.child}function P1(d,p){var y=p.ref;(d===null&&y!==null||d!==null&&d.ref!==y)&&(p.flags|=512,p.flags|=2097152)}function PE(d,p,y,w,R){var k=xr(y)?Yl:Yn.current;return k=fd(p,k),Cd(p,R),y=vE(d,p,y,w,k,R),w=yE(),d!==null&&!wr?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~R,fo(d,p,R)):($t&&w&&eE(p),p.flags|=1,cr(d,p,y,R),p.child)}function R1(d,p,y,w,R){if(xr(y)){var k=!0;T0(p)}else k=!1;if(Cd(p,R),p.stateNode===null)U0(d,p),g1(p,y,w),xE(p,y,w,R),w=!0;else if(d===null){var U=p.stateNode,Z=p.memoizedProps;U.props=Z;var Q=U.context,he=y.contextType;typeof he=="object"&&he!==null?he=Ci(he):(he=xr(y)?Yl:Yn.current,he=fd(p,he));var Ae=y.getDerivedStateFromProps,Ee=typeof Ae=="function"||typeof U.getSnapshotBeforeUpdate=="function";Ee||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(Z!==w||Q!==he)&&v1(p,U,w,he),Ma=!1;var Ce=p.memoizedState;U.state=Ce,k0(p,w,U,R),Q=p.memoizedState,Z!==w||Ce!==Q||Er.current||Ma?(typeof Ae=="function"&&(EE(p,y,Ae,w),Q=p.memoizedState),(Z=Ma||m1(p,y,Z,w,Ce,Q,he))?(Ee||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(p.flags|=4194308)):(typeof U.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=w,p.memoizedState=Q),U.props=w,U.state=Q,U.context=he,w=Z):(typeof U.componentDidMount=="function"&&(p.flags|=4194308),w=!1)}else{U=p.stateNode,$I(d,p),Z=p.memoizedProps,he=p.type===p.elementType?Z:Zi(p.type,Z),U.props=he,Ee=p.pendingProps,Ce=U.context,Q=y.contextType,typeof Q=="object"&&Q!==null?Q=Ci(Q):(Q=xr(y)?Yl:Yn.current,Q=fd(p,Q));var Me=y.getDerivedStateFromProps;(Ae=typeof Me=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(Z!==Ee||Ce!==Q)&&v1(p,U,w,Q),Ma=!1,Ce=p.memoizedState,U.state=Ce,k0(p,w,U,R);var Oe=p.memoizedState;Z!==Ee||Ce!==Oe||Er.current||Ma?(typeof Me=="function"&&(EE(p,y,Me,w),Oe=p.memoizedState),(he=Ma||m1(p,y,he,w,Ce,Oe,Q)||!1)?(Ae||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(w,Oe,Q),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(w,Oe,Q)),typeof U.componentDidUpdate=="function"&&(p.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof U.componentDidUpdate!="function"||Z===d.memoizedProps&&Ce===d.memoizedState||(p.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||Z===d.memoizedProps&&Ce===d.memoizedState||(p.flags|=1024),p.memoizedProps=w,p.memoizedState=Oe),U.props=w,U.state=Oe,U.context=Q,w=he):(typeof U.componentDidUpdate!="function"||Z===d.memoizedProps&&Ce===d.memoizedState||(p.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||Z===d.memoizedProps&&Ce===d.memoizedState||(p.flags|=1024),w=!1)}return RE(d,p,y,w,k,R)}function RE(d,p,y,w,R,k){P1(d,p);var U=(p.flags&128)!==0;if(!w&&!U)return R&&NI(p,y,!1),fo(d,p,k);w=p.stateNode,b3.current=p;var Z=U&&typeof y.getDerivedStateFromError!="function"?null:w.render();return p.flags|=1,d!==null&&U?(p.child=yd(p,d.child,null,k),p.child=yd(p,null,Z,k)):cr(d,p,Z,k),p.memoizedState=w.state,R&&NI(p,y,!0),p.child}function I1(d){var p=d.stateNode;p.pendingContext?kI(d,p.pendingContext,p.pendingContext!==p.context):p.context&&kI(d,p.context,!1),dE(d,p.containerInfo)}function _1(d,p,y,w,R){return vd(),iE(R),p.flags|=256,cr(d,p,y,w),p.child}var IE={dehydrated:null,treeContext:null,retryLane:0};function _E(d){return{baseLanes:d,cachePool:null,transitions:null}}function k1(d,p,y){var w=p.pendingProps,R=Gt.current,k=!1,U=(p.flags&128)!==0,Z;if((Z=U)||(Z=d!==null&&d.memoizedState===null?!1:(R&2)!==0),Z?(k=!0,p.flags&=-129):(d===null||d.memoizedState!==null)&&(R|=1),Ot(Gt,R&1),d===null)return rE(p),d=p.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((p.mode&1)===0?p.lanes=1:d.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(U=w.children,d=w.fallback,k?(w=p.mode,k=p.child,U={mode:"hidden",children:U},(w&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=U):k=X0(U,w,0,null),d=oc(d,w,y,null),k.return=p,d.return=p,k.sibling=d,p.child=k,p.child.memoizedState=_E(y),p.memoizedState=IE,d):kE(p,U));if(R=d.memoizedState,R!==null&&(Z=R.dehydrated,Z!==null))return P3(d,p,U,w,Z,R,y);if(k){k=w.fallback,U=p.mode,R=d.child,Z=R.sibling;var Q={mode:"hidden",children:w.children};return(U&1)===0&&p.child!==R?(w=p.child,w.childLanes=0,w.pendingProps=Q,p.deletions=null):(w=ja(R,Q),w.subtreeFlags=R.subtreeFlags&14680064),Z!==null?k=ja(Z,k):(k=oc(k,U,y,null),k.flags|=2),k.return=p,w.return=p,w.sibling=k,p.child=w,w=k,k=p.child,U=d.child.memoizedState,U=U===null?_E(y):{baseLanes:U.baseLanes|y,cachePool:null,transitions:U.transitions},k.memoizedState=U,k.childLanes=d.childLanes&~y,p.memoizedState=IE,w}return k=d.child,d=k.sibling,w=ja(k,{mode:"visible",children:w.children}),(p.mode&1)===0&&(w.lanes=y),w.return=p,w.sibling=null,d!==null&&(y=p.deletions,y===null?(p.deletions=[d],p.flags|=16):y.push(d)),p.child=w,p.memoizedState=null,w}function kE(d,p){return p=X0({mode:"visible",children:p},d.mode,0,null),p.return=d,d.child=p}function j0(d,p,y,w){return w!==null&&iE(w),yd(p,d.child,null,y),d=kE(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function P3(d,p,y,w,R,k,U){if(y)return p.flags&256?(p.flags&=-257,w=wE(Error(t(422))),j0(d,p,U,w)):p.memoizedState!==null?(p.child=d.child,p.flags|=128,null):(k=w.fallback,R=p.mode,w=X0({mode:"visible",children:w.children},R,0,null),k=oc(k,R,U,null),k.flags|=2,w.return=p,k.return=p,w.sibling=k,p.child=w,(p.mode&1)!==0&&yd(p,d.child,null,U),p.child.memoizedState=_E(U),p.memoizedState=IE,k);if((p.mode&1)===0)return j0(d,p,U,null);if(R.data==="$!"){if(w=R.nextSibling&&R.nextSibling.dataset,w)var Z=w.dgst;return w=Z,k=Error(t(419)),w=wE(k,w,void 0),j0(d,p,U,w)}if(Z=(U&d.childLanes)!==0,wr||Z){if(w=In,w!==null){switch(U&-U){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=(R&(w.suspendedLanes|U))!==0?0:R,R!==0&&R!==k.retryLane&&(k.retryLane=R,ho(d,R),Ki(w,d,R,-1))}return qE(),w=wE(Error(t(421))),j0(d,p,U,w)}return R.data==="$?"?(p.flags|=128,p.child=d.child,p=U3.bind(null,d),R._reactRetry=p,null):(d=k.treeContext,zr=Ra(R.nextSibling),Ur=p,$t=!0,Hi=null,d!==null&&(yi[Si++]=co,yi[Si++]=uo,yi[Si++]=Jl,co=d.id,uo=d.overflow,Jl=p),p=kE(p,w.children),p.flags|=4096,p)}function M1(d,p,y){d.lanes|=p;var w=d.alternate;w!==null&&(w.lanes|=p),lE(d.return,p,y)}function ME(d,p,y,w,R){var k=d.memoizedState;k===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:w,tail:y,tailMode:R}:(k.isBackwards=p,k.rendering=null,k.renderingStartTime=0,k.last=w,k.tail=y,k.tailMode=R)}function N1(d,p,y){var w=p.pendingProps,R=w.revealOrder,k=w.tail;if(cr(d,p,w.children,y),w=Gt.current,(w&2)!==0)w=w&1|2,p.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&M1(d,y,p);else if(d.tag===19)M1(d,y,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}w&=1}if(Ot(Gt,w),(p.mode&1)===0)p.memoizedState=null;else switch(R){case"forwards":for(y=p.child,R=null;y!==null;)d=y.alternate,d!==null&&M0(d)===null&&(R=y),y=y.sibling;y=R,y===null?(R=p.child,p.child=null):(R=y.sibling,y.sibling=null),ME(p,!1,R,y,k);break;case"backwards":for(y=null,R=p.child,p.child=null;R!==null;){if(d=R.alternate,d!==null&&M0(d)===null){p.child=R;break}d=R.sibling,R.sibling=y,y=R,R=d}ME(p,!0,y,null,k);break;case"together":ME(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function U0(d,p){(p.mode&1)===0&&d!==null&&(d.alternate=null,p.alternate=null,p.flags|=2)}function fo(d,p,y){if(d!==null&&(p.dependencies=d.dependencies),nc|=p.lanes,(y&p.childLanes)===0)return null;if(d!==null&&p.child!==d.child)throw Error(t(153));if(p.child!==null){for(d=p.child,y=ja(d,d.pendingProps),p.child=y,y.return=p;d.sibling!==null;)d=d.sibling,y=y.sibling=ja(d,d.pendingProps),y.return=p;y.sibling=null}return p.child}function R3(d,p,y){switch(p.tag){case 3:I1(p),vd();break;case 5:qI(p);break;case 1:xr(p.type)&&T0(p);break;case 4:dE(p,p.stateNode.containerInfo);break;case 10:var w=p.type._context,R=p.memoizedProps.value;Ot(R0,w._currentValue),w._currentValue=R;break;case 13:if(w=p.memoizedState,w!==null)return w.dehydrated!==null?(Ot(Gt,Gt.current&1),p.flags|=128,null):(y&p.child.childLanes)!==0?k1(d,p,y):(Ot(Gt,Gt.current&1),d=fo(d,p,y),d!==null?d.sibling:null);Ot(Gt,Gt.current&1);break;case 19:if(w=(y&p.childLanes)!==0,(d.flags&128)!==0){if(w)return N1(d,p,y);p.flags|=128}if(R=p.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),Ot(Gt,Gt.current),w)break;return null;case 22:case 23:return p.lanes=0,b1(d,p,y)}return fo(d,p,y)}var L1,NE,D1,O1;L1=function(d,p){for(var y=p.child;y!==null;){if(y.tag===5||y.tag===6)d.appendChild(y.stateNode);else if(y.tag!==4&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===p)break;for(;y.sibling===null;){if(y.return===null||y.return===p)return;y=y.return}y.sibling.return=y.return,y=y.sibling}},NE=function(){},D1=function(d,p,y,w){var R=d.memoizedProps;if(R!==w){d=p.stateNode,ec(bs.current);var k=null;switch(y){case"input":R=ge(d,R),w=ge(d,w),k=[];break;case"select":R=ae({},R,{value:void 0}),w=ae({},w,{value:void 0}),k=[];break;case"textarea":R=vi(d,R),w=vi(d,w),k=[];break;default:typeof R.onClick!="function"&&typeof w.onClick=="function"&&(d.onclick=S0)}ya(y,w);var U;y=null;for(he in R)if(!w.hasOwnProperty(he)&&R.hasOwnProperty(he)&&R[he]!=null)if(he==="style"){var Z=R[he];for(U in Z)Z.hasOwnProperty(U)&&(y||(y={}),y[U]="")}else he!=="dangerouslySetInnerHTML"&&he!=="children"&&he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&he!=="autoFocus"&&(i.hasOwnProperty(he)?k||(k=[]):(k=k||[]).push(he,null));for(he in w){var Q=w[he];if(Z=R!=null?R[he]:void 0,w.hasOwnProperty(he)&&Q!==Z&&(Q!=null||Z!=null))if(he==="style")if(Z){for(U in Z)!Z.hasOwnProperty(U)||Q&&Q.hasOwnProperty(U)||(y||(y={}),y[U]="");for(U in Q)Q.hasOwnProperty(U)&&Z[U]!==Q[U]&&(y||(y={}),y[U]=Q[U])}else y||(k||(k=[]),k.push(he,y)),y=Q;else he==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,Z=Z?Z.__html:void 0,Q!=null&&Z!==Q&&(k=k||[]).push(he,Q)):he==="children"?typeof Q!="string"&&typeof Q!="number"||(k=k||[]).push(he,""+Q):he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&(i.hasOwnProperty(he)?(Q!=null&&he==="onScroll"&&zt("scroll",d),k||Z===Q||(k=[])):(k=k||[]).push(he,Q))}y&&(k=k||[]).push("style",y);var he=k;(p.updateQueue=he)&&(p.flags|=4)}},O1=function(d,p,y,w){y!==w&&(p.flags|=4)};function cf(d,p){if(!$t)switch(d.tailMode){case"hidden":p=d.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?d.tail=null:y.sibling=null;break;case"collapsed":y=d.tail;for(var w=null;y!==null;)y.alternate!==null&&(w=y),y=y.sibling;w===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:w.sibling=null}}function Xn(d){var p=d.alternate!==null&&d.alternate.child===d.child,y=0,w=0;if(p)for(var R=d.child;R!==null;)y|=R.lanes|R.childLanes,w|=R.subtreeFlags&14680064,w|=R.flags&14680064,R.return=d,R=R.sibling;else for(R=d.child;R!==null;)y|=R.lanes|R.childLanes,w|=R.subtreeFlags,w|=R.flags,R.return=d,R=R.sibling;return d.subtreeFlags|=w,d.childLanes=y,p}function I3(d,p,y){var w=p.pendingProps;switch(tE(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xn(p),null;case 1:return xr(p.type)&&A0(),Xn(p),null;case 3:return w=p.stateNode,Ad(),Wt(Er),Wt(Yn),fE(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(d===null||d.child===null)&&(b0(p)?p.flags|=4:d===null||d.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,Hi!==null&&($E(Hi),Hi=null))),NE(d,p),Xn(p),null;case 5:hE(p);var R=ec(rf.current);if(y=p.type,d!==null&&p.stateNode!=null)D1(d,p,y,w,R),d.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!w){if(p.stateNode===null)throw Error(t(166));return Xn(p),null}if(d=ec(bs.current),b0(p)){w=p.stateNode,y=p.type;var k=p.memoizedProps;switch(w[ws]=p,w[Xp]=k,d=(p.mode&1)!==0,y){case"dialog":zt("cancel",w),zt("close",w);break;case"iframe":case"object":case"embed":zt("load",w);break;case"video":case"audio":for(R=0;R<Kp.length;R++)zt(Kp[R],w);break;case"source":zt("error",w);break;case"img":case"image":case"link":zt("error",w),zt("load",w);break;case"details":zt("toggle",w);break;case"input":Ie(w,k),zt("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!k.multiple},zt("invalid",w);break;case"textarea":Ss(w,k),zt("invalid",w)}ya(y,k),R=null;for(var U in k)if(k.hasOwnProperty(U)){var Z=k[U];U==="children"?typeof Z=="string"?w.textContent!==Z&&(k.suppressHydrationWarning!==!0&&y0(w.textContent,Z,d),R=["children",Z]):typeof Z=="number"&&w.textContent!==""+Z&&(k.suppressHydrationWarning!==!0&&y0(w.textContent,Z,d),R=["children",""+Z]):i.hasOwnProperty(U)&&Z!=null&&U==="onScroll"&&zt("scroll",w)}switch(y){case"input":pe(w),$e(w,k,!0);break;case"textarea":pe(w),As(w);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(w.onclick=S0)}w=R,p.updateQueue=w,w!==null&&(p.flags|=4)}else{U=R.nodeType===9?R:R.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=ye(y)),d==="http://www.w3.org/1999/xhtml"?y==="script"?(d=U.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof w.is=="string"?d=U.createElement(y,{is:w.is}):(d=U.createElement(y),y==="select"&&(U=d,w.multiple?U.multiple=!0:w.size&&(U.size=w.size))):d=U.createElementNS(d,y),d[ws]=p,d[Xp]=w,L1(d,p,!1,!1),p.stateNode=d;e:{switch(U=Sa(y,w),y){case"dialog":zt("cancel",d),zt("close",d),R=w;break;case"iframe":case"object":case"embed":zt("load",d),R=w;break;case"video":case"audio":for(R=0;R<Kp.length;R++)zt(Kp[R],d);R=w;break;case"source":zt("error",d),R=w;break;case"img":case"image":case"link":zt("error",d),zt("load",d),R=w;break;case"details":zt("toggle",d),R=w;break;case"input":Ie(d,w),R=ge(d,w),zt("invalid",d);break;case"option":R=w;break;case"select":d._wrapperState={wasMultiple:!!w.multiple},R=ae({},w,{value:void 0}),zt("invalid",d);break;case"textarea":Ss(d,w),R=vi(d,w),zt("invalid",d);break;default:R=w}ya(y,R),Z=R;for(k in Z)if(Z.hasOwnProperty(k)){var Q=Z[k];k==="style"?Zl(d,Q):k==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,Q!=null&&lr(d,Q)):k==="children"?typeof Q=="string"?(y!=="textarea"||Q!=="")&&Ts(d,Q):typeof Q=="number"&&Ts(d,""+Q):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(i.hasOwnProperty(k)?Q!=null&&k==="onScroll"&&zt("scroll",d):Q!=null&&b(d,k,Q,U))}switch(y){case"input":pe(d),$e(d,w,!1);break;case"textarea":pe(d),As(d);break;case"option":w.value!=null&&d.setAttribute("value",""+ie(w.value));break;case"select":d.multiple=!!w.multiple,k=w.value,k!=null?gt(d,!!w.multiple,k,!1):w.defaultValue!=null&&gt(d,!!w.multiple,w.defaultValue,!0);break;default:typeof R.onClick=="function"&&(d.onclick=S0)}switch(y){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return Xn(p),null;case 6:if(d&&p.stateNode!=null)O1(d,p,d.memoizedProps,w);else{if(typeof w!="string"&&p.stateNode===null)throw Error(t(166));if(y=ec(rf.current),ec(bs.current),b0(p)){if(w=p.stateNode,y=p.memoizedProps,w[ws]=p,(k=w.nodeValue!==y)&&(d=Ur,d!==null))switch(d.tag){case 3:y0(w.nodeValue,y,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&y0(w.nodeValue,y,(d.mode&1)!==0)}k&&(p.flags|=4)}else w=(y.nodeType===9?y:y.ownerDocument).createTextNode(w),w[ws]=p,p.stateNode=w}return Xn(p),null;case 13:if(Wt(Gt),w=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if($t&&zr!==null&&(p.mode&1)!==0&&(p.flags&128)===0)jI(),vd(),p.flags|=98560,k=!1;else if(k=b0(p),w!==null&&w.dehydrated!==null){if(d===null){if(!k)throw Error(t(318));if(k=p.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(t(317));k[ws]=p}else vd(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;Xn(p),k=!1}else Hi!==null&&($E(Hi),Hi=null),k=!0;if(!k)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=y,p):(w=w!==null,w!==(d!==null&&d.memoizedState!==null)&&w&&(p.child.flags|=8192,(p.mode&1)!==0&&(d===null||(Gt.current&1)!==0?Cn===0&&(Cn=3):qE())),p.updateQueue!==null&&(p.flags|=4),Xn(p),null);case 4:return Ad(),NE(d,p),d===null&&Yp(p.stateNode.containerInfo),Xn(p),null;case 10:return aE(p.type._context),Xn(p),null;case 17:return xr(p.type)&&A0(),Xn(p),null;case 19:if(Wt(Gt),k=p.memoizedState,k===null)return Xn(p),null;if(w=(p.flags&128)!==0,U=k.rendering,U===null)if(w)cf(k,!1);else{if(Cn!==0||d!==null&&(d.flags&128)!==0)for(d=p.child;d!==null;){if(U=M0(d),U!==null){for(p.flags|=128,cf(k,!1),w=U.updateQueue,w!==null&&(p.updateQueue=w,p.flags|=4),p.subtreeFlags=0,w=y,y=p.child;y!==null;)k=y,d=w,k.flags&=14680066,U=k.alternate,U===null?(k.childLanes=0,k.lanes=d,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=U.childLanes,k.lanes=U.lanes,k.child=U.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=U.memoizedProps,k.memoizedState=U.memoizedState,k.updateQueue=U.updateQueue,k.type=U.type,d=U.dependencies,k.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),y=y.sibling;return Ot(Gt,Gt.current&1|2),p.child}d=d.sibling}k.tail!==null&&un()>wd&&(p.flags|=128,w=!0,cf(k,!1),p.lanes=4194304)}else{if(!w)if(d=M0(U),d!==null){if(p.flags|=128,w=!0,y=d.updateQueue,y!==null&&(p.updateQueue=y,p.flags|=4),cf(k,!0),k.tail===null&&k.tailMode==="hidden"&&!U.alternate&&!$t)return Xn(p),null}else 2*un()-k.renderingStartTime>wd&&y!==1073741824&&(p.flags|=128,w=!0,cf(k,!1),p.lanes=4194304);k.isBackwards?(U.sibling=p.child,p.child=U):(y=k.last,y!==null?y.sibling=U:p.child=U,k.last=U)}return k.tail!==null?(p=k.tail,k.rendering=p,k.tail=p.sibling,k.renderingStartTime=un(),p.sibling=null,y=Gt.current,Ot(Gt,w?y&1|2:y&1),p):(Xn(p),null);case 22:case 23:return ZE(),w=p.memoizedState!==null,d!==null&&d.memoizedState!==null!==w&&(p.flags|=8192),w&&(p.mode&1)!==0?(Wr&1073741824)!==0&&(Xn(p),p.subtreeFlags&6&&(p.flags|=8192)):Xn(p),null;case 24:return null;case 25:return null}throw Error(t(156,p.tag))}function _3(d,p){switch(tE(p),p.tag){case 1:return xr(p.type)&&A0(),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return Ad(),Wt(Er),Wt(Yn),fE(),d=p.flags,(d&65536)!==0&&(d&128)===0?(p.flags=d&-65537|128,p):null;case 5:return hE(p),null;case 13:if(Wt(Gt),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(t(340));vd()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return Wt(Gt),null;case 4:return Ad(),null;case 10:return aE(p.type._context),null;case 22:case 23:return ZE(),null;case 24:return null;default:return null}}var z0=!1,Qn=!1,k3=typeof WeakSet=="function"?WeakSet:Set,De=null;function Ed(d,p){var y=d.ref;if(y!==null)if(typeof y=="function")try{y(null)}catch(w){tn(d,p,w)}else y.current=null}function LE(d,p,y){try{y()}catch(w){tn(d,p,w)}}var B1=!1;function M3(d,p){if(ZT=a0,d=mI(),FT(d)){if("selectionStart"in d)var y={start:d.selectionStart,end:d.selectionEnd};else e:{y=(y=d.ownerDocument)&&y.defaultView||window;var w=y.getSelection&&y.getSelection();if(w&&w.rangeCount!==0){y=w.anchorNode;var R=w.anchorOffset,k=w.focusNode;w=w.focusOffset;try{y.nodeType,k.nodeType}catch{y=null;break e}var U=0,Z=-1,Q=-1,he=0,Ae=0,Ee=d,Ce=null;t:for(;;){for(var Me;Ee!==y||R!==0&&Ee.nodeType!==3||(Z=U+R),Ee!==k||w!==0&&Ee.nodeType!==3||(Q=U+w),Ee.nodeType===3&&(U+=Ee.nodeValue.length),(Me=Ee.firstChild)!==null;)Ce=Ee,Ee=Me;for(;;){if(Ee===d)break t;if(Ce===y&&++he===R&&(Z=U),Ce===k&&++Ae===w&&(Q=U),(Me=Ee.nextSibling)!==null)break;Ee=Ce,Ce=Ee.parentNode}Ee=Me}y=Z===-1||Q===-1?null:{start:Z,end:Q}}else y=null}y=y||{start:0,end:0}}else y=null;for(qT={focusedElem:d,selectionRange:y},a0=!1,De=p;De!==null;)if(p=De,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,De=d;else for(;De!==null;){p=De;try{var Oe=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Oe!==null){var Be=Oe.memoizedProps,dn=Oe.memoizedState,oe=p.stateNode,te=oe.getSnapshotBeforeUpdate(p.elementType===p.type?Be:Zi(p.type,Be),dn);oe.__reactInternalSnapshotBeforeUpdate=te}break;case 3:var ue=p.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(we){tn(p,p.return,we)}if(d=p.sibling,d!==null){d.return=p.return,De=d;break}De=p.return}return Oe=B1,B1=!1,Oe}function uf(d,p,y){var w=p.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var R=w=w.next;do{if((R.tag&d)===d){var k=R.destroy;R.destroy=void 0,k!==void 0&&LE(p,y,k)}R=R.next}while(R!==w)}}function W0(d,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var y=p=p.next;do{if((y.tag&d)===d){var w=y.create;y.destroy=w()}y=y.next}while(y!==p)}}function DE(d){var p=d.ref;if(p!==null){var y=d.stateNode;switch(d.tag){case 5:d=y;break;default:d=y}typeof p=="function"?p(d):p.current=d}}function F1(d){var p=d.alternate;p!==null&&(d.alternate=null,F1(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&(delete p[ws],delete p[Xp],delete p[JT],delete p[f3],delete p[m3])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function j1(d){return d.tag===5||d.tag===3||d.tag===4}function U1(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||j1(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function OE(d,p,y){var w=d.tag;if(w===5||w===6)d=d.stateNode,p?y.nodeType===8?y.parentNode.insertBefore(d,p):y.insertBefore(d,p):(y.nodeType===8?(p=y.parentNode,p.insertBefore(d,y)):(p=y,p.appendChild(d)),y=y._reactRootContainer,y!=null||p.onclick!==null||(p.onclick=S0));else if(w!==4&&(d=d.child,d!==null))for(OE(d,p,y),d=d.sibling;d!==null;)OE(d,p,y),d=d.sibling}function BE(d,p,y){var w=d.tag;if(w===5||w===6)d=d.stateNode,p?y.insertBefore(d,p):y.appendChild(d);else if(w!==4&&(d=d.child,d!==null))for(BE(d,p,y),d=d.sibling;d!==null;)BE(d,p,y),d=d.sibling}var jn=null,qi=!1;function La(d,p,y){for(y=y.child;y!==null;)z1(d,p,y),y=y.sibling}function z1(d,p,y){if(xs&&typeof xs.onCommitFiberUnmount=="function")try{xs.onCommitFiberUnmount(t0,y)}catch{}switch(y.tag){case 5:Qn||Ed(y,p);case 6:var w=jn,R=qi;jn=null,La(d,p,y),jn=w,qi=R,jn!==null&&(qi?(d=jn,y=y.stateNode,d.nodeType===8?d.parentNode.removeChild(y):d.removeChild(y)):jn.removeChild(y.stateNode));break;case 18:jn!==null&&(qi?(d=jn,y=y.stateNode,d.nodeType===8?YT(d.parentNode,y):d.nodeType===1&&YT(d,y),zp(d)):YT(jn,y.stateNode));break;case 4:w=jn,R=qi,jn=y.stateNode.containerInfo,qi=!0,La(d,p,y),jn=w,qi=R;break;case 0:case 11:case 14:case 15:if(!Qn&&(w=y.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){R=w=w.next;do{var k=R,U=k.destroy;k=k.tag,U!==void 0&&((k&2)!==0||(k&4)!==0)&&LE(y,p,U),R=R.next}while(R!==w)}La(d,p,y);break;case 1:if(!Qn&&(Ed(y,p),w=y.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=y.memoizedProps,w.state=y.memoizedState,w.componentWillUnmount()}catch(Z){tn(y,p,Z)}La(d,p,y);break;case 21:La(d,p,y);break;case 22:y.mode&1?(Qn=(w=Qn)||y.memoizedState!==null,La(d,p,y),Qn=w):La(d,p,y);break;default:La(d,p,y)}}function W1(d){var p=d.updateQueue;if(p!==null){d.updateQueue=null;var y=d.stateNode;y===null&&(y=d.stateNode=new k3),p.forEach(function(w){var R=z3.bind(null,d,w);y.has(w)||(y.add(w),w.then(R,R))})}}function Gi(d,p){var y=p.deletions;if(y!==null)for(var w=0;w<y.length;w++){var R=y[w];try{var k=d,U=p,Z=U;e:for(;Z!==null;){switch(Z.tag){case 5:jn=Z.stateNode,qi=!1;break e;case 3:jn=Z.stateNode.containerInfo,qi=!0;break e;case 4:jn=Z.stateNode.containerInfo,qi=!0;break e}Z=Z.return}if(jn===null)throw Error(t(160));z1(k,U,R),jn=null,qi=!1;var Q=R.alternate;Q!==null&&(Q.return=null),R.return=null}catch(he){tn(R,p,he)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)V1(p,d),p=p.sibling}function V1(d,p){var y=d.alternate,w=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(Gi(p,d),Rs(d),w&4){try{uf(3,d,d.return),W0(3,d)}catch(Be){tn(d,d.return,Be)}try{uf(5,d,d.return)}catch(Be){tn(d,d.return,Be)}}break;case 1:Gi(p,d),Rs(d),w&512&&y!==null&&Ed(y,y.return);break;case 5:if(Gi(p,d),Rs(d),w&512&&y!==null&&Ed(y,y.return),d.flags&32){var R=d.stateNode;try{Ts(R,"")}catch(Be){tn(d,d.return,Be)}}if(w&4&&(R=d.stateNode,R!=null)){var k=d.memoizedProps,U=y!==null?y.memoizedProps:k,Z=d.type,Q=d.updateQueue;if(d.updateQueue=null,Q!==null)try{Z==="input"&&k.type==="radio"&&k.name!=null&&fe(R,k),Sa(Z,U);var he=Sa(Z,k);for(U=0;U<Q.length;U+=2){var Ae=Q[U],Ee=Q[U+1];Ae==="style"?Zl(R,Ee):Ae==="dangerouslySetInnerHTML"?lr(R,Ee):Ae==="children"?Ts(R,Ee):b(R,Ae,Ee,he)}switch(Z){case"input":xe(R,k);break;case"textarea":Cs(R,k);break;case"select":var Ce=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!k.multiple;var Me=k.value;Me!=null?gt(R,!!k.multiple,Me,!1):Ce!==!!k.multiple&&(k.defaultValue!=null?gt(R,!!k.multiple,k.defaultValue,!0):gt(R,!!k.multiple,k.multiple?[]:"",!1))}R[Xp]=k}catch(Be){tn(d,d.return,Be)}}break;case 6:if(Gi(p,d),Rs(d),w&4){if(d.stateNode===null)throw Error(t(162));R=d.stateNode,k=d.memoizedProps;try{R.nodeValue=k}catch(Be){tn(d,d.return,Be)}}break;case 3:if(Gi(p,d),Rs(d),w&4&&y!==null&&y.memoizedState.isDehydrated)try{zp(p.containerInfo)}catch(Be){tn(d,d.return,Be)}break;case 4:Gi(p,d),Rs(d);break;case 13:Gi(p,d),Rs(d),R=d.child,R.flags&8192&&(k=R.memoizedState!==null,R.stateNode.isHidden=k,!k||R.alternate!==null&&R.alternate.memoizedState!==null||(UE=un())),w&4&&W1(d);break;case 22:if(Ae=y!==null&&y.memoizedState!==null,d.mode&1?(Qn=(he=Qn)||Ae,Gi(p,d),Qn=he):Gi(p,d),Rs(d),w&8192){if(he=d.memoizedState!==null,(d.stateNode.isHidden=he)&&!Ae&&(d.mode&1)!==0)for(De=d,Ae=d.child;Ae!==null;){for(Ee=De=Ae;De!==null;){switch(Ce=De,Me=Ce.child,Ce.tag){case 0:case 11:case 14:case 15:uf(4,Ce,Ce.return);break;case 1:Ed(Ce,Ce.return);var Oe=Ce.stateNode;if(typeof Oe.componentWillUnmount=="function"){w=Ce,y=Ce.return;try{p=w,Oe.props=p.memoizedProps,Oe.state=p.memoizedState,Oe.componentWillUnmount()}catch(Be){tn(w,y,Be)}}break;case 5:Ed(Ce,Ce.return);break;case 22:if(Ce.memoizedState!==null){Z1(Ee);continue}}Me!==null?(Me.return=Ce,De=Me):Z1(Ee)}Ae=Ae.sibling}e:for(Ae=null,Ee=d;;){if(Ee.tag===5){if(Ae===null){Ae=Ee;try{R=Ee.stateNode,he?(k=R.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(Z=Ee.stateNode,Q=Ee.memoizedProps.style,U=Q!=null&&Q.hasOwnProperty("display")?Q.display:null,Z.style.display=Hl("display",U))}catch(Be){tn(d,d.return,Be)}}}else if(Ee.tag===6){if(Ae===null)try{Ee.stateNode.nodeValue=he?"":Ee.memoizedProps}catch(Be){tn(d,d.return,Be)}}else if((Ee.tag!==22&&Ee.tag!==23||Ee.memoizedState===null||Ee===d)&&Ee.child!==null){Ee.child.return=Ee,Ee=Ee.child;continue}if(Ee===d)break e;for(;Ee.sibling===null;){if(Ee.return===null||Ee.return===d)break e;Ae===Ee&&(Ae=null),Ee=Ee.return}Ae===Ee&&(Ae=null),Ee.sibling.return=Ee.return,Ee=Ee.sibling}}break;case 19:Gi(p,d),Rs(d),w&4&&W1(d);break;case 21:break;default:Gi(p,d),Rs(d)}}function Rs(d){var p=d.flags;if(p&2){try{e:{for(var y=d.return;y!==null;){if(j1(y)){var w=y;break e}y=y.return}throw Error(t(160))}switch(w.tag){case 5:var R=w.stateNode;w.flags&32&&(Ts(R,""),w.flags&=-33);var k=U1(d);BE(d,k,R);break;case 3:case 4:var U=w.stateNode.containerInfo,Z=U1(d);OE(d,Z,U);break;default:throw Error(t(161))}}catch(Q){tn(d,d.return,Q)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function N3(d,p,y){De=d,$1(d)}function $1(d,p,y){for(var w=(d.mode&1)!==0;De!==null;){var R=De,k=R.child;if(R.tag===22&&w){var U=R.memoizedState!==null||z0;if(!U){var Z=R.alternate,Q=Z!==null&&Z.memoizedState!==null||Qn;Z=z0;var he=Qn;if(z0=U,(Qn=Q)&&!he)for(De=R;De!==null;)U=De,Q=U.child,U.tag===22&&U.memoizedState!==null?q1(R):Q!==null?(Q.return=U,De=Q):q1(R);for(;k!==null;)De=k,$1(k),k=k.sibling;De=R,z0=Z,Qn=he}H1(d)}else(R.subtreeFlags&8772)!==0&&k!==null?(k.return=R,De=k):H1(d)}}function H1(d){for(;De!==null;){var p=De;if((p.flags&8772)!==0){var y=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Qn||W0(5,p);break;case 1:var w=p.stateNode;if(p.flags&4&&!Qn)if(y===null)w.componentDidMount();else{var R=p.elementType===p.type?y.memoizedProps:Zi(p.type,y.memoizedProps);w.componentDidUpdate(R,y.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var k=p.updateQueue;k!==null&&ZI(p,k,w);break;case 3:var U=p.updateQueue;if(U!==null){if(y=null,p.child!==null)switch(p.child.tag){case 5:y=p.child.stateNode;break;case 1:y=p.child.stateNode}ZI(p,U,y)}break;case 5:var Z=p.stateNode;if(y===null&&p.flags&4){y=Z;var Q=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":Q.autoFocus&&y.focus();break;case"img":Q.src&&(y.src=Q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var he=p.alternate;if(he!==null){var Ae=he.memoizedState;if(Ae!==null){var Ee=Ae.dehydrated;Ee!==null&&zp(Ee)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Qn||p.flags&512&&DE(p)}catch(Ce){tn(p,p.return,Ce)}}if(p===d){De=null;break}if(y=p.sibling,y!==null){y.return=p.return,De=y;break}De=p.return}}function Z1(d){for(;De!==null;){var p=De;if(p===d){De=null;break}var y=p.sibling;if(y!==null){y.return=p.return,De=y;break}De=p.return}}function q1(d){for(;De!==null;){var p=De;try{switch(p.tag){case 0:case 11:case 15:var y=p.return;try{W0(4,p)}catch(Q){tn(p,y,Q)}break;case 1:var w=p.stateNode;if(typeof w.componentDidMount=="function"){var R=p.return;try{w.componentDidMount()}catch(Q){tn(p,R,Q)}}var k=p.return;try{DE(p)}catch(Q){tn(p,k,Q)}break;case 5:var U=p.return;try{DE(p)}catch(Q){tn(p,U,Q)}}}catch(Q){tn(p,p.return,Q)}if(p===d){De=null;break}var Z=p.sibling;if(Z!==null){Z.return=p.return,De=Z;break}De=p.return}}var L3=Math.ceil,V0=I.ReactCurrentDispatcher,FE=I.ReactCurrentOwner,Ti=I.ReactCurrentBatchConfig,pt=0,In=null,fn=null,Un=0,Wr=0,xd=Ia(0),Cn=0,df=null,nc=0,$0=0,jE=0,hf=null,br=null,UE=0,wd=1/0,mo=null,H0=!1,zE=null,Da=null,Z0=!1,Oa=null,q0=0,pf=0,WE=null,G0=-1,K0=0;function ur(){return(pt&6)!==0?un():G0!==-1?G0:G0=un()}function Ba(d){return(d.mode&1)===0?1:(pt&2)!==0&&Un!==0?Un&-Un:v3.transition!==null?(K0===0&&(K0=UR()),K0):(d=At,d!==0||(d=window.event,d=d===void 0?16:KR(d.type)),d)}function Ki(d,p,y,w){if(50<pf)throw pf=0,WE=null,Error(t(185));Op(d,y,w),((pt&2)===0||d!==In)&&(d===In&&((pt&2)===0&&($0|=y),Cn===4&&Fa(d,Un)),Pr(d,w),y===1&&pt===0&&(p.mode&1)===0&&(wd=un()+500,E0&&ka()))}function Pr(d,p){var y=d.callbackNode;vz(d,p);var w=i0(d,d===In?Un:0);if(w===0)y!==null&&BR(y),d.callbackNode=null,d.callbackPriority=0;else if(p=w&-w,d.callbackPriority!==p){if(y!=null&&BR(y),p===1)d.tag===0?g3(K1.bind(null,d)):LI(K1.bind(null,d)),h3(function(){(pt&6)===0&&ka()}),y=null;else{switch(zR(w)){case 1:y=AT;break;case 4:y=FR;break;case 16:y=e0;break;case 536870912:y=jR;break;default:y=e0}y=r_(y,G1.bind(null,d))}d.callbackPriority=p,d.callbackNode=y}}function G1(d,p){if(G0=-1,K0=0,(pt&6)!==0)throw Error(t(327));var y=d.callbackNode;if(bd()&&d.callbackNode!==y)return null;var w=i0(d,d===In?Un:0);if(w===0)return null;if((w&30)!==0||(w&d.expiredLanes)!==0||p)p=Y0(d,w);else{p=w;var R=pt;pt|=2;var k=J1();(In!==d||Un!==p)&&(mo=null,wd=un()+500,ic(d,p));do try{B3();break}catch(Z){Y1(d,Z)}while(!0);oE(),V0.current=k,pt=R,fn!==null?p=0:(In=null,Un=0,p=Cn)}if(p!==0){if(p===2&&(R=TT(d),R!==0&&(w=R,p=VE(d,R))),p===1)throw y=df,ic(d,0),Fa(d,w),Pr(d,un()),y;if(p===6)Fa(d,w);else{if(R=d.current.alternate,(w&30)===0&&!D3(R)&&(p=Y0(d,w),p===2&&(k=TT(d),k!==0&&(w=k,p=VE(d,k))),p===1))throw y=df,ic(d,0),Fa(d,w),Pr(d,un()),y;switch(d.finishedWork=R,d.finishedLanes=w,p){case 0:case 1:throw Error(t(345));case 2:sc(d,br,mo);break;case 3:if(Fa(d,w),(w&130023424)===w&&(p=UE+500-un(),10<p)){if(i0(d,0)!==0)break;if(R=d.suspendedLanes,(R&w)!==w){ur(),d.pingedLanes|=d.suspendedLanes&R;break}d.timeoutHandle=KT(sc.bind(null,d,br,mo),p);break}sc(d,br,mo);break;case 4:if(Fa(d,w),(w&4194240)===w)break;for(p=d.eventTimes,R=-1;0<w;){var U=31-Vi(w);k=1<<U,U=p[U],U>R&&(R=U),w&=~k}if(w=R,w=un()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*L3(w/1960))-w,10<w){d.timeoutHandle=KT(sc.bind(null,d,br,mo),w);break}sc(d,br,mo);break;case 5:sc(d,br,mo);break;default:throw Error(t(329))}}}return Pr(d,un()),d.callbackNode===y?G1.bind(null,d):null}function VE(d,p){var y=hf;return d.current.memoizedState.isDehydrated&&(ic(d,p).flags|=256),d=Y0(d,p),d!==2&&(p=br,br=y,p!==null&&$E(p)),d}function $E(d){br===null?br=d:br.push.apply(br,d)}function D3(d){for(var p=d;;){if(p.flags&16384){var y=p.updateQueue;if(y!==null&&(y=y.stores,y!==null))for(var w=0;w<y.length;w++){var R=y[w],k=R.getSnapshot;R=R.value;try{if(!$i(k(),R))return!1}catch{return!1}}}if(y=p.child,p.subtreeFlags&16384&&y!==null)y.return=p,p=y;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Fa(d,p){for(p&=~jE,p&=~$0,d.suspendedLanes|=p,d.pingedLanes&=~p,d=d.expirationTimes;0<p;){var y=31-Vi(p),w=1<<y;d[y]=-1,p&=~w}}function K1(d){if((pt&6)!==0)throw Error(t(327));bd();var p=i0(d,0);if((p&1)===0)return Pr(d,un()),null;var y=Y0(d,p);if(d.tag!==0&&y===2){var w=TT(d);w!==0&&(p=w,y=VE(d,w))}if(y===1)throw y=df,ic(d,0),Fa(d,p),Pr(d,un()),y;if(y===6)throw Error(t(345));return d.finishedWork=d.current.alternate,d.finishedLanes=p,sc(d,br,mo),Pr(d,un()),null}function HE(d,p){var y=pt;pt|=1;try{return d(p)}finally{pt=y,pt===0&&(wd=un()+500,E0&&ka())}}function rc(d){Oa!==null&&Oa.tag===0&&(pt&6)===0&&bd();var p=pt;pt|=1;var y=Ti.transition,w=At;try{if(Ti.transition=null,At=1,d)return d()}finally{At=w,Ti.transition=y,pt=p,(pt&6)===0&&ka()}}function ZE(){Wr=xd.current,Wt(xd)}function ic(d,p){d.finishedWork=null,d.finishedLanes=0;var y=d.timeoutHandle;if(y!==-1&&(d.timeoutHandle=-1,d3(y)),fn!==null)for(y=fn.return;y!==null;){var w=y;switch(tE(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&A0();break;case 3:Ad(),Wt(Er),Wt(Yn),fE();break;case 5:hE(w);break;case 4:Ad();break;case 13:Wt(Gt);break;case 19:Wt(Gt);break;case 10:aE(w.type._context);break;case 22:case 23:ZE()}y=y.return}if(In=d,fn=d=ja(d.current,null),Un=Wr=p,Cn=0,df=null,jE=$0=nc=0,br=hf=null,Ql!==null){for(p=0;p<Ql.length;p++)if(y=Ql[p],w=y.interleaved,w!==null){y.interleaved=null;var R=w.next,k=y.pending;if(k!==null){var U=k.next;k.next=R,w.next=U}y.pending=w}Ql=null}return d}function Y1(d,p){do{var y=fn;try{if(oE(),N0.current=B0,L0){for(var w=Kt.memoizedState;w!==null;){var R=w.queue;R!==null&&(R.pending=null),w=w.next}L0=!1}if(tc=0,Rn=Sn=Kt=null,sf=!1,of=0,FE.current=null,y===null||y.return===null){Cn=1,df=p,fn=null;break}e:{var k=d,U=y.return,Z=y,Q=p;if(p=Un,Z.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var he=Q,Ae=Z,Ee=Ae.tag;if((Ae.mode&1)===0&&(Ee===0||Ee===11||Ee===15)){var Ce=Ae.alternate;Ce?(Ae.updateQueue=Ce.updateQueue,Ae.memoizedState=Ce.memoizedState,Ae.lanes=Ce.lanes):(Ae.updateQueue=null,Ae.memoizedState=null)}var Me=A1(U);if(Me!==null){Me.flags&=-257,T1(Me,U,Z,k,p),Me.mode&1&&C1(k,he,p),p=Me,Q=he;var Oe=p.updateQueue;if(Oe===null){var Be=new Set;Be.add(Q),p.updateQueue=Be}else Oe.add(Q);break e}else{if((p&1)===0){C1(k,he,p),qE();break e}Q=Error(t(426))}}else if($t&&Z.mode&1){var dn=A1(U);if(dn!==null){(dn.flags&65536)===0&&(dn.flags|=256),T1(dn,U,Z,k,p),iE(Td(Q,Z));break e}}k=Q=Td(Q,Z),Cn!==4&&(Cn=2),hf===null?hf=[k]:hf.push(k),k=U;do{switch(k.tag){case 3:k.flags|=65536,p&=-p,k.lanes|=p;var oe=y1(k,Q,p);HI(k,oe);break e;case 1:Z=Q;var te=k.type,ue=k.stateNode;if((k.flags&128)===0&&(typeof te.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(Da===null||!Da.has(ue)))){k.flags|=65536,p&=-p,k.lanes|=p;var we=S1(k,Z,p);HI(k,we);break e}}k=k.return}while(k!==null)}Q1(y)}catch(je){p=je,fn===y&&y!==null&&(fn=y=y.return);continue}break}while(!0)}function J1(){var d=V0.current;return V0.current=B0,d===null?B0:d}function qE(){(Cn===0||Cn===3||Cn===2)&&(Cn=4),In===null||(nc&268435455)===0&&($0&268435455)===0||Fa(In,Un)}function Y0(d,p){var y=pt;pt|=2;var w=J1();(In!==d||Un!==p)&&(mo=null,ic(d,p));do try{O3();break}catch(R){Y1(d,R)}while(!0);if(oE(),pt=y,V0.current=w,fn!==null)throw Error(t(261));return In=null,Un=0,Cn}function O3(){for(;fn!==null;)X1(fn)}function B3(){for(;fn!==null&&!lz();)X1(fn)}function X1(d){var p=n_(d.alternate,d,Wr);d.memoizedProps=d.pendingProps,p===null?Q1(d):fn=p,FE.current=null}function Q1(d){var p=d;do{var y=p.alternate;if(d=p.return,(p.flags&32768)===0){if(y=I3(y,p,Wr),y!==null){fn=y;return}}else{if(y=_3(y,p),y!==null){y.flags&=32767,fn=y;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{Cn=6,fn=null;return}}if(p=p.sibling,p!==null){fn=p;return}fn=p=d}while(p!==null);Cn===0&&(Cn=5)}function sc(d,p,y){var w=At,R=Ti.transition;try{Ti.transition=null,At=1,F3(d,p,y,w)}finally{Ti.transition=R,At=w}return null}function F3(d,p,y,w){do bd();while(Oa!==null);if((pt&6)!==0)throw Error(t(327));y=d.finishedWork;var R=d.finishedLanes;if(y===null)return null;if(d.finishedWork=null,d.finishedLanes=0,y===d.current)throw Error(t(177));d.callbackNode=null,d.callbackPriority=0;var k=y.lanes|y.childLanes;if(yz(d,k),d===In&&(fn=In=null,Un=0),(y.subtreeFlags&2064)===0&&(y.flags&2064)===0||Z0||(Z0=!0,r_(e0,function(){return bd(),null})),k=(y.flags&15990)!==0,(y.subtreeFlags&15990)!==0||k){k=Ti.transition,Ti.transition=null;var U=At;At=1;var Z=pt;pt|=4,FE.current=null,M3(d,y),V1(y,d),i3(qT),a0=!!ZT,qT=ZT=null,d.current=y,N3(y),cz(),pt=Z,At=U,Ti.transition=k}else d.current=y;if(Z0&&(Z0=!1,Oa=d,q0=R),k=d.pendingLanes,k===0&&(Da=null),hz(y.stateNode),Pr(d,un()),p!==null)for(w=d.onRecoverableError,y=0;y<p.length;y++)R=p[y],w(R.value,{componentStack:R.stack,digest:R.digest});if(H0)throw H0=!1,d=zE,zE=null,d;return(q0&1)!==0&&d.tag!==0&&bd(),k=d.pendingLanes,(k&1)!==0?d===WE?pf++:(pf=0,WE=d):pf=0,ka(),null}function bd(){if(Oa!==null){var d=zR(q0),p=Ti.transition,y=At;try{if(Ti.transition=null,At=16>d?16:d,Oa===null)var w=!1;else{if(d=Oa,Oa=null,q0=0,(pt&6)!==0)throw Error(t(331));var R=pt;for(pt|=4,De=d.current;De!==null;){var k=De,U=k.child;if((De.flags&16)!==0){var Z=k.deletions;if(Z!==null){for(var Q=0;Q<Z.length;Q++){var he=Z[Q];for(De=he;De!==null;){var Ae=De;switch(Ae.tag){case 0:case 11:case 15:uf(8,Ae,k)}var Ee=Ae.child;if(Ee!==null)Ee.return=Ae,De=Ee;else for(;De!==null;){Ae=De;var Ce=Ae.sibling,Me=Ae.return;if(F1(Ae),Ae===he){De=null;break}if(Ce!==null){Ce.return=Me,De=Ce;break}De=Me}}}var Oe=k.alternate;if(Oe!==null){var Be=Oe.child;if(Be!==null){Oe.child=null;do{var dn=Be.sibling;Be.sibling=null,Be=dn}while(Be!==null)}}De=k}}if((k.subtreeFlags&2064)!==0&&U!==null)U.return=k,De=U;else e:for(;De!==null;){if(k=De,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:uf(9,k,k.return)}var oe=k.sibling;if(oe!==null){oe.return=k.return,De=oe;break e}De=k.return}}var te=d.current;for(De=te;De!==null;){U=De;var ue=U.child;if((U.subtreeFlags&2064)!==0&&ue!==null)ue.return=U,De=ue;else e:for(U=te;De!==null;){if(Z=De,(Z.flags&2048)!==0)try{switch(Z.tag){case 0:case 11:case 15:W0(9,Z)}}catch(je){tn(Z,Z.return,je)}if(Z===U){De=null;break e}var we=Z.sibling;if(we!==null){we.return=Z.return,De=we;break e}De=Z.return}}if(pt=R,ka(),xs&&typeof xs.onPostCommitFiberRoot=="function")try{xs.onPostCommitFiberRoot(t0,d)}catch{}w=!0}return w}finally{At=y,Ti.transition=p}}return!1}function e_(d,p,y){p=Td(y,p),p=y1(d,p,1),d=Na(d,p,1),p=ur(),d!==null&&(Op(d,1,p),Pr(d,p))}function tn(d,p,y){if(d.tag===3)e_(d,d,y);else for(;p!==null;){if(p.tag===3){e_(p,d,y);break}else if(p.tag===1){var w=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Da===null||!Da.has(w))){d=Td(y,d),d=S1(p,d,1),p=Na(p,d,1),d=ur(),p!==null&&(Op(p,1,d),Pr(p,d));break}}p=p.return}}function j3(d,p,y){var w=d.pingCache;w!==null&&w.delete(p),p=ur(),d.pingedLanes|=d.suspendedLanes&y,In===d&&(Un&y)===y&&(Cn===4||Cn===3&&(Un&130023424)===Un&&500>un()-UE?ic(d,0):jE|=y),Pr(d,p)}function t_(d,p){p===0&&((d.mode&1)===0?p=1:(p=r0,r0<<=1,(r0&130023424)===0&&(r0=4194304)));var y=ur();d=ho(d,p),d!==null&&(Op(d,p,y),Pr(d,y))}function U3(d){var p=d.memoizedState,y=0;p!==null&&(y=p.retryLane),t_(d,y)}function z3(d,p){var y=0;switch(d.tag){case 13:var w=d.stateNode,R=d.memoizedState;R!==null&&(y=R.retryLane);break;case 19:w=d.stateNode;break;default:throw Error(t(314))}w!==null&&w.delete(p),t_(d,y)}var n_;n_=function(d,p,y){if(d!==null)if(d.memoizedProps!==p.pendingProps||Er.current)wr=!0;else{if((d.lanes&y)===0&&(p.flags&128)===0)return wr=!1,R3(d,p,y);wr=(d.flags&131072)!==0}else wr=!1,$t&&(p.flags&1048576)!==0&&DI(p,w0,p.index);switch(p.lanes=0,p.tag){case 2:var w=p.type;U0(d,p),d=p.pendingProps;var R=fd(p,Yn.current);Cd(p,y),R=vE(null,p,w,d,R,y);var k=yE();return p.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,xr(w)?(k=!0,T0(p)):k=!1,p.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,uE(p),R.updater=F0,p.stateNode=R,R._reactInternals=p,xE(p,w,d,y),p=RE(null,p,w,!0,k,y)):(p.tag=0,$t&&k&&eE(p),cr(null,p,R,y),p=p.child),p;case 16:w=p.elementType;e:{switch(U0(d,p),d=p.pendingProps,R=w._init,w=R(w._payload),p.type=w,R=p.tag=V3(w),d=Zi(w,d),R){case 0:p=PE(null,p,w,d,y);break e;case 1:p=R1(null,p,w,d,y);break e;case 11:p=E1(null,p,w,d,y);break e;case 14:p=x1(null,p,w,Zi(w.type,d),y);break e}throw Error(t(306,w,""))}return p;case 0:return w=p.type,R=p.pendingProps,R=p.elementType===w?R:Zi(w,R),PE(d,p,w,R,y);case 1:return w=p.type,R=p.pendingProps,R=p.elementType===w?R:Zi(w,R),R1(d,p,w,R,y);case 3:e:{if(I1(p),d===null)throw Error(t(387));w=p.pendingProps,k=p.memoizedState,R=k.element,$I(d,p),k0(p,w,null,y);var U=p.memoizedState;if(w=U.element,k.isDehydrated)if(k={element:w,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},p.updateQueue.baseState=k,p.memoizedState=k,p.flags&256){R=Td(Error(t(423)),p),p=_1(d,p,w,y,R);break e}else if(w!==R){R=Td(Error(t(424)),p),p=_1(d,p,w,y,R);break e}else for(zr=Ra(p.stateNode.containerInfo.firstChild),Ur=p,$t=!0,Hi=null,y=WI(p,null,w,y),p.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling;else{if(vd(),w===R){p=fo(d,p,y);break e}cr(d,p,w,y)}p=p.child}return p;case 5:return qI(p),d===null&&rE(p),w=p.type,R=p.pendingProps,k=d!==null?d.memoizedProps:null,U=R.children,GT(w,R)?U=null:k!==null&&GT(w,k)&&(p.flags|=32),P1(d,p),cr(d,p,U,y),p.child;case 6:return d===null&&rE(p),null;case 13:return k1(d,p,y);case 4:return dE(p,p.stateNode.containerInfo),w=p.pendingProps,d===null?p.child=yd(p,null,w,y):cr(d,p,w,y),p.child;case 11:return w=p.type,R=p.pendingProps,R=p.elementType===w?R:Zi(w,R),E1(d,p,w,R,y);case 7:return cr(d,p,p.pendingProps,y),p.child;case 8:return cr(d,p,p.pendingProps.children,y),p.child;case 12:return cr(d,p,p.pendingProps.children,y),p.child;case 10:e:{if(w=p.type._context,R=p.pendingProps,k=p.memoizedProps,U=R.value,Ot(R0,w._currentValue),w._currentValue=U,k!==null)if($i(k.value,U)){if(k.children===R.children&&!Er.current){p=fo(d,p,y);break e}}else for(k=p.child,k!==null&&(k.return=p);k!==null;){var Z=k.dependencies;if(Z!==null){U=k.child;for(var Q=Z.firstContext;Q!==null;){if(Q.context===w){if(k.tag===1){Q=po(-1,y&-y),Q.tag=2;var he=k.updateQueue;if(he!==null){he=he.shared;var Ae=he.pending;Ae===null?Q.next=Q:(Q.next=Ae.next,Ae.next=Q),he.pending=Q}}k.lanes|=y,Q=k.alternate,Q!==null&&(Q.lanes|=y),lE(k.return,y,p),Z.lanes|=y;break}Q=Q.next}}else if(k.tag===10)U=k.type===p.type?null:k.child;else if(k.tag===18){if(U=k.return,U===null)throw Error(t(341));U.lanes|=y,Z=U.alternate,Z!==null&&(Z.lanes|=y),lE(U,y,p),U=k.sibling}else U=k.child;if(U!==null)U.return=k;else for(U=k;U!==null;){if(U===p){U=null;break}if(k=U.sibling,k!==null){k.return=U.return,U=k;break}U=U.return}k=U}cr(d,p,R.children,y),p=p.child}return p;case 9:return R=p.type,w=p.pendingProps.children,Cd(p,y),R=Ci(R),w=w(R),p.flags|=1,cr(d,p,w,y),p.child;case 14:return w=p.type,R=Zi(w,p.pendingProps),R=Zi(w.type,R),x1(d,p,w,R,y);case 15:return w1(d,p,p.type,p.pendingProps,y);case 17:return w=p.type,R=p.pendingProps,R=p.elementType===w?R:Zi(w,R),U0(d,p),p.tag=1,xr(w)?(d=!0,T0(p)):d=!1,Cd(p,y),g1(p,w,R),xE(p,w,R,y),RE(null,p,w,!0,d,y);case 19:return N1(d,p,y);case 22:return b1(d,p,y)}throw Error(t(156,p.tag))};function r_(d,p){return OR(d,p)}function W3(d,p,y,w){this.tag=d,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ei(d,p,y,w){return new W3(d,p,y,w)}function GE(d){return d=d.prototype,!(!d||!d.isReactComponent)}function V3(d){if(typeof d=="function")return GE(d)?1:0;if(d!=null){if(d=d.$$typeof,d===H)return 11;if(d===ee)return 14}return 2}function ja(d,p){var y=d.alternate;return y===null?(y=Ei(d.tag,p,d.key,d.mode),y.elementType=d.elementType,y.type=d.type,y.stateNode=d.stateNode,y.alternate=d,d.alternate=y):(y.pendingProps=p,y.type=d.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=d.flags&14680064,y.childLanes=d.childLanes,y.lanes=d.lanes,y.child=d.child,y.memoizedProps=d.memoizedProps,y.memoizedState=d.memoizedState,y.updateQueue=d.updateQueue,p=d.dependencies,y.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},y.sibling=d.sibling,y.index=d.index,y.ref=d.ref,y}function J0(d,p,y,w,R,k){var U=2;if(w=d,typeof d=="function")GE(d)&&(U=1);else if(typeof d=="string")U=5;else e:switch(d){case D:return oc(y.children,R,k,p);case j:U=8,R|=8;break;case F:return d=Ei(12,y,p,R|2),d.elementType=F,d.lanes=k,d;case V:return d=Ei(13,y,p,R),d.elementType=V,d.lanes=k,d;case K:return d=Ei(19,y,p,R),d.elementType=K,d.lanes=k,d;case X:return X0(y,R,k,p);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case z:U=10;break e;case W:U=9;break e;case H:U=11;break e;case ee:U=14;break e;case G:U=16,w=null;break e}throw Error(t(130,d==null?d:typeof d,""))}return p=Ei(U,y,p,R),p.elementType=d,p.type=w,p.lanes=k,p}function oc(d,p,y,w){return d=Ei(7,d,w,p),d.lanes=y,d}function X0(d,p,y,w){return d=Ei(22,d,w,p),d.elementType=X,d.lanes=y,d.stateNode={isHidden:!1},d}function KE(d,p,y){return d=Ei(6,d,null,p),d.lanes=y,d}function YE(d,p,y){return p=Ei(4,d.children!==null?d.children:[],d.key,p),p.lanes=y,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}function $3(d,p,y,w,R){this.tag=p,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ET(0),this.expirationTimes=ET(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ET(0),this.identifierPrefix=w,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function JE(d,p,y,w,R,k,U,Z,Q){return d=new $3(d,p,y,Z,Q),p===1?(p=1,k===!0&&(p|=8)):p=0,k=Ei(3,null,null,p),d.current=k,k.stateNode=d,k.memoizedState={element:w,isDehydrated:y,cache:null,transitions:null,pendingSuspenseBoundaries:null},uE(k),d}function H3(d,p,y){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:N,key:w==null?null:""+w,children:d,containerInfo:p,implementation:y}}function i_(d){if(!d)return _a;d=d._reactInternals;e:{if(Gl(d)!==d||d.tag!==1)throw Error(t(170));var p=d;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(xr(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(t(171))}if(d.tag===1){var y=d.type;if(xr(y))return MI(d,y,p)}return p}function s_(d,p,y,w,R,k,U,Z,Q){return d=JE(y,w,!0,d,R,k,U,Z,Q),d.context=i_(null),y=d.current,w=ur(),R=Ba(y),k=po(w,R),k.callback=p??null,Na(y,k,R),d.current.lanes=R,Op(d,R,w),Pr(d,w),d}function Q0(d,p,y,w){var R=p.current,k=ur(),U=Ba(R);return y=i_(y),p.context===null?p.context=y:p.pendingContext=y,p=po(k,U),p.payload={element:d},w=w===void 0?null:w,w!==null&&(p.callback=w),d=Na(R,p,U),d!==null&&(Ki(d,R,U,k),_0(d,R,U)),U}function eC(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function o_(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var y=d.retryLane;d.retryLane=y!==0&&y<p?y:p}}function XE(d,p){o_(d,p),(d=d.alternate)&&o_(d,p)}function Z3(){return null}var a_=typeof reportError=="function"?reportError:function(d){console.error(d)};function QE(d){this._internalRoot=d}tC.prototype.render=QE.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(t(409));Q0(d,p,null,null)},tC.prototype.unmount=QE.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;rc(function(){Q0(null,d,null,null)}),p[ao]=null}};function tC(d){this._internalRoot=d}tC.prototype.unstable_scheduleHydration=function(d){if(d){var p=$R();d={blockedOn:null,target:d,priority:p};for(var y=0;y<wa.length&&p!==0&&p<wa[y].priority;y++);wa.splice(y,0,d),y===0&&qR(d)}};function ex(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function nC(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function l_(){}function q3(d,p,y,w,R){if(R){if(typeof w=="function"){var k=w;w=function(){var he=eC(U);k.call(he)}}var U=s_(p,w,d,0,null,!1,!1,"",l_);return d._reactRootContainer=U,d[ao]=U.current,Yp(d.nodeType===8?d.parentNode:d),rc(),U}for(;R=d.lastChild;)d.removeChild(R);if(typeof w=="function"){var Z=w;w=function(){var he=eC(Q);Z.call(he)}}var Q=JE(d,0,!1,null,null,!1,!1,"",l_);return d._reactRootContainer=Q,d[ao]=Q.current,Yp(d.nodeType===8?d.parentNode:d),rc(function(){Q0(p,Q,y,w)}),Q}function rC(d,p,y,w,R){var k=y._reactRootContainer;if(k){var U=k;if(typeof R=="function"){var Z=R;R=function(){var Q=eC(U);Z.call(Q)}}Q0(p,U,d,R)}else U=q3(y,p,d,R,w);return eC(U)}WR=function(d){switch(d.tag){case 3:var p=d.stateNode;if(p.current.memoizedState.isDehydrated){var y=Dp(p.pendingLanes);y!==0&&(xT(p,y|1),Pr(p,un()),(pt&6)===0&&(wd=un()+500,ka()))}break;case 13:rc(function(){var w=ho(d,1);if(w!==null){var R=ur();Ki(w,d,1,R)}}),XE(d,1)}},wT=function(d){if(d.tag===13){var p=ho(d,134217728);if(p!==null){var y=ur();Ki(p,d,134217728,y)}XE(d,134217728)}},VR=function(d){if(d.tag===13){var p=Ba(d),y=ho(d,p);if(y!==null){var w=ur();Ki(y,d,p,w)}XE(d,p)}},$R=function(){return At},HR=function(d,p){var y=At;try{return At=d,p()}finally{At=y}},kp=function(d,p,y){switch(p){case"input":if(xe(d,y),p=y.name,y.type==="radio"&&p!=null){for(y=d;y.parentNode;)y=y.parentNode;for(y=y.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<y.length;p++){var w=y[p];if(w!==d&&w.form===d.form){var R=C0(w);if(!R)throw Error(t(90));ne(w),xe(w,R)}}}break;case"textarea":Cs(d,y);break;case"select":p=y.value,p!=null&&gt(d,!!y.multiple,p,!1)}},IR=HE,_R=rc;var G3={usingClientEntryPoint:!1,Events:[Qp,hd,C0,JS,RR,HE]},ff={findFiberByHostInstance:Kl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},K3={bundleType:ff.bundleType,version:ff.version,rendererPackageName:ff.rendererPackageName,rendererConfig:ff.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=LR(d),d===null?null:d.stateNode},findFiberByHostInstance:ff.findFiberByHostInstance||Z3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iC.isDisabled&&iC.supportsFiber)try{t0=iC.inject(K3),xs=iC}catch{}}return Rr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G3,Rr.createPortal=function(d,p){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ex(p))throw Error(t(200));return H3(d,p,null,y)},Rr.createRoot=function(d,p){if(!ex(d))throw Error(t(299));var y=!1,w="",R=a_;return p!=null&&(p.unstable_strictMode===!0&&(y=!0),p.identifierPrefix!==void 0&&(w=p.identifierPrefix),p.onRecoverableError!==void 0&&(R=p.onRecoverableError)),p=JE(d,1,!1,null,null,y,!1,w,R),d[ao]=p.current,Yp(d.nodeType===8?d.parentNode:d),new QE(p)},Rr.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var p=d._reactInternals;if(p===void 0)throw typeof d.render=="function"?Error(t(188)):(d=Object.keys(d).join(","),Error(t(268,d)));return d=LR(p),d=d===null?null:d.stateNode,d},Rr.flushSync=function(d){return rc(d)},Rr.hydrate=function(d,p,y){if(!nC(p))throw Error(t(200));return rC(null,d,p,!0,y)},Rr.hydrateRoot=function(d,p,y){if(!ex(d))throw Error(t(405));var w=y!=null&&y.hydratedSources||null,R=!1,k="",U=a_;if(y!=null&&(y.unstable_strictMode===!0&&(R=!0),y.identifierPrefix!==void 0&&(k=y.identifierPrefix),y.onRecoverableError!==void 0&&(U=y.onRecoverableError)),p=s_(p,null,d,1,y??null,R,!1,k,U),d[ao]=p.current,Yp(d),w)for(d=0;d<w.length;d++)y=w[d],R=y._getVersion,R=R(y._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[y,R]:p.mutableSourceEagerHydrationData.push(y,R);return new tC(p)},Rr.render=function(d,p,y){if(!nC(p))throw Error(t(200));return rC(null,d,p,!1,y)},Rr.unmountComponentAtNode=function(d){if(!nC(d))throw Error(t(40));return d._reactRootContainer?(rc(function(){rC(null,null,d,!1,function(){d._reactRootContainer=null,d[ao]=null})}),!0):!1},Rr.unstable_batchedUpdates=HE,Rr.unstable_renderSubtreeIntoContainer=function(d,p,y,w){if(!nC(y))throw Error(t(200));if(d==null||d._reactInternals===void 0)throw Error(t(38));return rC(d,p,y,!1,w)},Rr.version="18.3.1-next-f1338f8080-20240426",Rr}var v_;function o5(){if(v_)return ix.exports;v_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ix.exports=s5(),ix.exports}var y_;function a5(){if(y_)return sC;y_=1;var n=o5();return sC.createRoot=n.createRoot,sC.hydrateRoot=n.hydrateRoot,sC}var l5=a5();const c5=uB(l5),S_="azure-tts-settings",VP="azure-tts-api-keys",hB="azure-voice-live-settings",oC={apiKey:"",region:"eastus",selectedVoice:"en-US-JennyNeural",voiceLiveEndpoint:"",voiceLiveApiKey:""};function u5(){try{const n=localStorage.getItem(hB);if(n)return JSON.parse(n)}catch(n){console.error("Failed to load Voice Live settings from localStorage:",n)}return{endpoint:"",apiKey:""}}function d5(n,e){try{localStorage.setItem(hB,JSON.stringify({endpoint:n,apiKey:e}))}catch(t){console.error("Failed to save Voice Live settings to localStorage:",t)}}function gf(){try{const n=localStorage.getItem(VP);if(n)return JSON.parse(n)}catch(n){console.error("Failed to load API keys from localStorage:",n)}return{}}function C_(n){try{localStorage.setItem(VP,JSON.stringify(n))}catch(e){console.error("Failed to save API keys to localStorage:",e)}}function h5(){const[n,e]=O.useState(()=>{try{const o=localStorage.getItem(S_),a=gf(),l=u5();console.log("=== LOADING SETTINGS ===");const c={};if(Object.keys(a).forEach(u=>{const h=a[u];c[u]=h.length>8?`${h.substring(0,4)}...${h.substring(h.length-4)}`:"****"}),console.log("Stored API keys by region:",c),o){const u=JSON.parse(o),h=u.region||oC.region,m=a[h]||u.apiKey||"",v=m.length>8?`${m.substring(0,4)}...${m.substring(m.length-4)}`:"****";return console.log("Loading settings for region:",h),console.log("Loaded API key:",v),console.log("========================"),{...oC,...u,apiKey:m,voiceLiveEndpoint:l.endpoint,voiceLiveApiKey:l.apiKey}}return{...oC,voiceLiveEndpoint:l.endpoint,voiceLiveApiKey:l.apiKey}}catch(o){console.error("Failed to load settings from localStorage:",o)}return oC});O.useEffect(()=>{try{const o=n.apiKey.length>8?`${n.apiKey.substring(0,4)}...${n.apiKey.substring(n.apiKey.length-4)}`:"****";console.log("=== SAVING SETTINGS (useEffect) ==="),console.log("Region:",n.region),console.log("API Key being saved:",o),console.log("This key will be saved FOR region:",n.region),console.log("===================================");const{apiKey:a,voiceLiveEndpoint:l,voiceLiveApiKey:c,...u}=n;if(localStorage.setItem(S_,JSON.stringify(u)),a){const h=gf();h[n.region]=a,C_(h),console.log(` API key ${o} saved for region: ${n.region}`)}(l||c)&&d5(l||"",c||"")}catch(o){console.error("Failed to save settings to localStorage:",o)}},[n]);const t=o=>{console.log("=== UPDATE SETTINGS CALLED ==="),console.trace("Called from:"),e(a=>{const l=a.apiKey.length>8?`${a.apiKey.substring(0,4)}...${a.apiKey.substring(a.apiKey.length-4)}`:"****";console.log("Previous settings:",{region:a.region,apiKey:l});const c={...o};if(o.apiKey){const h=o.apiKey;c.apiKey=h.length>8?`${h.substring(0,4)}...${h.substring(h.length-4)}`:"****"}console.log("Partial update:",c);const u={...a,...o};if(o.region&&o.region!==a.region&&!o.apiKey){const m=gf()[o.region]||"";u.apiKey=m;const v=a.apiKey.length>8?`${a.apiKey.substring(0,4)}...${a.apiKey.substring(a.apiKey.length-4)}`:"****",C=m.length>8?`${m.substring(0,4)}...${m.substring(m.length-4)}`:"****";console.log(` Region changed from "${a.region}" to "${o.region}"`),console.log(` Loading saved API key for "${o.region}": ${v}  ${C}`),m||console.warn(` No API key found for region "${o.region}" - you'll need to enter one`)}return console.log("New settings:",{region:u.region,apiKey:u.apiKey.length>8?`${u.apiKey.substring(0,4)}...${u.apiKey.substring(u.apiKey.length-4)}`:"****"}),console.log("=============================="),u})},r=n.apiKey.length>0&&n.region.length>0,i=o=>{const a=gf();delete a[o],C_(a),console.log(` Cleared API key for region: ${o}`),console.log("Remaining keys:",a)},s=()=>{localStorage.removeItem(VP),console.log(" Cleared all API keys from localStorage")};return typeof window<"u"&&(window.debugSettings={clearRegionKey:i,clearAllKeys:s,viewKeys:()=>{console.log("Current API keys in localStorage:",gf())}}),{settings:n,updateSettings:t,isConfigured:r}}function p5(){const[n,e]=O.useState([]),t=O.useCallback(s=>{const o={...s,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(a=>[...a,o])},[]),r=O.useCallback(s=>{e(o=>o.filter(a=>a.id!==s))},[]),i=O.useCallback(()=>{e([])},[]);return{history:n,addToHistory:t,removeFromHistory:r,clearHistory:i}}function f5(){const[n,e]=O.useState([]),t=O.useCallback(s=>{const o={...s,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(a=>[...a,o])},[]),r=O.useCallback(s=>{e(o=>o.filter(a=>a.id!==s))},[]),i=O.useCallback(()=>{e([])},[]);return{history:n,addToHistory:t,removeFromHistory:r,clearHistory:i}}function m5(){const[n,e]=O.useState([]),t=O.useCallback(s=>{const o={...s,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(a=>[...a,o])},[]),r=O.useCallback(s=>{e(o=>o.filter(a=>a.id!==s))},[]),i=O.useCallback(()=>{e([])},[]);return{history:n,addToHistory:t,removeFromHistory:r,clearHistory:i}}function g5(){const[n,e]=O.useState([]),t=O.useCallback(s=>{const o={...s,id:`stt-${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(a=>[o,...a])},[]),r=O.useCallback(s=>{e(o=>o.filter(a=>a.id!==s))},[]),i=O.useCallback(()=>{e([])},[]);return{history:n,addToHistory:t,removeFromHistory:r,clearHistory:i}}const pB="podcast.history",v5=50;function y5(){try{const n=localStorage.getItem(pB);if(n)return JSON.parse(n)}catch(n){console.error("Failed to load podcast history:",n)}return[]}function aC(n){try{localStorage.setItem(pB,JSON.stringify(n))}catch(e){console.error("Failed to save podcast history:",e)}}function S5(){const[n,e]=O.useState(y5),t=O.useCallback(s=>{const o={...s,id:crypto.randomUUID()};e(a=>{const l=[o,...a].slice(0,v5);return aC(l),l})},[]),r=O.useCallback(s=>{e(o=>{const a=o.filter(l=>l.id!==s);return aC(a),a})},[]),i=O.useCallback(()=>{e([]),aC([])},[]);return O.useEffect(()=>{aC(n)},[n]),{history:n,addToHistory:t,removeFromHistory:r,clearHistory:i}}const C5="2026-01-28T06:31:21.416Z",A_="07e0662",A5=[{value:"brazilsouth",label:"Brazil South"},{value:"canadacentral",label:"Canada Central"},{value:"canadaeast",label:"Canada East"},{value:"centralus",label:"Central US"},{value:"eastus",label:"East US"},{value:"eastus2",label:"East US 2"},{value:"northcentralus",label:"North Central US"},{value:"southcentralus",label:"South Central US"},{value:"westcentralus",label:"West Central US"},{value:"westus",label:"West US"},{value:"westus2",label:"West US 2"},{value:"westus3",label:"West US 3"},{value:"francecentral",label:"France Central"},{value:"germanywestcentral",label:"Germany West Central"},{value:"italynorth",label:"Italy North"},{value:"northeurope",label:"North Europe"},{value:"norwayeast",label:"Norway East"},{value:"swedencentral",label:"Sweden Central"},{value:"switzerlandnorth",label:"Switzerland North"},{value:"switzerlandwest",label:"Switzerland West"},{value:"uksouth",label:"UK South"},{value:"ukwest",label:"UK West"},{value:"westeurope",label:"West Europe"},{value:"australiaeast",label:"Australia East"},{value:"centralindia",label:"Central India"},{value:"eastasia",label:"East Asia"},{value:"japaneast",label:"Japan East"},{value:"japanwest",label:"Japan West"},{value:"koreacentral",label:"Korea Central"},{value:"southeastasia",label:"Southeast Asia"},{value:"qatarcentral",label:"Qatar Central"},{value:"southafricanorth",label:"South Africa North"},{value:"uaenorth",label:"UAE North"}],T_=[{mode:"voice-creation",label:"Voice Creation",category:"content",icon:g.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})},{mode:"text-to-speech",label:"Text to Speech",category:"content",icon:g.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})},{mode:"multi-talker",label:"Multi Talker",category:"content",icon:g.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})},{mode:"voice-changer",label:"Voice Changer",category:"content",icon:g.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},{mode:"speech-to-text",label:"Speech to Text",category:"content",icon:g.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})})},{mode:"video-translation",label:"Video Translation",category:"content",icon:g.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})},{mode:"podcast-agent",label:"Podcast Agent",category:"content",icon:g.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})},{mode:"voice-live-chat",label:"Voice Live Chat",category:"agent",icon:g.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})},{mode:"voice-live-translator",label:"Voice Live Translator",category:"agent",icon:g.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})})},{mode:"gemini-live",label:"Gemini Live",category:"agent",icon:g.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}];function T5({activeMode:n,onModeChange:e,settings:t,onSettingsChange:r,geminiLiveEnabled:i=!1}){const[s,o]=O.useState(!1),[a,l]=O.useState(!1),c=n==="voice-live-chat"||n==="voice-live-translator"||n==="gemini-live";return g.jsxs("div",{className:`h-full bg-gray-900 text-white flex flex-col flex-shrink-0 transition-all duration-300 ${s?"w-16":"w-64"}`,children:[g.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[!s&&g.jsxs("div",{children:[g.jsx("h1",{className:"text-lg font-bold text-white",children:"Azure Voice"}),g.jsx("p",{className:"text-xs text-gray-400",children:"Playground"})]}),g.jsx("button",{onClick:()=>o(!s),className:`p-1.5 rounded-lg hover:bg-gray-800 transition-colors ${s?"mx-auto":""}`,title:s?"Expand sidebar":"Collapse sidebar",children:g.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform duration-300 ${s?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})})]}),g.jsxs("div",{className:"p-3",children:[!s&&g.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-2 px-2",children:"Content Generation"}),g.jsx("nav",{className:"space-y-1",children:T_.filter(u=>u.category==="content").map(({mode:u,label:h,icon:m})=>g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsxs("button",{onClick:()=>e(u),title:s?h:void 0,className:`flex-1 flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${n===u?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"} ${s?"justify-center":""}`,children:[m,!s&&g.jsx("span",{children:h})]}),!s&&g.jsx("a",{href:`${window.location.origin}${window.location.pathname}#${u}`,onClick:v=>{v.preventDefault();const C=`${window.location.origin}${window.location.pathname}#${u}`;navigator.clipboard.writeText(C)},className:"p-1.5 rounded text-gray-500 hover:text-gray-300 hover:bg-gray-800 transition-colors",title:"Click to copy link",children:g.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})})]},u))})]}),g.jsxs("div",{className:"p-3 pt-0",children:[!s&&g.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-2 px-2",children:"Voice Agent"}),g.jsx("nav",{className:"space-y-1",children:T_.filter(u=>u.category==="agent"&&(u.mode!=="gemini-live"||i)).map(({mode:u,label:h,icon:m})=>g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsxs("button",{onClick:()=>e(u),title:s?h:void 0,className:`flex-1 flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${n===u?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"} ${s?"justify-center":""}`,children:[m,!s&&g.jsx("span",{children:h})]}),!s&&g.jsx("a",{href:`${window.location.origin}${window.location.pathname}#${u}`,onClick:v=>{v.preventDefault();const C=`${window.location.origin}${window.location.pathname}#${u}`;navigator.clipboard.writeText(C)},className:"p-1.5 rounded text-gray-500 hover:text-gray-300 hover:bg-gray-800 transition-colors",title:"Click to copy link",children:g.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})})]},u))})]}),g.jsx("div",{className:"border-t border-gray-700 mx-3 my-2"}),g.jsx("div",{className:`flex-1 overflow-y-auto p-3 ${s?"hidden":""}`,children:c?g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-3 px-2",children:"Voice Live Config"}),g.jsxs("div",{className:"space-y-2 px-2 mb-4",children:[g.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"Endpoint"}),g.jsx("input",{type:"text",value:t.voiceLiveEndpoint||"",onChange:u=>{const h=u.target.value;r({voiceLiveEndpoint:h})},placeholder:"https://{resource}.cognitiveservices.azure.com/",autoComplete:"off",className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),g.jsxs("div",{className:"space-y-2 px-2 mb-4",children:[g.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"API Key"}),g.jsx("input",{type:"password",value:t.voiceLiveApiKey||"",onChange:u=>{const h=u.target.value;r({voiceLiveApiKey:h})},placeholder:"Enter API key",autoComplete:"new-password","data-lpignore":"true","data-form-type":"other",className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),g.jsx("a",{href:"https://ai.azure.com",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-400 hover:text-blue-300 underline",children:"Get credentials"})]}),g.jsxs("div",{className:"mt-4 bg-yellow-900/30 border border-yellow-700/50 rounded-md overflow-hidden",children:[g.jsxs("button",{onClick:()=>l(!a),className:"w-full p-3 flex items-center justify-between hover:bg-yellow-900/50 transition-colors",children:[g.jsx("h3",{className:"text-xs font-semibold text-yellow-400",children:"Security Notice"}),g.jsx("svg",{className:`w-4 h-4 text-yellow-400 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&g.jsx("div",{className:"px-3 pb-3",children:g.jsx("p",{className:"text-xs text-yellow-200/70",children:"Your credentials are stored in browser localStorage. Never share your key or use on untrusted devices."})})]})]}):g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-3 px-2",children:"Azure Speech Config"}),g.jsxs("div",{className:"space-y-2 px-2 mb-4",children:[g.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"API Key"}),g.jsx("input",{type:"password",value:t.apiKey,onChange:u=>{const h=u.target.value;h!==t.apiKey&&r({apiKey:h})},placeholder:"Enter API key",autoComplete:"new-password","data-lpignore":"true","data-form-type":"other",className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),g.jsx("a",{href:"https://portal.azure.com/#view/Microsoft_Azure_ProjectOxford/CognitiveServicesHub/~/SpeechServices",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-400 hover:text-blue-300 underline",children:"Get API key"})]}),g.jsxs("div",{className:"space-y-2 px-2",children:[g.jsx("label",{className:"block text-xs font-medium text-gray-400",children:"Region"}),g.jsx("select",{value:t.region,onChange:u=>r({region:u.target.value}),className:"w-full px-2 py-1.5 text-sm bg-gray-800 border border-gray-700 rounded text-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:A5.map(u=>g.jsx("option",{value:u.value,children:u.label},u.value))})]}),g.jsxs("div",{className:"mt-6 bg-yellow-900/30 border border-yellow-700/50 rounded-md overflow-hidden",children:[g.jsxs("button",{onClick:()=>l(!a),className:"w-full p-3 flex items-center justify-between hover:bg-yellow-900/50 transition-colors",children:[g.jsx("h3",{className:"text-xs font-semibold text-yellow-400",children:"Security Notice"}),g.jsx("svg",{className:`w-4 h-4 text-yellow-400 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&g.jsx("div",{className:"px-3 pb-3",children:g.jsx("p",{className:"text-xs text-yellow-200/70",children:"Your API key is stored in browser localStorage. Never share your key or use on untrusted devices."})})]})]})}),s&&g.jsx("div",{className:"flex-1 flex flex-col items-center pt-2",children:g.jsx("div",{className:"p-2 text-gray-500",title:"Expand to configure Azure settings",children:g.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})}),g.jsx("div",{className:"p-3 border-t border-gray-700",children:!s&&g.jsxs("div",{className:"text-xs text-gray-500 text-center space-y-1",children:[g.jsx("p",{children:"API key stored locally"}),g.jsxs("p",{className:"text-gray-600",children:["Build: ",g.jsx("a",{href:`https://github.com/szhaomsft/AzureVoicePlayground/commit/${A_}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:A_})]}),g.jsx("p",{className:"text-gray-600",children:new Date(C5).toLocaleString()})]})})]})}var ac={},lc={},vf={},cc={},Yt={},ax={},uc={},lx={},yf={},lC={},E_;function fB(){if(E_)return lC;E_=1,Object.defineProperty(lC,"__esModule",{value:!0}),lC.default=t;let n;const e=new Uint8Array(16);function t(){if(!n&&(n=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(e)}return lC}var Pd={},Sf={},Cf={},x_;function E5(){if(x_)return Cf;x_=1,Object.defineProperty(Cf,"__esModule",{value:!0}),Cf.default=void 0;var n=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;return Cf.default=n,Cf}var w_;function XA(){if(w_)return Sf;w_=1,Object.defineProperty(Sf,"__esModule",{value:!0}),Sf.default=void 0;var n=e(E5());function e(i){return i&&i.__esModule?i:{default:i}}function t(i){return typeof i=="string"&&n.default.test(i)}var r=t;return Sf.default=r,Sf}var b_;function QA(){if(b_)return Pd;b_=1,Object.defineProperty(Pd,"__esModule",{value:!0}),Pd.default=void 0,Pd.unsafeStringify=r;var n=e(XA());function e(o){return o&&o.__esModule?o:{default:o}}const t=[];for(let o=0;o<256;++o)t.push((o+256).toString(16).slice(1));function r(o,a=0){return t[o[a+0]]+t[o[a+1]]+t[o[a+2]]+t[o[a+3]]+"-"+t[o[a+4]]+t[o[a+5]]+"-"+t[o[a+6]]+t[o[a+7]]+"-"+t[o[a+8]]+t[o[a+9]]+"-"+t[o[a+10]]+t[o[a+11]]+t[o[a+12]]+t[o[a+13]]+t[o[a+14]]+t[o[a+15]]}function i(o,a=0){const l=r(o,a);if(!(0,n.default)(l))throw TypeError("Stringified UUID is invalid");return l}var s=i;return Pd.default=s,Pd}var P_;function x5(){if(P_)return yf;P_=1,Object.defineProperty(yf,"__esModule",{value:!0}),yf.default=void 0;var n=t(fB()),e=QA();function t(c){return c&&c.__esModule?c:{default:c}}let r,i,s=0,o=0;function a(c,u,h){let m=u&&h||0;const v=u||new Array(16);c=c||{};let C=c.node||r,T=c.clockseq!==void 0?c.clockseq:i;if(C==null||T==null){const M=c.random||(c.rng||n.default)();C==null&&(C=r=[M[0]|1,M[1],M[2],M[3],M[4],M[5]]),T==null&&(T=i=(M[6]<<8|M[7])&16383)}let E=c.msecs!==void 0?c.msecs:Date.now(),x=c.nsecs!==void 0?c.nsecs:o+1;const P=E-s+(x-o)/1e4;if(P<0&&c.clockseq===void 0&&(T=T+1&16383),(P<0||E>s)&&c.nsecs===void 0&&(x=0),x>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=E,o=x,i=T,E+=122192928e5;const b=((E&268435455)*1e4+x)%4294967296;v[m++]=b>>>24&255,v[m++]=b>>>16&255,v[m++]=b>>>8&255,v[m++]=b&255;const I=E/4294967296*1e4&268435455;v[m++]=I>>>8&255,v[m++]=I&255,v[m++]=I>>>24&15|16,v[m++]=I>>>16&255,v[m++]=T>>>8|128,v[m++]=T&255;for(let M=0;M<6;++M)v[m+M]=C[M];return u||(0,e.unsafeStringify)(v)}var l=a;return yf.default=l,yf}var Af={},za={},Tf={},R_;function mB(){if(R_)return Tf;R_=1,Object.defineProperty(Tf,"__esModule",{value:!0}),Tf.default=void 0;var n=e(XA());function e(i){return i&&i.__esModule?i:{default:i}}function t(i){if(!(0,n.default)(i))throw TypeError("Invalid UUID");let s;const o=new Uint8Array(16);return o[0]=(s=parseInt(i.slice(0,8),16))>>>24,o[1]=s>>>16&255,o[2]=s>>>8&255,o[3]=s&255,o[4]=(s=parseInt(i.slice(9,13),16))>>>8,o[5]=s&255,o[6]=(s=parseInt(i.slice(14,18),16))>>>8,o[7]=s&255,o[8]=(s=parseInt(i.slice(19,23),16))>>>8,o[9]=s&255,o[10]=(s=parseInt(i.slice(24,36),16))/1099511627776&255,o[11]=s/4294967296&255,o[12]=s>>>24&255,o[13]=s>>>16&255,o[14]=s>>>8&255,o[15]=s&255,o}var r=t;return Tf.default=r,Tf}var I_;function gB(){if(I_)return za;I_=1,Object.defineProperty(za,"__esModule",{value:!0}),za.URL=za.DNS=void 0,za.default=o;var n=QA(),e=t(mB());function t(a){return a&&a.__esModule?a:{default:a}}function r(a){a=unescape(encodeURIComponent(a));const l=[];for(let c=0;c<a.length;++c)l.push(a.charCodeAt(c));return l}const i="6ba7b810-9dad-11d1-80b4-00c04fd430c8";za.DNS=i;const s="6ba7b811-9dad-11d1-80b4-00c04fd430c8";za.URL=s;function o(a,l,c){function u(h,m,v,C){var T;if(typeof h=="string"&&(h=r(h)),typeof m=="string"&&(m=(0,e.default)(m)),((T=m)===null||T===void 0?void 0:T.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let E=new Uint8Array(16+h.length);if(E.set(m),E.set(h,m.length),E=c(E),E[6]=E[6]&15|l,E[8]=E[8]&63|128,v){C=C||0;for(let x=0;x<16;++x)v[C+x]=E[x];return v}return(0,n.unsafeStringify)(E)}try{u.name=a}catch{}return u.DNS=i,u.URL=s,u}return za}var Ef={},__;function w5(){if(__)return Ef;__=1,Object.defineProperty(Ef,"__esModule",{value:!0}),Ef.default=void 0;function n(v){if(typeof v=="string"){const C=unescape(encodeURIComponent(v));v=new Uint8Array(C.length);for(let T=0;T<C.length;++T)v[T]=C.charCodeAt(T)}return e(r(i(v),v.length*8))}function e(v){const C=[],T=v.length*32,E="0123456789abcdef";for(let x=0;x<T;x+=8){const P=v[x>>5]>>>x%32&255,b=parseInt(E.charAt(P>>>4&15)+E.charAt(P&15),16);C.push(b)}return C}function t(v){return(v+64>>>9<<4)+14+1}function r(v,C){v[C>>5]|=128<<C%32,v[t(C)-1]=C;let T=1732584193,E=-271733879,x=-1732584194,P=271733878;for(let b=0;b<v.length;b+=16){const I=T,M=E,N=x,D=P;T=l(T,E,x,P,v[b],7,-680876936),P=l(P,T,E,x,v[b+1],12,-389564586),x=l(x,P,T,E,v[b+2],17,606105819),E=l(E,x,P,T,v[b+3],22,-1044525330),T=l(T,E,x,P,v[b+4],7,-176418897),P=l(P,T,E,x,v[b+5],12,1200080426),x=l(x,P,T,E,v[b+6],17,-1473231341),E=l(E,x,P,T,v[b+7],22,-45705983),T=l(T,E,x,P,v[b+8],7,1770035416),P=l(P,T,E,x,v[b+9],12,-1958414417),x=l(x,P,T,E,v[b+10],17,-42063),E=l(E,x,P,T,v[b+11],22,-1990404162),T=l(T,E,x,P,v[b+12],7,1804603682),P=l(P,T,E,x,v[b+13],12,-40341101),x=l(x,P,T,E,v[b+14],17,-1502002290),E=l(E,x,P,T,v[b+15],22,1236535329),T=c(T,E,x,P,v[b+1],5,-165796510),P=c(P,T,E,x,v[b+6],9,-1069501632),x=c(x,P,T,E,v[b+11],14,643717713),E=c(E,x,P,T,v[b],20,-373897302),T=c(T,E,x,P,v[b+5],5,-701558691),P=c(P,T,E,x,v[b+10],9,38016083),x=c(x,P,T,E,v[b+15],14,-660478335),E=c(E,x,P,T,v[b+4],20,-405537848),T=c(T,E,x,P,v[b+9],5,568446438),P=c(P,T,E,x,v[b+14],9,-1019803690),x=c(x,P,T,E,v[b+3],14,-187363961),E=c(E,x,P,T,v[b+8],20,1163531501),T=c(T,E,x,P,v[b+13],5,-1444681467),P=c(P,T,E,x,v[b+2],9,-51403784),x=c(x,P,T,E,v[b+7],14,1735328473),E=c(E,x,P,T,v[b+12],20,-1926607734),T=u(T,E,x,P,v[b+5],4,-378558),P=u(P,T,E,x,v[b+8],11,-2022574463),x=u(x,P,T,E,v[b+11],16,1839030562),E=u(E,x,P,T,v[b+14],23,-35309556),T=u(T,E,x,P,v[b+1],4,-1530992060),P=u(P,T,E,x,v[b+4],11,1272893353),x=u(x,P,T,E,v[b+7],16,-155497632),E=u(E,x,P,T,v[b+10],23,-1094730640),T=u(T,E,x,P,v[b+13],4,681279174),P=u(P,T,E,x,v[b],11,-358537222),x=u(x,P,T,E,v[b+3],16,-722521979),E=u(E,x,P,T,v[b+6],23,76029189),T=u(T,E,x,P,v[b+9],4,-640364487),P=u(P,T,E,x,v[b+12],11,-421815835),x=u(x,P,T,E,v[b+15],16,530742520),E=u(E,x,P,T,v[b+2],23,-995338651),T=h(T,E,x,P,v[b],6,-198630844),P=h(P,T,E,x,v[b+7],10,1126891415),x=h(x,P,T,E,v[b+14],15,-1416354905),E=h(E,x,P,T,v[b+5],21,-57434055),T=h(T,E,x,P,v[b+12],6,1700485571),P=h(P,T,E,x,v[b+3],10,-1894986606),x=h(x,P,T,E,v[b+10],15,-1051523),E=h(E,x,P,T,v[b+1],21,-2054922799),T=h(T,E,x,P,v[b+8],6,1873313359),P=h(P,T,E,x,v[b+15],10,-30611744),x=h(x,P,T,E,v[b+6],15,-1560198380),E=h(E,x,P,T,v[b+13],21,1309151649),T=h(T,E,x,P,v[b+4],6,-145523070),P=h(P,T,E,x,v[b+11],10,-1120210379),x=h(x,P,T,E,v[b+2],15,718787259),E=h(E,x,P,T,v[b+9],21,-343485551),T=s(T,I),E=s(E,M),x=s(x,N),P=s(P,D)}return[T,E,x,P]}function i(v){if(v.length===0)return[];const C=v.length*8,T=new Uint32Array(t(C));for(let E=0;E<C;E+=8)T[E>>5]|=(v[E/8]&255)<<E%32;return T}function s(v,C){const T=(v&65535)+(C&65535);return(v>>16)+(C>>16)+(T>>16)<<16|T&65535}function o(v,C){return v<<C|v>>>32-C}function a(v,C,T,E,x,P){return s(o(s(s(C,v),s(E,P)),x),T)}function l(v,C,T,E,x,P,b){return a(C&T|~C&E,v,C,x,P,b)}function c(v,C,T,E,x,P,b){return a(C&E|T&~E,v,C,x,P,b)}function u(v,C,T,E,x,P,b){return a(C^T^E,v,C,x,P,b)}function h(v,C,T,E,x,P,b){return a(T^(C|~E),v,C,x,P,b)}var m=n;return Ef.default=m,Ef}var k_;function b5(){if(k_)return Af;k_=1,Object.defineProperty(Af,"__esModule",{value:!0}),Af.default=void 0;var n=t(gB()),e=t(w5());function t(s){return s&&s.__esModule?s:{default:s}}var i=(0,n.default)("v3",48,e.default);return Af.default=i,Af}var xf={},wf={},M_;function P5(){if(M_)return wf;M_=1,Object.defineProperty(wf,"__esModule",{value:!0}),wf.default=void 0;var e={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};return wf.default=e,wf}var N_;function R5(){if(N_)return xf;N_=1,Object.defineProperty(xf,"__esModule",{value:!0}),xf.default=void 0;var n=r(P5()),e=r(fB()),t=QA();function r(o){return o&&o.__esModule?o:{default:o}}function i(o,a,l){if(n.default.randomUUID&&!a&&!o)return n.default.randomUUID();o=o||{};const c=o.random||(o.rng||e.default)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,a){l=l||0;for(let u=0;u<16;++u)a[l+u]=c[u];return a}return(0,t.unsafeStringify)(c)}var s=i;return xf.default=s,xf}var bf={},Pf={},L_;function I5(){if(L_)return Pf;L_=1,Object.defineProperty(Pf,"__esModule",{value:!0}),Pf.default=void 0;function n(i,s,o,a){switch(i){case 0:return s&o^~s&a;case 1:return s^o^a;case 2:return s&o^s&a^o&a;case 3:return s^o^a}}function e(i,s){return i<<s|i>>>32-s}function t(i){const s=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof i=="string"){const u=unescape(encodeURIComponent(i));i=[];for(let h=0;h<u.length;++h)i.push(u.charCodeAt(h))}else Array.isArray(i)||(i=Array.prototype.slice.call(i));i.push(128);const a=i.length/4+2,l=Math.ceil(a/16),c=new Array(l);for(let u=0;u<l;++u){const h=new Uint32Array(16);for(let m=0;m<16;++m)h[m]=i[u*64+m*4]<<24|i[u*64+m*4+1]<<16|i[u*64+m*4+2]<<8|i[u*64+m*4+3];c[u]=h}c[l-1][14]=(i.length-1)*8/Math.pow(2,32),c[l-1][14]=Math.floor(c[l-1][14]),c[l-1][15]=(i.length-1)*8&4294967295;for(let u=0;u<l;++u){const h=new Uint32Array(80);for(let x=0;x<16;++x)h[x]=c[u][x];for(let x=16;x<80;++x)h[x]=e(h[x-3]^h[x-8]^h[x-14]^h[x-16],1);let m=o[0],v=o[1],C=o[2],T=o[3],E=o[4];for(let x=0;x<80;++x){const P=Math.floor(x/20),b=e(m,5)+n(P,v,C,T)+E+s[P]+h[x]>>>0;E=T,T=C,C=e(v,30)>>>0,v=m,m=b}o[0]=o[0]+m>>>0,o[1]=o[1]+v>>>0,o[2]=o[2]+C>>>0,o[3]=o[3]+T>>>0,o[4]=o[4]+E>>>0}return[o[0]>>24&255,o[0]>>16&255,o[0]>>8&255,o[0]&255,o[1]>>24&255,o[1]>>16&255,o[1]>>8&255,o[1]&255,o[2]>>24&255,o[2]>>16&255,o[2]>>8&255,o[2]&255,o[3]>>24&255,o[3]>>16&255,o[3]>>8&255,o[3]&255,o[4]>>24&255,o[4]>>16&255,o[4]>>8&255,o[4]&255]}var r=t;return Pf.default=r,Pf}var D_;function _5(){if(D_)return bf;D_=1,Object.defineProperty(bf,"__esModule",{value:!0}),bf.default=void 0;var n=t(gB()),e=t(I5());function t(s){return s&&s.__esModule?s:{default:s}}var i=(0,n.default)("v5",80,e.default);return bf.default=i,bf}var Rf={},O_;function k5(){if(O_)return Rf;O_=1,Object.defineProperty(Rf,"__esModule",{value:!0}),Rf.default=void 0;var n="00000000-0000-0000-0000-000000000000";return Rf.default=n,Rf}var If={},B_;function M5(){if(B_)return If;B_=1,Object.defineProperty(If,"__esModule",{value:!0}),If.default=void 0;var n=e(XA());function e(i){return i&&i.__esModule?i:{default:i}}function t(i){if(!(0,n.default)(i))throw TypeError("Invalid UUID");return parseInt(i.slice(14,15),16)}var r=t;return If.default=r,If}var F_;function N5(){return F_||(F_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"NIL",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"parse",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(n,"stringify",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"v1",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"v3",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"v4",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"validate",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"version",{enumerable:!0,get:function(){return o.default}});var e=u(x5()),t=u(b5()),r=u(R5()),i=u(_5()),s=u(k5()),o=u(M5()),a=u(XA()),l=u(QA()),c=u(mB());function u(h){return h&&h.__esModule?h:{default:h}}})(lx)),lx}var j_;function Xu(){if(j_)return uc;j_=1,Object.defineProperty(uc,"__esModule",{value:!0}),uc.createNoDashGuid=uc.createGuid=void 0;const n=N5(),e=()=>(0,n.v4)();uc.createGuid=e;const t=()=>e().replace(new RegExp("-","g"),"").toUpperCase();return uc.createNoDashGuid=t,uc}var U_;function jS(){return U_||(U_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.PlatformEvent=n.EventType=void 0;const e=Xu();(function(r){r[r.Debug=0]="Debug",r[r.Info=1]="Info",r[r.Warning=2]="Warning",r[r.Error=3]="Error",r[r.None=4]="None"})(n.EventType||(n.EventType={}));class t{constructor(i,s){this.privName=i,this.privEventId=(0,e.createNoDashGuid)(),this.privEventTime=new Date().toISOString(),this.privEventType=s,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}n.PlatformEvent=t})(ax)),ax}var z_;function L5(){if(z_)return Yt;z_=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.AudioStreamNodeErrorEvent=Yt.AudioStreamNodeDetachedEvent=Yt.AudioStreamNodeAttachedEvent=Yt.AudioStreamNodeAttachingEvent=Yt.AudioStreamNodeEvent=Yt.AudioSourceErrorEvent=Yt.AudioSourceOffEvent=Yt.AudioSourceReadyEvent=Yt.AudioSourceInitializingEvent=Yt.AudioSourceEvent=void 0;const n=jS();class e extends n.PlatformEvent{constructor(m,v,C=n.EventType.Info){super(m,C),this.privAudioSourceId=v}get audioSourceId(){return this.privAudioSourceId}}Yt.AudioSourceEvent=e;class t extends e{constructor(m){super("AudioSourceInitializingEvent",m)}}Yt.AudioSourceInitializingEvent=t;class r extends e{constructor(m){super("AudioSourceReadyEvent",m)}}Yt.AudioSourceReadyEvent=r;class i extends e{constructor(m){super("AudioSourceOffEvent",m)}}Yt.AudioSourceOffEvent=i;class s extends e{constructor(m,v){super("AudioSourceErrorEvent",m,n.EventType.Error),this.privError=v}get error(){return this.privError}}Yt.AudioSourceErrorEvent=s;class o extends e{constructor(m,v,C){super(m,v),this.privAudioNodeId=C}get audioNodeId(){return this.privAudioNodeId}}Yt.AudioStreamNodeEvent=o;class a extends o{constructor(m,v){super("AudioStreamNodeAttachingEvent",m,v)}}Yt.AudioStreamNodeAttachingEvent=a;class l extends o{constructor(m,v){super("AudioStreamNodeAttachedEvent",m,v)}}Yt.AudioStreamNodeAttachedEvent=l;class c extends o{constructor(m,v){super("AudioStreamNodeDetachedEvent",m,v)}}Yt.AudioStreamNodeDetachedEvent=c;class u extends o{constructor(m,v,C){super("AudioStreamNodeErrorEvent",m,v),this.privError=C}get error(){return this.privError}}return Yt.AudioStreamNodeErrorEvent=u,Yt}var Jt={},W_;function D5(){if(W_)return Jt;W_=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.ConnectionRedirectEvent=Jt.ConnectionMessageSentEvent=Jt.ConnectionMessageReceivedEvent=Jt.ConnectionEstablishErrorEvent=Jt.ConnectionErrorEvent=Jt.ConnectionClosedEvent=Jt.ConnectionEstablishedEvent=Jt.ConnectionStartEvent=Jt.ConnectionEvent=Jt.ServiceEvent=void 0;const n=jS();class e extends n.PlatformEvent{constructor(m,v,C=n.EventType.Info){super(m,C),this.privJsonResult=v}get jsonString(){return this.privJsonResult}}Jt.ServiceEvent=e;class t extends n.PlatformEvent{constructor(m,v,C=n.EventType.Info){super(m,C),this.privConnectionId=v}get connectionId(){return this.privConnectionId}}Jt.ConnectionEvent=t;class r extends t{constructor(m,v,C){super("ConnectionStartEvent",m),this.privUri=v,this.privHeaders=C}get uri(){return this.privUri}get headers(){return this.privHeaders}}Jt.ConnectionStartEvent=r;class i extends t{constructor(m){super("ConnectionEstablishedEvent",m)}}Jt.ConnectionEstablishedEvent=i;class s extends t{constructor(m,v,C){super("ConnectionClosedEvent",m,n.EventType.Debug),this.privReason=C,this.privStatusCode=v}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}Jt.ConnectionClosedEvent=s;class o extends t{constructor(m,v,C){super("ConnectionErrorEvent",m,n.EventType.Debug),this.privMessage=v,this.privType=C}get message(){return this.privMessage}get type(){return this.privType}}Jt.ConnectionErrorEvent=o;class a extends t{constructor(m,v,C){super("ConnectionEstablishErrorEvent",m,n.EventType.Error),this.privStatusCode=v,this.privReason=C}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}Jt.ConnectionEstablishErrorEvent=a;class l extends t{constructor(m,v,C){super("ConnectionMessageReceivedEvent",m),this.privNetworkReceivedTime=v,this.privMessage=C}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}Jt.ConnectionMessageReceivedEvent=l;class c extends t{constructor(m,v,C){super("ConnectionMessageSentEvent",m),this.privNetworkSentTime=v,this.privMessage=C}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}Jt.ConnectionMessageSentEvent=c;class u extends t{constructor(m,v,C,T){super("ConnectionRedirectEvent",m,n.EventType.Info),this.privRedirectUrl=v,this.privOriginalUrl=C,this.privContext=T}get redirectUrl(){return this.privRedirectUrl}get originalUrl(){return this.privOriginalUrl}get context(){return this.privContext}}return Jt.ConnectionRedirectEvent=u,Jt}var cx={},go={},V_;function ro(){if(V_)return go;V_=1,Object.defineProperty(go,"__esModule",{value:!0}),go.ObjectDisposedError=go.InvalidOperationError=go.ArgumentNullError=void 0;class n extends Error{constructor(i){super(i),this.name="ArgumentNull",this.message=i}}go.ArgumentNullError=n;class e extends Error{constructor(i){super(i),this.name="InvalidOperation",this.message=i}}go.InvalidOperationError=e;class t extends Error{constructor(i,s){super(s),this.name=i+"ObjectDisposed",this.message=s}}return go.ObjectDisposedError=t,go}var $_;function vB(){return $_||($_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConnectionMessage=n.MessageType=void 0;const e=ro(),t=Xu();var r;(function(s){s[s.Text=0]="Text",s[s.Binary=1]="Binary"})(r=n.MessageType||(n.MessageType={}));class i{constructor(o,a,l,c){if(this.privBody=null,o===r.Text&&a&&typeof a!="string")throw new e.InvalidOperationError("Payload must be a string");if(o===r.Binary&&a&&!(a instanceof ArrayBuffer))throw new e.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=o,this.privBody=a,this.privHeaders=l||{},this.privId=c||(0,t.createNoDashGuid)(),this.messageType){case r.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case r.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===r.Binary)throw new e.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===r.Text)throw new e.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}n.ConnectionMessage=i})(cx)),cx}var _f={},H_;function O5(){if(H_)return _f;H_=1,Object.defineProperty(_f,"__esModule",{value:!0}),_f.ConnectionOpenResponse=void 0;let n=class{constructor(t,r){this.privStatusCode=t,this.privReason=r}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};return _f.ConnectionOpenResponse=n,_f}var kf={},Z_;function B5(){if(Z_)return kf;Z_=1,Object.defineProperty(kf,"__esModule",{value:!0}),kf.DeferralMap=void 0;let n=class{constructor(){this.privMap={}}add(t,r){this.privMap[t]=r}getId(t){return this.privMap[t]}complete(t,r){try{this.privMap[t].resolve(r)}catch(i){this.privMap[t].reject(i)}finally{this.privMap[t]=void 0}}};return kf.DeferralMap=n,kf}var dc={},q_;function yB(){if(q_)return dc;q_=1,Object.defineProperty(dc,"__esModule",{value:!0}),dc.SendingAgentContextMessageEvent=dc.DialogEvent=void 0;const n=jS();class e extends n.PlatformEvent{constructor(i,s=n.EventType.Info){super(i,s)}}dc.DialogEvent=e;class t extends e{constructor(i){super("SendingAgentContextMessageEvent"),this.privAgentConfig=i}get agentConfig(){return this.privAgentConfig}}return dc.SendingAgentContextMessageEvent=t,dc}var Mf={},Nf={},G_;function SB(){if(G_)return Nf;G_=1,Object.defineProperty(Nf,"__esModule",{value:!0}),Nf.EventSource=void 0;const n=ro(),e=Xu();let t=class{constructor(i){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=i}onEvent(i){if(this.isDisposed())throw new n.ObjectDisposedError("EventSource");if(this.metadata)for(const s in this.metadata)s&&i.metadata&&(i.metadata[s]||(i.metadata[s]=this.metadata[s]));for(const s in this.privEventListeners)s&&this.privEventListeners[s]&&this.privEventListeners[s](i)}attach(i){const s=(0,e.createNoDashGuid)();return this.privEventListeners[s]=i,{detach:()=>(delete this.privEventListeners[s],Promise.resolve())}}attachListener(i){return this.attach(s=>i.onEvent(s))}attachConsoleListener(i){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(s=>i.onEvent(s)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};return Nf.EventSource=t,Nf}var K_;function F5(){if(K_)return Mf;K_=1,Object.defineProperty(Mf,"__esModule",{value:!0}),Mf.Events=void 0;const n=ro(),e=SB();let t=class jw{static setEventSource(i){if(!i)throw new n.ArgumentNullError("eventSource");jw.privInstance=i}static get instance(){return jw.privInstance}};return Mf.Events=t,t.privInstance=new e.EventSource,Mf}var ux={},Y_;function j5(){return Y_||(Y_=1,Object.defineProperty(ux,"__esModule",{value:!0})),ux}var dx={},J_;function U5(){return J_||(J_=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConnectionState=void 0,(function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"})(n.ConnectionState||(n.ConnectionState={}))})(dx)),dx}var hx={},X_;function z5(){return X_||(X_=1,Object.defineProperty(hx,"__esModule",{value:!0})),hx}var px={},Q_;function W5(){return Q_||(Q_=1,Object.defineProperty(px,"__esModule",{value:!0})),px}var fx={},ek;function V5(){return ek||(ek=1,Object.defineProperty(fx,"__esModule",{value:!0})),fx}var mx={},tk;function $5(){return tk||(tk=1,Object.defineProperty(mx,"__esModule",{value:!0})),mx}var gx={},nk;function H5(){return nk||(nk=1,Object.defineProperty(gx,"__esModule",{value:!0})),gx}var vx={},rk;function Z5(){return rk||(rk=1,Object.defineProperty(vx,"__esModule",{value:!0})),vx}var yx={},ik;function q5(){return ik||(ik=1,Object.defineProperty(yx,"__esModule",{value:!0})),yx}var Sx={},sk;function G5(){return sk||(sk=1,Object.defineProperty(Sx,"__esModule",{value:!0})),Sx}var Lf={},ok;function CB(){if(ok)return Lf;ok=1,Object.defineProperty(Lf,"__esModule",{value:!0}),Lf.List=void 0;const n=ro();let e=class wc{constructor(r){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],r)for(const i of r)this.privList.push(i)}get(r){return this.throwIfDisposed(),this.privList[r]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(r){this.throwIfDisposed(),this.insertAt(this.privList.length,r)}insertAt(r,i){this.throwIfDisposed(),r===0?this.privList.unshift(i):r===this.privList.length?this.privList.push(i):this.privList.splice(r,0,i),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(r){return this.throwIfDisposed(),this.remove(r,1)[0]}remove(r,i){this.throwIfDisposed();const s=this.privList.splice(r,i);return this.triggerSubscriptions(this.privRemoveSubscriptions),s}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(r){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[i]=r,{detach:()=>(delete this.privAddSubscriptions[i],Promise.resolve())}}onRemoved(r){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[i]=r,{detach:()=>(delete this.privRemoveSubscriptions[i],Promise.resolve())}}onDisposed(r){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[i]=r,{detach:()=>(delete this.privDisposedSubscriptions[i],Promise.resolve())}}join(r){return this.throwIfDisposed(),this.privList.join(r)}toArray(){const r=Array();return this.privList.forEach(i=>{r.push(i)}),r}any(r){return this.throwIfDisposed(),r?this.where(r).length()>0:this.length()>0}all(r){return this.throwIfDisposed(),this.where(r).length()===this.length()}forEach(r){this.throwIfDisposed();for(let i=0;i<this.length();i++)r(this.privList[i],i)}select(r){this.throwIfDisposed();const i=[];for(let s=0;s<this.privList.length;s++)i.push(r(this.privList[s],s));return new wc(i)}where(r){this.throwIfDisposed();const i=new wc;for(let s=0;s<this.privList.length;s++)r(this.privList[s],s)&&i.add(this.privList[s]);return i}orderBy(r){this.throwIfDisposed();const s=this.toArray().sort(r);return new wc(s)}orderByDesc(r){return this.throwIfDisposed(),this.orderBy((i,s)=>r(s,i))}clone(){return this.throwIfDisposed(),new wc(this.toArray())}concat(r){return this.throwIfDisposed(),new wc(this.privList.concat(r.toArray()))}concatArray(r){return this.throwIfDisposed(),new wc(this.privList.concat(r))}isDisposed(){return this.privList==null}dispose(r){this.isDisposed()||(this.privDisposeReason=r,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new n.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(r){if(r)for(const i in r)i&&r[i]()}};return Lf.List=e,Lf}var Cx={},ak;function AB(){return ak||(ak=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.marshalPromiseToCallbacks=n.Sink=n.Deferred=n.PromiseResultEventSource=n.PromiseResult=n.PromiseState=void 0;var e;(function(a){a[a.None=0]="None",a[a.Resolved=1]="Resolved",a[a.Rejected=2]="Rejected"})(e=n.PromiseState||(n.PromiseState={}));class t{constructor(l){this.throwIfError=()=>{if(this.isError)throw this.error},l.on(c=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=c)},c=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=c)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}n.PromiseResult=t;class r{constructor(){this.setResult=l=>{this.privOnSetResult(l)},this.setError=l=>{this.privOnSetError(l)},this.on=(l,c)=>{this.privOnSetResult=l,this.privOnSetError=c}}}n.PromiseResultEventSource=r;class i{constructor(){this.resolve=l=>(this.privResolve(l),this),this.reject=l=>(this.privReject(l),this),this.privPromise=new Promise((l,c)=>{this.privResolve=l,this.privReject=c})}get promise(){return this.privPromise}}n.Deferred=i;class s{constructor(){this.privState=e.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new r,this.privPromiseResult=new t(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(l){if(this.privState!==e.None)throw new Error("'Cannot resolve a completed promise'");this.privState=e.Resolved,this.privPromiseResultEvents.setResult(l);for(let c=0;c<this.privSuccessHandlers.length;c++)this.executeSuccessCallback(l,this.privSuccessHandlers[c],this.privErrorHandlers[c]);this.detachHandlers()}reject(l){if(this.privState!==e.None)throw new Error("'Cannot reject a completed promise'");this.privState=e.Rejected,this.privPromiseResultEvents.setError(l);for(const c of this.privErrorHandlers)this.executeErrorCallback(l,c);this.detachHandlers()}on(l,c){l==null&&(l=()=>{}),this.privState===e.None?(this.privSuccessHandlers.push(l),this.privErrorHandlers.push(c)):(this.privState===e.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,l,c):this.privState===e.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,c),this.detachHandlers())}executeSuccessCallback(l,c,u){try{c(l)}catch(h){this.executeErrorCallback(`'Unhandled callback error: ${h}'`,u)}}executeErrorCallback(l,c){if(c)try{c(l)}catch(u){throw new Error(`'Unhandled callback error: ${u}. InnerError: ${l}'`)}else throw new Error(`'Unhandled error: ${l}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}}n.Sink=s;function o(a,l,c){a.then(u=>{try{l&&l(u)}catch(h){if(c)try{if(h instanceof Error){const m=h;c(m.name+": "+m.message)}else c(h)}catch{}}},u=>{if(c)try{if(u instanceof Error){const h=u;c(h.name+": "+h.message)}else c(u)}catch{}})}n.marshalPromiseToCallbacks=o})(Cx)),Cx}var Df={},lk;function TB(){if(lk)return Df;lk=1,Object.defineProperty(Df,"__esModule",{value:!0}),Df.Queue=void 0;const n=ro(),e=CB(),t=AB();var r;(function(s){s[s.Dequeue=0]="Dequeue",s[s.Peek=1]="Peek"})(r||(r={}));let i=class{constructor(o){this.privPromiseStore=new e.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=o||new e.List,this.privDetachables=[],this.privSubscribers=new e.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(o){this.throwIfDispose(),this.enqueueFromPromise(new Promise(a=>a(o)))}enqueueFromPromise(o){this.throwIfDispose(),o.then(a=>{this.privList.add(a)},()=>{})}dequeue(){this.throwIfDispose();const o=new t.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:o,type:r.Dequeue}),this.drain()),o.promise}peek(){this.throwIfDispose();const o=new t.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:o,type:r.Peek}),this.drain()),o.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(o,a){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=a,this.privIsDisposing=!0;const l=this.privSubscribers;if(l){for(;l.length()>0;)l.removeFirst().deferral.resolve(void 0);this.privSubscribers===l&&(this.privSubscribers=l)}for(const c of this.privDetachables)await c.detach();if(this.privPromiseStore.length()>0&&o){const c=[];return this.privPromiseStore.toArray().forEach(u=>{c.push(u)}),Promise.all(c).finally(()=>{this.privSubscribers=null,this.privList.forEach(u=>{o(u)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}}async dispose(o){await this.drainAndDispose(null,o)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const o=this.privSubscribers,a=this.privList;if(o&&a){for(;a.length()>0&&o.length()>0&&!this.privIsDisposing;){const l=o.removeFirst();if(l.type===r.Peek)l.deferral.resolve(a.first());else{const c=a.removeFirst();l.deferral.resolve(c)}}this.privSubscribers===o&&(this.privSubscribers=o),this.privList===a&&(this.privList=a)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new n.InvalidOperationError(this.privDisposeReason):new n.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new n.InvalidOperationError("Queue disposing")}};return Df.Queue=i,Df}var Of={},ck;function K5(){if(ck)return Of;ck=1,Object.defineProperty(Of,"__esModule",{value:!0}),Of.RawWebsocketMessage=void 0;const n=vB(),e=ro(),t=Xu();let r=class{constructor(s,o,a){if(this.privPayload=null,!o)throw new e.ArgumentNullError("payload");if(s===n.MessageType.Binary&&Object.getPrototypeOf(o).constructor.name!=="ArrayBuffer")throw new e.InvalidOperationError("Payload must be ArrayBuffer");if(s===n.MessageType.Text&&typeof o!="string")throw new e.InvalidOperationError("Payload must be a string");this.privMessageType=s,this.privPayload=o,this.privId=a||(0,t.createNoDashGuid)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===n.MessageType.Binary)throw new e.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===n.MessageType.Text)throw new e.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};return Of.RawWebsocketMessage=r,Of}var Bf={},uk;function Y5(){if(uk)return Bf;uk=1,Object.defineProperty(Bf,"__esModule",{value:!0}),Bf.RiffPcmEncoder=void 0;let n=class{constructor(t,r){this.privActualSampleRate=t,this.privDesiredSampleRate=r}encode(t){const r=this.downSampleAudioFrame(t,this.privActualSampleRate,this.privDesiredSampleRate);if(!r)return null;const i=r.length*2,s=new ArrayBuffer(i),o=new DataView(s);return this.floatTo16BitPCM(o,0,r),s}setString(t,r,i){for(let s=0;s<i.length;s++)t.setUint8(r+s,i.charCodeAt(s))}floatTo16BitPCM(t,r,i){for(let s=0;s<i.length;s++,r+=2){const o=Math.max(-1,Math.min(1,i[s]));t.setInt16(r,o<0?o*32768:o*32767,!0)}}downSampleAudioFrame(t,r,i){if(!t)return null;if(i===r||i>r)return t;const s=r/i,o=Math.round(t.length/s),a=new Float32Array(o);let l=0,c=0;for(;c<o;){const u=Math.round((c+1)*s);let h=0,m=0;for(;l<u&&l<t.length;)h+=t[l++],m++;a[c++]=h/m}return a}};return Bf.RiffPcmEncoder=n,Bf}var Ff={},dk;function J5(){if(dk)return Ff;dk=1,Object.defineProperty(Ff,"__esModule",{value:!0}),Ff.Stream=void 0;const n=ro(),e=Xu(),t=TB();class r{constructor(s){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=s||(0,e.createNoDashGuid)(),this.privReaderQueue=new t.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(s){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(s)}catch{}}read(){if(this.privIsReadEnded)throw new n.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async s=>((s===void 0||s.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),s))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new t.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new n.InvalidOperationError("Stream closed")}}return Ff.Stream=r,Ff}var Ax={},hk;function $P(){return hk||(hk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.TranslationStatus=void 0,(function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"})(n.TranslationStatus||(n.TranslationStatus={}))})(Ax)),Ax}var jf={},pk;function X5(){if(pk)return jf;pk=1,Object.defineProperty(jf,"__esModule",{value:!0}),jf.ChunkedArrayBufferStream=void 0;const n=He();let e=class extends n.Stream{constructor(r,i){super(i),this.privTargetChunkSize=Math.round(r),this.privNextBufferReadyBytes=0}writeStreamChunk(r){if(r.isEnd||this.privNextBufferReadyBytes===0&&r.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(r);return}let i=0;for(;i<r.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=r.timeReceived);const s=Math.min(r.buffer.byteLength-i,this.privTargetChunkSize-this.privNextBufferReadyBytes),o=new Uint8Array(this.privNextBufferToWrite),a=new Uint8Array(r.buffer.slice(i,s+i));o.set(a,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=s,i+=s,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};return jf.ChunkedArrayBufferStream=e,jf}var Tx={},fk;function Q5(){return fk||(fk=1,Object.defineProperty(Tx,"__esModule",{value:!0})),Tx}var Uf={},mk;function e8(){if(mk)return Uf;mk=1,Object.defineProperty(Uf,"__esModule",{value:!0}),Uf.Timeout=void 0;let n=class Va{static load(){const t=new Map([[0,()=>{}]]),r=new Map,s="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),o=new Worker(s);return o.addEventListener("message",({data:c})=>{if(Va.isCallNotification(c)){const{params:{timerId:u}}=c,h=t.get(u);if(typeof h=="number"){const m=r.get(h);if(m===void 0||m!==u)throw new Error("The timer is in an undefined state.")}else if(typeof h<"u")h(),t.delete(u);else throw new Error("The timer is in an undefined state.")}else if(Va.isClearResponse(c)){const{id:u}=c,h=r.get(u);if(h===void 0)throw new Error("The timer is in an undefined state.");r.delete(u),t.delete(h)}else{const{error:{message:u}}=c;throw new Error(u)}}),{clearTimeout:c=>{const u=Math.random();r.set(u,c),t.set(c,u),o.postMessage({id:u,method:"clear",params:{timerId:c}})},setTimeout:(c,u)=>{const h=Math.random();return t.set(h,c),o.postMessage({id:null,method:"set",params:{delay:u,now:performance.now(),timerId:h}}),h}}}static loadWorkerTimers(){return()=>(Va.workerTimers!==null||(Va.workerTimers=Va.load()),Va.workerTimers)}static isCallNotification(t){return t.method!==void 0&&t.method==="call"}static isClearResponse(t){return t.error===null&&typeof t.id=="number"}};return Uf.Timeout=n,n.workerTimers=null,n.clearTimeout=e=>n.timers().clearTimeout(e),n.setTimeout=(e,t)=>n.timers().setTimeout(e,t),n.timers=n.loadWorkerTimers(),Uf}var ot={},gk;function t8(){if(gk)return ot;gk=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.OCSPCacheUpdateErrorEvent=ot.OCSPResponseRetrievedEvent=ot.OCSPCacheFetchErrorEvent=ot.OCSPVerificationFailedEvent=ot.OCSPCacheHitEvent=ot.OCSPCacheEntryNeedsRefreshEvent=ot.OCSPCacheEntryExpiredEvent=ot.OCSPWSUpgradeStartedEvent=ot.OCSPStapleReceivedEvent=ot.OCSPCacheUpdateCompleteEvent=ot.OCSPDiskCacheStoreEvent=ot.OCSPMemoryCacheStoreEvent=ot.OCSPCacheUpdateNeededEvent=ot.OCSPDiskCacheHitEvent=ot.OCSPCacheMissEvent=ot.OCSPMemoryCacheHitEvent=ot.OCSPEvent=void 0;const n=jS();class e extends n.PlatformEvent{constructor(b,I,M){super(b,I),this.privSignature=M}}ot.OCSPEvent=e;class t extends e{constructor(b){super("OCSPMemoryCacheHitEvent",n.EventType.Debug,b)}}ot.OCSPMemoryCacheHitEvent=t;class r extends e{constructor(b){super("OCSPCacheMissEvent",n.EventType.Debug,b)}}ot.OCSPCacheMissEvent=r;class i extends e{constructor(b){super("OCSPDiskCacheHitEvent",n.EventType.Debug,b)}}ot.OCSPDiskCacheHitEvent=i;class s extends e{constructor(b){super("OCSPCacheUpdateNeededEvent",n.EventType.Debug,b)}}ot.OCSPCacheUpdateNeededEvent=s;class o extends e{constructor(b){super("OCSPMemoryCacheStoreEvent",n.EventType.Debug,b)}}ot.OCSPMemoryCacheStoreEvent=o;class a extends e{constructor(b){super("OCSPDiskCacheStoreEvent",n.EventType.Debug,b)}}ot.OCSPDiskCacheStoreEvent=a;class l extends e{constructor(b){super("OCSPCacheUpdateCompleteEvent",n.EventType.Debug,b)}}ot.OCSPCacheUpdateCompleteEvent=l;class c extends e{constructor(){super("OCSPStapleReceivedEvent",n.EventType.Debug,"")}}ot.OCSPStapleReceivedEvent=c;class u extends e{constructor(b){super("OCSPWSUpgradeStartedEvent",n.EventType.Debug,b)}}ot.OCSPWSUpgradeStartedEvent=u;class h extends e{constructor(b,I){super("OCSPCacheEntryExpiredEvent",n.EventType.Debug,b),this.privExpireTime=I}}ot.OCSPCacheEntryExpiredEvent=h;class m extends e{constructor(b,I,M){super("OCSPCacheEntryNeedsRefreshEvent",n.EventType.Debug,b),this.privExpireTime=M,this.privStartTime=I}}ot.OCSPCacheEntryNeedsRefreshEvent=m;class v extends e{constructor(b,I,M){super("OCSPCacheHitEvent",n.EventType.Debug,b),this.privExpireTime=M,this.privExpireTimeString=new Date(M).toLocaleDateString(),this.privStartTime=I,this.privStartTimeString=new Date(I).toLocaleTimeString()}}ot.OCSPCacheHitEvent=v;class C extends e{constructor(b,I){super("OCSPVerificationFailedEvent",n.EventType.Debug,b),this.privError=I}}ot.OCSPVerificationFailedEvent=C;class T extends e{constructor(b,I){super("OCSPCacheFetchErrorEvent",n.EventType.Debug,b),this.privError=I}}ot.OCSPCacheFetchErrorEvent=T;class E extends e{constructor(b){super("OCSPResponseRetrievedEvent",n.EventType.Debug,b)}}ot.OCSPResponseRetrievedEvent=E;class x extends e{constructor(b,I){super("OCSPCacheUpdateErrorEvent",n.EventType.Debug,b),this.privError=I}}return ot.OCSPCacheUpdateErrorEvent=x,ot}var zf={},vk;function n8(){if(vk)return zf;vk=1,Object.defineProperty(zf,"__esModule",{value:!0}),zf.BackgroundEvent=void 0;const n=He();class e extends n.PlatformEvent{constructor(r){super("BackgroundEvent",n.EventType.Error),this.privError=r}get error(){return this.privError}}return zf.BackgroundEvent=e,zf}var yk;function He(){return yk||(yk=1,(function(n){var e=cc&&cc.__createBinding||(Object.create?(function(i,s,o,a){a===void 0&&(a=o),Object.defineProperty(i,a,{enumerable:!0,get:function(){return s[o]}})}):(function(i,s,o,a){a===void 0&&(a=o),i[a]=s[o]})),t=cc&&cc.__exportStar||function(i,s){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,i,o)};Object.defineProperty(n,"__esModule",{value:!0}),n.TranslationStatus=void 0,t(L5(),n),t(D5(),n),t(vB(),n),t(O5(),n),t(B5(),n),t(yB(),n),t(ro(),n),t(F5(),n),t(SB(),n),t(Xu(),n),t(j5(),n),t(U5(),n),t(z5(),n),t(W5(),n),t(V5(),n),t($5(),n),t(H5(),n),t(Z5(),n),t(q5(),n),t(G5(),n),t(CB(),n),t(jS(),n),t(AB(),n),t(TB(),n),t(K5(),n),t(Y5(),n),t(J5(),n);var r=$P();Object.defineProperty(n,"TranslationStatus",{enumerable:!0,get:function(){return r.TranslationStatus}}),t(X5(),n),t(Q5(),n),t(e8(),n),t(t8(),n),t(n8(),n)})(cc)),cc}var Wf={},Sk;function gi(){if(Sk)return Wf;Sk=1,Object.defineProperty(Wf,"__esModule",{value:!0}),Wf.HeaderNames=void 0;let n=class{};return Wf.HeaderNames=n,n.AuthKey="Ocp-Apim-Subscription-Key",n.Authorization="Authorization",n.SpIDAuthKey="Apim-Subscription-Id",n.ConnectionId="X-ConnectionId",n.ContentType="Content-Type",n.CustomCommandsAppId="X-CommandsAppId",n.Path="Path",n.RequestId="X-RequestId",n.RequestStreamId="X-StreamId",n.RequestTimestamp="X-Timestamp",Wf}var Vf={},Ck;function HP(){if(Ck)return Vf;Ck=1,Object.defineProperty(Vf,"__esModule",{value:!0}),Vf.AuthInfo=void 0;class n{constructor(t,r){this.privHeaderName=t,this.privToken=r}get headerName(){return this.privHeaderName}get token(){return this.privToken}}return Vf.AuthInfo=n,Vf}var Ak;function r8(){if(Ak)return vf;Ak=1,Object.defineProperty(vf,"__esModule",{value:!0}),vf.CognitiveSubscriptionKeyAuthentication=void 0;const n=He(),e=gi(),t=HP();let r=class{constructor(s){if(!s)throw new n.ArgumentNullError("subscriptionKey");this.privAuthInfo=new t.AuthInfo(e.HeaderNames.AuthKey,s)}fetch(s){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(s){return Promise.resolve(this.privAuthInfo)}};return vf.CognitiveSubscriptionKeyAuthentication=r,vf}var $f={},Tk;function i8(){if(Tk)return $f;Tk=1,Object.defineProperty($f,"__esModule",{value:!0}),$f.CognitiveTokenAuthentication=void 0;const n=He(),e=HP(),t=gi();let r=class Uw{constructor(s,o){if(!s)throw new n.ArgumentNullError("fetchCallback");if(!o)throw new n.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=s,this.privFetchOnExpiryCallback=o}fetch(s){return this.privFetchCallback(s).then(o=>new e.AuthInfo(t.HeaderNames.Authorization,o===void 0?void 0:Uw.privTokenPrefix+o))}fetchOnExpiry(s){return this.privFetchOnExpiryCallback(s).then(o=>new e.AuthInfo(t.HeaderNames.Authorization,o===void 0?void 0:Uw.privTokenPrefix+o))}};return $f.CognitiveTokenAuthentication=r,r.privTokenPrefix="Bearer ",$f}var Ex={},Ek;function s8(){return Ek||(Ek=1,Object.defineProperty(Ex,"__esModule",{value:!0})),Ex}var xx={},xk;function o8(){return xk||(xk=1,Object.defineProperty(xx,"__esModule",{value:!0})),xx}var wx={},wk;function ZP(){return wk||(wk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.RecognitionEndedEvent=n.RecognitionCompletionStatus=n.RecognitionStartedEvent=n.ConnectingToServiceEvent=n.ListeningStartedEvent=n.RecognitionTriggeredEvent=n.SpeechRecognitionEvent=void 0;const e=He();class t extends e.PlatformEvent{constructor(u,h,m,v=e.EventType.Info){super(u,v),this.privRequestId=h,this.privSessionId=m}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}n.SpeechRecognitionEvent=t;class r extends t{constructor(u,h,m,v){super("RecognitionTriggeredEvent",u,h),this.privAudioSourceId=m,this.privAudioNodeId=v}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}n.RecognitionTriggeredEvent=r;class i extends t{constructor(u,h,m,v){super("ListeningStartedEvent",u,h),this.privAudioSourceId=m,this.privAudioNodeId=v}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}n.ListeningStartedEvent=i;class s extends t{constructor(u,h,m){super("ConnectingToServiceEvent",u,m),this.privAuthFetchEventid=h}get authFetchEventid(){return this.privAuthFetchEventid}}n.ConnectingToServiceEvent=s;class o extends t{constructor(u,h,m,v,C){super("RecognitionStartedEvent",u,C),this.privAudioSourceId=h,this.privAudioNodeId=m,this.privAuthFetchEventId=v}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}n.RecognitionStartedEvent=o;var a;(function(c){c[c.Success=0]="Success",c[c.AudioSourceError=1]="AudioSourceError",c[c.AudioSourceTimeout=2]="AudioSourceTimeout",c[c.AuthTokenFetchError=3]="AuthTokenFetchError",c[c.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",c[c.UnAuthorized=5]="UnAuthorized",c[c.ConnectTimeout=6]="ConnectTimeout",c[c.ConnectError=7]="ConnectError",c[c.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",c[c.UnknownError=9]="UnknownError"})(a=n.RecognitionCompletionStatus||(n.RecognitionCompletionStatus={}));class l extends t{constructor(u,h,m,v,C,T,E,x){super("RecognitionEndedEvent",u,C,E===a.Success?e.EventType.Info:e.EventType.Error),this.privAudioSourceId=h,this.privAudioNodeId=m,this.privAuthFetchEventId=v,this.privStatus=E,this.privError=x,this.privServiceTag=T}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}}n.RecognitionEndedEvent=l})(wx)),wx}var Hf={},hc={},Yi={};const a8={},l8=Object.freeze(Object.defineProperty({__proto__:null,default:a8},Symbol.toStringTag,{value:"Module"})),_c=Q3(l8);var bx={},bk;function EB(){return bk||(bk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.LogLevel=void 0;const e=He();Object.defineProperty(n,"LogLevel",{enumerable:!0,get:function(){return e.EventType}})})(bx)),bx}var Zf={},Pk;function lt(){if(Pk)return Zf;Pk=1,Object.defineProperty(Zf,"__esModule",{value:!0}),Zf.Contracts=void 0;let n=class $a{static throwIfNullOrUndefined(t,r){if(t==null)throw new Error("throwIfNullOrUndefined:"+r)}static throwIfNull(t,r){if(t===null)throw new Error("throwIfNull:"+r)}static throwIfNullOrWhitespace(t,r){if($a.throwIfNullOrUndefined(t,r),(""+t).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+r)}static throwIfNullOrTooLong(t,r,i){if($a.throwIfNullOrUndefined(t,r),(""+t).length>i)throw new Error("throwIfNullOrTooLong:"+r+" (more than "+i.toString()+" characters)")}static throwIfNullOrTooShort(t,r,i){if($a.throwIfNullOrUndefined(t,r),(""+t).length<i)throw new Error("throwIfNullOrTooShort:"+r+" (less than "+i.toString()+" characters)")}static throwIfDisposed(t){if(t)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(t,r){if($a.throwIfNullOrUndefined(t,r),t.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+r);for(const i of t)$a.throwIfNullOrWhitespace(i,r)}static throwIfFileDoesNotExist(t,r){$a.throwIfNullOrWhitespace(t,r)}static throwIfNotUndefined(t,r){if(t!==void 0)throw new Error("throwIfNotUndefined:"+r)}static throwIfNumberOutOfRange(t,r,i,s){if($a.throwIfNullOrUndefined(t,r),t<i||t>s)throw new Error("throwIfNumberOutOfRange:"+r+" (must be between "+i.toString()+" and "+s.toString()+")")}};return Zf.Contracts=n,Zf}var Rk;function c8(){if(Rk)return Yi;Rk=1;var n=Yi&&Yi.__createBinding||(Object.create?(function(a,l,c,u){u===void 0&&(u=c),Object.defineProperty(a,u,{enumerable:!0,get:function(){return l[c]}})}):(function(a,l,c,u){u===void 0&&(u=c),a[u]=l[c]})),e=Yi&&Yi.__setModuleDefault||(Object.create?(function(a,l){Object.defineProperty(a,"default",{enumerable:!0,value:l})}):function(a,l){a.default=l}),t=Yi&&Yi.__importStar||function(a){if(a&&a.__esModule)return a;var l={};if(a!=null)for(var c in a)c!=="default"&&Object.prototype.hasOwnProperty.call(a,c)&&n(l,a,c);return e(l,a),l};Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.ConsoleLoggingListener=void 0;const r=t(_c),i=EB(),s=lt();let o=class{constructor(l=i.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=l}set logPath(l){s.Contracts.throwIfNullOrUndefined(r.openSync,`
File System access not available`),this.privLogPath=l}set enableConsoleOutput(l){this.privEnableConsoleOutput=l}onEvent(l){if(l.eventType>=this.privLogLevelFilter){const c=this.toString(l);if(this.logCallback&&this.logCallback(c),this.privLogPath&&r.writeFileSync(this.privLogPath,c+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(l.eventType){case i.LogLevel.Debug:console.debug(c);break;case i.LogLevel.Info:console.info(c);break;case i.LogLevel.Warning:console.warn(c);break;case i.LogLevel.Error:console.error(c);break;default:console.log(c);break}}}toString(l){const c=[`${l.eventTime}`,`${l.name}`],u=l;for(const h in u)if(h&&l.hasOwnProperty(h)&&h!=="eventTime"&&h!=="eventType"&&h!=="eventId"&&h!=="name"&&h!=="constructor"){const m=u[h];let v="<NULL>";m!=null&&(typeof m=="number"||typeof m=="string"?v=m.toString():v=JSON.stringify(m)),c.push(`${h}: ${v}`)}return c.join(" | ")}};return Yi.ConsoleLoggingListener=o,Yi}var Px={},Ik;function u8(){return Ik||(Ik=1,Object.defineProperty(Px,"__esModule",{value:!0})),Px}var Rx={},Ix={},_k;function Qu(){return _k||(_k=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.AudioStreamFormatImpl=n.AudioStreamFormat=n.AudioFormatTag=void 0;var e;(function(i){i[i.PCM=1]="PCM",i[i.MuLaw=2]="MuLaw",i[i.Siren=3]="Siren",i[i.MP3=4]="MP3",i[i.SILKSkype=5]="SILKSkype",i[i.OGG_OPUS=6]="OGG_OPUS",i[i.WEBM_OPUS=7]="WEBM_OPUS",i[i.ALaw=8]="ALaw",i[i.FLAC=9]="FLAC",i[i.OPUS=10]="OPUS",i[i.AMR_WB=11]="AMR_WB",i[i.G722=12]="G722"})(e=n.AudioFormatTag||(n.AudioFormatTag={}));class t{static getDefaultInputFormat(){return r.getDefaultInputFormat()}static getWaveFormat(s,o,a,l){return new r(s,o,a,l)}static getWaveFormatPCM(s,o,a){return new r(s,o,a)}}n.AudioStreamFormat=t;class r extends t{constructor(s=16e3,o=16,a=1,l=e.PCM){super();let c=!0;switch(l){case e.PCM:this.formatTag=1;break;case e.ALaw:this.formatTag=6;break;case e.MuLaw:this.formatTag=7;break;default:c=!1}if(this.bitsPerSample=o,this.samplesPerSec=s,this.channels=a,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),c){this.privHeader=new ArrayBuffer(44);const u=new DataView(this.privHeader);this.setString(u,0,"RIFF"),u.setUint32(4,0,!0),this.setString(u,8,"WAVEfmt "),u.setUint32(16,16,!0),u.setUint16(20,this.formatTag,!0),u.setUint16(22,this.channels,!0),u.setUint32(24,this.samplesPerSec,!0),u.setUint32(28,this.avgBytesPerSec,!0),u.setUint16(32,this.channels*(this.bitsPerSample/8),!0),u.setUint16(34,this.bitsPerSample,!0),this.setString(u,36,"data"),u.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new r}static getAudioContext(s){const o=window.AudioContext||window.webkitAudioContext||!1;if(o)return s!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new o({sampleRate:s}):new o;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(s,o,a){for(let l=0;l<a.length;l++)s.setUint8(o+l,a.charCodeAt(l))}}n.AudioStreamFormatImpl=r})(Ix)),Ix}var kk;function d8(){return kk||(kk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.MicAudioSource=n.AudioWorkletSourceURLPropertyName=void 0;const e=Ue(),t=He(),r=Qu();n.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";class i{constructor(o,a,l,c){this.privRecorder=o,this.deviceId=a,this.privStreams={},this.privOutputChunkSize=i.AUDIOFORMAT.avgBytesPerSec/10,this.privId=l||(0,t.createNoDashGuid)(),this.privEvents=new t.EventSource,this.privMediaStream=c||null,this.privIsClosing=!1}get format(){return Promise.resolve(i.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new t.Deferred;try{this.createAudioContext()}catch(l){if(l instanceof Error){const c=l;this.privInitializeDeferral.reject(c.name+": "+c.message)}else this.privInitializeDeferral.reject(l);return this.privInitializeDeferral.promise}const o=window.navigator;let a=o.getUserMedia||o.webkitGetUserMedia||o.mozGetUserMedia||o.msGetUserMedia;if(o.mediaDevices&&(a=(l,c,u)=>{o.mediaDevices.getUserMedia(l).then(c).catch(u)}),a){const l=()=>{this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new t.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):a({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},c=>{this.privMediaStream=c,this.onEvent(new t.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},c=>{const u=`Error occurred during microphone initialization: ${c}`;this.privInitializeDeferral.reject(u),this.onEvent(new t.AudioSourceErrorEvent(this.privId,u))})};this.privContext.state==="suspended"?this.privContext.resume().then(l).catch(c=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${c}`)}):l()}else{const l="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(l),this.onEvent(new t.AudioSourceErrorEvent(l,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(o){return this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,o)),this.listen(o).then(a=>(this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,o)),{detach:async()=>(a.readEnded(),delete this.privStreams[o],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,o)),this.turnOff()),id:()=>o,read:()=>a.read()}))}detach(o){o&&this.privStreams[o]&&(this.privStreams[o].close(),delete this.privStreams[o],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,o)))}async turnOff(){for(const o in this.privStreams)if(o){const a=this.privStreams[o];a&&a.close()}this.onEvent(new t.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(o=>({bitspersample:i.AUDIOFORMAT.bitsPerSample,channelcount:i.AUDIOFORMAT.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:o,samplerate:i.AUDIOFORMAT.samplesPerSec,type:e.type.Microphones}))}setProperty(o,a){if(o===n.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(a);else throw new Error("Property '"+o+"' is not supported on Microphone.")}getMicrophoneLabel(){const o="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(o);this.privMicrophoneLabel=o;const a=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(a===void 0)return Promise.resolve(this.privMicrophoneLabel);const l=new t.Deferred;return navigator.mediaDevices.enumerateDevices().then(c=>{for(const u of c)if(u.deviceId===a){this.privMicrophoneLabel=u.label;break}l.resolve(this.privMicrophoneLabel)},()=>l.resolve(this.privMicrophoneLabel)),l.promise}async listen(o){await this.turnOn();const a=new t.ChunkedArrayBufferStream(this.privOutputChunkSize,o);this.privStreams[o]=a;try{this.privRecorder.record(this.privContext,this.privMediaStream,a)}catch(c){throw this.onEvent(new t.AudioStreamNodeErrorEvent(this.privId,o,c)),c}return a}onEvent(o){this.privEvents.onEvent(o),t.Events.instance.onEvent(o)}createAudioContext(){this.privContext||(this.privContext=r.AudioStreamFormatImpl.getAudioContext(i.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let o=!1;"close"in this.privContext&&(o=!0),o?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}}n.MicAudioSource=i,i.AUDIOFORMAT=r.AudioStreamFormat.getDefaultInputFormat()})(Rx)),Rx}var qf={},Mk;function h8(){if(Mk)return qf;Mk=1,Object.defineProperty(qf,"__esModule",{value:!0}),qf.FileAudioSource=void 0;const n=Ue(),e=He(),t=Qu();let r=class{constructor(s,o,a){this.privStreams={},this.privHeaderEnd=44,this.privId=a||(0,e.createNoDashGuid)(),this.privEvents=new e.EventSource,this.privSource=s,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=s.name:this.privFilename=o||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const s=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new e.AudioSourceErrorEvent(s,"")),Promise.reject(s)}this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(s){this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,s));const o=await this.upload(s);return this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,s)),Promise.resolve({detach:async()=>{o.readEnded(),delete this.privStreams[s],this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,s)),await this.turnOff()},id:()=>s,read:()=>o.read()})}detach(s){s&&this.privStreams[s]&&(this.privStreams[s].close(),delete this.privStreams[s],this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,s)))}turnOff(){for(const s in this.privStreams)if(s){const o=this.privStreams[s];o&&!o.isClosed&&o.close()}return this.onEvent(new e.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(s=>Promise.resolve({bitspersample:s.bitsPerSample,channelcount:s.channels,connectivity:n.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:s.samplesPerSec,type:n.type.File}))}readHeader(){const o=this.privSource.slice(0,4296),a=new e.Deferred,l=c=>{const u=new DataView(c),h=x=>String.fromCharCode(u.getUint8(x),u.getUint8(x+1),u.getUint8(x+2),u.getUint8(x+3));if(h(0)!=="RIFF"){a.reject("Invalid WAV header in file, RIFF was not found");return}if(h(8)!=="WAVE"||h(12)!=="fmt "){a.reject("Invalid WAV header in file, WAVEfmt was not found");return}const m=u.getInt32(16,!0),v=u.getUint16(22,!0),C=u.getUint32(24,!0),T=u.getUint16(34,!0);let E=36+Math.max(m-16,0);for(;h(E)!=="data";E+=2)if(E>4288){a.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=E+8,a.resolve(t.AudioStreamFormat.getWaveFormatPCM(C,T,v))};if(typeof window<"u"&&typeof Blob<"u"&&o instanceof Blob){const c=new FileReader;c.onload=u=>{const h=u.target.result;l(h)},c.readAsArrayBuffer(o)}else{const c=o;l(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength))}return a.promise}async upload(s){const o=a=>{const l=`Error occurred while processing '${this.privFilename}'. ${a}`;throw this.onEvent(new e.AudioStreamNodeErrorEvent(this.privId,s,l)),new Error(l)};try{await this.turnOn();const a=await this.privAudioFormatPromise,l=new e.ChunkedArrayBufferStream(a.avgBytesPerSec/10,s);this.privStreams[s]=l;const c=this.privSource.slice(this.privHeaderEnd),u=h=>{l.isClosed||(l.writeStreamChunk({buffer:h,isEnd:!1,timeReceived:Date.now()}),l.close())};if(typeof window<"u"&&typeof Blob<"u"&&c instanceof Blob){const h=new FileReader;h.onerror=m=>o(m.toString()),h.onload=m=>{const v=m.target.result;u(v)},h.readAsArrayBuffer(c)}else{const h=c;u(h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength))}return l}catch(a){o(a)}}onEvent(s){this.privEvents.onEvent(s),e.Events.instance.onEvent(s)}};return qf.FileAudioSource=r,qf}var Gf={},Nk;function p8(){if(Nk)return Gf;Nk=1,Object.defineProperty(Gf,"__esModule",{value:!0}),Gf.PcmRecorder=void 0;const n=He();class e{constructor(r){this.privStopInputOnRelease=r}record(r,i,s){const a=new n.RiffPcmEncoder(r.sampleRate,16e3),l=r.createMediaStreamSource(i),c=()=>{const h=(()=>{let m=0;try{return r.createScriptProcessor(m,1,1)}catch{m=2048;let C=r.sampleRate;for(;m<16384&&C>=32e3;)m<<=1,C>>=1;return r.createScriptProcessor(m,1,1)}})();h.onaudioprocess=m=>{const v=m.inputBuffer.getChannelData(0);if(s&&!s.isClosed){const C=a.encode(v);C&&s.writeStreamChunk({buffer:C,isEnd:!1,timeReceived:Date.now()})}},l.connect(h),h.connect(r.destination),this.privMediaResources={scriptProcessorNode:h,source:l,stream:i}},u=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(r.audioWorklet&&!u){if(!this.privSpeechProcessorScript){const h=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,m=new Blob([h],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(m)}r.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const h=new AudioWorkletNode(r,"speech-processor");h.port.onmessage=m=>{const v=m.data;if(s&&!s.isClosed){const C=a.encode(v);C&&s.writeStreamChunk({buffer:C,isEnd:!1,timeReceived:Date.now()})}},l.connect(h),h.connect(r.destination),this.privMediaResources={scriptProcessorNode:h,source:l,stream:i}}).catch(()=>{c()})}else try{c()}catch(h){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${h}`)}}releaseMediaResources(r){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(r.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(i=>i.stop()),this.privMediaResources.source=null))}setWorkletUrl(r){this.privSpeechProcessorScript=r}}return Gf.PcmRecorder=e,Gf}var Kf={},Vr={},Lk;function xB(){if(Lk)return Vr;Lk=1;var n=Vr&&Vr.__createBinding||(Object.create?(function(m,v,C,T){T===void 0&&(T=C),Object.defineProperty(m,T,{enumerable:!0,get:function(){return v[C]}})}):(function(m,v,C,T){T===void 0&&(T=C),m[T]=v[C]})),e=Vr&&Vr.__setModuleDefault||(Object.create?(function(m,v){Object.defineProperty(m,"default",{enumerable:!0,value:v})}):function(m,v){m.default=v}),t=Vr&&Vr.__importStar||function(m){if(m&&m.__esModule)return m;var v={};if(m!=null)for(var C in m)C!=="default"&&Object.prototype.hasOwnProperty.call(m,C)&&n(v,m,C);return e(v,m),v},r=Vr&&Vr.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.WebsocketMessageAdapter=void 0;const i=t(_c),s=t(_c),o=r(_c),a=r(_c),l=r(_c),c=gi(),u=He();let h=class zw{constructor(v,C,T,E,x,P){if(!v)throw new u.ArgumentNullError("uri");if(!T)throw new u.ArgumentNullError("messageFormatter");this.proxyInfo=E,this.privConnectionEvents=new u.EventSource,this.privConnectionId=C,this.privMessageFormatter=T,this.privConnectionState=u.ConnectionState.None,this.privUri=v,this.privHeaders=x,this.privEnableCompression=P,this.privHeaders[c.HeaderNames.ConnectionId]=this.privConnectionId,this.privHeaders.connectionId=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===u.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new u.Deferred,this.privCertificateValidatedDeferral=new u.Deferred,this.privConnectionState=u.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!zw.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{let C=new URL(this.privUri).protocol;(C==null?void 0:C.toLocaleLowerCase())==="wss:"?C="https:":(C==null?void 0:C.toLocaleLowerCase())==="ws:"&&(C="http:");const T={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression,followRedirects:C.toLocaleLowerCase()==="https:"};this.privCertificateValidatedDeferral.resolve(),T.agent=this.getAgent(),T.agent.protocol=C,this.privWebsocketClient=new l.default(this.privUri,T),this.privWebsocketClient.on("redirect",E=>{const x=new u.ConnectionRedirectEvent(this.privConnectionId,E,this.privUri,`Getting redirect URL from endpoint ${this.privUri} with redirect URL '${E}'`);u.Events.instance.onEvent(x)})}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new u.Queue,this.privDisconnectDeferral=new u.Deferred,this.privSendMessageQueue=new u.Queue,this.processSendQueue().catch(v=>{u.Events.instance.onEvent(new u.BackgroundEvent(v))})}catch(v){return this.privConnectionEstablishDeferral.resolve(new u.ConnectionOpenResponse(500,v)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new u.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=u.ConnectionState.Connected,this.onEvent(new u.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new u.ConnectionOpenResponse(200,""))},v=>{this.privConnectionEstablishDeferral.reject(v)})},this.privWebsocketClient.onerror=v=>{this.onEvent(new u.ConnectionErrorEvent(this.privConnectionId,v.message,v.type)),this.privLastErrorReceived=v.message},this.privWebsocketClient.onclose=v=>{this.privConnectionState===u.ConnectionState.Connecting?(this.privConnectionState=u.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new u.ConnectionOpenResponse(v.code,v.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=u.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new u.ConnectionClosedEvent(this.privConnectionId,v.code,v.reason))),this.onClose(v.code,v.reason).catch(C=>{u.Events.instance.onEvent(new u.BackgroundEvent(C))})},this.privWebsocketClient.onmessage=v=>{const C=new Date().toISOString();if(this.privConnectionState===u.ConnectionState.Connected){const T=new u.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(T.promise),v.data instanceof ArrayBuffer){const E=new u.RawWebsocketMessage(u.MessageType.Binary,v.data);this.privMessageFormatter.toConnectionMessage(E).then(x=>{this.onEvent(new u.ConnectionMessageReceivedEvent(this.privConnectionId,C,x)),T.resolve(x)},x=>{T.reject(`Invalid binary message format. Error: ${x}`)})}else{const E=new u.RawWebsocketMessage(u.MessageType.Text,v.data);this.privMessageFormatter.toConnectionMessage(E).then(x=>{this.onEvent(new u.ConnectionMessageReceivedEvent(this.privConnectionId,C,x)),T.resolve(x)},x=>{T.reject(`Invalid text message format. Error: ${x}`)})}}},this.privConnectionEstablishDeferral.promise}send(v){if(this.privConnectionState!==u.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${u.ConnectionState[this.privConnectionState]} state`);const C=new u.Deferred,T=new u.Deferred;return this.privSendMessageQueue.enqueueFromPromise(T.promise),this.privMessageFormatter.fromConnectionMessage(v).then(E=>{T.resolve({Message:v,RawWebsocketMessage:E,sendStatusDeferral:C})},E=>{T.reject(`Error formatting the message. ${E}`)}),C.promise}read(){return this.privConnectionState!==u.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(v){if(this.privWebsocketClient)this.privConnectionState!==u.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,v||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(v){try{if(!v)return Promise.resolve();if(this.onEvent(new u.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),v.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(v.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+v.Message.id+" "+new Error().stack);return Promise.resolve()}catch(C){return Promise.reject(`websocket send error: ${C}`)}}async onClose(v,C){const T=`Connection closed. ${v}: ${C}`;this.privConnectionState=u.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},T),await this.privSendMessageQueue.drainAndDispose(E=>{E.sendStatusDeferral.reject(T)},T)}async processSendQueue(){for(;;){const C=await this.privSendMessageQueue.dequeue();if(!C)return;try{await this.sendRawMessage(C),C.sendStatusDeferral.resolve()}catch(T){C.sendStatusDeferral.reject(T)}}}onEvent(v){this.privConnectionEvents.onEvent(v),u.Events.instance.onEvent(v)}getAgent(){const v=new o.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(v.proxyInfo=this.proxyInfo),v}static GetProxyAgent(v){const C={host:v.HostName,port:v.Port};return v.UserName?C.headers={"Proxy-Authentication":"Basic "+Buffer.from(`${v.UserName}:${v.Password===void 0?"":v.Password}`).toString("base64")}:C.headers={},C.headers.requestOCSP="true",new a.default(C)}createConnection(v,C){let T;if(C={...C,requestOCSP:!0,servername:C.host},this.proxyInfo){const x=zw.GetProxyAgent(this.proxyInfo);T=new Promise((P,b)=>{x.callback(v,C,(I,M)=>{I?b(I):P(M)})})}else C.secureEndpoint?T=Promise.resolve(s.connect(C)):T=Promise.resolve(i.connect(C));return T}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};return Vr.WebsocketMessageAdapter=h,h.forceNpmWebSocket=!1,Vr}var Dk;function f8(){if(Dk)return Kf;Dk=1,Object.defineProperty(Kf,"__esModule",{value:!0}),Kf.WebsocketConnection=void 0;const n=He(),e=xB();let t=class{constructor(i,s,o,a,l,c=!1,u){if(this.privIsDisposed=!1,!i)throw new n.ArgumentNullError("uri");if(!a)throw new n.ArgumentNullError("messageFormatter");this.privMessageFormatter=a;let h="",m=0;if(s){for(const v in s)if(v){h+=m===0&&i.indexOf("?")===-1?"?":"&";const C=encodeURIComponent(v);h+=C;let T=s[v];T&&(T=encodeURIComponent(T),h+=`=${T}`),m++}}if(o){for(const v in o)if(v){h+=m===0&&i.indexOf("?")===-1?"?":"&";const C=encodeURIComponent(o[v]);h+=`${v}=${C}`,m++}}this.privUri=i+h,this.privId=u||(0,n.createNoDashGuid)(),this.privConnectionMessageAdapter=new e.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,l,o,c)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(i){return this.privConnectionMessageAdapter.send(i)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};return Kf.WebsocketConnection=t,Kf}var Yf={},Ok;function m8(){if(Ok)return Yf;Ok=1,Object.defineProperty(Yf,"__esModule",{value:!0}),Yf.ReplayableAudioNode=void 0;let n=class{constructor(r,i){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=r,this.privBytesPerSecond=i}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){const r=this.privReplayOffset-this.privBufferStartOffset;let i=Math.round(r*this.privBytesPerSecond*1e-7);i%2!==0&&i++;let s=0;for(;s<this.privBuffers.length&&i>=this.privBuffers[s].chunk.buffer.byteLength;)i-=this.privBuffers[s++].chunk.buffer.byteLength;if(s<this.privBuffers.length){const o=this.privBuffers[s].chunk.buffer.slice(i);return this.privReplayOffset+=o.byteLength/this.privBytesPerSecond*1e7,s===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:o,isEnd:!1,timeReceived:this.privBuffers[s].chunk.timeReceived})}}return this.privAudioNode.read().then(r=>(r&&r.buffer&&this.privBuffers&&(this.privBuffers.push(new e(r,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=r.buffer.byteLength),r))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(r){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=r;const i=r-this.privBufferStartOffset;let s=Math.round(i*this.privBytesPerSecond*1e-7),o=0;for(;o<this.privBuffers.length&&s>=this.privBuffers[o].chunk.buffer.byteLength;)s-=this.privBuffers[o++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(r-s/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(o)}findTimeAtOffset(r){if(r<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const i of this.privBuffers){const s=i.byteOffset/this.privBytesPerSecond*1e7,o=s+i.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(r>=s&&r<=o)return i.chunk.timeReceived}return 0}};Yf.ReplayableAudioNode=n;class e{constructor(r,i,s){this.chunk=r,this.serial=i,this.byteOffset=s}}return Yf}var Jf={},_x={},vo={},Ji={},Bk;function wB(){if(Bk)return Ji;Bk=1;var n=Ji&&Ji.__createBinding||(Object.create?(function(o,a,l,c){c===void 0&&(c=l),Object.defineProperty(o,c,{enumerable:!0,get:function(){return a[l]}})}):(function(o,a,l,c){c===void 0&&(c=l),o[c]=a[l]})),e=Ji&&Ji.__setModuleDefault||(Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a}),t=Ji&&Ji.__importStar||function(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var l in o)l!=="default"&&Object.prototype.hasOwnProperty.call(o,l)&&n(a,o,l);return e(a,o),a};Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.AudioFileWriter=void 0;const r=t(_c),i=lt();let s=class{constructor(a){i.Contracts.throwIfNullOrUndefined(r.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=r.openSync(a,"w")}set format(a){i.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=a;let l=0;this.privAudioFormat.hasHeader&&(l=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=r.createWriteStream("",{fd:this.privFd,start:l,autoClose:!1}))}write(a){i.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(a.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),r.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),r.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};return Ji.AudioFileWriter=s,Ji}var $r={},Fk;function bB(){if(Fk)return $r;Fk=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.PullAudioInputStreamImpl=$r.PullAudioInputStream=$r.PushAudioInputStreamImpl=$r.PushAudioInputStream=$r.AudioInputStream=void 0;const n=Ue(),e=He(),t=Xu(),r=Pe(),i=Qu();let s=class{constructor(){}static createPushStream(h){return o.create(h)}static createPullStream(h,m){return l.create(h,m)}};$r.AudioInputStream=s;class o extends s{static create(h){return new a(h)}}$r.PushAudioInputStream=o;class a extends o{constructor(h){super(),h===void 0?this.privFormat=i.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=h,this.privEvents=new e.EventSource,this.privId=(0,t.createNoDashGuid)(),this.privStream=new e.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(h){this.privStream.writeStreamChunk({buffer:h,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}async attach(h){this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,h)),await this.turnOn();const m=this.privStream;return this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,h)),{detach:async()=>(this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,h)),this.turnOff()),id:()=>h,read:()=>m.read()}}detach(h){this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,h))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:n.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:n.type.Stream})}onEvent(h){this.privEvents.onEvent(h),e.Events.instance.onEvent(h)}toBuffer(h){const m=Buffer.alloc(h.byteLength),v=new Uint8Array(h);for(let C=0;C<m.length;++C)m[C]=v[C];return m}}$r.PushAudioInputStreamImpl=a;class l extends s{constructor(){super()}static create(h,m){return new c(h,m)}}$r.PullAudioInputStream=l;class c extends l{constructor(h,m){super(),m===void 0?this.privFormat=r.AudioStreamFormat.getDefaultInputFormat():this.privFormat=m,this.privEvents=new e.EventSource,this.privId=(0,t.createNoDashGuid)(),this.privCallback=h,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}async attach(h){return this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,h)),await this.turnOn(),this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,h)),{detach:()=>(this.privCallback.close(),this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,h)),this.turnOff()),id:()=>h,read:()=>{let m=0,v;for(;m<this.privBufferSize;){const C=new ArrayBuffer(this.privBufferSize-m),T=this.privCallback.read(C);if(v===void 0?v=C:new Int8Array(v).set(new Int8Array(C),m),T===0)break;m+=T}return Promise.resolve({buffer:v.slice(0,m),isEnd:this.privIsClosed||m===0,timeReceived:Date.now()})}}}detach(h){this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,h))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:n.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:n.type.Stream})}onEvent(h){this.privEvents.onEvent(h),e.Events.instance.onEvent(h)}}return $r.PullAudioInputStreamImpl=c,$r}var Hr={},Xf={},kx={},jk;function PB(){return jk||(jk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SpeechSynthesisOutputFormat=void 0,(function(e){e[e.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",e[e.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",e[e.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",e[e.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",e[e.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",e[e.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",e[e.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",e[e.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",e[e.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",e[e.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",e[e.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",e[e.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",e[e.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",e[e.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",e[e.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",e[e.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",e[e.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",e[e.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",e[e.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",e[e.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",e[e.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",e[e.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",e[e.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",e[e.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",e[e.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",e[e.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",e[e.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",e[e.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",e[e.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",e[e.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",e[e.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",e[e.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",e[e.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",e[e.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",e[e.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",e[e.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",e[e.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",e[e.AmrWb16000Hz=37]="AmrWb16000Hz",e[e.G72216Khz64Kbps=38]="G72216Khz64Kbps"})(n.SpeechSynthesisOutputFormat||(n.SpeechSynthesisOutputFormat={}))})(kx)),kx}var Uk;function US(){if(Uk)return Xf;Uk=1,Object.defineProperty(Xf,"__esModule",{value:!0}),Xf.AudioOutputFormatImpl=void 0;const n=PB(),e=Qu();class t extends e.AudioStreamFormatImpl{constructor(i,s,o,a,l,c,u,h,m){super(o,c,s,i),this.formatTag=i,this.avgBytesPerSec=a,this.blockAlign=l,this.priAudioFormatString=u,this.priRequestAudioFormatString=h,this.priHasHeader=m}static fromSpeechSynthesisOutputFormat(i){return i===void 0?t.getDefaultOutputFormat():t.fromSpeechSynthesisOutputFormatString(t.SpeechSynthesisOutputFormatToString[i])}static fromSpeechSynthesisOutputFormatString(i){switch(i){case"raw-8khz-8bit-mono-mulaw":return new t(e.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,i,i,!1);case"riff-16khz-16kbps-mono-siren":return new t(e.AudioFormatTag.Siren,1,16e3,2e3,40,0,i,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new t(e.AudioFormatTag.Siren,1,16e3,2e3,40,0,i,i,!1);case"audio-16khz-32kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,16e3,4096,2,16,i,i,!1);case"audio-16khz-128kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,16e3,16384,2,16,i,i,!1);case"audio-16khz-64kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,16e3,8192,2,16,i,i,!1);case"audio-24khz-48kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,24e3,6144,2,16,i,i,!1);case"audio-24khz-96kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,24e3,12288,2,16,i,i,!1);case"audio-24khz-160kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,24e3,20480,2,16,i,i,!1);case"raw-16khz-16bit-mono-truesilk":return new t(e.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,i,i,!1);case"riff-8khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,8e3,16e3,2,16,i,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,24e3,48e3,2,16,i,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new t(e.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,i,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,16e3,32e3,2,16,i,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,24e3,48e3,2,16,i,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,8e3,16e3,2,16,i,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new t(e.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,i,i,!1);case"ogg-24khz-16bit-mono-opus":return new t(e.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,i,i,!1);case"raw-48khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,48e3,96e3,2,16,i,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,48e3,96e3,2,16,i,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,48e3,12288,2,16,i,i,!1);case"audio-48khz-192kbitrate-mono-mp3":return new t(e.AudioFormatTag.MP3,1,48e3,24576,2,16,i,i,!1);case"ogg-48khz-16bit-mono-opus":return new t(e.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,i,i,!1);case"webm-16khz-16bit-mono-opus":return new t(e.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,i,i,!1);case"webm-24khz-16bit-mono-opus":return new t(e.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,i,i,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new t(e.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,i,i,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new t(e.AudioFormatTag.OPUS,1,16e3,4e3,2,16,i,i,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new t(e.AudioFormatTag.OPUS,1,24e3,6e3,2,16,i,i,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new t(e.AudioFormatTag.OPUS,1,24e3,3e3,2,16,i,i,!1);case"audio-24khz-16bit-mono-flac":return new t(e.AudioFormatTag.FLAC,1,24e3,24e3,2,16,i,i,!1);case"audio-48khz-16bit-mono-flac":return new t(e.AudioFormatTag.FLAC,1,48e3,3e4,2,16,i,i,!1);case"raw-24khz-16bit-mono-truesilk":return new t(e.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,i,i,!1);case"raw-8khz-8bit-mono-alaw":return new t(e.AudioFormatTag.ALaw,1,8e3,8e3,1,8,i,i,!1);case"riff-8khz-8bit-mono-alaw":return new t(e.AudioFormatTag.ALaw,1,8e3,8e3,1,8,i,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,22050,44100,2,16,i,i,!1);case"riff-22050hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,22050,44100,2,16,i,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,44100,88200,2,16,i,i,!1);case"riff-44100hz-16bit-mono-pcm":return new t(e.AudioFormatTag.PCM,1,44100,88200,2,16,i,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new t(e.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,i,i,!1);case"g722-16khz-64kbps":return new t(e.AudioFormatTag.G722,1,16e3,8e3,2,16,i,i,!1);case"riff-16khz-16bit-mono-pcm":default:return new t(e.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return t.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(i){if(this.priHasHeader){const s=new DataView(this.privHeader);s.setUint32(4,i+this.privHeader.byteLength-8,!0),s.setUint32(40,i,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(i){if(!this.hasHeader)return i;this.updateHeader(i.byteLength);const s=new Uint8Array(i.byteLength+this.header.byteLength);return s.set(new Uint8Array(this.header),0),s.set(new Uint8Array(i),this.header.byteLength),s.buffer}}return Xf.AudioOutputFormatImpl=t,t.SpeechSynthesisOutputFormatToString={[n.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[n.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[n.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[n.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[n.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[n.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[n.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[n.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[n.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[n.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[n.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[n.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[n.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[n.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[n.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[n.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[n.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[n.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[n.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[n.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[n.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"},Xf}var zk;function Ep(){if(zk)return Hr;zk=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.PushAudioOutputStreamImpl=Hr.PushAudioOutputStream=Hr.PullAudioOutputStreamImpl=Hr.PullAudioOutputStream=Hr.AudioOutputStream=void 0;const n=He(),e=lt(),t=US();let r=class{constructor(){}static createPullStream(){return i.create()}};Hr.AudioOutputStream=r;class i extends r{static create(){return new s}}Hr.PullAudioOutputStream=i;class s extends i{constructor(){super(),this.privId=(0,n.createNoDashGuid)(),this.privStream=new n.Stream}set format(c){c==null&&(this.privFormat=t.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=c}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(c){const u=new Int8Array(c);let h=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>c.byteLength)return u.set(this.privLastChunkView.slice(0,c.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(c.byteLength),Promise.resolve(c.byteLength);u.set(this.privLastChunkView),h=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;h<c.byteLength&&!this.privStream.isReadEnded;){const m=await this.privStream.read();if(m!==void 0&&!m.isEnd){let v;m.buffer.byteLength>c.byteLength-h?(v=m.buffer.slice(0,c.byteLength-h),this.privLastChunkView=new Int8Array(m.buffer.slice(c.byteLength-h))):v=m.buffer,u.set(new Int8Array(v),h),h+=v.byteLength}else this.privStream.readEnded()}return h}write(c){e.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:c,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}Hr.PullAudioOutputStreamImpl=s;class o extends r{constructor(){super()}static create(c){return new a(c)}}Hr.PushAudioOutputStream=o;class a extends o{constructor(c){super(),this.privId=(0,n.createNoDashGuid)(),this.privCallback=c}set format(c){}write(c){this.privCallback.write&&this.privCallback.write(c)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}return Hr.PushAudioOutputStreamImpl=a,Hr}var Wk;function g8(){if(Wk)return vo;Wk=1,Object.defineProperty(vo,"__esModule",{value:!0}),vo.AudioOutputConfigImpl=vo.AudioConfigImpl=vo.AudioConfig=void 0;const n=Fr(),e=lt(),t=Pe(),r=wB(),i=bB(),s=Ep();let o=class RB{static fromDefaultMicrophoneInput(){const u=new n.PcmRecorder(!0);return new a(new n.MicAudioSource(u))}static fromMicrophoneInput(u){const h=new n.PcmRecorder(!0);return new a(new n.MicAudioSource(h,u))}static fromWavFileInput(u,h="unnamedBuffer.wav"){return new a(new n.FileAudioSource(u,h))}static fromStreamInput(u){if(u instanceof t.PullAudioInputStreamCallback)return new a(new i.PullAudioInputStreamImpl(u));if(u instanceof t.AudioInputStream)return new a(u);if(typeof MediaStream<"u"&&u instanceof MediaStream){const h=new n.PcmRecorder(!1);return new a(new n.MicAudioSource(h,null,null,u))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new l(new t.SpeakerAudioDestination)}static fromSpeakerOutput(u){if(u===void 0)return RB.fromDefaultSpeakerOutput();if(u instanceof t.SpeakerAudioDestination)return new l(u);throw new Error("Not Supported Type")}static fromAudioFileOutput(u){return new l(new r.AudioFileWriter(u))}static fromStreamOutput(u){if(u instanceof t.PushAudioOutputStreamCallback)return new l(new s.PushAudioOutputStreamImpl(u));if(u instanceof t.PushAudioOutputStream)return new l(u);if(u instanceof t.PullAudioOutputStream)return new l(u);throw new Error("Not Supported Type")}};vo.AudioConfig=o;class a extends o{constructor(u){super(),this.privSource=u}get format(){return this.privSource.format}close(u,h){this.privSource.turnOff().then(()=>{u&&u()},m=>{h&&h(m)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(u){return this.privSource.attach(u)}detach(u){return this.privSource.detach(u)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(u,h){if(e.Contracts.throwIfNull(h,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(u,h);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(u,h){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(u,h);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}vo.AudioConfigImpl=a;class l extends o{constructor(u){super(),this.privDestination=u}set format(u){this.privDestination.format=u}write(u){this.privDestination.write(u)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}return vo.AudioOutputConfigImpl=l,vo}var Mx={},Vk;function v8(){return Vk||(Vk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.CancellationReason=void 0,(function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"})(n.CancellationReason||(n.CancellationReason={}))})(Mx)),Mx}var Qf={},$k;function y8(){if($k)return Qf;$k=1,Object.defineProperty(Qf,"__esModule",{value:!0}),Qf.PullAudioInputStreamCallback=void 0;let n=class{};return Qf.PullAudioInputStreamCallback=n,Qf}var em={},Hk;function S8(){if(Hk)return em;Hk=1,Object.defineProperty(em,"__esModule",{value:!0}),em.PushAudioOutputStreamCallback=void 0;let n=class{};return em.PushAudioOutputStreamCallback=n,em}var tm={},Zk;function C8(){if(Zk)return tm;Zk=1,Object.defineProperty(tm,"__esModule",{value:!0}),tm.KeywordRecognitionModel=void 0;const n=lt();let e=class{constructor(){this.privDisposed=!1}static fromFile(r){throw n.Contracts.throwIfFileDoesNotExist(r,"fileName"),new Error("Not yet implemented.")}static fromStream(r){throw n.Contracts.throwIfNull(r,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};return tm.KeywordRecognitionModel=e,tm}var nm={},qk;function A8(){if(qk)return nm;qk=1,Object.defineProperty(nm,"__esModule",{value:!0}),nm.SessionEventArgs=void 0;let n=class{constructor(t){this.privSessionId=t}get sessionId(){return this.privSessionId}};return nm.SessionEventArgs=n,nm}var rm={},Gk;function T8(){if(Gk)return rm;Gk=1,Object.defineProperty(rm,"__esModule",{value:!0}),rm.RecognitionEventArgs=void 0;const n=Pe();let e=class extends n.SessionEventArgs{constructor(r,i){super(i),this.privOffset=r}get offset(){return this.privOffset}};return rm.RecognitionEventArgs=e,rm}var Nx={},Kk;function E8(){return Kk||(Kk=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.OutputFormat=void 0,(function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"})(n.OutputFormat||(n.OutputFormat={}))})(Nx)),Nx}var im={},Yk;function x8(){if(Yk)return im;Yk=1,Object.defineProperty(im,"__esModule",{value:!0}),im.RecognitionResult=void 0;let n=class{constructor(t,r,i,s,o,a,l,c,u,h){this.privResultId=t,this.privReason=r,this.privText=i,this.privDuration=s,this.privOffset=o,this.privLanguage=a,this.privLanguageDetectionConfidence=l,this.privErrorDetails=c,this.privJson=u,this.privProperties=h}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};return im.RecognitionResult=n,im}var sm={},Jk;function w8(){if(Jk)return sm;Jk=1,Object.defineProperty(sm,"__esModule",{value:!0}),sm.SpeechRecognitionResult=void 0;const n=Pe();let e=class extends n.RecognitionResult{constructor(r,i,s,o,a,l,c,u,h,m,v){super(r,i,s,o,a,l,c,h,m,v),this.privSpeakerId=u}get speakerId(){return this.privSpeakerId}};return sm.SpeechRecognitionResult=e,sm}var yo={},Xk;function b8(){if(Xk)return yo;Xk=1,Object.defineProperty(yo,"__esModule",{value:!0}),yo.MeetingTranscriptionEventArgs=yo.ConversationTranscriptionEventArgs=yo.SpeechRecognitionEventArgs=void 0;const n=Pe();let e=class extends n.RecognitionEventArgs{constructor(s,o,a){super(o,a),this.privResult=s}get result(){return this.privResult}};yo.SpeechRecognitionEventArgs=e;class t extends n.RecognitionEventArgs{constructor(s,o,a){super(o,a),this.privResult=s}get result(){return this.privResult}}yo.ConversationTranscriptionEventArgs=t;class r extends e{}return yo.MeetingTranscriptionEventArgs=r,yo}var om={},am={},Qk;function zS(){if(Qk)return am;Qk=1,Object.defineProperty(am,"__esModule",{value:!0}),am.CancellationEventArgsBase=void 0;const n=Pe();let e=class extends n.RecognitionEventArgs{constructor(r,i,s,o,a){super(o,a),this.privReason=r,this.privErrorDetails=i,this.privErrorCode=s}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return am.CancellationEventArgsBase=e,am}var eM;function P8(){if(eM)return om;eM=1,Object.defineProperty(om,"__esModule",{value:!0}),om.SpeechRecognitionCanceledEventArgs=void 0;const n=zS();let e=class extends n.CancellationEventArgsBase{};return om.SpeechRecognitionCanceledEventArgs=e,om}var lm={},tM;function R8(){if(tM)return lm;tM=1,Object.defineProperty(lm,"__esModule",{value:!0}),lm.TranslationRecognitionEventArgs=void 0;const n=Pe();let e=class extends n.RecognitionEventArgs{constructor(r,i,s){super(i,s),this.privResult=r}get result(){return this.privResult}};return lm.TranslationRecognitionEventArgs=e,lm}var cm={},nM;function I8(){if(nM)return cm;nM=1,Object.defineProperty(cm,"__esModule",{value:!0}),cm.TranslationSynthesisEventArgs=void 0;const n=Pe();let e=class extends n.SessionEventArgs{constructor(r,i){super(i),this.privResult=r}get result(){return this.privResult}};return cm.TranslationSynthesisEventArgs=e,cm}var um={},rM;function _B(){if(rM)return um;rM=1,Object.defineProperty(um,"__esModule",{value:!0}),um.TranslationRecognitionResult=void 0;const n=Pe();let e=class IB extends n.SpeechRecognitionResult{constructor(r,i,s,o,a,l,c,u,h,m,v){super(i,s,o,a,l,c,u,void 0,h,m,v),this.privTranslations=r}static fromSpeechRecognitionResult(r){return new IB(void 0,r.resultId,r.reason,r.text,r.duration,r.offset,r.language,r.languageDetectionConfidence,r.errorDetails,r.json,r.properties)}get translations(){return this.privTranslations}};return um.TranslationRecognitionResult=e,um}var dm={},iM;function _8(){if(iM)return dm;iM=1,Object.defineProperty(dm,"__esModule",{value:!0}),dm.TranslationSynthesisResult=void 0;let n=class{constructor(t,r){this.privReason=t,this.privAudio=r}get audio(){return this.privAudio}get reason(){return this.privReason}};return dm.TranslationSynthesisResult=n,dm}var Lx={},sM;function k8(){return sM||(sM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ResultReason=void 0,(function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizedKeyword=4]="RecognizedKeyword",e[e.TranslatingSpeech=5]="TranslatingSpeech",e[e.TranslatedSpeech=6]="TranslatedSpeech",e[e.SynthesizingAudio=7]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=8]="SynthesizingAudioCompleted",e[e.SynthesizingAudioStarted=9]="SynthesizingAudioStarted",e[e.VoicesListRetrieved=10]="VoicesListRetrieved",e[e.TranslatingParticipantSpeech=11]="TranslatingParticipantSpeech",e[e.TranslatedParticipantSpeech=12]="TranslatedParticipantSpeech",e[e.TranslatedInstantMessage=13]="TranslatedInstantMessage",e[e.TranslatedParticipantInstantMessage=14]="TranslatedParticipantInstantMessage"})(n.ResultReason||(n.ResultReason={}))})(Lx)),Lx}var pc={},oM;function M8(){if(oM)return pc;oM=1,Object.defineProperty(pc,"__esModule",{value:!0}),pc.SpeechConfigImpl=pc.SpeechConfig=void 0;const n=Ue(),e=lt(),t=Pe();let r=class{constructor(){}static fromSubscription(o,a){e.Contracts.throwIfNullOrWhitespace(o,"subscriptionKey"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),l}static fromEndpoint(o,a){e.Contracts.throwIfNull(o,"endpoint");const l=typeof a=="string"&&a.trim().length>0,c=typeof a=="object"&&a!==null&&typeof a.getToken=="function",u=typeof a=="object"&&a!==null&&typeof a.key=="string";if(a!==void 0&&!l&&!c&&!u)throw new Error("Invalid 'auth' parameter: expected a non-empty API key string, a TokenCredential, or a KeyCredential.");let h;return typeof a=="string"?(h=new i,h.setProperty(t.PropertyId.SpeechServiceConnection_Key,a)):typeof a=="object"&&typeof a.getToken=="function"?h=new i(a):typeof a=="object"&&typeof a.key=="string"?(h=new i,h.setProperty(t.PropertyId.SpeechServiceConnection_Key,a.key)):h=new i,h.setProperty(t.PropertyId.SpeechServiceConnection_Endpoint,o.href),h}static fromHost(o,a){e.Contracts.throwIfNull(o,"hostName");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Host,o.protocol+"//"+o.hostname+(o.port===""?"":":"+o.port)),l.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),a!==void 0&&l.setProperty(t.PropertyId.SpeechServiceConnection_Key,a),l}static fromAuthorizationToken(o,a){e.Contracts.throwIfNull(o,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l.authorizationToken=o,l}close(){}};pc.SpeechConfig=r;class i extends r{constructor(o){super(),this.privProperties=new t.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=t.OutputFormat.Simple,this.privTokenCredential=o}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o)}get speechRecognitionLanguage(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,o)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,o)}get outputFormat(){return t.OutputFormat[this.privProperties.getProperty(n.OutputFormatPropertyName,void 0)]}set outputFormat(o){this.privProperties.setProperty(n.OutputFormatPropertyName,t.OutputFormat[o])}get endpointId(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_EndpointId,o)}get tokenCredential(){return this.privTokenCredential}setProperty(o,a){e.Contracts.throwIfNull(a,"value"),this.privProperties.setProperty(o,a)}getProperty(o,a){return this.privProperties.getProperty(o,a)}setProxy(o,a,l,c){this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyHostName],o),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPort],a),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyUserName],l),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPassword],c)}setServiceProperty(o,a){const l=JSON.parse(this.privProperties.getProperty(n.ServicePropertiesPropertyName,"{}"));l[o]=a,this.privProperties.setProperty(n.ServicePropertiesPropertyName,JSON.stringify(l))}setProfanity(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceResponse_ProfanityOption,t.ProfanityOption[o])}enableAudioLogging(){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true"),this.privProperties.setProperty(n.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Detailed])}enableDictation(){this.privProperties.setProperty(n.ForceDictationPropertyName,"true")}clone(){const o=new i(this.tokenCredential);return o.privProperties=this.privProperties.clone(),o}get speechSynthesisLanguage(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage,o)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthVoice,o)}get speechSynthesisOutputFormat(){return t.SpeechSynthesisOutputFormat[this.privProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(o){this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,t.SpeechSynthesisOutputFormat[o])}}return pc.SpeechConfigImpl=i,pc}var fc={},aM;function N8(){if(aM)return fc;aM=1,Object.defineProperty(fc,"__esModule",{value:!0}),fc.SpeechTranslationConfigImpl=fc.SpeechTranslationConfig=void 0;const n=Ue(),e=lt(),t=Pe();let r=class extends t.SpeechConfig{constructor(){super()}static fromSubscription(o,a){e.Contracts.throwIfNullOrWhitespace(o,"subscriptionKey"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.properties.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),l.properties.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}static fromAuthorizationToken(o,a){e.Contracts.throwIfNullOrWhitespace(o,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(a,"region");const l=new i;return l.properties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o),l.properties.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}static fromHost(o,a){e.Contracts.throwIfNull(o,"hostName");const l=new i;return l.setProperty(t.PropertyId.SpeechServiceConnection_Host,o.protocol+"//"+o.hostname+(o.port===""?"":":"+o.port)),a!==void 0&&l.setProperty(t.PropertyId.SpeechServiceConnection_Key,a),l}static fromEndpoint(o,a){e.Contracts.throwIfNull(o,"endpoint");const l=typeof a=="string"&&a.trim().length>0,c=typeof a=="object"&&a!==null&&typeof a.getToken=="function",u=typeof a=="object"&&a!==null&&typeof a.key=="string";if(a!==void 0&&!l&&!c&&!u)throw new Error("Invalid 'auth' parameter: expected a non-empty API key string, a TokenCredential, or a KeyCredential.");let h;return typeof a=="string"?(h=new i,h.setProperty(t.PropertyId.SpeechServiceConnection_Key,a)):typeof a=="object"&&typeof a.getToken=="function"?h=new i(a):typeof a=="object"&&typeof a.key=="string"?(h=new i,h.setProperty(t.PropertyId.SpeechServiceConnection_Key,a.key)):h=new i,h.setProperty(t.PropertyId.SpeechServiceConnection_Endpoint,o.href),h}};fc.SpeechTranslationConfig=r;class i extends r{constructor(o){super(),this.privSpeechProperties=new t.PropertyCollection,this.outputFormat=t.OutputFormat.Simple,this.privTokenCredential=o}set authorizationToken(o){e.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o)}set speechRecognitionLanguage(o){e.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,o)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return t.OutputFormat[this.privSpeechProperties.getProperty(n.OutputFormatPropertyName,void 0)]}set outputFormat(o){this.privSpeechProperties.setProperty(n.OutputFormatPropertyName,t.OutputFormat[o])}get endpointId(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_EndpointId,o)}addTargetLanguage(o){e.Contracts.throwIfNullOrWhitespace(o,"value");const a=this.targetLanguages;a.includes(o)||(a.push(o),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,a.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(o){e.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,o)}get region(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_Region)}get tokenCredential(){return this.privTokenCredential}setProxy(o,a,l,c){this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyHostName],o),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPort],a),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyUserName],l),this.setProperty(t.PropertyId[t.PropertyId.SpeechServiceConnection_ProxyPassword],c)}getProperty(o,a){return this.privSpeechProperties.getProperty(o,a)}setProperty(o,a){this.privSpeechProperties.setProperty(o,a)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(o,a){const l=JSON.parse(this.privSpeechProperties.getProperty(n.ServicePropertiesPropertyName,"{}"));l[o]=a,this.privSpeechProperties.setProperty(n.ServicePropertiesPropertyName,JSON.stringify(l))}setProfanity(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceResponse_ProfanityOption,t.ProfanityOption[o])}enableAudioLogging(){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(n.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthLanguage,o)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthVoice,o)}get speechSynthesisOutputFormat(){return t.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(o){this.privSpeechProperties.setProperty(t.PropertyId.SpeechServiceConnection_SynthOutputFormat,t.SpeechSynthesisOutputFormat[o])}}return fc.SpeechTranslationConfigImpl=i,fc}var hm={},lM;function MB(){if(lM)return hm;lM=1,Object.defineProperty(hm,"__esModule",{value:!0}),hm.PropertyCollection=void 0;const n=Pe();let e=class kB{constructor(){this.privKeys=[],this.privValues=[]}getProperty(r,i){let s;typeof r=="string"?s=r:s=n.PropertyId[r];for(let o=0;o<this.privKeys.length;o++)if(this.privKeys[o]===s)return this.privValues[o];if(i!==void 0)return String(i)}setProperty(r,i){let s;typeof r=="string"?s=r:s=n.PropertyId[r];for(let o=0;o<this.privKeys.length;o++)if(this.privKeys[o]===s){this.privValues[o]=i;return}this.privKeys.push(s),this.privValues.push(i)}clone(){const r=new kB;for(let i=0;i<this.privKeys.length;i++)r.privKeys.push(this.privKeys[i]),r.privValues.push(this.privValues[i]);return r}mergeTo(r){this.privKeys.forEach(i=>{if(r.getProperty(i,void 0)===void 0){const s=this.getProperty(i);r.setProperty(i,s)}})}get keys(){return this.privKeys}};return hm.PropertyCollection=e,hm}var Dx={},cM;function qP(){return cM||(cM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.PropertyId=void 0,(function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_TranslationCategoryId=9]="SpeechServiceConnection_TranslationCategoryId",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",e[e.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",e[e.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",e[e.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=25]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",e[e.SpeechServiceConnection_Url=28]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=29]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=30]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.Speech_SegmentationSilenceTimeoutMs=31]="Speech_SegmentationSilenceTimeoutMs",e[e.Speech_SegmentationMaximumTimeMs=32]="Speech_SegmentationMaximumTimeMs",e[e.Speech_SegmentationStrategy=33]="Speech_SegmentationStrategy",e[e.Speech_StartEventSensitivity=34]="Speech_StartEventSensitivity",e[e.SpeechServiceConnection_EnableAudioLogging=35]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceConnection_LanguageIdMode=36]="SpeechServiceConnection_LanguageIdMode",e[e.SpeechServiceConnection_RecognitionEndpointVersion=37]="SpeechServiceConnection_RecognitionEndpointVersion",e[e.SpeechServiceResponse_ProfanityOption=38]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=39]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=40]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=41]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=42]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=43]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.SpeechServiceResponse_RequestWordBoundary=44]="SpeechServiceResponse_RequestWordBoundary",e[e.SpeechServiceResponse_RequestPunctuationBoundary=45]="SpeechServiceResponse_RequestPunctuationBoundary",e[e.SpeechServiceResponse_RequestSentenceBoundary=46]="SpeechServiceResponse_RequestSentenceBoundary",e[e.SpeechServiceResponse_DiarizeIntermediateResults=47]="SpeechServiceResponse_DiarizeIntermediateResults",e[e.Conversation_ApplicationId=48]="Conversation_ApplicationId",e[e.Conversation_DialogType=49]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=50]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=51]="Conversation_From_Id",e[e.Conversation_Conversation_Id=52]="Conversation_Conversation_Id",e[e.Conversation_Custom_Voice_Deployment_Ids=53]="Conversation_Custom_Voice_Deployment_Ids",e[e.Conversation_Speech_Activity_Template=54]="Conversation_Speech_Activity_Template",e[e.Conversation_Request_Bot_Status_Messages=55]="Conversation_Request_Bot_Status_Messages",e[e.Conversation_Agent_Connection_Id=56]="Conversation_Agent_Connection_Id",e[e.SpeechServiceConnection_Host=57]="SpeechServiceConnection_Host",e[e.ConversationTranslator_Host=58]="ConversationTranslator_Host",e[e.ConversationTranslator_Name=59]="ConversationTranslator_Name",e[e.ConversationTranslator_CorrelationId=60]="ConversationTranslator_CorrelationId",e[e.ConversationTranslator_Token=61]="ConversationTranslator_Token",e[e.PronunciationAssessment_ReferenceText=62]="PronunciationAssessment_ReferenceText",e[e.PronunciationAssessment_GradingSystem=63]="PronunciationAssessment_GradingSystem",e[e.PronunciationAssessment_Granularity=64]="PronunciationAssessment_Granularity",e[e.PronunciationAssessment_EnableMiscue=65]="PronunciationAssessment_EnableMiscue",e[e.PronunciationAssessment_Json=66]="PronunciationAssessment_Json",e[e.PronunciationAssessment_Params=67]="PronunciationAssessment_Params",e[e.WebWorkerLoadType=68]="WebWorkerLoadType",e[e.TalkingAvatarService_WebRTC_SDP=69]="TalkingAvatarService_WebRTC_SDP"})(n.PropertyId||(n.PropertyId={}))})(Dx)),Dx}var pm={},uM;function L8(){if(uM)return pm;uM=1,Object.defineProperty(pm,"__esModule",{value:!0}),pm.Recognizer=void 0;const n=Ue(),e=He(),t=lt(),r=Pe();let i=class NB{constructor(o,a,l,c){this.audioConfig=o!==void 0?o:r.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=a.clone(),this.privConnectionFactory=l,this.tokenCredential=c,this.implCommonRecognizerSetup()}close(o,a){t.Contracts.throwIfDisposed(this.privDisposed),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),o,a)}get internalData(){return this.privReco}async dispose(o){this.privDisposed||(this.privDisposed=!0,o&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return n.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(o){n.ServiceRecognizerBase.telemetryDataEnabled=o}implCommonRecognizerSetup(){let o=typeof window<"u"?"Browser":"Node",a="unknown",l="unknown";typeof navigator<"u"&&(o=o+"/"+navigator.platform,a=navigator.userAgent,l=navigator.appVersion);const c=this.createRecognizerConfig(new n.SpeechServiceConfig(new n.Context(new n.OS(o,a,l))));this.privReco=this.createServiceRecognizer(NB.getAuth(this.privProperties,this.tokenCredential),this.privConnectionFactory,this.audioConfig,c)}async recognizeOnceAsyncImpl(o){t.Contracts.throwIfDisposed(this.privDisposed);const a=new e.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(o,a.resolve,a.reject);const l=await a.promise;return await this.implRecognizerStop(),l}async startContinuousRecognitionAsyncImpl(o){t.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(o,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){t.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuth(o,a){const l=o.getProperty(r.PropertyId.SpeechServiceConnection_Key,void 0);return l&&l!==""?new n.CognitiveSubscriptionKeyAuthentication(l):a?new n.CognitiveTokenAuthentication(async()=>{try{const c=await a.getToken("https://cognitiveservices.azure.com/.default");return(c==null?void 0:c.token)??""}catch(c){throw c}},async()=>{try{const c=await a.getToken("https://cognitiveservices.azure.com/.default");return(c==null?void 0:c.token)??""}catch(c){throw c}}):new n.CognitiveTokenAuthentication(()=>{const c=o.getProperty(r.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(c)},()=>{const c=o.getProperty(r.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(c)})}};return pm.Recognizer=i,pm}var fm={},Ox={},dM;function vs(){return dM||(dM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SpeechStartEventSensitivity=n.RecognitionMode=void 0,(function(e){e.Interactive="Interactive",e.Dictation="Dictation",e.Conversation="Conversation",e.None="None"})(n.RecognitionMode||(n.RecognitionMode={})),(function(e){e.Low="low",e.Medium="medium",e.High="high"})(n.SpeechStartEventSensitivity||(n.SpeechStartEventSensitivity={}))})(Ox)),Ox}var hM;function D8(){if(hM)return fm;hM=1,Object.defineProperty(fm,"__esModule",{value:!0}),fm.SpeechRecognizer=void 0;const n=Ue(),e=vs(),t=He(),r=lt(),i=Pe();let s=class LB extends i.Recognizer{constructor(a,l){const c=a;r.Contracts.throwIfNull(c,"speechConfig"),r.Contracts.throwIfNullOrWhitespace(c.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),super(l,c.properties,new n.SpeechConnectionFactory,a.tokenCredential),this.privDisposedRecognizer=!1}static FromConfig(a,l,c){const u=a;return l.properties.mergeTo(u.properties),new LB(a,c)}get endpointId(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){r.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,a)}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple])===i.OutputFormat[i.OutputFormat.Simple]?i.OutputFormat.Simple:i.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(e.RecognitionMode.Interactive),a,l)}startContinuousRecognitionAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(this.properties.getProperty(n.ForceDictationPropertyName,void 0)===void 0?e.RecognitionMode.Conversation:e.RecognitionMode.Dictation),a,l)}stopContinuousRecognitionAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),a,l)}startKeywordRecognitionAsync(a,l,c){r.Contracts.throwIfNull(a,"model"),c&&c("Not yet implemented.")}stopKeywordRecognitionAsync(a){a&&a()}close(a,l){r.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),a,l)}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new n.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,l,c,u){const h=c;return new n.SpeechServiceRecognizer(a,l,h,u,this)}};return fm.SpeechRecognizer=s,fm}var mm={},gm={},mc={},pM;function DB(){if(pM)return mc;pM=1,Object.defineProperty(mc,"__esModule",{value:!0}),mc.ConnectionMessageImpl=mc.ConnectionMessage=void 0;const n=gi(),e=He(),t=MB(),r=qP();let i=class{};mc.ConnectionMessage=i;class s{constructor(a){this.privConnectionMessage=a,this.privProperties=new t.PropertyCollection,this.privConnectionMessage.headers[n.HeaderNames.ConnectionId]&&this.privProperties.setProperty(r.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[n.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(l=>{this.privProperties.setProperty(l,this.privConnectionMessage.headers[l])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(a=>a.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===e.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===e.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}return mc.ConnectionMessageImpl=s,mc}var fM;function OB(){if(fM)return gm;fM=1,Object.defineProperty(gm,"__esModule",{value:!0}),gm.Connection=void 0;const n=Ue(),e=He(),t=DB(),r=lt(),i=Pe();let s=class Ww{static fromRecognizer(a){const l=a.internalData,c=new Ww;return c.privInternalData=l,c.setupEvents(),c}static fromSynthesizer(a){const l=a.internalData,c=new Ww;return c.privInternalData=l,c.setupEvents(),c}openConnection(a,l){(0,e.marshalPromiseToCallbacks)(this.privInternalData.connect(),a,l)}closeConnection(a,l){if(this.privInternalData instanceof n.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");(0,e.marshalPromiseToCallbacks)(this.privInternalData.disconnect(),a,l)}setMessageProperty(a,l,c){if(r.Contracts.throwIfNullOrWhitespace(l,"propertyName"),this.privInternalData instanceof n.ServiceRecognizerBase){if(a.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");{const u=this.privInternalData.speechContext.getContext();u[l]=c}}else if(this.privInternalData instanceof n.SynthesisAdapterBase){if(a.toLowerCase()!=="speech.config"&&a.toLowerCase()!=="synthesis.context")throw new Error("Only speech.config and synthesis.context message paths are currently supported for synthesizer");if(a.toLowerCase()==="speech.config"){if(l.toLowerCase()!=="context")throw new Error("Only context property is currently supported for speech.config message path for synthesizer");this.privInternalData.synthesizerConfig.setContextFromJson(c)}else this.privInternalData.synthesisContext.setSection(l,c)}}sendMessageAsync(a,l,c,u){(0,e.marshalPromiseToCallbacks)(this.privInternalData.sendNetworkMessage(a,l),c,u)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(a=>{a.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new i.ConnectionEventArgs(a.connectionId)):a.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new i.ConnectionEventArgs(a.connectionId)):a.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new i.ConnectionMessageEventArgs(new t.ConnectionMessageImpl(a.message))):a.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new i.ConnectionMessageEventArgs(new t.ConnectionMessageImpl(a.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(a=>{this.receivedServiceMessage&&this.receivedServiceMessage(new i.ServiceEventArgs(a.jsonString,a.name))})}};return gm.Connection=s,gm}var mM;function O8(){if(mM)return mm;mM=1,Object.defineProperty(mm,"__esModule",{value:!0}),mm.TranslationRecognizer=void 0;const n=Ue(),e=vs(),t=He(),r=OB(),i=lt(),s=Pe();let o=class BB extends s.Recognizer{constructor(l,c,u){const h=l;i.Contracts.throwIfNull(h,"speechConfig"),super(c,h.properties,u||new n.TranslationConnectionFactory,l.tokenCredential),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice),s.PropertyId[s.PropertyId.SpeechServiceConnection_TranslationVoice]),i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages),s.PropertyId[s.PropertyId.SpeechServiceConnection_TranslationToLanguages]),i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage),s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(l,c,u){const h=l;return c.properties.mergeTo(h.properties),c.properties.getProperty(s.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)===n.AutoDetectSourceLanguagesOpenRangeOptionName&&h.properties.setProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),new BB(l,u)}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(l){this.properties.setProperty(s.PropertyId.SpeechServiceAuthorization_Token,l)}recognizeOnceAsync(l,c){i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,t.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(e.RecognitionMode.Interactive),l,c)}startContinuousRecognitionAsync(l,c){(0,t.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(e.RecognitionMode.Conversation),l,c)}stopContinuousRecognitionAsync(l,c){(0,t.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),l,c)}removeTargetLanguage(l){if(i.Contracts.throwIfNullOrUndefined(l,"language to be removed"),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){const c=this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),u=c.indexOf(l);u>-1&&(c.splice(u,1),this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,c.join(",")),this.updateLanguages(c))}}addTargetLanguage(l){i.Contracts.throwIfNullOrUndefined(l,"language to be added");let c=[];this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(c=this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),c.includes(l)||(c.push(l),this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,c.join(",")))):(this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,l),c=[l]),this.updateLanguages(c)}close(l,c){i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),l,c)}onConnection(){}async dispose(l){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,l&&(await this.implRecognizerStop(),await super.dispose(l)))}createRecognizerConfig(l){return new n.RecognizerConfig(l,this.privProperties)}createServiceRecognizer(l,c,u,h){const m=u;return new n.TranslationServiceRecognizer(l,c,m,h,this)}updateLanguages(l){const c=r.Connection.fromRecognizer(this);c&&(c.setMessageProperty("speech.context","translationcontext",{to:l}),c.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:l})))}};return mm.TranslationRecognizer=o,mm}var vm={},gM;function B8(){if(gM)return vm;gM=1,Object.defineProperty(vm,"__esModule",{value:!0}),vm.Translations=void 0;const n=Pe();let e=class{constructor(){this.privMap=new n.PropertyCollection}get languages(){return this.privMap.keys}get(r,i){return this.privMap.getProperty(r,i)}set(r,i){this.privMap.setProperty(r,i)}};return vm.Translations=e,vm}var Bx={},vM;function F8(){return vM||(vM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.NoMatchReason=void 0,(function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"})(n.NoMatchReason||(n.NoMatchReason={}))})(Bx)),Bx}var ym={},yM;function j8(){if(yM)return ym;yM=1,Object.defineProperty(ym,"__esModule",{value:!0}),ym.NoMatchDetails=void 0;const n=Ue(),e=Pe();let t=class FB{constructor(i){this.privReason=i}static fromResult(i){const s=n.SimpleSpeechPhrase.fromJSON(i.json,0);let o=e.NoMatchReason.NotRecognized;switch(s.RecognitionStatus){case n.RecognitionStatus.BabbleTimeout:o=e.NoMatchReason.InitialBabbleTimeout;break;case n.RecognitionStatus.InitialSilenceTimeout:o=e.NoMatchReason.InitialSilenceTimeout;break;default:o=e.NoMatchReason.NotRecognized;break}return new FB(o)}get reason(){return this.privReason}};return ym.NoMatchDetails=t,ym}var Sm={},SM;function U8(){if(SM)return Sm;SM=1,Object.defineProperty(Sm,"__esModule",{value:!0}),Sm.TranslationRecognitionCanceledEventArgs=void 0;let n=class{constructor(t,r,i,s,o){this.privCancelReason=r,this.privErrorDetails=i,this.privResult=o,this.privSessionId=t,this.privErrorCode=s}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return Sm.TranslationRecognitionCanceledEventArgs=n,Sm}var Cm={},CM;function jB(){if(CM)return Cm;CM=1,Object.defineProperty(Cm,"__esModule",{value:!0}),Cm.CancellationDetailsBase=void 0;let n=class{constructor(t,r,i){this.privReason=t,this.privErrorDetails=r,this.privErrorCode=i}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};return Cm.CancellationDetailsBase=n,Cm}var Am={},AM;function z8(){if(AM)return Am;AM=1,Object.defineProperty(Am,"__esModule",{value:!0}),Am.CancellationDetails=void 0;const n=Ue(),e=jB(),t=Pe();let r=class UB extends e.CancellationDetailsBase{constructor(s,o,a){super(s,o,a)}static fromResult(s){let o=t.CancellationReason.Error,a=t.CancellationErrorCode.NoError;if(s instanceof t.RecognitionResult&&s.json){const l=n.SimpleSpeechPhrase.fromJSON(s.json,0);o=n.EnumTranslation.implTranslateCancelResult(l.RecognitionStatus)}return s.properties&&(a=t.CancellationErrorCode[s.properties.getProperty(n.CancellationErrorCodePropertyName,t.CancellationErrorCode[t.CancellationErrorCode.NoError])]),new UB(o,s.errorDetails||n.EnumTranslation.implTranslateErrorDetails(a),a)}};return Am.CancellationDetails=r,Am}var Fx={},TM;function W8(){return TM||(TM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.CancellationErrorCode=void 0,(function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError",e[e.Forbidden=8]="Forbidden"})(n.CancellationErrorCode||(n.CancellationErrorCode={}))})(Fx)),Fx}var Tm={},EM;function V8(){if(EM)return Tm;EM=1,Object.defineProperty(Tm,"__esModule",{value:!0}),Tm.ConnectionEventArgs=void 0;const n=Pe();let e=class extends n.SessionEventArgs{};return Tm.ConnectionEventArgs=e,Tm}var Em={},xM;function $8(){if(xM)return Em;xM=1,Object.defineProperty(Em,"__esModule",{value:!0}),Em.ServiceEventArgs=void 0;const n=Pe();let e=class extends n.SessionEventArgs{constructor(r,i,s){super(s),this.privJsonResult=r,this.privEventName=i}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};return Em.ServiceEventArgs=e,Em}var xm={},wM;function H8(){if(wM)return xm;wM=1,Object.defineProperty(xm,"__esModule",{value:!0}),xm.PhraseListGrammar=void 0;const n=lt();let e=class zB{constructor(r){this.privGrammerBuilder=r.dynamicGrammar}static fromRecognizer(r){const i=r.internalData;return new zB(i)}addPhrase(r){this.privGrammerBuilder.addPhrase(r)}addPhrases(r){this.privGrammerBuilder.addPhrase(r)}clear(){this.privGrammerBuilder.clearPhrases()}setWeight(r){n.Contracts.throwIfNumberOutOfRange(r,"weight",0,2),this.privGrammerBuilder.setWeight(r)}};return xm.PhraseListGrammar=e,xm}var gc={},bM;function GP(){if(bM)return gc;bM=1,Object.defineProperty(gc,"__esModule",{value:!0}),gc.DialogServiceConfigImpl=gc.DialogServiceConfig=void 0;const n=lt(),e=Pe();let t=class{constructor(){}set applicationId(s){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};gc.DialogServiceConfig=t;class r extends t{constructor(){super(),this.privSpeechConfig=new e.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(s){n.Contracts.throwIfNullOrWhitespace(s,"value"),this.privSpeechConfig.speechRecognitionLanguage=s}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(s){this.privSpeechConfig.outputFormat=s}setProperty(s,o){this.privSpeechConfig.setProperty(s,o)}getProperty(s,o){return this.privSpeechConfig.getProperty(s)}setProxy(s,o,a,l){this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyHostName,s),this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyPort,`${o}`),a&&this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyUserName,a),l&&this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyPassword,l)}setServiceProperty(s,o,a){this.privSpeechConfig.setServiceProperty(s,o)}close(){}}return gc.DialogServiceConfigImpl=r,gc}var wm={},PM;function Z8(){if(PM)return wm;PM=1,Object.defineProperty(wm,"__esModule",{value:!0}),wm.BotFrameworkConfig=void 0;const n=lt(),e=GP(),t=Pe();let r=class extends e.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(s,o,a){n.Contracts.throwIfNullOrWhitespace(s,"subscription"),n.Contracts.throwIfNullOrWhitespace(o,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),l.setProperty(t.PropertyId.SpeechServiceConnection_Key,s),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,o),a&&l.setProperty(t.PropertyId.Conversation_ApplicationId,a),l}static fromAuthorizationToken(s,o,a){n.Contracts.throwIfNullOrWhitespace(s,"authorizationToken"),n.Contracts.throwIfNullOrWhitespace(o,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),l.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,s),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,o),a&&l.setProperty(t.PropertyId.Conversation_ApplicationId,a),l}static fromHost(s,o,a){n.Contracts.throwIfNullOrUndefined(s,"host");const l=s instanceof URL?s:new URL(`wss://${s}.convai.speech.azure.us`);n.Contracts.throwIfNullOrUndefined(l,"resolvedHost");const c=new e.DialogServiceConfigImpl;return c.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),c.setProperty(t.PropertyId.SpeechServiceConnection_Host,l.toString()),o!==void 0&&c.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),c}static fromEndpoint(s,o){n.Contracts.throwIfNull(s,"endpoint");const a=new e.DialogServiceConfigImpl;return a.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),a.setProperty(t.PropertyId.SpeechServiceConnection_Endpoint,s.toString()),o!==void 0&&a.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),a}};return wm.BotFrameworkConfig=r,wm}var bm={},RM;function q8(){if(RM)return bm;RM=1,Object.defineProperty(bm,"__esModule",{value:!0}),bm.CustomCommandsConfig=void 0;const n=lt(),e=GP(),t=Pe();let r=class extends e.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(s,o,a){n.Contracts.throwIfNullOrWhitespace(s,"applicationId"),n.Contracts.throwIfNullOrWhitespace(o,"subscription"),n.Contracts.throwIfNullOrWhitespace(a,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.CustomCommands),l.setProperty(t.PropertyId.Conversation_ApplicationId,s),l.setProperty(t.PropertyId.SpeechServiceConnection_Key,o),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}static fromAuthorizationToken(s,o,a){n.Contracts.throwIfNullOrWhitespace(s,"applicationId"),n.Contracts.throwIfNullOrWhitespace(o,"authorizationToken"),n.Contracts.throwIfNullOrWhitespace(a,"region");const l=new e.DialogServiceConfigImpl;return l.setProperty(t.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.CustomCommands),l.setProperty(t.PropertyId.Conversation_ApplicationId,s),l.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,o),l.setProperty(t.PropertyId.SpeechServiceConnection_Region,a),l}set applicationId(s){n.Contracts.throwIfNullOrWhitespace(s,"value"),this.setProperty(t.PropertyId.Conversation_ApplicationId,s)}get applicationId(){return this.getProperty(t.PropertyId.Conversation_ApplicationId)}};return bm.CustomCommandsConfig=r,bm}var Pm={},Rm={},Im={},_m={},IM;function Vl(){if(IM)return _m;IM=1,Object.defineProperty(_m,"__esModule",{value:!0}),_m.QueryParameterNames=void 0;let n=class{};return _m.QueryParameterNames=n,n.BotId="botid",n.CustomSpeechDeploymentId="cid",n.CustomVoiceDeploymentId="deploymentId",n.EnableAudioLogging="storeAudio",n.EnableLanguageId="lidEnabled",n.EnableWordLevelTimestamps="wordLevelTimestamps",n.EndSilenceTimeoutMs="endSilenceTimeoutMs",n.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",n.SegmentationMaximumTimeMs="segmentationMaximumTimeMs",n.SegmentationStrategy="segmentationStrategy",n.Format="format",n.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",n.Language="language",n.Profanity="profanity",n.RequestBotStatusMessages="enableBotMessageStatus",n.StableIntermediateThreshold="stableIntermediateThreshold",n.StableTranslation="stableTranslation",n.TestHooks="testhooks",n.Postprocessing="postprocessing",n.CtsMeetingId="meetingId",n.CtsDeviceId="deviceId",n.CtsIsParticipant="isParticipant",n.EnableAvatar="enableTalkingAvatar",_m}var _M;function pa(){if(_M)return Im;_M=1,Object.defineProperty(Im,"__esModule",{value:!0}),Im.ConnectionFactoryBase=void 0;const n=Ue(),e=He(),t=Pe(),r=Vl();let i=class{static getHostSuffix(o){if(o){if(o.toLowerCase().startsWith("china"))return".azure.cn";if(o.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(o,a,l){new Map([[t.PropertyId.Speech_SegmentationSilenceTimeoutMs,r.QueryParameterNames.SegmentationSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_EnableAudioLogging,r.QueryParameterNames.EnableAudioLogging],[t.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,r.QueryParameterNames.EndSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,r.QueryParameterNames.InitialSilenceTimeoutMs],[t.PropertyId.SpeechServiceResponse_PostProcessingOption,r.QueryParameterNames.Postprocessing],[t.PropertyId.SpeechServiceResponse_ProfanityOption,r.QueryParameterNames.Profanity],[t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,r.QueryParameterNames.EnableWordLevelTimestamps],[t.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,r.QueryParameterNames.StableIntermediateThreshold]]).forEach((h,m)=>{this.setUrlParameter(m,h,o,a,l)});const u=JSON.parse(o.parameters.getProperty(n.ServicePropertiesPropertyName,"{}"));Object.keys(u).forEach(h=>{a[h]=u[h]})}setUrlParameter(o,a,l,c,u){const h=l.parameters.getProperty(o,void 0);h&&(!u||u.search(a)===-1)&&(c[a]=h.toLocaleLowerCase())}static async getRedirectUrlFromEndpoint(o){const a=new URL(o);a.protocol="https:",a.port="443",a.searchParams.append("GenerateRedirectResponse","true");const c=a.toString();e.Events.instance.onEvent(new e.ConnectionRedirectEvent("",c,void 0,"ConnectionFactoryBase: redirectUrl request"));const u=await fetch(c);if(u.status!==200)return o;const h=await u.text();e.Events.instance.onEvent(new e.ConnectionRedirectEvent("",h,o,"ConnectionFactoryBase: redirectUrlString"));try{return new URL(h.trim()).toString()}catch{return o}}};return Im.ConnectionFactoryBase=i,Im}var kM;function G8(){if(kM)return Rm;kM=1,Object.defineProperty(Rm,"__esModule",{value:!0}),Rm.DialogConnectionFactory=void 0;const n=Fr(),e=Ue(),t=Pe(),r=pa(),i=Ue(),s=gi(),o=Vl();class a extends r.ConnectionFactoryBase{create(c,u,h){const m=c.parameters.getProperty(t.PropertyId.Conversation_ApplicationId,""),v=c.parameters.getProperty(t.PropertyId.Conversation_DialogType),C=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region),T=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),E=c.parameters.getProperty(t.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),x={};x[s.HeaderNames.ConnectionId]=h,x[o.QueryParameterNames.Format]=c.parameters.getProperty(e.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple]).toLowerCase(),x[o.QueryParameterNames.Language]=T,x[o.QueryParameterNames.RequestBotStatusMessages]=E,m&&(x[o.QueryParameterNames.BotId]=m,v===t.DialogServiceConfig.DialogTypes.CustomCommands&&(x[s.HeaderNames.CustomCommandsAppId]=m));const P=v===t.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",b=v===t.DialogServiceConfig.DialogTypes.CustomCommands?"v1":v===t.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",I={};u.token!=null&&u.token!==""&&(I[u.headerName]=u.token);let M=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,"");if(!M){const D=r.ConnectionFactoryBase.getHostSuffix(C),j=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,`wss://${C}.${a.BaseUrl}${D}`);M=`${j.endsWith("/")?j:j+"/"}${P}${a.ApiKey}/${b}`}this.setCommonUrlParams(c,x,M);const N=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new n.WebsocketConnection(M,x,I,new i.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(c),N,h))}}return Rm.DialogConnectionFactory=a,a.ApiKey="api",a.BaseUrl="convai.speech",Rm}var MM;function K8(){if(MM)return Pm;MM=1,Object.defineProperty(Pm,"__esModule",{value:!0}),Pm.DialogServiceConnector=void 0;const n=G8(),e=Ue(),t=vs(),r=He(),i=lt(),s=Pe(),o=qP();let a=class extends s.Recognizer{constructor(c,u){const h=c;i.Contracts.throwIfNull(c,"dialogConfig"),super(u,h.properties,new n.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=h.properties.clone();const m=this.buildAgentConfig();this.privReco.agentConfig.set(m)}connect(c,u){(0,r.marshalPromiseToCallbacks)(this.privReco.connect(),c,u)}disconnect(c,u){(0,r.marshalPromiseToCallbacks)(this.privReco.disconnect(),c,u)}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){i.Contracts.throwIfNullOrWhitespace(c,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,c)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(o.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(c){this.properties.setProperty(o.PropertyId.Conversation_Speech_Activity_Template,c)}listenOnceAsync(c,u){if(this.isTurnComplete){i.Contracts.throwIfDisposed(this.privIsDisposed);const m=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;const v=new r.Deferred;await this.privReco.recognize(t.RecognitionMode.Conversation,v.resolve,v.reject);const C=await v.promise;return await this.implRecognizerStop(),C})();m.catch(()=>{this.dispose(!0).catch(()=>{})}),(0,r.marshalPromiseToCallbacks)(m.finally(()=>{this.isTurnComplete=!0}),c,u)}}sendActivityAsync(c,u,h){(0,r.marshalPromiseToCallbacks)(this.privReco.sendMessage(c),u,h)}close(c,u){i.Contracts.throwIfDisposed(this.privIsDisposed),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),c,u)}async dispose(c){this.privIsDisposed||c&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(c))}createRecognizerConfig(c){return new e.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,u,h,m){const v=h;return new e.DialogServiceAdapter(c,u,v,m,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(o.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(o.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(o.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};return Pm.DialogServiceConnector=a,Pm}var km={},NM;function Y8(){if(NM)return km;NM=1,Object.defineProperty(km,"__esModule",{value:!0}),km.ActivityReceivedEventArgs=void 0;let n=class{constructor(t,r){this.privActivity=t,this.privAudioStream=r}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};return km.ActivityReceivedEventArgs=n,km}var Mm={},Nm={},LM;function J8(){if(LM)return Nm;LM=1,Object.defineProperty(Nm,"__esModule",{value:!0}),Nm.TurnStatusResponsePayload=void 0;class n{constructor(t){this.privMessageStatusResponse=JSON.parse(t)}static fromJSON(t){return new n(t)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}return Nm.TurnStatusResponsePayload=n,Nm}var DM;function X8(){if(DM)return Mm;DM=1,Object.defineProperty(Mm,"__esModule",{value:!0}),Mm.TurnStatusReceivedEventArgs=void 0;const n=J8();let e=class{constructor(r){this.privTurnStatus=n.TurnStatusResponsePayload.fromJSON(r)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};return Mm.TurnStatusReceivedEventArgs=e,Mm}var jx={},OM;function Q8(){return OM||(OM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ServicePropertyChannel=void 0,(function(e){e[e.UriQueryParameter=0]="UriQueryParameter"})(n.ServicePropertyChannel||(n.ServicePropertyChannel={}))})(jx)),jx}var Ux={},BM;function eW(){return BM||(BM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ProfanityOption=void 0,(function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"})(n.ProfanityOption||(n.ProfanityOption={}))})(Ux)),Ux}var Lm={},FM;function tW(){if(FM)return Lm;FM=1,Object.defineProperty(Lm,"__esModule",{value:!0}),Lm.BaseAudioPlayer=void 0;const n=ro(),e=Pe(),t=Qu();let r=class{constructor(s){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,s===void 0&&(s=e.AudioStreamFormat.getDefaultInputFormat()),this.init(s)}playAudioSample(s,o,a){try{this.ensureInitializedContext();const l=this.formatAudioData(s),c=new Float32Array(this.samples.length+l.length);c.set(this.samples,0),c.set(l,this.samples.length),this.samples=c,o&&o()}catch(l){a&&a(l)}}stopAudio(s,o){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{s&&s()},a=>{o&&o(a)}),this.audioContext=null)}init(s){this.audioFormat=s,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();const s=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},s)}}createAudioContext(){this.audioContext=t.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(s){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(s),128);case 16:return this.formatArrayBuffer(new Int16Array(s),32768);case 32:return this.formatArrayBuffer(new Int32Array(s),2147483648);default:throw new n.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(s,o){const a=new Float32Array(s.length);for(let l=0;l<s.length;l++)a[l]=s[l]/o;return a}updateAudioBuffer(){if(this.samples.length===0)return;const s=this.audioFormat.channels,o=this.audioContext.createBufferSource(),a=this.samples.length/s,l=this.audioContext.createBuffer(s,a,this.audioFormat.samplesPerSec);for(let c=0;c<s;c++){let u=c;const h=l.getChannelData(c);for(let m=0;m<this.samples.length;m++,u+=s)h[m]=this.samples[u]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),o.buffer=l,o.connect(this.gainNode),o.start(this.startTime),this.startTime+=l.duration,this.samples=new Float32Array}async playAudio(s){this.audioContext===null&&this.createAudioContext();const o=this.audioContext.createBufferSource(),a=this.audioContext.destination;await this.audioContext.decodeAudioData(s,l=>{o.buffer=l,o.connect(a),o.start(0)})}};return Lm.BaseAudioPlayer=r,Lm}var Dm={},jM;function nW(){if(jM)return Dm;jM=1,Object.defineProperty(Dm,"__esModule",{value:!0}),Dm.ConnectionMessageEventArgs=void 0;let n=class{constructor(t){this.privConnectionMessage=t}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};return Dm.ConnectionMessageEventArgs=n,Dm}var Om={},zx={},UM;function WB(){return UM||(UM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.LanguageIdMode=void 0,(function(e){e[e.AtStart=0]="AtStart",e[e.Continuous=1]="Continuous"})(n.LanguageIdMode||(n.LanguageIdMode={}))})(zx)),zx}var zM;function rW(){if(zM)return Om;zM=1,Object.defineProperty(Om,"__esModule",{value:!0}),Om.AutoDetectSourceLanguageConfig=void 0;const n=Ue(),e=lt(),t=Pe(),r=WB();let i=class _C{constructor(){this.privProperties=new t.PropertyCollection,this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=r.LanguageIdMode.AtStart}static fromOpenRange(){const o=new _C;return o.properties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,n.AutoDetectSourceLanguagesOpenRangeOptionName),o.properties.setProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),o}static fromLanguages(o){e.Contracts.throwIfArrayEmptyOrWhitespace(o,"languages");const a=new _C;return a.properties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,o.join()),a}static fromSourceLanguageConfigs(o){if(o.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const a=new _C,l=[];return o.forEach(c=>{if(l.push(c.language),c.endpointId!==void 0&&c.endpointId!==""){const u=c.language+t.PropertyId.SpeechServiceConnection_EndpointId.toString();a.properties.setProperty(u,c.endpointId)}}),a.properties.setProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,l.join()),a}get properties(){return this.privProperties}set mode(o){o===r.LanguageIdMode.Continuous?(this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=o}};return Om.AutoDetectSourceLanguageConfig=i,Om}var Bm={},WM;function iW(){if(WM)return Bm;WM=1,Object.defineProperty(Bm,"__esModule",{value:!0}),Bm.AutoDetectSourceLanguageResult=void 0;const n=lt();let e=class Vw{constructor(r,i){n.Contracts.throwIfNullOrUndefined(r,"language"),n.Contracts.throwIfNullOrUndefined(i,"languageDetectionConfidence"),this.privLanguage=r,this.privLanguageDetectionConfidence=i}static fromResult(r){return new Vw(r.language,r.languageDetectionConfidence)}static fromConversationTranscriptionResult(r){return new Vw(r.language,r.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};return Bm.AutoDetectSourceLanguageResult=e,Bm}var Fm={},VM;function sW(){if(VM)return Fm;VM=1,Object.defineProperty(Fm,"__esModule",{value:!0}),Fm.SourceLanguageConfig=void 0;const n=lt();let e=class VB{constructor(r,i){n.Contracts.throwIfNullOrUndefined(r,"language"),this.privLanguage=r,this.privEndpointId=i}static fromLanguage(r,i){return new VB(r,i)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};return Fm.SourceLanguageConfig=e,Fm}var Wx={},vc={},$M;function $B(){if($M)return vc;$M=1,Object.defineProperty(vc,"__esModule",{value:!0}),vc.ConversationImpl=vc.Conversation=void 0;const n=Ue(),e=He(),t=lt(),r=Pe();let i=class{constructor(){}static createConversationAsync(a,l,c,u){t.Contracts.throwIfNullOrUndefined(a,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrUndefined(a.region,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!a.subscriptionKey&&!a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceAuthorization_Token])&&t.Contracts.throwIfNullOrUndefined(a.subscriptionKey,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let h,m,v;return typeof l=="string"?(h=new s(a,l),(0,e.marshalPromiseToCallbacks)((async()=>{})(),c,u)):(h=new s(a),m=l,v=c,h.createConversationAsync((()=>{m&&m()}),C=>{v&&v(C)})),h}};vc.Conversation=i;class s extends i{constructor(a,l){if(super(),this.privErrors=n.ConversationConnectionConfig.restErrors,this.onConnected=h=>{var m;this.privIsConnected=!0;try{(m=this.privConversationTranslator)!=null&&m.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,h)}catch{}},this.onDisconnected=h=>{var m;try{(m=this.privConversationTranslator)!=null&&m.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,h)}catch{}finally{this.close(!1)}},this.onCanceled=(h,m)=>{var v;try{(v=this.privConversationTranslator)!=null&&v.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,m)}catch{}},this.onParticipantUpdateCommandReceived=(h,m)=>{try{const v=this.privParticipants.getParticipant(m.id);if(v!==void 0){switch(m.key){case n.ConversationTranslatorCommandTypes.changeNickname:v.displayName=m.value;break;case n.ConversationTranslatorCommandTypes.setUseTTS:v.isUsingTts=m.value;break;case n.ConversationTranslatorCommandTypes.setProfanityFiltering:v.profanity=m.value;break;case n.ConversationTranslatorCommandTypes.setMute:v.isMuted=m.value;break;case n.ConversationTranslatorCommandTypes.setTranslateToLanguages:v.translateToLanguages=m.value;break}this.privParticipants.addOrUpdateParticipant(v),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.Updated,[this.toParticipant(v)],m.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(h,m)=>{try{this.privParticipants.participants.forEach(v=>v.isMuted=v.isHost?!1:m.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.Updated,this.toParticipants(!1),m.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(h,m)=>{try{const v=this.privParticipants.addOrUpdateParticipant(m.participant);v!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.JoinedConversation,[this.toParticipant(v)],m.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(h,m)=>{try{const v=this.privParticipants.getParticipant(m.participant.id);v!==void 0&&(this.privParticipants.deleteParticipant(m.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.LeftConversation,[this.toParticipant(v)],m.sessionId)))}catch{}},this.onTranslationReceived=(h,m)=>{try{switch(m.command){case n.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new r.ConversationTranslationEventArgs(m.payload,void 0,m.sessionId));break;case n.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new r.ConversationTranslationEventArgs(m.payload,void 0,m.sessionId));break;case n.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new r.ConversationTranslationEventArgs(m.payload,void 0,m.sessionId));break}}catch{}},this.onParticipantsListReceived=(h,m)=>{var v;try{if(m.sessionToken!==void 0&&m.sessionToken!==null&&(this.privRoom.token=m.sessionToken),this.privParticipants.participants=[...m.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),m.sessionId)),this.me.isHost){const C=(v=this.privConversationTranslator)==null?void 0:v.properties.getProperty(r.PropertyId.ConversationTranslator_Name);C!==void 0&&C.length>0&&C!==this.me.displayName&&this.changeNicknameAsync(C)}}catch{}},this.onConversationExpiration=(h,m)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,m)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new r.PropertyCollection,this.privManager=new n.ConversationManager,a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage])||a.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage],n.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage]),l)this.privConversationId=l;else{a.targetLanguages.length===0&&a.addTargetLanguage(this.privLanguage),a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceResponse_ProfanityOption])||a.setProfanity(r.ProfanityOption.Masked);let m=a.getProperty(r.PropertyId[r.PropertyId.ConversationTranslator_Name]);m==null&&(m="Host"),t.Contracts.throwIfNullOrTooLong(m,"nickname",50),t.Contracts.throwIfNullOrTooShort(m,"nickname",2),a.setProperty(r.PropertyId[r.PropertyId.ConversationTranslator_Name],m)}this.privConfig=a;const u=a;t.Contracts.throwIfNull(u,"speechConfig"),this.privProperties=u.properties.clone(),this.privIsConnected=!1,this.privParticipants=new n.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var a,l;return(a=this.privParticipants.me)!=null&&a.isHost?!1:(l=this.privParticipants.me)==null?void 0:l.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const a=this.conversationId,l=this.participants.map(h=>({id:h.id,preferredLanguage:h.preferredLanguage,voice:h.voice})),c={};for(const h of n.ConversationConnectionConfig.transcriptionEventKeys){const m=this.properties.getProperty(h,"");m!==""&&(c[h]=m)}return{id:a,participants:l,conversationProperties:c}}get canSend(){var a;return this.privIsConnected&&!((a=this.privParticipants.me)!=null&&a.isMuted)}get canSendAsHost(){var a;return this.privIsConnected&&((a=this.privParticipants.me)==null?void 0:a.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),this.privToken=a}set conversationTranslator(a){this.privConversationTranslator=a}onToken(a){this.privConversationTranslator.onToken(a)}createConversationAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),this.privManager.createOrJoin(this.privProperties,void 0,(c=>{c||this.handleError(new Error(this.privErrors.permissionDeniedConnect),l),this.privRoom=c,this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}startConversationAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=n.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}addParticipantAsync(a,l,c){t.Contracts.throwIfNullOrUndefined(a,"Participant"),(0,e.marshalPromiseToCallbacks)(this.addParticipantImplAsync(a),l,c)}joinConversationAsync(a,l,c,u,h){try{t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","conversationId")),t.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,a,(m=>{t.Contracts.throwIfNullOrUndefined(m,this.privErrors.permissionDeniedConnect),this.privRoom=m,this.privConfig.authorizationToken=m.cognitiveSpeechAuthToken,u&&u(m.cognitiveSpeechAuthToken)}),(m=>{this.handleError(m,h)}))}catch(m){this.handleError(m,h)}}deleteConversationAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.deleteConversationImplAsync(),a,l)}async deleteConversationImplAsync(){t.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),t.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.endConversationImplAsync(),a,l)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}muteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}muteParticipantAsync(a,l,c){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!0),(()=>{this.handleCallback(l,c)}),(h=>{this.handleError(h,c)}))}catch(u){this.handleError(u,c)}}removeParticipantAsync(a,l,c){try{if(t.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&a.hasOwnProperty("id"))(0,e.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(a),l,c);else{t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),c);let u="";typeof a=="string"?u=a:a.hasOwnProperty("id")?u=a.id:a.hasOwnProperty("userId")&&(u=a.userId),t.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(m=>m.id===u)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(u),(()=>{this.handleCallback(l,c)}),(m=>{this.handleError(m,c)}))}}catch(u){this.handleError(u,c)}}unlockConversationAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}unmuteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}unmuteParticipantAsync(a,l,c){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!1),(()=>{this.handleCallback(l,c)}),(h=>{this.handleError(h,c)}))}catch(u){this.handleError(u,c)}}sendTextMessageAsync(a,l,c){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","message")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),a.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(a),(()=>{this.handleCallback(l,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}setTranslatedLanguagesAsync(a,l,c){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfArrayEmptyOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","languages")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(a),(()=>{this.handleCallback(l,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}changeNicknameAsync(a,l,c){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(a),(()=>{this.handleCallback(l,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(a){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await a.enforceAudioGating(),this.privTranscriberRecognizer=a,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){const a=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:a,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(a){if(this.privParticipants.addOrUpdateParticipant(a)!==void 0&&this.privTranscriberRecognizer){const c=this.conversationInfo;return c.participants=[a],this.privTranscriberRecognizer.pushConversationEvent(c,"join")}}removeParticipantImplAsync(a){this.privParticipants.deleteParticipant(a.id);const l=this.conversationInfo;return l.participants=[a],this.privTranscriberRecognizer.pushConversationEvent(l,"leave")}async close(a){var l;try{this.privIsConnected=!1,await((l=this.privConversationRecognizer)==null?void 0:l.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(c){throw c}a&&this.dispose()}handleCallback(a,l){if(a){try{a()}catch(c){l&&l(c)}a=void 0}}handleError(a,l){if(l)if(a instanceof Error){const c=a;l(c.name+": "+c.message)}else l(a)}toParticipants(a){const l=this.privParticipants.participants.map(c=>this.toParticipant(c));return a?l:l.filter(c=>c.isHost===!1)}toParticipant(a){return new r.Participant(a.id,a.avatar,a.displayName,a.isHost,a.isMuted,a.isUsingTts,a.preferredLanguage,a.voice)}getMuteAllCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMuteCommand(a,l){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setMute,participantId:a,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:l})}getLockCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getEjectCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.ejectParticipant,participantId:a,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getChangeNicknameCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"nickname"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.changeNickname,nickname:a,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMessageCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),t.Contracts.throwIfNullOrWhitespace(a,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:a,type:n.ConversationTranslatorMessageTypes.instantMessage})}}return vc.ConversationImpl=s,vc}var jm={},HM;function oW(){if(HM)return jm;HM=1,Object.defineProperty(jm,"__esModule",{value:!0}),jm.ConversationCommon=void 0;let n=class{constructor(t){this.privAudioConfig=t}handleCallback(t,r){if(t){try{t()}catch(i){r&&r(i)}t=void 0}}handleError(t,r){if(r)if(t instanceof Error){const i=t;r(i.name+": "+i.message)}else r(t)}};return jm.ConversationCommon=n,jm}var Um={},ZM;function aW(){if(ZM)return Um;ZM=1,Object.defineProperty(Um,"__esModule",{value:!0}),Um.ConversationExpirationEventArgs=void 0;const n=Pe();let e=class extends n.SessionEventArgs{constructor(r,i){super(i),this.privExpirationTime=r}get expirationTime(){return this.privExpirationTime}};return Um.ConversationExpirationEventArgs=e,Um}var zm={},qM;function lW(){if(qM)return zm;qM=1,Object.defineProperty(zm,"__esModule",{value:!0}),zm.ConversationParticipantsChangedEventArgs=void 0;const n=Pe();let e=class extends n.SessionEventArgs{constructor(r,i,s){super(s),this.privReason=r,this.privParticipant=i}get reason(){return this.privReason}get participants(){return this.privParticipant}};return zm.ConversationParticipantsChangedEventArgs=e,zm}var Wm={},GM;function cW(){if(GM)return Wm;GM=1,Object.defineProperty(Wm,"__esModule",{value:!0}),Wm.ConversationTranslationCanceledEventArgs=void 0;const n=zS();let e=class extends n.CancellationEventArgsBase{};return Wm.ConversationTranslationCanceledEventArgs=e,Wm}var Vm={},KM;function uW(){if(KM)return Vm;KM=1,Object.defineProperty(Vm,"__esModule",{value:!0}),Vm.ConversationTranslationEventArgs=void 0;const n=Pe();let e=class extends n.RecognitionEventArgs{constructor(r,i,s){super(i,s),this.privResult=r}get result(){return this.privResult}};return Vm.ConversationTranslationEventArgs=e,Vm}var $m={},YM;function dW(){if(YM)return $m;YM=1,Object.defineProperty($m,"__esModule",{value:!0}),$m.ConversationTranslationResult=void 0;const n=_B();let e=class extends n.TranslationRecognitionResult{constructor(r,i,s,o,a,l,c,u,h,m,v){super(i,o,a,l,c,u,void 0,void 0,h,m,v),this.privId=r,this.privOrigLang=s}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};return $m.ConversationTranslationResult=e,$m}var Vx={},Hm={},Zm={},JM;function HB(){if(JM)return Zm;JM=1,Object.defineProperty(Zm,"__esModule",{value:!0}),Zm.StringUtils=void 0;let n=class{static formatString(t,r){if(!t)return"";if(!r)return t;let i="",s="";const o=c=>{i+=c},a=c=>{s+=c};let l=o;for(let c=0;c<t.length;c++){const u=t[c],h=c+1<t.length?t[c+1]:"";switch(u){case"{":h==="{"?(l("{"),c++):l=a;break;case"}":h==="}"?(l("}"),c++):(r.hasOwnProperty(s)&&(i+=r[s]),l=o,s="");break;default:l(u);break}}return i}};return Zm.StringUtils=n,Zm}var XM;function hW(){if(XM)return Hm;XM=1,Object.defineProperty(Hm,"__esModule",{value:!0}),Hm.ConversationTranslatorConnectionFactory=void 0;const n=Fr(),e=HB(),t=lt(),r=Pe(),i=gi(),s=Vl(),o=pa(),a=Ue();let l=class ZB extends o.ConnectionFactoryBase{constructor(u){super(),t.Contracts.throwIfNullOrUndefined(u,"convGetter"),this.privConvGetter=u}create(u,h,m){const v=u.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",C=this.privConvGetter().room,T=C.cognitiveSpeechRegion||u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,""),E={hostSuffix:o.ConnectionFactoryBase.getHostSuffix(T),path:ZB.CTS_VIRT_MIC_PATH,region:encodeURIComponent(T)};E[s.QueryParameterNames.Language]=encodeURIComponent(u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,"")),E[s.QueryParameterNames.CtsMeetingId]=encodeURIComponent(C.roomId),E[s.QueryParameterNames.CtsDeviceId]=encodeURIComponent(C.participantId),E[s.QueryParameterNames.CtsIsParticipant]=C.isHost?"":"&"+s.QueryParameterNames.CtsIsParticipant;let x="";const P={},b={};if(v){x=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint),x||(x="wss://"+u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),x=e.StringUtils.formatString(x,E);const M=new URL(x);M.searchParams.forEach((D,j)=>{P[j]=D}),new a.TranscriberConnectionFactory().setQueryParams(P,u,x),P[s.QueryParameterNames.CtsMeetingId]=E[s.QueryParameterNames.CtsMeetingId],P[s.QueryParameterNames.CtsDeviceId]=E[s.QueryParameterNames.CtsDeviceId],C.isHost||(P[s.QueryParameterNames.CtsIsParticipant]=""),s.QueryParameterNames.Format in P||(P[s.QueryParameterNames.Format]="simple"),M.searchParams.forEach((D,j)=>{M.searchParams.set(j,P[j]),delete P[j]}),x=M.toString()}else{const M=new a.TranslationConnectionFactory;x=M.getEndpointUrl(u,!0),x=e.StringUtils.formatString(x,E),M.setQueryParams(P,u,x)}b[i.HeaderNames.ConnectionId]=m,b[n.RestConfigBase.configParams.token]=C.token,h.token&&(b[h.headerName]=h.token);const I=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return Promise.resolve(new n.WebsocketConnection(x,P,b,new a.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(u),I,m))}};return Hm.ConversationTranslatorConnectionFactory=l,l.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio",Hm}var QM;function pW(){return QM||(QM=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConversationTranslator=n.SpeechState=void 0;const e=Ue(),t=hW(),r=He(),i=lt(),s=Pe(),o=$B(),a=KP();var l;(function(h){h[h.Inactive=0]="Inactive",h[h.Connecting=1]="Connecting",h[h.Connected=2]="Connected"})(l=n.SpeechState||(n.SpeechState={}));class c extends s.TranslationRecognizer{constructor(m,v,C,T){super(m,v,new t.ConversationTranslatorConnectionFactory(T)),this.privSpeechState=l.Inactive,C&&(this.privTranslator=C,this.sessionStarted=()=>{this.privSpeechState=l.Connected},this.sessionStopped=()=>{this.privSpeechState=l.Inactive},this.recognizing=(E,x)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,x)},this.recognized=async(E,x)=>{var P;(P=x.result)!=null&&P.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(x.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,x)},this.canceled=async()=>{if(this.privSpeechState!==l.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=l.Inactive}})}get state(){return this.privSpeechState}set state(m){this.privSpeechState=m}set authentication(m){this.privReco.authentication=m}onConnection(){this.privSpeechState=l.Connected}async onCancelSpeech(){this.privSpeechState=l.Inactive,await this.cancelSpeech()}fireCancelEvent(m){try{if(this.privTranslator.canceled){const v=new a.ConversationTranslationCanceledEventArgs(s.CancellationReason.Error,m,s.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,v)}}catch{}}async cancelSpeech(){var m;try{this.stopContinuousRecognitionAsync(),await((m=this.privReco)==null?void 0:m.disconnect()),this.privSpeechState=l.Inactive}catch{}}}class u extends a.ConversationCommon{constructor(m){super(m),this.privErrors=e.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new s.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){var m;return(m=this.privConversation)==null?void 0:m.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===l.Connected||this.privCTRecognizer.state===l.Connecting||this.privConversation.isMutedByHost)}onToken(m){this.privCTRecognizer.authentication=m}setServiceProperty(m,v){const C=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));C[m]=v,this.privProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(C))}joinConversationAsync(m,v,C,T,E){try{if(typeof m=="string"){i.Contracts.throwIfNullOrUndefined(m,this.privErrors.invalidArgs.replace("{arg}","conversation id")),i.Contracts.throwIfNullOrWhitespace(v,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),E);let x=C;(x==null||x==="")&&(x=e.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=s.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(s.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(x),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage],x),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.ConversationTranslator_Name],v);const P=[s.PropertyId.SpeechServiceConnection_Host,s.PropertyId.ConversationTranslator_Host,s.PropertyId.SpeechServiceConnection_Endpoint,s.PropertyId.SpeechServiceConnection_ProxyHostName,s.PropertyId.SpeechServiceConnection_ProxyPassword,s.PropertyId.SpeechServiceConnection_ProxyPort,s.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const I of P){const M=this.privProperties.getProperty(I);if(M){const N=typeof I=="string"?I:s.PropertyId[I];this.privSpeechTranslationConfig.setProperty(N,M)}}const b=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));for(const I of Object.keys(b))this.privSpeechTranslationConfig.setServiceProperty(I,b[I],s.ServicePropertyChannel.UriQueryParameter);this.privConversation=new o.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(m,v,x,(I=>{I||this.handleError(new Error(this.privErrors.permissionDeniedConnect),E),this.privSpeechTranslationConfig.authorizationToken=I,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync((()=>{this.handleCallback(T,E)}),(M=>{this.handleError(M,E)}))}),(I=>{this.handleError(I,E)}))}else typeof m=="object"?(i.Contracts.throwIfNullOrUndefined(m,this.privErrors.invalidArgs.replace("{arg}","conversation id")),i.Contracts.throwIfNullOrWhitespace(v,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(s.PropertyId.ConversationTranslator_Name,v),this.privConversation=m,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),i.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=m.config,this.handleCallback(C,T)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),T)}catch(x){this.handleError(x,typeof C=="string"?E:T)}}leaveConversationAsync(m,v){(0,r.marshalPromiseToCallbacks)((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),m,v)}sendTextMessageAsync(m,v,C){try{i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrWhitespace(m,this.privErrors.invalidArgs.replace("{arg}",m)),this.privConversation.sendTextMessageAsync(m,v,C)}catch(T){this.handleError(T,C)}}startTranscribingAsync(m,v){(0,r.marshalPromiseToCallbacks)((async()=>{try{i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),i.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),v),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(C){throw this.privIsSpeaking=!1,await this.cancelSpeech(),C}})(),m,v)}stopTranscribingAsync(m,v){(0,r.marshalPromiseToCallbacks)((async()=>{try{if(!this.privIsSpeaking){await this.cancelSpeech();return}this.privIsSpeaking=!1,await new Promise((C,T)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(C,T)})}catch{await this.cancelSpeech()}})(),m,v)}isDisposed(){return this.privIsDisposed}dispose(m,v,C){(0,r.marshalPromiseToCallbacks)((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),v,C)}async cancelSpeech(){var m;try{this.privIsSpeaking=!1,await((m=this.privCTRecognizer)==null?void 0:m.onCancelSpeech()),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=s.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key],"");const m=()=>this.privConversation;this.privCTRecognizer=new c(this.privSpeechTranslationConfig,this.privAudioConfig,this,m)}catch(m){throw await this.cancelSpeech(),m}}startContinuousRecognition(){return new Promise((m,v)=>{this.privCTRecognizer.startContinuousRecognitionAsync(m,v)})}}n.ConversationTranslator=u})(Vx)),Vx}var qm={},eN;function fW(){if(eN)return qm;eN=1,Object.defineProperty(qm,"__esModule",{value:!0}),qm.ConversationTranscriber=void 0;const n=Ue(),e=vs(),t=He(),r=lt(),i=Pe();let s=class qB extends i.Recognizer{constructor(a,l){const c=a;r.Contracts.throwIfNull(c,"speechConfig"),r.Contracts.throwIfNullOrWhitespace(c.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),super(l,c.properties,new n.ConversationTranscriberConnectionFactory,a.tokenCredential),this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(a,l,c){const u=a;return l.properties.mergeTo(u.properties),new qB(a,c)}get endpointId(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){r.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,a)}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple])===i.OutputFormat[i.OutputFormat.Simple]?i.OutputFormat.Simple:i.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(e.RecognitionMode.Conversation),a,l)}stopTranscribingAsync(a,l){(0,t.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),a,l)}close(a,l){r.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),a,l)}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new n.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,l,c,u){const h=c;return u.isSpeakerDiarizationEnabled=!0,new n.ConversationTranscriptionServiceRecognizer(a,l,h,u,this)}};return qm.ConversationTranscriber=s,qm}var yc={},tN;function mW(){if(tN)return yc;tN=1,Object.defineProperty(yc,"__esModule",{value:!0}),yc.Participant=yc.User=void 0;const n=Pe();class e{constructor(i){this.privUserId=i}get userId(){return this.privUserId}}yc.User=e;class t{constructor(i,s,o,a,l,c,u,h){this.privId=i,this.privAvatar=s,this.privDisplayName=o,this.privIsHost=a,this.privIsMuted=l,this.privIsUsingTts=c,this.privPreferredLanguage=u,this.privVoice=h,this.privProperties=new n.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(i,s,o){return new t(i,"",i,!1,!1,!1,s,o)}}return yc.Participant=t,yc}var $x={},nN;function gW(){return nN||(nN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ParticipantChangedReason=void 0,(function(e){e[e.JoinedConversation=0]="JoinedConversation",e[e.LeftConversation=1]="LeftConversation",e[e.Updated=2]="Updated"})(n.ParticipantChangedReason||(n.ParticipantChangedReason={}))})($x)),$x}var Sc={},rN;function vW(){if(rN)return Sc;rN=1,Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.MeetingImpl=Sc.Meeting=void 0;const n=Ue(),e=He(),t=lt(),r=Pe();let i=class{constructor(){}static createMeetingAsync(a,l,c,u){if(t.Contracts.throwIfNullOrUndefined(a,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrUndefined(a.region,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),t.Contracts.throwIfNull(l,"meetingId"),l.length===0)throw new Error("meetingId cannot be empty");!a.subscriptionKey&&!a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceAuthorization_Token])&&t.Contracts.throwIfNullOrUndefined(a.subscriptionKey,n.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const h=new s(a,l);return(0,e.marshalPromiseToCallbacks)((async()=>{})(),c,u),h}};Sc.Meeting=i;class s extends i{constructor(a,l){super(),this.privErrors=n.ConversationConnectionConfig.restErrors,this.onConnected=h=>{var m;this.privIsConnected=!0;try{(m=this.privConversationTranslator)!=null&&m.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,h)}catch{}},this.onDisconnected=h=>{var m;try{(m=this.privConversationTranslator)!=null&&m.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,h)}catch{}finally{this.close(!1)}},this.onCanceled=(h,m)=>{var v;try{(v=this.privConversationTranslator)!=null&&v.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,m)}catch{}},this.onParticipantUpdateCommandReceived=(h,m)=>{try{const v=this.privParticipants.getParticipant(m.id);if(v!==void 0){switch(m.key){case n.ConversationTranslatorCommandTypes.changeNickname:v.displayName=m.value;break;case n.ConversationTranslatorCommandTypes.setUseTTS:v.isUsingTts=m.value;break;case n.ConversationTranslatorCommandTypes.setProfanityFiltering:v.profanity=m.value;break;case n.ConversationTranslatorCommandTypes.setMute:v.isMuted=m.value;break;case n.ConversationTranslatorCommandTypes.setTranslateToLanguages:v.translateToLanguages=m.value;break}this.privParticipants.addOrUpdateParticipant(v),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.Updated,[this.toParticipant(v)],m.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(h,m)=>{try{this.privParticipants.participants.forEach(v=>v.isMuted=v.isHost?!1:m.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.Updated,this.toParticipants(!1),m.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(h,m)=>{try{const v=this.privParticipants.addOrUpdateParticipant(m.participant);v!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.JoinedConversation,[this.toParticipant(v)],m.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(h,m)=>{try{const v=this.privParticipants.getParticipant(m.participant.id);v!==void 0&&(this.privParticipants.deleteParticipant(m.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.LeftConversation,[this.toParticipant(v)],m.sessionId)))}catch{}},this.onTranslationReceived=(h,m)=>{try{switch(m.command){case n.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new r.ConversationTranslationEventArgs(m.payload,void 0,m.sessionId));break;case n.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new r.ConversationTranslationEventArgs(m.payload,void 0,m.sessionId));break;case n.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new r.ConversationTranslationEventArgs(m.payload,void 0,m.sessionId));break}}catch{}},this.onParticipantsListReceived=(h,m)=>{var v;try{if(m.sessionToken!==void 0&&m.sessionToken!==null&&(this.privRoom.token=m.sessionToken),this.privParticipants.participants=[...m.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new r.ConversationParticipantsChangedEventArgs(r.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),m.sessionId)),this.me.isHost){const C=(v=this.privConversationTranslator)==null?void 0:v.properties.getProperty(r.PropertyId.ConversationTranslator_Name);C!==void 0&&C.length>0&&C!==this.me.displayName&&this.changeNicknameAsync(C)}}catch{}},this.onConversationExpiration=(h,m)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,m)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new r.PropertyCollection,this.privManager=new n.ConversationManager,a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage])||a.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage],n.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=a.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=l,this.privConfig=a;const u=a;t.Contracts.throwIfNull(u,"speechConfig"),this.privProperties=u.properties.clone(),this.privIsConnected=!1,this.privParticipants=new n.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var a,l;return(a=this.privParticipants.me)!=null&&a.isHost?!1:(l=this.privParticipants.me)==null?void 0:l.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const a=this.meetingId,l=this.participants.map(h=>({id:h.id,preferredLanguage:h.preferredLanguage,voice:h.voice})),c={};for(const h of n.ConversationConnectionConfig.transcriptionEventKeys){const m=this.properties.getProperty(h,"");m!==""&&(c[h]=m)}return{id:a,participants:l,meetingProperties:c}}get canSend(){var a;return this.privIsConnected&&!((a=this.privParticipants.me)!=null&&a.isMuted)}get canSendAsHost(){var a;return this.privIsConnected&&((a=this.privParticipants.me)==null?void 0:a.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),this.privToken=a}createMeetingAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),this.privManager.createOrJoin(this.privProperties,void 0,(c=>{c||this.handleError(new Error(this.privErrors.permissionDeniedConnect),l),this.privRoom=c,this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}startMeetingAsync(a,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}addParticipantAsync(a,l,c){t.Contracts.throwIfNullOrUndefined(a,"Participant"),(0,e.marshalPromiseToCallbacks)(this.addParticipantImplAsync(a),l,c)}joinMeetingAsync(a,l,c,u,h){try{t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","conversationId")),t.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,a,(m=>{t.Contracts.throwIfNullOrUndefined(m,this.privErrors.permissionDeniedConnect),this.privRoom=m,this.privConfig.authorizationToken=m.cognitiveSpeechAuthToken,u&&u(m.cognitiveSpeechAuthToken)}),(m=>{this.handleError(m,h)}))}catch(m){this.handleError(m,h)}}deleteMeetingAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.deleteMeetingImplAsync(),a,l)}async deleteMeetingImplAsync(){t.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),t.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(a,l){(0,e.marshalPromiseToCallbacks)(this.endMeetingImplAsync(),a,l)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}muteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}muteParticipantAsync(a,l,c){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!0),(()=>{this.handleCallback(l,c)}),(h=>{this.handleError(h,c)}))}catch(u){this.handleError(u,c)}}removeParticipantAsync(a,l,c){try{if(t.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&a.hasOwnProperty("id"))(0,e.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(a),l,c);else{t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),c);let u="";typeof a=="string"?u=a:a.hasOwnProperty("id")?u=a.id:a.hasOwnProperty("userId")&&(u=a.userId),t.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(m=>m.id===u)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(u),(()=>{this.handleCallback(l,c)}),(m=>{this.handleError(m,c)}))}}catch(u){this.handleError(u,c)}}unlockMeetingAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}unmuteAllParticipantsAsync(a,l){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(a,l)}),(c=>{this.handleError(c,l)}))}catch(c){this.handleError(c,l)}}unmuteParticipantAsync(a,l,c){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","userId")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==a&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(a)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(a,!1),(()=>{this.handleCallback(l,c)}),(h=>{this.handleError(h,c)}))}catch(u){this.handleError(u,c)}}sendTextMessageAsync(a,l,c){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","message")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),a.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(a),(()=>{this.handleCallback(l,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}setTranslatedLanguagesAsync(a,l,c){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfArrayEmptyOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","languages")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(a),(()=>{this.handleCallback(l,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}changeNicknameAsync(a,l,c){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),t.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","nickname")),t.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(a),(()=>{this.handleCallback(l,c)}),(u=>{this.handleError(u,c)}))}catch(u){this.handleError(u,c)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(a){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await a.enforceAudioGating(),this.privTranscriberRecognizer=a,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){const a=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:a,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(a){if(this.privParticipants.addOrUpdateParticipant(a)!==void 0&&this.privTranscriberRecognizer){const c=this.meetingInfo;return c.participants=[a],this.privTranscriberRecognizer.pushMeetingEvent(c,"join")}}removeParticipantImplAsync(a){this.privParticipants.deleteParticipant(a.id);const l=this.meetingInfo;return l.participants=[a],this.privTranscriberRecognizer.pushMeetingEvent(l,"leave")}async close(a){var l;try{this.privIsConnected=!1,await((l=this.privConversationRecognizer)==null?void 0:l.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(c){throw c}a&&this.dispose()}handleCallback(a,l){if(a){try{a()}catch(c){l&&l(c)}a=void 0}}handleError(a,l){if(l)if(a instanceof Error){const c=a;l(c.name+": "+c.message)}else l(a)}toParticipants(a){const l=this.privParticipants.participants.map(c=>this.toParticipant(c));return a?l:l.filter(c=>c.isHost===!1)}toParticipant(a){return new r.Participant(a.id,a.avatar,a.displayName,a.isHost,a.isMuted,a.isUsingTts,a.preferredLanguage,a.voice)}getMuteAllCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMuteCommand(a,l){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setMute,participantId:a,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:l})}getLockCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getEjectCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(a,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.ejectParticipant,participantId:a,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getChangeNicknameCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(a,"nickname"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.ConversationTranslatorCommandTypes.changeNickname,nickname:a,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.ConversationTranslatorMessageTypes.participantCommand,value:a})}getMessageCommand(a){return t.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),t.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),t.Contracts.throwIfNullOrWhitespace(a,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:a,type:n.ConversationTranslatorMessageTypes.instantMessage})}}return Sc.MeetingImpl=s,Sc}var Gm={},iN;function yW(){if(iN)return Gm;iN=1,Object.defineProperty(Gm,"__esModule",{value:!0}),Gm.MeetingTranscriptionCanceledEventArgs=void 0;const n=zS();class e extends n.CancellationEventArgsBase{}return Gm.MeetingTranscriptionCanceledEventArgs=e,Gm}var Km={},sN;function SW(){if(sN)return Km;sN=1,Object.defineProperty(Km,"__esModule",{value:!0}),Km.MeetingTranscriber=void 0;const n=Ue(),e=He(),t=lt(),r=Pe(),i=KP();let s=class{constructor(a){this.privAudioConfig=a,this.privProperties=new r.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return t.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return r.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a)}joinMeetingAsync(a,l,c){const u=a;t.Contracts.throwIfNullOrUndefined(i.MeetingImpl,"Meeting"),this.privRecognizer=new n.TranscriberRecognizer(a.config,this.privAudioConfig),t.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),(0,e.marshalPromiseToCallbacks)(u.connectTranscriberRecognizer(this.privRecognizer),l,c)}startTranscribingAsync(a,l){this.privRecognizer.startContinuousRecognitionAsync(a,l)}stopTranscribingAsync(a,l){this.privRecognizer.stopContinuousRecognitionAsync(a,l)}leaveMeetingAsync(a,l){this.privRecognizer.disconnectCallbacks(),(0,e.marshalPromiseToCallbacks)((async()=>{})(),a,l)}close(a,l){t.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),a,l)}async dispose(a){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),a&&(this.privDisposedRecognizer=!0))}};return Km.MeetingTranscriber=s,Km}var Ym={},oN;function CW(){if(oN)return Ym;oN=1,Object.defineProperty(Ym,"__esModule",{value:!0}),Ym.ConversationTranscriptionResult=void 0;const n=Pe();let e=class extends n.RecognitionResult{constructor(r,i,s,o,a,l,c,u,h,m,v){super(r,i,s,o,a,l,c,h,m,v),this.privSpeakerId=u}get speakerId(){return this.privSpeakerId}};return Ym.ConversationTranscriptionResult=e,Ym}var aN;function KP(){return aN||(aN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConversationTranscriptionResult=n.MeetingTranscriber=n.MeetingTranscriptionCanceledEventArgs=n.MeetingImpl=n.Meeting=n.ParticipantChangedReason=n.User=n.Participant=n.ConversationTranscriber=n.ConversationTranslator=n.ConversationTranslationResult=n.ConversationTranslationEventArgs=n.ConversationTranslationCanceledEventArgs=n.ConversationParticipantsChangedEventArgs=n.ConversationExpirationEventArgs=n.ConversationCommon=n.ConversationImpl=n.Conversation=void 0;var e=$B();Object.defineProperty(n,"Conversation",{enumerable:!0,get:function(){return e.Conversation}}),Object.defineProperty(n,"ConversationImpl",{enumerable:!0,get:function(){return e.ConversationImpl}});var t=oW();Object.defineProperty(n,"ConversationCommon",{enumerable:!0,get:function(){return t.ConversationCommon}});var r=aW();Object.defineProperty(n,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return r.ConversationExpirationEventArgs}});var i=lW();Object.defineProperty(n,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return i.ConversationParticipantsChangedEventArgs}});var s=cW();Object.defineProperty(n,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return s.ConversationTranslationCanceledEventArgs}});var o=uW();Object.defineProperty(n,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return o.ConversationTranslationEventArgs}});var a=dW();Object.defineProperty(n,"ConversationTranslationResult",{enumerable:!0,get:function(){return a.ConversationTranslationResult}});var l=pW();Object.defineProperty(n,"ConversationTranslator",{enumerable:!0,get:function(){return l.ConversationTranslator}});var c=fW();Object.defineProperty(n,"ConversationTranscriber",{enumerable:!0,get:function(){return c.ConversationTranscriber}});var u=mW();Object.defineProperty(n,"Participant",{enumerable:!0,get:function(){return u.Participant}}),Object.defineProperty(n,"User",{enumerable:!0,get:function(){return u.User}});var h=gW();Object.defineProperty(n,"ParticipantChangedReason",{enumerable:!0,get:function(){return h.ParticipantChangedReason}});var m=vW();Object.defineProperty(n,"Meeting",{enumerable:!0,get:function(){return m.Meeting}}),Object.defineProperty(n,"MeetingImpl",{enumerable:!0,get:function(){return m.MeetingImpl}});var v=yW();Object.defineProperty(n,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return v.MeetingTranscriptionCanceledEventArgs}});var C=SW();Object.defineProperty(n,"MeetingTranscriber",{enumerable:!0,get:function(){return C.MeetingTranscriber}});var T=CW();Object.defineProperty(n,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return T.ConversationTranscriptionResult}})})(Wx)),Wx}var Cc={},lN;function YP(){if(lN)return Cc;lN=1,Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.SynthesisRequest=Cc.Synthesizer=void 0;const n=Ue(),e=He(),t=lt(),r=Pe();let i=class GB{constructor(a){const l=a;t.Contracts.throwIfNull(l,"speechConfig"),this.privProperties=l.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new e.Queue,this.tokenCredential=a.tokenCredential}get authorizationToken(){return this.properties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===n.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(a){const l={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let c=this.properties.getProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),u=this.properties.getProperty(r.PropertyId.SpeechServiceConnection_SynthVoice,""),h=GB.XMLEncode(a);return this.autoDetectSourceLanguage?c="en-US":u=u||l[c],u&&(h=`<voice name='${u}'>${h}</voice>`),h=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${c}'>${h}</speak>`,h}async dispose(a){this.privDisposed||(a&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const a=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(a.text,a.isSSML,a.requestId,a.cb,a.err,a.dataStream)}}createSynthesizerConfig(a){return new n.SynthesizerConfig(a,this.privProperties)}implCommonSynthesizeSetup(){let a=typeof window<"u"?"Browser":"Node",l="unknown",c="unknown";typeof navigator<"u"&&(a=a+"/"+navigator.platform,l=navigator.userAgent,c=navigator.appVersion);const u=this.createSynthesizerConfig(new n.SpeechServiceConfig(new n.Context(new n.OS(a,l,c)))),h=this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Key,void 0),m=h&&h!==""?new n.CognitiveSubscriptionKeyAuthentication(h):this.tokenCredential?new n.CognitiveTokenAuthentication(async()=>{try{const v=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(v==null?void 0:v.token)??""}catch(v){throw v}},async()=>{try{const v=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(v==null?void 0:v.token)??""}catch(v){throw v}}):new n.CognitiveTokenAuthentication(()=>{const v=this.privProperties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(v)},()=>{const v=this.privProperties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(v)});this.privAdapter=this.createSynthesisAdapter(m,this.privConnectionFactory,u),this.privRestAdapter=this.createRestSynthesisAdapter(m,u)}static XMLEncode(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};Cc.Synthesizer=i;class s{constructor(a,l,c,u,h,m){this.requestId=a,this.text=l,this.isSSML=c,this.cb=u,this.err=h,this.dataStream=m}}return Cc.SynthesisRequest=s,Cc}var Jm={},cN;function AW(){if(cN)return Jm;cN=1,Object.defineProperty(Jm,"__esModule",{value:!0}),Jm.SpeechSynthesizer=void 0;const n=Ue(),e=He(),t=wB(),r=US(),i=Ep(),s=lt(),o=Pe(),a=YP();let l=class KB extends o.Synthesizer{constructor(u,h){super(u),h!==null&&(h===void 0?this.audioConfig=typeof window>"u"?void 0:o.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=h),this.privConnectionFactory=new n.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(u,h,m){const v=u;return h.properties.mergeTo(v.properties),new KB(u,m)}speakTextAsync(u,h,m,v){this.speakImpl(u,!1,h,m,v)}speakSsmlAsync(u,h,m,v){this.speakImpl(u,!0,h,m,v)}async getVoicesAsync(u=""){return this.getVoices(u)}close(u,h){s.Contracts.throwIfDisposed(this.privDisposed),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),u,h)}get internalData(){return this.privAdapter}createSynthesisAdapter(u,h,m){return new n.SpeechSynthesisAdapter(u,h,m,this,this.audioConfig)}createRestSynthesisAdapter(u,h){return new n.SynthesisRestAdapter(h,u)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=r.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(o.SpeechSynthesisOutputFormat[this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(u,h,m,v,C){try{s.Contracts.throwIfDisposed(this.privDisposed);const T=(0,e.createNoDashGuid)();let E;C instanceof o.PushAudioOutputStreamCallback?E=new i.PushAudioOutputStreamImpl(C):C instanceof o.PullAudioOutputStream?E=C:C!==void 0?E=new t.AudioFileWriter(C):E=void 0,this.synthesisRequestQueue.enqueue(new a.SynthesisRequest(T,u,h,x=>{if(this.privSynthesizing=!1,m)try{m(x)}catch(P){v&&v(P)}m=void 0,this.adapterSpeak().catch(()=>{})},x=>{v&&v(x)},E)),this.adapterSpeak().catch(()=>{})}catch(T){if(v)if(T instanceof Error){const E=T;v(E.name+": "+E.message)}else v(T);this.dispose(!0).catch(()=>{})}}async getVoices(u){const h=(0,e.createNoDashGuid)(),m=await this.privRestAdapter.getVoicesList(h);if(m.ok&&Array.isArray(m.json)){let v=m.json;return u&&u.length>0&&(v=v.filter(C=>!!C.Locale&&C.Locale.toLowerCase()===u.toLowerCase())),new o.SynthesisVoicesResult(h,v,void 0)}else return new o.SynthesisVoicesResult(h,void 0,`Error: ${m.status}: ${m.statusText}`)}};return Jm.SpeechSynthesizer=l,Jm}var Xm={},uN;function TW(){if(uN)return Xm;uN=1,Object.defineProperty(Xm,"__esModule",{value:!0}),Xm.SynthesisResult=void 0;let n=class{constructor(t,r,i,s){this.privResultId=t,this.privReason=r,this.privErrorDetails=i,this.privProperties=s}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};return Xm.SynthesisResult=n,Xm}var Qm={},dN;function EW(){if(dN)return Qm;dN=1,Object.defineProperty(Qm,"__esModule",{value:!0}),Qm.SpeechSynthesisResult=void 0;const n=Pe();let e=class extends n.SynthesisResult{constructor(r,i,s,o,a,l){super(r,i,o,a),this.privAudioData=s,this.privAudioDuration=l}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};return Qm.SpeechSynthesisResult=e,Qm}var eg={},hN;function xW(){if(hN)return eg;hN=1,Object.defineProperty(eg,"__esModule",{value:!0}),eg.SpeechSynthesisEventArgs=void 0;let n=class{constructor(t){this.privResult=t}get result(){return this.privResult}};return eg.SpeechSynthesisEventArgs=n,eg}var tg={},pN;function wW(){if(pN)return tg;pN=1,Object.defineProperty(tg,"__esModule",{value:!0}),tg.SpeechSynthesisWordBoundaryEventArgs=void 0;let n=class{constructor(t,r,i,s,o,a){this.privAudioOffset=t,this.privDuration=r,this.privText=i,this.privWordLength=s,this.privTextOffset=o,this.privBoundaryType=a}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};return tg.SpeechSynthesisWordBoundaryEventArgs=n,tg}var ng={},fN;function bW(){if(fN)return ng;fN=1,Object.defineProperty(ng,"__esModule",{value:!0}),ng.SpeechSynthesisBookmarkEventArgs=void 0;let n=class{constructor(t,r){this.privAudioOffset=t,this.privText=r}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};return ng.SpeechSynthesisBookmarkEventArgs=n,ng}var rg={},mN;function PW(){if(mN)return rg;mN=1,Object.defineProperty(rg,"__esModule",{value:!0}),rg.SpeechSynthesisVisemeEventArgs=void 0;let n=class{constructor(t,r,i){this.privAudioOffset=t,this.privVisemeId=r,this.privAnimation=i}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};return rg.SpeechSynthesisVisemeEventArgs=n,rg}var Hx={},gN;function RW(){return gN||(gN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SpeechSynthesisBoundaryType=void 0,(function(e){e.Word="WordBoundary",e.Punctuation="PunctuationBoundary",e.Sentence="SentenceBoundary"})(n.SpeechSynthesisBoundaryType||(n.SpeechSynthesisBoundaryType={}))})(Hx)),Hx}var ig={},vN;function IW(){if(vN)return ig;vN=1,Object.defineProperty(ig,"__esModule",{value:!0}),ig.SynthesisVoicesResult=void 0;const n=Pe();let e=class extends n.SynthesisResult{constructor(r,i,s){if(Array.isArray(i)){super(r,n.ResultReason.VoicesListRetrieved,void 0,new n.PropertyCollection),this.privVoices=[];for(const o of i)this.privVoices.push(new n.VoiceInfo(o))}else super(r,n.ResultReason.Canceled,s||"Error information unavailable",new n.PropertyCollection)}get voices(){return this.privVoices}};return ig.SynthesisVoicesResult=e,ig}var Zx={},yN;function _W(){return yN||(yN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.VoiceInfo=n.SynthesisVoiceType=n.SynthesisVoiceGender=void 0;var e;(function(o){o[o.Unknown=0]="Unknown",o[o.Female=1]="Female",o[o.Male=2]="Male",o[o.Neutral=3]="Neutral"})(e=n.SynthesisVoiceGender||(n.SynthesisVoiceGender={}));var t;(function(o){o[o.Unknown=0]="Unknown",o[o.OnlineNeural=1]="OnlineNeural",o[o.OnlineStandard=2]="OnlineStandard",o[o.OfflineNeural=3]="OfflineNeural",o[o.OfflineStandard=4]="OfflineStandard",o[o.OnlineNeuralHD=5]="OnlineNeuralHD"})(t=n.SynthesisVoiceType||(n.SynthesisVoiceType={}));const r={[e[e.Neutral]]:e.Neutral,[e[e.Male]]:e.Male,[e[e.Female]]:e.Female},i={Neural:t.OnlineNeural,NeuralHD:t.OnlineNeuralHD};class s{constructor(a){if(this.privStyleList=[],a){if(this.privName=a.Name,this.privLocale=a.Locale,this.privShortName=a.ShortName,this.privLocaleName=a.LocaleName,this.privDisplayName=a.DisplayName,this.privLocalName=a.LocalName,this.privVoiceType=i[a.VoiceType]||t.Unknown,this.privGender=r[a.Gender]||e.Unknown,a.StyleList&&Array.isArray(a.StyleList))for(const l of a.StyleList)this.privStyleList.push(l);this.privSampleRateHertz=a.SampleRateHertz,this.privStatus=a.Status,a.ExtendedPropertyMap&&(this.privExtendedPropertyMap=a.ExtendedPropertyMap),this.privWordsPerMinute=a.WordsPerMinute,Array.isArray(a.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...a.SecondaryLocaleList]),Array.isArray(a.RolePlayList)&&(this.privRolePlayList=[...a.RolePlayList]),a.VoiceTag&&(this.privVoiceTag=a.VoiceTag)}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}get voiceTag(){return this.privVoiceTag}}n.VoiceInfo=s})(Zx)),Zx}var sg={},SN;function kW(){if(SN)return sg;SN=1,Object.defineProperty(sg,"__esModule",{value:!0}),sg.SpeakerAudioDestination=void 0;const n=He(),e=Ep(),t=Qu(),r=1800,i={[t.AudioFormatTag.PCM]:"audio/wav",[t.AudioFormatTag.MuLaw]:"audio/x-wav",[t.AudioFormatTag.MP3]:"audio/mpeg",[t.AudioFormatTag.OGG_OPUS]:"audio/ogg",[t.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[t.AudioFormatTag.ALaw]:"audio/x-wav",[t.AudioFormatTag.FLAC]:"audio/flac",[t.AudioFormatTag.AMR_WB]:"audio/amr-wb",[t.AudioFormatTag.G722]:"audio/G722"};let s=class{constructor(a){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=a||(0,n.createNoDashGuid)(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(a,l,c){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(a),this.updateSourceBuffer().then(()=>{l&&l()},u=>{c&&c(u)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(a),this.privBytesReceived+=a.byteLength)}close(a,l){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{a&&a()},c=>{l&&l(c)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===t.AudioFormatTag.PCM||this.privFormat.formatTag===t.AudioFormatTag.MuLaw||this.privFormat.formatTag===t.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let c=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(c).then(()=>{c=this.privFormat.addHeader(c);const u=new Blob([c],{type:i[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(u),this.notifyPlayback().then(()=>{a&&a()},h=>{l&&l(h)})},u=>{l&&l(u)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(a){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=a;const l=i[this.privFormat.formatTag];l===void 0?console.warn(`Unknown mimeType for format ${t.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(l)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=r,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(l),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(c=>{n.Events.instance.onEvent(new n.BackgroundEvent(c))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(c=>{n.Events.instance.onEvent(new n.BackgroundEvent(c))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(c=>{n.Events.instance.onEvent(new n.BackgroundEvent(c))})):(console.warn(`Format ${t.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new e.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var a;return((a=this.privAudio)==null?void 0:a.volume)??-1}set volume(a){this.privAudio&&(this.privAudio.volume=a)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(a,l){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{a&&a()},c=>{l&&l(c)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const a=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(a)}catch{this.privAudioBuffer.unshift(a),console.log("buffer filled, pausing addition of binaries until space is made");return}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};return sg.SpeakerAudioDestination=s,sg}var og={},CN;function MW(){if(CN)return og;CN=1,Object.defineProperty(og,"__esModule",{value:!0}),og.ConversationTranscriptionCanceledEventArgs=void 0;const n=zS();let e=class extends n.CancellationEventArgsBase{};return og.ConversationTranscriptionCanceledEventArgs=e,og}var ag={},AN;function NW(){if(AN)return ag;AN=1,Object.defineProperty(ag,"__esModule",{value:!0}),ag.MeetingTranscriptionCanceledEventArgs=void 0;const n=zS();let e=class extends n.CancellationEventArgsBase{};return ag.MeetingTranscriptionCanceledEventArgs=e,ag}var qx={},TN;function LW(){return TN||(TN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.PronunciationAssessmentGradingSystem=void 0,(function(e){e[e.FivePoint=1]="FivePoint",e[e.HundredMark=2]="HundredMark"})(n.PronunciationAssessmentGradingSystem||(n.PronunciationAssessmentGradingSystem={}))})(qx)),qx}var Gx={},EN;function DW(){return EN||(EN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.PronunciationAssessmentGranularity=void 0,(function(e){e[e.Phoneme=1]="Phoneme",e[e.Word=2]="Word",e[e.FullText=3]="FullText"})(n.PronunciationAssessmentGranularity||(n.PronunciationAssessmentGranularity={}))})(Gx)),Gx}var lg={},xN;function OW(){if(xN)return lg;xN=1,Object.defineProperty(lg,"__esModule",{value:!0}),lg.PronunciationAssessmentConfig=void 0;const n=lt(),e=Pe();let t=class YB{constructor(i,s=e.PronunciationAssessmentGradingSystem.FivePoint,o=e.PronunciationAssessmentGranularity.Phoneme,a=!1){n.Contracts.throwIfNullOrUndefined(i,"referenceText"),this.privProperties=new e.PropertyCollection,this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_ReferenceText,i),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_GradingSystem,e.PronunciationAssessmentGradingSystem[s]),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_Granularity,e.PronunciationAssessmentGranularity[o]),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,String(a))}static fromJSON(i){n.Contracts.throwIfNullOrUndefined(i,"json");const s=new YB("");return s.privProperties=new e.PropertyCollection,s.properties.setProperty(e.PropertyId.PronunciationAssessment_Json,i),s}toJSON(){return this.updateJson(),this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Params)}applyTo(i){this.updateJson();const s=i.internalData;s.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(e.PropertyId.PronunciationAssessment_Params),s.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(e.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(i){n.Contracts.throwIfNullOrWhitespace(i,"referenceText"),this.properties.setProperty(e.PropertyId.PronunciationAssessment_ReferenceText,i)}set phonemeAlphabet(i){n.Contracts.throwIfNullOrWhitespace(i,"phonemeAlphabet"),this.privPhonemeAlphabet=i}set enableMiscue(i){const s=i?"true":"false";this.properties.setProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,s)}get enableMiscue(){return this.properties.getProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(i){this.privNBestPhonemeCount=i}set enableProsodyAssessment(i){this.privEnableProsodyAssessment=i}get properties(){return this.privProperties}updateJson(){const i=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Json,"{}"),s=JSON.parse(i),o=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_ReferenceText);o&&(s.referenceText=o);const a=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_GradingSystem);a&&(s.gradingSystem=a);const l=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Granularity);l&&(s.granularity=l),this.privPhonemeAlphabet&&(s.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(s.nbestPhonemeCount=this.privNBestPhonemeCount),s.enableProsodyAssessment=this.privEnableProsodyAssessment,s.dimension="Comprehensive",this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_EnableMiscue)&&(s.enableMiscue=this.enableMiscue),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_Params,JSON.stringify(s))}};return lg.PronunciationAssessmentConfig=t,lg}var cg={},wN;function BW(){if(wN)return cg;wN=1,Object.defineProperty(cg,"__esModule",{value:!0}),cg.PronunciationAssessmentResult=void 0;const n=lt(),e=Pe();let t=class JB{constructor(i){const s=JSON.parse(i);n.Contracts.throwIfNullOrUndefined(s.NBest[0],"NBest"),this.privPronJson=s.NBest[0]}static fromResult(i){n.Contracts.throwIfNullOrUndefined(i,"result");const s=i.properties.getProperty(e.PropertyId.SpeechServiceResponse_JsonResult);return n.Contracts.throwIfNullOrUndefined(s,"json"),new JB(s)}get detailResult(){return this.privPronJson}get accuracyScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.AccuracyScore}get pronunciationScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.PronScore}get completenessScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.CompletenessScore}get fluencyScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.FluencyScore}get prosodyScore(){var i;return(i=this.detailResult.PronunciationAssessment)==null?void 0:i.ProsodyScore}};return cg.PronunciationAssessmentResult=t,cg}var ug={},bN;function FW(){if(bN)return ug;bN=1,Object.defineProperty(ug,"__esModule",{value:!0}),ug.AvatarConfig=void 0;const n=lt(),e=Pe();let t=class{constructor(i,s,o){this.privCustomized=!1,this.privUseBuiltInVoice=!1,n.Contracts.throwIfNullOrWhitespace(i,"character"),this.character=i,this.style=s,o===void 0&&(o=new e.AvatarVideoFormat),this.videoFormat=o}get customized(){return this.privCustomized}set customized(i){this.privCustomized=i}get useBuiltInVoice(){return this.privUseBuiltInVoice}set useBuiltInVoice(i){this.privUseBuiltInVoice=i}get photoAvatarBaseModel(){return this.privPhotoAvatarBaseModel}set photoAvatarBaseModel(i){this.privPhotoAvatarBaseModel=i}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(i){this.privBackgroundColor=i}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(i){this.privBackgroundImage=i}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(i){this.privRemoteIceServers=i}};return ug.AvatarConfig=t,ug}var Kx={},PN;function jW(){return PN||(PN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.AvatarEventArgs=n.AvatarEventTypes=void 0,(function(t){t.SwitchedToSpeaking="SwitchedToSpeaking",t.SwitchedToIdle="SwitchedToIdle",t.SessionClosed="SessionClosed"})(n.AvatarEventTypes||(n.AvatarEventTypes={}));class e{constructor(r,i){this.privOffset=r,this.privDescription=i}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}n.AvatarEventArgs=e})(Kx)),Kx}var dg={},hg={},RN;function XB(){if(RN)return hg;RN=1,Object.defineProperty(hg,"__esModule",{value:!0}),hg.SpeechSynthesisConnectionFactory=void 0;const n=Fr(),e=Pe(),t=pa(),r=Ue(),i=gi(),s=Vl();let o=class{constructor(){this.synthesisUri="/tts/cognitiveservices/websocket/v1"}async create(l,c,u){let h=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const m=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,void 0),v=t.ConnectionFactoryBase.getHostSuffix(m),C=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),T=C===void 0?"tts":"voice",E=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,"wss://"+m+"."+T+".speech"+v),x={},P={};if(c.token!==void 0&&c.token!==""&&(P[c.headerName]=c.token),P[i.HeaderNames.ConnectionId]=u,C!==void 0&&C!==""&&(!h||h.search(s.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(x[s.QueryParameterNames.CustomVoiceDeploymentId]=C),l.avatarEnabled&&(!h||h.search(s.QueryParameterNames.EnableAvatar)===-1)&&(x[s.QueryParameterNames.EnableAvatar]="true"),h){const I=new URL(h),M=I.pathname;(M===""||M==="/")&&(I.pathname=this.synthesisUri,h=await t.ConnectionFactoryBase.getRedirectUrlFromEndpoint(I.toString()))}h||(h=E+this.synthesisUri),l.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,h);const b=l.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new n.WebsocketConnection(h,x,P,new r.WebsocketMessageFormatter,n.ProxyInfo.fromParameters(l.parameters),b,u)}};return hg.SpeechSynthesisConnectionFactory=o,hg}var IN;function UW(){if(IN)return dg;IN=1,Object.defineProperty(dg,"__esModule",{value:!0}),dg.AvatarSynthesizer=void 0;const n=XB(),e=Ue(),t=He(),r=US(),i=Pe(),s=lt(),o=YP();let a=class extends i.Synthesizer{constructor(c,u){super(c),s.Contracts.throwIfNullOrUndefined(u,"avatarConfig"),this.privConnectionFactory=new n.SpeechSynthesisConnectionFactory,this.privAvatarConfig=u,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=r.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(i.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(c){s.Contracts.throwIfNullOrUndefined(c,"peerConnection"),this.privIceServers=c.getConfiguration().iceServers,s.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const u=new t.Deferred;c.onicegatheringstatechange=()=>{t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice gathering state: "+c.iceGatheringState,t.EventType.Debug)),c.iceGatheringState==="complete"&&(t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice gathering complete.",t.EventType.Info)),u.resolve())},c.onicecandidate=T=>{T.candidate?t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice candidate: "+T.candidate.candidate,t.EventType.Debug)):(t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice candidate: complete",t.EventType.Debug)),u.resolve())},setTimeout(()=>{c.iceGatheringState!=="complete"&&(t.Events.instance.onEvent(new t.PlatformEvent("peer connection: ice gathering timeout.",t.EventType.Warning)),u.resolve())},2e3);const h=await c.createOffer();await c.setLocalDescription(h),await u.promise,t.Events.instance.onEvent(new t.PlatformEvent("peer connection: got local SDP.",t.EventType.Info)),this.privProperties.setProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(c.localDescription));const m=await this.speak("",!1);if(m.reason!==i.ResultReason.SynthesizingAudioCompleted)return new i.SynthesisResult(m.resultId,m.reason,m.errorDetails,m.properties);const v=atob(m.properties.getProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP)),C=new RTCSessionDescription(JSON.parse(v));return await c.setRemoteDescription(C),new i.SynthesisResult(m.resultId,m.reason,void 0,m.properties)}async speakTextAsync(c){const u=await this.speak(c,!1);return new i.SynthesisResult(u.resultId,u.reason,u.errorDetails,u.properties)}async speakSsmlAsync(c){const u=await this.speak(c,!0);return new i.SynthesisResult(u.resultId,u.reason,u.errorDetails,u.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return s.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(c,u,h){return new e.AvatarSynthesisAdapter(c,u,h,this,this.privAvatarConfig)}createRestSynthesisAdapter(c,u){}createSynthesizerConfig(c){const u=super.createSynthesizerConfig(c);return u.avatarEnabled=!0,u}async speak(c,u){const h=(0,t.createNoDashGuid)(),m=new t.Deferred;return this.synthesisRequestQueue.enqueue(new o.SynthesisRequest(h,c,u,v=>{m.resolve(v),this.privSynthesizing=!1,this.adapterSpeak()},v=>{m.reject(v),this.privSynthesizing=!1})),this.adapterSpeak(),m.promise}};return dg.AvatarSynthesizer=a,dg}var Ac={},_N;function zW(){if(_N)return Ac;_N=1,Object.defineProperty(Ac,"__esModule",{value:!0}),Ac.AvatarVideoFormat=Ac.Coordinate=void 0;class n{constructor(r,i){this.x=r,this.y=i}}Ac.Coordinate=n;let e=class{constructor(r="H264",i=2e6,s=1920,o=1080){this.codec=r,this.bitrate=i,this.width=s,this.height=o}setCropRange(r,i){this.cropRange={bottomRight:i,topLeft:r}}};return Ac.AvatarVideoFormat=e,Ac}var pg={},kN;function WW(){if(kN)return pg;kN=1,Object.defineProperty(pg,"__esModule",{value:!0}),pg.AvatarWebRTCConnectionResult=void 0;const n=Pe();let e=class extends n.SynthesisResult{constructor(r,i,s,o,a){super(i,s,o,a),this.privSDPAnswer=r}get SDPAnswer(){return this.privSDPAnswer}};return pg.AvatarWebRTCConnectionResult=e,pg}var fg={},MN;function VW(){if(MN)return fg;MN=1,Object.defineProperty(fg,"__esModule",{value:!0}),fg.Diagnostics=void 0;const n=Fr(),e=He();let t=class{static SetLoggingLevel(i){this.privListener=new n.ConsoleLoggingListener(i),e.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(i){if(typeof window>"u")this.privListener&&(this.privListener.logPath=i);else throw new Error("File system logging not available in browser.")}static set onLogOutput(i){this.privListener&&(this.privListener.logCallback=i)}};return fg.Diagnostics=t,t.privListener=void 0,fg}var NN;function Pe(){return NN||(NN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.CustomCommandsConfig=n.BotFrameworkConfig=n.DialogServiceConfig=n.PhraseListGrammar=n.Connection=n.ServiceEventArgs=n.ConnectionEventArgs=n.CancellationErrorCode=n.CancellationDetails=n.CancellationDetailsBase=n.TranslationRecognitionCanceledEventArgs=n.NoMatchDetails=n.NoMatchReason=n.Translations=n.TranslationRecognizer=n.SpeechRecognizer=n.Recognizer=n.PropertyId=n.PropertyCollection=n.SpeechTranslationConfigImpl=n.SpeechTranslationConfig=n.SpeechConfigImpl=n.SpeechConfig=n.ResultReason=n.TranslationSynthesisResult=n.TranslationRecognitionResult=n.TranslationSynthesisEventArgs=n.TranslationRecognitionEventArgs=n.SpeechRecognitionCanceledEventArgs=n.MeetingTranscriptionEventArgs=n.ConversationTranscriptionEventArgs=n.SpeechRecognitionEventArgs=n.SpeechRecognitionResult=n.RecognitionResult=n.OutputFormat=n.RecognitionEventArgs=n.SessionEventArgs=n.KeywordRecognitionModel=n.PushAudioOutputStreamCallback=n.PullAudioInputStreamCallback=n.CancellationReason=n.PushAudioOutputStream=n.PullAudioOutputStream=n.AudioOutputStream=n.PushAudioInputStream=n.PullAudioInputStream=n.AudioInputStream=n.AudioFormatTag=n.AudioStreamFormat=n.AudioConfig=void 0,n.AvatarSynthesizer=n.AvatarEventArgs=n.AvatarConfig=n.LanguageIdMode=n.PronunciationAssessmentResult=n.PronunciationAssessmentConfig=n.PronunciationAssessmentGranularity=n.PronunciationAssessmentGradingSystem=n.MeetingTranscriptionCanceledEventArgs=n.ConversationTranscriptionCanceledEventArgs=n.SpeakerAudioDestination=n.VoiceInfo=n.SynthesisVoiceType=n.SynthesisVoiceGender=n.SynthesisVoicesResult=n.SpeechSynthesisBoundaryType=n.SpeechSynthesisVisemeEventArgs=n.SpeechSynthesisBookmarkEventArgs=n.SpeechSynthesisWordBoundaryEventArgs=n.SpeechSynthesisEventArgs=n.SpeechSynthesisResult=n.SynthesisResult=n.SpeechSynthesizer=n.SpeechSynthesisOutputFormat=n.Synthesizer=n.User=n.ParticipantChangedReason=n.Participant=n.MeetingTranscriber=n.Meeting=n.ConversationTranscriptionResult=n.ConversationTranscriber=n.ConversationTranslator=n.ConversationTranslationResult=n.ConversationTranslationEventArgs=n.ConversationTranslationCanceledEventArgs=n.ConversationParticipantsChangedEventArgs=n.ConversationExpirationEventArgs=n.Conversation=n.SourceLanguageConfig=n.AutoDetectSourceLanguageResult=n.AutoDetectSourceLanguageConfig=n.ConnectionMessage=n.ConnectionMessageEventArgs=n.BaseAudioPlayer=n.ProfanityOption=n.ServicePropertyChannel=n.TurnStatusReceivedEventArgs=n.ActivityReceivedEventArgs=n.DialogServiceConnector=void 0,n.LogLevel=n.Diagnostics=n.AvatarWebRTCConnectionResult=n.Coordinate=n.AvatarVideoFormat=void 0;var e=g8();Object.defineProperty(n,"AudioConfig",{enumerable:!0,get:function(){return e.AudioConfig}});var t=Qu();Object.defineProperty(n,"AudioStreamFormat",{enumerable:!0,get:function(){return t.AudioStreamFormat}}),Object.defineProperty(n,"AudioFormatTag",{enumerable:!0,get:function(){return t.AudioFormatTag}});var r=bB();Object.defineProperty(n,"AudioInputStream",{enumerable:!0,get:function(){return r.AudioInputStream}}),Object.defineProperty(n,"PullAudioInputStream",{enumerable:!0,get:function(){return r.PullAudioInputStream}}),Object.defineProperty(n,"PushAudioInputStream",{enumerable:!0,get:function(){return r.PushAudioInputStream}});var i=Ep();Object.defineProperty(n,"AudioOutputStream",{enumerable:!0,get:function(){return i.AudioOutputStream}}),Object.defineProperty(n,"PullAudioOutputStream",{enumerable:!0,get:function(){return i.PullAudioOutputStream}}),Object.defineProperty(n,"PushAudioOutputStream",{enumerable:!0,get:function(){return i.PushAudioOutputStream}});var s=v8();Object.defineProperty(n,"CancellationReason",{enumerable:!0,get:function(){return s.CancellationReason}});var o=y8();Object.defineProperty(n,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return o.PullAudioInputStreamCallback}});var a=S8();Object.defineProperty(n,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return a.PushAudioOutputStreamCallback}});var l=C8();Object.defineProperty(n,"KeywordRecognitionModel",{enumerable:!0,get:function(){return l.KeywordRecognitionModel}});var c=A8();Object.defineProperty(n,"SessionEventArgs",{enumerable:!0,get:function(){return c.SessionEventArgs}});var u=T8();Object.defineProperty(n,"RecognitionEventArgs",{enumerable:!0,get:function(){return u.RecognitionEventArgs}});var h=E8();Object.defineProperty(n,"OutputFormat",{enumerable:!0,get:function(){return h.OutputFormat}});var m=x8();Object.defineProperty(n,"RecognitionResult",{enumerable:!0,get:function(){return m.RecognitionResult}});var v=w8();Object.defineProperty(n,"SpeechRecognitionResult",{enumerable:!0,get:function(){return v.SpeechRecognitionResult}});var C=b8();Object.defineProperty(n,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return C.SpeechRecognitionEventArgs}}),Object.defineProperty(n,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return C.ConversationTranscriptionEventArgs}}),Object.defineProperty(n,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return C.MeetingTranscriptionEventArgs}});var T=P8();Object.defineProperty(n,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return T.SpeechRecognitionCanceledEventArgs}});var E=R8();Object.defineProperty(n,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return E.TranslationRecognitionEventArgs}});var x=I8();Object.defineProperty(n,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return x.TranslationSynthesisEventArgs}});var P=_B();Object.defineProperty(n,"TranslationRecognitionResult",{enumerable:!0,get:function(){return P.TranslationRecognitionResult}});var b=_8();Object.defineProperty(n,"TranslationSynthesisResult",{enumerable:!0,get:function(){return b.TranslationSynthesisResult}});var I=k8();Object.defineProperty(n,"ResultReason",{enumerable:!0,get:function(){return I.ResultReason}});var M=M8();Object.defineProperty(n,"SpeechConfig",{enumerable:!0,get:function(){return M.SpeechConfig}}),Object.defineProperty(n,"SpeechConfigImpl",{enumerable:!0,get:function(){return M.SpeechConfigImpl}});var N=N8();Object.defineProperty(n,"SpeechTranslationConfig",{enumerable:!0,get:function(){return N.SpeechTranslationConfig}}),Object.defineProperty(n,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return N.SpeechTranslationConfigImpl}});var D=MB();Object.defineProperty(n,"PropertyCollection",{enumerable:!0,get:function(){return D.PropertyCollection}});var j=qP();Object.defineProperty(n,"PropertyId",{enumerable:!0,get:function(){return j.PropertyId}});var F=L8();Object.defineProperty(n,"Recognizer",{enumerable:!0,get:function(){return F.Recognizer}});var z=D8();Object.defineProperty(n,"SpeechRecognizer",{enumerable:!0,get:function(){return z.SpeechRecognizer}});var W=O8();Object.defineProperty(n,"TranslationRecognizer",{enumerable:!0,get:function(){return W.TranslationRecognizer}});var H=B8();Object.defineProperty(n,"Translations",{enumerable:!0,get:function(){return H.Translations}});var V=F8();Object.defineProperty(n,"NoMatchReason",{enumerable:!0,get:function(){return V.NoMatchReason}});var K=j8();Object.defineProperty(n,"NoMatchDetails",{enumerable:!0,get:function(){return K.NoMatchDetails}});var ee=U8();Object.defineProperty(n,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return ee.TranslationRecognitionCanceledEventArgs}});var G=jB();Object.defineProperty(n,"CancellationDetailsBase",{enumerable:!0,get:function(){return G.CancellationDetailsBase}});var X=z8();Object.defineProperty(n,"CancellationDetails",{enumerable:!0,get:function(){return X.CancellationDetails}});var Y=W8();Object.defineProperty(n,"CancellationErrorCode",{enumerable:!0,get:function(){return Y.CancellationErrorCode}});var ce=V8();Object.defineProperty(n,"ConnectionEventArgs",{enumerable:!0,get:function(){return ce.ConnectionEventArgs}});var ae=$8();Object.defineProperty(n,"ServiceEventArgs",{enumerable:!0,get:function(){return ae.ServiceEventArgs}});var $=OB();Object.defineProperty(n,"Connection",{enumerable:!0,get:function(){return $.Connection}});var J=H8();Object.defineProperty(n,"PhraseListGrammar",{enumerable:!0,get:function(){return J.PhraseListGrammar}});var de=GP();Object.defineProperty(n,"DialogServiceConfig",{enumerable:!0,get:function(){return de.DialogServiceConfig}});var me=Z8();Object.defineProperty(n,"BotFrameworkConfig",{enumerable:!0,get:function(){return me.BotFrameworkConfig}});var Te=q8();Object.defineProperty(n,"CustomCommandsConfig",{enumerable:!0,get:function(){return Te.CustomCommandsConfig}});var le=K8();Object.defineProperty(n,"DialogServiceConnector",{enumerable:!0,get:function(){return le.DialogServiceConnector}});var se=Y8();Object.defineProperty(n,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return se.ActivityReceivedEventArgs}});var ie=X8();Object.defineProperty(n,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return ie.TurnStatusReceivedEventArgs}});var Se=Q8();Object.defineProperty(n,"ServicePropertyChannel",{enumerable:!0,get:function(){return Se.ServicePropertyChannel}});var re=eW();Object.defineProperty(n,"ProfanityOption",{enumerable:!0,get:function(){return re.ProfanityOption}});var pe=tW();Object.defineProperty(n,"BaseAudioPlayer",{enumerable:!0,get:function(){return pe.BaseAudioPlayer}});var ne=nW();Object.defineProperty(n,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return ne.ConnectionMessageEventArgs}});var ve=DB();Object.defineProperty(n,"ConnectionMessage",{enumerable:!0,get:function(){return ve.ConnectionMessage}});var ge=rW();Object.defineProperty(n,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return ge.AutoDetectSourceLanguageConfig}});var Ie=iW();Object.defineProperty(n,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return Ie.AutoDetectSourceLanguageResult}});var fe=sW();Object.defineProperty(n,"SourceLanguageConfig",{enumerable:!0,get:function(){return fe.SourceLanguageConfig}});var xe=KP();Object.defineProperty(n,"Conversation",{enumerable:!0,get:function(){return xe.Conversation}}),Object.defineProperty(n,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return xe.ConversationExpirationEventArgs}}),Object.defineProperty(n,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return xe.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(n,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return xe.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(n,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return xe.ConversationTranslationEventArgs}}),Object.defineProperty(n,"ConversationTranslationResult",{enumerable:!0,get:function(){return xe.ConversationTranslationResult}}),Object.defineProperty(n,"ConversationTranslator",{enumerable:!0,get:function(){return xe.ConversationTranslator}}),Object.defineProperty(n,"ConversationTranscriber",{enumerable:!0,get:function(){return xe.ConversationTranscriber}}),Object.defineProperty(n,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return xe.ConversationTranscriptionResult}}),Object.defineProperty(n,"Meeting",{enumerable:!0,get:function(){return xe.Meeting}}),Object.defineProperty(n,"MeetingTranscriber",{enumerable:!0,get:function(){return xe.MeetingTranscriber}}),Object.defineProperty(n,"Participant",{enumerable:!0,get:function(){return xe.Participant}}),Object.defineProperty(n,"ParticipantChangedReason",{enumerable:!0,get:function(){return xe.ParticipantChangedReason}}),Object.defineProperty(n,"User",{enumerable:!0,get:function(){return xe.User}});var $e=YP();Object.defineProperty(n,"Synthesizer",{enumerable:!0,get:function(){return $e.Synthesizer}});var Ge=PB();Object.defineProperty(n,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return Ge.SpeechSynthesisOutputFormat}});var be=AW();Object.defineProperty(n,"SpeechSynthesizer",{enumerable:!0,get:function(){return be.SpeechSynthesizer}});var gt=TW();Object.defineProperty(n,"SynthesisResult",{enumerable:!0,get:function(){return gt.SynthesisResult}});var vi=EW();Object.defineProperty(n,"SpeechSynthesisResult",{enumerable:!0,get:function(){return vi.SpeechSynthesisResult}});var Ss=xW();Object.defineProperty(n,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return Ss.SpeechSynthesisEventArgs}});var Cs=wW();Object.defineProperty(n,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return Cs.SpeechSynthesisWordBoundaryEventArgs}});var As=bW();Object.defineProperty(n,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return As.SpeechSynthesisBookmarkEventArgs}});var ye=PW();Object.defineProperty(n,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return ye.SpeechSynthesisVisemeEventArgs}});var st=RW();Object.defineProperty(n,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return st.SpeechSynthesisBoundaryType}});var wt=IW();Object.defineProperty(n,"SynthesisVoicesResult",{enumerable:!0,get:function(){return wt.SynthesisVoicesResult}});var lr=_W();Object.defineProperty(n,"SynthesisVoiceGender",{enumerable:!0,get:function(){return lr.SynthesisVoiceGender}}),Object.defineProperty(n,"SynthesisVoiceType",{enumerable:!0,get:function(){return lr.SynthesisVoiceType}}),Object.defineProperty(n,"VoiceInfo",{enumerable:!0,get:function(){return lr.VoiceInfo}});var Ts=kW();Object.defineProperty(n,"SpeakerAudioDestination",{enumerable:!0,get:function(){return Ts.SpeakerAudioDestination}});var Es=MW();Object.defineProperty(n,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return Es.ConversationTranscriptionCanceledEventArgs}});var rd=NW();Object.defineProperty(n,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return rd.MeetingTranscriptionCanceledEventArgs}});var Hl=LW();Object.defineProperty(n,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return Hl.PronunciationAssessmentGradingSystem}});var Zl=DW();Object.defineProperty(n,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return Zl.PronunciationAssessmentGranularity}});var id=OW();Object.defineProperty(n,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return id.PronunciationAssessmentConfig}});var ya=BW();Object.defineProperty(n,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return ya.PronunciationAssessmentResult}});var Sa=WB();Object.defineProperty(n,"LanguageIdMode",{enumerable:!0,get:function(){return Sa.LanguageIdMode}});var Ca=FW();Object.defineProperty(n,"AvatarConfig",{enumerable:!0,get:function(){return Ca.AvatarConfig}});var ql=jW();Object.defineProperty(n,"AvatarEventArgs",{enumerable:!0,get:function(){return ql.AvatarEventArgs}});var kp=UW();Object.defineProperty(n,"AvatarSynthesizer",{enumerable:!0,get:function(){return kp.AvatarSynthesizer}});var oo=zW();Object.defineProperty(n,"AvatarVideoFormat",{enumerable:!0,get:function(){return oo.AvatarVideoFormat}}),Object.defineProperty(n,"Coordinate",{enumerable:!0,get:function(){return oo.Coordinate}});var Aa=WW();Object.defineProperty(n,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return Aa.AvatarWebRTCConnectionResult}});var YS=VW();Object.defineProperty(n,"Diagnostics",{enumerable:!0,get:function(){return YS.Diagnostics}});var JS=EB();Object.defineProperty(n,"LogLevel",{enumerable:!0,get:function(){return JS.LogLevel}})})(_x)),_x}var LN;function $W(){if(LN)return Jf;LN=1,Object.defineProperty(Jf,"__esModule",{value:!0}),Jf.ProxyInfo=void 0;const n=Pe();let e=class QB{constructor(r,i,s,o){this.privProxyHostName=r,this.privProxyPort=i,this.privProxyUserName=s,this.privProxyPassword=o}static fromParameters(r){return new QB(r.getProperty(n.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(r.getProperty(n.PropertyId.SpeechServiceConnection_ProxyPort),10),r.getProperty(n.PropertyId.SpeechServiceConnection_ProxyUserName),r.getProperty(n.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(r){return this.fromParameters(r.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};return Jf.ProxyInfo=e,Jf}var mg={},Yx,DN;function HW(){if(DN)return Yx;DN=1;const n=new Set(["json","buffer","string"]);return Yx=e=>(...t)=>{const r=new Set;let i,s,o,a="";return t.forEach(l=>{if(typeof l=="string")if(l.toUpperCase()===l)if(i){const c=`Can't set method to ${l}, already set to ${i}.`;throw new Error(c)}else i=l;else if(l.startsWith("http:")||l.startsWith("https:"))a=l;else if(n.has(l))s=l;else throw new Error(`Unknown encoding, ${l}`);else if(typeof l=="number")r.add(l);else if(typeof l=="object")if(Array.isArray(l)||l instanceof Set)l.forEach(c=>r.add(c));else{if(o)throw new Error("Cannot set headers twice.");o=l}else throw new Error(`Unknown type: ${typeof l}`)}),i||(i="GET"),r.size===0&&r.add(200),e(r,i,s,o,a)},Yx}var Jx,ON;function ZW(){if(ON)return Jx;ON=1;const n=HW();class e extends Error{constructor(i,...s){super(...s),Error.captureStackTrace&&Error.captureStackTrace(this,e),this.name="StatusError",this.message=i.statusMessage,this.statusCode=i.status,this.res=i,this.json=i.json.bind(i),this.text=i.text.bind(i),this.arrayBuffer=i.arrayBuffer.bind(i);let o;Object.defineProperty(this,"responseBody",{get:()=>(o||(o=this.arrayBuffer()),o)}),this.headers={};for(const[l,c]of i.headers.entries())this.headers[l.toLowerCase()]=c}}return Jx=n((r,i,s,o,a)=>async(l,c,u={})=>{l=a+(l||"");let h=new URL(l);if(o||(o={}),h.username&&(o.Authorization="Basic "+btoa(h.username+":"+h.password),h=new URL(h.protocol+"//"+h.host+h.pathname+h.search)),h.protocol!=="https:"&&h.protocol!=="http:")throw new Error(`Unknown protocol, ${h.protocol}`);if(c&&!(c instanceof ArrayBuffer||ArrayBuffer.isView(c)||typeof c=="string"))if(typeof c=="object")c=JSON.stringify(c),o["Content-Type"]="application/json";else throw new Error("Unknown body type.");u=new Headers({...o||{},...u});const m=await fetch(h,{method:i,headers:u,body:c});if(m.statusCode=m.status,!r.has(m.status))throw new e(m);return s==="json"?m.json():s==="buffer"?m.arrayBuffer():s==="string"?m.text():m}),Jx}var BN;function qW(){return BN||(BN=1,(function(n){var e=mg&&mg.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(n,"__esModule",{value:!0}),n.RestMessageAdapter=n.RestRequestType=void 0;const t=e(ZW()),r=He();var i;(function(o){o.Get="GET",o.Post="POST",o.Delete="DELETE",o.File="file"})(i=n.RestRequestType||(n.RestRequestType={}));let s=class{constructor(a){if(!a)throw new r.ArgumentNullError("configParams");this.privHeaders=a.headers,this.privIgnoreCache=a.ignoreCache}static extractHeaderValue(a,l){let c="";try{const u=l.trim().split(/[\r\n]+/),h={};u.forEach(m=>{const v=m.split(": "),C=v.shift().toLowerCase(),T=v.join(": ");h[C]=T}),c=h[a.toLowerCase()]}catch{}return c}set options(a){this.privHeaders=a.headers,this.privIgnoreCache=a.ignoreCache}setHeaders(a,l){this.privHeaders[a]=l}request(a,l,c={},u=null){const h=new r.Deferred,m=a===i.File?"POST":a,v=(T,E={})=>{const x=T;return{data:JSON.stringify(E),headers:JSON.stringify(T.headers),json:E,ok:T.statusCode>=200&&T.statusCode<300,status:T.statusCode,statusText:E.error?E.error.message:x.statusText?x.statusText:x.statusMessage}},C=T=>{const E=(0,t.default)(l,m,this.privHeaders,200,201,202,204,400,401,402,403,404),x=this.queryParams(c)===""?"":`?${this.queryParams(c)}`;E(x,T).then(async P=>{if(a===i.Delete||P.statusCode===204)h.resolve(v(P));else try{const b=await P.json();h.resolve(v(P,b))}catch{h.resolve(v(P))}}).catch(P=>{h.reject(P)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),a===i.Post&&u&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),C(u),h.promise}queryParams(a={}){return Object.keys(a).map(l=>encodeURIComponent(l)+"="+encodeURIComponent(a[l])).join("&")}};n.RestMessageAdapter=s})(mg)),mg}var gg={},FN;function eF(){if(FN)return gg;FN=1,Object.defineProperty(gg,"__esModule",{value:!0}),gg.RestConfigBase=void 0;let n=class kC{static get requestOptions(){return kC.privDefaultRequestOptions}static get configParams(){return kC.privDefaultParams}static get restErrors(){return kC.privRestErrors}};return gg.RestConfigBase=n,n.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},n.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},n.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"},gg}var jN;function Fr(){return jN||(jN=1,(function(n){var e=hc&&hc.__createBinding||(Object.create?(function(r,i,s,o){o===void 0&&(o=s),Object.defineProperty(r,o,{enumerable:!0,get:function(){return i[s]}})}):(function(r,i,s,o){o===void 0&&(o=s),r[o]=i[s]})),t=hc&&hc.__exportStar||function(r,i){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,r,s)};Object.defineProperty(n,"__esModule",{value:!0}),t(c8(),n),t(u8(),n),t(d8(),n),t(h8(),n),t(p8(),n),t(f8(),n),t(xB(),n),t(m8(),n),t($W(),n),t(qW(),n),t(eF(),n)})(hc)),hc}var vg={},UN;function eT(){if(UN)return vg;UN=1,Object.defineProperty(vg,"__esModule",{value:!0}),vg.SpeechConnectionMessage=void 0;const n=He(),e=gi();class t extends n.ConnectionMessage{constructor(i,s,o,a,l,c,u,h){if(!s)throw new n.ArgumentNullError("path");if(!o)throw new n.ArgumentNullError("requestId");const m={};if(m[e.HeaderNames.Path]=s,m[e.HeaderNames.RequestId]=o,m[e.HeaderNames.RequestTimestamp]=new Date().toISOString(),a&&(m[e.HeaderNames.ContentType]=a),c&&(m[e.HeaderNames.RequestStreamId]=c),u)for(const v in u)v&&(m[v]=u[v]);h?super(i,l,m,h):super(i,l,m),this.privPath=s,this.privRequestId=o,this.privContentType=a,this.privStreamId=c,this.privAdditionalHeaders=u}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(i){let s=null,o=null,a=null,l=null;const c={};if(i.headers)for(const u in i.headers)u&&(u.toLowerCase()===e.HeaderNames.Path.toLowerCase()?s=i.headers[u]:u.toLowerCase()===e.HeaderNames.RequestId.toLowerCase()?o=i.headers[u]:u.toLowerCase()===e.HeaderNames.ContentType.toLowerCase()?a=i.headers[u]:u.toLowerCase()===e.HeaderNames.RequestStreamId.toLowerCase()?l=i.headers[u]:c[u]=i.headers[u]);return new t(i.messageType,s,o,a,i.body,l,c,i.id)}}return vg.SpeechConnectionMessage=t,vg}var Xx={},zN;function GW(){return zN||(zN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SegmentationMode=void 0,(function(e){e.Normal="Normal",e.Disabled="Disabled",e.Custom="Custom",e.Semantic="Semantic"})(n.SegmentationMode||(n.SegmentationMode={}))})(Xx)),Xx}var Qx={},WN;function KW(){return WN||(WN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.NextAction=void 0,(function(e){e.None="None",e.Synthesize="Synthesize"})(n.NextAction||(n.NextAction={}))})(Qx)),Qx}var ew={},VN;function YW(){return VN||(VN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Mode=void 0,(function(e){e.None="None",e.Always="Always"})(n.Mode||(n.Mode={}))})(ew)),ew}var tw={},$N;function JW(){return $N||($N=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.LanguageIdDetectionPriority=n.LanguageIdDetectionMode=void 0,(function(e){e.DetectAtAudioStart="DetectAtAudioStart",e.DetectContinuous="DetectContinuous",e.DetectSegments="DetectSegments"})(n.LanguageIdDetectionMode||(n.LanguageIdDetectionMode={})),(function(e){e.Auto="Auto",e.PrioritizeLatency="PrioritizeLatency",e.PrioritizeAccuracy="PrioritizeAccuracy"})(n.LanguageIdDetectionPriority||(n.LanguageIdDetectionPriority={}))})(tw)),tw}var nw={},HN;function XW(){return HN||(HN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.NextAction=void 0,(function(e){e.Recognize="Recognize",e.None="None"})(n.NextAction||(n.NextAction={}))})(nw)),nw}var rw={},ZN;function QW(){return ZN||(ZN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnUnknownAction=void 0,(function(e){e.RecognizeWithDefaultLanguage="RecognizeWithDefaultLanguage",e.None="None"})(n.OnUnknownAction||(n.OnUnknownAction={}))})(rw)),rw}var iw={},qN;function e6(){return qN||(qN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ResultType=void 0,(function(e){e.Auto="Auto",e.StableFragment="StableFragment",e.Hypothesis="Hypothesis",e.None="None"})(n.ResultType||(n.ResultType={}))})(iw)),iw}var sw={},GN;function t6(){return GN||(GN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.PhraseResultOutputType=void 0,(function(e){e.Always="Always",e.None="None"})(n.PhraseResultOutputType||(n.PhraseResultOutputType={}))})(sw)),sw}var ow={},KN;function n6(){return KN||(KN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.NextAction=void 0,(function(e){e.None="None",e.Translate="Translate"})(n.NextAction||(n.NextAction={}))})(ow)),ow}var YN;function r6(){if(YN)return Hf;YN=1,Object.defineProperty(Hf,"__esModule",{value:!0}),Hf.ServiceRecognizerBase=void 0;const n=Fr(),e=He(),t=Pe(),r=Ue(),i=eT(),s=GW(),o=vs(),a=KW(),l=YW(),c=JW(),u=XW(),h=QW(),m=e6(),v=t6(),C=n6();let T=class fv{constructor(x,P,b,I,M){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!x)throw new e.ArgumentNullError("authentication");if(!P)throw new e.ArgumentNullError("connectionFactory");if(!b)throw new e.ArgumentNullError("audioSource");if(!I)throw new e.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=I.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=x,this.privConnectionFactory=P,this.privAudioSource=b,this.privRecognizerConfig=I,this.privIsDisposed=!1,this.privRecognizer=M,this.privRequestSession=new r.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new e.EventSource,this.privServiceEvents=new e.EventSource,this.privDynamicGrammar=new r.DynamicGrammarBuilder,this.privSpeechContext=new r.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new r.AgentConfig,this.privRecognizerConfig.parameters.getProperty(t.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=e.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(D=>{if(D.name==="ConnectionClosedEvent"){const j=D;(j.statusCode===1003||j.statusCode===1007||j.statusCode===1002||j.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(t.CancellationReason.Error,j.statusCode===1007?t.CancellationErrorCode.BadRequestParameters:t.CancellationErrorCode.ConnectionFailure,`${j.reason} websocket error code: ${j.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=(0,e.createNoDashGuid)())}setTranslationJson(){const x=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(x!==void 0){const P=x.split(","),b=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),I=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationCategoryId,void 0),M=b!==void 0?a.NextAction.Synthesize:a.NextAction.None;if(this.privSpeechContext.getContext().translation={onPassthrough:{action:M},onSuccess:{action:M},output:{includePassThroughResults:!0,interimResults:{mode:l.Mode.Always}},targetLanguages:P},I!==void 0&&(this.privSpeechContext.getContext().translation.category=I),b!==void 0){const D={};for(const j of P)D[j]=b;this.privSpeechContext.getContext().synthesis={defaultVoices:D}}const N=this.privSpeechContext.getContext().phraseDetection||{};N.onSuccess={action:C.NextAction.Translate},N.onInterim={action:C.NextAction.Translate},this.privSpeechContext.getContext().phraseDetection=N}}setSpeechSegmentationTimeoutJson(){const x=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0),P=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_SegmentationMaximumTimeMs,void 0),b=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_SegmentationStrategy,void 0),I={mode:s.SegmentationMode.Normal};let M=!1;if(b!==void 0){M=!0;let N=s.SegmentationMode.Normal;switch(b.toLowerCase()){case"default":break;case"time":N=s.SegmentationMode.Custom;break;case"semantic":N=s.SegmentationMode.Semantic;break}I.mode=N}if(x!==void 0){M=!0;const N=parseInt(x,10);I.mode=s.SegmentationMode.Custom,I.segmentationSilenceTimeoutMs=N}if(P!==void 0){M=!0;const N=parseInt(P,10);I.mode=s.SegmentationMode.Custom,I.segmentationForcedTimeoutMs=N}if(M){const N=this.privSpeechContext.getContext().phraseDetection||{};switch(N.mode=this.recognitionMode,this.recognitionMode){case o.RecognitionMode.Conversation:N.conversation=N.conversation??{segmentation:{}},N.conversation.segmentation=I;break;case o.RecognitionMode.Interactive:N.interactive=N.interactive??{segmentation:{}},N.interactive.segmentation=I;break;case o.RecognitionMode.Dictation:N.dictation=N.dictation??{},N.dictation.segmentation=I;break}this.privSpeechContext.getContext().phraseDetection=N}}setLanguageIdJson(){const x=this.privSpeechContext.getContext().phraseDetection||{};if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){const P=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");P.length===1&&P[0]===r.AutoDetectSourceLanguagesOpenRangeOptionName&&(P[0]="UND");let b;this.privRecognizerConfig.languageIdMode==="Continuous"?b=c.LanguageIdDetectionMode.DetectContinuous:b=c.LanguageIdDetectionMode.DetectAtAudioStart,this.privSpeechContext.getContext().languageId={languages:P,mode:b,onSuccess:{action:u.NextAction.Recognize},onUnknown:{action:h.OnUnknownAction.None},priority:c.LanguageIdDetectionPriority.PrioritizeLatency},this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:m.ResultType.Auto},phraseResults:{resultType:v.PhraseResultOutputType.Always}};const I=this.privRecognizerConfig.sourceLanguageModels;I!==void 0&&(x.customModels=I,x.onInterim={action:C.NextAction.None},x.onSuccess={action:C.NextAction.None})}this.privSpeechContext.getContext().phraseDetection=x}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(r.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple]).toLowerCase()===t.OutputFormat[t.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}setSpeechStartEventSensitivityJson(){const x=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.Speech_StartEventSensitivity,void 0);if(x!==void 0){let P=!1;switch(x.toLowerCase()){case o.SpeechStartEventSensitivity.Low:case o.SpeechStartEventSensitivity.Medium:case o.SpeechStartEventSensitivity.High:P=!0;break}if(P){const b=this.privSpeechContext.getContext().phraseDetection||{};b.voiceOnsetSensitivity=x.toLowerCase(),this.privSpeechContext.getContext().phraseDetection=b}}}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(x){this.privRecognizerConfig.parameters.setProperty(t.PropertyId.ConversationTranslator_Token,x)}set authentication(x){this.privAuthentication=x}isDisposed(){return this.privIsDisposed}async dispose(x){if(this.privIsDisposed=!0,this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose(x)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(x,P,b){if(this.recognizeOverride!==void 0){await this.recognizeOverride(x,P,b);return}if(this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=x,this.privRecognizerConfig.recognitionEndpointVersion==="2"){const j=this.privSpeechContext.getContext().phraseDetection||{};j.mode=x,this.privSpeechContext.getContext().phraseDetection=j}this.setLanguageIdJson(),this.setTranslationJson(),this.privRecognizerConfig.autoDetectSourceLanguages!==void 0&&this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&this.setupTranslationWithLanguageId(),this.setSpeechSegmentationTimeoutJson(),this.setOutputDetailLevelJson(),this.setSpeechStartEventSensitivityJson(),this.privSuccessCallback=P,this.privErrorCallback=b,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const I=this.connectImpl();let M;try{const j=await this.audioSource.attach(this.privRequestSession.audioNodeId),F=await this.audioSource.format,z=await this.audioSource.deviceInfo;this.privIsLiveAudio=z.type&&z.type===r.type.Microphones,M=new n.ReplayableAudioNode(j,F.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(M,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:z}}catch(j){throw await this.privRequestSession.onStopRecognizing(),j}try{await I}catch(j){await this.cancelRecognitionLocal(t.CancellationReason.Error,t.CancellationErrorCode.ConnectionFailure,j);return}const N=new t.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,N),this.receiveMessage(),this.sendAudio(M).catch(async j=>{await this.cancelRecognitionLocal(t.CancellationReason.Error,t.CancellationErrorCode.RuntimeError,j)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(x,P){this.connectImpl().then(()=>{try{x&&x()}catch(b){P&&P(b)}},b=>{try{P&&P(b)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(t.CancellationReason.Error,t.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(x){}async sendNetworkMessage(x,P){const b=typeof P=="string"?e.MessageType.Text:e.MessageType.Binary,I=typeof P=="string"?"application/json":"";return(await this.fetchConnection()).send(new i.SpeechConnectionMessage(b,x,this.privRequestSession.requestId,I,P))}set activityTemplate(x){this.privActivityTemplate=x}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(x){this.privExpectContentAssessmentResponse=x}async sendTelemetryData(){const x=this.privRequestSession.getTelemetry();if(fv.telemetryDataEnabled!==!0||this.privIsDisposed||x===null)return;if(fv.telemetryData)try{fv.telemetryData(x)}catch{}await(await this.fetchConnection()).send(new i.SpeechConnectionMessage(e.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",x))}async cancelRecognitionLocal(x,P,b){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,x,P,b))}async receiveMessage(){try{if(this.privIsDisposed)return;let x=await this.fetchConnection();const P=await x.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!P)return this.receiveMessage();this.privServiceHasSentMessage=!0;const b=i.SpeechConnectionMessage.fromConnectionMessage(P);if(b.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(b.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const I=r.SpeechDetected.fromJSON(b.textBody,this.privRequestSession.currentTurnAudioOffset),M=new t.RecognitionEventArgs(I.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,M);break;case"speech.enddetected":let N;b.textBody.length>0?N=b.textBody:N="{ Offset: 0 }";const D=r.SpeechDetected.fromJSON(N,this.privRequestSession.currentTurnAudioOffset),j=new t.RecognitionEventArgs(D.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,j);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(t.CancellationReason.EndOfStream,t.CancellationErrorCode.NoError,void 0));const F=new t.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,F);return}else x=await this.fetchConnection(),await this.sendPrePayloadJSON(x);break;default:await this.processTypeSpecificMessages(b)||this.privServiceEvents&&this.serviceEvents.onEvent(new e.ServiceEvent(b.path.toLowerCase(),b.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){const x=this.privRequestSession.recognitionBytesSent,P=this.privAverageBytesPerMs!==0?x/this.privAverageBytesPerMs:0;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(P)}sendSpeechContext(x,P){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const b=this.speechContext.toJSON();if(P&&this.privRequestSession.onSpeechContext(),b)return x.send(new i.SpeechConnectionMessage(e.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",b))}setupTranslationWithLanguageId(){const x=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0),P=this.privRecognizerConfig.autoDetectSourceLanguages!==void 0;if(x!==void 0&&P){this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:m.ResultType.None},phraseResults:{resultType:v.PhraseResultOutputType.None}};const b=this.privSpeechContext.getContext().translation;if(b){const I=this.privRecognizerConfig.sourceLanguageModels;if(I!==void 0&&I.length>0){const N=this.privSpeechContext.getContext().phraseDetection||{};N.customModels=I,this.privSpeechContext.getContext().phraseDetection=N}this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&(b.onSuccess={action:a.NextAction.Synthesize},b.onPassthrough={action:a.NextAction.Synthesize})}}}noOp(){}async sendPrePayloadJSON(x,P=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(x);await this.sendSpeechContext(x,P),await this.sendWaveHeader(x)}async sendWaveHeader(x){const P=await this.audioSource.format;return x.send(new i.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",P.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(x=>x.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(x,P,b){if(P.onSpeechContext(),fv.telemetryDataEnabled!==!0){const M={context:{system:JSON.parse(b).context.system}};b=JSON.stringify(M)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){const I=JSON.parse(b);I.context.DisableReferenceChannel="True",I.context.MicSpec="1_0_0",b=JSON.stringify(I)}if(b)return x.send(new i.SpeechConnectionMessage(e.MessageType.Text,"speech.config",P.requestId,"application/json",b))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(x=>x.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(x){const P=await this.audioSource.format;this.privAverageBytesPerMs=P.avgBytesPerSec/1e3;let b=Date.now();const I=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),M=P.avgBytesPerSec/1e3*parseInt(I,10),N=this.privRequestSession.recogNumber,D=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===N){const j=await this.fetchConnection(),F=await x.read();if(this.privRequestSession.isSpeechEnded)return;let z,W;if(!F||F.isEnd?(z=null,W=0):(z=F.buffer,this.privRequestSession.onAudioSent(z.byteLength),M>=this.privRequestSession.bytesSent?W=0:W=Math.max(0,b-Date.now())),W!==0&&await this.delay(W),z!==null&&(b=Date.now()+z.byteLength*1e3/(P.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===N)if(j.send(new i.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,null,z)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),F!=null&&F.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return D()}};return D()}async retryableConnect(){let x=!1;this.privAuthFetchEventId=(0,e.createNoDashGuid)();const P=this.privRequestSession.sessionId;this.privConnectionId=P!==void 0?P:(0,e.createNoDashGuid)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let b=0,I="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){this.privRequestSession.onRetryConnection();const N=await(x?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId));await this.privRequestSession.onAuthCompleted(!1);const D=await this.privConnectionFactory.create(this.privRecognizerConfig,N,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(D.events),D.events.attach(F=>{this.connectionEvents.onEvent(F)});const j=await D.open();if(j.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(j.statusCode),Promise.resolve(D);j.statusCode===1006&&(x=!0),b=j.statusCode,I=j.reason}return await this.privRequestSession.onConnectionEstablishCompleted(b,I),Promise.reject(`Unable to contact server. StatusCode: ${b}, ${this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${I}`)}delay(x){return new Promise(P=>this.privSetTimeout(P,x))}writeBufferToConsole(x){let P="Buffer Size: ";if(x===null)P+="null";else{const b=new Uint8Array(x);P+=`${x.byteLength}\r
`;for(let I=0;I<x.byteLength;I++)P+=b[I].toString(16).padStart(2,"0")+" ",(I+1)%16===0&&(console.info(P),P="")}console.info(P)}async sendFinalAudio(){await(await this.fetchConnection()).send(new i.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){const x=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(x):(await this.sendSpeechServiceConfig(x,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(x,!1),x)}};return Hf.ServiceRecognizerBase=T,T.telemetryDataEnabled=!0,Hf}var yg={},JN;function i6(){if(JN)return yg;JN=1,Object.defineProperty(yg,"__esModule",{value:!0}),yg.ConversationServiceRecognizer=void 0;const n=Pe(),e=Ue();let t=class extends e.ServiceRecognizerBase{constructor(i,s,o,a,l){super(i,s,o,a,l),this.handleSpeechPhraseMessage=async c=>this.handleSpeechPhrase(c),this.handleSpeechHypothesisMessage=c=>this.handleSpeechHypothesis(c)}processTypeSpecificMessages(i){}handleRecognizedCallback(i,s,o){}handleRecognizingCallback(i,s,o){}async processSpeechMessages(i){let s=!1;switch(i.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(i.textBody),s=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(i.textBody),s=!0;break}return s}cancelRecognition(i,s,o,a,l){}async handleSpeechPhrase(i){const s=e.SimpleSpeechPhrase.fromJSON(i,this.privRequestSession.currentTurnAudioOffset),o=e.EnumTranslation.implTranslateRecognitionResult(s.RecognitionStatus);let a;const l=new n.PropertyCollection;if(l.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,i),this.privRequestSession.onPhraseRecognized(s.Offset+s.Duration),n.ResultReason.Canceled===o){const c=e.EnumTranslation.implTranslateCancelResult(s.RecognitionStatus),u=e.EnumTranslation.implTranslateCancelErrorCode(s.RecognitionStatus);await this.cancelRecognitionLocal(c,u,e.EnumTranslation.implTranslateErrorDetails(u))}else if(s.RecognitionStatus!==e.RecognitionStatus.EndOfDictation){if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===n.OutputFormat[n.OutputFormat.Simple])a=new n.SpeechRecognitionResult(this.privRequestSession.requestId,o,s.DisplayText,s.Duration,s.Offset,s.Language,s.LanguageDetectionConfidence,s.SpeakerId,void 0,s.asJson(),l);else{const c=e.DetailedSpeechPhrase.fromJSON(i,this.privRequestSession.currentTurnAudioOffset);a=new n.SpeechRecognitionResult(this.privRequestSession.requestId,o,c.Text,c.Duration,c.Offset,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,c.asJson(),l)}this.handleRecognizedCallback(a,a.offset,this.privRequestSession.sessionId)}}handleSpeechHypothesis(i){const s=e.SpeechHypothesis.fromJSON(i,this.privRequestSession.currentTurnAudioOffset),o=new n.PropertyCollection;o.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,i);const a=new n.SpeechRecognitionResult(this.privRequestSession.requestId,n.ResultReason.RecognizingSpeech,s.Text,s.Duration,s.Offset,s.Language,s.LanguageDetectionConfidence,s.SpeakerId,void 0,s.asJson(),o);this.privRequestSession.onHypothesis(s.Offset),this.handleRecognizingCallback(a,s.Duration,this.privRequestSession.sessionId)}};return yg.ConversationServiceRecognizer=t,yg}var aw={},XN;function s6(){return XN||(XN=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.RecognizerConfig=n.SpeechResultFormat=void 0;const e=Pe(),t=Ue(),r=vs();(function(s){s[s.Simple=0]="Simple",s[s.Detailed=1]="Detailed"})(n.SpeechResultFormat||(n.SpeechResultFormat={}));class i{constructor(o,a){this.privSpeechServiceConfig=o||new t.SpeechServiceConfig(new t.Context(null)),this.privParameters=a,this.privMaxRetryCount=parseInt(a.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=a.getProperty(e.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(o){this.privRecognitionMode=o,this.privRecognitionActivityTimeout=o===r.RecognitionMode.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=r.RecognitionMode[o]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==r.RecognitionMode.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(e.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2")}set recognitionEndpointVersion(o){this.parameters.setProperty(e.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,o)}get sourceLanguageModels(){const o=[];let a=!1;if(this.autoDetectSourceLanguages!==void 0)for(const l of this.autoDetectSourceLanguages.split(",")){const c=l+e.PropertyId.SpeechServiceConnection_EndpointId.toString(),u=this.parameters.getProperty(c,void 0);u!==void 0?(o.push({language:l,endpoint:u}),a=!0):o.push({language:l,endpoint:""})}return a?o:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(o){this.privEnableSpeakerId=o}}n.RecognizerConfig=i})(aw)),aw}var lw={},QN;function o6(){return QN||(QN=1,Object.defineProperty(lw,"__esModule",{value:!0})),lw}var Sg={},eL;function a6(){if(eL)return Sg;eL=1,Object.defineProperty(Sg,"__esModule",{value:!0}),Sg.WebsocketMessageFormatter=void 0;const n=He(),e=`\r
`;let t=class{toConnectionMessage(i){const s=new n.Deferred;try{if(i.messageType===n.MessageType.Text){const o=i.textContent;let a={},l=null;if(o){const c=o.split(`\r
\r
`);c&&c.length>0&&(a=this.parseHeaders(c[0]),c.length>1&&(l=c[1]))}s.resolve(new n.ConnectionMessage(i.messageType,l,a,i.id))}else if(i.messageType===n.MessageType.Binary){const o=i.binaryContent;let a={},l=null;if(!o||o.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const c=new DataView(o),u=c.getInt16(0);if(o.byteLength<u+2)throw new Error("Invalid binary message format. Header content missing.");let h="";for(let m=0;m<u;m++)h+=String.fromCharCode(c.getInt8(m+2));a=this.parseHeaders(h),o.byteLength>u+2&&(l=o.slice(2+u)),s.resolve(new n.ConnectionMessage(i.messageType,l,a,i.id))}}catch(o){s.reject(`Error formatting the message. Error: ${o}`)}return s.promise}fromConnectionMessage(i){const s=new n.Deferred;try{if(i.messageType===n.MessageType.Text){const o=`${this.makeHeaders(i)}${e}${i.textBody?i.textBody:""}`;s.resolve(new n.RawWebsocketMessage(n.MessageType.Text,o,i.id))}else if(i.messageType===n.MessageType.Binary){const o=this.makeHeaders(i),a=i.binaryBody,l=this.stringToArrayBuffer(o),c=new Int8Array(l),u=c.byteLength,h=new Int8Array(2+u+(a?a.byteLength:0));if(h[0]=u>>8&255,h[1]=u&255,h.set(c,2),a){const v=new Int8Array(a);h.set(v,2+u)}const m=h.buffer;s.resolve(new n.RawWebsocketMessage(n.MessageType.Binary,m,i.id))}}catch(o){s.reject(`Error formatting the message. ${o}`)}return s.promise}makeHeaders(i){let s="";if(i.headers)for(const o in i.headers)o&&(s+=`${o}: ${i.headers[o]}${e}`);return s}parseHeaders(i){const s={};if(i){const o=i.match(/[^\r\n]+/g);if(s){for(const a of o)if(a){const l=a.indexOf(":"),c=l>0?a.substr(0,l).trim().toLowerCase():a,u=l>0&&a.length>l+1?a.substr(l+1).trim():"";s[c]=u}}}return s}stringToArrayBuffer(i){const s=new ArrayBuffer(i.length),o=new DataView(s);for(let a=0;a<i.length;a++)o.setUint8(a,i.charCodeAt(a));return s}};return Sg.WebsocketMessageFormatter=t,Sg}var Cg={},tL;function l6(){if(tL)return Cg;tL=1,Object.defineProperty(Cg,"__esModule",{value:!0}),Cg.SpeechConnectionFactory=void 0;const n=Fr(),e=Ue(),t=Pe(),r=pa(),i=Ue(),s=gi(),o=Vl(),a=vs();let l=class extends r.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/stt/speech/universal/v"}async create(u,h,m){let v=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const C=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),T=r.ConnectionFactoryBase.getHostSuffix(C),E=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+C+".stt.speech"+T),x={},P=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),b=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(P?(!v||v.search(o.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(x[o.QueryParameterNames.CustomSpeechDeploymentId]=P):b&&(!v||v.search(o.QueryParameterNames.Language)===-1)&&(x[o.QueryParameterNames.Language]=b),(!v||v.search(o.QueryParameterNames.Format)===-1)&&(x[o.QueryParameterNames.Format]=u.parameters.getProperty(e.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple]).toLowerCase()),u.autoDetectSourceLanguages!==void 0&&(x[o.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(u,x,v),v){const j=new URL(v),F=j.pathname;(F===""||F==="/")&&(j.pathname=this.universalUri+u.recognitionEndpointVersion,v=await r.ConnectionFactoryBase.getRedirectUrlFromEndpoint(j.toString()))}if(!v)switch(u.recognitionMode){case a.RecognitionMode.Conversation:u.parameters.getProperty(e.ForceDictationPropertyName,"false")==="true"?v=E+this.dictationRelativeUri:u.recognitionEndpointVersion!==void 0&&parseInt(u.recognitionEndpointVersion,10)>1?v=`${E}${this.universalUri}${u.recognitionEndpointVersion}`:v=E+this.conversationRelativeUri;break;case a.RecognitionMode.Dictation:v=E+this.dictationRelativeUri;break;default:u.recognitionEndpointVersion!==void 0&&parseInt(u.recognitionEndpointVersion,10)>1?v=`${E}${this.universalUri}${u.recognitionEndpointVersion}`:v=E+this.interactiveRelativeUri;break}const I={};h.token!==void 0&&h.token!==""&&(I[h.headerName]=h.token),I[s.HeaderNames.ConnectionId]=m,I.connectionId=m;const M=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",N=new n.WebsocketConnection(v,x,I,new i.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(u),M,m),D=N.uri;return u.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,D),N}};return Cg.SpeechConnectionFactory=l,Cg}var Ag={},nL;function c6(){if(nL)return Ag;nL=1,Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.ConversationTranscriberConnectionFactory=void 0;const n=Fr(),e=Pe(),t=Ue(),r=pa(),i=Ue(),s=gi(),o=Vl();let a=class extends r.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.conversationRelativeUriV1="/speech/recognition/conversation/cognitiveservices/v1"}async create(c,u,h){let m=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const v=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,void 0),C=r.ConnectionFactoryBase.getHostSuffix(v),T=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,"wss://"+v+".stt.speech"+C),E={},x=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),P=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(x?(!m||m.search(o.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(E[o.QueryParameterNames.CustomSpeechDeploymentId]=x):P&&(!m||m.search(o.QueryParameterNames.Language)===-1)&&(E[o.QueryParameterNames.Language]=P),c.autoDetectSourceLanguages!==void 0&&(E[o.QueryParameterNames.EnableLanguageId]="true"),c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,void 0)==="1")m=`${T}${this.universalUri}`;else{if(this.setV2UrlParams(c,E,m),m){const j=new URL(m),F=j.pathname;(F===""||F==="/")&&(j.pathname=this.universalUri,m=await r.ConnectionFactoryBase.getRedirectUrlFromEndpoint(j.toString()))}m||(m=`${T}${this.conversationRelativeUriV1}`)}const I={};u.token!==void 0&&u.token!==""&&(I[u.headerName]=u.token),I[s.HeaderNames.ConnectionId]=h;const M=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",N=new n.WebsocketConnection(m,E,I,new i.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(c),M,h),D=N.uri;return c.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,D),N}setV2UrlParams(c,u,h){new Map([[e.PropertyId.Speech_SegmentationSilenceTimeoutMs,o.QueryParameterNames.SegmentationSilenceTimeoutMs],[e.PropertyId.SpeechServiceConnection_EnableAudioLogging,o.QueryParameterNames.EnableAudioLogging],[e.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,o.QueryParameterNames.EndSilenceTimeoutMs],[e.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,o.QueryParameterNames.InitialSilenceTimeoutMs],[e.PropertyId.SpeechServiceResponse_PostProcessingOption,o.QueryParameterNames.Postprocessing],[e.PropertyId.SpeechServiceResponse_ProfanityOption,o.QueryParameterNames.Profanity],[e.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,o.QueryParameterNames.StableIntermediateThreshold]]).forEach((C,T)=>{this.setUrlParameter(T,C,c,u,h)});const v=JSON.parse(c.parameters.getProperty(t.ServicePropertiesPropertyName,"{}"));Object.keys(v).forEach(C=>{u[C]=v[C]})}};return Ag.ConversationTranscriberConnectionFactory=a,Ag}var Tg={},rL;function u6(){if(rL)return Tg;rL=1,Object.defineProperty(Tg,"__esModule",{value:!0}),Tg.TranscriberConnectionFactory=void 0;const n=Fr(),e=Pe(),t=pa(),r=Ue(),i=gi(),s=Vl();let o=class extends t.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(l,c,u){let h=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const m=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,"centralus"),v=t.ConnectionFactoryBase.getHostSuffix(m),C="wss://transcribe."+m+".cts.speech"+v+this.multiaudioRelativeUri,T=l.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,C),E={};this.setQueryParams(E,l,h),h||(h=T);const x={};c.token!==void 0&&c.token!==""&&(x[c.headerName]=c.token),x[i.HeaderNames.ConnectionId]=u,l.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,h);const P=l.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new n.WebsocketConnection(h,E,x,new r.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(l),P,u))}setQueryParams(l,c,u){const h=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),m=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);h&&!(s.QueryParameterNames.CustomSpeechDeploymentId in l)&&(l[s.QueryParameterNames.CustomSpeechDeploymentId]=h),m&&!(s.QueryParameterNames.Language in l)&&(l[s.QueryParameterNames.Language]=m);const v=c.parameters.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",C=c.parameters.getProperty(r.OutputFormatPropertyName,e.OutputFormat[e.OutputFormat.Simple])!==e.OutputFormat[e.OutputFormat.Simple];(v||C)&&(l[s.QueryParameterNames.Format]=e.OutputFormat[e.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(c,l,u)}};return Tg.TranscriberConnectionFactory=o,Tg}var Eg={},iL;function d6(){if(iL)return Eg;iL=1,Object.defineProperty(Eg,"__esModule",{value:!0}),Eg.TranslationConnectionFactory=void 0;const n=Fr(),e=HB(),t=Pe(),r=pa(),i=Ue(),s=gi(),o=Vl(),a=vs();let l=class extends r.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.translationV1Uri="/speech/translation/cognitiveservices/v1"}async create(u,h,m){let v=this.getEndpointUrl(u);const C={};if(this.setQueryParams(C,u,v),v){const P=new URL(v),b=P.pathname;(b===""||b==="/")&&(P.pathname=this.universalUri,v=await r.ConnectionFactoryBase.getRedirectUrlFromEndpoint(P.toString()))}const T={};h.token!==void 0&&h.token!==""&&(T[h.headerName]=h.token),T[s.HeaderNames.ConnectionId]=m,u.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,v);const E=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new n.WebsocketConnection(v,C,T,new i.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(u),E,m)}getEndpointUrl(u,h){const m=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region),v=r.ConnectionFactoryBase.getHostSuffix(m);let C=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);return C?h===!0?C:e.StringUtils.formatString(C,{region:m}):(u.parameters.getProperty("SPEECH-ForceV1Endpoint","false")==="true"?C=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+v)+this.translationV1Uri:C=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+v)+this.universalUri,h===!0?C:e.StringUtils.formatString(C,{region:m}))}setQueryParams(u,h,m){u.from=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage),u.to=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationToLanguages),u.scenario=h.recognitionMode===a.RecognitionMode.Interactive?"interactive":h.recognitionMode===a.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(h,u,m),this.setUrlParameter(t.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,o.QueryParameterNames.StableTranslation,h,u,m);const v=h.parameters.getProperty(t.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);v!==void 0&&(u.voice=v,u.features="requireVoice")}};return Eg.TranslationConnectionFactory=l,Eg}var xg={},sL;function h6(){if(sL)return xg;sL=1,Object.defineProperty(xg,"__esModule",{value:!0}),xg.EnumTranslation=void 0;const n=Pe(),e=Ue();let t=class{static implTranslateRecognitionResult(i,s=!1){let o=n.ResultReason.Canceled;switch(i){case e.RecognitionStatus.Success:o=n.ResultReason.RecognizedSpeech;break;case e.RecognitionStatus.EndOfDictation:o=s?n.ResultReason.RecognizedSpeech:n.ResultReason.NoMatch;break;case e.RecognitionStatus.NoMatch:case e.RecognitionStatus.InitialSilenceTimeout:case e.RecognitionStatus.BabbleTimeout:o=n.ResultReason.NoMatch;break;case e.RecognitionStatus.Error:case e.RecognitionStatus.BadRequest:case e.RecognitionStatus.Forbidden:default:o=n.ResultReason.Canceled;break}return o}static implTranslateCancelResult(i){let s=n.CancellationReason.EndOfStream;switch(i){case e.RecognitionStatus.Success:case e.RecognitionStatus.EndOfDictation:case e.RecognitionStatus.NoMatch:s=n.CancellationReason.EndOfStream;break;case e.RecognitionStatus.InitialSilenceTimeout:case e.RecognitionStatus.BabbleTimeout:case e.RecognitionStatus.Error:case e.RecognitionStatus.BadRequest:case e.RecognitionStatus.Forbidden:default:s=n.CancellationReason.Error;break}return s}static implTranslateCancelErrorCode(i){let s=n.CancellationErrorCode.NoError;switch(i){case e.RecognitionStatus.Error:s=n.CancellationErrorCode.ServiceError;break;case e.RecognitionStatus.TooManyRequests:s=n.CancellationErrorCode.TooManyRequests;break;case e.RecognitionStatus.BadRequest:s=n.CancellationErrorCode.BadRequestParameters;break;case e.RecognitionStatus.Forbidden:s=n.CancellationErrorCode.Forbidden;break;default:s=n.CancellationErrorCode.NoError;break}return s}static implTranslateErrorDetails(i){let s="The speech service encountered an internal error and could not continue.";switch(i){case n.CancellationErrorCode.Forbidden:s="The recognizer is using a free subscription that ran out of quota.";break;case n.CancellationErrorCode.BadRequestParameters:s="Invalid parameter or unsupported audio format in the request.";break;case n.CancellationErrorCode.TooManyRequests:s="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break}return s}};return xg.EnumTranslation=t,xg}var cw={},oL;function p6(){return oL||(oL=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.RecognitionStatus=n.SynthesisStatus=void 0,(function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"})(n.SynthesisStatus||(n.SynthesisStatus={})),(function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests",e[e.BadRequest=7]="BadRequest",e[e.Forbidden=8]="Forbidden"})(n.RecognitionStatus||(n.RecognitionStatus={}))})(cw)),cw}var wg={},aL;function f6(){if(aL)return wg;aL=1,Object.defineProperty(wg,"__esModule",{value:!0}),wg.TranslationSynthesisEnd=void 0;const n=Ue();let e=class tF{constructor(r){this.privSynthesisEnd=JSON.parse(r),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=n.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=n.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(r){return new tF(r)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};return wg.TranslationSynthesisEnd=e,wg}var bg={},lL;function m6(){if(lL)return bg;lL=1,Object.defineProperty(bg,"__esModule",{value:!0}),bg.TranslationHypothesis=void 0;const n=lt(),e=$P();let t=class $w{constructor(i,s){this.privTranslationHypothesis=i,this.privTranslationHypothesis.Offset+=s,this.privTranslationHypothesis.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationHypothesis.Translation.TranslationStatus)}static fromJSON(i,s){return new $w(JSON.parse(i),s)}static fromTranslationResponse(i,s){n.Contracts.throwIfNullOrUndefined(i,"translationHypothesis");const o=i.SpeechHypothesis;return i.SpeechHypothesis=void 0,o.Translation=i,new $w(o,s)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){var i;return(i=this.privTranslationHypothesis.PrimaryLanguage)==null?void 0:i.Language}asJson(){const i={...this.privTranslationHypothesis};return i.Translation!==void 0?JSON.stringify({...i,TranslationStatus:e.TranslationStatus[i.Translation.TranslationStatus]}):JSON.stringify(i)}mapTranslationStatus(i){if(typeof i=="string")return e.TranslationStatus[i];if(typeof i=="number")return i}};return bg.TranslationHypothesis=t,bg}var Pg={},cL;function g6(){if(cL)return Pg;cL=1,Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.TranslationPhrase=void 0;const n=lt(),e=Ue(),t=$P();let r=class Hw{constructor(s,o){this.privTranslationPhrase=s,this.privTranslationPhrase.Offset+=o,this.privTranslationPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privTranslationPhrase.RecognitionStatus),this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationPhrase.Translation.TranslationStatus))}static fromJSON(s,o){return new Hw(JSON.parse(s),o)}static fromTranslationResponse(s,o){n.Contracts.throwIfNullOrUndefined(s,"translationResponse");const a=s.SpeechPhrase;return s.SpeechPhrase=void 0,a.Translation=s,a.Text=a.DisplayText,new Hw(a,o)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){var s;return(s=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:s.Language}get Confidence(){var s;return(s=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:s.Confidence}get Translation(){return this.privTranslationPhrase.Translation}asJson(){const s={...this.privTranslationPhrase},o={...s,RecognitionStatus:e.RecognitionStatus[s.RecognitionStatus]};return s.Translation&&(o.Translation={...s.Translation,TranslationStatus:t.TranslationStatus[s.Translation.TranslationStatus]}),JSON.stringify(o)}mapRecognitionStatus(s){if(typeof s=="string")return e.RecognitionStatus[s];if(typeof s=="number")return s}mapTranslationStatus(s){if(typeof s=="string")return t.TranslationStatus[s];if(typeof s=="number")return s}};return Pg.TranslationPhrase=r,Pg}var Rg={},uL;function v6(){if(uL)return Rg;uL=1,Object.defineProperty(Rg,"__esModule",{value:!0}),Rg.TranslationServiceRecognizer=void 0;const n=He(),e=Pe(),t=Ue();let r=class extends t.ConversationServiceRecognizer{constructor(s,o,a,l,c){super(s,o,a,l,c),this.privTranslationRecognizer=c,this.connectionEvents.attach(u=>{u.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(s){const o=new e.PropertyCollection;let a=await this.processSpeechMessages(s);if(a)return!0;const l=async u=>{if(o.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,u.asJson()),this.privRequestSession.onPhraseRecognized(u.Offset+u.Duration),u.RecognitionStatus===t.RecognitionStatus.Success){const h=this.fireEventForResult(u,o);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,h)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(h.result)}catch(m){this.privErrorCallback&&this.privErrorCallback(m)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const h=t.EnumTranslation.implTranslateRecognitionResult(u.RecognitionStatus),m=new e.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,h,u.Text,u.Duration,u.Offset,u.Language,u.Confidence,void 0,u.asJson(),o);if(h===e.ResultReason.Canceled){const v=t.EnumTranslation.implTranslateCancelResult(u.RecognitionStatus),C=t.EnumTranslation.implTranslateCancelErrorCode(u.RecognitionStatus);await this.cancelRecognitionLocal(v,C,t.EnumTranslation.implTranslateErrorDetails(C))}else if(u.RecognitionStatus!==t.RecognitionStatus.EndOfDictation){const v=new e.TranslationRecognitionEventArgs(m,m.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,v)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(m)}catch(C){this.privErrorCallback&&this.privErrorCallback(C)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}a=!0}},c=u=>{o.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,u.asJson());const h=this.fireEventForResult(u,o);if(this.privRequestSession.onHypothesis(h.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,h)}catch{}a=!0};switch(s.messageType===n.MessageType.Text&&o.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,s.textBody),s.path.toLowerCase()){case"translation.hypothesis":c(t.TranslationHypothesis.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.response":const u=JSON.parse(s.textBody);if(u.SpeechPhrase)await l(t.TranslationPhrase.fromTranslationResponse(u,this.privRequestSession.currentTurnAudioOffset));else{const m=JSON.parse(s.textBody);m.SpeechHypothesis&&c(t.TranslationHypothesis.fromTranslationResponse(m,this.privRequestSession.currentTurnAudioOffset))}break;case"translation.phrase":await l(t.TranslationPhrase.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.synthesis":case"audio":this.sendSynthesisAudio(s.binaryBody,this.privRequestSession.sessionId),a=!0;break;case"audio.end":case"translation.synthesis.end":const h=t.TranslationSynthesisEnd.fromJSON(s.textBody);switch(h.SynthesisStatus){case t.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){const m=new e.TranslationSynthesisResult(e.ResultReason.Canceled,void 0),v=new e.TranslationSynthesisEventArgs(m,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,v)}catch{}}if(this.privTranslationRecognizer.canceled){const m=new e.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,e.CancellationReason.Error,h.FailureReason,e.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,m)}catch{}}break;case t.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break}a=!0;break}return a}cancelRecognition(s,o,a,l,c){const u=new e.PropertyCollection;if(u.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[l]),this.privTranslationRecognizer.canceled){const h=new e.TranslationRecognitionCanceledEventArgs(s,a,c,l,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,h)}catch{}}if(this.privSuccessCallback){const h=new e.TranslationRecognitionResult(void 0,o,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,c,void 0,u);try{this.privSuccessCallback(h),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(s,o,a){try{const l=new e.TranslationRecognitionEventArgs(e.TranslationRecognitionResult.fromSpeechRecognitionResult(s),o,a);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,l)}catch{}}handleRecognizedCallback(s,o,a){try{const l=new e.TranslationRecognitionEventArgs(e.TranslationRecognitionResult.fromSpeechRecognitionResult(s),o,a);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,l)}catch{}}fireEventForResult(s,o){let a;if(s.Translation.Translations!==void 0){a=new e.Translations;for(const v of s.Translation.Translations)a.set(v.Language,v.Text||v.DisplayText)}let l,c;s instanceof t.TranslationPhrase?(s.Translation&&s.Translation.TranslationStatus===n.TranslationStatus.Success?l=e.ResultReason.TranslatedSpeech:l=e.ResultReason.RecognizedSpeech,c=s.Confidence):l=e.ResultReason.TranslatingSpeech;const u=s.Language,h=new e.TranslationRecognitionResult(a,this.privRequestSession.requestId,l,s.Text,s.Duration,s.Offset,u,c,s.Translation.FailureReason,s.asJson(),o);return new e.TranslationRecognitionEventArgs(h,s.Offset,this.privRequestSession.sessionId)}sendSynthesisAudio(s,o){const a=s===void 0?e.ResultReason.SynthesizingAudioCompleted:e.ResultReason.SynthesizingAudio,l=new e.TranslationSynthesisResult(a,s),c=new e.TranslationSynthesisEventArgs(l,o);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,c)}catch{}}};return Rg.TranslationServiceRecognizer=r,Rg}var Ig={},dL;function y6(){if(dL)return Ig;dL=1,Object.defineProperty(Ig,"__esModule",{value:!0}),Ig.SpeechDetected=void 0;let n=class nF{constructor(t,r){this.privSpeechStartDetected=JSON.parse(t),this.privSpeechStartDetected.Offset+=r}static fromJSON(t,r){return new nF(t,r)}get Offset(){return this.privSpeechStartDetected.Offset}};return Ig.SpeechDetected=n,Ig}var _g={},hL;function S6(){if(hL)return _g;hL=1,Object.defineProperty(_g,"__esModule",{value:!0}),_g.SpeechHypothesis=void 0;let n=class rF{constructor(t,r){this.privSpeechHypothesis=JSON.parse(t),this.updateOffset(r)}static fromJSON(t,r){return new rF(t,r)}updateOffset(t){this.privSpeechHypothesis.Offset+=t}asJson(){return JSON.stringify(this.privSpeechHypothesis)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};return _g.SpeechHypothesis=n,_g}var kg={},pL;function C6(){if(pL)return kg;pL=1,Object.defineProperty(kg,"__esModule",{value:!0}),kg.SpeechKeyword=void 0;let n=class iF{constructor(t,r){this.privSpeechKeyword=JSON.parse(t),this.privSpeechKeyword.Offset+=r}static fromJSON(t,r){return new iF(t,r)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}asJson(){return JSON.stringify(this.privSpeechKeyword)}};return kg.SpeechKeyword=n,kg}var Mg={},fL;function A6(){if(fL)return Mg;fL=1,Object.defineProperty(Mg,"__esModule",{value:!0}),Mg.SpeechServiceRecognizer=void 0;const n=Pe(),e=Ue();let t=class extends e.ServiceRecognizerBase{constructor(i,s,o,a,l){super(i,s,o,a,l),this.privSpeechRecognizer=l}async processTypeSpecificMessages(i){let s;const o=new n.PropertyCollection;let a=!1;switch(i.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const l=e.SpeechHypothesis.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);o.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,l.asJson()),s=new n.SpeechRecognitionResult(this.privRequestSession.requestId,n.ResultReason.RecognizingSpeech,l.Text,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,void 0,void 0,l.asJson(),o),this.privRequestSession.onHypothesis(l.Offset);const c=new n.SpeechRecognitionEventArgs(s,l.Offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,c)}catch{}a=!0;break;case"speech.phrase":const u=e.SimpleSpeechPhrase.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);o.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,u.asJson());const h=e.EnumTranslation.implTranslateRecognitionResult(u.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(u.Offset+u.Duration),n.ResultReason.Canceled===h){const m=e.EnumTranslation.implTranslateCancelResult(u.RecognitionStatus),v=e.EnumTranslation.implTranslateCancelErrorCode(u.RecognitionStatus);await this.cancelRecognitionLocal(m,v,e.EnumTranslation.implTranslateErrorDetails(v))}else{if(u.RecognitionStatus===e.RecognitionStatus.EndOfDictation)break;if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===n.OutputFormat[n.OutputFormat.Simple])s=new n.SpeechRecognitionResult(this.privRequestSession.requestId,h,u.DisplayText,u.Duration,u.Offset,u.Language,u.LanguageDetectionConfidence,void 0,void 0,u.asJson(),o);else{const v=e.DetailedSpeechPhrase.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);o.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,v.asJson()),s=new n.SpeechRecognitionResult(this.privRequestSession.requestId,h,v.RecognitionStatus===e.RecognitionStatus.Success?v.NBest[0].Display:"",v.Duration,v.Offset,v.Language,v.LanguageDetectionConfidence,void 0,void 0,v.asJson(),o)}const m=new n.SpeechRecognitionEventArgs(s,s.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,m)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(s)}catch(v){this.privErrorCallback&&this.privErrorCallback(v)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}a=!0;break}return a}cancelRecognition(i,s,o,a,l){const c=new n.PropertyCollection;if(c.setProperty(e.CancellationErrorCodePropertyName,n.CancellationErrorCode[a]),this.privSpeechRecognizer.canceled){const u=new n.SpeechRecognitionCanceledEventArgs(o,l,a,void 0,i);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,u)}catch{}}if(this.privSuccessCallback){const u=new n.SpeechRecognitionResult(s,n.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,l,void 0,c);try{this.privSuccessCallback(u),this.privSuccessCallback=void 0}catch{}}}};return Mg.SpeechServiceRecognizer=t,Mg}var Ng={},uw={},mL;function T6(){return mL||(mL=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.IdentityProvider=n.SpeakerDiarizationMode=void 0,(function(e){e.None="None",e.Identity="Identity",e.Anonymous="Anonymous"})(n.SpeakerDiarizationMode||(n.SpeakerDiarizationMode={})),(function(e){e.CallCenter="CallCenter"})(n.IdentityProvider||(n.IdentityProvider={}))})(uw)),uw}var gL;function E6(){if(gL)return Ng;gL=1,Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.ConversationTranscriptionServiceRecognizer=void 0;const n=Pe(),e=Ue(),t=T6(),r=vs();let i=class extends e.ServiceRecognizerBase{constructor(o,a,l,c,u){super(o,a,l,c,u),this.privConversationTranscriber=u,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const o=this.privSpeechContext.getContext().phraseDetection||{};o.mode=r.RecognitionMode.Conversation;const a={};a.mode=t.SpeakerDiarizationMode.Anonymous,a.audioSessionId=this.privDiarizationSessionId,a.audioOffsetMs=0,a.diarizeIntermediates=this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceResponse_DiarizeIntermediateResults,"false")==="true",o.speakerDiarization=a,this.privSpeechContext.getContext().phraseDetection=o}}async processTypeSpecificMessages(o){let a;const l=new n.PropertyCollection;l.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,o.textBody);let c=!1;switch(o.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const u=e.SpeechHypothesis.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);a=new n.ConversationTranscriptionResult(this.privRequestSession.requestId,n.ResultReason.RecognizingSpeech,u.Text,u.Duration,u.Offset,u.Language,u.LanguageDetectionConfidence,u.SpeakerId,void 0,u.asJson(),l),this.privRequestSession.onHypothesis(u.Offset);const h=new n.ConversationTranscriptionEventArgs(a,u.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,h)}catch{}c=!0;break;case"speech.phrase":const m=e.SimpleSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset),v=e.EnumTranslation.implTranslateRecognitionResult(m.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(m.Offset+m.Duration),n.ResultReason.Canceled===v){const C=e.EnumTranslation.implTranslateCancelResult(m.RecognitionStatus),T=e.EnumTranslation.implTranslateCancelErrorCode(m.RecognitionStatus);await this.cancelRecognitionLocal(C,T,e.EnumTranslation.implTranslateErrorDetails(T))}else if(!(this.privRequestSession.isSpeechEnded&&v===n.ResultReason.NoMatch&&m.RecognitionStatus!==e.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===n.OutputFormat[n.OutputFormat.Simple])a=new n.ConversationTranscriptionResult(this.privRequestSession.requestId,v,m.DisplayText,m.Duration,m.Offset,m.Language,m.LanguageDetectionConfidence,m.SpeakerId,void 0,m.asJson(),l);else{const T=e.DetailedSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);a=new n.ConversationTranscriptionResult(this.privRequestSession.requestId,v,T.RecognitionStatus===e.RecognitionStatus.Success?T.NBest[0].Display:void 0,T.Duration,T.Offset,T.Language,T.LanguageDetectionConfidence,m.SpeakerId,void 0,T.asJson(),l)}const C=new n.ConversationTranscriptionEventArgs(a,a.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,C)}catch{}}c=!0;break}return c}cancelRecognition(o,a,l,c,u){if(new n.PropertyCollection().setProperty(e.CancellationErrorCodePropertyName,n.CancellationErrorCode[c]),this.privConversationTranscriber.canceled){const m=new n.ConversationTranscriptionCanceledEventArgs(l,u,c,void 0,o);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,m)}catch{}}}};return Ng.ConversationTranscriptionServiceRecognizer=i,Ng}var Lg={},vL;function x6(){if(vL)return Lg;vL=1,Object.defineProperty(Lg,"__esModule",{value:!0}),Lg.TranscriptionServiceRecognizer=void 0;const n=He(),e=Pe(),t=Ue(),r=eT();let i=class extends t.ConversationServiceRecognizer{constructor(o,a,l,c,u){super(o,a,l,c,u),this.privTranscriberRecognizer=u,this.sendPrePayloadJSONOverride=h=>this.sendTranscriptionStartJSON(h),this.privRecognizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(o,a){if(this.privRequestSession.isRecognizing){const l=await this.fetchConnection();await this.sendSpeechEvent(l,this.createSpeechEventPayload(o,a))}}async sendMeetingSpeechEventAsync(o,a){if(this.privRequestSession.isRecognizing){const l=await this.fetchConnection();await this.sendSpeechEvent(l,this.createMeetingSpeechEventPayload(o,a))}}processTypeSpecificMessages(o){return this.processSpeechMessages(o)}handleRecognizedCallback(o,a,l){try{const c=new e.SpeechRecognitionEventArgs(o,a,l);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,c),this.privSuccessCallback){try{this.privSuccessCallback(o)}catch(u){this.privErrorCallback&&this.privErrorCallback(u)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(o,a,l){try{const c=new e.SpeechRecognitionEventArgs(o,a,l);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,c)}catch{}}cancelRecognition(o,a,l,c,u){const h=new e.PropertyCollection;if(h.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[c]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const m=new e.MeetingTranscriptionCanceledEventArgs(l,u,c,void 0,o);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,m)}catch{}}}else if(this.privTranscriberRecognizer.canceled){const m=new e.ConversationTranscriptionCanceledEventArgs(l,u,c,void 0,o);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,m)}catch{}}if(this.privSuccessCallback){const m=new e.SpeechRecognitionResult(a,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,u,void 0,h);try{this.privSuccessCallback(m),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(o){if(await this.sendSpeechContext(o,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const a=this.privTranscriberRecognizer.getMeetingInfo(),l=this.createMeetingSpeechEventPayload(a,"start");await this.sendSpeechEvent(o,l)}else{const a=this.privTranscriberRecognizer.getConversationInfo(),l=this.createSpeechEventPayload(a,"start");await this.sendSpeechEvent(o,l)}await this.sendWaveHeader(o)}sendSpeechEvent(o,a){const l=JSON.stringify(a);if(l)return o.send(new r.SpeechConnectionMessage(n.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",l))}createSpeechEventPayload(o,a){const l={id:"meeting",name:a,meeting:o.conversationProperties};return l.meeting.id=o.id,l.meeting.attendees=o.participants,l}createMeetingSpeechEventPayload(o,a){const l={id:"meeting",name:a,meeting:o.meetingProperties};return l.meeting.id=o.id,l.meeting.attendees=o.participants,l}};return Lg.TranscriptionServiceRecognizer=i,Lg}var Dg={},yL;function w6(){if(yL)return Dg;yL=1,Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.DetailedSpeechPhrase=void 0;const n=Ue();let e=class sF{constructor(r,i){this.privDetailedSpeechPhrase=JSON.parse(r),this.privDetailedSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privDetailedSpeechPhrase.RecognitionStatus),this.updateOffsets(i)}static fromJSON(r,i){return new sF(r,i)}updateOffsets(r){if(this.privDetailedSpeechPhrase.Offset+=r,this.privDetailedSpeechPhrase.NBest)for(const i of this.privDetailedSpeechPhrase.NBest){if(i.Words)for(const s of i.Words)s.Offset+=r;if(i.DisplayWords)for(const s of i.DisplayWords)s.Offset+=r}}asJson(){const r={...this.privDetailedSpeechPhrase};return JSON.stringify({...r,RecognitionStatus:n.RecognitionStatus[r.RecognitionStatus]})}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}mapRecognitionStatus(r){if(typeof r=="string")return n.RecognitionStatus[r];if(typeof r=="number")return r}};return Dg.DetailedSpeechPhrase=e,Dg}var Og={},SL;function b6(){if(SL)return Og;SL=1,Object.defineProperty(Og,"__esModule",{value:!0}),Og.SimpleSpeechPhrase=void 0;const n=Ue();let e=class oF{constructor(r,i=0){this.privSimpleSpeechPhrase=JSON.parse(r),this.privSimpleSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privSimpleSpeechPhrase.RecognitionStatus),this.updateOffset(i)}static fromJSON(r,i){return new oF(r,i)}updateOffset(r){this.privSimpleSpeechPhrase.Offset+=r}asJson(){const r={...this.privSimpleSpeechPhrase};return JSON.stringify({...r,RecognitionStatus:n.RecognitionStatus[r.RecognitionStatus]})}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}mapRecognitionStatus(r){if(typeof r=="string")return n.RecognitionStatus[r];if(typeof r=="number")return r}};return Og.SimpleSpeechPhrase=e,Og}var Bg={},Fg={},CL;function P6(){if(CL)return Fg;CL=1,Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.ServiceTelemetryListener=void 0;const n=He(),e=ZP();class t{constructor(i,s,o){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=i,this.privAudioSourceId=s,this.privAudioNodeId=o,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(i){i>0&&this.privPhraseLatencies.push(Date.now()-i)}hypothesisReceived(i){i>0&&this.privHypothesisLatencies.push(Date.now()-i)}onEvent(i){this.privIsDisposed||(i instanceof e.RecognitionTriggeredEvent&&i.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:i.eventTime,Name:"ListeningTrigger",Start:i.eventTime}),i instanceof n.AudioStreamNodeAttachingEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof n.AudioStreamNodeAttachedEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof n.AudioSourceErrorEvent&&i.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof n.AudioStreamNodeErrorEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof n.AudioStreamNodeDetachedEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Name:"Microphone",Start:this.privMicStartTime})),i instanceof e.ConnectingToServiceEvent&&i.requestId===this.privRequestId&&(this.privConnectionId=i.sessionId),i instanceof n.ConnectionStartEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionStartTime=i.eventTime),i instanceof n.ConnectionEstablishedEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof n.ConnectionEstablishErrorEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Error:this.getConnectionError(i.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof n.ConnectionMessageReceivedEvent&&i.connectionId===this.privConnectionId&&i.message&&i.message.headers&&i.message.headers.path&&(this.privReceivedMessages[i.message.headers.path]||(this.privReceivedMessages[i.message.headers.path]=new Array),this.privReceivedMessages[i.message.headers.path].length<50&&this.privReceivedMessages[i.message.headers.path].push(i.networkReceivedTime)))}getTelemetry(){const i=new Array;this.privListeningTriggerMetric&&i.push(this.privListeningTriggerMetric),this.privMicMetric&&i.push(this.privMicMetric),this.privConnectionEstablishMetric&&i.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&i.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&i.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const s={Metrics:i,ReceivedMessages:this.privReceivedMessages},o=JSON.stringify(s);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],o}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(i){switch(i){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+i.toString()}}}return Fg.ServiceTelemetryListener=t,Fg}var AL;function R6(){if(AL)return Bg;AL=1,Object.defineProperty(Bg,"__esModule",{value:!0}),Bg.RequestSession=void 0;const n=He(),e=ZP(),t=P6();let r=class{constructor(s){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=s,this.privRequestId=(0,n.createNoDashGuid)(),this.privAudioNodeId=(0,n.createNoDashGuid)(),this.privTurnDeferral=new n.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(s){this.privServiceTelemetryListener&&this.privDetachables.push(s.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new t.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new e.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(s,o){this.privAudioNode=s,this.privIsAudioNodeDetached=!1,o?await this.onComplete():this.onEvent(new e.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(s,o){this.privAuthFetchEventId=s,this.privSessionId=o,this.onEvent(new e.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(s){s&&await this.onComplete()}async onConnectionEstablishCompleted(s,o){if(s===200){this.onEvent(new e.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else s===403&&await this.onComplete()}async onServiceTurnEndResponse(s){this.privTurnDeferral.resolve(),!s||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=(0,n.createNoDashGuid)()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new n.Deferred}onHypothesis(s){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(s)))}onPhraseRecognized(s){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(s)),this.onServiceRecognized(s)}onServiceRecognized(s){this.privLastRecoOffset=s,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(s),this.privConnectionAttempts=0}onAudioSent(s){this.privBytesSent+=s,this.privRecognitionBytesSent+=s}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const s of this.privDetachables)await s.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(s){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(s),n.Events.instance.onEvent(s)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}};return Bg.RequestSession=r,Bg}var jg={},dw={},TL;function I6(){return TL||(TL=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.TentativePhraseResultsOption=n.OutputFormat=n.PhraseExtension=n.PhraseOption=void 0,(function(e){e.WordTimings="WordTimings",e.SNR="SNR",e.Pronunciation="Pronunciation",e.WordPronunciation="WordPronunciation",e.WordConfidence="WordConfidence",e.Words="Words",e.Sentiment="Sentiment",e.PronunciationAssessment="PronunciationAssessment",e.ContentAssessment="ContentAssessment",e.PhraseAMScore="PhraseAMScore",e.PhraseLMScore="PhraseLMScore",e.WordAMScore="WordAMScore",e.WordLMScore="WordLMScore",e.RuleTree="RuleTree",e.NBestTimings="NBestTimings",e.DecoderDiagnostics="DecoderDiagnostics",e.DisplayWordTimings="DisplayWordTimings",e.DisplayWords="DisplayWords"})(n.PhraseOption||(n.PhraseOption={})),(function(e){e.Graph="Graph",e.Corrections="Corrections",e.Sentiment="Sentiment"})(n.PhraseExtension||(n.PhraseExtension={})),(function(e){e.Simple="Simple",e.Detailed="Detailed"})(n.OutputFormat||(n.OutputFormat={})),(function(e){e.None="None",e.Always="Always"})(n.TentativePhraseResultsOption||(n.TentativePhraseResultsOption={}))})(dw)),dw}var EL;function _6(){if(EL)return jg;EL=1,Object.defineProperty(jg,"__esModule",{value:!0}),jg.SpeechContext=void 0;const n=vs(),e=I6();let t=class{constructor(i){this.privContext={},this.privDynamicGrammar=i}getContext(){return this.privContext}setPronunciationAssessmentParams(i,s=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(i)||{},s&&(this.privContext.phraseDetection.mode=n.RecognitionMode.Conversation),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push(e.PhraseOption.PronunciationAssessment),this.privContext.phraseOutput.detailed.options.indexOf(e.PhraseOption.SNR)===-1&&this.privContext.phraseOutput.detailed.options.push(e.PhraseOption.SNR)}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=e.OutputFormat.Detailed}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=e.OutputFormat.Detailed,this.privContext.phraseOutput.detailed.options.indexOf(e.PhraseOption.WordTimings)===-1&&this.privContext.phraseOutput.detailed.options.push(e.PhraseOption.WordTimings)}setSpeakerDiarizationAudioOffsetMs(i){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=i}toJSON(){const i=this.privDynamicGrammar.generateGrammarObject();return this.privContext.dgi=i,JSON.stringify(this.privContext)}};return jg.SpeechContext=t,jg}var Ug={},hw={},xL;function k6(){return xL||(xL=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SubstringMatchType=n.GroupType=void 0,(function(e){e.IntentText="IntentText",e.IntentEntity="IntentEntity",e.Generic="Generic",e.People="People",e.Place="Place",e.DynamicEntity="DynamicEntity"})(n.GroupType||(n.GroupType={})),(function(e){e.None="None",e.LeftRooted="LeftRooted",e.PartialName="PartialName",e.MiddleOfSentence="MiddleOfSentence"})(n.SubstringMatchType||(n.SubstringMatchType={}))})(hw)),hw}var wL;function M6(){if(wL)return Ug;wL=1,Object.defineProperty(Ug,"__esModule",{value:!0}),Ug.DynamicGrammarBuilder=void 0;const n=k6();let e=class{constructor(){this.privWeight=1}addPhrase(r){this.privPhrases||(this.privPhrases=[]),r instanceof Array?this.privPhrases=this.privPhrases.concat(r):this.privPhrases.push(r)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(r){this.privGrammars||(this.privGrammars=[]),r instanceof Array?this.privGrammars=this.privGrammars.concat(r):this.privGrammars.push(r)}clearGrammars(){this.privGrammars=void 0}setWeight(r){this.privWeight=r}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const r={};if(r.referenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const i=[];this.privPhrases.forEach(s=>{i.push({text:s})}),r.groups=[{type:n.GroupType.Generic,items:i}],r.bias=this.privWeight}return r}};return Ug.DynamicGrammarBuilder=e,Ug}var zg={},Wg={},Vg={},pw={},bL;function aF(){return bL||(bL=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.MessageDataStreamType=n.ActivityPayloadResponse=void 0;class e{constructor(r){this.privActivityResponse=JSON.parse(r)}static fromJSON(r){return new e(r)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}n.ActivityPayloadResponse=e,(function(t){t[t.None=0]="None",t[t.TextToSpeechAudio=1]="TextToSpeechAudio"})(n.MessageDataStreamType||(n.MessageDataStreamType={}))})(pw)),pw}var PL;function N6(){if(PL)return Vg;PL=1,Object.defineProperty(Vg,"__esModule",{value:!0}),Vg.DialogServiceTurnState=void 0;const n=US(),e=Ep(),t=aF();let r=class{constructor(s,o){this.privRequestId=o,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=s,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(s,o){return s.messageDataStreamType===t.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=e.AudioOutputStream.createPullStream(),this.privAudioStream.format=o!==void 0?o:n.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};return Vg.DialogServiceTurnState=r,Vg}var RL;function L6(){if(RL)return Wg;RL=1,Object.defineProperty(Wg,"__esModule",{value:!0}),Wg.DialogServiceTurnStateManager=void 0;const n=ro(),e=N6();let t=class{constructor(){this.privTurnMap=new Map}StartTurn(i){if(this.privTurnMap.has(i))throw new n.InvalidOperationError("Service error: There is already a turn with id:"+i);const s=new e.DialogServiceTurnState(this,i);return this.privTurnMap.set(i,s),this.privTurnMap.get(i)}GetTurn(i){return this.privTurnMap.get(i)}CompleteTurn(i){if(!this.privTurnMap.has(i))throw new n.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+i);const s=this.privTurnMap.get(i);return s.complete(),this.privTurnMap.delete(i),s}};return Wg.DialogServiceTurnStateManager=t,Wg}var fw={},IL;function D6(){return IL||(IL=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.InvocationSource=void 0,(function(e){e.None="None",e.VoiceActivationWithKeyword="VoiceActivationWithKeyword"})(n.InvocationSource||(n.InvocationSource={}))})(fw)),fw}var mw={},_L;function O6(){return _L||(_L=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnRejectAction=n.KeywordDetectionType=void 0,(function(e){e.StartTrigger="StartTrigger"})(n.KeywordDetectionType||(n.KeywordDetectionType={})),(function(e){e.EndOfTurn="EndOfTurn",e.Continue="Continue"})(n.OnRejectAction||(n.OnRejectAction={}))})(mw)),mw}var kL;function B6(){if(kL)return zg;kL=1,Object.defineProperty(zg,"__esModule",{value:!0}),zg.DialogServiceAdapter=void 0;const n=Fr(),e=yB(),t=He(),r=US(),i=Pe(),s=L6(),o=Ue(),a=aF(),l=D6(),c=O6(),u=eT();let h=class extends o.ServiceRecognizerBase{constructor(v,C,T,E,x){super(v,C,T,E,x),this.privEvents=new t.EventSource,this.privDialogServiceConnector=x,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new s.DialogServiceTurnStateManager,this.recognizeOverride=(P,b,I)=>this.listenOnce(P,b,I),this.postConnectImplOverride=P=>this.dialogConnectImpl(P),this.configConnectionOverride=P=>this.configConnection(P),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=T,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(P=>{P.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(v){const C=(0,t.createGuid)(),T=(0,t.createNoDashGuid)(),E={context:{interactionId:C},messagePayload:JSON.parse(v),version:.5},x=JSON.stringify(E);await(await this.fetchConnection()).send(new u.SpeechConnectionMessage(t.MessageType.Text,"agent",T,"application/json",x))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(v){const C=new i.PropertyCollection;v.messageType===t.MessageType.Text&&C.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,v.textBody);let T,E;switch(v.path.toLowerCase()){case"speech.phrase":const P=o.SimpleSpeechPhrase.fromJSON(v.textBody,this.privRequestSession.currentTurnAudioOffset);if(this.privRequestSession.onPhraseRecognized(P.Offset+P.Duration),P.RecognitionStatus!==o.RecognitionStatus.TooManyRequests&&P.RecognitionStatus!==o.RecognitionStatus.Error){const D=this.fireEventForResult(P,C);if(this.privLastResult=D.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,D)}catch{}}E=!0;break;case"speech.hypothesis":const b=o.SpeechHypothesis.fromJSON(v.textBody,this.privRequestSession.currentTurnAudioOffset);T=new i.SpeechRecognitionResult(this.privRequestSession.requestId,i.ResultReason.RecognizingSpeech,b.Text,b.Duration,b.Offset,b.Language,b.LanguageDetectionConfidence,void 0,void 0,b.asJson(),C),this.privRequestSession.onHypothesis(b.Offset);const I=new i.SpeechRecognitionEventArgs(T,b.Offset,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,I)}catch{}E=!0;break;case"speech.keyword":const M=o.SpeechKeyword.fromJSON(v.textBody,this.privRequestSession.currentTurnAudioOffset);T=new i.SpeechRecognitionResult(this.privRequestSession.requestId,M.Status==="Accepted"?i.ResultReason.RecognizedKeyword:i.ResultReason.NoMatch,M.Text,M.Duration,M.Offset,void 0,void 0,void 0,void 0,M.asJson(),C),M.Status!=="Accepted"&&(this.privLastResult=T);const N=new i.SpeechRecognitionEventArgs(T,T.duration,T.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,N)}catch{}E=!0;break;case"audio":{const D=v.requestId.toUpperCase(),j=this.privTurnStateManager.GetTurn(D);try{v.binaryBody?j.audioStream.write(v.binaryBody):j.endAudioStream()}catch{}}E=!0;break;case"response":this.handleResponseMessage(v),E=!0;break}const x=new t.Deferred;return x.resolve(E),x.promise}async cancelRecognition(v,C,T,E,x){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const P=new i.PropertyCollection;P.setProperty(o.CancellationErrorCodePropertyName,i.CancellationErrorCode[E]);const b=new i.SpeechRecognitionCanceledEventArgs(T,x,E,void 0,v);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,b)}catch{}if(this.privSuccessCallback){const I=new i.SpeechRecognitionResult(void 0,i.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,x,void 0,P);try{this.privSuccessCallback(I),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(v,C,T){this.privRecognizerConfig.recognitionMode=v,this.privSuccessCallback=C,this.privErrorCallback=T,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(i.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const E=this.connectImpl(),x=this.sendPreAudioMessages(),P=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),b=await this.privDialogAudioSource.format,I=await this.privDialogAudioSource.deviceInfo,M=new n.ReplayableAudioNode(P,b.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(M,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:I};try{await E,await x}catch(j){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,j),Promise.resolve()}const N=new i.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,N),this.sendAudio(M).then(()=>{},async j=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,j)})}dialogConnectImpl(v){return this.privConnectionLoop=this.startMessageLoop(),v}receiveDialogMessageOverride(){const v=new t.Deferred,C=async()=>{try{const T=this.isDisposed(),E=!this.isDisposed()&&this.terminateMessageLoop;if(T||E){v.resolve(void 0);return}const P=await(await this.fetchConnection()).read();if(!P)return C();const b=u.SpeechConnectionMessage.fromConnectionMessage(P);switch(b.path.toLowerCase()){case"turn.start":{const z=b.requestId.toUpperCase(),W=this.privRequestSession.requestId.toUpperCase();z!==W?this.privTurnStateManager.StartTurn(z):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const M=o.SpeechDetected.fromJSON(b.textBody,this.privRequestSession.currentTurnAudioOffset),N=new i.RecognitionEventArgs(M.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,N);break;case"speech.enddetected":let D;b.textBody.length>0?D=b.textBody:D="{ Offset: 0 }";const j=o.SpeechDetected.fromJSON(D,this.privRequestSession.currentTurnAudioOffset);this.privRequestSession.onServiceRecognized(j.Offset);const F=new i.RecognitionEventArgs(j.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,F);break;case"turn.end":{const z=b.requestId.toUpperCase(),W=this.privRequestSession.requestId.toUpperCase();if(z!==W)this.privTurnStateManager.CompleteTurn(z);else{const H=new i.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,H),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(V){this.privErrorCallback&&this.privErrorCallback(V)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(b)||this.serviceEvents&&this.serviceEvents.onEvent(new t.ServiceEvent(b.path.toLowerCase(),b.textBody))}catch{}}return C()}catch{this.terminateMessageLoop=!0,v.resolve()}};return C().catch(T=>{t.Events.instance.onEvent(new t.BackgroundEvent(T))}),v.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(v){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,v)}return Promise.resolve()}async configConnection(v){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(v,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(v),v)}async sendPreAudioMessages(){const v=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(v,!0),await this.sendAgentContext(v),await this.sendWaveHeader(v)}sendAgentConfig(v){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Conversation_DialogType)===i.DialogServiceConfig.DialogTypes.CustomCommands){const T=this.agentConfig.get();T.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(T)}this.onEvent(new e.SendingAgentContextMessageEvent(this.agentConfig));const C=this.agentConfig.toJsonString();return this.agentConfigSent=!0,v.send(new u.SpeechConnectionMessage(t.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",C))}}sendAgentContext(v){const C=(0,t.createGuid)(),T=this.privDialogServiceConnector.properties.getProperty(i.PropertyId.Conversation_Speech_Activity_Template),x=JSON.stringify({channelData:"",context:{interactionId:C},messagePayload:typeof T===void 0?void 0:T,version:.5});return v.send(new u.SpeechConnectionMessage(t.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",x))}fireEventForResult(v,C){const T=o.EnumTranslation.implTranslateRecognitionResult(v.RecognitionStatus),E=new i.SpeechRecognitionResult(this.privRequestSession.requestId,T,v.DisplayText,v.Duration,v.Offset,v.Language,v.LanguageDetectionConfidence,void 0,void 0,v.asJson(),C);return new i.SpeechRecognitionEventArgs(E,v.Offset,this.privRequestSession.sessionId)}handleResponseMessage(v){const C=JSON.parse(v.textBody);switch(C.messageType.toLowerCase()){case"message":const T=v.requestId.toUpperCase(),E=a.ActivityPayloadResponse.fromJSON(v.textBody),x=this.privTurnStateManager.GetTurn(T);if(E.conversationId){const I=this.agentConfig.get();I.botInfo.conversationId=E.conversationId,this.agentConfig.set(I)}const P=x.processActivityPayload(E,r.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),b=new i.ActivityReceivedEventArgs(E.messagePayload,P);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,b)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new i.TurnStatusReceivedEventArgs(v.textBody))}catch{}break;default:t.Events.instance.onEvent(new t.BackgroundEvent(`Unexpected response of type ${C.messageType}. Ignoring.`));break}}onEvent(v){this.privEvents.onEvent(v),t.Events.instance.onEvent(v)}addKeywordContextData(){const v=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(v===void 0)return;const C=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),T=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),E=v.split(";"),x=C===void 0?[]:C.split(";"),P=T===void 0?[]:T.split(";"),b=[];for(let I=0;I<E.length;I++){const M={text:E[I]};I<x.length&&(M.startOffset=Number(x[I])),I<P.length&&(M.duration=Number(P[I])),b.push(M)}this.speechContext.getContext().invocationSource=l.InvocationSource.VoiceActivationWithKeyword,this.speechContext.getContext().keywordDetection=[{clientDetectedKeywords:b,onReject:{action:c.OnRejectAction.EndOfTurn},type:c.KeywordDetectionType.StartTrigger}]}};return zg.DialogServiceAdapter=h,zg}var $g={},ML;function F6(){if(ML)return $g;ML=1,Object.defineProperty($g,"__esModule",{value:!0}),$g.AgentConfig=void 0;let n=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(t){this.iPrivConfig=t}};return $g.AgentConfig=n,$g}var gw={},Hg={},Zg={},NL;function JP(){if(NL)return Zg;NL=1,Object.defineProperty(Zg,"__esModule",{value:!0}),Zg.ConversationConnectionConfig=void 0;const n=eF();let e=class Ha extends n.RestConfigBase{static get host(){return Ha.privHost}static get apiVersion(){return Ha.privApiVersion}static get clientAppId(){return Ha.privClientAppId}static get defaultLanguageCode(){return Ha.privDefaultLanguageCode}static get restPath(){return Ha.privRestPath}static get webSocketPath(){return Ha.privWebSocketPath}static get transcriptionEventKeys(){return Ha.privTranscriptionEventKeys}};return Zg.ConversationConnectionConfig=e,e.privHost="dev.microsofttranslator.com",e.privRestPath="/capito/room",e.privApiVersion="2.0",e.privDefaultLanguageCode="en-US",e.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",e.privWebSocketPath="/capito/translate",e.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"],Zg}var LL;function j6(){if(LL)return Hg;LL=1,Object.defineProperty(Hg,"__esModule",{value:!0}),Hg.ConversationManager=void 0;const n=Fr(),e=lt(),t=Pe(),r=JP();let i=class{constructor(){this.privRequestParams=r.ConversationConnectionConfig.configParams,this.privErrors=r.ConversationConnectionConfig.restErrors,this.privHost=r.ConversationConnectionConfig.host,this.privApiVersion=r.ConversationConnectionConfig.apiVersion,this.privRestPath=r.ConversationConnectionConfig.restPath,this.privRestAdapter=new n.RestMessageAdapter({})}createOrJoin(o,a,l,c){try{e.Contracts.throwIfNullOrUndefined(o,"args");const u=o.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,r.ConversationConnectionConfig.defaultLanguageCode),h=o.getProperty(t.PropertyId.ConversationTranslator_Name,"conversation_host"),m=o.getProperty(t.PropertyId.ConversationTranslator_Host,this.privHost),v=o.getProperty(t.PropertyId.ConversationTranslator_CorrelationId),C=o.getProperty(t.PropertyId.SpeechServiceConnection_Key),T=o.getProperty(t.PropertyId.SpeechServiceConnection_Region),E=o.getProperty(t.PropertyId.SpeechServiceAuthorization_Token);e.Contracts.throwIfNullOrWhitespace(u,"languageCode"),e.Contracts.throwIfNullOrWhitespace(h,"nickname"),e.Contracts.throwIfNullOrWhitespace(m,"endpointHost");const x={};x[this.privRequestParams.apiVersion]=this.privApiVersion,x[this.privRequestParams.languageCode]=u,x[this.privRequestParams.nickname]=h;const P={};v&&(P[this.privRequestParams.correlationId]=v),P[this.privRequestParams.clientAppId]=r.ConversationConnectionConfig.clientAppId,a!==void 0?x[this.privRequestParams.roomId]=a:(e.Contracts.throwIfNullOrUndefined(T,this.privErrors.authInvalidSubscriptionRegion),P[this.privRequestParams.subscriptionRegion]=T,C?P[this.privRequestParams.subscriptionKey]=C:E?P[this.privRequestParams.authorization]=`Bearer ${E}`:e.Contracts.throwIfNullOrUndefined(C,this.privErrors.authInvalidSubscriptionKey));const b={};b.headers=P,this.privRestAdapter.options=b;const I=`https://${m}${this.privRestPath}`;this.privRestAdapter.request(n.RestRequestType.Post,I,x,null).then(M=>{const N=n.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,M.headers);if(!M.ok){if(c){let j=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",M.status.toString()),F;try{F=JSON.parse(M.data),j+=` [${F.error.code}: ${F.error.message}]`}catch{j+=` [${M.data}]`}N&&(j+=` ${N}`),c(j)}return}const D=JSON.parse(M.data);if(D&&(D.requestId=N),l){try{l(D)}catch(j){c&&c(j)}l=void 0}}).catch(()=>{})}catch(u){if(c)if(u instanceof Error){const h=u;c(h.name+": "+h.message)}else c(u)}}leave(o,a){return new Promise((l,c)=>{try{e.Contracts.throwIfNullOrUndefined(o,this.privErrors.invalidArgs.replace("{arg}","config")),e.Contracts.throwIfNullOrWhitespace(a,this.privErrors.invalidArgs.replace("{arg}","token"));const u=o.getProperty(t.PropertyId.ConversationTranslator_Host,this.privHost),h=o.getProperty(t.PropertyId.ConversationTranslator_CorrelationId),m={};m[this.privRequestParams.apiVersion]=this.privApiVersion,m[this.privRequestParams.sessionToken]=a;const v={};h&&(v[this.privRequestParams.correlationId]=h);const C={};C.headers=v,this.privRestAdapter.options=C;const T=`https://${u}${this.privRestPath}`;this.privRestAdapter.request(n.RestRequestType.Delete,T,m,null).then(E=>{E.ok,l()}).catch(()=>{})}catch(u){if(u instanceof Error){const h=u;c(h.name+": "+h.message)}else c(u)}})}};return Hg.ConversationManager=i,Hg}var Tc={},qg={},Gg={},Kg={},DL;function lF(){if(DL)return Kg;DL=1,Object.defineProperty(Kg,"__esModule",{value:!0}),Kg.ConversationConnectionMessage=void 0;const n=He();let e=class extends n.ConnectionMessage{constructor(r,i,s,o){super(r,i,s,o);const a=JSON.parse(this.textBody);a.type!==void 0&&(this.privConversationMessageType=a.type)}get conversationMessageType(){return this.privConversationMessageType}};return Kg.ConversationConnectionMessage=e,Kg}var OL;function U6(){if(OL)return Gg;OL=1,Object.defineProperty(Gg,"__esModule",{value:!0}),Gg.ConversationWebsocketMessageFormatter=void 0;const n=He(),e=lF();let t=class{toConnectionMessage(i){const s=new n.Deferred;try{if(i.messageType===n.MessageType.Text){const o=new e.ConversationConnectionMessage(i.messageType,i.textContent,{},i.id);s.resolve(o)}else i.messageType===n.MessageType.Binary&&s.resolve(new e.ConversationConnectionMessage(i.messageType,i.binaryContent,void 0,i.id))}catch(o){s.reject(`Error formatting the message. Error: ${o}`)}return s.promise}fromConnectionMessage(i){const s=new n.Deferred;try{if(i.messageType===n.MessageType.Text){const o=`${i.textBody?i.textBody:""}`;s.resolve(new n.RawWebsocketMessage(n.MessageType.Text,o,i.id))}}catch(o){s.reject(`Error formatting the message. ${o}`)}return s.promise}};return Gg.ConversationWebsocketMessageFormatter=t,Gg}var BL;function z6(){if(BL)return qg;BL=1,Object.defineProperty(qg,"__esModule",{value:!0}),qg.ConversationConnectionFactory=void 0;const n=Fr(),e=He(),t=lt(),r=Pe(),i=pa(),s=JP(),o=U6();let a=class extends i.ConnectionFactoryBase{create(c,u,h){const m=c.parameters.getProperty(r.PropertyId.ConversationTranslator_Host,s.ConversationConnectionConfig.host),v=c.parameters.getProperty(r.PropertyId.ConversationTranslator_CorrelationId,(0,e.createGuid)()),C=`wss://${m}${s.ConversationConnectionConfig.webSocketPath}`,T=c.parameters.getProperty(r.PropertyId.ConversationTranslator_Token,void 0);t.Contracts.throwIfNullOrUndefined(T,"token");const E={};E[s.ConversationConnectionConfig.configParams.apiVersion]=s.ConversationConnectionConfig.apiVersion,E[s.ConversationConnectionConfig.configParams.token]=T,E[s.ConversationConnectionConfig.configParams.correlationId]=v;const x=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new n.WebsocketConnection(C,E,{},new o.ConversationWebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(c),x,h))}};return qg.ConversationConnectionFactory=a,qg}var Yg={},Jg={},FL;function W6(){if(FL)return Jg;FL=1,Object.defineProperty(Jg,"__esModule",{value:!0}),Jg.ConversationRequestSession=void 0;const n=He();let e=class{constructor(r){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=r,this.privRequestId=(0,n.createNoDashGuid)(),this.privRequestCompletionDeferral=new n.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(r,i){this.privSessionId=i}onAuthCompleted(r){r&&this.onComplete()}onConnectionEstablishCompleted(r){r!==200&&r===403&&this.onComplete()}onServiceTurnEndResponse(r){r?this.privRequestId=(0,n.createNoDashGuid)():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const r of this.privDetachables)await r.detach()}}onComplete(){}};return Jg.ConversationRequestSession=e,Jg}var dr={},jL;function cF(){if(jL)return dr;jL=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.ConversationReceivedTranslationEventArgs=dr.ParticipantsListEventArgs=dr.ParticipantAttributeEventArgs=dr.ParticipantEventArgs=dr.LockRoomEventArgs=dr.MuteAllEventArgs=void 0;const n=Pe();class e extends n.SessionEventArgs{constructor(l,c){super(c),this.privIsMuted=l}get isMuted(){return this.privIsMuted}}dr.MuteAllEventArgs=e;class t extends n.SessionEventArgs{constructor(l,c){super(c),this.privIsLocked=l}get isMuted(){return this.privIsLocked}}dr.LockRoomEventArgs=t;class r extends n.SessionEventArgs{constructor(l,c){super(c),this.privParticipant=l}get participant(){return this.privParticipant}}dr.ParticipantEventArgs=r;class i extends n.SessionEventArgs{constructor(l,c,u,h){super(h),this.privKey=c,this.privValue=u,this.privParticipantId=l}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}dr.ParticipantAttributeEventArgs=i;class s extends n.SessionEventArgs{constructor(l,c,u,h,m,v,C,T,E){super(E),this.privRoomId=l,this.privSessionToken=c,this.privTranslateTo=u,this.privProfanityFilter=h,this.privRoomProfanityFilter=m,this.privIsRoomLocked=v,this.privIsRoomLocked=C,this.privParticipants=T}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}dr.ParticipantsListEventArgs=s;class o{constructor(l,c,u){this.privPayload=c,this.privCommand=l,this.privSessionId=u}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}return dr.ConversationReceivedTranslationEventArgs=o,dr}var So={},UL;function uF(){if(UL)return So;UL=1,Object.defineProperty(So,"__esModule",{value:!0}),So.ConversationTranslatorCommandTypes=So.ConversationTranslatorMessageTypes=So.InternalParticipants=void 0;class n{constructor(t=[],r){this.participants=t,this.meId=r}addOrUpdateParticipant(t){if(t===void 0)return;const r=this.getParticipantIndex(t.id);return r>-1?this.participants.splice(r,1,t):this.participants.push(t),this.getParticipant(t.id)}getParticipantIndex(t){return this.participants.findIndex(r=>r.id===t)}getParticipant(t){return this.participants.find(r=>r.id===t)}deleteParticipant(t){this.participants=this.participants.filter(r=>r.id!==t)}get host(){return this.participants.find(t=>t.isHost===!0)}get me(){return this.getParticipant(this.meId)}}return So.InternalParticipants=n,So.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},So.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"},So}var vw={},Xg={},zL;function V6(){if(zL)return Xg;zL=1,Object.defineProperty(Xg,"__esModule",{value:!0}),Xg.CommandResponsePayload=void 0;const n=t=>JSON.parse(t);let e=class dF{constructor(r){this.privCommandResponse=n(r)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(r){return new dF(r)}};return Xg.CommandResponsePayload=e,Xg}var Ec={},WL;function $6(){if(WL)return Ec;WL=1,Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.ParticipantPayloadResponse=Ec.ParticipantsListPayloadResponse=void 0;const n=i=>JSON.parse(i),e=i=>JSON.parse(i);class t{constructor(s){this.privParticipantsPayloadResponse=n(s)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(s){return new t(s)}}Ec.ParticipantsListPayloadResponse=t;class r{constructor(s){this.privParticipantPayloadResponse=e(s)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(s){return new r(s)}}return Ec.ParticipantPayloadResponse=r,Ec}var xc={},VL;function H6(){if(VL)return xc;VL=1,Object.defineProperty(xc,"__esModule",{value:!0}),xc.TextResponsePayload=xc.SpeechResponsePayload=void 0;const n=i=>JSON.parse(i),e=i=>JSON.parse(i);class t{constructor(s){this.privSpeechResponse=n(s)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(s){return new t(s)}}xc.SpeechResponsePayload=t;class r{constructor(s){this.privTextResponse=e(s)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(s){return new r(s)}}return xc.TextResponsePayload=r,xc}var $L;function Z6(){return $L||($L=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.TextResponsePayload=n.SpeechResponsePayload=n.ParticipantPayloadResponse=n.ParticipantsListPayloadResponse=n.CommandResponsePayload=void 0;var e=V6();Object.defineProperty(n,"CommandResponsePayload",{enumerable:!0,get:function(){return e.CommandResponsePayload}});var t=$6();Object.defineProperty(n,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return t.ParticipantsListPayloadResponse}}),Object.defineProperty(n,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return t.ParticipantPayloadResponse}});var r=H6();Object.defineProperty(n,"SpeechResponsePayload",{enumerable:!0,get:function(){return r.SpeechResponsePayload}}),Object.defineProperty(n,"TextResponsePayload",{enumerable:!0,get:function(){return r.TextResponsePayload}})})(vw)),vw}var HL;function q6(){if(HL)return Yg;HL=1,Object.defineProperty(Yg,"__esModule",{value:!0}),Yg.ConversationServiceAdapter=void 0;const n=He(),e=Pe(),t=Ue(),r=lF(),i=W6(),s=cF(),o=uF(),a=Z6();let l=class extends t.ServiceRecognizerBase{constructor(u,h,m,v,C){super(u,h,m,v,C),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=C,this.privConversationAuthentication=u,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=T=>this.conversationConnectImpl(T),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new i.ConversationRequestSession((0,n.createNoDashGuid)()),this.privConversationConnectionFactory=h,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(u){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(u),await super.dispose(u)}async sendMessage(u){return(await this.fetchConnection()).send(new r.ConversationConnectionMessage(n.MessageType.Text,u))}async sendMessageAsync(u){await(await this.fetchConnection()).send(new r.ConversationConnectionMessage(n.MessageType.Text,u))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,e.CancellationReason.Error,e.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(u,h,m,v,C){this.terminateMessageLoop=!0;const T=new e.ConversationTranslationCanceledEventArgs(m,C,v,void 0,u);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,T)}catch{}}async conversationConnectImpl(u){return this.privConnectionLoop=this.startMessageLoop(),u}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const u=new n.Deferred;try{const m=await(await this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return u.resolve(),Promise.resolve();if(!m)return this.receiveConversationMessageOverride();const v=this.privConversationRequestSession.sessionId,C=m.conversationMessageType.toLowerCase();let T=!1;try{switch(C){case"info":case"participant_command":case"command":const E=a.CommandResponsePayload.fromJSON(m.textBody);switch(E.command.toLowerCase()){case"participantlist":const N=a.ParticipantsListPayloadResponse.fromJSON(m.textBody),D=N.participants.map(V=>({avatar:V.avatar,displayName:V.nickname,id:V.participantId,isHost:V.ishost,isMuted:V.ismuted,isUsingTts:V.usetts,preferredLanguage:V.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new s.ParticipantsListEventArgs(N.roomid,N.token,N.translateTo,N.profanityFilter,N.roomProfanityFilter,N.roomLocked,N.muteAll,D,v));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(E.participantId,o.ConversationTranslatorCommandTypes.setTranslateToLanguages,E.value,v));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(E.participantId,o.ConversationTranslatorCommandTypes.setProfanityFiltering,E.value,v));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(E.participantId,o.ConversationTranslatorCommandTypes.setMute,E.value,v));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new s.MuteAllEventArgs(E.value,v));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new e.ConversationExpirationEventArgs(E.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(E.participantId,o.ConversationTranslatorCommandTypes.setUseTTS,E.value,v));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new s.LockRoomEventArgs(E.value,v));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new s.ParticipantAttributeEventArgs(E.participantId,o.ConversationTranslatorCommandTypes.changeNickname,E.value,v));break;case"joinsession":const j=a.ParticipantPayloadResponse.fromJSON(m.textBody),F={avatar:j.avatar,displayName:j.nickname,id:j.participantId,isHost:j.ishost,isMuted:j.ismuted,isUsingTts:j.usetts,preferredLanguage:j.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new s.ParticipantEventArgs(F,v));break;case"leavesession":const z={id:E.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new s.ParticipantEventArgs(z,v));break;case"disconnectsession":const W={id:E.participantId};break;case"token":const H=new t.CognitiveTokenAuthentication(()=>{const V=E.token;return Promise.resolve(V)},()=>{const V=E.token;return Promise.resolve(V)});this.authentication=H,this.privConversationServiceConnector.onToken(H);break;default:break}break;case"partial":case"final":const x=a.SpeechResponsePayload.fromJSON(m.textBody),P=C==="final"?e.ResultReason.TranslatedParticipantSpeech:e.ResultReason.TranslatingParticipantSpeech,b=new e.ConversationTranslationResult(x.participantId,this.getTranslations(x.translations),x.language,x.id,P,x.recognition,void 0,void 0,m.textBody,void 0);x.isFinal?((b.text!==void 0&&b.text.length>0||x.id===this.privLastPartialUtteranceId)&&(T=!0),T&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(o.ConversationTranslatorMessageTypes.final,b,v))):b.text!==void 0&&(this.privLastPartialUtteranceId=x.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(o.ConversationTranslatorMessageTypes.partial,b,v)));break;case"translated_message":const I=a.TextResponsePayload.fromJSON(m.textBody),M=new e.ConversationTranslationResult(I.participantId,this.getTranslations(I.translations),I.language,void 0,void 0,I.originalText,void 0,void 0,void 0,m.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new s.ConversationReceivedTranslationEventArgs(o.ConversationTranslatorMessageTypes.instantMessage,M,v));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return u.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const u=this.receiveConversationMessageOverride();try{return await u}catch(h){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",e.CancellationReason.Error,e.CancellationErrorCode.RuntimeError,h),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(u=>u.state()===n.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(u=>u),this.privConnectionConfigPromise)}getTranslations(u){let h;if(u!==void 0){h=new e.Translations;for(const m of u)h.set(m.lang,m.translation)}return h}};return Yg.ConversationServiceAdapter=l,Yg}var ZL;function G6(){if(ZL)return Tc;ZL=1,Object.defineProperty(Tc,"__esModule",{value:!0}),Tc.ConversationTranslatorRecognizer=Tc.ConversationRecognizerFactory=void 0;const n=Ue(),e=He(),t=lt(),r=Pe(),i=z6(),s=q6();class o{static fromConfig(c,u,h){return new a(c,u,h)}}Tc.ConversationRecognizerFactory=o;let a=class extends r.Recognizer{constructor(c,u,h){const m=u;t.Contracts.throwIfNull(m,"speechConfig");const v=c;t.Contracts.throwIfNull(v,"conversationImpl"),super(h,m.properties,new i.ConversationConnectionFactory),this.privConversation=v,this.privIsDisposed=!1,this.privProperties=m.properties.clone(),this.privConnection=r.Connection.fromRecognizer(this),this.privProperties.getProperty(r.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=e.Timeout.setTimeout,this.privClearTimeout=e.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(c){this.privConnection.connected=c}set disconnected(c){this.privConnection.disconnected=c}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(c,u,h){try{t.Contracts.throwIfDisposed(this.privIsDisposed),t.Contracts.throwIfNullOrWhitespace(c,"token"),this.privReco.conversationTranslatorToken=c,this.resetConversationTimeout(),this.privReco.connectAsync(u,h)}catch(m){if(h)if(m instanceof Error){const v=m;h(v.name+": "+v.message)}else h(m)}}disconnect(c,u){try{t.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{c&&c()},h=>{u&&u(h)})}catch(h){if(u)if(h instanceof Error){const m=h;u(m.name+": "+m.message)}else u(h);this.dispose(!0).catch(m=>{e.Events.instance.onEvent(new e.BackgroundEvent(m))})}}sendRequest(c,u,h){try{t.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(c,u,h)}catch(m){if(h)if(m instanceof Error){const v=m;h(v.name+": "+v.message)}else h(m);this.dispose(!0).catch(v=>{e.Events.instance.onEvent(new e.BackgroundEvent(v))})}}onToken(c){this.privConversation.onToken(c)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(c){this.privIsDisposed||c&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(c))}createRecognizerConfig(c){return new n.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,u,h,m){const v=h;return new s.ConversationServiceAdapter(c,u,v,m,this)}sendMessage(c,u,h){const m=this.privReco;((C,T,E)=>{C!==void 0?C.then(()=>{try{T&&T()}catch(x){E&&E(`'Unhandled error on promise callback: ${x}'`)}},x=>{try{E&&E(x)}catch{}}):E&&E("Null promise")})(m.sendMessageAsync(c),u,h),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};return Tc.ConversationTranslatorRecognizer=a,Tc}var Qg={},qL;function K6(){if(qL)return Qg;qL=1,Object.defineProperty(Qg,"__esModule",{value:!0}),Qg.TranscriberRecognizer=void 0;const n=He(),e=lt(),t=Pe(),r=Ue(),i=vs();let s=class extends t.Recognizer{constructor(a,l){const c=a;e.Contracts.throwIfNull(c,"speechTranslationConfig");const u=l;e.Contracts.throwIfNull(u,"audioConfigImpl"),e.Contracts.throwIfNullOrWhitespace(c.speechRecognitionLanguage,t.PropertyId[t.PropertyId.SpeechServiceConnection_RecoLanguage]),super(l,c.properties,new r.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return e.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(t.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){e.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(t.PropertyId.SpeechServiceAuthorization_Token,a)}set conversation(a){e.Contracts.throwIfNullOrUndefined(a,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=a}getConversationInfo(){return e.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(a){e.Contracts.throwIfNullOrUndefined(a,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=a}getMeetingInfo(){return e.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(a,l){(0,n.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(i.RecognitionMode.Conversation),a,l)}stopContinuousRecognitionAsync(a,l){(0,n.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),a,l)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(a,l){const c=this.privReco;e.Contracts.throwIfNullOrUndefined(c,"serviceRecognizer"),await c.sendSpeechEventAsync(a,l)}async pushMeetingEvent(a,l){const c=this.privReco;e.Contracts.throwIfNullOrUndefined(c,"serviceRecognizer"),await c.sendMeetingSpeechEventAsync(a,l)}async enforceAudioGating(){const c=(await this.audioConfig.format).channels;if(c===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(c!==8)throw new Error(`Unsupported audio configuration: Detected ${c}-channel audio`)}connectMeetingCallbacks(a){this.isMeetingRecognizer=!0,this.canceled=(l,c)=>{a.canceled&&a.canceled(a,c)},this.recognizing=(l,c)=>{a.transcribing&&a.transcribing(a,c)},this.recognized=(l,c)=>{a.transcribed&&a.transcribed(a,c)},this.sessionStarted=(l,c)=>{a.sessionStarted&&a.sessionStarted(a,c)},this.sessionStopped=(l,c)=>{a.sessionStopped&&a.sessionStopped(a,c)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new r.RecognizerConfig(a,this.properties)}createServiceRecognizer(a,l,c,u){const h=c;return new r.TranscriptionServiceRecognizer(a,l,h,u,this)}};return Qg.TranscriberRecognizer=s,Qg}var GL;function Y6(){return GL||(GL=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.InternalParticipants=n.ConversationTranslatorMessageTypes=n.ConversationTranslatorCommandTypes=n.ParticipantsListEventArgs=n.ParticipantEventArgs=n.ParticipantAttributeEventArgs=n.MuteAllEventArgs=n.LockRoomEventArgs=n.ConversationReceivedTranslationEventArgs=n.TranscriberRecognizer=n.ConversationRecognizerFactory=n.ConversationConnectionConfig=n.ConversationManager=void 0;var e=j6();Object.defineProperty(n,"ConversationManager",{enumerable:!0,get:function(){return e.ConversationManager}});var t=JP();Object.defineProperty(n,"ConversationConnectionConfig",{enumerable:!0,get:function(){return t.ConversationConnectionConfig}});var r=G6();Object.defineProperty(n,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return r.ConversationRecognizerFactory}});var i=K6();Object.defineProperty(n,"TranscriberRecognizer",{enumerable:!0,get:function(){return i.TranscriberRecognizer}});var s=cF();Object.defineProperty(n,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return s.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(n,"LockRoomEventArgs",{enumerable:!0,get:function(){return s.LockRoomEventArgs}}),Object.defineProperty(n,"MuteAllEventArgs",{enumerable:!0,get:function(){return s.MuteAllEventArgs}}),Object.defineProperty(n,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return s.ParticipantAttributeEventArgs}}),Object.defineProperty(n,"ParticipantEventArgs",{enumerable:!0,get:function(){return s.ParticipantEventArgs}}),Object.defineProperty(n,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return s.ParticipantsListEventArgs}});var o=uF();Object.defineProperty(n,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return o.ConversationTranslatorCommandTypes}}),Object.defineProperty(n,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return o.ConversationTranslatorMessageTypes}}),Object.defineProperty(n,"InternalParticipants",{enumerable:!0,get:function(){return o.InternalParticipants}})})(gw)),gw}var yw={},KL;function hF(){return KL||(KL=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SynthesisAudioMetadata=n.MetadataType=void 0,(function(t){t.WordBoundary="WordBoundary",t.Bookmark="Bookmark",t.Viseme="Viseme",t.SentenceBoundary="SentenceBoundary",t.SessionEnd="SessionEnd",t.AvatarSignal="TalkingAvatarSignal"})(n.MetadataType||(n.MetadataType={}));class e{constructor(r){this.privSynthesisAudioMetadata=JSON.parse(r)}static fromJSON(r){return new e(r)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}n.SynthesisAudioMetadata=e})(yw)),yw}var ev={},Xi={},YL;function J6(){if(YL)return Xi;YL=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.SynthesisStartedEvent=Xi.ConnectingToSynthesisServiceEvent=Xi.SynthesisTriggeredEvent=Xi.SpeechSynthesisEvent=void 0;const n=He();class e extends n.PlatformEvent{constructor(o,a,l=n.EventType.Info){super(o,l),this.privRequestId=a}get requestId(){return this.privRequestId}}Xi.SpeechSynthesisEvent=e;class t extends e{constructor(o,a,l){super("SynthesisTriggeredEvent",o),this.privSessionAudioDestinationId=a,this.privTurnAudioDestinationId=l}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}Xi.SynthesisTriggeredEvent=t;class r extends e{constructor(o,a){super("ConnectingToSynthesisServiceEvent",o),this.privAuthFetchEventId=a}get authFetchEventId(){return this.privAuthFetchEventId}}Xi.ConnectingToSynthesisServiceEvent=r;class i extends e{constructor(o,a){super("SynthesisStartedEvent",o),this.privAuthFetchEventId=a}get authFetchEventId(){return this.privAuthFetchEventId}}return Xi.SynthesisStartedEvent=i,Xi}var JL;function X6(){if(JL)return ev;JL=1,Object.defineProperty(ev,"__esModule",{value:!0}),ev.SynthesisTurn=void 0;const n=He(),e=Ep(),t=Pe(),r=hF(),i=J6();let s=class Zw{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=(0,n.createNoDashGuid)(),this.privTurnDeferral=new n.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(a){this.privStreamId=a}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(a){this.privAudioOutputFormat=a}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const a=new t.PropertyCollection;return a.setProperty(t.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),a}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const a=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(a),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()}startNewSynthesis(a,l,c,u){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=a,this.privRawText=l,this.privIsSSML=c,this.privAudioOutputStream=new e.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",u!==void 0&&(this.privTurnAudioDestination=u,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new i.SynthesisTriggeredEvent(this.requestId,void 0,u===void 0?void 0:u.id()))}onPreConnectionStart(a){this.privAuthFetchEventId=a,this.onEvent(new i.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(a){a&&this.onComplete()}onConnectionEstablishCompleted(a){if(a===200){this.onEvent(new i.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else a===403&&this.onComplete()}onServiceResponseMessage(a){const l=JSON.parse(a);this.streamId=l.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(a){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new n.Deferred;const l=JSON.parse(a);l.webrtc&&(this.privWebRTCSDP=l.webrtc.connectionString)}onAudioChunkReceived(a){this.isSynthesizing&&(this.privAudioOutputStream.write(a),this.privBytesReceived+=a.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(a))}onTextBoundaryEvent(a){this.updateTextOffset(a.Data.text.Text,a.Type)}onVisemeMetadataReceived(a){a.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=a.Data.AnimationChunk)}onSessionEnd(a){this.privAudioDuration=a.Data.Offset}async constructSynthesisResult(){const a=await this.getAllReceivedAudioWithHeader();return new t.SpeechSynthesisResult(this.requestId,t.ResultReason.SynthesizingAudioCompleted,a,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const a=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",a}onEvent(a){n.Events.instance.onEvent(a)}static isXmlTag(a){return a.length>=2&&a[0]==="<"&&a[a.length-1]===">"}updateTextOffset(a,l){l===r.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(a,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+a.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!Zw.isXmlTag(a)&&this.updateTextOffset(a,l))):(this.privSentenceOffset=this.privRawText.indexOf(a,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+a.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!Zw.isXmlTag(a)&&this.updateTextOffset(a,l)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(a){return this.privRawText.indexOf("<",a+1)>this.privRawText.indexOf(">",a+1)}};return ev.SynthesisTurn=s,ev}var tv={},XL;function Q6(){if(XL)return tv;XL=1,Object.defineProperty(tv,"__esModule",{value:!0}),tv.SynthesisAdapterBase=void 0;const n=He(),e=Pe(),t=Ue(),r=eT();let i=class{constructor(o,a,l,c){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!o)throw new n.ArgumentNullError("authentication");if(!a)throw new n.ArgumentNullError("connectionFactory");if(!l)throw new n.ArgumentNullError("synthesizerConfig");this.privAuthentication=o,this.privConnectionFactory=a,this.privSynthesizerConfig=l,this.privIsDisposed=!1,this.privSessionAudioDestination=c,this.privSynthesisTurn=new t.SynthesisTurn,this.privConnectionEvents=new n.EventSource,this.privServiceEvents=new n.EventSource,this.privSynthesisContext=new t.SynthesisContext,this.privAgentConfig=new t.AgentConfig,this.connectionEvents.attach(u=>{if(u.name==="ConnectionClosedEvent"){const h=u;h.statusCode!==1e3&&this.cancelSynthesisLocal(e.CancellationReason.Error,h.statusCode===1007?e.CancellationErrorCode.BadRequestParameters:e.CancellationErrorCode.ConnectionFailure,`${h.reason} websocket error code: ${h.statusCode}`)}})}get synthesizerConfig(){return this.privSynthesizerConfig}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(o){this.privActivityTemplate=o}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(o){this.privAudioOutputFormat=o,this.privSynthesisTurn.audioOutputFormat=o,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=o),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=o)}isDisposed(){return this.privIsDisposed}async dispose(o){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(o)}async connect(){await this.connectImpl()}async sendNetworkMessage(o,a){const l=typeof a=="string"?n.MessageType.Text:n.MessageType.Binary,c=typeof a=="string"?"application/json":"";return(await this.fetchConnection()).send(new r.SpeechConnectionMessage(l,o,this.privSynthesisTurn.requestId,c,a))}async Speak(o,a,l,c,u,h){let m;if(a?m=o:m=this.privSynthesizer.buildSsml(o),this.speakOverride!==void 0)return this.speakOverride(m,l,c,u);this.privSuccessCallback=c,this.privErrorCallback=u,this.privSynthesisTurn.startNewSynthesis(l,o,a,h);try{await this.connectImpl();const v=await this.fetchConnection();await this.sendSynthesisContext(v),await this.sendSsmlMessage(v,m,l),this.onSynthesisStarted(l),this.receiveMessage()}catch(v){return this.cancelSynthesisLocal(e.CancellationReason.Error,e.CancellationErrorCode.ConnectionFailure,v),Promise.reject(v)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new r.SpeechConnectionMessage(n.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(o,a,l,c){const u=new e.PropertyCollection;u.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[l]);const h=new e.SpeechSynthesisResult(o,e.ResultReason.Canceled,void 0,c,u);if(this.onSynthesisCancelled(h),this.privSuccessCallback)try{this.privSuccessCallback(h)}catch{}}cancelSynthesisLocal(o,a,l){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,o,a,l))}processTypeSpecificMessages(o){return!0}async receiveMessage(){try{const a=await(await this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!a)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const l=r.SpeechConnectionMessage.fromConnectionMessage(a);if(l.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(l.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(l.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(l.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===l.streamId.toLowerCase()&&l.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(l.binaryBody),this.onSynthesizing(l.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(l.binaryBody));break;case"audio.metadata":const c=t.SynthesisAudioMetadata.fromJSON(l.textBody).Metadata;for(const h of c)switch(h.Type){case t.MetadataType.WordBoundary:case t.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(h);const m=new e.SpeechSynthesisWordBoundaryEventArgs(h.Data.Offset,h.Data.Duration,h.Data.text.Text,h.Data.text.Length,h.Type===t.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,h.Data.text.BoundaryType);this.onWordBoundary(m);break;case t.MetadataType.Bookmark:const v=new e.SpeechSynthesisBookmarkEventArgs(h.Data.Offset,h.Data.Bookmark);this.onBookmarkReached(v);break;case t.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(h),h.Data.IsLastAnimation){const C=new e.SpeechSynthesisVisemeEventArgs(h.Data.Offset,h.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(C)}break;case t.MetadataType.AvatarSignal:this.onAvatarEvent(h);break;case t.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(h);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let u;try{u=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(u)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.onSynthesisCompleted(u);break;default:this.processTypeSpecificMessages(l)||this.privServiceEvents&&this.serviceEvents.onEvent(new n.ServiceEvent(l.path.toLowerCase(),l.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(o){this.setSynthesisContextSynthesisSection();const a=this.synthesisContext.toJSON();if(a)return o.send(new r.SpeechConnectionMessage(n.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",a))}setSpeechConfigSynthesisSection(){}connectImpl(o=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(l=>l.state()===n.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=(0,n.createNoDashGuid)(),this.privConnectionId=(0,n.createNoDashGuid)(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const a=o?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=a.then(async l=>{this.privSynthesisTurn.onAuthCompleted(!1);const c=await this.privConnectionFactory.create(this.privSynthesizerConfig,l,this.privConnectionId);c.events.attach(h=>{this.connectionEvents.onEvent(h)});const u=await c.open();return u.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(u.statusCode),Promise.resolve(c)):u.statusCode===403&&!o?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(u.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${u.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Url)} Reason: ${u.reason}`))},l=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(l)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(o,a){if(a)return o.send(new r.SpeechConnectionMessage(n.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",a))}sendSsmlMessage(o,a,l){return o.send(new r.SpeechConnectionMessage(n.MessageType.Text,"ssml",l,"application/ssml+xml",a))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(o=>o.state()===n.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){const o=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(o):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(o,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),o)}onAvatarEvent(o){}onSynthesisStarted(o){}onSynthesizing(o){}onSynthesisCancelled(o){}onSynthesisCompleted(o){}onWordBoundary(o){}onVisemeReceived(o){}onBookmarkReached(o){}};return tv.SynthesisAdapterBase=i,i.telemetryDataEnabled=!0,tv}var nv={},QL;function e9(){if(QL)return nv;QL=1,Object.defineProperty(nv,"__esModule",{value:!0}),nv.AvatarSynthesisAdapter=void 0;const n=Pe(),e=Ue();let t=class extends e.SynthesisAdapterBase{constructor(i,s,o,a,l){super(i,s,o,void 0),this.privAvatarSynthesizer=a,this.privSynthesizer=a,this.privAvatarConfig=l}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){var i,s,o,a,l,c,u,h,m,v,C,T,E,x,P,b,I;this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:(i=this.privAvatarConfig.videoFormat)==null?void 0:i.bitrate,codec:(s=this.privAvatarConfig.videoFormat)==null?void 0:s.codec,crop:{bottomRight:{x:(l=(a=(o=this.privAvatarConfig.videoFormat)==null?void 0:o.cropRange)==null?void 0:a.bottomRight)==null?void 0:l.x,y:(h=(u=(c=this.privAvatarConfig.videoFormat)==null?void 0:c.cropRange)==null?void 0:u.bottomRight)==null?void 0:h.y},topLeft:{x:(C=(v=(m=this.privAvatarConfig.videoFormat)==null?void 0:m.cropRange)==null?void 0:v.topLeft)==null?void 0:C.x,y:(x=(E=(T=this.privAvatarConfig.videoFormat)==null?void 0:T.cropRange)==null?void 0:E.topLeft)==null?void 0:x.y}},resolution:{height:(P=this.privAvatarConfig.videoFormat)==null?void 0:P.height,width:(b=this.privAvatarConfig.videoFormat)==null?void 0:b.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(n.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:(I=this.privAvatarConfig.backgroundImage)==null?void 0:I.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,photoAvatarBaseModel:this.privAvatarConfig.photoAvatarBaseModel,style:this.privAvatarConfig.style,useBuiltInVoice:this.privAvatarConfig.useBuiltInVoice}}}onAvatarEvent(i){if(this.privAvatarSynthesizer.avatarEventReceived){const s=new n.AvatarEventArgs(i.Data.Offset,i.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,s)}catch{}}}};return nv.AvatarSynthesisAdapter=t,nv}var rv={},eD;function t9(){if(eD)return rv;eD=1,Object.defineProperty(rv,"__esModule",{value:!0}),rv.SpeechSynthesisAdapter=void 0;const n=Pe(),e=Ue();let t=class extends e.SynthesisAdapterBase{constructor(i,s,o,a,l){super(i,s,o,l),this.privSpeechSynthesizer=a,this.privSynthesizer=a}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(i){const s=new n.SpeechSynthesisEventArgs(new n.SpeechSynthesisResult(i,n.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,s)}onSynthesizing(i){if(this.privSpeechSynthesizer.synthesizing)try{const s=this.privSynthesisTurn.audioOutputFormat.addHeader(i),o=new n.SpeechSynthesisEventArgs(new n.SpeechSynthesisResult(this.privSynthesisTurn.requestId,n.ResultReason.SynthesizingAudio,s));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,o)}catch{}}onSynthesisCancelled(i){if(this.privSpeechSynthesizer.SynthesisCanceled){const s=new n.SpeechSynthesisEventArgs(i);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,s)}catch{}}}onSynthesisCompleted(i){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new n.SpeechSynthesisEventArgs(i))}catch{}}onWordBoundary(i){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,i)}catch{}}onVisemeReceived(i){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,i)}catch{}}onBookmarkReached(i){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,i)}catch{}}};return rv.SpeechSynthesisAdapter=t,rv}var iv={},tD;function n9(){if(tD)return iv;tD=1,Object.defineProperty(iv,"__esModule",{value:!0}),iv.SynthesisRestAdapter=void 0;const n=Fr(),e=Pe(),t=pa(),r=gi();let i=class{constructor(o,a){let l=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!l){const u=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,"westus"),h=t.ConnectionFactoryBase.getHostSuffix(u);l=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,`https://${u}.tts.speech${h}`)}this.privUri=`${l}/cognitiveservices/voices/list`;const c=n.RestConfigBase.requestOptions;this.privRestAdapter=new n.RestMessageAdapter(c),this.privAuthentication=a}getVoicesList(o){return this.privRestAdapter.setHeaders(r.HeaderNames.ConnectionId,o),this.privAuthentication.fetch(o).then(a=>(this.privRestAdapter.setHeaders(a.headerName,a.token),this.privRestAdapter.request(n.RestRequestType.Get,this.privUri)))}};return iv.SynthesisRestAdapter=i,iv}var Sw={},nD;function r9(){return nD||(nD=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SynthesizerConfig=n.SynthesisServiceType=void 0;const e=Ue();var t;(function(i){i[i.Standard=0]="Standard",i[i.Custom=1]="Custom"})(t=n.SynthesisServiceType||(n.SynthesisServiceType={}));class r{constructor(s,o){this.privSynthesisServiceType=t.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=s||new e.SpeechServiceConfig(new e.Context(null)),this.privParameters=o}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(s){this.privSynthesisServiceType=s}set synthesisVideoSection(s){this.privSpeechServiceConfig.Context.synthesis={video:s}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}setContextFromJson(s){const o=JSON.parse(s);o.system&&(this.privSpeechServiceConfig.Context.system=o.system),o.os&&(this.privSpeechServiceConfig.Context.os=o.os),o.audio&&(this.privSpeechServiceConfig.Context.audio=o.audio),o.synthesis&&(this.privSpeechServiceConfig.Context.synthesis=o.synthesis)}}n.SynthesizerConfig=r})(Sw)),Sw}var sv={},rD;function i9(){if(rD)return sv;rD=1,Object.defineProperty(sv,"__esModule",{value:!0}),sv.SynthesisContext=void 0;const n=Pe();let e=class{constructor(){this.privContext={}}setSection(r,i){this.privContext[r]=i}set audioOutputFormat(r){this.privAudioOutputFormat=r}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(r){const i=this.buildSynthesisContext(r);this.setSection("synthesis",i)}buildSynthesisContext(r){return{audio:{metadataOptions:{bookmarkEnabled:!!(r!=null&&r.bookmarkReached),punctuationBoundaryEnabled:r==null?void 0:r.properties.getProperty(n.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!(r!=null&&r.wordBoundary)),sentenceBoundaryEnabled:r==null?void 0:r.properties.getProperty(n.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!(r!=null&&r.visemeReceived),wordBoundaryEnabled:r==null?void 0:r.properties.getProperty(n.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!(r!=null&&r.wordBoundary))},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:r==null?void 0:r.autoDetectSourceLanguage}}}};return sv.SynthesisContext=e,sv}var Cw={},iD;function s9(){return iD||(iD=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.type=n.connectivity=n.Device=n.OS=n.System=n.Context=n.SpeechServiceConfig=void 0;class e{constructor(a){this.context=a}serialize(){return JSON.stringify(this,(a,l)=>{if(l&&typeof l=="object"&&!Array.isArray(l)){const c={};for(const u in l)Object.hasOwnProperty.call(l,u)&&(c[u&&u.charAt(0).toLowerCase()+u.substring(1)]=l[u]);return c}return l})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(a){this.recognition=a.toLowerCase()}}n.SpeechServiceConfig=e;class t{constructor(a){this.system=new r,this.os=a}}n.Context=t;class r{constructor(){const a="1.47.0";this.name="SpeechSDK",this.version=a,this.build="JavaScript",this.lang="JavaScript"}}n.System=r;class i{constructor(a,l,c){this.platform=a,this.name=l,this.version=c}}n.OS=i;class s{constructor(a,l,c){this.manufacturer=a,this.model=l,this.version=c}}n.Device=s,(function(o){o.Bluetooth="Bluetooth",o.Wired="Wired",o.WiFi="WiFi",o.Cellular="Cellular",o.InBuilt="InBuilt",o.Unknown="Unknown"})(n.connectivity||(n.connectivity={})),(function(o){o.Phone="Phone",o.Speaker="Speaker",o.Car="Car",o.Headset="Headset",o.Thermostat="Thermostat",o.Microphones="Microphones",o.Deskphone="Deskphone",o.RemoteControl="RemoteControl",o.Unknown="Unknown",o.File="File",o.Stream="Stream"})(n.type||(n.type={}))})(Cw)),Cw}var sD;function Ue(){return sD||(sD=1,(function(n){var e=lc&&lc.__createBinding||(Object.create?(function(s,o,a,l){l===void 0&&(l=a),Object.defineProperty(s,l,{enumerable:!0,get:function(){return o[a]}})}):(function(s,o,a,l){l===void 0&&(l=a),s[l]=o[a]})),t=lc&&lc.__exportStar||function(s,o){for(var a in s)a!=="default"&&!Object.prototype.hasOwnProperty.call(o,a)&&e(o,s,a)};Object.defineProperty(n,"__esModule",{value:!0}),n.AutoDetectSourceLanguagesOpenRangeOptionName=n.ForceDictationPropertyName=n.ServicePropertiesPropertyName=n.CancellationErrorCodePropertyName=n.OutputFormatPropertyName=n.SpeechSynthesisAdapter=n.AvatarSynthesisAdapter=void 0,t(r8(),n),t(i8(),n),t(HP(),n),t(s8(),n),t(o8(),n),t(ZP(),n),t(r6(),n),t(i6(),n),t(s6(),n),t(o6(),n),t(a6(),n),t(l6(),n),t(c6(),n),t(u6(),n),t(d6(),n),t(XB(),n),t(h6(),n),t(p6(),n),t(f6(),n),t(m6(),n),t(g6(),n),t(v6(),n),t(y6(),n),t(S6(),n),t(C6(),n),t(A6(),n),t(E6(),n),t(x6(),n),t(w6(),n),t(b6(),n),t(R6(),n),t(_6(),n),t(M6(),n),t(B6(),n),t(F6(),n),t(Y6(),n),t(hF(),n),t(X6(),n),t(Q6(),n);var r=e9();Object.defineProperty(n,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return r.AvatarSynthesisAdapter}});var i=t9();Object.defineProperty(n,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return i.SpeechSynthesisAdapter}}),t(n9(),n),t(r9(),n),t(i9(),n),t(s9(),n),n.OutputFormatPropertyName="OutputFormat",n.CancellationErrorCodePropertyName="CancellationErrorCode",n.ServicePropertiesPropertyName="ServiceProperties",n.ForceDictationPropertyName="ForceDictation",n.AutoDetectSourceLanguagesOpenRangeOptionName="UND"})(lc)),lc}var oD;function o9(){return oD||(oD=1,(function(n){var e=ac&&ac.__createBinding||(Object.create?(function(i,s,o,a){a===void 0&&(a=o),Object.defineProperty(i,a,{enumerable:!0,get:function(){return s[o]}})}):(function(i,s,o,a){a===void 0&&(a=o),i[a]=s[o]})),t=ac&&ac.__exportStar||function(i,s){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,i,o)};Object.defineProperty(n,"__esModule",{value:!0});const r=Ue();new r.AgentConfig,t(Pe(),n)})(ac)),ac}var jt=o9();const io="2024-02-01-preview";function so(n){return`https://${n}.api.cognitive.microsoft.com/customvoice`}function fa(n){return{"Ocp-Apim-Subscription-Key":n}}function a9(n){return{"Ocp-Apim-Subscription-Key":n,"Content-Type":"application/json"}}async function ma(n){var e;if(!n.ok){const t=await n.text();let r=`API error: ${n.status} ${n.statusText}`;try{const i=JSON.parse(t);(e=i.error)!=null&&e.message?r=i.error.message:i.message&&(r=i.message)}catch{t&&(r=t)}throw new Error(r)}if(n.status!==204)return n.json()}async function l9(n,e){const t=`${so(n.region)}/projects/${e}?api-version=${io}`;try{const r=await fetch(t,{method:"GET",headers:fa(n.apiKey)});return r.status===404?null:r.ok?await r.json():(console.warn(`getProject returned ${r.status}, will create new project`),null)}catch(r){return console.warn("getProject failed, will create new project:",r),null}}async function c9(n,e,t){const r=`${so(n.region)}/projects/${e}?api-version=${io}`,i={kind:"PersonalVoice",description:"Personal Voice Playground Project"},s=await fetch(r,{method:"PUT",headers:a9(n.apiKey),body:JSON.stringify(i)});return ma(s)}async function u9(n,e){let t=`${so(n.region)}/consents?api-version=${io}`;e&&(t+=`&filter=projectId eq '${e}'`);const r=await fetch(t,{method:"GET",headers:fa(n.apiKey)});return(await ma(r)).value}async function d9(n,e){const t=`${so(n.region)}/consents/${e}?api-version=${io}`,r=await fetch(t,{method:"GET",headers:fa(n.apiKey)});return ma(r)}async function h9(n,e){const t=`${so(n.region)}/consents/${e.consentId}?api-version=${io}`,r=new FormData;r.append("projectId",e.projectId),r.append("voiceTalentName",e.voiceTalentName),r.append("companyName",e.companyName),r.append("locale",e.locale),e.description&&r.append("description",e.description),r.append("audiodata",e.audioFile,"consent.wav");const i=await fetch(t,{method:"POST",headers:fa(n.apiKey),body:r});return ma(i)}async function p9(n,e){const t=`${so(n.region)}/consents/${e}?api-version=${io}`,r=await fetch(t,{method:"DELETE",headers:fa(n.apiKey)});await ma(r)}async function pF(n,e){let t=`${so(n.region)}/personalvoices?api-version=${io}`;e&&(t+=`&filter=projectId eq '${e}'`);const r=await fetch(t,{method:"GET",headers:fa(n.apiKey)});return(await ma(r)).value}async function f9(n,e){const t=`${so(n.region)}/personalvoices/${e}?api-version=${io}`,r=await fetch(t,{method:"GET",headers:fa(n.apiKey)});return ma(r)}async function m9(n,e){const t=`${so(n.region)}/personalvoices/${e.personalVoiceId}?api-version=${io}`,r=new FormData;r.append("projectId",e.projectId),r.append("consentId",e.consentId),e.description&&r.append("description",e.description),e.audioFiles.forEach((s,o)=>{r.append("audiodata",s,`audio_${o}.wav`)});const i=await fetch(t,{method:"POST",headers:fa(n.apiKey),body:r});return ma(i)}async function g9(n,e){const t=`${so(n.region)}/personalvoices/${e}?api-version=${io}`,r=await fetch(t,{method:"DELETE",headers:fa(n.apiKey)});await ma(r)}async function v9(n,e,t=3e4,r=1e3){const i=Date.now();for(;Date.now()-i<t;){const s=await d9(n,e);if(s.status==="Succeeded"||s.status==="Failed")return s;await new Promise(o=>setTimeout(o,r))}throw new Error("Consent creation timed out")}async function y9(n,e,t=6e4,r=2e3){const i=Date.now();for(;Date.now()-i<t;){const s=await f9(n,e);if(s.status==="Succeeded"||s.status==="Failed")return s;await new Promise(o=>setTimeout(o,r))}throw new Error("Personal voice creation timed out")}function Uv(n,e,t="en-US",r="DragonLatestNeural"){return`<speak version='1.0' xml:lang='${t}' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts'>
  <voice name='${r}'>
    <mstts:ttsembedding speakerProfileId='${e}'/>
    <mstts:express-as style='Prompt'>
      ${n}
    </mstts:express-as>
  </voice>
</speak>`}async function S9(n,e,t,r="en-US",i="DragonLatestNeural"){const s=Uv(e,t,r,i),o=`https://${n.region}.tts.speech.microsoft.com/cognitiveservices/v1`,a=await fetch(o,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":n.apiKey,"Content-Type":"application/ssml+xml","X-Microsoft-OutputFormat":"audio-24khz-48kbitrate-mono-mp3"},body:s});if(!a.ok){const l=await a.text();throw new Error(`TTS synthesis failed: ${a.status} ${l}`)}return a.arrayBuffer()}function C9(n){const[e,t]=O.useState("idle"),[r,i]=O.useState(""),[s,o]=O.useState([]),[a,l]=O.useState(-1),[c,u]=O.useState(null),h=O.useRef(n);O.useEffect(()=>{h.current=n},[n]);const m=O.useRef(null),v=O.useRef(null),C=O.useRef([]),T=O.useRef(0),E=O.useRef(null),x=O.useRef(!1),P=O.useRef([]),b=O.useRef(!1),I=O.useRef(!1),M=O.useRef(!1),N=O.useRef(""),D=O.useRef(null),j=O.useCallback(()=>{var ae,$;m.current&&m.current.close();const K=h.current,ee=((ae=K.personalVoiceInfo)==null?void 0:ae.isPersonalVoice)&&(($=K.personalVoiceInfo)==null?void 0:$.speakerProfileId);console.log("Initializing synthesizer with voice:",K.selectedVoice,"isPersonalVoice:",ee),console.log("personalVoiceInfo:",K.personalVoiceInfo);const G=jt.SpeechConfig.fromSubscription(K.apiKey,K.region);ee||(G.speechSynthesisVoiceName=K.selectedVoice),G.speechSynthesisOutputFormat=jt.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3;const X=new jt.SpeakerAudioDestination;v.current=X;const Y=jt.AudioConfig.fromSpeakerOutput(X),ce=new jt.SpeechSynthesizer(G,Y);return m.current=ce,ce},[]),F=O.useCallback(()=>{if(!x.current){console.log("Stopped tracking - not playing");return}let K=Date.now()-T.current;if(v.current&&v.current.currentTime)try{const G=v.current.currentTime;G>0&&(K=G*1e3)}catch{}let ee=-1;for(let G=0;G<P.current.length&&P.current[G].audioOffset<=K+300;G++)ee=G;if(ee!==-1&&l(ee),Math.floor(K/500)!==Math.floor((K-16)/500)){const G=ee>=0?P.current[ee]:null;console.log(` ${K.toFixed(0)}ms | Word [${ee}]: "${G==null?void 0:G.text}" @ ${G==null?void 0:G.audioOffset}ms | Total: ${P.current.length} | Complete: ${I.current}`)}x.current&&(E.current=requestAnimationFrame(F))},[]),z=O.useCallback((K,ee)=>{var ae,$;if(!K.trim()){i("Please enter some text to synthesize");return}t("synthesizing"),i(""),o([]),l(-1),C.current=[],P.current=[],x.current=!1,b.current=!1,I.current=!1,M.current=!1,N.current=K;const G=j(),X=setTimeout(()=>{P.current.length===0&&(console.log(" No word boundary received within 1 second - will start playback when audio arrives"),M.current=!0)},1e3);G.wordBoundary=(J,de)=>{var se;let me=de.textOffset;if(((se=h.current.personalVoiceInfo)==null?void 0:se.isPersonalVoice)&&de.text){const ie=P.current[P.current.length-1],Se=ie?ie.offset+ie.length:0,re=N.current.indexOf(de.text,Se);re!==-1&&(me=re)}const le={text:de.text,offset:me,length:de.wordLength,audioOffset:de.audioOffset/1e4};if(P.current.push(le),o([...P.current]),console.log(` Word boundary: "${le.text}" at ${le.audioOffset}ms (text offset: ${le.offset})`),P.current.length===1){clearTimeout(X),M.current=!1;const ie=Date.now(),Se=ie-le.audioOffset;T.current=Se,console.log(" FIRST word boundary - starting playback. Word:",le.text,"offset:",le.audioOffset,"ms. Playback start:",Se,"Current time:",ie),x.current?(console.log(" Switching from fallback mode to word boundary mode - restarting tracking"),F()):(x.current=!0,t("playing"),F())}},G.synthesizing=(J,de)=>{de.result.audioData&&(C.current.push(new Uint8Array(de.result.audioData)),M.current&&!x.current&&C.current.length===1&&(console.log(" First audio chunk received (fallback mode) - starting playback"),T.current=Date.now(),x.current=!0,t("playing")))},G.synthesisStarted=()=>{t("synthesizing"),console.log("Synthesis started")},G.synthesisCompleted=(J,de)=>{const me=C.current.reduce((re,pe)=>re+pe.length,0),Te=new Uint8Array(me);let le=0;for(const re of C.current)Te.set(re,le),le+=re.length;u(Te.buffer),I.current=!0,console.log(" Synthesis completed - now have all",P.current.length,"word boundaries");const se=me*8/48e3*1e3,ie=Date.now()-T.current,Se=Math.max(100,se-ie+300);console.log(` Estimated audio duration: ${se}ms, current playback: ${ie}ms, will stop in: ${Se}ms`),x.current||(T.current=Date.now(),x.current=!0,t("playing")),D.current&&clearTimeout(D.current),D.current=setTimeout(()=>{console.log(" Audio playback ended (duration timeout)"),x.current=!1,E.current&&(cancelAnimationFrame(E.current),E.current=null),t("idle"),l(-1),D.current=null},Se)},G.SynthesisCanceled=(J,de)=>{console.error("Synthesis canceled:",de.errorDetails),i(de.errorDetails||"Synthesis was canceled"),t("error"),l(-1),x.current=!1,E.current&&cancelAnimationFrame(E.current)};const Y=h.current,ce=((ae=Y.personalVoiceInfo)==null?void 0:ae.isPersonalVoice)&&(($=Y.personalVoiceInfo)==null?void 0:$.speakerProfileId);if(console.log("=== SYNTHESIS DEBUG ==="),console.log("currentSettings.personalVoiceInfo:",Y.personalVoiceInfo),console.log("isPersonalVoice:",ce),console.log("selectedVoice:",Y.selectedVoice),console.log("locale:",ee),console.log("======================="),ce){const J=Y.personalVoiceInfo.model||"DragonLatestNeural",de=ee||"en-US",me=Uv(K,Y.personalVoiceInfo.speakerProfileId,de,J);console.log("Using personal voice SSML with model:",J),console.log("SSML:",me),G.speakSsmlAsync(me,Te=>{Te.reason===jt.ResultReason.SynthesizingAudioCompleted?console.log("Personal voice synthesis completed successfully"):(console.error("Personal voice synthesis failed:",Te.errorDetails),i(Te.errorDetails||"Synthesis failed"),t("error"))},Te=>{console.error("Personal voice synthesis error:",Te),i(Te),t("error")})}else G.speakTextAsync(K,J=>{J.reason===jt.ResultReason.SynthesizingAudioCompleted?console.log("Synthesis completed successfully"):(console.error("Synthesis failed:",J.errorDetails),i(J.errorDetails||"Synthesis failed"),t("error"))},J=>{console.error("Synthesis error:",J),i(J),t("error")})},[j,F]),W=O.useCallback(()=>{v.current&&e==="playing"&&(v.current.pause(),t("paused"),x.current=!1,E.current&&(cancelAnimationFrame(E.current),E.current=null))},[e]),H=O.useCallback(()=>{v.current&&e==="paused"&&(v.current.resume(),t("playing"),x.current=!0,F())},[e,F]),V=O.useCallback(()=>{console.log(" Stop called - cleaning up"),x.current=!1,E.current&&(cancelAnimationFrame(E.current),E.current=null),v.current&&v.current.pause(),m.current&&(m.current.close(),m.current=null),t("idle"),l(-1)},[]);return{state:e,error:r,wordBoundaries:s,currentWordIndex:a,audioData:c,synthesize:z,pause:W,resume:H,stop:V}}async function A9(n,e,t=!1){try{const r=n.length>8?`${n.substring(0,4)}...${n.substring(n.length-4)}`:"****";console.log("=== FETCHING VOICES ==="),console.log("Region:",e),console.log("API Key:",r),console.log("=======================");const i=`https://${e}.tts.speech.microsoft.com/cognitiveservices/voices/list`,s=await fetch(i,{headers:{"Ocp-Apim-Subscription-Key":n}});if(!s.ok)throw new Error(`Failed to fetch voices: ${s.status} ${s.statusText}`);const o=await s.json();console.log("Fetched voices - total count:",o.length),console.log("First voice full structure:",JSON.stringify(o[0],null,2));const a=[...new Set(o.map(c=>c.VoiceType))];console.log("Available VoiceType values:",a),a.forEach(c=>{const u=o.find(h=>h.VoiceType===c);u&&console.log(`Sample ${c} voice:`,u.ShortName,u)});const l=o.map(c=>{var v,C;const u=((v=c.ShortName)==null?void 0:v.includes("HD"))||((C=c.Name)==null?void 0:C.includes("HD")),h=c.WordsPerMinute||c.SecondaryLocaleList||[];let m="Female";return typeof c.Gender=="number"?m=c.Gender===1?"Female":"Male":typeof c.Gender=="string"&&(m=c.Gender),{name:c.ShortName||c.Name||"Unknown",locale:String(c.Locale||"en-US"),gender:m,description:`${c.LocalName||c.DisplayName||c.Name||"Unknown"} (${c.Locale||"Unknown"})`,styleList:c.StyleList||[],isFeatured:u,voiceType:c.VoiceType,isNeuralHD:u,keywords:Array.isArray(h)?h:[],wordsPer:c.WordsPerMinute,voiceTag:c.VoiceTag||{}}});return t&&(e.toLowerCase()==="eastus"||e==="East US")&&(console.log("Adding hardcoded MAI voices for East US region"),l.unshift({name:"en-us-phoebe:MAI-Voice-1",locale:"en-US",gender:"Female",description:"Phoebe MAI Voice (en-US)",styleList:[],isFeatured:!0,voiceType:"Neural",isNeuralHD:!0,keywords:["MAI"],wordsPer:void 0},{name:"en-us-benjamin:MAI-Voice-1",locale:"en-US",gender:"Male",description:"Benjamin MAI Voice (en-US)",styleList:[],isFeatured:!0,voiceType:"Neural",isNeuralHD:!0,keywords:["MAI"],wordsPer:void 0})),l.sort((c,u)=>c.isFeatured&&!u.isFeatured?-1:!c.isFeatured&&u.isFeatured?1:c.name.localeCompare(u.name)),console.log("Successfully processed voices:",l.length),l}catch(r){throw console.error("Failed to fetch voices:",r),r}}function T9({apiKey:n,region:e,selectedVoice:t,onVoiceChange:r,onVoiceInfoChange:i,enableMAIVoices:s=!1}){const[o,a]=O.useState([]),[l,c]=O.useState([]),[u,h]=O.useState(!1),[m,v]=O.useState(""),[C,T]=O.useState(""),[E,x]=O.useState(""),[P,b]=O.useState(!1);O.useEffect(()=>{n&&e&&(h(!0),v(""),A9(n,e,s).then(N=>{a(N);const D=N.filter(F=>F.name.toLowerCase().includes("openai")),j=N.filter(F=>F.name.toLowerCase().includes("mai-voice")||F.name.toLowerCase().includes(":mai-"));console.log(`Found ${D.length} OpenAI voices:`,D.map(F=>F.name)),console.log(`Found ${j.length} MAI voices:`,j.map(F=>F.name)),h(!1)}).catch(N=>{console.error("Failed to fetch voices:",N),v("Failed to load voices from Azure."),a([]),h(!1)}))},[n,e,s]),O.useEffect(()=>{E==="MyVoices"&&n&&e&&(h(!0),pF({apiKey:n,region:e}).then(D=>{const j=D.filter(F=>F.status==="Succeeded");c(j),console.log(`Found ${j.length} personal voices:`,j.map(F=>F.id)),h(!1)}).catch(D=>{console.error("Failed to fetch personal voices:",D),c([]),h(!1)}))},[E,n,e]);const I=E==="MyVoices",M=I?[]:o.filter(N=>{var F,z,W,H;if(N.name.toLowerCase().includes("multitalker"))return!1;if(E)switch(E){case"MAI":const V=N.name.toLowerCase().includes("mai-voice")||N.name.toLowerCase().includes(":mai-"),K=Array.isArray((F=N.voiceTag)==null?void 0:F.Source)&&N.voiceTag.Source.some(X=>X.toLowerCase()==="mai");if(!V&&!K)return!1;break;case"HD":if(!N.isNeuralHD)return!1;break;case"NonHD":if(N.isNeuralHD)return!1;break;case"OpenAI":const ee=N.name.toLowerCase().includes("openai"),G=Array.isArray((z=N.voiceTag)==null?void 0:z.Source)&&N.voiceTag.Source.some(X=>X.toLowerCase()==="openai");if(!ee&&!G)return!1;break}if(!C)return!0;const D=C.toLowerCase().trim(),j=V=>V.toLowerCase().split(/\s+/).some(ee=>ee===D);return N.name.toLowerCase().includes(D)||N.description.toLowerCase().includes(D)||j(N.locale)||N.gender&&j(N.gender)||((W=N.styleList)==null?void 0:W.some(V=>j(V)))||((H=N.keywords)==null?void 0:H.some(V=>j(String(V))))});return O.useEffect(()=>{if(M.length>0){const N=M[0],D=M.some(j=>j.name===t);P&&(C||E)&&!D&&(console.log("Auto-selecting top voice from filtered list:",N.name),r(N.name),i==null||i({voiceName:N.name,isPersonalVoice:!1,locale:N.locale}))}},[C,M.length,E]),g.jsxs("div",{className:"h-full flex flex-col space-y-2",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Voice"}),m&&g.jsx("div",{className:"text-sm text-yellow-600 bg-yellow-50 p-2 rounded",children:m}),g.jsxs("div",{className:"flex gap-2 flex-wrap",children:[g.jsx("button",{onClick:()=>x(""),className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${E===""?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"All"}),g.jsx("button",{onClick:()=>{x(E==="HD"?"":"HD"),b(!0)},className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${E==="HD"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"HD"}),g.jsx("button",{onClick:()=>{x(E==="MAI"?"":"MAI"),b(!0)},className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${E==="MAI"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"MAI"}),g.jsx("button",{onClick:()=>{x(E==="OpenAI"?"":"OpenAI"),b(!0)},className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${E==="OpenAI"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"OpenAI"}),g.jsx("button",{onClick:()=>{x(E==="NonHD"?"":"NonHD"),b(!0)},className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${E==="NonHD"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Non-HD"}),g.jsx("button",{onClick:()=>{x(E==="MyVoices"?"":"MyVoices"),b(!0)},className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${E==="MyVoices"?"bg-emerald-600 text-white":"bg-emerald-100 text-emerald-700 hover:bg-emerald-200"}`,children:"My Voices"})]}),g.jsx("input",{type:"text",placeholder:"Search voices...",value:C,onChange:N=>{console.log("Search term changed to:",N.target.value),T(N.target.value),b(!0)},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),t&&g.jsxs("div",{className:"p-2 bg-blue-50 border border-blue-200 rounded-md flex-shrink-0",children:[g.jsx("div",{className:"text-xs text-blue-600 font-medium",children:"Selected:"}),g.jsx("div",{className:"text-sm text-blue-800 truncate",children:t})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto border border-gray-200 rounded-md min-h-0",children:[u&&g.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"Loading voices..."}),!u&&!I&&M.length===0&&g.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No voices found"}),!u&&!I&&M.map(N=>{var F,z;const D=[];(F=N.voiceTag)!=null&&F.ContentCategories&&D.push(...N.voiceTag.ContentCategories),(z=N.voiceTag)!=null&&z.VoicePersonalities&&D.push(...N.voiceTag.VoicePersonalities);const j=D.length>0?` [${D.join(", ")}]`:"";return g.jsxs("button",{onClick:()=>{console.log("Voice changed to:",N.name),r(N.name),i==null||i({voiceName:N.name,isPersonalVoice:!1,locale:N.locale})},className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${t===N.name?"bg-blue-50 border-l-4 border-l-blue-600":"hover:bg-gray-50"}`,children:[g.jsxs("div",{className:"font-medium text-gray-800 text-sm",children:[N.isFeatured?" ":"",N.name]}),j&&g.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:j})]},N.name)}),!u&&I&&l.length===0&&g.jsxs("div",{className:"p-4 text-center text-gray-500 text-sm",children:[g.jsx("p",{children:"No personal voices found"}),g.jsx("p",{className:"text-xs mt-1",children:"Create voices in Voice Creation playground"})]}),!u&&I&&l.map(N=>g.jsxs("button",{onClick:()=>{console.log("Personal voice selected:",N.id,"speakerProfileId:",N.speakerProfileId);const D=`personal:${N.id}`;r(D),i==null||i({voiceName:N.id,isPersonalVoice:!0,speakerProfileId:N.speakerProfileId})},className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${t===`personal:${N.id}`?"bg-emerald-50 border-l-4 border-l-emerald-600":"hover:bg-gray-50"}`,children:[g.jsxs("div",{className:"font-medium text-gray-800 text-sm flex items-center gap-2",children:[g.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),N.id]}),g.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"Personal Voice"})]},N.id))]}),g.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 pt-2",children:I?`${l.length} personal voice${l.length!==1?"s":""}`:`${M.length} voice${M.length!==1?"s":""} available${C?` (filtered from ${o.length})`:""}`})]})}const aD={"en-GB":"Welcome to our programme exploring the fascinating world of marine biology. From the depths of the ocean to coastal waters, we'll discover the wonders of underwater life.","en-AU":"G'day and welcome to our show about the amazing world of marine biology. From the deep blue ocean to our beautiful coastlines, we'll explore the incredible underwater world.","en-CA":"Welcome to our podcast about the wonderful world of marine biology. From the depths of the ocean to our coastal waters, we'll explore the amazing underwater ecosystems.","en-IN":"Welcome to our programme on marine biology. We will explore the fascinating world beneath the oceans, from the deepest waters to coastal regions.","hi-IN":"                ,           ","es-ES":"Bienvenidos a nuestro programa sobre el fascinante mundo de la biologa marina. Desde las profundidades del ocano hasta las costas, exploraremos las maravillas del mundo submarino.","es-MX":"Bienvenidos a nuestro podcast sobre el fascinante mundo de la biologa marina. Desde las profundidades del mar hasta nuestras costas, exploraremos las maravillas del mundo submarino.","ja-JP":"","fr-FR":"Bienvenue dans notre mission sur le monde fascinant de la biologie marine. Des profondeurs ocaniques aux ctes, nous explorerons les merveilles du monde sous-marin.","fr-CA":"Bienvenue  notre mission sur le merveilleux monde de la biologie marine. Des profondeurs de l'ocan jusqu'aux ctes, nous explorerons les merveilles du monde sous-marin.","pt-BR":"Bem-vindos ao nosso podcast sobre o fascinante mundo da biologia marinha. Das profundezas do oceano at as costas, vamos explorar as maravilhas do mundo submarino.","pt-PT":"Bem-vindos ao nosso programa sobre o fascinante mundo da biologia marinha. Desde as profundezas do oceano at s costas, iremos explorar as maravilhas do mundo submarino.","it-IT":"Benvenuti al nostro programma sul affascinante mondo della biologia marina. Dalle profondit dell'oceano alle coste, esploreremo le meraviglie del mondo sottomarino.","zh-TW":",","ko-KR":"      .   ,          .","nl-NL":"Welkom bij ons programma over de fascinerende wereld van de mariene biologie. Van de diepten van de oceaan tot de kustlijnen, we verkennen de wonderen van de onderwaterwereld.","sv-SE":"Vlkommen till vrt program om den fascinerande vrlden av marinbiologi. Frn havets djup till kusterna kommer vi att utforska undervattensvrldens under.","pl-PL":"Witamy w naszym programie o fascynujcym wiecie biologii morskiej. Od gbin oceanu po wybrzea, bdziemy odkrywa cuda podwodnego wiata.","nb-NO":"Velkommen til vrt program om den fascinerende verden av marinbiologi. Fra havets dyp til kystene vil vi utforske undervannens underverker.","da-DK":"Velkommen til vores program om den fascinerende verden af marinbiologi. Fra havets dybder til kysterne vil vi udforske undervandensverdenens vidundere.","fi-FI":"Tervetuloa ohjelmaammme meribiologian kiehtovasta maailmasta. Valtameren syvyyksist rannikoille tutkimme vedenalaisen maailman ihmeit.","ru-RU":"         .           .","ca-ES":"Benvinguts al nostre programa sobre el fascinant mn de la biologia marina. Des de les profunditats de l'oce fins a les costes, explorarem les meravelles del mn submar.","tr-TR":"Deniz biyolojisinin byleyici dnyas hakkndaki programmza ho geldiniz. Okyanusun derinliklerinden kylara kadar, su alt dnyasnn harikalarn kefedeceiz.","ar-SA":"        .          .","ar-EG":"        .           .","th-TH":"  ","he-IL":"         .    ,      -.","cs-CZ":"Vtejte v naem poadu o fascinujcm svt mosk biologie. Od hlubin ocenu a po pobe budeme zkoumat zzraky podmoskho svta.","hu-HU":"dvzljk msorunkban a tengeri biolgia lenygz vilgrl. Az cen mlytl a partokig felfedezzk a vz alatti vilg csodit.","uk-UA":"         .          .","cy-GB":"Croeso i'n rhaglen am fyd hynod ddiddorol bioleg forol. O ddyfnderoedd y cefnfor i'r arfordiroedd, byddwn yn archwilio rhyfeddodau'r byd tanddwr.","vi-VN":"Cho mng n vi chng trnh ca chng ti v th gii hp dn ca sinh hc bin. T  su ca i dng n b bin, chng ta s khm ph nhng k quan ca th gii di nc.","sl-SI":"Dobrodoli v naem programu o fascinantnem svetu morske biologije. Od globin oceana do obal bomo raziskovali udee podvodnega sveta.","id-ID":"Selamat datang di program kami tentang dunia biologi laut yang menarik. Dari kedalaman samudra hingga garis pantai, kami akan menjelajahi keajaiban dunia bawah laut.","el-GR":"           .        ,       .","sk-SK":"Vitajte v naom programe o fascinujcom svete morskej biolgie. Od hlbn ocenu a po pobreia budeme skma zzraky podmorskho sveta.","hr-HR":"Dobrodoli u na program o fascinantnom svijetu morske biologije. Od dubina oceana do obala, istrait emo uda podvodnog svijeta.","ro-RO":"Bun venit la programul nostru despre lumea fascinant a biologiei marine. De la adncurile oceanului pn la coaste, vom explora minunile lumii subacvatice.","lt-LT":"Sveiki atvyk  ms program apie av jr biologijos pasaul. Nuo vandenyno gelmi iki krant tyrinsime povandeninio pasaulio stebuklus.","bg-BG":"      fascinating world   .            .","lv-LV":"Laipni ldzam msu programm par aizraujoo jras bioloijas pasauli. No okena dziumiem ldz krastiem ms izptsim zemdens pasaules brnumus.","et-EE":"Tere tulemast meie saatesse pnevast merebioloogia maailmast. Ookeani sgavustest kuni rannikualadeni uurime veealuse maailma imesid.","sr-RS":"Dobrodoli u na program o fascinantnom svetu morske biologije. Od dubina okeana do obala, istraiemo uda podvodnog sveta."},Aw={"en-US":{podcast:"Welcome to One Fish, Two Fish, the podcast that aims to make you laugh as you learn about the fascinating world of marine biology. From the depths of the deep blue to the shores of our coastlines, we'll explore the wonders of the underwater world and the creatures that call it home.",education:"Welcome to today's online math lesson! In this session, we'll delve into the fascinating world of algebra. We'll start by exploring the basics, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardized checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed on her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named 'Perseverance,' touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, beautiful people! Welcome back to my channel. Today, we're about to spill all the tea on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh boy, here we go. You know, I walked into this improv show, and I thought, 'Hey, this could be fun. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you folks.",enthusiastic:"Oh my gosh, that's AMAZING news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a mix of both? Tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, uh, I was thinkingno, I mean, I was wondering if, um, if you might want to go to the, uh, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite.",callcenter:"Thank you for calling customer support. My name is Sarah, and I'll be happy to assist you today. I understand you're experiencing an issue with your account. Let me pull up your information and see how I can help resolve this for you right away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their color. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"zh-CN":{podcast:",",education:"",instructions:"",story:"",ads:"iPhoneiPhone",news:"NASA",promotional:"",vlog:"",business:"Winnebago IndustriesWGO",standup:"",enthusiastic:"",casual:"",hesitant:"",callcenter:"",explainer:""},"de-DE":{podcast:"Willkommen zu unserem Podcast ber die faszinierende Welt der Meeresbiologie. Von den Tiefen des Ozeans bis zu den Ksten werden wir die Wunder der Unterwasserwelt und die erstaunlichen Kreaturen erkunden.",education:"Willkommen zur heutigen Online-Mathematikstunde! In dieser Sitzung werden wir in die faszinierende Welt der Algebra eintauchen. Wir beginnen mit den Grundlagen, vom Lsen einfacher Gleichungen bis zum Verstndnis von Variablen.",instructions:"Machen Sie bei der Durchfhrung der Inspektion klare und umfassende Notizen. Verwenden Sie unsere standardisierte Checkliste als Leitfaden und notieren Sie Abweichungen oder Problembereiche.",story:"Eine sanfte Melancholie lag auf ihrem Herzen, gewebt aus Erinnerungen an eine Zeit, als Lachen durch diese Wiesen hallte. Sie strich ber die zarten Bltenbltter eines vergessenen Gnseblmchens.",ads:"Wir prsentieren das brandneue iPhone, das den Standard fr neu definierte Innovation setzt. Mit elegantem Design und modernsten Funktionen definiert dieses iPhone den Gipfel der Technologie neu.",news:"In den internationalen Nachrichten hat die erfolgreiche Mission der NASA, einen Rover zum Mars zu schicken, weltweite Aufmerksamkeit erregt. Der Rover namens Perseverance landete diese Woche auf der Marsoberflche.",promotional:"Meine Damen, es ist Zeit fr etwas Selbstverwhnung! Gnnen Sie sich einen Moment der Glckseligkeit mit unserem exklusiven Winter-Spa-Paket.",vlog:"Hallo, ihr Lieben! Willkommen zurck auf meinem Kanal. Heute werden wir ber die neuesten Make-up-Must-haves sprechen.",business:"Winnebago Industries ist ein Unternehmen, das Wohnmobile, Reiseanhnger und andere Freizeitfahrzeuge herstellt. Das Brsenkrzel lautet WGO und wird an der New Yorker Brse gehandelt.",standup:"Oh je, jetzt geht's los. Wissen Sie, ich kam zu dieser Improv-Show und dachte: 'Hey, das knnte lustig werden.' Die berraschung war, dass ich hier Stand-up fr Sie machen muss.",enthusiastic:"Oh mein Gott, das sind ja fantastische Neuigkeiten! Herzlichen Glckwunsch! Wie fhlen Sie sich dabei? Aufgeregt, nervs oder beides?",casual:"Oh nein, das wollte ich nicht! Wie wre es damit: Wenn Sie etwas Skurriles mit viel Lachen wollen, nehmen Sie die Blue Man Group. Fr etwas Magisches ist Cirque du Soleil die beste Wahl.",hesitant:"Also, h, ich habe gedachtnein, ich meine, ich habe mich gefragt, ob, hm, ob Sie vielleicht Freitag in das, h, neue italienische Restaurant gehen mchten?",callcenter:"Vielen Dank fr Ihren Anruf beim Kundendienst. Mein Name ist Anna, und ich helfe Ihnen gerne weiter. Ich verstehe, dass Sie ein Problem mit Ihrem Konto haben. Lassen Sie mich Ihre Informationen abrufen und schauen, wie ich Ihnen umgehend helfen kann.",explainer:"Lassen Sie mich erklren, wie Photosynthese funktioniert. Pflanzen nutzen Sonnenlicht, Wasser und Kohlendioxid, um Energie zu erzeugen. Der Prozess findet in den Chloroplasten statt, die Chlorophyll enthalten  das grne Pigment, das Pflanzen ihre Farbe verleiht. Wenn Sonnenlicht auf die Bltter trifft, lst es eine chemische Reaktion aus, die diese Bestandteile in Glukose und Sauerstoff umwandelt."},"en-GB":{podcast:"Welcome to our programme exploring the fascinating world of marine biology. From the depths of the ocean to coastal waters, we'll discover the wonders of underwater life and the remarkable creatures that inhabit these environments.",education:"Welcome to today's online maths lesson! In this session, we'll explore the fascinating world of algebra. We'll begin with the fundamentals, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardised checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed upon her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, lovely people! Welcome back to my channel. Today, we're going to share all the details on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh blimey, here we go. You know, I walked into this improv show, and I thought, 'Right, this could be fun. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you lot.",enthusiastic:"Oh my goodness, that's brilliant news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a mix of both? Tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, um, I was thinkingno, I mean, I was wondering if, er, if you might want to go to the, um, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite.",callcenter:"Thank you for calling customer support. My name is Emily, and I'll be pleased to assist you today. I understand you're experiencing an issue with your account. Let me pull up your information and see how I can help resolve this for you straight away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"en-AU":{podcast:"G'day and welcome to our show about the amazing world of marine biology. From the deep blue ocean to our beautiful coastlines, we'll explore the incredible underwater world and the fascinating creatures that call it home.",education:"Welcome to today's online maths lesson! In this session, we'll dive into the fascinating world of algebra. We'll start with the basics, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardised checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed on her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, beautiful people! Welcome back to my channel. Today, we're going to spill all the tea on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh crikey, here we go. You know, I rocked up to this improv show, and I thought, 'Yeah, this could be a laugh. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you mob.",enthusiastic:"Oh my gosh, that's bloody amazing news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a bit of both? Tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with heaps of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, um, I was thinkingno, I mean, I was wondering if, er, if you might want to go to the, um, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite.",callcenter:"Thanks for calling customer support. My name is Jessica, and I'll be happy to help you out today. I understand you're having an issue with your account. Let me pull up your details and see how I can sort this out for you right away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"en-CA":{podcast:"Welcome to our podcast about the wonderful world of marine biology. From the depths of the ocean to our coastal waters, we'll explore the amazing underwater ecosystems and the remarkable creatures that inhabit them.",education:"Welcome to today's online math lesson! In this session, we'll delve into the fascinating world of algebra. We'll start by exploring the basics, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, take clear and comprehensive notes. Use our standardized checklist as a guide, noting any deviations or areas of concern. If possible, take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed on her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hey, beautiful people! Welcome back to my channel. Today, we're about to share all the details on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to up your glam game, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh boy, here we go. You know, eh, I walked into this improv show, and I thought, 'Hey, this could be fun. Maybe they'll have a surprise for me.' Well, guess what? The surprise was that I got roped into doing standup for you folks.",enthusiastic:"Oh my gosh, that's amazing news! Congratulations! How are you feeling about it all? Any excitement, nerves, or a mix of both? Tell me everything, eh!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughs, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil is your best bet.",hesitant:"So, uh, I was thinkingno, I mean, I was wondering if, um, if you might want to go to the, uh, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordoh, exquisite, eh?",callcenter:"Thank you for calling customer support. My name is Laura, and I'll be happy to assist you today. I understand you're experiencing an issue with your account. Let me pull up your information and see how I can help resolve this for you right away.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"en-IN":{podcast:"Welcome to our programme on marine biology. We will explore the fascinating world beneath the oceans, from the deepest waters to coastal regions, and learn about the wonderful creatures that inhabit these environments.",education:"Welcome to today's online mathematics lesson! In this session, we shall delve into the fascinating world of algebra. We will begin with the fundamentals, from solving simple equations like 2x plus 5 equals 11, to understanding variables and coefficients.",instructions:"As you complete the inspection, kindly take clear and comprehensive notes. Use our standardised checklist as a guide, noting any deviations or areas of concern. If possible, please take photographs to visually document any hazards or non-compliance issues.",story:"A gentle melancholy weighed upon her heart, woven from memories of a time when laughter echoed through these very meadows. She traced the delicate petals of a forgotten daisy, lost in thought until a soft voice broke the silence.",ads:"Introducing the all-new iPhone, setting the standard for Innovation Redefined. Boasting a sleek design and cutting-edge features, this iPhone redefines the pinnacle of technology.",news:"Turning to international news, NASA's recent successful mission to send a rover to explore Mars has captured the world's attention. The rover, named Perseverance, touched down on the Martian surface earlier this week.",promotional:"Ladies, it's time for some self-pampering! Treat yourself to a moment of bliss with our exclusive Winter Spa Package. Indulge in a rejuvenating spa day like never before, and let your worries melt away.",vlog:"Hello, beautiful people! Welcome back to my channel. Today, we are going to share all the details on the latest makeup must-haves. Whether you're a makeup enthusiast or just looking to enhance your beauty routine, you're in the right place.",business:"Winnebago Industries is a company that manufactures motor homes, travel trailers, and other recreational vehicles. Its stock ticker symbol is WGO and it is traded on the New York Stock Exchange.",standup:"Oh my, here we go. You know, I walked into this improv show, and I thought, 'This could be interesting. Perhaps they'll have a surprise for me.' Well, what happened? The surprise was that I got roped into doing standup for you all.",enthusiastic:"Oh my goodness, that's wonderful news! Congratulations! How are you feeling about it all? Any excitement, nervousness, or perhaps a combination of both? Please tell me everything!",casual:"Oh no, I didn't mean to disappoint! How about this: If you want something quirky and fun with lots of laughter, go for Blue Man Group. If you're looking for something awe-inspiring and magical, Cirque du Soleil would be your best option.",hesitant:"So, um, I was thinkingno, I mean, I was wondering if, er, if you might want to go to the, um, the new Italian restaurant on Friday? I've heard it's reallywhat's the wordah yes, exquisite.",callcenter:"Thank you for calling customer support. My name is Priya, and I shall be pleased to assist you today. I understand you are experiencing an issue with your account. Kindly allow me to access your information and see how I can help resolve this matter for you immediately.",explainer:"Let me explain how photosynthesis works. Plants use sunlight, water, and carbon dioxide to create energy. The process happens in the chloroplasts, which contain chlorophyll - the green pigment that gives plants their colour. When sunlight hits the leaves, it triggers a chemical reaction that converts these ingredients into glucose and oxygen."},"hi-IN":{podcast:"                ,                 ",education:"        !   ,              ,  2x  5  11      ,     ",instructions:"   ,               ,             ,      -           ",story:"       ,                              ,    ,          ",ads:"  iPhone  ,                     ,  iPhone         ",news:"     ,                                    ",promotional:",          !                                  ",vlog:",  !       ,                             ,     ",business:"Winnebago Industries      ,               WGO           ",standup:" ,       ,       ,   , ',             ' ,   ?                 ",enthusiastic:" ,    !  !           ?  , ,    ?    !",casual:" ,      !   :             ,                ,  Cirque du Soleil     ",hesitant:", ,    ,   ,     , ,    , ,       ?         ,  ",callcenter:"            ,                                     ",explainer:"                 ,              ,     -                 ,                   "},"es-ES":{podcast:"Bienvenidos a nuestro programa sobre el fascinante mundo de la biologa marina. Desde las profundidades del ocano hasta las costas, exploraremos las maravillas del mundo submarino y las criaturas asombrosas que lo habitan.",education:"Bienvenidos a la clase de matemticas en lnea de hoy! En esta sesin, nos adentraremos en el fascinante mundo del lgebra. Empezaremos explorando los fundamentos, desde resolver ecuaciones simples como 2x ms 5 igual a 11, hasta comprender variables y coeficientes.",instructions:"Al completar la inspeccin, tome notas claras y completas. Utilice nuestra lista de verificacin estandarizada como gua, anotando cualquier desviacin o rea de preocupacin. Si es posible, tome fotografas para documentar visualmente cualquier peligro o problema de incumplimiento.",story:"Una suave melancola pesaba sobre su corazn, tejida de recuerdos de un tiempo cuando las risas resonaban por estos mismos prados. Acarici los delicados ptalos de una margarita olvidada, perdida en sus pensamientos hasta que una voz suave rompi el silencio.",ads:"Presentamos el nuevo iPhone, que establece el estndar de Innovacin Redefinida. Con un diseo elegante y funciones de vanguardia, este iPhone redefine la cspide de la tecnologa.",news:"En las noticias internacionales, la reciente misin exitosa de la NASA para enviar un rover a explorar Marte ha captado la atencin del mundo. El rover, llamado Perseverance, aterriz en la superficie marciana a principios de esta semana.",promotional:"Seoras, es hora de mimarse! Reglese un momento de felicidad con nuestro exclusivo Paquete de Spa de Invierno. Disfrute de un da de spa rejuvenecedor como nunca antes y deje que sus preocupaciones se derritan.",vlog:"Hola, gente hermosa! Bienvenidos de nuevo a mi canal. Hoy, vamos a compartir todos los detalles sobre los ltimos imprescindibles de maquillaje. Ya sea que seas un entusiasta del maquillaje o simplemente quieras mejorar tu juego de glamour, ests en el lugar correcto.",business:"Winnebago Industries es una empresa que fabrica autocaravanas, remolques de viaje y otros vehculos recreativos. Su smbolo de cotizacin burstil es WGO y se cotiza en la Bolsa de Nueva York.",standup:"Oh vaya, aqu vamos. Sabis, entr en este espectculo de improvisacin y pens: 'Oye, esto podra ser divertido. Quizs tengan una sorpresa para m.' Pues, adivinis qu? La sorpresa fue que me obligaron a hacer monlogos para vosotros.",enthusiastic:"Oh Dios mo, esas son noticias increbles! Enhorabuena! Cmo te sientes al respecto? Emocionado, nervioso, o una mezcla de ambos? Cuntamelo todo!",casual:"Oh no, no quise decepcionarte! Qu te parece esto? Si quieres algo peculiar y divertido con muchas risas, ve a ver Blue Man Group. Si buscas algo impresionante y mgico, Cirque du Soleil es tu mejor opcin.",hesitant:"Entonces, eh, estaba pensandono, quiero decir, me preguntaba si, um, si tal vez quisieras ir al, eh, el nuevo restaurante italiano el viernes. He odo que es realmentecul es la palabra?oh, exquisito.",callcenter:"Gracias por llamar al servicio de atencin al cliente. Mi nombre es Carmen, y estar encantada de ayudarle hoy. Entiendo que est experimentando un problema con su cuenta. Permtame consultar su informacin y ver cmo puedo resolver esto para usted de inmediato.",explainer:"Permtanme explicar cmo funciona la fotosntesis. Las plantas utilizan la luz solar, el agua y el dixido de carbono para crear energa. El proceso ocurre en los cloroplastos, que contienen clorofila, el pigmento verde que da a las plantas su color. Cuando la luz solar llega a las hojas, desencadena una reaccin qumica que convierte estos ingredientes en glucosa y oxgeno."},"es-MX":{podcast:"Bienvenidos a nuestro podcast sobre el fascinante mundo de la biologa marina. Desde las profundidades del mar hasta nuestras costas, exploraremos las maravillas del mundo submarino y las criaturas asombrosas que lo habitan.",education:"Bienvenidos a la clase de matemticas en lnea de hoy! En esta sesin, nos adentraremos en el fascinante mundo del lgebra. Comenzaremos explorando los fundamentos, desde resolver ecuaciones simples como 2x ms 5 igual a 11, hasta comprender variables y coeficientes.",instructions:"Al completar la inspeccin, tome notas claras y completas. Utilice nuestra lista de verificacin estandarizada como gua, anotando cualquier desviacin o rea de preocupacin. Si es posible, tome fotografas para documentar visualmente cualquier peligro o problema de incumplimiento.",story:"Una suave melancola pesaba sobre su corazn, tejida de recuerdos de un tiempo cuando las risas resonaban por estos mismos prados. Acarici los delicados ptalos de una margarita olvidada, perdida en sus pensamientos hasta que una voz suave rompi el silencio.",ads:"Presentamos el nuevo iPhone, que establece el estndar de Innovacin Redefinida. Con un diseo elegante y funciones de vanguardia, este iPhone redefine la cspide de la tecnologa.",news:"En las noticias internacionales, la reciente misin exitosa de la NASA para enviar un rover a explorar Marte ha captado la atencin del mundo. El rover, llamado Perseverance, aterriz en la superficie marciana a principios de esta semana.",promotional:"Seoras, es hora de consentirse! Reglense un momento de felicidad con nuestro exclusivo Paquete de Spa de Invierno. Disfruten de un da de spa rejuvenecedor como nunca antes y dejen que sus preocupaciones se derritan.",vlog:"Hola, gente linda! Bienvenidos de nuevo a mi canal. Hoy, vamos a compartir todos los detalles sobre los ltimos imprescindibles de maquillaje. Ya sea que sean entusiastas del maquillaje o simplemente quieran mejorar su juego de glamour, estn en el lugar correcto.",business:"Winnebago Industries es una compaa que fabrica casas rodantes, trileres de viaje y otros vehculos recreativos. Su smbolo de cotizacin burstil es WGO y se cotiza en la Bolsa de Nueva York.",standup:"Ay gey, aqu vamos. Saben, entr a este show de improvisacin y pens: 'rale, esto podra ser divertido. A lo mejor tienen una sorpresa para m.' Pues, adivinen qu? La sorpresa fue que me obligaron a hacer stand-up para ustedes.",enthusiastic:"Ay, qu padre! Esas son noticias increbles! Felicidades! Cmo te sientes al respecto? Emocionado, nervioso, o una mezcla de ambos? Cuntamelo todo!",casual:"Ay no, no quise decepcionarte! Qu te parece esto? Si quieres algo peculiar y divertido con muchas risas, ve a ver Blue Man Group. Si buscas algo impresionante y mgico, Cirque du Soleil es tu mejor opcin.",hesitant:"Entonces, eh, estaba pensandono, o sea, me preguntaba si, este, si tal vez quisieras ir al, eh, el nuevo restaurante italiano el viernes. He odo que es realmentecul es la palabra?ah s, exquisito.",callcenter:"Gracias por llamar a servicio al cliente. Mi nombre es Mara, y con gusto le atender el da de hoy. Entiendo que est teniendo un problema con su cuenta. Permtame consultar su informacin y ver cmo puedo ayudarle a resolver esto de inmediato.",explainer:"Permtanme explicar cmo funciona la fotosntesis. Las plantas utilizan la luz solar, el agua y el dixido de carbono para crear energa. El proceso ocurre en los cloroplastos, que contienen clorofila, el pigmento verde que da a las plantas su color. Cuando la luz solar llega a las hojas, desencadena una reaccin qumica que convierte estos ingredientes en glucosa y oxgeno."},"ja-JP":{podcast:"",education:"2x + 5 = 11",instructions:"",story:"",ads:"iPhoneiPhone",news:"NASA",promotional:"",vlog:"",business:"Winnebago IndustriesWGO",standup:"",enthusiastic:"",casual:"",hesitant:"",callcenter:"",explainer:""},"fr-FR":{podcast:"Bienvenue dans notre mission sur le monde fascinant de la biologie marine. Des profondeurs ocaniques aux ctes, nous explorerons les merveilles du monde sous-marin et les cratures extraordinaires qui l'habitent.",education:"Bienvenue au cours de mathmatiques en ligne d'aujourd'hui ! Dans cette session, nous plongerons dans le monde fascinant de l'algbre. Nous commencerons par explorer les bases, de la rsolution d'quations simples comme 2x plus 5 gale 11,  la comprhension des variables et des coefficients.",instructions:"En effectuant l'inspection, prenez des notes claires et compltes. Utilisez notre liste de contrle standardise comme guide, en notant tout cart ou domaine proccupant. Si possible, prenez des photographies pour documenter visuellement tout danger ou problme de non-conformit.",story:"Une douce mlancolie pesait sur son cur, tisse de souvenirs d'un temps o le rire rsonnait dans ces mmes prairies. Elle caressa les ptales dlicats d'une marguerite oublie, perdue dans ses penses jusqu' ce qu'une voix douce rompe le silence.",ads:"Prsentation du tout nouvel iPhone, tablissant la norme de l'Innovation Redfinie. Arborant un design lgant et des fonctionnalits de pointe, cet iPhone redfinit le summum de la technologie.",news:"En tournant vers les nouvelles internationales, la rcente mission russie de la NASA pour envoyer un rover explorer Mars a capt l'attention du monde. Le rover, nomm Perseverance, s'est pos sur la surface martienne plus tt cette semaine.",promotional:"Mesdames, il est temps de vous faire plaisir ! Offrez-vous un moment de bonheur avec notre forfait spa d'hiver exclusif. Profitez d'une journe spa rajeunissante comme jamais auparavant et laissez vos soucis s'envoler.",vlog:"Salut, les gens magnifiques ! Bienvenue sur ma chane. Aujourd'hui, nous allons partager tous les dtails sur les derniers incontournables du maquillage. Que vous soyez passionn de maquillage ou que vous cherchiez simplement  amliorer votre jeu glamour, vous tes au bon endroit.",business:"Winnebago Industries est une entreprise qui fabrique des camping-cars, des caravanes et d'autres vhicules rcratifs. Son symbole boursier est WGO et elle est cote  la Bourse de New York.",standup:"Oh l l, c'est parti. Vous savez, je suis entr dans ce spectacle d'improvisation, et je me suis dit : 'H, a pourrait tre amusant. Peut-tre qu'ils auront une surprise pour moi.' Eh bien, devinez quoi ? La surprise, c'est qu'on m'a oblig  faire du stand-up pour vous.",enthusiastic:"Oh mon Dieu, c'est une nouvelle incroyable ! Flicitations ! Comment vous sentez-vous  ce sujet ? Excit, nerveux, ou un mlange des deux ? Racontez-moi tout !",casual:"Oh non, je ne voulais pas vous dcevoir ! Que diriez-vous de ceci : Si vous voulez quelque chose d'original et amusant avec beaucoup de rires, optez pour Blue Man Group. Si vous cherchez quelque chose d'impressionnant et magique, Cirque du Soleil est votre meilleur choix.",hesitant:"Alors, euh, je pensaisnon, je veux dire, je me demandais si, euh, si vous aimeriez aller au, euh, nouveau restaurant italien vendredi ? J'ai entendu dire que c'est vraimentquel est le motoh, exquis.",callcenter:"Merci d'avoir appel le service client. Je m'appelle Sophie, et je serai ravie de vous aider aujourd'hui. Je comprends que vous rencontrez un problme avec votre compte. Permettez-moi de consulter vos informations et voir comment je peux rsoudre cela pour vous immdiatement.",explainer:"Permettez-moi d'expliquer comment fonctionne la photosynthse. Les plantes utilisent la lumire du soleil, l'eau et le dioxyde de carbone pour crer de l'nergie. Le processus se droule dans les chloroplastes, qui contiennent de la chlorophylle - le pigment vert qui donne leur couleur aux plantes. Lorsque la lumire du soleil frappe les feuilles, elle dclenche une raction chimique qui convertit ces ingrdients en glucose et en oxygne."},"fr-CA":{podcast:"Bienvenue  notre mission sur le merveilleux monde de la biologie marine. Des profondeurs de l'ocan jusqu'aux ctes, nous explorerons les merveilles du monde sous-marin et les cratures remarquables qui l'habitent.",education:"Bienvenue au cours de mathmatiques en ligne d'aujourd'hui ! Dans cette session, nous plongerons dans le monde fascinant de l'algbre. Nous commencerons par explorer les bases, de la rsolution d'quations simples comme 2x plus 5 gale 11,  la comprhension des variables et des coefficients.",instructions:"En effectuant l'inspection, prenez des notes claires et compltes. Utilisez notre liste de contrle standardise comme guide, en notant tout cart ou domaine proccupant. Si possible, prenez des photos pour documenter visuellement tout danger ou problme de non-conformit.",story:"Une douce mlancolie pesait sur son cur, tisse de souvenirs d'un temps o le rire rsonnait dans ces mmes prairies. Elle caressa les ptales dlicats d'une marguerite oublie, perdue dans ses penses jusqu' ce qu'une voix douce rompe le silence.",ads:"Prsentation du tout nouvel iPhone, tablissant la norme de l'Innovation Redfinie. Arborant un design lgant et des fonctionnalits de pointe, cet iPhone redfinit le summum de la technologie.",news:"En tournant vers les nouvelles internationales, la rcente mission russie de la NASA pour envoyer un rover explorer Mars a capt l'attention du monde. Le rover, nomm Perseverance, s'est pos sur la surface martienne plus tt cette semaine.",promotional:"Mesdames, c'est le temps de vous gter ! Offrez-vous un moment de bonheur avec notre forfait spa d'hiver exclusif. Profitez d'une journe spa rajeunissante comme jamais auparavant et laissez vos soucis s'envoler.",vlog:"Salut, les gens magnifiques ! Bienvenue sur ma chane. Aujourd'hui, on va partager tous les dtails sur les derniers incontournables du maquillage. Que vous soyez passionn de maquillage ou que vous cherchiez simplement  amliorer votre jeu glamour, vous tes  la bonne place.",business:"Winnebago Industries est une entreprise qui fabrique des vhicules rcratifs, des roulottes et d'autres vhicules de loisir. Son symbole boursier est WGO et elle est cote  la Bourse de New York.",standup:"Oh l l, a commence. Vous savez, je suis entr dans ce spectacle d'improvisation, pis je me suis dit : 'H, a pourrait tre le fun. Peut-tre qu'ils auront une surprise pour moi.' Ben, devinez quoi ? La surprise, c'est qu'on m'a oblig  faire du stand-up pour vous autres.",enthusiastic:"Oh mon Dieu, c'est une nouvelle incroyable ! Flicitations ! Comment tu te sens par rapport  a ? Excit, nerveux, ou un mlange des deux ? Raconte-moi tout !",casual:"Oh non, je voulais pas te dcevoir ! Que dirais-tu de a : Si tu veux quelque chose d'original pis amusant avec ben des rires, va voir Blue Man Group. Si tu cherches quelque chose d'impressionnant pis magique, Cirque du Soleil est ton meilleur choix.",hesitant:"Alors, euh, je pensaisnon, je veux dire, je me demandais si, euh, si tu aimerais aller au, euh, nouveau restaurant italien vendredi ? J'ai entendu dire que c'est vraimentquel est le motoh, exquis.",callcenter:"Merci d'avoir appel le service  la clientle. Je m'appelle Isabelle, et je serai heureuse de vous aider aujourd'hui. Je comprends que vous prouvez un problme avec votre compte. Permettez-moi de consulter vos informations et voir comment je peux rgler a pour vous tout de suite.",explainer:"Permettez-moi d'expliquer comment fonctionne la photosynthse. Les plantes utilisent la lumire du soleil, l'eau et le dioxyde de carbone pour crer de l'nergie. Le processus se droule dans les chloroplastes, qui contiennent de la chlorophylle - le pigment vert qui donne leur couleur aux plantes. Lorsque la lumire du soleil frappe les feuilles, elle dclenche une raction chimique qui convertit ces ingrdients en glucose et en oxygne."},"pt-BR":{podcast:"Bem-vindos ao nosso podcast sobre o fascinante mundo da biologia marinha. Das profundezas do oceano at as costas, vamos explorar as maravilhas do mundo submarino e as criaturas incrveis que o habitam.",education:"Bem-vindos  aula de matemtica online de hoje! Nesta sesso, vamos mergulhar no fascinante mundo da lgebra. Comearemos explorando os fundamentos, desde resolver equaes simples como 2x mais 5 igual a 11, at entender variveis e coeficientes.",instructions:"Ao completar a inspeo, faa anotaes claras e abrangentes. Use nossa lista de verificao padronizada como guia, anotando quaisquer desvios ou reas de preocupao. Se possvel, tire fotografias para documentar visualmente quaisquer perigos ou problemas de no conformidade.",story:"Uma melancolia suave pesava em seu corao, tecida de memrias de um tempo quando risadas ecoavam por estes mesmos prados. Ela acariciou as delicadas ptalas de uma margarida esquecida, perdida em pensamentos at que uma voz suave quebrou o silncio.",ads:"Apresentando o novssimo iPhone, estabelecendo o padro para Inovao Redefinida. Com um design elegante e recursos de ponta, este iPhone redefine o pice da tecnologia.",news:"Nas notcias internacionais, a recente misso bem-sucedida da NASA para enviar um rover para explorar Marte capturou a ateno do mundo. O rover, chamado Perseverance, pousou na superfcie marciana no incio desta semana.",promotional:"Senhoras,  hora de se mimarem! Presenteiem-se com um momento de felicidade com nosso exclusivo Pacote de Spa de Inverno. Deliciem-se com um dia de spa rejuvenescedor como nunca antes e deixem suas preocupaes derreterem.",vlog:"E a, gente linda! Bem-vindos de volta ao meu canal. Hoje, vamos compartilhar todos os detalhes sobre os ltimos itens indispensveis de maquiagem. Seja voc um entusiasta de maquiagem ou apenas procurando melhorar seu jogo de glamour, voc est no lugar certo.",business:"Winnebago Industries  uma empresa que fabrica trailers, reboques de viagem e outros veculos recreativos. Seu smbolo de aes  WGO e  negociado na Bolsa de Valores de Nova York.",standup:"Ah cara, l vamos ns. Sabe, eu entrei nesse show de improviso e pensei: 'Ei, isso pode ser divertido. Talvez eles tenham uma surpresa para mim.' Bem, adivinha o qu? A surpresa foi que me obrigaram a fazer stand-up para vocs.",enthusiastic:"Meu Deus, essa  uma notcia incrvel! Parabns! Como voc est se sentindo sobre isso tudo? Empolgado, nervoso, ou uma mistura dos dois? Me conta tudo!",casual:"Ah no, no quis decepcionar! Que tal isso: Se voc quer algo peculiar e divertido com muitas risadas, v de Blue Man Group. Se voc est procurando algo impressionante e mgico, Cirque du Soleil  sua melhor aposta.",hesitant:"Ento, , eu estava pensandono, quero dizer, eu estava me perguntando se, hum, se voc talvez quisesse ir ao, , o novo restaurante italiano na sexta-feira? Eu ouvi que  realmentequal  a palavraah, requintado.",callcenter:"Obrigada por ligar para o suporte ao cliente. Meu nome  Juliana, e terei o prazer de ajud-lo hoje. Entendo que voc est enfrentando um problema com sua conta. Deixe-me consultar suas informaes e ver como posso resolver isso para voc imediatamente.",explainer:"Deixe-me explicar como funciona a fotossntese. As plantas usam luz solar, gua e dixido de carbono para criar energia. O processo acontece nos cloroplastos, que contm clorofila - o pigmento verde que d s plantas sua cor. Quando a luz solar atinge as folhas, ela desencadeia uma reao qumica que converte esses ingredientes em glicose e oxignio."},"pt-PT":{podcast:"Bem-vindos ao nosso programa sobre o fascinante mundo da biologia marinha. Desde as profundezas do oceano at s costas, iremos explorar as maravilhas do mundo submarino e as criaturas extraordinrias que o habitam.",education:"Bem-vindos  aula de matemtica online de hoje! Nesta sesso, vamos mergulhar no fascinante mundo da lgebra. Comearemos por explorar os fundamentos, desde resolver equaes simples como 2x mais 5 igual a 11, at compreender variveis e coeficientes.",instructions:"Ao completar a inspeo, faa anotaes claras e abrangentes. Use a nossa lista de verificao padronizada como guia, anotando quaisquer desvios ou reas de preocupao. Se possvel, tire fotografias para documentar visualmente quaisquer perigos ou problemas de no conformidade.",story:"Uma melancolia suave pesava no seu corao, tecida de memrias de um tempo quando risadas ecoavam por estes mesmos prados. Ela acariciou as delicadas ptalas de uma margarida esquecida, perdida em pensamentos at que uma voz suave quebrou o silncio.",ads:"Apresentamos o novssimo iPhone, estabelecendo o padro para Inovao Redefinida. Com um design elegante e funcionalidades de ponta, este iPhone redefine o auge da tecnologia.",news:"Nas notcias internacionais, a recente misso bem-sucedida da NASA para enviar um rover para explorar Marte capturou a ateno do mundo. O rover, chamado Perseverance, aterrou na superfcie marciana no incio desta semana.",promotional:"Senhoras,  hora de se mimarem! Presenteiem-se com um momento de felicidade com o nosso exclusivo Pacote de Spa de Inverno. Deliciem-se com um dia de spa rejuvenescedor como nunca antes e deixem as vossas preocupaes derreterem.",vlog:"Ol, gente linda! Bem-vindos de volta ao meu canal. Hoje, vamos partilhar todos os detalhes sobre os ltimos indispensveis de maquilhagem. Quer sejam entusiastas de maquilhagem ou apenas procurem melhorar o vosso jogo de glamour, esto no stio certo.",business:"Winnebago Industries  uma empresa que fabrica autocaravanas, reboques de viagem e outros veculos recreativos. O seu smbolo de cotao  WGO e  negociado na Bolsa de Valores de Nova Iorque.",standup:"Oh cus, c vamos ns. Sabem, entrei neste espetculo de improviso e pensei: 'Eh p, isto pode ser divertido. Talvez tenham uma surpresa para mim.' Bem, adivinhem? A surpresa foi que me obrigaram a fazer stand-up para vocs.",enthusiastic:"Meu Deus, essa  uma notcia fantstica! Parabns! Como se est a sentir em relao a isto tudo? Entusiasmado, nervoso, ou uma mistura dos dois? Conta-me tudo!",casual:"Oh no, no quis desiludir! Que tal isto: Se querem algo peculiar e divertido com muitas risadas, vo ao Blue Man Group. Se procuram algo impressionante e mgico, o Cirque du Soleil  a vossa melhor aposta.",hesitant:"Ento, , eu estava a pensarno, quer dizer, estava a perguntar-me se, hum, se talvez quisesses ir ao, , o novo restaurante italiano na sexta-feira? Ouvi dizer que  realmentequal  a palavraah, requintado.",callcenter:"Obrigada por contactar o apoio ao cliente. O meu nome  Sofia, e terei todo o gosto em ajud-lo hoje. Compreendo que est a ter um problema com a sua conta. Permita-me consultar as suas informaes e ver como posso resolver isto para si de imediato.",explainer:"Permitam-me explicar como funciona a fotossntese. As plantas usam luz solar, gua e dixido de carbono para criar energia. O processo acontece nos cloroplastos, que contm clorofila - o pigmento verde que d s plantas a sua cor. Quando a luz solar atinge as folhas, desencadeia uma reao qumica que converte estes ingredientes em glucose e oxignio."},"it-IT":{podcast:"Benvenuti al nostro programma sul affascinante mondo della biologia marina. Dalle profondit dell'oceano alle coste, esploreremo le meraviglie del mondo sottomarino e le creature straordinarie che lo abitano.",education:"Benvenuti alla lezione di matematica online di oggi! In questa sessione, ci immergeremo nel affascinante mondo dell'algebra. Inizieremo esplorando i fondamenti, dalla risoluzione di equazioni semplici come 2x pi 5 uguale 11, alla comprensione di variabili e coefficienti.",instructions:"Mentre completi l'ispezione, prendi note chiare e complete. Usa la nostra lista di controllo standardizzata come guida, annotando eventuali deviazioni o aree di preoccupazione. Se possibile, scatta fotografie per documentare visivamente eventuali pericoli o problemi di non conformit.",story:"Una dolce malinconia pesava sul suo cuore, tessuta da ricordi di un tempo quando le risate risuonavano in questi stessi prati. Accarezz i delicati petali di una margherita dimenticata, persa nei pensieri finch una voce dolce ruppe il silenzio.",ads:"Vi presentiamo il nuovissimo iPhone, che stabilisce lo standard per l'Innovazione Ridefinita. Con un design elegante e funzionalit all'avanguardia, questo iPhone ridefinisce l'apice della tecnologia.",news:"Passando alle notizie internazionali, la recente missione di successo della NASA per inviare un rover ad esplorare Marte ha catturato l'attenzione del mondo. Il rover, chiamato Perseverance,  atterrato sulla superficie marziana all'inizio di questa settimana.",promotional:"Signore,  ora di coccolarsi! Regalatevi un momento di felicit con il nostro esclusivo Pacchetto Spa Invernale. Concedetevi una giornata termale rigenerante come mai prima d'ora e lasciate che le vostre preoccupazioni si sciolgano.",vlog:"Ciao, belle persone! Bentornati sul mio canale. Oggi condivideremo tutti i dettagli sugli ultimi must-have del trucco. Che siate appassionati di trucco o semplicemente vogliate migliorare il vostro gioco glamour, siete nel posto giusto.",business:"Winnebago Industries  un'azienda che produce camper, roulotte e altri veicoli ricr eativi. Il suo simbolo azionario  WGO ed  quotata alla Borsa di New York.",standup:"Oh cavolo, eccoci qui. Sapete, sono entrato in questo spettacolo di improvvisazione e ho pensato: 'Ehi, questo potrebbe essere divertente. Forse avranno una sorpresa per me.' Beh, indovinate un po'? La sorpresa  stata che mi hanno costretto a fare stand-up per voi.",enthusiastic:"Oh mio Dio, questa  una notizia fantastica! Congratulazioni! Come ti senti riguardo a tutto questo? Eccitato, nervoso, o un mix di entrambi? Dimmi tutto!",casual:"Oh no, non volevo deluderti! Che ne dici di questo: Se vuoi qualcosa di stravagante e divertente con tante risate, scegli Blue Man Group. Se cerchi qualcosa di impressionante e magico, Cirque du Soleil  la tua scelta migliore.",hesitant:"Allora, ehm, stavo pensandono, voglio dire, mi chiedevo se, ehm, se forse vorresti andare al, ehm, nuovo ristorante italiano venerd? Ho sentito che  davveroqual  la parolaoh, squisito.",callcenter:"Grazie per aver chiamato l'assistenza clienti. Mi chiamo Francesca, e sar lieta di aiutarla oggi. Capisco che sta riscontrando un problema con il suo account. Mi permetta di consultare le sue informazioni e vedere come posso risolvere questo per lei immediatamente.",explainer:"Permettetemi di spiegare come funziona la fotosintesi. Le piante usano la luce solare, l'acqua e l'anidride carbonica per creare energia. Il processo avviene nei cloroplasti, che contengono la clorofilla - il pigmento verde che d alle piante il loro colore. Quando la luce solare colpisce le foglie, innesca una reazione chimica che converte questi ingredienti in glucosio e ossigeno."}};function fF(n){const e=n.match(/^([a-z]{2}-[A-Z]{2})/i);if(e){const t=e[1].split("-");return`${t[0].toLowerCase()}-${t[1].toUpperCase()}`}return"en-US"}function E9(n){if(Aw[n])return Aw[n];if(aD[n]){const e=aD[n];return{podcast:e,education:e,instructions:e,story:e,ads:e,news:e,promotional:e,vlog:e,business:e,standup:e,enthusiastic:e,casual:e,hesitant:e,callcenter:e,explainer:e}}return Aw["en-US"]}function x9({text:n,onTextChange:e,wordBoundaries:t,currentWordIndex:r,selectedVoice:i,state:s,personalVoiceInfo:o,selectedPresetLanguage:a,onPresetLanguageChange:l}){const c=O.useRef(null),u=O.useRef(null),[h,m]=O.useState(!1),v=n.trim()?n.trim().split(/\s+/).length:0,C=n.length,T=fF(i),x=E9(a||T),P=F=>{const z=x[F];z&&(e(z),m(!1))},b=s==="synthesizing"||s==="playing",I=()=>{c.current&&u.current&&(u.current.scrollTop=c.current.scrollTop,u.current.scrollLeft=c.current.scrollLeft)};O.useEffect(()=>{if(r>=0&&r<t.length){const F=t[r];if(c.current&&u.current){const z=c.current,W=document.createElement("div");W.style.cssText=window.getComputedStyle(z).cssText,W.style.position="absolute",W.style.visibility="hidden",W.style.height="auto",W.style.width=`${z.clientWidth-24}px`,W.style.whiteSpace="pre-wrap",W.style.wordWrap="break-word",W.style.font=window.getComputedStyle(z).font,W.style.lineHeight=window.getComputedStyle(z).lineHeight,W.style.padding="0",document.body.appendChild(W);const H=n.substring(0,F.offset);W.textContent=H;const V=W.scrollHeight,K=n.substring(0,F.offset+F.length);W.textContent=K;const ee=W.scrollHeight;document.body.removeChild(W);const G=z.scrollTop,X=z.clientHeight,Y=G+X,ce=50;V<G+ce?z.scrollTop=Math.max(0,V-ce):ee>Y-ce&&(z.scrollTop=ee-X+ce),u.current.scrollTop=z.scrollTop,u.current.scrollLeft=z.scrollLeft}}},[r,t,n]);const M=()=>{if(r<0||r>=t.length)return n;const F=t[r],z=n.substring(0,F.offset),W=n.substring(F.offset,F.offset+F.length),H=n.substring(F.offset+F.length);return g.jsxs(g.Fragment,{children:[z,g.jsx("span",{className:"bg-yellow-300 font-semibold",children:W}),H]})},N=F=>{if(!F.trim())return null;const z=/[\u4e00-\u9fff\u3400-\u4dbf]/g,W=/[\u3040-\u309f\u30a0-\u30ff]/g,H=/[\uac00-\ud7af\u1100-\u11ff]/g,V=/[\u0600-\u06ff]/g,K=/[\u0590-\u05ff]/g,ee=/[\u0400-\u04ff]/g,G=/[\u0e00-\u0e7f]/g,X=(F.match(z)||[]).length,Y=(F.match(W)||[]).length,ce=(F.match(H)||[]).length,ae=(F.match(V)||[]).length,$=(F.match(K)||[]).length,J=(F.match(ee)||[]).length,de=(F.match(G)||[]).length,me=5;return Y>me?"ja-JP":ce>me?"ko-KR":X>me?"zh-CN":ae>me?"ar-SA":$>me?"he-IL":J>me?"ru-RU":de>me?"th-TH":null},j=h?(()=>{const F=N(n),z=a||F||T||"en-US";return o!=null&&o.isPersonalVoice&&(o!=null&&o.speakerProfileId)?Uv(n,o.speakerProfileId,z,o.model||"DragonLatestNeural"):`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="${z}">
  <voice name="${i}">
    ${n}
  </voice>
</speak>`})():n;return g.jsxs("div",{className:"h-full flex flex-col",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Text to Synthesize"}),g.jsxs("div",{className:"flex gap-4 text-sm text-gray-600",children:[g.jsxs("span",{children:[v," word",v!==1?"s":""]}),g.jsxs("span",{children:[C," char",C!==1?"s":""]})]})]}),g.jsxs("div",{className:"mb-3 grid grid-cols-[200px_1fr] gap-3",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preset Language"}),g.jsxs("select",{value:a,onChange:F=>l(F.target.value),disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[g.jsxs("option",{value:"",children:["Voice Language (",T,")"]}),g.jsx("option",{value:"ar-EG",children:"Arabic (Egypt)"}),g.jsx("option",{value:"ar-SA",children:"Arabic (Saudi Arabia)"}),g.jsx("option",{value:"bg-BG",children:"Bulgarian"}),g.jsx("option",{value:"ca-ES",children:"Catalan"}),g.jsx("option",{value:"cs-CZ",children:"Czech"}),g.jsx("option",{value:"cy-GB",children:"Welsh"}),g.jsx("option",{value:"da-DK",children:"Danish"}),g.jsx("option",{value:"de-DE",children:"German"}),g.jsx("option",{value:"el-GR",children:"Greek"}),g.jsx("option",{value:"en-AU",children:"English (Australia)"}),g.jsx("option",{value:"en-CA",children:"English (Canada)"}),g.jsx("option",{value:"en-GB",children:"English (UK)"}),g.jsx("option",{value:"en-IN",children:"English (India)"}),g.jsx("option",{value:"en-US",children:"English (US)"}),g.jsx("option",{value:"es-ES",children:"Spanish (Spain)"}),g.jsx("option",{value:"es-MX",children:"Spanish (Mexico)"}),g.jsx("option",{value:"et-EE",children:"Estonian"}),g.jsx("option",{value:"fi-FI",children:"Finnish"}),g.jsx("option",{value:"fr-CA",children:"French (Canada)"}),g.jsx("option",{value:"fr-FR",children:"French (France)"}),g.jsx("option",{value:"he-IL",children:"Hebrew"}),g.jsx("option",{value:"hi-IN",children:"Hindi"}),g.jsx("option",{value:"hr-HR",children:"Croatian"}),g.jsx("option",{value:"hu-HU",children:"Hungarian"}),g.jsx("option",{value:"id-ID",children:"Indonesian"}),g.jsx("option",{value:"it-IT",children:"Italian"}),g.jsx("option",{value:"ja-JP",children:"Japanese"}),g.jsx("option",{value:"ko-KR",children:"Korean"}),g.jsx("option",{value:"lt-LT",children:"Lithuanian"}),g.jsx("option",{value:"lv-LV",children:"Latvian"}),g.jsx("option",{value:"nb-NO",children:"Norwegian"}),g.jsx("option",{value:"nl-NL",children:"Dutch"}),g.jsx("option",{value:"pl-PL",children:"Polish"}),g.jsx("option",{value:"pt-BR",children:"Portuguese (Brazil)"}),g.jsx("option",{value:"pt-PT",children:"Portuguese (Portugal)"}),g.jsx("option",{value:"ro-RO",children:"Romanian"}),g.jsx("option",{value:"ru-RU",children:"Russian"}),g.jsx("option",{value:"sk-SK",children:"Slovak"}),g.jsx("option",{value:"sl-SI",children:"Slovenian"}),g.jsx("option",{value:"sr-RS",children:"Serbian"}),g.jsx("option",{value:"sv-SE",children:"Swedish"}),g.jsx("option",{value:"th-TH",children:"Thai"}),g.jsx("option",{value:"tr-TR",children:"Turkish"}),g.jsx("option",{value:"uk-UA",children:"Ukrainian"}),g.jsx("option",{value:"vi-VN",children:"Vietnamese"}),g.jsx("option",{value:"zh-CN",children:"Chinese (Mandarin)"}),g.jsx("option",{value:"zh-TW",children:"Chinese (Taiwan)"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Load Preset Text"}),g.jsxs("select",{onChange:F=>P(F.target.value),disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",defaultValue:"",children:[g.jsx("option",{value:"",children:"-- Select a preset --"}),g.jsx("option",{value:"podcast",children:"Podcast"}),g.jsx("option",{value:"education",children:"Education/Learning"}),g.jsx("option",{value:"instructions",children:"Instructions/Guidance"}),g.jsx("option",{value:"story",children:"Story/Narrative"}),g.jsx("option",{value:"ads",children:"Advertisement"}),g.jsx("option",{value:"news",children:"News Report"}),g.jsx("option",{value:"promotional",children:"Promotional/Marketing"}),g.jsx("option",{value:"vlog",children:"Vlog/Social Media"}),g.jsx("option",{value:"business",children:"Business/Professional"}),g.jsx("option",{value:"callcenter",children:"Call Center/Customer Care"}),g.jsx("option",{value:"standup",children:"Stand-up Comedy"}),g.jsx("option",{value:"enthusiastic",children:"Enthusiastic/Excited"}),g.jsx("option",{value:"casual",children:"Casual Conversation"}),g.jsx("option",{value:"hesitant",children:"Hesitant/Uncertain"}),g.jsx("option",{value:"explainer",children:"Explainer Video"})]})]})]}),g.jsxs("div",{className:"flex-1 relative",children:[r>=0&&g.jsx("div",{ref:u,className:"absolute inset-0 px-3 py-2 pointer-events-none overflow-auto whitespace-pre-wrap break-words font-mono text-base leading-6 text-transparent",style:{zIndex:1},children:M()}),g.jsx("textarea",{ref:c,value:j,onChange:F=>!h&&e(F.target.value),onScroll:I,placeholder:"Enter text here to convert to speech...",readOnly:h,className:"w-full h-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none font-mono text-base leading-6",style:{position:"relative",zIndex:2,background:h?"#f9fafb":"transparent"}})]}),g.jsxs("div",{className:"mt-4 flex gap-2",children:[g.jsx("button",{onClick:()=>m(!h),disabled:!n,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Show Plain Text":"Show SSML"}),g.jsx("button",{onClick:()=>e(""),disabled:!n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Clear Text"})]})]})}function mF({state:n,error:e,audioData:t,hasText:r,isConfigured:i,onPlay:s,onPause:o,onResume:a,onStop:l}){const[c,u]=O.useState(!1),h=r&&i&&n==="idle",m=n==="playing",v=n==="paused",C=n==="playing"||n==="paused"||n==="synthesizing",T=()=>{switch(n){case"idle":return"Ready";case"synthesizing":return"Synthesizing...";case"playing":return"Playing";case"paused":return"Paused";case"error":return"Error";default:return"Unknown"}},E=()=>{switch(n){case"idle":return"text-gray-600";case"synthesizing":return"text-blue-600";case"playing":return"text-green-600";case"paused":return"text-yellow-600";case"error":return"text-red-600";default:return"text-gray-600"}};return g.jsxs("div",{className:"space-y-4",children:[g.jsx("div",{className:"flex items-center justify-between",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status:"}),g.jsx("span",{className:`text-sm font-semibold ${E()}`,children:T()}),n==="synthesizing"&&g.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full"})]})}),e&&g.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:[g.jsx("p",{className:"text-sm text-red-700 font-medium",children:"Error:"}),g.jsx("p",{className:"text-xs text-red-600 mt-1",children:e})]}),!i&&g.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:g.jsx("p",{className:"text-sm text-yellow-700",children:"Please configure your API key and region in the settings panel."})}),g.jsxs("div",{className:"flex gap-2 flex-wrap",children:[g.jsx("button",{onClick:s,disabled:!h,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-600",title:r?i?"Play":"Configure settings first":"Enter text first",children:" Play"}),v?g.jsx("button",{onClick:a,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:" Resume"}):g.jsx("button",{onClick:o,disabled:!m,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-yellow-600 rounded-md hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-yellow-600",children:" Pause"}),g.jsx("button",{onClick:l,disabled:!C,className:"flex-1 min-w-[100px] px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-red-600",children:" Stop"}),g.jsx("button",{onClick:()=>u(!c),className:"px-3 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",title:"Help",children:g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})})]}),c&&g.jsxs("div",{className:"text-xs text-gray-500 space-y-1 pt-2 mt-2 border-t border-gray-200",children:[g.jsx("p",{children:" Click Play to start synthesis and playback"}),g.jsx("p",{children:" Word highlighting shows the current word being spoken"}),g.jsx("p",{children:" Save audio from history panel below"})]})]})}function gF({text:n,selectedVoice:e,region:t,audioData:r}){const i=async()=>{try{const s=`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="en-US">
  <voice name="${e}">
    ${n}
  </voice>
</speak>`,o=`
Voice: ${e}
Region: ${t}

SSML:
${s}

Text:
${n}

${r?"Please find the audio file attached (downloaded separately).":"[No audio generated yet]"}
      `.trim(),a=encodeURIComponent(`Azure Voice Playground Feedback - ${e}`),l=encodeURIComponent(o),c=`mailto:ttsvoicefeedback@microsoft.com?subject=${a}&body=${l}`;if(r){const u=new Blob([r],{type:"audio/mpeg"}),h=URL.createObjectURL(u),m=document.createElement("a");m.href=h,m.download=`feedback-${e}-${Date.now()}.mp3`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(h)}navigator.clipboard&&await navigator.clipboard.writeText(s),window.open(c,"_blank"),r&&alert("Audio file downloaded! Please attach it to your email before sending.")}catch(s){console.error("Error sending feedback:",s),alert("Error preparing feedback. Please try again.")}};return g.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200 text-sm font-medium",title:"Send feedback with SSML and audio",children:[g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[g.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),g.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),"Send Feedback"]})}function vF(n,e){const t=new Blob([n],{type:"audio/mpeg"}),r=URL.createObjectURL(t),i=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5),s=e||`tts-output-${i}.mp3`,o=document.createElement("a");o.href=r,o.download=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(()=>URL.revokeObjectURL(r),100)}function tT(n){return new Promise((e,t)=>{const r=n instanceof Blob?n:new Blob([n],{type:"audio/mpeg"}),i=URL.createObjectURL(r),s=new Audio(i);s.addEventListener("loadedmetadata",()=>{e(s.duration),URL.revokeObjectURL(i)}),s.addEventListener("error",()=>{t(new Error("Failed to load audio metadata")),URL.revokeObjectURL(i)})})}function yF(n){const e=Math.floor(n/60),t=Math.floor(n%60);return`${e}:${t.toString().padStart(2,"0")}`}function w9({entry:n,onDelete:e}){const[t,r]=O.useState(!1),i=O.useRef(null),s=O.useRef(null);O.useEffect(()=>{const h=new Blob([n.audioData],{type:"audio/mpeg"}),m=URL.createObjectURL(h);return s.current=m,()=>{s.current&&URL.revokeObjectURL(s.current)}},[n.audioData]);const o=()=>{i.current||(i.current=new Audio(s.current||""),i.current.addEventListener("ended",()=>{r(!1)})),t?(i.current.pause(),r(!1)):(i.current.play(),r(!0))},a=()=>{const h=new Date(n.timestamp).toISOString().replace(/[:.]/g,"-").slice(0,-5),m=n.voice.replace(/[^a-zA-Z0-9-]/g,"_"),v=n.region.replace(/[^a-zA-Z0-9-]/g,"_"),C=n.model?`-${n.model.replace(/[^a-zA-Z0-9-]/g,"_")}`:"",T=`azurevoice-${v}-${m}${C}-${h}.mp3`;vF(n.audioData,T)},l=()=>{e&&(i.current&&(i.current.pause(),i.current=null),e(n.id))},c=n.text.length>100?n.text.substring(0,100)+"...":n.text,u=new Date(n.timestamp).toLocaleTimeString();return g.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border border-gray-200 rounded-md hover:bg-gray-50",children:[g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("p",{className:"text-sm text-gray-800 truncate mb-1",children:c}),g.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 flex-wrap",children:[g.jsx("span",{children:u}),g.jsx("span",{children:""}),g.jsx("span",{className:"truncate max-w-[200px]",children:n.voice}),n.model&&g.jsxs(g.Fragment,{children:[g.jsx("span",{children:""}),g.jsx("span",{className:"text-emerald-600 font-medium",children:n.model})]}),g.jsx("span",{children:""}),g.jsx("span",{children:n.region}),g.jsx("span",{children:""}),g.jsx("span",{children:yF(n.duration)})]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:o,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md transition-colors",title:t?"Pause":"Play",children:t?g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),g.jsx("button",{onClick:a,className:"p-2 text-green-600 hover:bg-green-50 rounded-md transition-colors",title:"Save as MP3",children:g.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:[g.jsx("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),g.jsx("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})]})}),e&&g.jsx("button",{onClick:l,className:"p-2 text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z",clipRule:"evenodd"})})})]})]})}function b9({history:n,onClearHistory:e,onDeleteEntry:t}){const[r,i]=O.useState(!1),s=()=>{i(!r)};return g.jsxs("div",{className:"border-t border-gray-200 bg-gray-50",children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-gray-100",onClick:s,children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Synthesis History"}),n.length>0&&g.jsx("span",{className:"px-2 py-1 text-xs font-medium text-white bg-blue-600 rounded-full",children:n.length})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[n.length>0&&g.jsx("button",{onClick:o=>{o.stopPropagation(),window.confirm("Clear all history?")&&e()},className:"px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors",children:"Clear All"}),g.jsx("button",{className:"p-1 text-gray-600",children:g.jsx("svg",{className:`w-5 h-5 transform transition-transform ${r?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),r&&g.jsx("div",{className:"px-4 pb-4 max-h-60 overflow-y-auto",children:n.length===0?g.jsxs("div",{className:"py-8 text-center text-gray-500",children:[g.jsx("p",{children:"No synthesis history yet"}),g.jsx("p",{className:"text-sm mt-1",children:"Synthesized audio will appear here"})]}):g.jsx("div",{className:"space-y-2",children:[...n].reverse().map(o=>g.jsx(w9,{entry:o,onDelete:t},o.id))})})]})}const Tw={projectId:"personal-voice-playground",voiceTalentName:"",companyName:"Voice Playground",locale:"en-US",voiceName:""},lD=[{code:"en-US",name:"English (US)"},{code:"en-GB",name:"English (UK)"},{code:"zh-CN",name:"Chinese (Simplified)"},{code:"ja-JP",name:"Japanese"},{code:"ko-KR",name:"Korean"},{code:"de-DE",name:"German"},{code:"fr-FR",name:"French"},{code:"es-ES",name:"Spanish (Spain)"},{code:"it-IT",name:"Italian"},{code:"pt-BR",name:"Portuguese (Brazil)"}],SF=[{id:"DragonLatestNeural",name:"Dragon (Latest)",description:"High quality personal voice"},{id:"PhoenixLatestNeural",name:"Phoenix (Latest)",description:"Supports word boundary events"}];function XP(){return O.useMemo(()=>({enableMAIVoices:new URLSearchParams(window.location.search).get("maivoice")==="true"}),[])}function P9({settings:n,onSettingsChange:e,isConfigured:t,history:r,addToHistory:i,removeFromHistory:s,clearHistory:o}){var H,V,K,ee;const{enableMAIVoices:a}=XP();(H=n.selectedVoice)!=null&&H.includes("DragonHD");const l="Welcome to Azure Voice Playground. Select a voice and choose a preset text to get started, or type your own text.",c=`Welcome to Azure Voice Playground. Select a voice and choose a preset text to get started, or type your own text.

[laughter] This is very funny.
[whisper] I just don't know if I can handle this anymore, I confided softly, hoping no one else could hear.
[shouting] Why can't anyone understand what I'm going through?
[angry] It's so frustrating to feel like I'm shouting into a void!
[sad] I just... I feel so alone in this, I finally admitted, my voice breaking as the sadness overwhelmed me.`,[u,h]=O.useState(l),[m,v]=O.useState(""),C=O.useRef(null),T=O.useRef(""),{state:E,error:x,wordBoundaries:P,currentWordIndex:b,audioData:I,synthesize:M,pause:N,resume:D,stop:j}=C9(n);O.useEffect(()=>{const G=n.selectedVoice||"",X=G.includes("DragonHD"),Y=T.current.includes("DragonHD");G!==T.current&&X!==Y&&(u===l||u===c)&&h(X?c:l),T.current=G},[n.selectedVoice,u]);const F=fF(n.selectedVoice),z=m||F||"en-US";O.useEffect(()=>{var G;if(I&&I!==C.current){C.current=I;const X=(G=n.personalVoiceInfo)!=null&&G.isPersonalVoice?n.personalVoiceInfo.model:void 0;tT(I).then(Y=>{i({timestamp:Date.now(),text:u,voice:n.selectedVoice,region:n.region,audioData:I,duration:Y,model:X})}).catch(Y=>{console.error("Failed to get audio duration:",Y);const ce=I.byteLength*8/48e3;i({timestamp:Date.now(),text:u,voice:n.selectedVoice,region:n.region,audioData:I,duration:ce,model:X})})}},[I,u,n.selectedVoice,n.region,n.personalVoiceInfo,i]);const W=()=>{M(u,z)};return g.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[g.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[g.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 shadow-md",children:[g.jsx("h1",{className:"text-3xl font-bold",children:"Text to Speech"}),g.jsx("p",{className:"text-blue-100 mt-1",children:"Realtime text-to-Speech voices from Microsoft Foundry Voice Gallery"})]}),g.jsxs("div",{className:"flex-1 grid grid-rows-[1fr_auto] gap-6 p-6 overflow-hidden",children:[g.jsx("div",{className:"overflow-hidden",children:g.jsx(x9,{text:u,onTextChange:h,wordBoundaries:P,currentWordIndex:b,selectedVoice:n.selectedVoice,state:E,personalVoiceInfo:n.personalVoiceInfo,selectedPresetLanguage:m,onPresetLanguageChange:v})}),g.jsx("div",{className:"border-t border-gray-200 pt-6",children:g.jsx(mF,{state:E,error:x,audioData:I,hasText:u.trim().length>0,isConfigured:t,onPlay:W,onPause:N,onResume:D,onStop:j})})]}),g.jsx(b9,{history:r,onClearHistory:o,onDeleteEntry:s}),g.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("p",{className:"text-xs text-gray-600",children:"Built with React, TypeScript, and Azure Cognitive Services Speech SDK"}),g.jsx(gF,{text:u,selectedVoice:n.selectedVoice,region:n.region,audioData:I})]})})]}),g.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-hidden",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Voice Selection"}),g.jsx("div",{className:"flex-1 min-h-0",children:g.jsx(T9,{apiKey:n.apiKey,region:n.region,selectedVoice:n.selectedVoice,enableMAIVoices:a,onVoiceChange:G=>{console.log("TTSPlayground: Voice changed to:",G),e({selectedVoice:G})},onVoiceInfoChange:G=>{var Y;console.log("TTSPlayground: Voice info changed:",G);const X=G.isPersonalVoice?`personal:${G.voiceName}`:G.voiceName;e({selectedVoice:X,personalVoiceInfo:{isPersonalVoice:G.isPersonalVoice,speakerProfileId:G.speakerProfileId,locale:G.locale,model:G.isPersonalVoice?((Y=n.personalVoiceInfo)==null?void 0:Y.model)||"DragonLatestNeural":void 0}})}})}),((V=n.personalVoiceInfo)==null?void 0:V.isPersonalVoice)&&((K=n.selectedVoice)==null?void 0:K.startsWith("personal:"))&&g.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Voice Model"}),g.jsx("select",{value:((ee=n.personalVoiceInfo)==null?void 0:ee.model)||"DragonLatestNeural",onChange:G=>{e({personalVoiceInfo:{...n.personalVoiceInfo,model:G.target.value}})},className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:SF.map(G=>g.jsxs("option",{value:G.id,children:[G.name," - ",G.description]},G.id))})]})]})]})}async function nT(n){const e=new AudioContext({sampleRate:16e3});try{const t=await n.arrayBuffer(),r=await e.decodeAudioData(t),i=r.numberOfChannels>1?R9(r):r.getChannelData(0);return I9(i,16e3)}finally{await e.close()}}function R9(n){const e=n.numberOfChannels,t=n.length,r=new Float32Array(t);for(let i=0;i<e;i++){const s=n.getChannelData(i);for(let o=0;o<t;o++)r[o]+=s[o]/e}return r}function I9(n,e){const t=new ArrayBuffer(44+n.length*2),r=new DataView(t);return cC(r,0,"RIFF"),r.setUint32(4,36+n.length*2,!0),cC(r,8,"WAVE"),cC(r,12,"fmt "),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,1,!0),r.setUint32(24,e,!0),r.setUint32(28,e*2,!0),r.setUint16(32,2,!0),r.setUint16(34,16,!0),cC(r,36,"data"),r.setUint32(40,n.length*2,!0),_9(r,44,n),new Blob([t],{type:"audio/wav"})}function cC(n,e,t){for(let r=0;r<t.length;r++)n.setUint8(e+r,t.charCodeAt(r))}function _9(n,e,t){for(let r=0;r<t.length;r++,e+=2){const i=Math.max(-1,Math.min(1,t[r]));n.setInt16(e,i<0?i*32768:i*32767,!0)}}const cD=["en-US","zh-CN","ja-JP","ko-KR"];function k9(n){const[e,t]=O.useState("idle"),[r,i]=O.useState(null),[s,o]=O.useState(""),a=O.useRef(null),l=O.useRef(null);O.useEffect(()=>()=>{a.current&&a.current.close(),l.current&&l.current.close()},[]);const c=O.useCallback(async(m,v)=>{try{t("processing"),o("");const C=await nT(m),T=jt.SpeechConfig.fromSubscription(n.apiKey,n.region);T.outputFormat=jt.OutputFormat.Detailed;const E=jt.AudioInputStream.createPushStream();l.current=E;const x=jt.AudioConfig.fromStreamInput(E);let P;if(v==="auto"){const j=jt.AutoDetectSourceLanguageConfig.fromLanguages(cD);P=jt.SpeechRecognizer.FromConfig(T,j,x),console.log("Auto-detect enabled with languages:",cD)}else T.speechRecognitionLanguage=v,P=new jt.SpeechRecognizer(T,x);a.current=P,i({text:"",segments:[],isStreaming:!0,isFinal:!1,interimText:""}),P.recognizing=(j,F)=>{F.result.reason===jt.ResultReason.RecognizingSpeech&&i(z=>z?{...z,interimText:F.result.text,isStreaming:!0}:null)},P.recognized=(j,F)=>{var z;if(F.result.reason===jt.ResultReason.RecognizedSpeech){const W=F.result.text,H=F.result.offset/1e4,V=F.result.duration/1e4;let K=.9,ee,G;try{const Y=JSON.parse(F.result.properties.getProperty(jt.PropertyId.SpeechServiceResponse_JsonResult));if(console.log("Realtime STT Detailed Result:",Y),Y.NBest&&Y.NBest.length>0){const ce=Y.NBest[0];K=ce.Confidence||.9,ce.Words&&(ee=ce.Words.map(ae=>({text:ae.Word,offset:ae.Offset/1e4,duration:ae.Duration/1e4,confidence:ae.Confidence||K})))}G=((z=Y.PrimaryLanguage)==null?void 0:z.Language)||Y.Locale}catch(Y){console.warn("Could not parse detailed result:",Y)}if(!G){const Y=F.result.properties.getProperty(jt.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages);Y?(console.log(`Detected language: ${Y}`),G=Y):v!=="auto"&&(G=v)}const X={text:W,offset:H,duration:V,confidence:K,words:ee,locale:G};i(Y=>{if(!Y)return null;const ce=[...Y.segments,X],ae=ce.map($=>$.text).join(" ");return{...Y,text:ae,segments:ce,interimText:""}})}else F.result.reason===jt.ResultReason.NoMatch&&console.warn("No speech could be recognized")},P.canceled=(j,F)=>{F.reason===jt.CancellationReason.Error&&(o(F.errorDetails||"Recognition error occurred"),t("error")),i(z=>z?{...z,isStreaming:!1,isFinal:!0}:null),P.stopContinuousRecognitionAsync()},P.sessionStopped=(j,F)=>{i(z=>z?{...z,isStreaming:!1,isFinal:!0}:null),t("completed"),P.stopContinuousRecognitionAsync()},P.startContinuousRecognitionAsync(()=>{t("streaming")},j=>{o(`Failed to start recognition: ${j}`),t("error")});const b=await C.arrayBuffer(),I=new Uint8Array(b),M=3200;let N=44;const D=()=>{if(N<I.length){const j=I.slice(N,N+M);E.write(j.buffer),N+=M,setTimeout(D,100)}else E.close()};D()}catch(C){o(C.message||"Failed to start recognition"),t("error")}},[n]),u=O.useCallback(()=>{a.current&&a.current.stopContinuousRecognitionAsync(()=>{i(m=>m?{...m,isStreaming:!1,isFinal:!0}:null),t("completed")},m=>{console.error("Error stopping recognition:",m)})},[]),h=O.useCallback(()=>{a.current&&(a.current.close(),a.current=null),l.current&&(l.current.close(),l.current=null),t("idle"),i(null),o("")},[]);return{state:e,transcript:r,error:s,startRecognition:c,stopRecognition:u,reset:h}}const CF={code:"auto",name:"Auto-detect",nativeName:"Auto-detect language"},QP=[{code:"en-US",name:"English",nativeName:"English (United States)",region:"US"},{code:"en-GB",name:"English",nativeName:"English (United Kingdom)",region:"GB"},{code:"en-AU",name:"English",nativeName:"English (Australia)",region:"AU"},{code:"en-CA",name:"English",nativeName:"English (Canada)",region:"CA"},{code:"en-IN",name:"English",nativeName:"English (India)",region:"IN"},{code:"en-IE",name:"English",nativeName:"English (Ireland)",region:"IE"},{code:"en-NZ",name:"English",nativeName:"English (New Zealand)",region:"NZ"},{code:"en-SG",name:"English",nativeName:"English (Singapore)",region:"SG"},{code:"en-ZA",name:"English",nativeName:"English (South Africa)",region:"ZA"},{code:"en-HK",name:"English",nativeName:"English (Hong Kong)",region:"HK"},{code:"en-PH",name:"English",nativeName:"English (Philippines)",region:"PH"},{code:"zh-CN",name:"Chinese",nativeName:" ()",region:"CN"},{code:"zh-HK",name:"Chinese",nativeName:" ()",region:"HK"},{code:"es-ES",name:"Spanish",nativeName:"Espaol (Espaa)",region:"ES"},{code:"es-MX",name:"Spanish",nativeName:"Espaol (Mxico)",region:"MX"},{code:"es-AR",name:"Spanish",nativeName:"Espaol (Argentina)",region:"AR"},{code:"es-CO",name:"Spanish",nativeName:"Espaol (Colombia)",region:"CO"},{code:"es-CL",name:"Spanish",nativeName:"Espaol (Chile)",region:"CL"},{code:"fr-FR",name:"French",nativeName:"Franais (France)",region:"FR"},{code:"fr-CA",name:"French",nativeName:"Franais (Canada)",region:"CA"},{code:"de-DE",name:"German",nativeName:"Deutsch (Deutschland)",region:"DE"},{code:"de-AT",name:"German",nativeName:"Deutsch (sterreich)",region:"AT"},{code:"de-CH",name:"German",nativeName:"Deutsch (Schweiz)",region:"CH"},{code:"ja-JP",name:"Japanese",nativeName:" ()",region:"JP"},{code:"ko-KR",name:"Korean",nativeName:" ()",region:"KR"},{code:"pt-BR",name:"Portuguese",nativeName:"Portugus (Brasil)",region:"BR"},{code:"pt-PT",name:"Portuguese",nativeName:"Portugus (Portugal)",region:"PT"},{code:"it-IT",name:"Italian",nativeName:"Italiano (Italia)",region:"IT"},{code:"ru-RU",name:"Russian",nativeName:" ()",region:"RU"},{code:"ar-SA",name:"Arabic",nativeName:" ()",region:"SA"},{code:"ar-EG",name:"Arabic",nativeName:" ()",region:"EG"},{code:"ar-AE",name:"Arabic",nativeName:" ()",region:"AE"},{code:"hi-IN",name:"Hindi",nativeName:" ()",region:"IN"},{code:"th-TH",name:"Thai",nativeName:" ()",region:"TH"},{code:"tr-TR",name:"Turkish",nativeName:"Trke (Trkiye)",region:"TR"},{code:"pl-PL",name:"Polish",nativeName:"Polski (Polska)",region:"PL"},{code:"nl-NL",name:"Dutch",nativeName:"Nederlands (Nederland)",region:"NL"},{code:"sv-SE",name:"Swedish",nativeName:"Svenska (Sverige)",region:"SE"},{code:"da-DK",name:"Danish",nativeName:"Dansk (Danmark)",region:"DK"},{code:"fi-FI",name:"Finnish",nativeName:"Suomi (Suomi)",region:"FI"},{code:"nb-NO",name:"Norwegian",nativeName:"Norsk Bokml (Norge)",region:"NO"},{code:"cs-CZ",name:"Czech",nativeName:"etina (esk republika)",region:"CZ"},{code:"hu-HU",name:"Hungarian",nativeName:"Magyar (Magyarorszg)",region:"HU"},{code:"ro-RO",name:"Romanian",nativeName:"Romn (Romnia)",region:"RO"},{code:"vi-VN",name:"Vietnamese",nativeName:"Ting Vit (Vit Nam)",region:"VN"},{code:"id-ID",name:"Indonesian",nativeName:"Bahasa Indonesia (Indonesia)",region:"ID"},{code:"ms-MY",name:"Malay",nativeName:"Bahasa Melayu (Malaysia)",region:"MY"},{code:"el-GR",name:"Greek",nativeName:" ()",region:"GR"},{code:"he-IL",name:"Hebrew",nativeName:" ()",region:"IL"},{code:"uk-UA",name:"Ukrainian",nativeName:" ()",region:"UA"},{code:"bg-BG",name:"Bulgarian",nativeName:" ()",region:"BG"},{code:"hr-HR",name:"Croatian",nativeName:"Hrvatski (Hrvatska)",region:"HR"},{code:"sk-SK",name:"Slovak",nativeName:"Slovenina (Slovensko)",region:"SK"},{code:"sl-SI",name:"Slovenian",nativeName:"Slovenina (Slovenija)",region:"SI"},{code:"et-EE",name:"Estonian",nativeName:"Eesti (Eesti)",region:"EE"},{code:"lv-LV",name:"Latvian",nativeName:"Latvieu (Latvija)",region:"LV"},{code:"lt-LT",name:"Lithuanian",nativeName:"Lietuvi (Lietuva)",region:"LT"},{code:"fa-IR",name:"Persian",nativeName:" ()",region:"IR"},{code:"bn-IN",name:"Bengali",nativeName:" ()",region:"IN"},{code:"ta-IN",name:"Tamil",nativeName:" ()",region:"IN"},{code:"te-IN",name:"Telugu",nativeName:" ()",region:"IN"},{code:"mr-IN",name:"Marathi",nativeName:" ()",region:"IN"},{code:"gu-IN",name:"Gujarati",nativeName:" ()",region:"IN"},{code:"kn-IN",name:"Kannada",nativeName:" ()",region:"IN"},{code:"ml-IN",name:"Malayalam",nativeName:" ()",region:"IN"},{code:"af-ZA",name:"Afrikaans",nativeName:"Afrikaans (Suid-Afrika)",region:"ZA"},{code:"fil-PH",name:"Filipino",nativeName:"Filipino (Pilipinas)",region:"PH"},{code:"ca-ES",name:"Catalan",nativeName:"Catal (Espanya)",region:"ES"}],AF=[{code:"af-ZA",name:"Afrikaans",nativeName:"Afrikaans (South Africa)",region:"ZA"},{code:"am-ET",name:"Amharic",nativeName:"Amharic (Ethiopia)",region:"ET"},{code:"ar-AE",name:"Arabic",nativeName:" ()",region:"AE"},{code:"ar-BH",name:"Arabic",nativeName:" ()",region:"BH"},{code:"ar-DZ",name:"Arabic",nativeName:" ()",region:"DZ"},{code:"ar-EG",name:"Arabic",nativeName:" ()",region:"EG"},{code:"ar-IL",name:"Arabic",nativeName:" ()",region:"IL"},{code:"ar-IQ",name:"Arabic",nativeName:" ()",region:"IQ"},{code:"ar-JO",name:"Arabic",nativeName:" ()",region:"JO"},{code:"ar-KW",name:"Arabic",nativeName:" ()",region:"KW"},{code:"ar-LB",name:"Arabic",nativeName:" ()",region:"LB"},{code:"ar-LY",name:"Arabic",nativeName:" ()",region:"LY"},{code:"ar-MA",name:"Arabic",nativeName:" ()",region:"MA"},{code:"ar-OM",name:"Arabic",nativeName:" ()",region:"OM"},{code:"ar-PS",name:"Arabic",nativeName:" ()",region:"PS"},{code:"ar-QA",name:"Arabic",nativeName:" ()",region:"QA"},{code:"ar-SA",name:"Arabic",nativeName:" ()",region:"SA"},{code:"ar-SY",name:"Arabic",nativeName:" ()",region:"SY"},{code:"ar-TN",name:"Arabic",nativeName:" ()",region:"TN"},{code:"ar-YE",name:"Arabic",nativeName:" ()",region:"YE"},{code:"as-IN",name:"Assamese",nativeName:" ()",region:"IN"},{code:"az-AZ",name:"Azerbaijani",nativeName:"Azrbaycan (Azrbaycan)",region:"AZ"},{code:"bg-BG",name:"Bulgarian",nativeName:" ()",region:"BG"},{code:"bn-IN",name:"Bengali",nativeName:" ()",region:"IN"},{code:"bs-BA",name:"Bosnian",nativeName:"Bosanski (Bosna i Hercegovina)",region:"BA"},{code:"ca-ES",name:"Catalan",nativeName:"Catal (Espanya)",region:"ES"},{code:"cs-CZ",name:"Czech",nativeName:"etina (esk republika)",region:"CZ"},{code:"cy-GB",name:"Welsh",nativeName:"Cymraeg (Y Deyrnas Unedig)",region:"GB"},{code:"da-DK",name:"Danish",nativeName:"Dansk (Danmark)",region:"DK"},{code:"de-AT",name:"German",nativeName:"Deutsch (sterreich)",region:"AT"},{code:"de-CH",name:"German",nativeName:"Deutsch (Schweiz)",region:"CH"},{code:"de-DE",name:"German",nativeName:"Deutsch (Deutschland)",region:"DE"},{code:"el-GR",name:"Greek",nativeName:" ()",region:"GR"},{code:"en-AU",name:"English",nativeName:"English (Australia)",region:"AU"},{code:"en-CA",name:"English",nativeName:"English (Canada)",region:"CA"},{code:"en-GB",name:"English",nativeName:"English (United Kingdom)",region:"GB"},{code:"en-GH",name:"English",nativeName:"English (Ghana)",region:"GH"},{code:"en-HK",name:"English",nativeName:"English (Hong Kong SAR)",region:"HK"},{code:"en-IE",name:"English",nativeName:"English (Ireland)",region:"IE"},{code:"en-IN",name:"English",nativeName:"English (India)",region:"IN"},{code:"en-KE",name:"English",nativeName:"English (Kenya)",region:"KE"},{code:"en-NG",name:"English",nativeName:"English (Nigeria)",region:"NG"},{code:"en-NZ",name:"English",nativeName:"English (New Zealand)",region:"NZ"},{code:"en-PH",name:"English",nativeName:"English (Philippines)",region:"PH"},{code:"en-SG",name:"English",nativeName:"English (Singapore)",region:"SG"},{code:"en-TZ",name:"English",nativeName:"English (Tanzania)",region:"TZ"},{code:"en-US",name:"English",nativeName:"English (United States)",region:"US"},{code:"en-ZA",name:"English",nativeName:"English (South Africa)",region:"ZA"},{code:"es-AR",name:"Spanish",nativeName:"Espaol (Argentina)",region:"AR"},{code:"es-BO",name:"Spanish",nativeName:"Espaol (Bolivia)",region:"BO"},{code:"es-CL",name:"Spanish",nativeName:"Espaol (Chile)",region:"CL"},{code:"es-CO",name:"Spanish",nativeName:"Espaol (Colombia)",region:"CO"},{code:"es-CR",name:"Spanish",nativeName:"Espaol (Costa Rica)",region:"CR"},{code:"es-CU",name:"Spanish",nativeName:"Espaol (Cuba)",region:"CU"},{code:"es-DO",name:"Spanish",nativeName:"Espaol (Repblica Dominicana)",region:"DO"},{code:"es-EC",name:"Spanish",nativeName:"Espaol (Ecuador)",region:"EC"},{code:"es-ES",name:"Spanish",nativeName:"Espaol (Espaa)",region:"ES"},{code:"es-GQ",name:"Spanish",nativeName:"Espaol (Guinea Ecuatorial)",region:"GQ"},{code:"es-GT",name:"Spanish",nativeName:"Espaol (Guatemala)",region:"GT"},{code:"es-HN",name:"Spanish",nativeName:"Espaol (Honduras)",region:"HN"},{code:"es-MX",name:"Spanish",nativeName:"Espaol (Mxico)",region:"MX"},{code:"es-NI",name:"Spanish",nativeName:"Espaol (Nicaragua)",region:"NI"},{code:"es-PA",name:"Spanish",nativeName:"Espaol (Panam)",region:"PA"},{code:"es-PE",name:"Spanish",nativeName:"Espaol (Per)",region:"PE"},{code:"es-PR",name:"Spanish",nativeName:"Espaol (Puerto Rico)",region:"PR"},{code:"es-PY",name:"Spanish",nativeName:"Espaol (Paraguay)",region:"PY"},{code:"es-SV",name:"Spanish",nativeName:"Espaol (El Salvador)",region:"SV"},{code:"es-US",name:"Spanish",nativeName:"Espaol (Estados Unidos)",region:"US"},{code:"es-UY",name:"Spanish",nativeName:"Espaol (Uruguay)",region:"UY"},{code:"es-VE",name:"Spanish",nativeName:"Espaol (Venezuela)",region:"VE"},{code:"et-EE",name:"Estonian",nativeName:"Eesti (Eesti)",region:"EE"},{code:"eu-ES",name:"Basque",nativeName:"Euskara (Espainia)",region:"ES"},{code:"fa-IR",name:"Persian",nativeName:" ()",region:"IR"},{code:"fi-FI",name:"Finnish",nativeName:"Suomi (Suomi)",region:"FI"},{code:"fil-PH",name:"Filipino",nativeName:"Filipino (Pilipinas)",region:"PH"},{code:"fr-BE",name:"French",nativeName:"Franais (Belgique)",region:"BE"},{code:"fr-CA",name:"French",nativeName:"Franais (Canada)",region:"CA"},{code:"fr-CH",name:"French",nativeName:"Franais (Suisse)",region:"CH"},{code:"fr-FR",name:"French",nativeName:"Franais (France)",region:"FR"},{code:"ga-IE",name:"Irish",nativeName:"Gaeilge (ire)",region:"IE"},{code:"gl-ES",name:"Galician",nativeName:"Galego (Espaa)",region:"ES"},{code:"gu-IN",name:"Gujarati",nativeName:" ()",region:"IN"},{code:"he-IL",name:"Hebrew",nativeName:" ()",region:"IL"},{code:"hi-IN",name:"Hindi",nativeName:" ()",region:"IN"},{code:"hr-HR",name:"Croatian",nativeName:"Hrvatski (Hrvatska)",region:"HR"},{code:"hu-HU",name:"Hungarian",nativeName:"Magyar (Magyarorszg)",region:"HU"},{code:"hy-AM",name:"Armenian",nativeName:" ()",region:"AM"},{code:"id-ID",name:"Indonesian",nativeName:"Bahasa Indonesia (Indonesia)",region:"ID"},{code:"is-IS",name:"Icelandic",nativeName:"slenska (sland)",region:"IS"},{code:"it-CH",name:"Italian",nativeName:"Italiano (Svizzera)",region:"CH"},{code:"it-IT",name:"Italian",nativeName:"Italiano (Italia)",region:"IT"},{code:"ja-JP",name:"Japanese",nativeName:" ()",region:"JP"},{code:"jv-ID",name:"Javanese",nativeName:"Jawa (Indonesia)",region:"ID"},{code:"ka-GE",name:"Georgian",nativeName:" ()",region:"GE"},{code:"kk-KZ",name:"Kazakh",nativeName:" ()",region:"KZ"},{code:"km-KH",name:"Khmer",nativeName:" ()",region:"KH"},{code:"kn-IN",name:"Kannada",nativeName:" ()",region:"IN"},{code:"ko-KR",name:"Korean",nativeName:" ()",region:"KR"},{code:"lo-LA",name:"Lao",nativeName:" ()",region:"LA"},{code:"lt-LT",name:"Lithuanian",nativeName:"Lietuvi (Lietuva)",region:"LT"},{code:"lv-LV",name:"Latvian",nativeName:"Latvieu (Latvija)",region:"LV"},{code:"mk-MK",name:"Macedonian",nativeName:" ( )",region:"MK"},{code:"ml-IN",name:"Malayalam",nativeName:" ()",region:"IN"},{code:"mn-MN",name:"Mongolian",nativeName:" ()",region:"MN"},{code:"mr-IN",name:"Marathi",nativeName:" ()",region:"IN"},{code:"ms-MY",name:"Malay",nativeName:"Bahasa Melayu (Malaysia)",region:"MY"},{code:"mt-MT",name:"Maltese",nativeName:"Malti (Malta)",region:"MT"},{code:"my-MM",name:"Burmese",nativeName:" ()",region:"MM"},{code:"nb-NO",name:"Norwegian Bokml",nativeName:"Norsk Bokml (Norge)",region:"NO"},{code:"ne-NP",name:"Nepali",nativeName:" ()",region:"NP"},{code:"nl-BE",name:"Dutch",nativeName:"Nederlands (Belgi)",region:"BE"},{code:"nl-NL",name:"Dutch",nativeName:"Nederlands (Nederland)",region:"NL"},{code:"or-IN",name:"Odia",nativeName:" ()",region:"IN"},{code:"pa-IN",name:"Punjabi",nativeName:" ()",region:"IN"},{code:"pl-PL",name:"Polish",nativeName:"Polski (Polska)",region:"PL"},{code:"ps-AF",name:"Pashto",nativeName:" ()",region:"AF"},{code:"pt-BR",name:"Portuguese",nativeName:"Portugus (Brasil)",region:"BR"},{code:"pt-PT",name:"Portuguese",nativeName:"Portugus (Portugal)",region:"PT"},{code:"ro-RO",name:"Romanian",nativeName:"Romn (Romnia)",region:"RO"},{code:"ru-RU",name:"Russian",nativeName:" ()",region:"RU"},{code:"si-LK",name:"Sinhala",nativeName:" ( )",region:"LK"},{code:"sk-SK",name:"Slovak",nativeName:"Slovenina (Slovensko)",region:"SK"},{code:"sl-SI",name:"Slovenian",nativeName:"Slovenina (Slovenija)",region:"SI"},{code:"so-SO",name:"Somali",nativeName:"Soomaali (Soomaaliya)",region:"SO"},{code:"sq-AL",name:"Albanian",nativeName:"Shqip (Shqipri)",region:"AL"},{code:"sr-RS",name:"Serbian",nativeName:" ()",region:"RS"},{code:"sv-SE",name:"Swedish",nativeName:"Svenska (Sverige)",region:"SE"},{code:"sw-KE",name:"Swahili",nativeName:"Kiswahili (Kenya)",region:"KE"},{code:"sw-TZ",name:"Swahili",nativeName:"Kiswahili (Tanzania)",region:"TZ"},{code:"ta-IN",name:"Tamil",nativeName:" ()",region:"IN"},{code:"te-IN",name:"Telugu",nativeName:" ()",region:"IN"},{code:"th-TH",name:"Thai",nativeName:" ()",region:"TH"},{code:"tr-TR",name:"Turkish",nativeName:"Trke (Trkiye)",region:"TR"},{code:"uk-UA",name:"Ukrainian",nativeName:" ()",region:"UA"},{code:"ur-IN",name:"Urdu",nativeName:" ()",region:"IN"},{code:"uz-UZ",name:"Uzbek",nativeName:"Ozbek (Ozbekiston)",region:"UZ"},{code:"vi-VN",name:"Vietnamese",nativeName:"Ting Vit (Vit Nam)",region:"VN"},{code:"wuu-CN",name:"Chinese (Wu)",nativeName:" ()",region:"CN"},{code:"yue-CN",name:"Chinese (Cantonese)",nativeName:" ()",region:"CN"},{code:"zh-CN",name:"Chinese (Mandarin)",nativeName:" ()",region:"CN"},{code:"zh-CN-shandong",name:"Chinese (Jilu Mandarin)",nativeName:" ()",region:"CN"},{code:"zh-CN-sichuan",name:"Chinese (Southwestern Mandarin)",nativeName:" ()",region:"CN"},{code:"zh-HK",name:"Chinese (Cantonese)",nativeName:" ()",region:"HK"},{code:"zh-TW",name:"Chinese (Taiwanese Mandarin)",nativeName:" ()",region:"TW"},{code:"zu-ZA",name:"Zulu",nativeName:"isiZulu (South Africa)",region:"ZA"}];function M9(n){return[CF,...n==="fast-transcription"?QP:AF]}function N9(n){const[e,t]=O.useState("idle"),[r,i]=O.useState(null),[s,o]=O.useState(""),[a,l]=O.useState(0),c=O.useCallback(async(h,m,v)=>{try{if(t("processing"),o(""),l(0),h.size>25*1024*1024)throw new Error("Audio file must be less than 25 MB for Fast Transcription API");l(10);const C=await nT(h);l(30);let T;m==="auto"?(T=QP.map(N=>N.code),console.log("Auto-detect enabled, using all Fast Transcription locales:",T.length)):T=[m];const E={locales:T};v!=null&&v.enableDiarization&&(E.diarization={enabled:!0,maxSpeakers:v.maxSpeakers||2});const x=`https://${n.region}.api.cognitive.microsoft.com/speechtotext/transcriptions:transcribe?api-version=2024-11-15`;l(50);const P=new FormData;P.append("audio",C,"audio.wav"),P.append("definition",JSON.stringify(E)),console.log("Fast Transcription API Request:",E);const b=await fetch(x,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":n.apiKey},body:P});if(l(70),!b.ok){const N=await b.text();throw new Error(`API request failed (${b.status}): ${N}`)}const I=await b.json();l(90);const M=L9(I,m);i(M),l(100),t("completed")}catch(C){o(C.message||"Transcription failed"),t("error"),l(0)}},[n]),u=O.useCallback(()=>{t("idle"),i(null),o(""),l(0)},[]);return{state:e,transcript:r,error:s,progress:a,transcribe:c,reset:u}}function L9(n,e){console.log("Fast Transcription API Response:",n);let t="",r=[];n.combinedPhrases&&n.combinedPhrases.length>0?t=n.combinedPhrases[0].text||"":n.combinedRecognizedPhrases&&n.combinedRecognizedPhrases.length>0&&(t=n.combinedRecognizedPhrases[0].display||""),n.phrases&&Array.isArray(n.phrases)?r=n.phrases.map(s=>{var v,C,T,E,x;const o=s.offsetMilliseconds??uC(s.offset||s.offsetInTicks||0),a=s.durationMilliseconds??uC(s.duration||s.durationInTicks||0),l=s.confidence||((C=(v=s.nBest)==null?void 0:v[0])==null?void 0:C.confidence)||.9,c=s.text||((E=(T=s.nBest)==null?void 0:T[0])==null?void 0:E.display)||"",u=(x=s.words)==null?void 0:x.map(P=>({text:P.text||P.word,offset:P.offsetMilliseconds??uC(P.offset||P.offsetInTicks||0),duration:P.durationMilliseconds??uC(P.duration||P.durationInTicks||0),confidence:P.confidence||l})),h=s.speaker,m=s.locale;return{text:c,offset:o,duration:a,confidence:l,words:u,speaker:h,locale:m}}).filter(s=>s.text):n.recognizedPhrases&&Array.isArray(n.recognizedPhrases)&&(r=n.recognizedPhrases.map(s=>{var h,m;const o=(h=s.nBest)==null?void 0:h[0];if(!o)return null;const a=mv(s.offset||"PT0S"),l=mv(s.duration||"PT0S"),c=o.confidence||.9,u=(m=o.words)==null?void 0:m.map(v=>({text:v.word,offset:mv(v.offset),duration:mv(v.duration),confidence:v.confidence||c}));return{text:o.display,offset:a,duration:l,confidence:c,words:u}}).filter(Boolean));const i=r.length>0?Math.max(...r.map(s=>s.offset+s.duration)):0;return{fullText:t,segments:r,language:e,duration:i}}function uC(n){return typeof n=="number"?n/1e4:typeof n=="string"?mv(n):0}function mv(n){const e=n.match(/PT(?:(\d+(?:\.\d+)?)H)?(?:(\d+(?:\.\d+)?)M)?(?:(\d+(?:\.\d+)?)S)?/);if(!e)return 0;const t=parseFloat(e[1]||"0"),r=parseFloat(e[2]||"0"),i=parseFloat(e[3]||"0");return(t*3600+r*60+i)*1e3}function D9(n){const[e,t]=O.useState("idle"),[r,i]=O.useState(null),[s,o]=O.useState(""),[a,l]=O.useState(""),[c,u]=O.useState(""),h=O.useRef(null),m=O.useCallback(async(T,E)=>{var x;try{throw t("processing"),o(""),l(""),u("Preparing audio..."),h.current=new AbortController,T.size>10*1024*1024?new Error("Audio file must be less than 10 MB for Whisper API (data URL limitation)"):new Error("Whisper API requires publicly accessible audio URLs. Data URLs are not supported. Please use Azure Blob Storage or a public URL.")}catch(P){P.name==="AbortError"?(o("Transcription cancelled"),u("Cancelled")):(o(P.message||"Transcription failed"),u("Failed")),t("error")}},[n]),v=O.useCallback(()=>{h.current&&h.current.abort()},[]),C=O.useCallback(()=>{v(),t("idle"),i(null),o(""),l(""),u("")},[v]);return{state:e,transcript:r,error:s,jobId:a,pollingStatus:c,transcribe:m,cancelJob:v,reset:C}}function O9(n){return new Promise((e,t)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=t,r.readAsDataURL(n)})}async function B9(n,e,t,r){const i=`https://${n.region}.api.cognitive.microsoft.com/speechtotext/models/base?api-version=2024-11-15`,s=await fetch(i,{headers:{"Ocp-Apim-Subscription-Key":n.apiKey},signal:r});if(!s.ok)throw new Error(`Failed to get Whisper model (${s.status})`);const a=(await s.json()).self,l=`https://${n.region}.api.cognitive.microsoft.com/speechtotext/transcriptions:submit?api-version=2024-11-15`,c=await fetch(l,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":n.apiKey,"Content-Type":"application/json"},body:JSON.stringify({contentUrls:[e],locale:t,displayName:`Whisper Transcription ${Date.now()}`,model:{self:a},properties:{wordLevelTimestampsEnabled:!0}}),signal:r});if(!c.ok){const h=await c.text();throw console.error("Whisper API Error:",h),console.error("Request body:",JSON.stringify({contentUrls:[e.substring(0,100)+"..."],locale:t,displayName:`Whisper Transcription ${Date.now()}`,model:{self:a},properties:{wordLevelTimestampsEnabled:!0}},null,2)),new Error(`Failed to create transcription job (${c.status}): ${h}`)}return(await c.json()).self}async function F9(n,e,t,r){let s=0,o=2e3;const a=5e3;for(;s<150;){const l=await fetch(e,{headers:{"Ocp-Apim-Subscription-Key":n.apiKey},signal:r});if(!l.ok)throw new Error(`Failed to poll job status (${l.status})`);const c=await l.json();if(t(`Status: ${c.status}${c.status==="Running"?` (${s*o/1e3}s elapsed)`:""}`),c.status==="Succeeded"||c.status==="Failed")return c;await z9(o),s>15&&(o=a),s++}throw new Error("Transcription timeout after 5 minutes")}async function j9(n,e,t,r,i){var u;const s=await fetch(`${e}/files`,{headers:{"Ocp-Apim-Subscription-Key":n.apiKey},signal:i});if(!s.ok)throw new Error(`Failed to get transcription files (${s.status})`);const a=(u=(await s.json()).values)==null?void 0:u.find(h=>h.kind==="Transcription");if(!a)throw new Error("Transcription file not found");const l=await fetch(a.links.contentUrl,{signal:i});if(!l.ok)throw new Error(`Failed to download transcription (${l.status})`);const c=await l.json();return U9(c,t,r)}function U9(n,e,t){var a;const i=((a=(n.combinedRecognizedPhrases||[])[0])==null?void 0:a.display)||"",s=(n.recognizedPhrases||[]).map(l=>{var T,E;const c=(T=l.nBest)==null?void 0:T[0];if(!c)return null;const u=dC(l.offset||"PT0S"),h=dC(l.duration||"PT0S"),m=c.confidence||.95,v=(E=c.words)==null?void 0:E.map(x=>({text:x.word,offset:dC(x.offset),duration:dC(x.duration),confidence:x.confidence||m})),C=l.locale||t;return{text:c.display,offset:u,duration:h,confidence:m,words:v,locale:C}}).filter(Boolean),o=s.length>0?Math.max(...s.map(l=>l.offset+l.duration)):0;return{fullText:i,segments:s,language:t,duration:o,jobId:e}}function dC(n){const e=n.match(/PT(?:(\d+(?:\.\d+)?)H)?(?:(\d+(?:\.\d+)?)M)?(?:(\d+(?:\.\d+)?)S)?/);if(!e)return 0;const t=parseFloat(e[1]||"0"),r=parseFloat(e[2]||"0"),i=parseFloat(e[3]||"0");return(t*3600+r*60+i)*1e3}function z9(n){return new Promise(e=>setTimeout(e,n))}const TF=[{code:"en-US",name:"English",nativeName:"English (United States)"},{code:"zh-CN",name:"Chinese",nativeName:" ()"},{code:"de-DE",name:"German",nativeName:"Deutsch (Deutschland)"},{code:"fr-FR",name:"French",nativeName:"Franais (France)"},{code:"it-IT",name:"Italian",nativeName:"Italiano (Italia)"},{code:"ja-JP",name:"Japanese",nativeName:" ()"},{code:"es-ES",name:"Spanish",nativeName:"Espaol (Espaa)"},{code:"pt-BR",name:"Portuguese",nativeName:"Portugus (Brasil)"},{code:"ko-KR",name:"Korean",nativeName:" ()"}];function W9(n){const[e,t]=O.useState("idle"),[r,i]=O.useState(null),[s,o]=O.useState(""),[a,l]=O.useState(0),c=O.useCallback(async(h,m,v={})=>{try{if(t("processing"),o(""),l(0),h.size>300*1024*1024)throw new Error("Audio file must be less than 300 MB for LLM Speech API");l(10);const C=await nT(h);l(30);const T=m.split("-")[0],E={enhancedMode:{enabled:!0,task:v.task||"transcribe"}};if(v.task==="translate"&&v.targetLanguage){const N=v.targetLanguage.split("-")[0];E.enhancedMode.targetLanguage=N}v.prompt&&v.prompt.length>0&&(E.enhancedMode.prompt=v.prompt),v.enableDiarization&&(E.diarization={enabled:!0,maxSpeakers:v.maxSpeakers||2});const x=`https://${n.region}.api.cognitive.microsoft.com/speechtotext/transcriptions:transcribe?api-version=2025-10-15`;l(50);const P=new FormData;P.append("audio",C,"audio.wav"),P.append("definition",JSON.stringify(E)),console.log("LLM Speech API Request:",E);const b=await fetch(x,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":n.apiKey},body:P});if(l(70),!b.ok){const N=await b.text();throw new Error(`API request failed (${b.status}): ${N}`)}const I=await b.json();l(90),console.log("LLM Speech API Response:",I);const M=V9(I,m);i(M),l(100),t("completed")}catch(C){o(C.message||"Transcription failed"),t("error"),l(0)}},[n]),u=O.useCallback(()=>{t("idle"),i(null),o(""),l(0)},[]);return{state:e,transcript:r,error:s,progress:a,transcribe:c,reset:u}}function V9(n,e){let t="",r=[];n.combinedPhrases&&n.combinedPhrases.length>0&&(t=n.combinedPhrases[0].text||""),n.phrases&&Array.isArray(n.phrases)&&(r=n.phrases.map(s=>{var v;const o=s.offsetMilliseconds??hC(s.offset||s.offsetInTicks||0),a=s.durationMilliseconds??hC(s.duration||s.durationInTicks||0),l=s.confidence||0,c=s.text||"",u=(v=s.words)==null?void 0:v.map(C=>({text:C.text||C.word,offset:C.offsetMilliseconds??hC(C.offset||C.offsetInTicks||0),duration:C.durationMilliseconds??hC(C.duration||C.durationInTicks||0),confidence:C.confidence||l})),h=s.speaker,m=s.locale;return{text:c,offset:o,duration:a,confidence:l,words:u,speaker:h,locale:m}}).filter(s=>s.text));const i=r.length>0?Math.max(...r.map(s=>s.offset+s.duration)):0;return{fullText:t,segments:r,language:e,duration:i}}function hC(n){return typeof n=="number"?n/1e4:typeof n=="string"?$9(n):0}function $9(n){const e=n.match(/PT(?:(\d+(?:\.\d+)?)H)?(?:(\d+(?:\.\d+)?)M)?(?:(\d+(?:\.\d+)?)S)?/);if(!e)return 0;const t=parseFloat(e[1]||"0"),r=parseFloat(e[2]||"0"),i=parseFloat(e[3]||"0");return(t*3600+r*60+i)*1e3}const H9=["australiaeast","centralindia","eastus","eastus2","northeurope","southcentralus","southeastasia","swedencentral","westeurope"],Z9=["centralindia","eastus","northeurope","southeastasia","westus"],uD=[{id:"realtime",name:"Azure Realtime ASR",description:"WebSocket streaming, low-latency recognition",icon:"",useCases:"Live transcription, real-time captions",features:["Streaming results","Word-level timestamps","Low latency","Any file size",`${AF.length} locales`]},{id:"fast-transcription",name:"Azure Fast Transcription",description:"REST API optimized for speed",icon:"",useCases:"Quick audio file transcription",features:["Fast processing","Batch transcription","Max 25 MB",`${QP.length} locales`]},{id:"llm-speech",name:"LLM Speech (Preview)",description:"LLM-enhanced with deep contextual understanding",icon:"",useCases:"High-accuracy transcription & translation",features:["LLM-enhanced","Prompt tuning","Translation","Diarization",`${TF.length} locales`]}];function q9(n,e){const t=e.toLowerCase();switch(n){case"realtime":return!0;case"fast-transcription":return H9.includes(t);case"llm-speech":return Z9.includes(t);case"whisper":return!0;default:return!0}}function G9({selectedModel:n,onModelChange:e,region:t=""}){const[r,i]=O.useState(!1),s=O.useMemo(()=>uD.find(a=>a.id===n),[n]),o=a=>{e(a),i(!1)};return g.jsxs("div",{className:"space-y-3",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Recognition Model"}),g.jsxs("div",{className:"relative",children:[g.jsxs("button",{onClick:()=>i(!r),className:"w-full px-4 py-2.5 bg-white border border-gray-300 rounded-lg text-left flex items-center justify-between hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xl",children:s==null?void 0:s.icon}),g.jsx("span",{className:"text-gray-900",children:(s==null?void 0:s.name)||"Select model"})]}),g.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&g.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg max-h-80 overflow-y-auto",children:uD.map(a=>{const l=q9(a.id,t);return g.jsx("button",{onClick:()=>l&&o(a.id),disabled:!l,className:`
                    w-full px-4 py-3 text-left transition-colors
                    ${l?n===a.id?"bg-blue-50":"hover:bg-gray-50":"bg-gray-50 opacity-60 cursor-not-allowed"}
                  `,children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:`text-xl ${l?"":"opacity-50"}`,children:a.icon}),g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:`font-medium ${l?"text-gray-900":"text-gray-500"}`,children:a.name}),!l&&g.jsx("span",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:"Not in region"})]}),g.jsx("p",{className:`text-xs ${l?"text-gray-500":"text-gray-400"}`,children:a.description})]})]}),n===a.id&&l&&g.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},a.id)})}),r&&g.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>i(!1)})]}),s&&g.jsx("div",{className:"p-4 rounded-lg border-2 border-blue-500 bg-blue-50",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("span",{className:"text-2xl flex-shrink-0",children:s.icon}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),g.jsx("svg",{className:"w-4 h-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),g.jsx("p",{className:"text-sm mt-1 text-gray-600",children:s.description}),g.jsx("p",{className:"text-xs mt-1 text-gray-500",children:s.useCases}),g.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:s.features.map((a,l)=>g.jsx("span",{className:"inline-block px-2 py-0.5 text-xs rounded bg-white text-gray-700",children:a},l))})]})]})})]})}const K9=TF.map(n=>({code:n.code,name:n.name,nativeName:n.nativeName}));function Y9({selectedLanguage:n,onLanguageChange:e,selectedModel:t}){const[r,i]=O.useState(""),[s,o]=O.useState(!1),a=O.useMemo(()=>t==="llm-speech"?[CF,...K9]:M9(t==="fast-transcription"?"fast-transcription":"realtime"),[t]),l=O.useMemo(()=>{if(!r.trim())return a;const h=r.toLowerCase();return a.filter(m=>m.name.toLowerCase().includes(h)||m.nativeName.toLowerCase().includes(h)||m.code.toLowerCase().includes(h))},[r,a]),c=O.useMemo(()=>a.find(h=>h.code===n),[n,a]),u=h=>{e(h),o(!1),i("")};return g.jsxs("div",{className:"relative",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recognition Language"}),g.jsxs("button",{onClick:()=>o(!s),className:"w-full px-4 py-2.5 bg-white border border-gray-300 rounded-lg text-left flex items-center justify-between hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[(c==null?void 0:c.code)==="auto"?g.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}):g.jsx("span",{className:"text-sm text-gray-500 font-mono",children:c==null?void 0:c.code}),g.jsx("span",{className:"text-gray-900",children:(c==null?void 0:c.nativeName)||"Select language"})]}),g.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform ${s?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&g.jsxs("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg max-h-80 overflow-hidden",children:[g.jsx("div",{className:"p-2 border-b border-gray-200",children:g.jsx("input",{type:"text",value:r,onChange:h=>i(h.target.value),placeholder:"Search languages...",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})}),g.jsx("div",{className:"overflow-y-auto max-h-64",children:l.length>0?l.map(h=>g.jsx("button",{onClick:()=>u(h.code),className:`
                    w-full px-4 py-2.5 text-left hover:bg-gray-50 transition-colors
                    ${n===h.code?"bg-blue-50":""}
                  `,children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center gap-2",children:[h.code==="auto"?g.jsx("svg",{className:"w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}):g.jsx("span",{className:"text-xs text-gray-500 font-mono w-16",children:h.code}),g.jsx("span",{className:"text-sm text-gray-900",children:h.nativeName})]}),h.code!=="auto"&&h.name!==h.nativeName&&g.jsx("div",{className:"text-xs text-gray-500 ml-[72px]",children:h.name})]}),n===h.code&&g.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},h.code)):g.jsx("div",{className:"px-4 py-8 text-center text-gray-500 text-sm",children:"No languages found"})})]}),s&&g.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>o(!1)})]})}function J9({segments:n,fullText:e,interimText:t,isStreaming:r,showTimestamps:i=!0,showConfidence:s=!0,audioSource:o,detectedLanguage:a}){const l=O.useRef(null),[c,u]=O.useState(null),[h,m]=O.useState(null),v=O.useRef(null);dB.useEffect(()=>{if(v.current&&(v.current(),v.current=null),l.current&&(l.current.pause(),u(null)),o){const b=URL.createObjectURL(o);return m(b),()=>{URL.revokeObjectURL(b),v.current&&(v.current(),v.current=null)}}else m(null)},[o]);const C=async(b,I)=>{if(!l.current||!h){console.log("No audio ref or URL available");return}const M=l.current;if(c===I){console.log("Stopping currently playing segment:",I),M.pause(),u(null),v.current&&(v.current(),v.current=null);return}const N=b.offset/1e3,D=(b.offset+b.duration)/1e3;console.log("Playing segment:",I,"from",N,"to",D),v.current&&(v.current(),v.current=null);try{M.pause()}catch{}u(null);try{M.src=h,M.readyState<2&&(console.log("Waiting for audio to load..."),await new Promise((W,H)=>{const V=setTimeout(()=>H(new Error("Timeout loading audio")),5e3),K=()=>{clearTimeout(V),W(!0)};M.addEventListener("loadeddata",K,{once:!0}),M.addEventListener("error",ee=>{clearTimeout(V),H(ee)},{once:!0})})),console.log("Setting currentTime to",N),M.currentTime=N,console.log("Playing audio...");const j=M.play();j!==void 0&&(await j,console.log("Audio playing successfully")),u(I);const F=()=>{M.currentTime>=D&&(console.log("Reached end of segment, stopping"),M.pause(),u(null))},z=()=>{console.log("Audio paused or ended"),u(null)};M.addEventListener("timeupdate",F),M.addEventListener("pause",z),M.addEventListener("ended",z),v.current=()=>{M.removeEventListener("timeupdate",F),M.removeEventListener("pause",z),M.removeEventListener("ended",z)}}catch(j){console.error("Error playing audio segment:",j),u(null)}},T=b=>{const I=Math.floor(b/1e3),M=Math.floor(I/60),N=Math.floor(M/60);return N>0?`${N}:${String(M%60).padStart(2,"0")}:${String(I%60).padStart(2,"0")}`:`${M}:${String(I%60).padStart(2,"0")}`},E=b=>b>=.9?"text-green-600":b>=.7?"text-yellow-600":"text-red-600",x=b=>b>=.9?"High":b>=.7?"Medium":"Low",P=n.length>0||t;return g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Transcript"}),a&&g.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:a})]}),r&&g.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[g.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse"}),g.jsx("span",{children:"Streaming..."})]})]}),g.jsx("div",{className:"bg-white border border-gray-300 rounded-lg min-h-[200px] max-h-[400px] overflow-y-auto p-4",children:P?g.jsxs("div",{className:"space-y-4",children:[n.map((b,I)=>g.jsxs("div",{onClick:()=>o&&C(b,I),className:`border-l-2 pl-3 transition-all ${c===I?"border-green-500 bg-green-50":"border-blue-500"} ${o?"cursor-pointer hover:bg-blue-50":""}`,title:o?"Click to play this segment":"",children:[i&&g.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[b.speaker!==void 0&&g.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800",children:["Speaker ",b.speaker]}),b.locale&&g.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:b.locale}),g.jsx("span",{className:"text-xs text-gray-500 font-mono",children:T(b.offset)}),s&&g.jsxs("span",{className:`text-xs font-medium ${E(b.confidence)}`,children:[x(b.confidence)," (",Math.round(b.confidence*100),"%)"]}),o&&g.jsx("span",{className:"text-xs text-gray-400",children:c===I?g.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):g.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})]}),g.jsx("p",{className:"text-gray-900 leading-relaxed",children:b.text}),b.words&&b.words.length>0&&g.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:b.words.map((M,N)=>g.jsx("span",{className:"inline-block px-1.5 py-0.5 bg-gray-50 text-gray-700 text-xs rounded border border-gray-200 hover:bg-gray-100 transition-colors cursor-default",title:`${T(M.offset)} - ${x(M.confidence)}`,children:M.text},N))})]},I)),t&&g.jsxs("div",{className:"border-l-2 border-gray-300 pl-3",children:[g.jsx("div",{className:"flex items-center gap-2 mb-1",children:g.jsx("span",{className:"text-xs text-gray-400 italic",children:"Recognizing..."})}),g.jsx("p",{className:"text-gray-500 italic leading-relaxed",children:t})]})]}):g.jsxs("div",{className:"flex flex-col items-center justify-center h-[180px] text-gray-400",children:[g.jsx("svg",{className:"w-12 h-12 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),g.jsx("p",{className:"text-sm",children:"No transcript yet"}),g.jsx("p",{className:"text-xs mt-1",children:"Upload or record audio to begin transcription"})]})}),n.length>0&&g.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-600",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})}),g.jsxs("span",{children:[n.length," segment",n.length!==1?"s":""]})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})}),g.jsxs("span",{children:[e.split(" ").length," word",e.split(" ").length!==1?"s":""]})]}),n.length>0&&n[n.length-1].offset&&g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),g.jsxs("span",{children:["Duration: ",T(n[n.length-1].offset+n[n.length-1].duration)]})]})]}),g.jsx("audio",{ref:l,className:"hidden"})]})}function X9(n){return n.map(e=>e.text).join(" ")}function Q9(n){return n.map((e,t)=>{const r=dD(e.offset),i=dD(e.offset+e.duration);return`${t+1}
${r} --> ${i}
${e.text}
`}).join(`
`)}function eV(n){const e=`WEBVTT

`,t=n.map((r,i)=>{const s=hD(r.offset),o=hD(r.offset+r.duration);return`${i+1}
${s} --> ${o}
${r.text}
`}).join(`
`);return e+t}function dD(n){const e=Math.floor(n/36e5),t=Math.floor(n%36e5/6e4),r=Math.floor(n%6e4/1e3),i=n%1e3;return`${Fl(e,2)}:${Fl(t,2)}:${Fl(r,2)},${Fl(i,3)}`}function hD(n){const e=Math.floor(n/36e5),t=Math.floor(n%36e5/6e4),r=Math.floor(n%6e4/1e3),i=n%1e3;return`${Fl(e,2)}:${Fl(t,2)}:${Fl(r,2)}.${Fl(i,3)}`}function Fl(n,e){return n.toString().padStart(e,"0")}function tV(n,e,t){const r={txt:"text/plain",srt:"text/srt",vtt:"text/vtt"},i=new Blob([n],{type:r[t]}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=`${e}.${t}`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}function nV(n,e,t){let r;switch(t){case"txt":r=X9(n);break;case"srt":r=Q9(n);break;case"vtt":r=eV(n);break;default:throw new Error(`Unsupported export format: ${t}`)}tV(r,e,t)}function rV({segments:n,filename:e="transcript",disabled:t=!1}){const r=s=>{n.length!==0&&nV(n,e,s)},i=n.length>0;return g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Export Transcript"}),g.jsxs("div",{className:"flex flex-wrap gap-2",children:[g.jsx("button",{onClick:()=>r("txt"),disabled:t||!i,className:"flex-1 min-w-[100px] px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:g.jsxs("div",{className:"flex items-center justify-center gap-2",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),g.jsx("span",{children:"TXT"})]})}),g.jsx("button",{onClick:()=>r("srt"),disabled:t||!i,className:"flex-1 min-w-[100px] px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:g.jsxs("div",{className:"flex items-center justify-center gap-2",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"})}),g.jsx("span",{children:"SRT"})]})}),g.jsx("button",{onClick:()=>r("vtt"),disabled:t||!i,className:"flex-1 min-w-[100px] px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:g.jsxs("div",{className:"flex items-center justify-center gap-2",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),g.jsx("span",{children:"VTT"})]})})]}),!i&&!t&&g.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Transcribe audio to enable export"})]})}const iV=["audio/wav","audio/wave","audio/x-wav","audio/mp3","audio/mpeg","audio/ogg","audio/flac","audio/x-flac","audio/webm","video/mp4","video/webm","video/x-m4v","video/quicktime","video/x-msvideo"],sV=100*1024*1024;function EF({file:n,onFileChange:e,disabled:t}){const r=O.useRef(null),i=O.useRef(null),s=O.useRef(null),[o,a]=O.useState(!1),[l,c]=O.useState(""),[u,h]=O.useState(!1);O.useEffect(()=>(n?(s.current&&URL.revokeObjectURL(s.current),s.current=URL.createObjectURL(n)):(s.current&&(URL.revokeObjectURL(s.current),s.current=null),i.current&&(i.current.pause(),i.current=null),h(!1)),()=>{s.current&&URL.revokeObjectURL(s.current)}),[n]);const m=O.useCallback(D=>{D.stopPropagation(),!(!s.current||!n)&&(i.current||(i.current=new Audio(s.current),i.current.addEventListener("ended",()=>{h(!1)})),u?(i.current.pause(),h(!1)):(i.current.play(),h(!0)))},[u,n]),v=O.useCallback(D=>!iV.includes(D.type)&&!D.name.match(/\.(wav|mp3|ogg|flac|webm|mp4|m4v|mov|avi)$/i)?"Unsupported file format. Please use WAV, MP3, OGG, FLAC, WebM, MP4, MOV, or AVI.":D.size>sV?`File size must be less than 100 MB. Your file is ${(D.size/(1024*1024)).toFixed(1)} MB.`:null,[]),C=O.useCallback(D=>{const j=v(D);if(j){c(j),e(null);return}c(""),e(D)},[v,e]),T=O.useCallback(D=>{D.preventDefault(),D.stopPropagation(),a(!0)},[]),E=O.useCallback(D=>{D.preventDefault(),D.stopPropagation(),a(!1)},[]),x=O.useCallback(D=>{if(D.preventDefault(),D.stopPropagation(),a(!1),t)return;const j=D.dataTransfer.files;j.length>0&&C(j[0])},[t,C]),P=O.useCallback(D=>{const j=D.target.files;j&&j.length>0&&C(j[0])},[C]),b=O.useCallback(()=>{var D;(D=r.current)==null||D.click()},[]),I=O.useCallback(()=>{e(null),c(""),r.current&&(r.current.value="")},[e]),M=D=>D<1024?`${D} B`:D<1024*1024?`${(D/1024).toFixed(1)} KB`:`${(D/(1024*1024)).toFixed(1)} MB`,N=D=>D.type.startsWith("video/")||D.name.match(/\.(mp4|m4v|mov|avi|webm)$/i)!==null;return g.jsxs("div",{className:"space-y-3",children:[g.jsx("input",{ref:r,type:"file",accept:".wav,.mp3,.ogg,.flac,.webm,.mp4,.m4v,.mov,.avi,audio/*,video/*",onChange:P,className:"hidden",disabled:t}),g.jsx("div",{onDragOver:T,onDragLeave:E,onDrop:x,className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${t?"border-gray-200 bg-gray-50 cursor-not-allowed":o?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400 cursor-pointer"}`,onClick:t?void 0:b,children:n?g.jsxs("div",{className:"flex items-center justify-center gap-3",children:[N(n)?g.jsx("svg",{className:"w-8 h-8 text-purple-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}):g.jsx("svg",{className:"w-8 h-8 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})}),g.jsxs("div",{className:"text-left flex-1 min-w-0",children:[g.jsx("p",{className:"font-medium text-gray-800 truncate",children:n.name}),g.jsx("p",{className:"text-sm text-gray-500",children:M(n.size)})]}),g.jsx("button",{onClick:m,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-full transition-colors flex-shrink-0",title:u?"Pause":"Play source audio",children:u?g.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):g.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),g.jsx("button",{onClick:D=>{D.stopPropagation(),I()},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors flex-shrink-0",title:"Remove file",children:g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):g.jsxs("div",{children:[g.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),g.jsxs("p",{className:"text-gray-600 mb-1",children:[g.jsx("span",{className:"font-medium text-blue-600",children:"Click to browse"})," or drag and drop"]}),g.jsx("p",{className:"text-sm text-gray-500",children:"WAV, MP3, OGG, FLAC, WebM, MP4, MOV, AVI (max 100 MB)"})]})}),l&&g.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded-md",children:l})]})}function qw({onRecordingComplete:n,maxDuration:e=90,minDuration:t=0,disabled:r=!1,shouldReset:i=!1}){const[s,o]=O.useState(!1),[a,l]=O.useState(0),[c,u]=O.useState(null),[h,m]=O.useState(null),[v,C]=O.useState(!1),T=O.useRef(null),E=O.useRef([]),x=O.useRef(null),P=O.useRef(null),b=O.useRef(null);O.useEffect(()=>{i&&c&&(c&&URL.revokeObjectURL(c),u(null),l(0),m(null))},[i,c]),O.useEffect(()=>()=>{x.current&&clearInterval(x.current),P.current&&P.current.getTracks().forEach(z=>z.stop()),c&&URL.revokeObjectURL(c)},[c]);const I=O.useCallback(async()=>{try{m(null),E.current=[];const z=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:16e3,echoCancellation:!0,noiseSuppression:!0}});P.current=z;const W=new MediaRecorder(z,{mimeType:"audio/webm;codecs=opus"});T.current=W,W.ondataavailable=V=>{V.data.size>0&&E.current.push(V.data)},W.onstop=async()=>{P.current&&(P.current.getTracks().forEach(G=>G.stop()),P.current=null);const V=new Blob(E.current,{type:"audio/webm"}),K=await oV(V);c&&URL.revokeObjectURL(c);const ee=URL.createObjectURL(K);u(ee),n(K)},W.start(100),o(!0),l(0);const H=Date.now();x.current=window.setInterval(()=>{const V=Math.floor((Date.now()-H)/1e3);l(V),V>=e&&M()},100)}catch(z){console.error("Error starting recording:",z),m("Failed to access microphone. Please check permissions.")}},[e,c,n]),M=O.useCallback(()=>{x.current&&(clearInterval(x.current),x.current=null),T.current&&T.current.state==="recording"&&T.current.stop(),o(!1)},[]),N=O.useCallback(()=>{c&&URL.revokeObjectURL(c),u(null),l(0),n(null)},[c,n]),D=O.useCallback(async z=>{var H;const W=(H=z.target.files)==null?void 0:H[0];if(W){m(null),C(!0);try{if(!W.type.startsWith("audio/"))throw new Error("Please upload an audio file (MP3, WAV, etc.)");const V=await aV(W),K=await lV(V);if(t>0&&K<t)throw new Error(`Audio must be at least ${t} seconds long`);if(K>e)throw new Error(`Audio must be less than ${e} seconds long`);l(Math.floor(K)),c&&URL.revokeObjectURL(c);const ee=URL.createObjectURL(V);u(ee),n(V)}catch(V){console.error("Error processing audio file:",V),m(V instanceof Error?V.message:"Failed to process audio file")}finally{C(!1),b.current&&(b.current.value="")}}},[c,e,t,n]),j=z=>{const W=Math.floor(z/60),H=z%60;return`${W}:${H.toString().padStart(2,"0")}`},F=a>=t;return g.jsxs("div",{className:"space-y-3",children:[h&&g.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:h}),g.jsxs("div",{className:"flex items-center gap-3",children:[s?g.jsxs("button",{onClick:M,disabled:!F,className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${F?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})}),"Stop Recording"]}):g.jsxs(g.Fragment,{children:[g.jsxs("button",{onClick:I,disabled:r||v,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("circle",{cx:"12",cy:"12",r:"6"})}),"Record"]}),g.jsx("span",{className:"text-gray-400 text-sm",children:"or"}),g.jsxs("label",{className:`flex items-center gap-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer ${r||v?"opacity-50 cursor-not-allowed":""}`,children:[g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),v?"Processing...":"Upload",g.jsx("input",{ref:b,type:"file",accept:"audio/*",onChange:D,disabled:r||v,className:"hidden"})]})]}),g.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s&&g.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),g.jsxs("span",{className:"font-mono text-lg",children:[j(a)," / ",j(e)]})]}),c&&!s&&g.jsx("button",{onClick:N,className:"px-3 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),s&&t>0&&a<t&&g.jsxs("p",{className:"text-sm text-yellow-600",children:["Minimum recording length: ",j(t)]}),c&&!s&&g.jsx("div",{className:"mt-3",children:g.jsx("audio",{src:c,controls:!0,className:"w-full"})})]})}async function oV(n){const e=new AudioContext({sampleRate:16e3});try{const t=await n.arrayBuffer(),r=await e.decodeAudioData(t),i=r.getChannelData(0),s=r.sampleRate,o=xF(i,s);return new Blob([o],{type:"audio/wav"})}finally{await e.close()}}function xF(n,e){const t=new ArrayBuffer(44+n.length*2),r=new DataView(t);pC(r,0,"RIFF"),r.setUint32(4,36+n.length*2,!0),pC(r,8,"WAVE"),pC(r,12,"fmt "),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,1,!0),r.setUint32(24,e,!0),r.setUint32(28,e*2,!0),r.setUint16(32,2,!0),r.setUint16(34,16,!0),pC(r,36,"data"),r.setUint32(40,n.length*2,!0);let i=44;for(let s=0;s<n.length;s++,i+=2){const o=Math.max(-1,Math.min(1,n[s]));r.setInt16(i,o<0?o*32768:o*32767,!0)}return t}function pC(n,e,t){for(let r=0;r<t.length;r++)n.setUint8(e+r,t.charCodeAt(r))}async function aV(n){const e=new AudioContext({sampleRate:16e3});try{const t=await n.arrayBuffer(),r=await e.decodeAudioData(t),i=r.getChannelData(0),s=r.sampleRate,o=xF(i,s);return new Blob([o],{type:"audio/wav"})}finally{await e.close()}}function lV(n){return new Promise((e,t)=>{const r=new Audio;r.onloadedmetadata=()=>{e(r.duration),URL.revokeObjectURL(r.src)},r.onerror=()=>{URL.revokeObjectURL(r.src),t(new Error("Failed to load audio"))},r.src=URL.createObjectURL(n)})}function cV({settings:n,onSettingsChange:e,isConfigured:t,history:r,addToHistory:i,removeFromHistory:s,clearHistory:o}){const[a,l]=O.useState("realtime"),[c,u]=O.useState("auto"),[h,m]=O.useState(null),[v,C]=O.useState(""),[T,E]=O.useState(!1),[x,P]=O.useState(!1),[b,I]=O.useState(2),[M,N]=O.useState(""),D=k9(n),j=N9(n),F=D9(n),z=W9(n),H=(()=>{switch(a){case"realtime":return D;case"fast-transcription":return j;case"llm-speech":return z;case"whisper":return F}})();O.useEffect(()=>{if(H.state==="completed"&&h){const J=a==="realtime"&&D.transcript?{text:D.transcript.text,segments:D.transcript.segments}:a==="fast-transcription"&&j.transcript?{text:j.transcript.fullText,segments:j.transcript.segments}:a==="llm-speech"&&z.transcript?{text:z.transcript.fullText,segments:z.transcript.segments}:a==="whisper"&&F.transcript?{text:F.transcript.fullText,segments:F.transcript.segments}:null;J&&tT(h).then(de=>{i({timestamp:Date.now(),model:a,audioFileName:v||"audio",audioSize:h.size,audioDuration:de,language:c,transcript:J.text,processingTime:0,segments:J.segments})}).catch(de=>{console.error("Failed to get audio duration:",de)})}},[H.state,a,h,v,c,i]);const V=$=>{m($),C(($==null?void 0:$.name)||""),E(!1),H.reset()},K=$=>{$&&(m($),C("recording"),E(!0),H.reset())},ee=async()=>{if(h)try{a==="realtime"?await D.startRecognition(h,c):a==="fast-transcription"?await j.transcribe(h,c,{enableDiarization:x,maxSpeakers:b}):a==="llm-speech"?await z.transcribe(h,c,{enableDiarization:x,maxSpeakers:b,prompt:M.trim()?M.split(`
`).filter($=>$.trim()):void 0}):a==="whisper"&&await F.transcribe(h,c)}catch($){console.error("Transcription error:",$)}},G=()=>{a==="realtime"?D.stopRecognition():a==="whisper"&&F.cancelJob()},X=H.state==="processing"||H.state==="streaming",Y=H.state==="completed",ae=a==="realtime"&&D.transcript?{segments:D.transcript.segments,fullText:D.transcript.text,interimText:D.transcript.interimText,isStreaming:D.transcript.isStreaming,detectedLanguage:void 0}:a==="fast-transcription"&&j.transcript?{segments:j.transcript.segments,fullText:j.transcript.fullText,interimText:void 0,isStreaming:!1,detectedLanguage:j.transcript.language}:a==="llm-speech"&&z.transcript?{segments:z.transcript.segments,fullText:z.transcript.fullText,interimText:void 0,isStreaming:!1,detectedLanguage:z.transcript.language}:a==="whisper"&&F.transcript?{segments:F.transcript.segments,fullText:F.transcript.fullText,interimText:void 0,isStreaming:!1,detectedLanguage:F.transcript.language}:{segments:[],fullText:"",interimText:void 0,isStreaming:!1,detectedLanguage:void 0};return g.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[g.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 shadow-md",children:[g.jsx("h1",{className:"text-3xl font-bold",children:"Speech to Text"}),g.jsx("p",{className:"text-purple-100 mt-1",children:"Transcribe audio using Azure Speech Recognition APIs"})]}),g.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[g.jsx("div",{className:"flex-1 bg-gray-50 border-r border-gray-200 flex flex-col overflow-hidden",children:g.jsxs("div",{className:"flex-1 flex flex-col gap-6 p-6 overflow-y-auto",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Audio Source"}),g.jsx("div",{children:g.jsx(EF,{file:h instanceof File?h:null,onFileChange:V,disabled:!t})}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"absolute inset-0 flex items-center",children:g.jsx("div",{className:"w-full border-t border-gray-300"})}),g.jsx("div",{className:"relative flex justify-center text-sm",children:g.jsx("span",{className:"px-2 bg-gray-50 text-gray-500",children:"or"})})]}),g.jsx("div",{children:g.jsx(qw,{onRecordingComplete:K,shouldReset:!T})}),g.jsxs("div",{className:"space-y-2",children:[!t&&g.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:g.jsx("p",{className:"text-sm text-yellow-800",children:"Please configure your Azure API key and region in the settings to use Speech-to-Text."})}),H.error&&g.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:g.jsx("p",{className:"text-sm text-red-800",children:H.error})}),a==="whisper"&&F.pollingStatus&&!H.error&&g.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:g.jsx("p",{className:"text-sm text-blue-800",children:F.pollingStatus})}),g.jsx("button",{onClick:X?G:ee,disabled:!t||!h,className:`
                  w-full py-3 px-6 rounded-lg font-semibold text-white transition-all
                  ${X?"bg-red-600 hover:bg-red-700":"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700"}
                  disabled:opacity-50 disabled:cursor-not-allowed
                  flex items-center justify-center gap-2
                `,children:X?g.jsxs(g.Fragment,{children:[g.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),g.jsx("span",{children:"Cancel"})]}):g.jsxs(g.Fragment,{children:[g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})}),g.jsx("span",{children:"Transcribe Audio"})]})})]}),g.jsx(J9,{segments:ae.segments,fullText:ae.fullText,interimText:ae.interimText,isStreaming:ae.isStreaming,audioSource:h,detectedLanguage:ae.detectedLanguage,showConfidence:a!=="llm-speech"}),Y&&g.jsx(rV,{segments:ae.segments,filename:v||"transcript"})]})}),g.jsxs("div",{className:"w-full md:w-[400px] flex-shrink-0 bg-white border-l border-gray-200 flex flex-col overflow-hidden",children:[g.jsxs("div",{className:"flex-1 flex flex-col gap-6 p-6 overflow-y-auto",children:[g.jsx(G9,{selectedModel:a,onModelChange:$=>{l($),H.reset()},region:n.region}),g.jsx(Y9,{selectedLanguage:c,onLanguageChange:u,selectedModel:a}),(a==="fast-transcription"||a==="llm-speech")&&g.jsxs("div",{className:"space-y-3",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Speaker Diarization"}),g.jsxs("div",{className:"flex items-start",children:[g.jsx("input",{type:"checkbox",id:"enableDiarization",checked:x,onChange:$=>P($.target.checked),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),g.jsx("label",{htmlFor:"enableDiarization",className:"ml-2 block text-sm text-gray-700",children:"Identify different speakers in the audio"})]}),x&&g.jsxs("div",{className:"ml-6 space-y-2",children:[g.jsx("label",{htmlFor:"maxSpeakers",className:"block text-sm text-gray-700",children:"Maximum speakers"}),g.jsxs("select",{id:"maxSpeakers",value:b,onChange:$=>I(parseInt($.target.value)),className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[g.jsx("option",{value:2,children:"2 speakers"}),g.jsx("option",{value:3,children:"3 speakers"}),g.jsx("option",{value:4,children:"4 speakers"}),g.jsx("option",{value:5,children:"5 speakers"}),g.jsx("option",{value:6,children:"6 speakers"}),g.jsx("option",{value:8,children:"8 speakers"}),g.jsx("option",{value:10,children:"10 speakers"})]}),g.jsx("p",{className:"text-xs text-gray-500",children:"Set the maximum number of speakers expected in the audio"})]})]}),a==="llm-speech"&&g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{htmlFor:"llmPrompt",className:"block text-sm font-medium text-gray-700",children:"LLM Prompt (Optional)"}),g.jsx("textarea",{id:"llmPrompt",value:M,onChange:$=>N($.target.value),placeholder:`Example: Output must be in lexical format.
Include all technical terms.
Preserve punctuation.`,rows:3,className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm font-mono text-xs"}),g.jsx("p",{className:"text-xs text-gray-500",children:"Add custom instructions for the LLM to guide transcription output format and style. Each line becomes a separate prompt instruction."})]})]}),g.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:g.jsx("p",{className:"text-xs text-gray-600",children:"Powered by Azure Speech Services - Realtime, Fast Transcription, and Whisper APIs"})})]})]})]})}const wF=[{name:"en-US-AmandaMultilingualNeural",displayName:"Amanda",gender:"Female"},{name:"en-US-AvaMultilingualNeural",displayName:"Ava",gender:"Female"},{name:"en-US-CoraMultilingualNeural",displayName:"Cora",gender:"Female"},{name:"en-US-EmmaMultilingualNeural",displayName:"Emma",gender:"Female"},{name:"en-US-EvelynMultilingualNeural",displayName:"Evelyn",gender:"Female"},{name:"en-US-JennyMultilingualNeural",displayName:"Jenny",gender:"Female"},{name:"en-US-LolaMultilingualNeural",displayName:"Lola",gender:"Female"},{name:"en-US-NancyMultilingualNeural",displayName:"Nancy",gender:"Female"},{name:"en-US-NovaTurboMultilingualNeural",displayName:"Nova (Turbo)",gender:"Female"},{name:"en-US-PhoebeMultilingualNeural",displayName:"Phoebe",gender:"Female"},{name:"en-US-SerenaMultilingualNeural",displayName:"Serena",gender:"Female"},{name:"en-US-ShimmerTurboMultilingualNeural",displayName:"Shimmer (Turbo)",gender:"Female"},{name:"en-US-AdamMultilingualNeural",displayName:"Adam",gender:"Male"},{name:"en-US-AlloyTurboMultilingualNeural",displayName:"Alloy (Turbo)",gender:"Male"},{name:"en-US-AndrewMultilingualNeural",displayName:"Andrew",gender:"Male"},{name:"en-US-BrandonMultilingualNeural",displayName:"Brandon",gender:"Male"},{name:"en-US-BrianMultilingualNeural",displayName:"Brian",gender:"Male"},{name:"en-US-ChristopherMultilingualNeural",displayName:"Christopher",gender:"Male"},{name:"en-US-DavisMultilingualNeural",displayName:"Davis",gender:"Male"},{name:"en-US-DerekMultilingualNeural",displayName:"Derek",gender:"Male"},{name:"en-US-DustinMultilingualNeural",displayName:"Dustin",gender:"Male"},{name:"en-US-EchoTurboMultilingualNeural",displayName:"Echo (Turbo)",gender:"Male"},{name:"en-US-LewisMultilingualNeural",displayName:"Lewis",gender:"Male"},{name:"en-US-OnyxTurboMultilingualNeural",displayName:"Onyx (Turbo)",gender:"Male"},{name:"en-US-RyanMultilingualNeural",displayName:"Ryan",gender:"Male"},{name:"en-US-SamuelMultilingualNeural",displayName:"Samuel",gender:"Male"},{name:"en-US-SteffanMultilingualNeural",displayName:"Steffan",gender:"Male"},{name:"en-US-FableTurboMultilingualNeural",displayName:"Fable (Turbo)",gender:"Neutral"}];async function bF(n,e){const t=e.accountName.trim(),r=e.containerName.trim(),i=e.sasToken.trim(),s=Date.now(),o=n.name.replace(/[^a-zA-Z0-9.-]/g,"_"),a=`voice-conversion/${s}-${o}`,l=i.startsWith("?")?i:`?${i}`,c=`https://${t}.blob.core.windows.net/${r}/${a}${l}`;console.log("Uploading to blob URL:",c.split("?")[0]);const u=await n.arrayBuffer();let h;try{h=await fetch(c,{method:"PUT",headers:{"x-ms-blob-type":"BlockBlob","Content-Type":n.type||"application/octet-stream"},body:u})}catch(v){throw console.error("Blob upload fetch error:",v),new Error(`Failed to upload to blob storage. This is likely a CORS issue. Please enable CORS on your Azure Storage Account "${t}": Go to Azure Portal  Storage Account  Settings  Resource sharing (CORS)  Add rule with Allowed origins: *, Methods: GET,PUT,OPTIONS, Headers: *`)}if(!h.ok){const v=await h.text();throw new Error(`Failed to upload to blob storage: ${h.status} ${h.statusText}. ${v}`)}const m=`https://${t}.blob.core.windows.net/${r}/${a}${l}`;return console.log("Blob uploaded successfully:",m.split("?")[0]),m}function PF(n){return n.accountName.trim()?n.containerName.trim()?n.sasToken.trim()?null:"SAS Token is required":"Container Name is required":"Storage Account Name is required"}function RF(){try{const n=localStorage.getItem("azure-voice-blob-config");if(n)return JSON.parse(n)}catch(n){console.error("Failed to load blob config:",n)}return{accountName:"",containerName:"",sasToken:""}}function IF(n){try{localStorage.setItem("azure-voice-blob-config",JSON.stringify(n))}catch(e){console.error("Failed to save blob config:",e)}}function uV({apiKey:n,region:e}){const[t,r]=O.useState("idle"),[i,s]=O.useState(""),[o,a]=O.useState(null),l=O.useCallback(()=>{r("idle"),s(""),a(null)},[]),c=O.useCallback(async(u,h,m)=>{if(!n){s("Azure API Key is required"),r("error");return}if(!e){s("Azure Region is required"),r("error");return}const v=PF(m);if(v){s(v),r("error");return}const C=100*1024*1024;if(u.size>C){s("File size must be less than 100 MB"),r("error");return}try{r("uploading"),s(""),console.log("Uploading audio to blob storage...");const T=await bF(u,m);console.log("Audio uploaded, URL:",T.split("?")[0]),r("converting"),console.log("Starting voice conversion...");const E=T.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),x=`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="en-US"><voice name="${h.name}"><mstts:voiceconversion url="${E}"/></voice></speak>`;console.log("SSML:",x);const P=`https://${e}.tts.speech.microsoft.com/cognitiveservices/v1`,b=await fetch(P,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":n,"Content-Type":"application/ssml+xml","X-Microsoft-OutputFormat":"audio-24khz-48kbitrate-mono-mp3","User-Agent":"AzureVoicePlayground"},body:x});if(!b.ok){const M=await b.text();throw new Error(`Voice conversion failed: ${b.status} ${b.statusText}. ${M}`)}const I=await b.arrayBuffer();console.log("Voice conversion completed, audio size:",I.byteLength),a(I),r("idle")}catch(T){console.error("Voice conversion error:",T),s(T instanceof Error?T.message:"Voice conversion failed"),r("error")}},[n,e]);return{state:t,error:i,resultAudioData:o,convert:c,reset:l}}function dV({selectedVoice:n,onVoiceChange:e}){const[t,r]=O.useState(""),[i,s]=O.useState("All"),o=O.useMemo(()=>wF.filter(l=>{if(i!=="All"&&l.gender!==i)return!1;if(t){const c=t.toLowerCase();return l.displayName.toLowerCase().includes(c)||l.name.toLowerCase().includes(c)}return!0}),[t,i]),a=["All","Female","Male"];return g.jsxs("div",{className:"space-y-4",children:[g.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Target Voice"}),g.jsx("div",{className:"flex gap-2 flex-wrap",children:a.map(l=>g.jsx("button",{onClick:()=>s(l),className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${i===l?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:l},l))}),g.jsx("input",{type:"text",placeholder:"Search voices...",value:t,onChange:l=>r(l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),n&&g.jsxs("div",{className:"p-2 bg-blue-50 border border-blue-200 rounded-md",children:[g.jsx("div",{className:"text-xs text-blue-600 font-medium",children:"Selected:"}),g.jsx("div",{className:"text-sm text-blue-800 truncate",children:n.displayName})]}),g.jsx("div",{className:"max-h-96 overflow-y-auto border border-gray-200 rounded-md",children:o.length===0?g.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No voices found"}):o.map(l=>g.jsxs("button",{onClick:()=>e(l),className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${(n==null?void 0:n.name)===l.name?"bg-blue-50 border-l-4 border-l-blue-600":"hover:bg-gray-50"}`,children:[g.jsx("div",{className:"font-medium text-gray-800",children:l.displayName}),g.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[g.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs ${l.gender==="Female"?"bg-pink-100 text-pink-700":l.gender==="Male"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:l.gender}),g.jsx("span",{className:"text-gray-400",children:"en-US"})]})]},l.name))}),g.jsxs("div",{className:"text-xs text-gray-500",children:[o.length," voice",o.length!==1?"s":""," available"]})]})}function hV({history:n,onClearHistory:e,onDeleteEntry:t}){const[r,i]=O.useState(!1),s=()=>{i(!r)};return g.jsxs("div",{className:"border-t border-gray-200 bg-gray-50",children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-gray-100",onClick:s,children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Conversion History"}),n.length>0&&g.jsx("span",{className:"px-2 py-1 text-xs font-medium text-white bg-purple-600 rounded-full",children:n.length})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[n.length>0&&g.jsx("button",{onClick:o=>{o.stopPropagation(),window.confirm("Clear all conversion history?")&&e()},className:"px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors",children:"Clear All"}),g.jsx("button",{className:"p-1 text-gray-600",children:g.jsx("svg",{className:`w-5 h-5 transform transition-transform ${r?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),r&&g.jsx("div",{className:"px-4 pb-4 max-h-60 overflow-y-auto",children:n.length===0?g.jsxs("div",{className:"py-8 text-center text-gray-500",children:[g.jsx("p",{children:"No conversion history yet"}),g.jsx("p",{className:"text-sm mt-1",children:"Converted audio will appear here"})]}):g.jsx("div",{className:"space-y-2",children:[...n].reverse().map(o=>g.jsx(pV,{entry:o,onDelete:t},o.id))})})]})}function pV({entry:n,onDelete:e}){const[t,r]=O.useState(!1),i=O.useRef(null),s=O.useRef(null);O.useEffect(()=>{const h=new Blob([n.resultAudioData],{type:"audio/mpeg"}),m=URL.createObjectURL(h);return s.current=m,()=>{s.current&&URL.revokeObjectURL(s.current)}},[n.resultAudioData]);const o=()=>{i.current||(i.current=new Audio(s.current||""),i.current.addEventListener("ended",()=>{r(!1)})),t?(i.current.pause(),r(!1)):(i.current.play(),r(!0))},a=()=>{const h=new Date(n.timestamp).toISOString().replace(/[:.]/g,"-").slice(0,-5),m=n.targetVoice.replace(/[^a-zA-Z0-9-]/g,"_"),C=`voiceconversion-${n.sourceFileName.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9-]/g,"_")}-to-${m}-${h}.mp3`;vF(n.resultAudioData,C)},l=()=>{i.current&&(i.current.pause(),i.current=null),e(n.id)},c=new Date(n.timestamp).toLocaleTimeString(),u=n.targetVoice.replace("en-US-","").replace("MultilingualNeural","").replace("Turbo"," (Turbo)");return g.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border border-gray-200 rounded-md hover:bg-gray-50",children:[g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsxs("p",{className:"text-sm text-gray-800 truncate mb-1",children:[g.jsx("span",{className:"font-medium",children:n.sourceFileName}),g.jsx("span",{className:"text-gray-400 mx-2",children:""}),g.jsx("span",{className:"text-purple-600",children:u})]}),g.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[g.jsx("span",{children:c}),g.jsx("span",{children:""}),g.jsx("span",{children:n.region}),g.jsx("span",{children:""}),g.jsx("span",{children:yF(n.duration)})]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:o,className:"p-2 text-purple-600 hover:bg-purple-50 rounded-md transition-colors",title:t?"Pause":"Play",children:t?g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),g.jsx("button",{onClick:a,className:"p-2 text-green-600 hover:bg-green-50 rounded-md transition-colors",title:"Save as MP3",children:g.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:[g.jsx("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),g.jsx("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})]})}),g.jsx("button",{onClick:l,className:"p-2 text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z",clipRule:"evenodd"})})})]})]})}function fV({sourceFileName:n,targetVoice:e,region:t,audioData:r}){const i=async()=>{try{const s=`
Source File: ${n||"[No file selected]"}
Target Voice: ${e||"[No voice selected]"}
Region: ${t}

${r?"Please find the converted audio file attached (downloaded separately).":"[No conversion completed yet]"}
      `.trim(),o=encodeURIComponent(`Azure Voice Conversion Feedback - ${e||"No voice"}`),a=encodeURIComponent(s),l=`mailto:ttsvoicefeedback@microsoft.com?subject=${o}&body=${a}`;if(r){const c=new Blob([r],{type:"audio/mpeg"}),u=URL.createObjectURL(c),h=document.createElement("a");h.href=u,h.download=`conversion-${e||"output"}-${Date.now()}.mp3`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(u)}window.open(l,"_blank"),r&&alert("Audio file downloaded! Please attach it to your email before sending.")}catch(s){console.error("Error sending feedback:",s),alert("Error preparing feedback. Please try again.")}};return g.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200 text-sm font-medium",title:"Send feedback about voice conversion",children:[g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[g.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),g.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),"Send Feedback"]})}function mV({settings:n,onSettingsChange:e,isConfigured:t,history:r,addToHistory:i,removeFromHistory:s,clearHistory:o}){const[a,l]=O.useState(RF),[c,u]=O.useState(!1),[h,m]=O.useState(null),[v,C]=O.useState(wF[0]),[T,E]=O.useState(!1),x=O.useRef(null),P=O.useRef(null),b=O.useRef(null),{state:I,error:M,resultAudioData:N,convert:D,reset:j}=uV({apiKey:n.apiKey,region:n.region});O.useEffect(()=>{IF(a)},[a]),O.useEffect(()=>{N&&h&&v&&N!==b.current&&(b.current=N,tT(N).then(ee=>{i({timestamp:Date.now(),sourceFileName:h.name,targetVoice:v.name,region:n.region,resultAudioData:N,duration:ee})}).catch(ee=>{console.error("Failed to get audio duration:",ee);const G=N.byteLength*8/48e3;i({timestamp:Date.now(),sourceFileName:h.name,targetVoice:v.name,region:n.region,resultAudioData:N,duration:G})}))},[N,h,v,n.region,i]),O.useEffect(()=>{if(N){P.current&&URL.revokeObjectURL(P.current);const ee=new Blob([N],{type:"audio/mpeg"});P.current=URL.createObjectURL(ee)}return()=>{P.current&&URL.revokeObjectURL(P.current)}},[N]);const F=O.useCallback(()=>{!h||!v||D(h,v,a)},[h,v,a,D]),z=O.useCallback(()=>{P.current&&(x.current||(x.current=new Audio(P.current),x.current.addEventListener("ended",()=>{E(!1)})),T?(x.current.pause(),E(!1)):(x.current.play(),E(!0)))},[T]),W=a.accountName&&a.containerName&&a.sasToken,V=["eastus","westeurope","southeastasia"].includes(n.region.toLowerCase()),K=t&&V&&W&&h&&v&&(I==="idle"||I==="error");return g.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[g.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[g.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 shadow-md",children:[g.jsx("h1",{className:"text-3xl font-bold",children:"Voice Changer"}),g.jsx("p",{className:"text-purple-100 mt-1",children:"Transform your voice using Azure Voice Conversion (Preview)"})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[t&&!V&&g.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("svg",{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-semibold text-amber-800",children:"Region Not Supported"}),g.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Voice Changer is currently only available in the following regions:"}),g.jsxs("ul",{className:"text-sm text-amber-700 mt-2 list-disc list-inside",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"East US"})," (eastus)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"West Europe"})," (westeurope)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Southeast Asia"})," (southeastasia)"]})]}),g.jsxs("p",{className:"text-sm text-amber-700 mt-2",children:["Your current region is ",g.jsx("strong",{children:n.region}),". Please update your region in the sidebar settings."]})]})]})}),(!t||V)&&g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[g.jsxs("button",{onClick:()=>u(!c),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})}),g.jsx("span",{className:"font-medium text-gray-800",children:"Azure Blob Storage Configuration"}),W&&g.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded-full",children:"Configured"})]}),g.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${c?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),c&&g.jsxs("div",{className:"p-4 space-y-4 border-t border-gray-200",children:[g.jsxs("p",{className:"text-sm text-gray-600",children:["Voice conversion requires uploading audio to Azure Blob Storage.",g.jsx("a",{href:"https://portal.azure.com/#create/Microsoft.StorageAccount",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline ml-1",children:"Create a storage account"})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Storage Account Name"}),g.jsx("input",{type:"text",value:a.accountName,onChange:ee=>l(G=>({...G,accountName:ee.target.value})),placeholder:"mystorageaccount",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Container Name"}),g.jsx("input",{type:"text",value:a.containerName,onChange:ee=>l(G=>({...G,containerName:ee.target.value})),placeholder:"audio-files",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SAS Token"}),g.jsx("input",{type:"password",value:a.sasToken,onChange:ee=>l(G=>({...G,sasToken:ee.target.value})),placeholder:"?sv=2022-11-02&ss=b...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})]}),g.jsx("p",{className:"text-xs text-gray-500",children:"SAS token needs read and write permissions. Credentials are stored locally in your browser."}),g.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-md",children:[g.jsx("p",{className:"text-xs font-medium text-amber-800 mb-1",children:"CORS Configuration Required"}),g.jsx("p",{className:"text-xs text-amber-700",children:"In Azure Portal, go to your Storage Account  Resource sharing (CORS) and add a rule:"}),g.jsxs("ul",{className:"text-xs text-amber-700 mt-1 ml-4 list-disc",children:[g.jsxs("li",{children:["Allowed origins: ",g.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"*"})]}),g.jsxs("li",{children:["Allowed methods: ",g.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"GET, PUT, OPTIONS"})]}),g.jsxs("li",{children:["Allowed headers: ",g.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"*"})]})]})]})]})]}),g.jsx(EF,{file:h,onFileChange:m,disabled:I!=="idle"}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("button",{onClick:F,disabled:!K,className:`px-6 py-3 rounded-lg font-medium transition-colors ${K?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:I==="uploading"?"Uploading...":I==="converting"?"Converting...":"Convert Voice"}),!t&&g.jsx("p",{className:"text-sm text-amber-600",children:"Please configure Azure API key and region in the sidebar."}),t&&!W&&g.jsx("p",{className:"text-sm text-amber-600",children:"Please configure Blob Storage above."})]}),M&&g.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:[g.jsx("p",{className:"font-medium",children:"Error"}),g.jsx("p",{className:"text-sm",children:M})]}),N&&g.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("p",{className:"font-medium text-green-800",children:"Conversion Complete"}),g.jsxs("p",{className:"text-sm text-green-600",children:[h==null?void 0:h.name,"  ",v==null?void 0:v.displayName]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:z,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:T?g.jsxs(g.Fragment,{children:[g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}),"Pause"]}):g.jsxs(g.Fragment,{children:[g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})}),"Play Result"]})}),g.jsx("button",{onClick:j,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"New Conversion"})]})]})})]})]}),g.jsx(hV,{history:r,onClearHistory:o,onDeleteEntry:s}),g.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("p",{className:"text-xs text-gray-600",children:"Voice Conversion is a preview feature. Only en-US voices are supported. Zeroshot is also supported, contact us."}),g.jsx(fV,{sourceFileName:(h==null?void 0:h.name)||null,targetVoice:(v==null?void 0:v.displayName)||null,region:n.region,audioData:N})]})})]}),g.jsx("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 overflow-y-auto",children:g.jsx(dV,{selectedVoice:v,onVoiceChange:C})})]})}function pD(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function _F(n,e,t,r){const i=r.map(a=>a.toLowerCase()),o=n.split(`
`).filter(a=>a.trim()).map(a=>{const l=a.indexOf(":");if(l>0){const u=a.substring(0,l).trim().toLowerCase(),h=a.substring(l+1).trim();if(i.indexOf(u)>=0&&h)return`<mstts:turn speaker="${u}">${pD(h)}</mstts:turn>`}return a.trim()?`<mstts:turn speaker="${r[0].toLowerCase()}">${pD(a.trim())}</mstts:turn>`:""}).filter(a=>a).join(`
`);return`<speak xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" version="1.0" xml:lang="${t}">
<voice name="${e}">
<mstts:dialog>
${o}
</mstts:dialog>
</voice>
</speak>`}function gV({apiKey:n,region:e}){const[t,r]=O.useState("idle"),[i,s]=O.useState(""),[o,a]=O.useState(null),[l,c]=O.useState(""),u=O.useRef(null),h=O.useRef(null),m=O.useRef([]),v=O.useRef(0),C=O.useRef(!1),T=O.useRef(null),E=O.useCallback(M=>{u.current&&u.current.close(),console.log("Initializing multi-talker synthesizer with voice:",M);const N=jt.SpeechConfig.fromSubscription(n,e);N.speechSynthesisOutputFormat=jt.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3;const D=new jt.SpeakerAudioDestination;h.current=D;const j=jt.AudioConfig.fromSpeakerOutput(D),F=new jt.SpeechSynthesizer(N,j);return u.current=F,F},[n,e]),x=O.useCallback((M,N,D,j)=>{if(!M.trim()){s("Please enter some text to synthesize");return}if(!N){s("Please select a multi-talker voice");return}if(j.length===0){s("No speakers found in voice name");return}const F=_F(M,N,D,j);c(F),console.log("Generated SSML:",F),r("synthesizing"),s(""),m.current=[],C.current=!1;const z=E(N);z.synthesizing=(W,H)=>{H.result.audioData&&(m.current.push(new Uint8Array(H.result.audioData)),!C.current&&m.current.length===1&&(console.log("First audio chunk received - starting playback"),v.current=Date.now(),C.current=!0,r("playing")))},z.synthesisStarted=()=>{r("synthesizing"),console.log("Multi-talker synthesis started")},z.synthesisCompleted=(W,H)=>{const V=m.current.reduce((ce,ae)=>ce+ae.length,0),K=new Uint8Array(V);let ee=0;for(const ce of m.current)K.set(ce,ee),ee+=ce.length;a(K.buffer),console.log("Multi-talker synthesis completed - audio size:",V,"bytes");const G=V*8/48e3*1e3,X=Date.now()-v.current,Y=Math.max(100,G-X+300);console.log(`Estimated audio duration: ${G}ms, will stop in: ${Y}ms`),C.current||(v.current=Date.now(),C.current=!0,r("playing")),T.current&&clearTimeout(T.current),T.current=setTimeout(()=>{console.log("Audio playback ended"),C.current=!1,r("idle"),T.current=null},Y)},z.SynthesisCanceled=(W,H)=>{console.error("Multi-talker synthesis canceled:",H.errorDetails),s(H.errorDetails||"Synthesis was canceled"),r("error"),C.current=!1},z.speakSsmlAsync(F,W=>{W.reason===jt.ResultReason.SynthesizingAudioCompleted?console.log("Multi-talker synthesis completed successfully"):(console.error("Multi-talker synthesis failed:",W.errorDetails),s(W.errorDetails||"Synthesis failed"),r("error"))},W=>{console.error("Multi-talker synthesis error:",W),s(W),r("error")})},[E]),P=O.useCallback(()=>{h.current&&t==="playing"&&(h.current.pause(),r("paused"),C.current=!1)},[t]),b=O.useCallback(()=>{h.current&&t==="paused"&&(h.current.resume(),r("playing"),C.current=!0)},[t]),I=O.useCallback(()=>{console.log("Stop called - cleaning up"),C.current=!1,T.current&&(clearTimeout(T.current),T.current=null),h.current&&h.current.pause(),u.current&&(u.current.close(),u.current=null),r("idle")},[]);return{state:t,error:i,audioData:o,generatedSSML:l,synthesize:x,pause:P,resume:b,stop:I}}const fD=[{female:"ava",male:"andrew",display:"Ava & Andrew"},{female:"ava",male:"brian",display:"Ava & Brian"},{female:"ava",male:"davis",display:"Ava & Davis"},{female:"ava",male:"steffan",display:"Ava & Steffan"},{female:"ada",male:"andrew",display:"Ada & Andrew"},{female:"ada",male:"brian",display:"Ada & Brian"},{female:"ada",male:"davis",display:"Ada & Davis"},{female:"ada",male:"steffan",display:"Ada & Steffan"},{female:"emma",male:"andrew",display:"Emma & Andrew"},{female:"emma",male:"brian",display:"Emma & Brian"},{female:"emma",male:"davis",display:"Emma & Davis"},{female:"emma",male:"steffan",display:"Emma & Steffan"},{female:"jane",male:"andrew",display:"Jane & Andrew"},{female:"jane",male:"brian",display:"Jane & Brian"},{female:"jane",male:"davis",display:"Jane & Davis"},{female:"jane",male:"steffan",display:"Jane & Steffan"}];function vV({selectedPair:n,onPairChange:e}){const[t,r]=O.useState(""),i=O.useMemo(()=>{if(!t)return fD;const s=t.toLowerCase().trim();return fD.filter(o=>o.display.toLowerCase().includes(s)||o.female.toLowerCase().includes(s)||o.male.toLowerCase().includes(s))},[t]);return g.jsxs("div",{className:"h-full flex flex-col space-y-2",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Speaker Pair"}),g.jsx("input",{type:"text",placeholder:"Search speaker pairs...",value:t,onChange:s=>r(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),n&&g.jsxs("div",{className:"p-2 bg-purple-50 border border-purple-200 rounded-md flex-shrink-0",children:[g.jsx("div",{className:"text-xs text-purple-600 font-medium",children:"Selected:"}),g.jsx("div",{className:"text-sm text-purple-800 truncate",children:n.display})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto border border-gray-200 rounded-md min-h-0",children:[i.length===0&&g.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No speaker pairs found"}),i.map(s=>g.jsxs("button",{onClick:()=>e(s),className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${(n==null?void 0:n.female)===s.female&&(n==null?void 0:n.male)===s.male?"bg-purple-50 border-l-4 border-l-purple-600":"hover:bg-gray-50"}`,children:[g.jsx("div",{className:"font-medium text-gray-800 text-sm",children:s.display}),g.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[g.jsx("span",{className:"inline-block px-1.5 py-0.5 bg-purple-100 text-purple-700 rounded mr-2",children:"en-US"}),g.jsx("span",{className:"inline-block px-1.5 py-0.5 bg-pink-100 text-pink-700 rounded mr-1",children:s.female}),g.jsx("span",{className:"inline-block px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded",children:s.male})]})]},`${s.female}-${s.male}`))]}),g.jsxs("div",{className:"text-xs text-gray-500 flex-shrink-0 pt-2",children:[i.length," speaker pair",i.length!==1?"s":""," available"]})]})}function Wa(n){return n?{voiceName:"en-us-multitalker-set1:DragonHDLatestNeural",locale:"en-US",speakers:[n.female,n.male],displayName:n.display}:null}const Ew=[{locale:"zh-CN",language:"Chinese (Simplified)",speakers:["xiaochen","yunhan"],script:`xiaochen: !,
yunhan: !?
xiaochen: ,
yunhan: !?
xiaochen: ,
yunhan: ,?
xiaochen: !
yunhan: !!
xiaochen: !!
yunhan: !`},{locale:"en-US",language:"English (US)",speakers:["speaker1","speaker2"],script:`speaker1: Welcome to Tech Talk! I'm your host, and today we're diving into artificial intelligence.
speaker2: Thanks for having me! AI is such a fascinating topic these days.
speaker1: Absolutely! Can you explain what makes modern AI so powerful?
speaker2: Of course! The key is deep learning, which allows computers to learn patterns from massive amounts of data.
speaker1: That sounds incredible. What are some practical applications?
speaker2: We see AI everywhere now - voice assistants, recommendation systems, autonomous vehicles, and more.
speaker1: Amazing! What do you think the future holds for AI?
speaker2: I believe we'll see even more integration into daily life, making technology more intuitive and helpful.
speaker1: Thank you for sharing your insights!
speaker2: My pleasure! Thanks for having me on the show.`},{locale:"ja-JP",language:"Japanese",speakers:["speaker1","speaker2"],script:`speaker1: !
speaker2: !AI
speaker1: !AI?
speaker2: !
speaker1: ?
speaker2: AI
speaker1: !AI?
speaker2: 
speaker1: !
speaker2: `},{locale:"de-DE",language:"German",speakers:["speaker1","speaker2"],script:`speaker1: Willkommen bei Tech Talk! Heute sprechen wir ber knstliche Intelligenz.
speaker2: Danke fr die Einladung! KI ist wirklich ein faszinierendes Thema.
speaker1: Absolut! Knnen Sie erklren, was moderne KI so leistungsfhig macht?
speaker2: Natrlich! Der Schlssel ist Deep Learning, das es Computern ermglicht, Muster aus riesigen Datenmengen zu lernen.
speaker1: Das klingt unglaublich. Welche praktischen Anwendungen gibt es?
speaker2: Wir sehen KI berall - Sprachassistenten, Empfehlungssysteme, autonome Fahrzeuge und mehr.
speaker1: Erstaunlich! Was denken Sie, wie die Zukunft der KI aussieht?
speaker2: Ich glaube, wir werden noch mehr Integration in den Alltag sehen.
speaker1: Vielen Dank fr Ihre Einblicke!
speaker2: Gern geschehen! Danke fr die Einladung zur Sendung.`},{locale:"fr-FR",language:"French",speakers:["speaker1","speaker2"],script:`speaker1: Bienvenue sur Tech Talk! Aujourd'hui, nous parlons d'intelligence artificielle.
speaker2: Merci de m'avoir invit! L'IA est un sujet vraiment fascinant.
speaker1: Absolument! Pouvez-vous expliquer ce qui rend l'IA moderne si puissante?
speaker2: Bien sr! La cl est l'apprentissage profond, qui permet aux ordinateurs d'apprendre des modles  partir de grandes quantits de donnes.
speaker1: C'est incroyable. Quelles sont les applications pratiques?
speaker2: L'IA est partout maintenant - assistants vocaux, systmes de recommandation, vhicules autonomes et plus encore.
speaker1: Incroyable! Que pensez-vous de l'avenir de l'IA?
speaker2: Je pense que nous verrons encore plus d'intgration dans la vie quotidienne.
speaker1: Merci pour vos perspectives!
speaker2: Avec plaisir! Merci de m'avoir reu dans l'mission.`},{locale:"es-ES",language:"Spanish",speakers:["speaker1","speaker2"],script:`speaker1: Bienvenidos a Tech Talk! Hoy hablamos sobre inteligencia artificial.
speaker2: Gracias por invitarme! La IA es un tema realmente fascinante.
speaker1: Absolutamente! Puede explicar qu hace que la IA moderna sea tan poderosa?
speaker2: Por supuesto! La clave es el aprendizaje profundo, que permite a las computadoras aprender patrones de grandes cantidades de datos.
speaker1: Eso suena increble. Cules son las aplicaciones prcticas?
speaker2: La IA est en todas partes ahora: asistentes de voz, sistemas de recomendacin, vehculos autnomos y ms.
speaker1: Increble! Qu piensa sobre el futuro de la IA?
speaker2: Creo que veremos an ms integracin en la vida diaria.
speaker1: Gracias por compartir sus conocimientos!
speaker2: Con mucho gusto! Gracias por invitarme al programa.`},{locale:"pt-BR",language:"Portuguese (Brazil)",speakers:["speaker1","speaker2"],script:`speaker1: Bem-vindos ao Tech Talk! Hoje vamos falar sobre inteligncia artificial.
speaker2: Obrigado pelo convite! IA  um tema realmente fascinante.
speaker1: Com certeza! Voc pode explicar o que torna a IA moderna to poderosa?
speaker2: Claro! A chave  o aprendizado profundo, que permite aos computadores aprender padres de grandes quantidades de dados.
speaker1: Isso parece incrvel. Quais so as aplicaes prticas?
speaker2: A IA est em toda parte agora - assistentes de voz, sistemas de recomendao, veculos autnomos e muito mais.
speaker1: Incrvel! O que voc acha sobre o futuro da IA?
speaker2: Acredito que veremos ainda mais integrao na vida cotidiana.
speaker1: Obrigado por compartilhar seus conhecimentos!
speaker2: Foi um prazer! Obrigado por me receber no programa.`},{locale:"it-IT",language:"Italian",speakers:["speaker1","speaker2"],script:`speaker1: Benvenuti a Tech Talk! Oggi parliamo di intelligenza artificiale.
speaker2: Grazie per l'invito! L'IA  un argomento davvero affascinante.
speaker1: Assolutamente! Pu spiegare cosa rende l'IA moderna cos potente?
speaker2: Certo! La chiave  il deep learning, che permette ai computer di imparare modelli da grandi quantit di dati.
speaker1: Sembra incredibile. Quali sono le applicazioni pratiche?
speaker2: L'IA  ovunque ora - assistenti vocali, sistemi di raccomandazione, veicoli autonomi e altro ancora.
speaker1: Fantastico! Cosa pensa del futuro dell'IA?
speaker2: Credo che vedremo ancora pi integrazione nella vita quotidiana.
speaker1: Grazie per aver condiviso le sue intuizioni!
speaker2:  stato un piacere! Grazie per avermi invitato al programma.`},{locale:"ko-KR",language:"Korean",speakers:["speaker1","speaker2"],script:`speaker1:     !     .
speaker2:   ! AI   .
speaker1: !  AI     ?
speaker2: !  .         .
speaker1:  .      ?
speaker2: AI   .  ,  ,    .
speaker1: ! AI    ?
speaker2:         .
speaker1:    !
speaker2:  !    .`}];function mD(n,e){let t=n.script;return n.speakers.forEach((r,i)=>{if(i<e.length){const s=new RegExp(`^${r}:`,"gmi");t=t.replace(s,`${e[i]}:`)}}),t}var yV={34:((n,e,t)=>{var r=t(4901);n.exports=function(i){return typeof i=="object"?i!==null:r(i)}}),81:((n,e,t)=>{var r=t(9565),i=t(9306),s=t(8551),o=t(6823),a=t(851),l=TypeError;n.exports=function(c,u){var h=arguments.length<2?a(c):u;if(i(h))return s(r(h,c));throw new l(o(c)+" is not iterable")}}),116:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),c=t(9539),u=t(4549),h=u("find",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:h},{find:function(v){a(this);try{o(v)}catch(E){c(this,"throw",E)}if(h)return i(h,this,v);var C=l(this),T=0;return s(C,function(E,x){if(v(E,T++))return x(E)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})}),283:((n,e,t)=>{var r=t(9504),i=t(9039),s=t(4901),o=t(9297),a=t(3724),l=t(350).CONFIGURABLE,c=t(3706),u=t(1181),h=u.enforce,m=u.get,v=String,C=Object.defineProperty,T=r("".slice),E=r("".replace),x=r([].join),P=a&&!i(function(){return C(function(){},"length",{value:8}).length!==8}),b=String(String).split("String"),I=n.exports=function(M,N,D){T(v(N),0,7)==="Symbol("&&(N="["+E(v(N),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),D&&D.getter&&(N="get "+N),D&&D.setter&&(N="set "+N),(!o(M,"name")||l&&M.name!==N)&&(a?C(M,"name",{value:N,configurable:!0}):M.name=N),P&&D&&o(D,"arity")&&M.length!==D.arity&&C(M,"length",{value:D.arity});try{D&&o(D,"constructor")&&D.constructor?a&&C(M,"prototype",{writable:!1}):M.prototype&&(M.prototype=void 0)}catch{}var j=h(M);return o(j,"source")||(j.source=x(b,typeof N=="string"?N:"")),M};Function.prototype.toString=I(function(){return s(this)&&m(this).source||c(this)},"toString")}),350:((n,e,t)=>{var r=t(3724),i=t(9297),s=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,a=i(s,"name"),l=a&&(function(){}).name==="something",c=a&&(!r||r&&o(s,"name").configurable);n.exports={EXISTS:a,PROPER:l,CONFIGURABLE:c}}),397:((n,e,t)=>{var r=t(7751);n.exports=r("document","documentElement")}),421:(n=>{n.exports={}}),456:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(9504),o=t(4154),a=t(5169),l=s(1.1.toString),c=i.Uint8Array,u=!c||!c.prototype.toHex||!(function(){try{var h=new c([255,255,255,255,255,255,255,255]);return h.toHex()==="ffffffffffffffff"}catch{return!1}})();c&&r({target:"Uint8Array",proto:!0,forced:u},{toHex:function(){o(this),a(this.buffer);for(var m="",v=0,C=this.length;v<C;v++){var T=l(this[v],16);m+=T.length===1?"0"+T:T}return m}})}),507:((n,e,t)=>{var r=t(9565);n.exports=function(i,s,o){for(var a=o?i:i.iterator,l=i.next,c,u;!(c=r(l,a)).done;)if(u=s(c.value),u!==void 0)return u}}),531:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(9306),o=t(8551),a=t(1767),l=t(8646),c=t(9462),u=t(9539),h=t(6395),m=t(684),v=t(4549),C=!h&&!m("flatMap",function(){}),T=!h&&!C&&v("flatMap",TypeError),E=h||C||T,x=c(function(){for(var P=this.iterator,b=this.mapper,I,M;;){if(M=this.inner)try{if(I=o(i(M.next,M.iterator)),!I.done)return I.value;this.inner=null}catch(N){u(P,"throw",N)}if(I=o(i(this.next,P)),this.done=!!I.done)return;try{this.inner=l(b(I.value,this.counter++),!1)}catch(N){u(P,"throw",N)}}});r({target:"Iterator",proto:!0,real:!0,forced:E},{flatMap:function(b){o(this);try{s(b)}catch(I){u(this,"throw",I)}return T?i(T,this,b):new x(a(this),{mapper:b,inner:null})}})}),616:((n,e,t)=>{var r=t(9039);n.exports=!r(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")})}),655:((n,e,t)=>{var r=t(6955),i=String;n.exports=function(s){if(r(s)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return i(s)}}),679:((n,e,t)=>{var r=t(1625),i=TypeError;n.exports=function(s,o){if(r(o,s))return s;throw new i("Incorrect invocation")}}),684:(n=>{n.exports=function(e,t){var r=typeof Iterator=="function"&&Iterator.prototype[e];if(r)try{r.call({next:null},t).next()}catch{return!0}}}),741:(n=>{var e=Math.ceil,t=Math.floor;n.exports=Math.trunc||function(i){var s=+i;return(s>0?t:e)(s)}}),757:((n,e,t)=>{var r=t(7751),i=t(4901),s=t(1625),o=t(7040),a=Object;n.exports=o?function(l){return typeof l=="symbol"}:function(l){var c=r("Symbol");return i(c)&&s(c.prototype,a(l))}}),851:((n,e,t)=>{var r=t(6955),i=t(5966),s=t(4117),o=t(6269),a=t(8227),l=a("iterator");n.exports=function(c){if(!s(c))return i(c,l)||i(c,"@@iterator")||o[r(c)]}}),944:(n=>{var e=TypeError;n.exports=function(t){var r=t&&t.alphabet;if(r===void 0||r==="base64"||r==="base64url")return r||"base64";throw new e("Incorrect `alphabet` option")}}),1072:((n,e,t)=>{var r=t(1828),i=t(8727);n.exports=Object.keys||function(o){return r(o,i)}}),1103:(n=>{n.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}}),1108:((n,e,t)=>{var r=t(6955);n.exports=function(i){var s=r(i);return s==="BigInt64Array"||s==="BigUint64Array"}}),1148:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),c=t(9539),u=t(4549),h=u("every",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:h},{every:function(v){a(this);try{o(v)}catch(E){c(this,"throw",E)}if(h)return i(h,this,v);var C=l(this),T=0;return!s(C,function(E,x){if(!v(E,T++))return x()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),1181:((n,e,t)=>{var r=t(8622),i=t(4576),s=t(34),o=t(6699),a=t(9297),l=t(7629),c=t(6119),u=t(421),h="Object already initialized",m=i.TypeError,v=i.WeakMap,C,T,E,x=function(M){return E(M)?T(M):C(M,{})},P=function(M){return function(N){var D;if(!s(N)||(D=T(N)).type!==M)throw new m("Incompatible receiver, "+M+" required");return D}};if(r||l.state){var b=l.state||(l.state=new v);b.get=b.get,b.has=b.has,b.set=b.set,C=function(M,N){if(b.has(M))throw new m(h);return N.facade=M,b.set(M,N),N},T=function(M){return b.get(M)||{}},E=function(M){return b.has(M)}}else{var I=c("state");u[I]=!0,C=function(M,N){if(a(M,I))throw new m(h);return N.facade=M,o(M,I,N),N},T=function(M){return a(M,I)?M[I]:{}},E=function(M){return a(M,I)}}n.exports={set:C,get:T,has:E,enforce:x,getterFor:P}}),1291:((n,e,t)=>{var r=t(741);n.exports=function(i){var s=+i;return s!==s||s===0?0:r(s)}}),1385:((n,e,t)=>{var r=t(9539);n.exports=function(i,s,o){for(var a=i.length-1;a>=0;a--)if(i[a]!==void 0)try{o=r(i[a].iterator,s,o)}catch(l){s="throw",o=l}if(s==="throw")throw o;return o}}),1548:((n,e,t)=>{var r=t(4576),i=t(9039),s=t(9519),o=t(4215),a=r.structuredClone;n.exports=!!a&&!i(function(){if(o==="DENO"&&s>92||o==="NODE"&&s>94||o==="BROWSER"&&s>97)return!1;var l=new ArrayBuffer(8),c=a(l,{transfer:[l]});return l.byteLength!==0||c.byteLength!==8})}),1549:((n,e,t)=>{t(6632)}),1625:((n,e,t)=>{var r=t(9504);n.exports=r({}.isPrototypeOf)}),1689:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(8745),o=t(7680),a=t(6043),l=t(9306),c=t(1103),u=i.Promise,h=!1,m=!u||!u.try||c(function(){u.try(function(v){h=v===8},8)}).error||!h;r({target:"Promise",stat:!0,forced:m},{try:function(v){var C=arguments.length>1?o(arguments,1):[],T=a.f(this),E=c(function(){return s(l(v),void 0,C)});return(E.error?T.reject:T.resolve)(E.value),T.promise}})}),1698:((n,e,t)=>{var r=t(6518),i=t(4204),s=t(9835),o=t(4916),a=!o("union")||!s("union");r({target:"Set",proto:!0,real:!0,forced:a},{union:i})}),1701:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(9306),o=t(8551),a=t(1767),l=t(9462),c=t(6319),u=t(9539),h=t(684),m=t(4549),v=t(6395),C=!v&&!h("map",function(){}),T=!v&&!C&&m("map",TypeError),E=v||C||T,x=l(function(){var P=this.iterator,b=o(i(this.next,P)),I=this.done=!!b.done;if(!I)return c(P,this.mapper,[b.value,this.counter++],!0)});r({target:"Iterator",proto:!0,real:!0,forced:E},{map:function(b){o(this);try{s(b)}catch(I){u(this,"throw",I)}return T?i(T,this,b):new x(a(this),{mapper:b})}})}),1767:(n=>{n.exports=function(e){return{iterator:e,next:e.next,done:!1}}}),1828:((n,e,t)=>{var r=t(9504),i=t(9297),s=t(5397),o=t(9617).indexOf,a=t(421),l=r([].push);n.exports=function(c,u){var h=s(c),m=0,v=[],C;for(C in h)!i(a,C)&&i(h,C)&&l(v,C);for(;u.length>m;)i(h,C=u[m++])&&(~o(v,C)||l(v,C));return v}}),2106:((n,e,t)=>{var r=t(283),i=t(4913);n.exports=function(s,o,a){return a.get&&r(a.get,o,{getter:!0}),a.set&&r(a.set,o,{setter:!0}),i.f(s,o,a)}}),2140:((n,e,t)=>{var r=t(8227),i=r("toStringTag"),s={};s[i]="z",n.exports=String(s)==="[object z]"}),2195:((n,e,t)=>{var r=t(9504),i=r({}.toString),s=r("".slice);n.exports=function(o){return s(i(o),8,-1)}}),2211:((n,e,t)=>{var r=t(9039);n.exports=!r(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})}),2303:((n,e,t)=>{var r=t(4576),i=t(9504),s=r.Uint8Array,o=r.SyntaxError,a=r.parseInt,l=Math.min,c=/[^\da-f]/i,u=i(c.exec),h=i("".slice);n.exports=function(m,v){var C=m.length;if(C%2!==0)throw new o("String should be an even number of characters");for(var T=v?l(v.length,C/2):C/2,E=v||new s(T),x=0,P=0;P<T;){var b=h(m,x,x+=2);if(u(c,b))throw new o("String should only contain hex characters");E[P++]=a(b,16)}return{bytes:E,read:x}}}),2360:((n,e,t)=>{var r=t(8551),i=t(6801),s=t(8727),o=t(421),a=t(397),l=t(4055),c=t(6119),u=">",h="<",m="prototype",v="script",C=c("IE_PROTO"),T=function(){},E=function(M){return h+v+u+M+h+"/"+v+u},x=function(M){M.write(E("")),M.close();var N=M.parentWindow.Object;return M=null,N},P=function(){var M=l("iframe"),N="java"+v+":",D;return M.style.display="none",a.appendChild(M),M.src=String(N),D=M.contentWindow.document,D.open(),D.write(E("document.F=Object")),D.close(),D.F},b,I=function(){try{b=new ActiveXObject("htmlfile")}catch{}I=typeof document<"u"?document.domain&&b?x(b):P():x(b);for(var M=s.length;M--;)delete I[m][s[M]];return I()};o[C]=!0,n.exports=Object.create||function(N,D){var j;return N!==null?(T[m]=r(N),j=new T,T[m]=null,j[C]=N):j=I(),D===void 0?j:i.f(j,D)}}),2475:((n,e,t)=>{var r=t(6518),i=t(8527),s=t(4916),o=!s("isSupersetOf",function(a){return!a});r({target:"Set",proto:!0,real:!0,forced:o},{isSupersetOf:i})}),2489:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(9306),o=t(8551),a=t(1767),l=t(9462),c=t(6319),u=t(6395),h=t(9539),m=t(684),v=t(4549),C=!u&&!m("filter",function(){}),T=!u&&!C&&v("filter",TypeError),E=u||C||T,x=l(function(){for(var P=this.iterator,b=this.predicate,I=this.next,M,N,D;;){if(M=o(i(I,P)),N=this.done=!!M.done,N)return;if(D=M.value,c(P,b,[D,this.counter++],!0))return D}});r({target:"Iterator",proto:!0,real:!0,forced:E},{filter:function(b){o(this);try{s(b)}catch(I){h(this,"throw",I)}return T?i(T,this,b):new x(a(this),{predicate:b})}})}),2529:(n=>{n.exports=function(e,t){return{value:e,done:t}}}),2603:((n,e,t)=>{var r=t(655);n.exports=function(i,s){return i===void 0?arguments.length<2?"":s:r(i)}}),2652:((n,e,t)=>{var r=t(6080),i=t(9565),s=t(8551),o=t(6823),a=t(4209),l=t(6198),c=t(1625),u=t(81),h=t(851),m=t(9539),v=TypeError,C=function(E,x){this.stopped=E,this.result=x},T=C.prototype;n.exports=function(E,x,P){var b=P&&P.that,I=!!(P&&P.AS_ENTRIES),M=!!(P&&P.IS_RECORD),N=!!(P&&P.IS_ITERATOR),D=!!(P&&P.INTERRUPTED),j=r(x,b),F,z,W,H,V,K,ee,G=function(Y){return F&&m(F,"normal"),new C(!0,Y)},X=function(Y){return I?(s(Y),D?j(Y[0],Y[1],G):j(Y[0],Y[1])):D?j(Y,G):j(Y)};if(M)F=E.iterator;else if(N)F=E;else{if(z=h(E),!z)throw new v(o(E)+" is not iterable");if(a(z)){for(W=0,H=l(E);H>W;W++)if(V=X(E[W]),V&&c(T,V))return V;return new C(!1)}F=u(E,z)}for(K=M?E.next:F.next;!(ee=i(K,F)).done;){try{V=X(ee.value)}catch(Y){m(F,"throw",Y)}if(typeof V=="object"&&V&&c(T,V))return V}return new C(!1)}}),2777:((n,e,t)=>{var r=t(9565),i=t(34),s=t(757),o=t(5966),a=t(4270),l=t(8227),c=TypeError,u=l("toPrimitive");n.exports=function(h,m){if(!i(h)||s(h))return h;var v=o(h,u),C;if(v){if(m===void 0&&(m="default"),C=r(v,h,m),!i(C)||s(C))return C;throw new c("Can't convert object to primitive value")}return m===void 0&&(m="number"),a(h,m)}}),2787:((n,e,t)=>{var r=t(9297),i=t(4901),s=t(8981),o=t(6119),a=t(2211),l=o("IE_PROTO"),c=Object,u=c.prototype;n.exports=a?c.getPrototypeOf:function(h){var m=s(h);if(r(m,l))return m[l];var v=m.constructor;return i(v)&&m instanceof v?v.prototype:m instanceof c?u:null}}),2796:((n,e,t)=>{var r=t(9039),i=t(4901),s=/#|\.prototype\./,o=function(h,m){var v=l[a(h)];return v===u?!0:v===c?!1:i(m)?r(m):!!m},a=o.normalize=function(h){return String(h).replace(s,".").toLowerCase()},l=o.data={},c=o.NATIVE="N",u=o.POLYFILL="P";n.exports=o}),2804:(n=>{var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=e+"+/",r=e+"-_",i=function(s){for(var o={},a=0;a<64;a++)o[s.charAt(a)]=a;return o};n.exports={i2c:t,c2i:i(t),i2cUrl:r,c2iUrl:i(r)}}),2812:(n=>{var e=TypeError;n.exports=function(t,r){if(t<r)throw new e("Not enough arguments");return t}}),2839:((n,e,t)=>{var r=t(4576),i=r.navigator,s=i&&i.userAgent;n.exports=s?String(s):""}),2967:((n,e,t)=>{var r=t(6706),i=t(34),s=t(7750),o=t(3506);n.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var a=!1,l={},c;try{c=r(Object.prototype,"__proto__","set"),c(l,[]),a=l instanceof Array}catch{}return function(h,m){return s(h),o(m),i(h)&&(a?c(h,m):h.__proto__=m),h}})():void 0)}),3068:((n,e,t)=>{var r=t(6518),i=t(9504),s=t(2652),o=RangeError,a=TypeError,l=1/0,c=NaN,u=Math.abs,h=Math.pow,m=i([].push),v=h(2,1023),C=h(2,53)-1,T=Number.MAX_VALUE,E=h(2,971),x={},P={},b={},I={},M={},N=function(D,j){var F=D+j,z=j-(F-D);return{hi:F,lo:z}};r({target:"Math",stat:!0},{sumPrecise:function(j){var F=[],z=0,W=I;switch(s(j,function(le){if(++z>=C)throw new o("Maximum allowed index exceeded");if(typeof le!="number")throw new a("Value is not a number");W!==x&&(le!==le?W=x:le===l?W=W===P?x:b:le===-l?W=W===b?x:P:(le!==0||1/le===l)&&(W===I||W===M)&&(W=M,m(F,le)))}),W){case x:return c;case P:return-l;case b:return l;case I:return-0}for(var H=[],V=0,K,ee,G,X,Y,ce,ae=0;ae<F.length;ae++){K=F[ae];for(var $=0,J=0;J<H.length;J++){if(ee=H[J],u(K)<u(ee)&&(ce=K,K=ee,ee=ce),G=N(K,ee),X=G.hi,Y=G.lo,u(X)===l){var de=X===l?1:-1;V+=de,K=K-de*v-de*v,u(K)<u(ee)&&(ce=K,K=ee,ee=ce),G=N(K,ee),X=G.hi,Y=G.lo}Y!==0&&(H[$++]=Y),K=X}H.length=$,K!==0&&m(H,K)}var me=H.length-1;if(X=0,Y=0,V!==0){var Te=me>=0?H[me]:0;if(me--,u(V)>1||V>0&&Te>0||V<0&&Te<0)return V>0?l:-l;if(G=N(V*v,Te/2),X=G.hi,Y=G.lo,Y*=2,u(2*X)===l)return X>0?X===v&&Y===-(E/2)&&me>=0&&H[me]<0?T:l:X===-v&&Y===E/2&&me>=0&&H[me]>0?-T:-l;Y!==0&&(H[++me]=Y,Y=0),X*=2}for(;me>=0&&(G=N(X,H[me--]),X=G.hi,Y=G.lo,Y===0););return me>=0&&(Y<0&&H[me]<0||Y>0&&H[me]>0)&&(ee=Y*2,K=X+ee,ee===K-X&&(X=K)),X}})}),3167:((n,e,t)=>{var r=t(4901),i=t(34),s=t(2967);n.exports=function(o,a,l){var c,u;return s&&r(c=a.constructor)&&c!==l&&i(u=c.prototype)&&u!==l.prototype&&s(o,u),o}}),3238:((n,e,t)=>{var r=t(4576),i=t(7811),s=t(7394),o=r.DataView;n.exports=function(a){if(!i||s(a)!==0)return!1;try{return new o(a),!1}catch{return!0}}}),3392:((n,e,t)=>{var r=t(9504),i=0,s=Math.random(),o=r(1.1.toString);n.exports=function(a){return"Symbol("+(a===void 0?"":a)+")_"+o(++i+s,36)}}),3440:((n,e,t)=>{var r=t(7080),i=t(4402),s=t(9286),o=t(5170),a=t(3789),l=t(8469),c=t(507),u=i.has,h=i.remove;n.exports=function(v){var C=r(this),T=a(v),E=s(C);return o(C)<=T.size?l(C,function(x){T.includes(x)&&h(E,x)}):c(T.getIterator(),function(x){u(E,x)&&h(E,x)}),E}}),3463:(n=>{var e=TypeError;n.exports=function(t){if(typeof t=="string")return t;throw new e("Argument is not a string")}}),3506:((n,e,t)=>{var r=t(3925),i=String,s=TypeError;n.exports=function(o){if(r(o))return o;throw new s("Can't set "+i(o)+" as a prototype")}}),3579:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),c=t(9539),u=t(4549),h=u("some",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:h},{some:function(v){a(this);try{o(v)}catch(E){c(this,"throw",E)}if(h)return i(h,this,v);var C=l(this),T=0;return s(C,function(E,x){if(v(E,T++))return x()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),3650:((n,e,t)=>{var r=t(7080),i=t(4402),s=t(9286),o=t(3789),a=t(507),l=i.add,c=i.has,u=i.remove;n.exports=function(m){var v=r(this),C=o(m).getIterator(),T=s(v);return a(C,function(E){c(v,E)?u(T,E):l(T,E)}),T}}),3706:((n,e,t)=>{var r=t(9504),i=t(4901),s=t(7629),o=r(Function.toString);i(s.inspectSource)||(s.inspectSource=function(a){return o(a)}),n.exports=s.inspectSource}),3717:((n,e)=>{e.f=Object.getOwnPropertySymbols}),3724:((n,e,t)=>{var r=t(9039);n.exports=!r(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})}),3789:((n,e,t)=>{var r=t(9306),i=t(8551),s=t(9565),o=t(1291),a=t(1767),l="Invalid size",c=RangeError,u=TypeError,h=Math.max,m=function(v,C){this.set=v,this.size=h(C,0),this.has=r(v.has),this.keys=r(v.keys)};m.prototype={getIterator:function(){return a(i(s(this.keys,this.set)))},includes:function(v){return s(this.has,this.set,v)}},n.exports=function(v){i(v);var C=+v.size;if(C!==C)throw new u(l);var T=o(C);if(T<0)throw new c(l);return new m(v,T)}}),3838:((n,e,t)=>{var r=t(7080),i=t(5170),s=t(8469),o=t(3789);n.exports=function(l){var c=r(this),u=o(l);return i(c)>u.size?!1:s(c,function(h){if(!u.includes(h))return!1},!0)!==!1}}),3853:((n,e,t)=>{var r=t(6518),i=t(4449),s=t(4916),o=!s("isDisjointFrom",function(a){return!a});r({target:"Set",proto:!0,real:!0,forced:o},{isDisjointFrom:i})}),3925:((n,e,t)=>{var r=t(34);n.exports=function(i){return r(i)||i===null}}),3972:((n,e,t)=>{var r=t(34),i=String,s=TypeError;n.exports=function(o){if(o===void 0||r(o))return o;throw new s(i(o)+" is not an object or undefined")}}),4055:((n,e,t)=>{var r=t(4576),i=t(34),s=r.document,o=i(s)&&i(s.createElement);n.exports=function(a){return o?s.createElement(a):{}}}),4114:((n,e,t)=>{var r=t(6518),i=t(8981),s=t(6198),o=t(4527),a=t(6837),l=t(9039),c=l(function(){return[].push.call({length:4294967296},1)!==4294967297}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(m){return m instanceof TypeError}},h=c||!u();r({target:"Array",proto:!0,arity:1,forced:h},{push:function(v){var C=i(this),T=s(C),E=arguments.length;a(T+E);for(var x=0;x<E;x++)C[T]=arguments[x],T++;return o(C,T),T}})}),4117:(n=>{n.exports=function(e){return e==null}}),4149:(n=>{var e=RangeError;n.exports=function(t){if(t===t)return t;throw new e("NaN is not allowed")}}),4154:((n,e,t)=>{var r=t(6955),i=TypeError;n.exports=function(s){if(r(s)==="Uint8Array")return s;throw new i("Argument is not an Uint8Array")}}),4204:((n,e,t)=>{var r=t(7080),i=t(4402).add,s=t(9286),o=t(3789),a=t(507);n.exports=function(c){var u=r(this),h=o(c).getIterator(),m=s(u);return a(h,function(v){i(m,v)}),m}}),4209:((n,e,t)=>{var r=t(8227),i=t(6269),s=r("iterator"),o=Array.prototype;n.exports=function(a){return a!==void 0&&(i.Array===a||o[s]===a)}}),4215:((n,e,t)=>{var r=t(4576),i=t(2839),s=t(2195),o=function(a){return i.slice(0,a.length)===a};n.exports=(function(){return o("Bun/")?"BUN":o("Cloudflare-Workers")?"CLOUDFLARE":o("Deno/")?"DENO":o("Node.js/")?"NODE":r.Bun&&typeof Bun.version=="string"?"BUN":r.Deno&&typeof Deno.version=="object"?"DENO":s(r.process)==="process"?"NODE":r.window&&r.document?"BROWSER":"REST"})()}),4226:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(3463),o=t(4154),a=t(5169),l=t(2303);i.Uint8Array&&r({target:"Uint8Array",proto:!0},{setFromHex:function(u){o(this),s(u),a(this.buffer);var h=l(u,this).read;return{read:h,written:h/2}}})}),4235:((n,e,t)=>{t(3068)}),4270:((n,e,t)=>{var r=t(9565),i=t(4901),s=t(34),o=TypeError;n.exports=function(a,l){var c,u;if(l==="string"&&i(c=a.toString)&&!s(u=r(c,a))||i(c=a.valueOf)&&!s(u=r(c,a))||l!=="string"&&i(c=a.toString)&&!s(u=r(c,a)))return u;throw new o("Can't convert object to primitive value")}}),4376:((n,e,t)=>{var r=t(2195);n.exports=Array.isArray||function(s){return r(s)==="Array"}}),4402:((n,e,t)=>{var r=t(9504),i=Set.prototype;n.exports={Set,add:r(i.add),has:r(i.has),remove:r(i.delete),proto:i}}),4449:((n,e,t)=>{var r=t(7080),i=t(4402).has,s=t(5170),o=t(3789),a=t(8469),l=t(507),c=t(9539);n.exports=function(h){var m=r(this),v=o(h);if(s(m)<=v.size)return a(m,function(T){if(v.includes(T))return!1},!0)!==!1;var C=v.getIterator();return l(C,function(T){if(i(m,T))return c(C,"normal",!1)})!==!1}}),4483:((n,e,t)=>{var r=t(4576),i=t(9429),s=t(1548),o=r.structuredClone,a=r.ArrayBuffer,l=r.MessageChannel,c=!1,u,h,m,v;if(s)c=function(C){o(C,{transfer:[C]})};else if(a)try{l||(u=i("worker_threads"),u&&(l=u.MessageChannel)),l&&(h=new l,m=new a(2),v=function(C){h.port1.postMessage(null,[C])},m.byteLength===2&&(v(m),m.byteLength===0&&(c=v)))}catch{}n.exports=c}),4495:((n,e,t)=>{var r=t(9519),i=t(9039),s=t(4576),o=s.String;n.exports=!!Object.getOwnPropertySymbols&&!i(function(){var a=Symbol("symbol detection");return!o(a)||!(Object(a)instanceof Symbol)||!Symbol.sham&&r&&r<41})}),4527:((n,e,t)=>{var r=t(3724),i=t(4376),s=TypeError,o=Object.getOwnPropertyDescriptor,a=r&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(l){return l instanceof TypeError}})();n.exports=a?function(l,c){if(i(l)&&!o(l,"length").writable)throw new s("Cannot set read only .length");return l.length=c}:function(l,c){return l.length=c}}),4549:((n,e,t)=>{var r=t(4576);n.exports=function(i,s){var o=r.Iterator,a=o&&o.prototype,l=a&&a[i],c=!1;if(l)try{l.call({next:function(){return{done:!0}},return:function(){c=!0}},-1)}catch(u){u instanceof s||(c=!1)}if(!c)return l}}),4576:(function(n){var e=function(t){return t&&t.Math===Math&&t};n.exports=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof global=="object"&&global)||e(typeof this=="object"&&this)||(function(){return this})()||Function("return this")()}),4603:((n,e,t)=>{var r=t(6840),i=t(9504),s=t(655),o=t(2812),a=URLSearchParams,l=a.prototype,c=i(l.append),u=i(l.delete),h=i(l.forEach),m=i([].push),v=new a("a=1&a=2&b=3");v.delete("a",1),v.delete("b",void 0),v+""!="a=2"&&r(l,"delete",function(C){var T=arguments.length,E=T<2?void 0:arguments[1];if(T&&E===void 0)return u(this,C);var x=[];h(this,function(F,z){m(x,{key:z,value:F})}),o(T,1);for(var P=s(C),b=s(E),I=0,M=0,N=!1,D=x.length,j;I<D;)j=x[I++],N||j.key===P?(N=!0,u(this,j.key)):M++;for(;M<D;)j=x[M++],j.key===P&&j.value===b||c(this,j.key,j.value)},{enumerable:!0,unsafe:!0})}),4628:((n,e,t)=>{var r=t(6518),i=t(6043);r({target:"Promise",stat:!0},{withResolvers:function(){var o=i.f(this);return{promise:o.promise,resolve:o.resolve,reject:o.reject}}})}),4644:((n,e,t)=>{var r=t(7811),i=t(3724),s=t(4576),o=t(4901),a=t(34),l=t(9297),c=t(6955),u=t(6823),h=t(6699),m=t(6840),v=t(2106),C=t(1625),T=t(2787),E=t(2967),x=t(8227),P=t(3392),b=t(1181),I=b.enforce,M=b.get,N=s.Int8Array,D=N&&N.prototype,j=s.Uint8ClampedArray,F=j&&j.prototype,z=N&&T(N),W=D&&T(D),H=Object.prototype,V=s.TypeError,K=x("toStringTag"),ee=P("TYPED_ARRAY_TAG"),G="TypedArrayConstructor",X=r&&!!E&&c(s.opera)!=="Opera",Y=!1,ce,ae,$,J={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},de={BigInt64Array:8,BigUint64Array:8},me=function(ne){if(!a(ne))return!1;var ve=c(ne);return ve==="DataView"||l(J,ve)||l(de,ve)},Te=function(pe){var ne=T(pe);if(a(ne)){var ve=M(ne);return ve&&l(ve,G)?ve[G]:Te(ne)}},le=function(pe){if(!a(pe))return!1;var ne=c(pe);return l(J,ne)||l(de,ne)},se=function(pe){if(le(pe))return pe;throw new V("Target is not a typed array")},ie=function(pe){if(o(pe)&&(!E||C(z,pe)))return pe;throw new V(u(pe)+" is not a typed array constructor")},Se=function(pe,ne,ve,ge){if(i){if(ve)for(var Ie in J){var fe=s[Ie];if(fe&&l(fe.prototype,pe))try{delete fe.prototype[pe]}catch{try{fe.prototype[pe]=ne}catch{}}}(!W[pe]||ve)&&m(W,pe,ve?ne:X&&D[pe]||ne,ge)}},re=function(pe,ne,ve){var ge,Ie;if(i){if(E){if(ve){for(ge in J)if(Ie=s[ge],Ie&&l(Ie,pe))try{delete Ie[pe]}catch{}}if(!z[pe]||ve)try{return m(z,pe,ve?ne:X&&z[pe]||ne)}catch{}else return}for(ge in J)Ie=s[ge],Ie&&(!Ie[pe]||ve)&&m(Ie,pe,ne)}};for(ce in J)ae=s[ce],$=ae&&ae.prototype,$?I($)[G]=ae:X=!1;for(ce in de)ae=s[ce],$=ae&&ae.prototype,$&&(I($)[G]=ae);if((!X||!o(z)||z===Function.prototype)&&(z=function(){throw new V("Incorrect invocation")},X))for(ce in J)s[ce]&&E(s[ce],z);if((!X||!W||W===H)&&(W=z.prototype,X))for(ce in J)s[ce]&&E(s[ce].prototype,W);if(X&&T(F)!==W&&E(F,W),i&&!l(W,K)){Y=!0,v(W,K,{configurable:!0,get:function(){return a(this)?this[ee]:void 0}});for(ce in J)s[ce]&&h(s[ce],ee,ce)}n.exports={NATIVE_ARRAY_BUFFER_VIEWS:X,TYPED_ARRAY_TAG:Y&&ee,aTypedArray:se,aTypedArrayConstructor:ie,exportTypedArrayMethod:Se,exportTypedArrayStaticMethod:re,getTypedArrayConstructor:Te,isView:me,isTypedArray:le,TypedArray:z,TypedArrayPrototype:W}}),4659:((n,e,t)=>{var r=t(3724),i=t(4913),s=t(6980);n.exports=function(o,a,l){r?i.f(o,a,s(0,l)):o[a]=l}}),4901:(n=>{var e=typeof document=="object"&&document.all;n.exports=typeof e>"u"&&e!==void 0?function(t){return typeof t=="function"||t===e}:function(t){return typeof t=="function"}}),4913:((n,e,t)=>{var r=t(3724),i=t(5917),s=t(8686),o=t(8551),a=t(6969),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",m="configurable",v="writable";e.f=r?s?function(T,E,x){if(o(T),E=a(E),o(x),typeof T=="function"&&E==="prototype"&&"value"in x&&v in x&&!x[v]){var P=u(T,E);P&&P[v]&&(T[E]=x.value,x={configurable:m in x?x[m]:P[m],enumerable:h in x?x[h]:P[h],writable:!1})}return c(T,E,x)}:c:function(T,E,x){if(o(T),E=a(E),o(x),i)try{return c(T,E,x)}catch{}if("get"in x||"set"in x)throw new l("Accessors not supported");return"value"in x&&(T[E]=x.value),T}}),4916:((n,e,t)=>{var r=t(7751),i=function(o){return{size:o,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},s=function(o){return{size:o,has:function(){return!0},keys:function(){throw new Error("e")}}};n.exports=function(o,a){var l=r("Set");try{new l()[o](i(0));try{return new l()[o](i(-1)),!1}catch{if(!a)return!0;try{return new l()[o](s(-1/0)),!1}catch{var c=new l([1,2]);return a(c[o](s(1/0)))}}}catch{return!1}}}),4972:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(8551),o=t(1767),a=t(4149),l=t(9590),c=t(9462),u=t(9539),h=t(4549),m=t(6395),v=!m&&h("take",RangeError),C=c(function(){var T=this.iterator;if(!this.remaining--)return this.done=!0,u(T,"normal",void 0);var E=s(i(this.next,T)),x=this.done=!!E.done;if(!x)return E.value});r({target:"Iterator",proto:!0,real:!0,forced:m||v},{take:function(E){s(this);var x;try{x=l(a(+E))}catch(P){u(this,"throw",P)}return v?i(v,this,x):new C(o(this),{remaining:x})}})}),4979:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(7751),o=t(6980),a=t(4913).f,l=t(9297),c=t(679),u=t(3167),h=t(2603),m=t(5002),v=t(8574),C=t(3724),T=t(6395),E="DOMException",x=s("Error"),P=s(E),b=function(){c(this,I);var G=arguments.length,X=h(G<1?void 0:arguments[0]),Y=h(G<2?void 0:arguments[1],"Error"),ce=new P(X,Y),ae=new x(X);return ae.name=E,a(ce,"stack",o(1,v(ae.stack,1))),u(ce,this,b),ce},I=b.prototype=P.prototype,M="stack"in new x(E),N="stack"in new P(1,2),D=P&&C&&Object.getOwnPropertyDescriptor(i,E),j=!!D&&!(D.writable&&D.configurable),F=M&&!j&&!N;r({global:!0,constructor:!0,forced:T||F},{DOMException:F?b:P});var z=s(E),W=z.prototype;if(W.constructor!==z){T||a(W,"constructor",o(1,z));for(var H in m)if(l(m,H)){var V=m[H],K=V.s;l(z,K)||a(z,K,o(6,V.c))}}}),5002:(n=>{n.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}}),5024:((n,e,t)=>{var r=t(6518),i=t(3650),s=t(9835),o=t(4916),a=!o("symmetricDifference")||!s("symmetricDifference");r({target:"Set",proto:!0,real:!0,forced:a},{symmetricDifference:i})}),5031:((n,e,t)=>{var r=t(7751),i=t(9504),s=t(8480),o=t(3717),a=t(8551),l=i([].concat);n.exports=r("Reflect","ownKeys")||function(u){var h=s.f(a(u)),m=o.f;return m?l(h,m(u)):h}}),5169:((n,e,t)=>{var r=t(3238),i=TypeError;n.exports=function(s){if(r(s))throw new i("ArrayBuffer is detached");return s}}),5170:((n,e,t)=>{var r=t(6706),i=t(4402);n.exports=r(i.proto,"size","get")||function(s){return s.size}}),5213:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(5370),o=t(9143),a=i.Uint8Array,l=!a||!a.fromBase64||!(function(){try{a.fromBase64("a");return}catch{}try{a.fromBase64("",null)}catch{return!0}})();a&&r({target:"Uint8Array",stat:!0,forced:l},{fromBase64:function(u){var h=o(u,arguments.length>1?arguments[1]:void 0,null,9007199254740991);return s(a,h.bytes)}})}),5370:((n,e,t)=>{var r=t(6198);n.exports=function(i,s,o){for(var a=0,l=arguments.length>2?o:r(s),c=new i(l);l>a;)c[a]=s[a++];return c}}),5397:((n,e,t)=>{var r=t(7055),i=t(7750);n.exports=function(s){return r(i(s))}}),5610:((n,e,t)=>{var r=t(1291),i=Math.max,s=Math.min;n.exports=function(o,a){var l=r(o);return l<0?i(l+a,0):s(l,a)}}),5623:((n,e,t)=>{t(456)}),5636:((n,e,t)=>{var r=t(4576),i=t(9504),s=t(6706),o=t(7696),a=t(5169),l=t(7394),c=t(4483),u=t(1548),h=r.structuredClone,m=r.ArrayBuffer,v=r.DataView,C=Math.min,T=m.prototype,E=v.prototype,x=i(T.slice),P=s(T,"resizable","get"),b=s(T,"maxByteLength","get"),I=i(E.getInt8),M=i(E.setInt8);n.exports=(u||c)&&function(N,D,j){var F=l(N),z=D===void 0?F:o(D),W=!P||!P(N),H;if(a(N),u&&(N=h(N,{transfer:[N]}),F===z&&(j||W)))return N;if(F>=z&&(!j||W))H=x(N,0,z);else{var V=j&&!W&&b?{maxByteLength:b(N)}:void 0;H=new m(z,V);for(var K=new v(N),ee=new v(H),G=C(z,F),X=0;X<G;X++)M(ee,X,I(K,X))}return u||c(N),H}}),5745:((n,e,t)=>{var r=t(7629);n.exports=function(i,s){return r[i]||(r[i]=s||{})}}),5781:((n,e,t)=>{var r=t(6518),i=t(7751),s=t(2812),o=t(655),a=t(7416),l=i("URL");r({target:"URL",stat:!0,forced:!a},{parse:function(u){var h=s(arguments.length,1),m=o(u),v=h<2||arguments[1]===void 0?void 0:o(arguments[1]);try{return new l(m,v)}catch{return null}}})}),5854:((n,e,t)=>{var r=t(2777),i=TypeError;n.exports=function(s){var o=r(s,"number");if(typeof o=="number")throw new i("Can't convert number to bigint");return BigInt(o)}}),5876:((n,e,t)=>{var r=t(6518),i=t(3838),s=t(4916),o=!s("isSubsetOf",function(a){return a});r({target:"Set",proto:!0,real:!0,forced:o},{isSubsetOf:i})}),5917:((n,e,t)=>{var r=t(3724),i=t(9039),s=t(4055);n.exports=!r&&!i(function(){return Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a!==7})}),5966:((n,e,t)=>{var r=t(9306),i=t(4117);n.exports=function(s,o){var a=s[o];return i(a)?void 0:r(a)}}),6043:((n,e,t)=>{var r=t(9306),i=TypeError,s=function(o){var a,l;this.promise=new o(function(c,u){if(a!==void 0||l!==void 0)throw new i("Bad Promise constructor");a=c,l=u}),this.resolve=r(a),this.reject=r(l)};n.exports.f=function(o){return new s(o)}}),6080:((n,e,t)=>{var r=t(7476),i=t(9306),s=t(616),o=r(r.bind);n.exports=function(a,l){return i(a),l===void 0?a:s?o(a,l):function(){return a.apply(l,arguments)}}}),6119:((n,e,t)=>{var r=t(5745),i=t(3392),s=r("keys");n.exports=function(o){return s[o]||(s[o]=i(o))}}),6193:((n,e,t)=>{var r=t(4215);n.exports=r==="NODE"}),6198:((n,e,t)=>{var r=t(8014);n.exports=function(i){return r(i.length)}}),6269:(n=>{n.exports={}}),6279:((n,e,t)=>{var r=t(6840);n.exports=function(i,s,o){for(var a in s)r(i,a,s[a],o);return i}}),6319:((n,e,t)=>{var r=t(8551),i=t(9539);n.exports=function(s,o,a,l){try{return l?o(r(a)[0],a[1]):o(a)}catch(c){i(s,"throw",c)}}}),6395:(n=>{n.exports=!1}),6518:((n,e,t)=>{var r=t(4576),i=t(7347).f,s=t(6699),o=t(6840),a=t(9433),l=t(7740),c=t(2796);n.exports=function(u,h){var m=u.target,v=u.global,C=u.stat,T,E,x,P,b,I;if(v?E=r:C?E=r[m]||a(m,{}):E=r[m]&&r[m].prototype,E)for(x in h){if(b=h[x],u.dontCallGetSet?(I=i(E,x),P=I&&I.value):P=E[x],T=c(v?x:m+(C?".":"#")+x,u.forced),!T&&P!==void 0){if(typeof b==typeof P)continue;l(b,P)}(u.sham||P&&P.sham)&&s(b,"sham",!0),o(E,x,b,u)}}}),6573:((n,e,t)=>{var r=t(3724),i=t(2106),s=t(3238),o=ArrayBuffer.prototype;r&&!("detached"in o)&&i(o,"detached",{configurable:!0,get:function(){return s(this)}})}),6632:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(9143),o=t(4154),a=i.Uint8Array,l=!a||!a.prototype.setFromBase64||!(function(){var c=new a([255,255,255,255,255]);try{c.setFromBase64("",null);return}catch{}try{c.setFromBase64("a");return}catch{}try{c.setFromBase64("MjYyZg===")}catch{return c[0]===50&&c[1]===54&&c[2]===50&&c[3]===255&&c[4]===255}})();a&&r({target:"Uint8Array",proto:!0,forced:l},{setFromBase64:function(u){o(this);var h=s(u,arguments.length>1?arguments[1]:void 0,this,this.length);return{read:h.read,written:h.written}}})}),6699:((n,e,t)=>{var r=t(3724),i=t(4913),s=t(6980);n.exports=r?function(o,a,l){return i.f(o,a,s(1,l))}:function(o,a,l){return o[a]=l,o}}),6706:((n,e,t)=>{var r=t(9504),i=t(9306);n.exports=function(s,o,a){try{return r(i(Object.getOwnPropertyDescriptor(s,o)[a]))}catch{}}}),6801:((n,e,t)=>{var r=t(3724),i=t(8686),s=t(4913),o=t(8551),a=t(5397),l=t(1072);e.f=r&&!i?Object.defineProperties:function(u,h){o(u);for(var m=a(h),v=l(h),C=v.length,T=0,E;C>T;)s.f(u,E=v[T++],m[E]);return u}}),6823:(n=>{var e=String;n.exports=function(t){try{return e(t)}catch{return"Object"}}}),6837:(n=>{var e=TypeError,t=9007199254740991;n.exports=function(r){if(r>t)throw e("Maximum allowed index exceeded");return r}}),6840:((n,e,t)=>{var r=t(4901),i=t(4913),s=t(283),o=t(9433);n.exports=function(a,l,c,u){u||(u={});var h=u.enumerable,m=u.name!==void 0?u.name:l;if(r(c)&&s(c,m,u),u.global)h?a[l]=c:o(l,c);else{try{u.unsafe?a[l]&&(h=!0):delete a[l]}catch{}h?a[l]=c:i.f(a,l,{value:c,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return a}}),6955:((n,e,t)=>{var r=t(2140),i=t(4901),s=t(2195),o=t(8227),a=o("toStringTag"),l=Object,c=s((function(){return arguments})())==="Arguments",u=function(h,m){try{return h[m]}catch{}};n.exports=r?s:function(h){var m,v,C;return h===void 0?"Undefined":h===null?"Null":typeof(v=u(m=l(h),a))=="string"?v:c?s(m):(C=s(m))==="Object"&&i(m.callee)?"Arguments":C}}),6969:((n,e,t)=>{var r=t(2777),i=t(757);n.exports=function(s){var o=r(s,"string");return i(o)?o:o+""}}),6980:(n=>{n.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}}),7040:((n,e,t)=>{var r=t(4495);n.exports=r&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}),7055:((n,e,t)=>{var r=t(9504),i=t(9039),s=t(2195),o=Object,a=r("".split);n.exports=i(function(){return!o("z").propertyIsEnumerable(0)})?function(l){return s(l)==="String"?a(l,""):o(l)}:o}),7080:((n,e,t)=>{var r=t(4402).has;n.exports=function(i){return r(i),i}}),7347:((n,e,t)=>{var r=t(3724),i=t(9565),s=t(8773),o=t(6980),a=t(5397),l=t(6969),c=t(9297),u=t(5917),h=Object.getOwnPropertyDescriptor;e.f=r?h:function(v,C){if(v=a(v),C=l(C),u)try{return h(v,C)}catch{}if(c(v,C))return o(!i(s.f,v,C),v[C])}}),7394:((n,e,t)=>{var r=t(4576),i=t(6706),s=t(2195),o=r.ArrayBuffer,a=r.TypeError;n.exports=o&&i(o.prototype,"byteLength","get")||function(l){if(s(l)!=="ArrayBuffer")throw new a("ArrayBuffer expected");return l.byteLength}}),7416:((n,e,t)=>{var r=t(9039),i=t(8227),s=t(3724),o=t(6395),a=i("iterator");n.exports=!r(function(){var l=new URL("b?a=1&b=2&c=3","https://a"),c=l.searchParams,u=new URLSearchParams("a=1&a=2&b=3"),h="";return l.pathname="c%20d",c.forEach(function(m,v){c.delete("b"),h+=v+m}),u.delete("a",2),u.delete("b",void 0),o&&(!l.toJSON||!u.has("a",1)||u.has("a",2)||!u.has("a",void 0)||u.has("b"))||!c.size&&(o||!s)||!c.sort||l.href!=="https://a/c%20d?a=1&c=3"||c.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!c[a]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://").host!=="xn--e1aybc"||new URL("https://a#").hash!=="#%D0%B1"||h!=="a1c3"||new URL("https://x",void 0).host!=="x"})}),7476:((n,e,t)=>{var r=t(2195),i=t(9504);n.exports=function(s){if(r(s)==="Function")return i(s)}}),7566:((n,e,t)=>{var r=t(6840),i=t(9504),s=t(655),o=t(2812),a=URLSearchParams,l=a.prototype,c=i(l.getAll),u=i(l.has),h=new a("a=1");(h.has("a",2)||!h.has("a",void 0))&&r(l,"has",function(v){var C=arguments.length,T=C<2?void 0:arguments[1];if(C&&T===void 0)return u(this,v);var E=c(this,v);o(C,1);for(var x=s(T),P=0;P<E.length;)if(E[P++]===x)return!0;return!1},{enumerable:!0,unsafe:!0})}),7588:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(2652),o=t(9306),a=t(8551),l=t(1767),c=t(9539),u=t(4549),h=u("forEach",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:h},{forEach:function(v){a(this);try{o(v)}catch(E){c(this,"throw",E)}if(h)return i(h,this,v);var C=l(this),T=0;s(C,function(E){v(E,T++)},{IS_RECORD:!0})}})}),7629:((n,e,t)=>{var r=t(6395),i=t(4576),s=t(9433),o="__core-js_shared__",a=n.exports=i[o]||s(o,{});(a.versions||(a.versions=[])).push({version:"3.47.0",mode:r?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),7642:((n,e,t)=>{var r=t(6518),i=t(3440),s=t(9039),o=t(4916),a=!o("difference",function(c){return c.size===0}),l=a||s(function(){var c={size:1,has:function(){return!0},keys:function(){var h=0;return{next:function(){var m=h++>1;return u.has(1)&&u.clear(),{done:m,value:2}}}}},u=new Set([1,2,3,4]);return u.difference(c).size!==3});r({target:"Set",proto:!0,real:!0,forced:l},{difference:i})}),7657:((n,e,t)=>{var r=t(9039),i=t(4901),s=t(34),o=t(2360),a=t(2787),l=t(6840),c=t(8227),u=t(6395),h=c("iterator"),m=!1,v,C,T;[].keys&&(T=[].keys(),"next"in T?(C=a(a(T)),C!==Object.prototype&&(v=C)):m=!0);var E=!s(v)||r(function(){var x={};return v[h].call(x)!==x});E?v={}:u&&(v=o(v)),i(v[h])||l(v,h,function(){return this}),n.exports={IteratorPrototype:v,BUGGY_SAFARI_ITERATORS:m}}),7680:((n,e,t)=>{var r=t(9504);n.exports=r([].slice)}),7696:((n,e,t)=>{var r=t(1291),i=t(8014),s=RangeError;n.exports=function(o){if(o===void 0)return 0;var a=r(o),l=i(a);if(a!==l)throw new s("Wrong length or index");return l}}),7740:((n,e,t)=>{var r=t(9297),i=t(5031),s=t(7347),o=t(4913);n.exports=function(a,l,c){for(var u=i(l),h=o.f,m=s.f,v=0;v<u.length;v++){var C=u[v];!r(a,C)&&!(c&&r(c,C))&&h(a,C,m(l,C))}}}),7750:((n,e,t)=>{var r=t(4117),i=TypeError;n.exports=function(s){if(r(s))throw new i("Can't call method on "+s);return s}}),7751:((n,e,t)=>{var r=t(4576),i=t(4901),s=function(o){return i(o)?o:void 0};n.exports=function(o,a){return arguments.length<2?s(r[o]):r[o]&&r[o][a]}}),7811:(n=>{n.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"}),7936:((n,e,t)=>{var r=t(6518),i=t(5636);i&&r({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return i(this,arguments.length?arguments[0]:void 0,!1)}})}),8004:((n,e,t)=>{var r=t(6518),i=t(9039),s=t(8750),o=t(4916),a=!o("intersection",function(l){return l.size===2&&l.has(1)&&l.has(2)})||i(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});r({target:"Set",proto:!0,real:!0,forced:a},{intersection:s})}),8014:((n,e,t)=>{var r=t(1291),i=Math.min;n.exports=function(s){var o=r(s);return o>0?i(o,9007199254740991):0}}),8100:((n,e,t)=>{var r=t(6518),i=t(5636);i&&r({target:"ArrayBuffer",proto:!0},{transfer:function(){return i(this,arguments.length?arguments[0]:void 0,!0)}})}),8111:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(679),o=t(8551),a=t(4901),l=t(2787),c=t(2106),u=t(4659),h=t(9039),m=t(9297),v=t(8227),C=t(7657).IteratorPrototype,T=t(3724),E=t(6395),x="constructor",P="Iterator",b=v("toStringTag"),I=TypeError,M=i[P],N=E||!a(M)||M.prototype!==C||!h(function(){M({})}),D=function(){if(s(this,C),l(this)===C)throw new I("Abstract class Iterator not directly constructable")},j=function(F,z){T?c(C,F,{configurable:!0,get:function(){return z},set:function(W){if(o(this),this===C)throw new I("You can't redefine this property");m(this,F)?this[F]=W:u(this,F,W)}}):C[F]=z};m(C,b)||j(b,P),(N||!m(C,x)||C[x]===Object)&&j(x,D),D.prototype=C,r({global:!0,constructor:!0,forced:N},{Iterator:D})}),8227:((n,e,t)=>{var r=t(4576),i=t(5745),s=t(9297),o=t(3392),a=t(4495),l=t(7040),c=r.Symbol,u=i("wks"),h=l?c.for||c:c&&c.withoutSetter||o;n.exports=function(m){return s(u,m)||(u[m]=a&&s(c,m)?c[m]:h("Symbol."+m)),u[m]}}),8235:((n,e,t)=>{var r=t(9504),i=t(9297),s=SyntaxError,o=parseInt,a=String.fromCharCode,l=r("".charAt),c=r("".slice),u=r(/./.exec),h={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},m=/^[\da-f]{4}$/i,v=/^[\u0000-\u001F]$/;n.exports=function(C,T){for(var E=!0,x="";T<C.length;){var P=l(C,T);if(P==="\\"){var b=c(C,T,T+2);if(i(h,b))x+=h[b],T+=2;else if(b==="\\u"){T+=2;var I=c(C,T,T+4);if(!u(m,I))throw new s("Bad Unicode escape at: "+T);x+=a(o(I,16)),T+=4}else throw new s('Unknown escape sequence: "'+b+'"')}else if(P==='"'){E=!1,T++;break}else{if(u(v,P))throw new s("Bad control character in string literal at: "+T);x+=P,T++}}if(E)throw new s("Unterminated string at: "+T);return{value:x,end:T}}}),8237:((n,e,t)=>{var r=t(6518),i=t(2652),s=t(9306),o=t(8551),a=t(1767),l=t(9539),c=t(4549),u=t(8745),h=t(9039),m=TypeError,v=h(function(){[].keys().reduce(function(){},void 0)}),C=!v&&c("reduce",m);r({target:"Iterator",proto:!0,real:!0,forced:v||C},{reduce:function(E){o(this);try{s(E)}catch(M){l(this,"throw",M)}var x=arguments.length<2,P=x?void 0:arguments[1];if(C)return u(C,this,x?[E]:[E,P]);var b=a(this),I=0;if(i(b,function(M){x?(x=!1,P=M):P=E(P,M,I),I++},{IS_RECORD:!0}),x)throw new m("Reduce of empty iterator with no initial value");return P}})}),8335:((n,e,t)=>{t(9112)}),8469:((n,e,t)=>{var r=t(9504),i=t(507),s=t(4402),o=s.Set,a=s.proto,l=r(a.forEach),c=r(a.keys),u=c(new o).next;n.exports=function(h,m,v){return v?i({iterator:c(h),next:u},m):l(h,m)}}),8480:((n,e,t)=>{var r=t(1828),i=t(8727),s=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(a){return r(a,s)}}),8527:((n,e,t)=>{var r=t(7080),i=t(4402).has,s=t(5170),o=t(3789),a=t(507),l=t(9539);n.exports=function(u){var h=r(this),m=o(u);if(s(h)<m.size)return!1;var v=m.getIterator();return a(v,function(C){if(!i(h,C))return l(v,"normal",!1)})!==!1}}),8551:((n,e,t)=>{var r=t(34),i=String,s=TypeError;n.exports=function(o){if(r(o))return o;throw new s(i(o)+" is not an object")}}),8574:((n,e,t)=>{var r=t(9504),i=Error,s=r("".replace),o=(function(c){return String(new i(c).stack)})("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,l=a.test(o);n.exports=function(c,u){if(l&&typeof c=="string"&&!i.prepareStackTrace)for(;u--;)c=s(c,a,"");return c}}),8622:((n,e,t)=>{var r=t(4576),i=t(4901),s=r.WeakMap;n.exports=i(s)&&/native code/.test(String(s))}),8646:((n,e,t)=>{var r=t(9565),i=t(8551),s=t(1767),o=t(851);n.exports=function(a,l){(!l||typeof a!="string")&&i(a);var c=o(a);return s(i(c!==void 0?r(c,a):a))}}),8686:((n,e,t)=>{var r=t(3724),i=t(9039);n.exports=r&&i(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})}),8721:((n,e,t)=>{var r=t(3724),i=t(9504),s=t(2106),o=URLSearchParams.prototype,a=i(o.forEach);r&&!("size"in o)&&s(o,"size",{get:function(){var c=0;return a(this,function(){c++}),c},configurable:!0,enumerable:!0})}),8727:(n=>{n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}),8745:((n,e,t)=>{var r=t(616),i=Function.prototype,s=i.apply,o=i.call;n.exports=typeof Reflect=="object"&&Reflect.apply||(r?o.bind(s):function(){return o.apply(s,arguments)})}),8750:((n,e,t)=>{var r=t(7080),i=t(4402),s=t(5170),o=t(3789),a=t(8469),l=t(507),c=i.Set,u=i.add,h=i.has;n.exports=function(v){var C=r(this),T=o(v),E=new c;return s(C)>T.size?l(T.getIterator(),function(x){h(C,x)&&u(E,x)}):a(C,function(x){T.includes(x)&&u(E,x)}),E}}),8773:((n,e)=>{var t={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!t.call({1:2},1);e.f=i?function(o){var a=r(this,o);return!!a&&a.enumerable}:t}),8981:((n,e,t)=>{var r=t(7750),i=Object;n.exports=function(s){return i(r(s))}}),9039:(n=>{n.exports=function(e){try{return!!e()}catch{return!0}}}),9112:((n,e,t)=>{var r=t(6518),i=t(3724),s=t(4576),o=t(7751),a=t(9504),l=t(9565),c=t(4901),u=t(34),h=t(4376),m=t(9297),v=t(655),C=t(6198),T=t(4659),E=t(9039),x=t(8235),P=t(4495),b=s.JSON,I=s.Number,M=s.SyntaxError,N=b&&b.parse,D=o("Object","keys"),j=Object.getOwnPropertyDescriptor,F=a("".charAt),z=a("".slice),W=a(/./.exec),H=a([].push),V=/^\d$/,K=/^[1-9]$/,ee=/^[\d-]$/,G=/^[\t\n\r ]$/,X=0,Y=1,ce=function(le,se){le=v(le);var ie=new de(le,0),Se=ie.parse(),re=Se.value,pe=ie.skip(G,Se.end);if(pe<le.length)throw new M('Unexpected extra character: "'+F(le,pe)+'" after the parsed data at: '+pe);return c(se)?ae({"":re},"",se,Se):re},ae=function(le,se,ie,Se){var re=le[se],pe=Se&&re===Se.value,ne=pe&&typeof Se.source=="string"?{source:Se.source}:{},ve,ge,Ie,fe,xe;if(u(re)){var $e=h(re),Ge=pe?Se.nodes:$e?[]:{};if($e)for(ve=Ge.length,Ie=C(re),fe=0;fe<Ie;fe++)$(re,fe,ae(re,""+fe,ie,fe<ve?Ge[fe]:void 0));else for(ge=D(re),Ie=C(ge),fe=0;fe<Ie;fe++)xe=ge[fe],$(re,xe,ae(re,xe,ie,m(Ge,xe)?Ge[xe]:void 0))}return l(ie,le,se,re,ne)},$=function(le,se,ie){if(i){var Se=j(le,se);if(Se&&!Se.configurable)return}ie===void 0?delete le[se]:T(le,se,ie)},J=function(le,se,ie,Se){this.value=le,this.end=se,this.source=ie,this.nodes=Se},de=function(le,se){this.source=le,this.index=se};de.prototype={fork:function(le){return new de(this.source,le)},parse:function(){var le=this.source,se=this.skip(G,this.index),ie=this.fork(se),Se=F(le,se);if(W(ee,Se))return ie.number();switch(Se){case"{":return ie.object();case"[":return ie.array();case'"':return ie.string();case"t":return ie.keyword(!0);case"f":return ie.keyword(!1);case"n":return ie.keyword(null)}throw new M('Unexpected character: "'+Se+'" at: '+se)},node:function(le,se,ie,Se,re){return new J(se,Se,le?null:z(this.source,ie,Se),re)},object:function(){for(var le=this.source,se=this.index+1,ie=!1,Se={},re={};se<le.length;){if(se=this.until(['"',"}"],se),F(le,se)==="}"&&!ie){se++;break}var pe=this.fork(se).string(),ne=pe.value;se=pe.end,se=this.until([":"],se)+1,se=this.skip(G,se),pe=this.fork(se).parse(),T(re,ne,pe),T(Se,ne,pe.value),se=this.until([",","}"],pe.end);var ve=F(le,se);if(ve===",")ie=!0,se++;else if(ve==="}"){se++;break}}return this.node(Y,Se,this.index,se,re)},array:function(){for(var le=this.source,se=this.index+1,ie=!1,Se=[],re=[];se<le.length;){if(se=this.skip(G,se),F(le,se)==="]"&&!ie){se++;break}var pe=this.fork(se).parse();if(H(re,pe),H(Se,pe.value),se=this.until([",","]"],pe.end),F(le,se)===",")ie=!0,se++;else if(F(le,se)==="]"){se++;break}}return this.node(Y,Se,this.index,se,re)},string:function(){var le=this.index,se=x(this.source,this.index+1);return this.node(X,se.value,le,se.end)},number:function(){var le=this.source,se=this.index,ie=se;if(F(le,ie)==="-"&&ie++,F(le,ie)==="0")ie++;else if(W(K,F(le,ie)))ie=this.skip(V,ie+1);else throw new M("Failed to parse number at: "+ie);if(F(le,ie)==="."&&(ie=this.skip(V,ie+1)),F(le,ie)==="e"||F(le,ie)==="E"){ie++,(F(le,ie)==="+"||F(le,ie)==="-")&&ie++;var Se=ie;if(ie=this.skip(V,ie),Se===ie)throw new M("Failed to parse number's exponent value at: "+ie)}return this.node(X,I(z(le,se,ie)),se,ie)},keyword:function(le){var se=""+le,ie=this.index,Se=ie+se.length;if(z(this.source,ie,Se)!==se)throw new M("Failed to parse value at: "+ie);return this.node(X,le,ie,Se)},skip:function(le,se){for(var ie=this.source;se<ie.length&&W(le,F(ie,se));se++);return se},until:function(le,se){se=this.skip(G,se);for(var ie=F(this.source,se),Se=0;Se<le.length;Se++)if(le[Se]===ie)return se;throw new M('Unexpected character: "'+ie+'" at: '+se)}};var me=E(function(){var le="9007199254740993",se;return N(le,function(ie,Se,re){se=re.source}),se!==le}),Te=P&&!E(function(){return 1/N("-0 	")!==-1/0});r({target:"JSON",stat:!0,forced:me},{parse:function(se,ie){return Te&&!c(ie)?N(se):ce(se,ie)}})}),9143:((n,e,t)=>{var r=t(4576),i=t(9504),s=t(3972),o=t(3463),a=t(9297),l=t(2804),c=t(944),u=t(5169),h=l.c2i,m=l.c2iUrl,v=r.SyntaxError,C=r.TypeError,T=i("".charAt),E=function(b,I){for(var M=b.length;I<M;I++){var N=T(b,I);if(N!==" "&&N!=="	"&&N!==`
`&&N!=="\f"&&N!=="\r")break}return I},x=function(b,I,M){var N=b.length;N<4&&(b+=N===2?"AA":"A");var D=(I[T(b,0)]<<18)+(I[T(b,1)]<<12)+(I[T(b,2)]<<6)+I[T(b,3)],j=[D>>16&255,D>>8&255,D&255];if(N===2){if(M&&j[1]!==0)throw new v("Extra bits");return[j[0]]}if(N===3){if(M&&j[2]!==0)throw new v("Extra bits");return[j[0],j[1]]}return j},P=function(b,I,M){for(var N=I.length,D=0;D<N;D++)b[M+D]=I[D];return M+N};n.exports=function(b,I,M,N){o(b),s(I);var D=c(I)==="base64"?h:m,j=I?I.lastChunkHandling:void 0;if(j===void 0&&(j="loose"),j!=="loose"&&j!=="strict"&&j!=="stop-before-partial")throw new C("Incorrect `lastChunkHandling` option");M&&u(M.buffer);var F=b.length,z=M||[],W=0,H=0,V="",K=0;if(N)for(;;){if(K=E(b,K),K===F){if(V.length>0){if(j==="stop-before-partial")break;if(j==="loose"){if(V.length===1)throw new v("Malformed padding: exactly one additional character");W=P(z,x(V,D,!1),W)}else throw new v("Missing padding")}H=F;break}var ee=T(b,K);if(++K,ee==="="){if(V.length<2)throw new v("Padding is too early");if(K=E(b,K),V.length===2){if(K===F){if(j==="stop-before-partial")break;throw new v("Malformed padding: only one =")}T(b,K)==="="&&(++K,K=E(b,K))}if(K<F)throw new v("Unexpected character after padding");W=P(z,x(V,D,j==="strict"),W),H=F;break}if(!a(D,ee))throw new v("Unexpected character");var G=N-W;if(G===1&&V.length===2||G===2&&V.length===3||(V+=ee,V.length===4&&(W=P(z,x(V,D,!1),W),V="",H=K,W===N)))break}return{bytes:z,read:H,written:W}}}),9286:((n,e,t)=>{var r=t(4402),i=t(8469),s=r.Set,o=r.add;n.exports=function(a){var l=new s;return i(a,function(c){o(l,c)}),l}}),9297:((n,e,t)=>{var r=t(9504),i=t(8981),s=r({}.hasOwnProperty);n.exports=Object.hasOwn||function(a,l){return s(i(a),l)}}),9306:((n,e,t)=>{var r=t(4901),i=t(6823),s=TypeError;n.exports=function(o){if(r(o))return o;throw new s(i(o)+" is not a function")}}),9314:((n,e,t)=>{var r=t(6518),i=t(9565),s=t(8551),o=t(1767),a=t(4149),l=t(9590),c=t(9539),u=t(9462),h=t(684),m=t(4549),v=t(6395),C=!v&&!h("drop",0),T=!v&&!C&&m("drop",RangeError),E=v||C||T,x=u(function(){for(var P=this.iterator,b=this.next,I,M;this.remaining;)if(this.remaining--,I=s(i(b,P)),M=this.done=!!I.done,M)return;if(I=s(i(b,P)),M=this.done=!!I.done,!M)return I.value});r({target:"Iterator",proto:!0,real:!0,forced:E},{drop:function(b){s(this);var I;try{I=l(a(+b))}catch(M){c(this,"throw",M)}return T?i(T,this,I):new x(o(this),{remaining:I})}})}),9429:((n,e,t)=>{var r=t(4576),i=t(6193);n.exports=function(s){if(i){try{return r.process.getBuiltinModule(s)}catch{}try{return Function('return require("'+s+'")')()}catch{}}}}),9432:((n,e,t)=>{t(5213)}),9433:((n,e,t)=>{var r=t(4576),i=Object.defineProperty;n.exports=function(s,o){try{i(r,s,{value:o,configurable:!0,writable:!0})}catch{r[s]=o}return o}}),9462:((n,e,t)=>{var r=t(9565),i=t(2360),s=t(6699),o=t(6279),a=t(8227),l=t(1181),c=t(5966),u=t(7657).IteratorPrototype,h=t(2529),m=t(9539),v=t(1385),C=a("toStringTag"),T="IteratorHelper",E="WrapForValidIterator",x="normal",P="throw",b=l.set,I=function(D){var j=l.getterFor(D?E:T);return o(i(u),{next:function(){var z=j(this);if(D)return z.nextHandler();if(z.done)return h(void 0,!0);try{var W=z.nextHandler();return z.returnHandlerResult?W:h(W,z.done)}catch(H){throw z.done=!0,H}},return:function(){var F=j(this),z=F.iterator;if(F.done=!0,D){var W=c(z,"return");return W?r(W,z):h(void 0,!0)}if(F.inner)try{m(F.inner.iterator,x)}catch(H){return m(z,P,H)}if(F.openIters)try{v(F.openIters,x)}catch(H){return m(z,P,H)}return z&&m(z,x),h(void 0,!0)}})},M=I(!0),N=I(!1);s(N,C,"Iterator Helper"),n.exports=function(D,j,F){var z=function(H,V){V?(V.iterator=H.iterator,V.next=H.next):V=H,V.type=j?E:T,V.returnHandlerResult=!!F,V.nextHandler=D,V.counter=0,V.done=!1,b(this,V)};return z.prototype=j?M:N,z}}),9486:((n,e,t)=>{var r=t(6518),i=t(4576),s=t(9504),o=t(3972),a=t(4154),l=t(5169),c=t(2804),u=t(944),h=c.i2c,m=c.i2cUrl,v=s("".charAt),C=i.Uint8Array,T=!C||!C.prototype.toBase64||!(function(){try{var E=new C;E.toBase64(null)}catch{return!0}})();C&&r({target:"Uint8Array",proto:!0,forced:T},{toBase64:function(){var x=a(this),P=arguments.length?o(arguments[0]):void 0,b=u(P)==="base64"?h:m,I=!!P&&!!P.omitPadding;l(this.buffer);for(var M="",N=0,D=x.length,j,F=function(z){return v(b,j>>6*z&63)};N+2<D;N+=3)j=(x[N]<<16)+(x[N+1]<<8)+x[N+2],M+=F(3)+F(2)+F(1)+F(0);return N+2===D?(j=(x[N]<<16)+(x[N+1]<<8),M+=F(3)+F(2)+F(1)+(I?"":"=")):N+1===D&&(j=x[N]<<16,M+=F(3)+F(2)+(I?"":"==")),M}})}),9504:((n,e,t)=>{var r=t(616),i=Function.prototype,s=i.call,o=r&&i.bind.bind(s,s);n.exports=r?o:function(a){return function(){return s.apply(a,arguments)}}}),9519:((n,e,t)=>{var r=t(4576),i=t(2839),s=r.process,o=r.Deno,a=s&&s.versions||o&&o.version,l=a&&a.v8,c,u;l&&(c=l.split("."),u=c[0]>0&&c[0]<4?1:+(c[0]+c[1])),!u&&i&&(c=i.match(/Edge\/(\d+)/),(!c||c[1]>=74)&&(c=i.match(/Chrome\/(\d+)/),c&&(u=+c[1]))),n.exports=u}),9539:((n,e,t)=>{var r=t(9565),i=t(8551),s=t(5966);n.exports=function(o,a,l){var c,u;i(o);try{if(c=s(o,"return"),!c){if(a==="throw")throw l;return l}c=r(c,o)}catch(h){u=!0,c=h}if(a==="throw")throw l;if(u)throw c;return i(c),l}}),9565:((n,e,t)=>{var r=t(616),i=Function.prototype.call;n.exports=r?i.bind(i):function(){return i.apply(i,arguments)}}),9577:((n,e,t)=>{var r=t(9928),i=t(4644),s=t(1108),o=t(1291),a=t(5854),l=i.aTypedArray,c=i.getTypedArrayConstructor,u=i.exportTypedArrayMethod,h=(function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(v){return v===8}})(),m=h&&(function(){try{new Int8Array(1).with(-.5,1)}catch{return!0}})();u("with",function(v,C){var T=l(this),E=o(v),x=s(T)?a(C):+C;return r(T,c(T),E,x)},!h||m)}),9590:((n,e,t)=>{var r=t(1291),i=RangeError;n.exports=function(s){var o=r(s);if(o<0)throw new i("The argument can't be less than 0");return o}}),9617:((n,e,t)=>{var r=t(5397),i=t(5610),s=t(6198),o=function(a){return function(l,c,u){var h=r(l),m=s(h);if(m===0)return!a&&-1;var v=i(u,m),C;if(a&&c!==c){for(;m>v;)if(C=h[v++],C!==C)return!0}else for(;m>v;v++)if((a||v in h)&&h[v]===c)return a||v||0;return!a&&-1}};n.exports={includes:o(!0),indexOf:o(!1)}}),9631:((n,e,t)=>{t(9486)}),9797:((n,e,t)=>{t(4226)}),9835:(n=>{n.exports=function(e){try{var t=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return t.clear(),t.add(4),function(){return{done:!0}}}})}},i=t[e](r);return i.size===1&&i.values().next().value===4}catch{return!1}}}),9928:((n,e,t)=>{var r=t(6198),i=t(1291),s=RangeError;n.exports=function(o,a,l,c){var u=r(o),h=i(l),m=h<0?u+h:h;if(m>=u||m<0)throw new s("Incorrect index");for(var v=new a(u),C=0;C<u;C++)v[C]=C===m?c:o[C];return v}})},gD={};function et(n){var e=gD[n];if(e!==void 0)return e.exports;var t=gD[n]={exports:{}};return yV[n].call(t.exports,t,t.exports,et),t.exports}et.d=(n,e)=>{for(var t in e)et.o(e,t)&&!et.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};et.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);et(4114);et(6573);et(8100);et(7936);et(8111);et(8237);et(1689);et(9577);et(4235);et(9432);et(1549);et(9797);et(9631);et(5623);et(4979);et(5781);const yr=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Gw=[.001,0,0,.001,0,0],xw=1.35,hi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},qa={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},zv="pdfjs_internal_editor_",Xe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},ut={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},SV={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Kw={TRIANGLES:1,LATTICE:2},Tn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},MC={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},gn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},_d={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},rT={ERRORS:0,WARNINGS:1,INFOS:5},Wv={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ov={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},CV={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let iT=rT.WARNINGS;function AV(n){Number.isInteger(n)&&(iT=n)}function TV(){return iT}function sT(n){iT>=rT.INFOS&&console.info(`Info: ${n}`)}function Ze(n){iT>=rT.WARNINGS&&console.warn(`Warning: ${n}`)}function Dt(n){throw new Error(n)}function dt(n,e){n||Dt(e)}function EV(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function kF(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=RV(n)}catch{}}const r=e?URL.parse(n,e):URL.parse(n);return EV(r)?r:null}function MF(n,e,t=!1){const r=URL.parse(n);return r?(r.hash=e,r.href):t&&kF(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Ye(n,e,t,r=!1){return Object.defineProperty(n,e,{value:t,enumerable:!r,configurable:!0,writable:!1}),t}const ed=(function(){function e(t,r){this.message=t,this.name=r}return e.prototype=new Error,e.constructor=e,e})();class vD extends ed{constructor(e,t){super(e,"PasswordException"),this.code=t}}class ww extends ed{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Yw extends ed{constructor(e){super(e,"InvalidPDFException")}}class fA extends ed{constructor(e,t,r){super(e,"ResponseException"),this.status=t,this.missing=r}}class xV extends ed{constructor(e){super(e,"FormatError")}}class Ul extends ed{constructor(e){super(e,"AbortException")}}function NF(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Dt("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const r=[];for(let i=0;i<e;i+=t){const s=Math.min(i+t,e),o=n.subarray(i,s);r.push(String.fromCharCode.apply(null,o))}return r.join("")}function WS(n){typeof n!="string"&&Dt("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let r=0;r<e;++r)t[r]=n.charCodeAt(r)&255;return t}function wV(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function bV(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function PV(){try{return new Function(""),!0}catch{return!1}}class Pn{static get isLittleEndian(){return Ye(this,"isLittleEndian",bV())}static get isEvalSupported(){return Ye(this,"isEvalSupported",PV())}static get isOffscreenCanvasSupported(){return Ye(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ye(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return Ye(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return Ye(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Ye(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Ye(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const bw=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var aa,NC,Jw;class ke{static makeHexColor(e,t,r){return`#${bw[e]}${bw[t]}${bw[r]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let r;e[0]?(e[0]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[3],t[3]*=e[3]):(r=t[0],t[0]=t[1],t[1]=r,r=t[2],t[2]=t[3],t[3]=r,e[1]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,r=0){const i=e[r],s=e[r+1];e[r]=i*t[0]+s*t[2]+t[4],e[r+1]=i*t[1]+s*t[3]+t[5]}static applyTransformToBezier(e,t,r=0){const i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5];for(let u=0;u<6;u+=2){const h=e[r+u],m=e[r+u+1];e[r+u]=h*i+m*o+l,e[r+u+1]=h*s+m*a+c}}static applyInverseTransform(e,t){const r=e[0],i=e[1],s=t[0]*t[3]-t[1]*t[2];e[0]=(r*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/s,e[1]=(-r*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/s}static axialAlignedBoundingBox(e,t,r){const i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5],u=e[0],h=e[1],m=e[2],v=e[3];let C=i*u+l,T=C,E=i*m+l,x=E,P=a*h+c,b=P,I=a*v+c,M=I;if(s!==0||o!==0){const N=s*u,D=s*m,j=o*h,F=o*v;C+=j,x+=j,E+=F,T+=F,P+=N,M+=N,I+=D,b+=D}r[0]=Math.min(r[0],C,E,T,x),r[1]=Math.min(r[1],P,I,b,M),r[2]=Math.max(r[2],C,E,T,x),r[3]=Math.max(r[3],P,I,b,M)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const r=e[0],i=e[1],s=e[2],o=e[3],a=r**2+i**2,l=r*s+i*o,c=s**2+o**2,u=(a+c)/2,h=Math.sqrt(u**2-(a*c-l**2));t[0]=Math.sqrt(u+h||1),t[1]=Math.sqrt(u-h||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const r=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(r>i)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>o?null:[r,s,i,o]}static pointBoundingBox(e,t,r){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],t),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],t)}static rectBoundingBox(e,t,r,i,s){s[0]=Math.min(s[0],e,r),s[1]=Math.min(s[1],t,i),s[2]=Math.max(s[2],e,r),s[3]=Math.max(s[3],t,i)}static bezierBoundingBox(e,t,r,i,s,o,a,l,c){c[0]=Math.min(c[0],e,a),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,a),c[3]=Math.max(c[3],t,l),B(this,aa,Jw).call(this,e,r,s,a,t,i,o,l,3*(-e+3*(r-s)+a),6*(e-2*r+s),3*(r-e),c),B(this,aa,Jw).call(this,e,r,s,a,t,i,o,l,3*(-t+3*(i-o)+l),6*(t-2*i+o),3*(i-t),c)}}aa=new WeakSet,NC=function(e,t,r,i,s,o,a,l,c,u){if(c<=0||c>=1)return;const h=1-c,m=c*c,v=m*c,C=h*(h*(h*e+3*c*t)+3*m*r)+v*i,T=h*(h*(h*s+3*c*o)+3*m*a)+v*l;u[0]=Math.min(u[0],C),u[1]=Math.min(u[1],T),u[2]=Math.max(u[2],C),u[3]=Math.max(u[3],T)},Jw=function(e,t,r,i,s,o,a,l,c,u,h,m){if(Math.abs(c)<1e-12){Math.abs(u)>=1e-12&&B(this,aa,NC).call(this,e,t,r,i,s,o,a,l,-h/u,m);return}const v=u**2-4*h*c;if(v<0)return;const C=Math.sqrt(v),T=2*c;B(this,aa,NC).call(this,e,t,r,i,s,o,a,l,(-u+C)/T,m),B(this,aa,NC).call(this,e,t,r,i,s,o,a,l,(-u-C)/T,m)},L(ke,aa);function RV(n){return decodeURIComponent(escape(n))}let Pw=null,yD=null;function IV(n){return Pw||(Pw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,yD=new Map([["","t"]])),n.replaceAll(Pw,(e,t,r)=>t?t.normalize("NFKC"):yD.get(r))}function LF(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),NF(n)}const Ud="pdfjs_internal_id_";function _V(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[r,i,...s]=t;if(!n(r)&&!Number.isInteger(r)||!e(i))return!1;const o=s.length;let a=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;a=!1;break;default:return!1}for(const l of s)if(!(typeof l=="number"||a&&l===null))return!1;return!0}function Sr(n,e,t){return Math.min(Math.max(n,e),t)}function DF(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(NF(n))}function kV(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):WS(atob(n))}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});typeof AbortSignal.any!="function"&&(AbortSignal.any=function(n){const e=new AbortController,{signal:t}=e;for(const r of n)if(r.aborted)return e.abort(r.reason),t;for(const r of n)r.addEventListener("abort",()=>{e.abort(r.reason)},{signal:t});return t});et(1701);et(4603);et(7566);et(8721);class Vv{static textContent(e){const t=[],r={items:t,styles:Object.create(null)};function i(s){var l;if(!s)return;let o=null;const a=s.name;if(a==="#text")o=s.value;else if(Vv.shouldBuildText(a))(l=s==null?void 0:s.attributes)!=null&&l.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&t.push({str:o}),!!s.children)for(const c of s.children)i(c)}return i(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class OF{static setupStorage(e,t,r,i,s){const o=i.getValue(t,{value:null});switch(r.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),s==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(o.value===r.attributes.xfaOn?e.setAttribute("checked",!0):o.value===r.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",a=>{i.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),s==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of r.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const l=a.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:r=null,intent:i,linkService:s}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[l,c]of Object.entries(o))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}a&&s.addLinkAttributes(e,o.href,o.newWindow),r&&o.dataId&&this.setupStorage(e,o.dataId,t,r)}static render(e){var h,m;const t=e.annotationStorage,r=e.linkService,i=e.xfaHtml,s=e.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:s,linkService:r});const a=s!=="richText",l=e.div;if(l.append(o),e.viewport){const v=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=v}a&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(i.children.length===0){if(i.value){const v=document.createTextNode(i.value);o.append(v),a&&Vv.shouldBuildText(i.name)&&c.push(v)}return{textDivs:c}}const u=[[i,-1,o]];for(;u.length>0;){const[v,C,T]=u.at(-1);if(C+1===v.children.length){u.pop();continue}const E=v.children[++u.at(-1)[1]];if(E===null)continue;const{name:x}=E;if(x==="#text"){const b=document.createTextNode(E.value);c.push(b),T.append(b);continue}const P=(h=E==null?void 0:E.attributes)!=null&&h.xmlns?document.createElementNS(E.attributes.xmlns,x):document.createElement(x);if(T.append(P),E.attributes&&this.setAttributes({html:P,element:E,storage:t,intent:s,linkService:r}),((m=E.children)==null?void 0:m.length)>0)u.push([E,-1,P]);else if(E.value){const b=document.createTextNode(E.value);a&&Vv.shouldBuildText(x)&&c.push(b),P.append(b)}}for(const v of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))v.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Co="http://www.w3.org/2000/svg",kc=class kc{};q(kc,"CSS",96),q(kc,"PDF",72),q(kc,"PDF_TO_CSS_UNITS",kc.CSS/kc.PDF);let zl=kc;async function VS(n,e="text"){if(gv(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,r)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}r(new Error(i.statusText))}},i.send(null)})}class $S{constructor({viewBox:e,userUnit:t,scale:r,rotation:i,offsetX:s=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=r,this.rotation=i,this.offsetX=s,this.offsetY=o,r*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let u,h,m,v;switch(i%=360,i<0&&(i+=360),i){case 180:u=-1,h=0,m=0,v=1;break;case 90:u=0,h=1,m=1,v=0;break;case 270:u=0,h=-1,m=-1,v=0;break;case 0:u=1,h=0,m=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(m=-m,v=-v);let C,T,E,x;u===0?(C=Math.abs(c-e[1])*r+s,T=Math.abs(l-e[0])*r+o,E=(e[3]-e[1])*r,x=(e[2]-e[0])*r):(C=Math.abs(l-e[0])*r+s,T=Math.abs(c-e[1])*r+o,E=(e[2]-e[0])*r,x=(e[3]-e[1])*r),this.transform=[u*r,h*r,m*r,v*r,C-u*r*l-m*r*c,T-h*r*l-v*r*c],this.width=E,this.height=x}get rawDims(){const e=this.viewBox;return Ye(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new $S({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}convertToViewportPoint(e,t){const r=[e,t];return ke.applyTransform(r,this.transform),r}convertToViewportRectangle(e){const t=[e[0],e[1]];ke.applyTransform(t,this.transform);const r=[e[2],e[3]];return ke.applyTransform(r,this.transform),[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){const r=[e,t];return ke.applyInverseTransform(r,this.transform),r}}class eR extends ed{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function oT(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function tR(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function MV(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function NV(n,e="document.pdf"){if(typeof n!="string")return e;if(oT(n))return Ze('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const r=(a=>{try{return new URL(a)}catch{try{return new URL(decodeURIComponent(a))}catch{try{return new URL(a,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(a),"https://foo.bar")}catch{return null}}}}})(n);if(!r)return e;const i=a=>{try{let l=decodeURIComponent(a);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:a):l}catch{return a}},s=/\.pdf$/i,o=r.pathname.split("/").at(-1);if(s.test(o))return i(o);if(r.searchParams.size>0){const a=Array.from(r.searchParams.values()).reverse();for(const c of a)if(s.test(c))return i(c);const l=Array.from(r.searchParams.keys()).reverse();for(const c of l)if(s.test(c))return i(c)}if(r.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(r.hash);if(l)return i(l[0])}return e}class SD{constructor(){q(this,"started",Object.create(null));q(this,"times",[])}time(e){e in this.started&&Ze(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ze(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:r}of this.times)t=Math.max(r.length,t);for(const{name:r,start:i,end:s}of this.times)e.push(`${r.padEnd(t)} ${s-i}ms
`);return e.join("")}}function gv(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function zi(n){n.preventDefault()}function cn(n){n.preventDefault(),n.stopPropagation()}function LV(n){console.log("Deprecated API usage: "+n)}var Kv;class mA{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;f(this,Kv)||_(this,Kv,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=f(this,Kv).exec(e);if(!t)return null;const r=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,c==="-"?(o+=u,a+=h):c==="+"&&(o-=u,a-=h),new Date(Date.UTC(r,i,s,o,a,l))}}Kv=new WeakMap,L(mA,Kv);function DV(n,{scale:e=1,rotation:t=0}){const{width:r,height:i}=n.attributes.style,s=[0,0,parseInt(r),parseInt(i)];return new $S({viewBox:s,userUnit:1,scale:e,rotation:t})}function HS(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ze(`Not a valid color format: "${n}"`),[0,0,0])}function OV(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const r=window.getComputedStyle(e).color;n.set(t,HS(r))}e.remove()}function Qt(n){const{a:e,b:t,c:r,d:i,e:s,f:o}=n.getTransform();return[e,t,r,i,s,o]}function Is(n){const{a:e,b:t,c:r,d:i,e:s,f:o}=n.getTransform().invertSelf();return[e,t,r,i,s,o]}function Ku(n,e,t=!1,r=!0){if(e instanceof $S){const{pageWidth:i,pageHeight:s}=e.rawDims,{style:o}=n,a=Pn.isCSSRoundSupported,l=`var(--total-scale-factor) * ${i}px`,c=`var(--total-scale-factor) * ${s}px`,u=a?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,h=a?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!t||e.rotation%180===0?(o.width=u,o.height=h):(o.width=h,o.height=u)}r&&n.setAttribute("data-main-rotation",e.rotation)}class to{constructor(){const{pixelRatio:e}=to;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,r,i,s=-1){let o=1/0,a=1/0,l=1/0;r=to.capPixels(r,s),r>0&&(o=Math.sqrt(r/(e*t))),i!==-1&&(a=i/e,l=i/t);const c=Math.min(o,a,l);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const r=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,r):r}return e}}const Xw=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class BV{static get isDarkMode(){var e;return Ye(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class FV{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:r}=window.getComputedStyle(e);return e.remove(),Ye(this,"commentForegroundColor",HS(r))}}function jV(n,e,t,r){r=Math.min(Math.max(r??1,0),1);const i=255*(1-r);return n=Math.round(n*r+i),e=Math.round(e*r+i),t=Math.round(t*r+i),[n,e,t]}function CD(n,e){const t=n[0]/255,r=n[1]/255,i=n[2]/255,s=Math.max(t,r,i),o=Math.min(t,r,i),a=(s+o)/2;if(s===o)e[0]=e[1]=0;else{const l=s-o;switch(e[1]=a<.5?l/(s+o):l/(2-s-o),s){case t:e[0]=((r-i)/l+(r<i?6:0))*60;break;case r:e[0]=((i-t)/l+2)*60;break;case i:e[0]=((t-r)/l+4)*60;break}}e[2]=a}function Qw(n,e){const t=n[0],r=n[1],i=n[2],s=(1-Math.abs(2*i-1))*r,o=s*(1-Math.abs(t/60%2-1)),a=i-s/2;switch(Math.floor(t/60)){case 0:e[0]=s+a,e[1]=o+a,e[2]=a;break;case 1:e[0]=o+a,e[1]=s+a,e[2]=a;break;case 2:e[0]=a,e[1]=s+a,e[2]=o+a;break;case 3:e[0]=a,e[1]=o+a,e[2]=s+a;break;case 4:e[0]=o+a,e[1]=a,e[2]=s+a;break;case 5:case 6:e[0]=s+a,e[1]=a,e[2]=o+a;break}}function AD(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function TD(n,e,t){Qw(n,t),t.map(AD);const r=.2126*t[0]+.7152*t[1]+.0722*t[2];Qw(e,t),t.map(AD);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return r>i?(r+.05)/(i+.05):(i+.05)/(r+.05)}const ED=new Map;function UV(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let r=ED.get(t);if(r)return r;const i=new Float32Array(9),s=i.subarray(0,3),o=i.subarray(3,6);CD(n,o);const a=i.subarray(6,9);CD(e,a);const l=a[2]<.5,c=l?12:4.5;if(o[2]=l?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),TD(o,a,s)<c){let u,h;l?(u=o[2],h=1):(u=0,h=o[2]);const m=.005;for(;h-u>m;){const v=o[2]=(u+h)/2;l===TD(o,a,s)<c?u=v:h=v}o[2]=l?h:u}return Qw(o,s),r=ke.makeHexColor(Math.round(s[0]*255),Math.round(s[1]*255),Math.round(s[2]*255)),ED.set(t,r),r}function BF({html:n,dir:e,className:t},r){const i=document.createDocumentFragment();if(typeof n=="string"){const s=document.createElement("p");s.dir=e||"auto";const o=n.split(/(?:\r\n?|\n)/);for(let a=0,l=o.length;a<l;++a){const c=o[a];s.append(document.createTextNode(c)),a<l-1&&s.append(document.createElement("br"))}i.append(s)}else OF.render({xfaHtml:n,div:i,intent:"richText"});i.firstElementChild.classList.add("richText",t),r.append(i)}function FF(n){const e=new Path2D;if(!n)return e;for(let t=0,r=n.length;t<r;)switch(n[t++]){case ov.moveTo:e.moveTo(n[t++],n[t++]);break;case ov.lineTo:e.lineTo(n[t++],n[t++]);break;case ov.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case ov.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case ov.closePath:e.closePath();break;default:Ze(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}et(4972);et(4628);et(7642);et(8004);et(3853);et(5876);et(2475);et(5024);et(1698);et(9314);et(1148);et(3579);et(8335);var Ga,Ka,bi,Pi,Yv,Ya,Jd,Xd,Jv,NA,jF,Kn,UF,zF,kd,vv;const Eo=class Eo{constructor(e){L(this,Kn);L(this,Ga,null);L(this,Ka,null);L(this,bi);L(this,Pi,null);L(this,Yv,null);L(this,Ya,null);L(this,Jd,null);L(this,Xd,null);_(this,bi,e),f(Eo,Jv)||_(Eo,Jv,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=_(this,Ga,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=f(this,bi)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",zi,{signal:t}),e.addEventListener("pointerdown",B(Eo,NA,jF),{signal:t}));const r=_(this,Pi,document.createElement("div"));r.className="buttons",e.append(r);const i=f(this,bi).toolbarPosition;if(i){const{style:s}=e,o=f(this,bi)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return f(this,Ga)}hide(){var e;f(this,Ga).classList.add("hidden"),(e=f(this,Ka))==null||e.hideDropdown()}show(){var e,t;f(this,Ga).classList.remove("hidden"),(e=f(this,Yv))==null||e.shown(),(t=f(this,Ya))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=f(this,bi),r=document.createElement("button");r.classList.add("basic","deleteButton"),r.tabIndex=0,r.setAttribute("data-l10n-id",f(Eo,Jv)[e]),B(this,Kn,kd).call(this,r)&&r.addEventListener("click",i=>{t.delete()},{signal:t._signal}),f(this,Pi).append(r)}async addAltText(e){const t=await e.render();B(this,Kn,kd).call(this,t),f(this,Pi).append(t,f(this,Kn,vv)),_(this,Yv,e)}addComment(e,t=null){if(f(this,Ya))return;const r=e.renderForToolbar();if(!r)return;B(this,Kn,kd).call(this,r);const i=_(this,Jd,f(this,Kn,vv));t?(f(this,Pi).insertBefore(r,t),f(this,Pi).insertBefore(i,t)):f(this,Pi).append(r,i),_(this,Ya,e),e.toolbar=this}addColorPicker(e){if(f(this,Ka))return;_(this,Ka,e);const t=e.renderButton();B(this,Kn,kd).call(this,t),f(this,Pi).append(t,f(this,Kn,vv))}async addEditSignatureButton(e){const t=_(this,Xd,await e.renderEditButton(f(this,bi)));B(this,Kn,kd).call(this,t),f(this,Pi).append(t,f(this,Kn,vv))}removeButton(e){var t,r;switch(e){case"comment":(t=f(this,Ya))==null||t.removeToolbarCommentButton(),_(this,Ya,null),(r=f(this,Jd))==null||r.remove(),_(this,Jd,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,r){if(!t&&e==="comment")return;const i=f(this,Pi).querySelector(r);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){f(this,Xd)&&(f(this,Xd).title=e)}remove(){var e;f(this,Ga).remove(),(e=f(this,Ka))==null||e.destroy(),_(this,Ka,null)}};Ga=new WeakMap,Ka=new WeakMap,bi=new WeakMap,Pi=new WeakMap,Yv=new WeakMap,Ya=new WeakMap,Jd=new WeakMap,Xd=new WeakMap,Jv=new WeakMap,NA=new WeakSet,jF=function(e){e.stopPropagation()},Kn=new WeakSet,UF=function(e){f(this,bi)._focusEventsAllowed=!1,cn(e)},zF=function(e){f(this,bi)._focusEventsAllowed=!0,cn(e)},kd=function(e){const t=f(this,bi)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",B(this,Kn,UF).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",B(this,Kn,zF).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",zi,{signal:t}),!0)},vv=function(){const e=document.createElement("div");return e.className="divider",e},L(Eo,NA),L(Eo,Jv,null);let eb=Eo;var Xv,Lc,bo,da,WF,VF,tb;class zV{constructor(e){L(this,da);L(this,Xv,null);L(this,Lc,null);L(this,bo);_(this,bo,e)}show(e,t,r){const[i,s]=B(this,da,VF).call(this,t,r),{style:o}=f(this,Lc)||_(this,Lc,B(this,da,WF).call(this));e.append(f(this,Lc)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){f(this,Lc).remove()}}Xv=new WeakMap,Lc=new WeakMap,bo=new WeakMap,da=new WeakSet,WF=function(){const e=_(this,Lc,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=f(this,bo)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",zi,{signal:t});const r=_(this,Xv,document.createElement("div"));return r.className="buttons",e.append(r),f(this,bo).hasCommentManager()&&B(this,da,tb).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{f(this,bo).commentSelection("floating_button")}),B(this,da,tb).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{f(this,bo).highlightSelection("floating_button")}),e},VF=function(e,t){let r=0,i=0;for(const s of e){const o=s.y+s.height;if(o<r)continue;const a=s.x+(t?s.width:0);if(o>r){i=a,r=o;continue}t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,r]},tb=function(e,t,r,i){const s=document.createElement("button");s.classList.add("basic",e),s.tabIndex=0,s.setAttribute("data-l10n-id",t);const o=document.createElement("span");s.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",r);const a=f(this,bo)._signal;a instanceof AbortSignal&&!a.aborted&&(s.addEventListener("contextmenu",zi,{signal:a}),s.addEventListener("click",i,{signal:a})),f(this,Xv).append(s)};function $F(n,e,t){for(const r of t)e.addEventListener(r,n[r].bind(n))}var Dc,Oc,Qd,Bc;const bt=class bt{static initializeAndAddPointerId(e){(f(bt,Oc)||_(bt,Oc,new Set)).add(e)}static setPointer(e,t){f(bt,Dc)||_(bt,Dc,t),f(bt,Bc)??_(bt,Bc,e)}static setTimeStamp(e){_(bt,Qd,e)}static isSamePointerId(e){return f(bt,Dc)===e}static isSamePointerIdOrRemove(e){var t;return f(bt,Dc)===e?!0:((t=f(bt,Oc))==null||t.delete(e),!1)}static isSamePointerType(e){return f(bt,Bc)===e}static isInitializedAndDifferentPointerType(e){return f(bt,Bc)!==null&&!bt.isSamePointerType(e)}static isSameTimeStamp(e){return f(bt,Qd)===e}static isUsingMultiplePointers(){var e;return((e=f(bt,Oc))==null?void 0:e.size)>=1}static clearPointerType(){_(bt,Bc,null)}static clearPointerIds(){_(bt,Dc,NaN),_(bt,Oc,null)}static clearTimeStamp(){_(bt,Qd,NaN)}};Dc=new WeakMap,Oc=new WeakMap,Qd=new WeakMap,Bc=new WeakMap,L(bt,Dc,NaN),L(bt,Oc,null),L(bt,Qd,NaN),L(bt,Bc,null);let tr=bt;var LA;class WV{constructor(){L(this,LA,0)}get id(){return`${zv}${An(this,LA)._++}`}}LA=new WeakMap;var eh,Qv,nr,th,LC;const TR=class TR{constructor(){L(this,th);L(this,eh,LF());L(this,Qv,0);L(this,nr,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const s=i.decode().then(()=>(r.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return Ye(this,"_isSVGFittingCanvas",s)}async getFromFile(e){const{lastModified:t,name:r,size:i,type:s}=e;return B(this,th,LC).call(this,`${t}_${r}_${i}_${s}`,e)}async getFromUrl(e){return B(this,th,LC).call(this,e,e)}async getFromBlob(e,t){const r=await t;return B(this,th,LC).call(this,e,r)}async getFromId(e){f(this,nr)||_(this,nr,new Map);const t=f(this,nr).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:r}=t;return delete t.blobPromise,this.getFromBlob(t.id,r)}return this.getFromUrl(t.url)}getFromCanvas(e,t){f(this,nr)||_(this,nr,new Map);let r=f(this,nr).get(e);if(r!=null&&r.bitmap)return r.refCounter+=1,r;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),r={bitmap:i.transferToImageBitmap(),id:`image_${f(this,eh)}_${An(this,Qv)._++}`,refCounter:1,isSvg:!1},f(this,nr).set(e,r),f(this,nr).set(r.id,r),r}getSvgUrl(e){const t=f(this,nr).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;f(this,nr)||_(this,nr,new Map);const t=f(this,nr).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:r}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(r.width,r.height);s.getContext("bitmaprenderer").transferFromImageBitmap(r),t.blobPromise=s.convertToBlob()}(i=r.close)==null||i.call(r),t.bitmap=null}isValidId(e){return e.startsWith(`image_${f(this,eh)}_`)}};eh=new WeakMap,Qv=new WeakMap,nr=new WeakMap,th=new WeakSet,LC=async function(e,t){f(this,nr)||_(this,nr,new Map);let r=f(this,nr).get(e);if(r===null)return null;if(r!=null&&r.bitmap)return r.refCounter+=1,r;try{r||(r={bitmap:null,id:`image_${f(this,eh)}_${An(this,Qv)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(r.url=t,i=await VS(t,"blob")):t instanceof File?i=r.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const s=TR._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((c,u)=>{a.onload=()=>{r.bitmap=a,r.isSvg=!0,c()},o.onload=async()=>{const h=r.svgUrl=o.result;a.src=await s?`${h}#svgView(preserveAspectRatio(none))`:h},a.onerror=o.onerror=u});o.readAsDataURL(i),await l}else r.bitmap=await createImageBitmap(i);r.refCounter=1}catch(i){Ze(i),r=null}return f(this,nr).set(e,r),r&&f(this,nr).set(r.id,r),r};let nb=TR;var hn,Ja,ey,Xt;class VV{constructor(e=128){L(this,hn,[]);L(this,Ja,!1);L(this,ey);L(this,Xt,-1);_(this,ey,e)}add({cmd:e,undo:t,post:r,mustExec:i,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(i&&e(),f(this,Ja))return;const l={cmd:e,undo:t,post:r,type:s};if(f(this,Xt)===-1){f(this,hn).length>0&&(f(this,hn).length=0),_(this,Xt,0),f(this,hn).push(l);return}if(o&&f(this,hn)[f(this,Xt)].type===s){a&&(l.undo=f(this,hn)[f(this,Xt)].undo),f(this,hn)[f(this,Xt)]=l;return}const c=f(this,Xt)+1;c===f(this,ey)?f(this,hn).splice(0,1):(_(this,Xt,c),c<f(this,hn).length&&f(this,hn).splice(c)),f(this,hn).push(l)}undo(){if(f(this,Xt)===-1)return;_(this,Ja,!0);const{undo:e,post:t}=f(this,hn)[f(this,Xt)];e(),t==null||t(),_(this,Ja,!1),_(this,Xt,f(this,Xt)-1)}redo(){if(f(this,Xt)<f(this,hn).length-1){_(this,Xt,f(this,Xt)+1),_(this,Ja,!0);const{cmd:e,post:t}=f(this,hn)[f(this,Xt)];e(),t==null||t(),_(this,Ja,!1)}}hasSomethingToUndo(){return f(this,Xt)!==-1}hasSomethingToRedo(){return f(this,Xt)<f(this,hn).length-1}cleanType(e){if(f(this,Xt)!==-1){for(let t=f(this,Xt);t>=0;t--)if(f(this,hn)[t].type!==e){f(this,hn).splice(t+1,f(this,Xt)-t),_(this,Xt,t);return}f(this,hn).length=0,_(this,Xt,-1)}}destroy(){_(this,hn,null)}}hn=new WeakMap,Ja=new WeakMap,ey=new WeakMap,Xt=new WeakMap;var DA,HF;class ZS{constructor(e){L(this,DA);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Pn.platform;for(const[r,i,s={}]of e)for(const o of r){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const r=this.callbacks.get(B(this,DA,HF).call(this,t));if(!r)return;const{callback:i,options:{bubbles:s=!1,args:o=[],checker:a=null}}=r;a&&!a(e,t)||(i.bind(e,...o,t)(),s||cn(t))}}DA=new WeakSet,HF=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const OA=class OA{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return OV(e),Ye(this,"_colors",e)}convert(e){const t=HS(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[r,i]of this._colors)if(i.every((s,o)=>s===t[o]))return OA._colorsMapping.get(r);return t}getHexCode(e){const t=this._colors.get(e);return t?ke.makeHexColor(...t):e}};q(OA,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let rb=OA;var nh,qr,rh,nn,xn,ih,Ri,sh,Ii,rr,Xa,Qa,oh,el,Ms,_i,Fc,ty,ny,ah,ry,Ns,tl,lh,nl,Ls,BA,rl,ch,iy,il,jc,uh,sl,sy,vn,Tt,Po,ol,al,oy,dh,ay,ll,Ds,Ro,ly,cy,ki,Re,DC,ib,ZF,qF,yv,GF,KF,YF,sb,JF,XF,QF,ej,hr,Ao,tj,nj,ob,rj,Sv,ab;const $d=class $d{constructor(e,t,r,i,s,o,a,l,c,u,h,m,v,C,T,E){L(this,Re);L(this,nh,new AbortController);L(this,qr,null);L(this,rh,null);L(this,nn,new Map);L(this,xn,new Map);L(this,ih,null);L(this,Ri,null);L(this,sh,null);L(this,Ii,new VV);L(this,rr,null);L(this,Xa,null);L(this,Qa,null);L(this,oh,0);L(this,el,new Set);L(this,Ms,null);L(this,_i,null);L(this,Fc,new Set);q(this,"_editorUndoBar",null);L(this,ty,!1);L(this,ny,!1);L(this,ah,!1);L(this,ry,null);L(this,Ns,null);L(this,tl,null);L(this,lh,null);L(this,nl,!1);L(this,Ls,null);L(this,BA,new WV);L(this,rl,!1);L(this,ch,!1);L(this,iy,!1);L(this,il,null);L(this,jc,null);L(this,uh,null);L(this,sl,null);L(this,sy,null);L(this,vn,Xe.NONE);L(this,Tt,new Set);L(this,Po,null);L(this,ol,null);L(this,al,null);L(this,oy,null);L(this,dh,null);L(this,ay,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});L(this,ll,[0,0]);L(this,Ds,null);L(this,Ro,null);L(this,ly,null);L(this,cy,null);L(this,ki,null);const x=this._signal=f(this,nh).signal;_(this,Ro,e),_(this,ly,t),_(this,cy,r),_(this,ih,i),_(this,rr,s),_(this,ol,o),_(this,dh,l),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:x}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:x}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:x}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:x}),a._on("setpreference",this.onSetPreference.bind(this),{signal:x}),a._on("switchannotationeditorparams",P=>this.updateParams(P.type,P.value),{signal:x}),window.addEventListener("pointerdown",()=>{_(this,ch,!0)},{capture:!0,signal:x}),window.addEventListener("pointerup",()=>{_(this,ch,!1)},{capture:!0,signal:x}),B(this,Re,GF).call(this),B(this,Re,ej).call(this),B(this,Re,sb).call(this),_(this,Ri,l.annotationStorage),_(this,ry,l.filterFactory),_(this,al,c),_(this,lh,u||null),_(this,ty,h),_(this,ny,m),_(this,ah,v),_(this,sy,C||null),this.viewParameters={realScale:zl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=T||null,this._supportsPinchToZoom=E!==!1,s==null||s.setSidebarUiManager(this)}static get _keyboardManager(){const e=$d.prototype,t=o=>f(o,Ro).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),r=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Ye(this,"_keyboardManager",new ZS([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],e.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:r}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&f(o,Ro).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&f(o,Ro).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}destroy(){var e,t,r,i,s,o,a,l,c;(e=f(this,ki))==null||e.resolve(),_(this,ki,null),(t=f(this,nh))==null||t.abort(),_(this,nh,null),this._signal=null;for(const u of f(this,xn).values())u.destroy();f(this,xn).clear(),f(this,nn).clear(),f(this,Fc).clear(),(r=f(this,sl))==null||r.clear(),_(this,qr,null),f(this,Tt).clear(),f(this,Ii).destroy(),(i=f(this,ih))==null||i.destroy(),(s=f(this,rr))==null||s.destroy(),(o=f(this,ol))==null||o.destroy(),(a=f(this,Ls))==null||a.hide(),_(this,Ls,null),(l=f(this,uh))==null||l.destroy(),_(this,uh,null),_(this,rh,null),f(this,Ns)&&(clearTimeout(f(this,Ns)),_(this,Ns,null)),f(this,Ds)&&(clearTimeout(f(this,Ds)),_(this,Ds,null)),(c=this._editorUndoBar)==null||c.destroy(),_(this,dh,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return f(this,sy)}get useNewAltTextFlow(){return f(this,ny)}get useNewAltTextWhenAddingImage(){return f(this,ah)}get hcmFilter(){return Ye(this,"hcmFilter",f(this,al)?f(this,ry).addHCMFilter(f(this,al).foreground,f(this,al).background):"none")}get direction(){return Ye(this,"direction",getComputedStyle(f(this,Ro)).direction)}get _highlightColors(){return Ye(this,"_highlightColors",f(this,lh)?new Map(f(this,lh).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Ye(this,"highlightColors",null);const t=new Map,r=!!f(this,al);for(const[i,s]of e){const o=i.endsWith("_HCM");if(r&&o){t.set(i.replace("_HCM",""),s);continue}!r&&!o&&t.set(i,s)}return Ye(this,"highlightColors",t)}get highlightColorNames(){return Ye(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),_(this,Qa,e)}setMainHighlightColorPicker(e){_(this,uh,e)}editAltText(e,t=!1){var r;(r=f(this,ih))==null||r.editAltText(this,e,t)}hasCommentManager(){return!!f(this,rr)}editComment(e,t,r,i){var s;(s=f(this,rr))==null||s.showDialog(this,e,t,r,i)}selectComment(e,t){const r=f(this,xn).get(e),i=r==null?void 0:r.getEditorByUID(t);i==null||i.toggleComment(!0,!0)}updateComment(e){var t;(t=f(this,rr))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=f(this,rr))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=f(this,rr))==null||t.removeComments([e.uid])}toggleComment(e,t,r=void 0){var i;(i=f(this,rr))==null||i.toggleCommentPopup(e,t,r)}makeCommentColor(e,t){var r;return e&&((r=f(this,rr))==null?void 0:r.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=f(this,rr))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(f(this,xn).has(e-1))return;const{resolve:t,promise:r}=Promise.withResolvers(),i=s=>{s.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await r}getSignature(e){var t;(t=f(this,ol))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return f(this,ol)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":_(this,ah,t);break}}onPageChanging({pageNumber:e}){_(this,oh,e-1)}focusMainContainer(){f(this,Ro).focus()}findParent(e,t){for(const r of f(this,xn).values()){const{x:i,y:s,width:o,height:a}=r.div.getBoundingClientRect();if(e>=i&&e<=i+o&&t>=s&&t<=s+a)return r}return null}disableUserSelect(e=!1){f(this,ly).classList.toggle("noUserSelect",e)}addShouldRescale(e){f(this,Fc).add(e)}removeShouldRescale(e){f(this,Fc).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*zl.PDF_TO_CSS_UNITS;for(const r of f(this,Fc))r.onScaleChanging();(t=f(this,Qa))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const r=document.getSelection();if(!r||r.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:o,focusOffset:a}=r,l=r.toString(),u=B(this,Re,DC).call(this,r).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;r.empty();const m=B(this,Re,ib).call(this,u),v=f(this,vn)===Xe.NONE,C=()=>{const T=m==null?void 0:m.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:s,focusNode:o,focusOffset:a,text:l});v&&this.showAllEditors("highlight",!0,!0),t&&(T==null||T.editComment())};if(v){this.switchToMode(Xe.HIGHLIGHT,C);return}C()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!f(this,Ri))return null;const t=`${zv}${e}`,r=f(this,Ri).getRawValue(t);return r&&f(this,Ri).remove(t),r}addToAnnotationStorage(e){!e.isEmpty()&&f(this,Ri)&&!f(this,Ri).has(e.id)&&f(this,Ri).setValue(e.id,e)}a11yAlert(e,t=null){const r=f(this,cy);r&&(r.setAttribute("data-l10n-id",e),t?r.setAttribute("data-l10n-args",JSON.stringify(t)):r.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,f(this,nl)&&(_(this,nl,!1),B(this,Re,yv).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of f(this,Tt))if(t.div.contains(e)){_(this,jc,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!f(this,jc))return;const[e,t]=f(this,jc);_(this,jc,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){B(this,Re,sb).call(this),this.setEditingState(!0)}removeEditListeners(){B(this,Re,JF).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const r of f(this,_i))if(r.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const r of f(this,_i))if(r.isHandlingMimeForPasting(t.type)){r.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var r;if(e.preventDefault(),(r=f(this,qr))==null||r.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of f(this,Tt)){const s=i.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const o of f(this,_i))if(o.isHandlingMimeForPasting(s.type)){o.paste(s,this.currentLayer);return}let r=t.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(s){Ze(`paste: "${s.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const l of r){const c=await i.deserialize(l);if(!c)return;s.push(c)}const o=()=>{for(const l of s)B(this,Re,ob).call(this,l);B(this,Re,ab).call(this,s)},a=()=>{for(const l of s)l.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(s){Ze(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),f(this,vn)!==Xe.NONE&&!this.isEditorHandlingKeyboard&&$d._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,f(this,nl)&&(_(this,nl,!1),B(this,Re,yv).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(B(this,Re,KF).call(this),B(this,Re,XF).call(this),B(this,Re,hr).call(this,{isEditing:f(this,vn)!==Xe.NONE,isEmpty:B(this,Re,Sv).call(this),hasSomethingToUndo:f(this,Ii).hasSomethingToUndo(),hasSomethingToRedo:f(this,Ii).hasSomethingToRedo(),hasSelectedEditor:!1})):(B(this,Re,YF).call(this),B(this,Re,QF).call(this),B(this,Re,hr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!f(this,_i)){_(this,_i,e);for(const t of f(this,_i))B(this,Re,Ao).call(this,t.defaultPropertiesToUpdate)}}getId(){return f(this,BA).id}get currentLayer(){return f(this,xn).get(f(this,oh))}getLayer(e){return f(this,xn).get(e)}get currentPageIndex(){return f(this,oh)}addLayer(e){f(this,xn).set(e.pageIndex,e),f(this,rl)?e.enable():e.disable()}removeLayer(e){f(this,xn).delete(e.pageIndex)}async updateMode(e,t=null,r=!1,i=!1,s=!1,o=!1){var a,l,c,u,h,m;if(f(this,vn)!==e&&!(f(this,ki)&&(await f(this,ki).promise,!f(this,ki)))){if(_(this,ki,Promise.withResolvers()),(a=f(this,Qa))==null||a.commitOrRemove(),f(this,vn)===Xe.POPUP&&((l=f(this,rr))==null||l.hideSidebar()),(c=f(this,rr))==null||c.destroyPopup(),_(this,vn,e),e===Xe.NONE){this.setEditingState(!1),B(this,Re,nj).call(this);for(const v of f(this,nn).values())v.hideStandaloneCommentButton();(u=this._editorUndoBar)==null||u.hide(),this.toggleComment(null),f(this,ki).resolve();return}for(const v of f(this,nn).values())v.addStandaloneCommentButton();e===Xe.SIGNATURE&&await((h=f(this,ol))==null?void 0:h.loadSignatures()),r&&tr.clearPointerType(),this.setEditingState(!0),await B(this,Re,tj).call(this),this.unselectAll();for(const v of f(this,xn).values())v.updateMode(e);if(e===Xe.POPUP){f(this,rh)||_(this,rh,await f(this,dh).getAnnotationsByType(new Set(f(this,_i).map(T=>T._editorType))));const v=new Set,C=[];for(const T of f(this,nn).values()){const{annotationElementId:E,hasComment:x,deleted:P}=T;E&&v.add(E),x&&!P&&C.push(T.getData())}for(const T of f(this,rh)){const{id:E,popupRef:x,contentsObj:P}=T;x&&(P!=null&&P.str)&&!v.has(E)&&!f(this,el).has(E)&&C.push(T)}(m=f(this,rr))==null||m.showSidebar(C)}if(!t){i&&this.addNewEditorFromKeyboard(),f(this,ki).resolve();return}for(const v of f(this,nn).values())v.uid===t?(this.setSelected(v),o?v.editComment():s?v.enterInEditMode():v.focus()):v.unselect();f(this,ki).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==f(this,vn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(f(this,_i)){switch(e){case ut.CREATE:this.currentLayer.addNewEditor(t);return;case ut.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(f(this,oy)||_(this,oy,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const r of f(this,Tt))r.updateParams(e,t);else for(const r of f(this,_i))r.updateDefaultParams(e,t)}}showAllEditors(e,t,r=!1){var s;for(const o of f(this,nn).values())o.editorType===e&&o.show(t);(((s=f(this,oy))==null?void 0:s.get(ut.HIGHLIGHT_SHOW_ALL))??!0)!==t&&B(this,Re,Ao).call(this,[[ut.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(f(this,iy)!==e){_(this,iy,e);for(const t of f(this,xn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of f(this,nn).values())t.pageIndex===e&&(yield t)}getEditor(e){return f(this,nn).get(e)}addEditor(e){f(this,nn).set(e.id,e)}removeEditor(e){var t,r;e.div.contains(document.activeElement)&&(f(this,Ns)&&clearTimeout(f(this,Ns)),_(this,Ns,setTimeout(()=>{this.focusMainContainer(),_(this,Ns,null)},0))),f(this,nn).delete(e.id),e.annotationElementId&&((t=f(this,sl))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!f(this,el).has(e.annotationElementId))&&((r=f(this,Ri))==null||r.remove(e.id))}addDeletedAnnotationElement(e){f(this,el).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return f(this,el).has(e)}removeDeletedAnnotationElement(e){f(this,el).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){f(this,qr)!==e&&(_(this,qr,e),e&&B(this,Re,Ao).call(this,e.propertiesToUpdate))}updateUI(e){f(this,Re,rj)===e&&B(this,Re,Ao).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){B(this,Re,Ao).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(f(this,Tt).has(e)){f(this,Tt).delete(e),e.unselect(),B(this,Re,hr).call(this,{hasSelectedEditor:this.hasSelection});return}f(this,Tt).add(e),e.select(),B(this,Re,Ao).call(this,e.propertiesToUpdate),B(this,Re,hr).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=f(this,Qa))==null||t.commitOrRemove();for(const r of f(this,Tt))r!==e&&r.unselect();f(this,Tt).clear(),f(this,Tt).add(e),e.select(),B(this,Re,Ao).call(this,e.propertiesToUpdate),B(this,Re,hr).call(this,{hasSelectedEditor:!0})}isSelected(e){return f(this,Tt).has(e)}get firstSelectedEditor(){return f(this,Tt).values().next().value}unselect(e){e.unselect(),f(this,Tt).delete(e),B(this,Re,hr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return f(this,Tt).size!==0}get isEnterHandled(){return f(this,Tt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;f(this,Ii).undo(),B(this,Re,hr).call(this,{hasSomethingToUndo:f(this,Ii).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:B(this,Re,Sv).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){f(this,Ii).redo(),B(this,Re,hr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:f(this,Ii).hasSomethingToRedo(),isEmpty:B(this,Re,Sv).call(this)})}addCommands(e){f(this,Ii).add(e),B(this,Re,hr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:B(this,Re,Sv).call(this)})}cleanUndoStack(e){f(this,Ii).cleanType(e)}delete(){var s;this.commitOrRemove();const e=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...f(this,Tt)],r=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},i=()=>{for(const o of t)B(this,Re,ob).call(this,o)};this.addCommands({cmd:r,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=f(this,qr))==null||e.commitOrRemove()}hasSomethingToControl(){return f(this,qr)||this.hasSelection}selectAll(){for(const e of f(this,Tt))e.commit();B(this,Re,ab).call(this,f(this,nn).values())}unselectAll(){var e;if(!(f(this,qr)&&(f(this,qr).commitOrRemove(),f(this,vn)!==Xe.NONE))&&!((e=f(this,Qa))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of f(this,Tt))t.unselect();f(this,Tt).clear(),B(this,Re,hr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;f(this,ll)[0]+=e,f(this,ll)[1]+=t;const[i,s]=f(this,ll),o=[...f(this,Tt)],a=1e3;f(this,Ds)&&clearTimeout(f(this,Ds)),_(this,Ds,setTimeout(()=>{_(this,Ds,null),f(this,ll)[0]=f(this,ll)[1]=0,this.addCommands({cmd:()=>{for(const l of o)f(this,nn).has(l.id)&&(l.translateInPage(i,s),l.translationDone())},undo:()=>{for(const l of o)f(this,nn).has(l.id)&&(l.translateInPage(-i,-s),l.translationDone())},mustExec:!1})},a));for(const l of o)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),_(this,Ms,new Map);for(const e of f(this,Tt))f(this,Ms).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!f(this,Ms))return!1;this.disableUserSelect(!1);const e=f(this,Ms);_(this,Ms,null);let t=!1;for(const[{x:i,y:s,pageIndex:o},a]of e)a.newX=i,a.newY=s,a.newPageIndex=o,t||(t=i!==a.savedX||s!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const r=(i,s,o,a)=>{if(f(this,nn).has(i.id)){const l=f(this,xn).get(a);l?i._setParentAndPosition(l,s,o):(i.pageIndex=a,i.x=s,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:o,newPageIndex:a}]of e)r(i,s,o,a)},undo:()=>{for(const[i,{savedX:s,savedY:o,savedPageIndex:a}]of e)r(i,s,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(f(this,Ms))for(const r of f(this,Ms).keys())r.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||f(this,Tt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return f(this,qr)===e}getActive(){return f(this,qr)}getMode(){return f(this,vn)}isEditingMode(){return f(this,vn)!==Xe.NONE}get imageManager(){return Ye(this,"imageManager",new nb)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,u=t.rangeCount;c<u;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:r,y:i,width:s,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(c,u,h,m)=>({x:(u-i)/o,y:1-(c+h-r)/s,width:m/o,height:h/s});break;case"180":a=(c,u,h,m)=>({x:1-(c+h-r)/s,y:1-(u+m-i)/o,width:h/s,height:m/o});break;case"270":a=(c,u,h,m)=>({x:1-(u+m-i)/o,y:(c-r)/s,width:m/o,height:h/s});break;default:a=(c,u,h,m)=>({x:(c-r)/s,y:(u-i)/o,width:h/s,height:m/o});break}const l=[];for(let c=0,u=t.rangeCount;c<u;c++){const h=t.getRangeAt(c);if(!h.collapsed)for(const{x:m,y:v,width:C,height:T}of h.getClientRects())C===0||T===0||l.push(a(m,v,C,T))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(f(this,sh)||_(this,sh,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=f(this,sh))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=f(this,sh))==null?void 0:i.get(e.data.id);if(!t)return;const r=f(this,Ri).getRawValue(t);r&&(f(this,vn)===Xe.NONE&&!r.hasBeenModified||r.renderAnnotationElement(e))}setMissingCanvas(e,t,r){var s;const i=(s=f(this,sl))==null?void 0:s.get(e);i&&(i.setCanvas(t,r),f(this,sl).delete(e))}addMissingCanvas(e,t){(f(this,sl)||_(this,sl,new Map)).set(e,t)}};nh=new WeakMap,qr=new WeakMap,rh=new WeakMap,nn=new WeakMap,xn=new WeakMap,ih=new WeakMap,Ri=new WeakMap,sh=new WeakMap,Ii=new WeakMap,rr=new WeakMap,Xa=new WeakMap,Qa=new WeakMap,oh=new WeakMap,el=new WeakMap,Ms=new WeakMap,_i=new WeakMap,Fc=new WeakMap,ty=new WeakMap,ny=new WeakMap,ah=new WeakMap,ry=new WeakMap,Ns=new WeakMap,tl=new WeakMap,lh=new WeakMap,nl=new WeakMap,Ls=new WeakMap,BA=new WeakMap,rl=new WeakMap,ch=new WeakMap,iy=new WeakMap,il=new WeakMap,jc=new WeakMap,uh=new WeakMap,sl=new WeakMap,sy=new WeakMap,vn=new WeakMap,Tt=new WeakMap,Po=new WeakMap,ol=new WeakMap,al=new WeakMap,oy=new WeakMap,dh=new WeakMap,ay=new WeakMap,ll=new WeakMap,Ds=new WeakMap,Ro=new WeakMap,ly=new WeakMap,cy=new WeakMap,ki=new WeakMap,Re=new WeakSet,DC=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},ib=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const r of f(this,xn).values())if(r.hasTextLayer(e))return r;return null},ZF=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const r=B(this,Re,DC).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(r);i&&(f(this,Ls)||_(this,Ls,new zV(this)),f(this,Ls).show(r,i,this.direction==="ltr"))},qF=function(){var s,o,a;const e=document.getSelection();if(!e||e.isCollapsed){f(this,Po)&&((s=f(this,Ls))==null||s.hide(),_(this,Po,null),B(this,Re,hr).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===f(this,Po))return;const i=B(this,Re,DC).call(this,e).closest(".textLayer");if(!i){f(this,Po)&&((o=f(this,Ls))==null||o.hide(),_(this,Po,null),B(this,Re,hr).call(this,{hasSelectedText:!1}));return}if((a=f(this,Ls))==null||a.hide(),_(this,Po,t),B(this,Re,hr).call(this,{hasSelectedText:!0}),!(f(this,vn)!==Xe.HIGHLIGHT&&f(this,vn)!==Xe.NONE)&&(f(this,vn)===Xe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),_(this,nl,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=f(this,vn)===Xe.HIGHLIGHT?B(this,Re,ib).call(this,i):null;if(l==null||l.toggleDrawing(),f(this,ch)){const c=new AbortController,u=this.combinedSignal(c),h=m=>{m.type==="pointerup"&&m.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),m.type==="pointerup"&&B(this,Re,yv).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else l==null||l.toggleDrawing(!0),B(this,Re,yv).call(this,"main_toolbar")}},yv=function(e=""){f(this,vn)===Xe.HIGHLIGHT?this.highlightSelection(e):f(this,ty)&&B(this,Re,ZF).call(this)},GF=function(){document.addEventListener("selectionchange",B(this,Re,qF).bind(this),{signal:this._signal})},KF=function(){if(f(this,tl))return;_(this,tl,new AbortController);const e=this.combinedSignal(f(this,tl));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},YF=function(){var e;(e=f(this,tl))==null||e.abort(),_(this,tl,null)},sb=function(){if(f(this,il))return;_(this,il,new AbortController);const e=this.combinedSignal(f(this,il));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},JF=function(){var e;(e=f(this,il))==null||e.abort(),_(this,il,null)},XF=function(){if(f(this,Xa))return;_(this,Xa,new AbortController);const e=this.combinedSignal(f(this,Xa));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},QF=function(){var e;(e=f(this,Xa))==null||e.abort(),_(this,Xa,null)},ej=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},hr=function(e){Object.entries(e).some(([r,i])=>f(this,ay)[r]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(f(this,ay),e)}),f(this,vn)===Xe.HIGHLIGHT&&e.hasSelectedEditor===!1&&B(this,Re,Ao).call(this,[[ut.HIGHLIGHT_FREE,!0]]))},Ao=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},tj=async function(){if(!f(this,rl)){_(this,rl,!0);const e=[];for(const t of f(this,xn).values())e.push(t.enable());await Promise.all(e);for(const t of f(this,nn).values())t.enable()}},nj=function(){if(this.unselectAll(),f(this,rl)){_(this,rl,!1);for(const e of f(this,xn).values())e.disable();for(const e of f(this,nn).values())e.disable()}},ob=function(e){const t=f(this,xn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},rj=function(){let e=null;for(e of f(this,Tt));return e},Sv=function(){if(f(this,nn).size===0)return!0;if(f(this,nn).size===1)for(const e of f(this,nn).values())return e.isEmpty();return!1},ab=function(e){for(const t of f(this,Tt))t.unselect();f(this,Tt).clear();for(const t of e)t.isEmpty()||(f(this,Tt).add(t),t.select());B(this,Re,hr).call(this,{hasSelectedEditor:this.hasSelection})},q($d,"TRANSLATE_SMALL",1),q($d,"TRANSLATE_BIG",10);let Yu=$d;var kn,Os,ts,hh,Bs,Gr,ph,Fs,kr,Io,Uc,js,cl,ps,Cv,OC;const pr=class pr{constructor(e){L(this,ps);L(this,kn,null);L(this,Os,!1);L(this,ts,null);L(this,hh,null);L(this,Bs,null);L(this,Gr,null);L(this,ph,!1);L(this,Fs,null);L(this,kr,null);L(this,Io,null);L(this,Uc,null);L(this,js,!1);_(this,kr,e),_(this,js,e._uiManager.useNewAltTextFlow),f(pr,cl)||_(pr,cl,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){pr._l10n??(pr._l10n=e)}async render(){const e=_(this,ts,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=_(this,hh,document.createElement("span"));e.append(t),f(this,js)?(e.classList.add("new"),e.setAttribute("data-l10n-id",f(pr,cl).missing),t.setAttribute("data-l10n-id",f(pr,cl)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=f(this,kr)._uiManager._signal;e.addEventListener("contextmenu",zi,{signal:r}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),f(this,kr)._uiManager.editAltText(f(this,kr)),f(this,js)&&f(this,kr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:f(this,ps,Cv)}})};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(_(this,ph,!0),i(s))},{signal:r}),await B(this,ps,OC).call(this),e}finish(){f(this,ts)&&(f(this,ts).focus({focusVisible:f(this,ph)}),_(this,ph,!1))}isEmpty(){return f(this,js)?f(this,kn)===null:!f(this,kn)&&!f(this,Os)}hasData(){return f(this,js)?f(this,kn)!==null||!!f(this,Io):this.isEmpty()}get guessedText(){return f(this,Io)}async setGuessedText(e){f(this,kn)===null&&(_(this,Io,e),_(this,Uc,await pr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),B(this,ps,OC).call(this))}toggleAltTextBadge(e=!1){var t;if(!f(this,js)||f(this,kn)){(t=f(this,Fs))==null||t.remove(),_(this,Fs,null);return}if(!f(this,Fs)){const r=_(this,Fs,document.createElement("div"));r.className="noAltTextBadge",f(this,kr).div.append(r)}f(this,Fs).classList.toggle("hidden",!e)}serialize(e){let t=f(this,kn);return!e&&f(this,Io)===t&&(t=f(this,Uc)),{altText:t,decorative:f(this,Os),guessedText:f(this,Io),textWithDisclaimer:f(this,Uc)}}get data(){return{altText:f(this,kn),decorative:f(this,Os)}}set data({altText:e,decorative:t,guessedText:r,textWithDisclaimer:i,cancel:s=!1}){r&&(_(this,Io,r),_(this,Uc,i)),!(f(this,kn)===e&&f(this,Os)===t)&&(s||(_(this,kn,e),_(this,Os,t)),B(this,ps,OC).call(this))}toggle(e=!1){f(this,ts)&&(!e&&f(this,Gr)&&(clearTimeout(f(this,Gr)),_(this,Gr,null)),f(this,ts).disabled=!e)}shown(){f(this,kr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:f(this,ps,Cv)}})}destroy(){var e,t;(e=f(this,ts))==null||e.remove(),_(this,ts,null),_(this,hh,null),_(this,Bs,null),(t=f(this,Fs))==null||t.remove(),_(this,Fs,null)}};kn=new WeakMap,Os=new WeakMap,ts=new WeakMap,hh=new WeakMap,Bs=new WeakMap,Gr=new WeakMap,ph=new WeakMap,Fs=new WeakMap,kr=new WeakMap,Io=new WeakMap,Uc=new WeakMap,js=new WeakMap,cl=new WeakMap,ps=new WeakSet,Cv=function(){return f(this,kn)&&"added"||f(this,kn)===null&&this.guessedText&&"review"||"missing"},OC=async function(){var i,s,o;const e=f(this,ts);if(!e)return;if(f(this,js)){if(e.classList.toggle("done",!!f(this,kn)),e.setAttribute("data-l10n-id",f(pr,cl)[f(this,ps,Cv)]),(i=f(this,hh))==null||i.setAttribute("data-l10n-id",f(pr,cl)[`${f(this,ps,Cv)}-label`]),!f(this,kn)){(s=f(this,Bs))==null||s.remove();return}}else{if(!f(this,kn)&&!f(this,Os)){e.classList.remove("done"),(o=f(this,Bs))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=f(this,Bs);if(!t){_(this,Bs,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${f(this,kr).id}`;const a=100,l=f(this,kr)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(f(this,Gr)),_(this,Gr,null)},{once:!0}),e.addEventListener("mouseenter",()=>{_(this,Gr,setTimeout(()=>{_(this,Gr,null),f(this,Bs).classList.add("show"),f(this,kr)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:l}),e.addEventListener("mouseleave",()=>{var c;f(this,Gr)&&(clearTimeout(f(this,Gr)),_(this,Gr,null)),(c=f(this,Bs))==null||c.classList.remove("show")},{signal:l})}f(this,Os)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=f(this,kn)),t.parentNode||e.append(t);const r=f(this,kr).getElementForAltText();r==null||r.setAttribute("aria-describedby",t.id)},L(pr,cl,null),q(pr,"_l10n",null);let gA=pr;var Wn,Mi,zc,Ft,uy,Wc,ns,Vc,$c,Hc,dy,lb;class fC{constructor(e){L(this,dy);L(this,Wn,null);L(this,Mi,null);L(this,zc,!1);L(this,Ft,null);L(this,uy,null);L(this,Wc,null);L(this,ns,null);L(this,Vc,null);L(this,$c,!1);L(this,Hc,null);_(this,Ft,e)}renderForToolbar(){const e=_(this,Mi,document.createElement("button"));return e.className="comment",B(this,dy,lb).call(this,e,!1)}renderForStandalone(){const e=_(this,Wn,document.createElement("button"));e.className="annotationCommentButton";const t=f(this,Ft).commentButtonPosition;if(t){const{style:r}=e;r.insetInlineEnd=`calc(${100*(f(this,Ft)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,r.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=f(this,Ft).commentButtonColor;i&&(r.backgroundColor=i)}return B(this,dy,lb).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=f(this,Wn)??f(this,Mi))==null||e.focus()},0)}onUpdatedColor(){if(!f(this,Wn))return;const e=f(this,Ft).commentButtonColor;e&&(f(this,Wn).style.backgroundColor=e),f(this,Ft)._uiManager.updatePopupColor(f(this,Ft))}get commentButtonWidth(){var e;return(((e=f(this,Wn))==null?void 0:e.getBoundingClientRect().width)??0)/f(this,Ft).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(f(this,Hc))return f(this,Hc);if(!f(this,Wn))return null;const{x:e,y:t,height:r}=f(this,Wn).getBoundingClientRect(),{x:i,y:s,width:o,height:a}=f(this,Ft).parent.boundingClientRect;return[(e-i)/o,(t+r-s)/a]}set commentPopupPositionInLayer(e){_(this,Hc,e)}hasDefaultPopupPosition(){return f(this,Hc)===null}removeStandaloneCommentButton(){var e;(e=f(this,Wn))==null||e.remove(),_(this,Wn,null)}removeToolbarCommentButton(){var e;(e=f(this,Mi))==null||e.remove(),_(this,Mi,null)}setCommentButtonStates({selected:e,hasPopup:t}){f(this,Wn)&&(f(this,Wn).classList.toggle("selected",e),f(this,Wn).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let r,i;if(t)[r,i]=t;else{[r,i]=f(this,Ft).commentButtonPosition;const{width:u,height:h,x:m,y:v}=f(this,Ft);r=m+r*u,i=v+i*h}const s=f(this,Ft).parent.boundingClientRect,{x:o,y:a,width:l,height:c}=s;f(this,Ft)._uiManager.editComment(f(this,Ft),o+r*l,a+i*c,{...e,parentDimensions:s})}finish(){f(this,Mi)&&(f(this,Mi).focus({focusVisible:f(this,zc)}),_(this,zc,!1))}isDeleted(){return f(this,$c)||f(this,ns)===""}isEmpty(){return f(this,ns)===null}hasBeenEdited(){return this.isDeleted()||f(this,ns)!==f(this,uy)}serialize(){return this.data}get data(){return{text:f(this,ns),richText:f(this,Wc),date:f(this,Vc),deleted:this.isDeleted()}}set data(e){if(e!==f(this,ns)&&_(this,Wc,null),e===null){_(this,ns,""),_(this,$c,!0);return}_(this,ns,e),_(this,Vc,new Date),_(this,$c,!1)}setInitialText(e,t=null){_(this,uy,e),this.data=e,_(this,Vc,null),_(this,Wc,t)}shown(){}destroy(){var e,t;(e=f(this,Mi))==null||e.remove(),_(this,Mi,null),(t=f(this,Wn))==null||t.remove(),_(this,Wn,null),_(this,ns,""),_(this,Wc,null),_(this,Vc,null),_(this,Ft,null),_(this,zc,!1),_(this,$c,!1)}}Wn=new WeakMap,Mi=new WeakMap,zc=new WeakMap,Ft=new WeakMap,uy=new WeakMap,Wc=new WeakMap,ns=new WeakMap,Vc=new WeakMap,$c=new WeakMap,Hc=new WeakMap,dy=new WeakSet,lb=function(e,t){if(!f(this,Ft)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[f(this,Ft)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const r=f(this,Ft)._uiManager._signal;if(!(r instanceof AbortSignal)||r.aborted)return e;e.addEventListener("contextmenu",zi,{signal:r}),t&&(e.addEventListener("focusin",s=>{f(this,Ft)._focusEventsAllowed=!1,cn(s)},{capture:!0,signal:r}),e.addEventListener("focusout",s=>{f(this,Ft)._focusEventsAllowed=!0,cn(s)},{capture:!0,signal:r})),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),e===f(this,Mi)?this.edit():f(this,Ft).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(_(this,zc,!0),i(s))},{signal:r}),e.addEventListener("pointerenter",()=>{f(this,Ft).toggleComment(!1,!0)},{signal:r}),e.addEventListener("pointerleave",()=>{f(this,Ft).toggleComment(!1,!1)},{signal:r}),e};var fh,Zc,hy,py,fy,my,gy,_o,qc,ko,Gc,Mo,Wl,ij,sj,oj;const ER=class ER{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:r=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:o=null,signal:a}){L(this,Wl);L(this,fh);L(this,Zc,!1);L(this,hy,null);L(this,py);L(this,fy);L(this,my);L(this,gy);L(this,_o,null);L(this,qc);L(this,ko,null);L(this,Gc);L(this,Mo,null);_(this,fh,e),_(this,hy,r),_(this,py,t),_(this,fy,i),_(this,my,s),_(this,gy,o),_(this,Gc,new AbortController),_(this,qc,AbortSignal.any([a,f(this,Gc).signal])),e.addEventListener("touchstart",B(this,Wl,ij).bind(this),{passive:!1,signal:f(this,qc)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/to.pixelRatio}destroy(){var e,t;(e=f(this,Gc))==null||e.abort(),_(this,Gc,null),(t=f(this,_o))==null||t.abort(),_(this,_o,null)}};fh=new WeakMap,Zc=new WeakMap,hy=new WeakMap,py=new WeakMap,fy=new WeakMap,my=new WeakMap,gy=new WeakMap,_o=new WeakMap,qc=new WeakMap,ko=new WeakMap,Gc=new WeakMap,Mo=new WeakMap,Wl=new WeakSet,ij=function(e){var i,s,o;if((i=f(this,py))!=null&&i.call(this))return;if(e.touches.length===1){if(f(this,_o))return;const a=_(this,_o,new AbortController),l=AbortSignal.any([f(this,qc),a.signal]),c=f(this,fh),u={capture:!0,signal:l,passive:!1},h=m=>{var v;m.pointerType==="touch"&&((v=f(this,_o))==null||v.abort(),_(this,_o,null))};c.addEventListener("pointerdown",m=>{m.pointerType==="touch"&&(cn(m),h(m))},u),c.addEventListener("pointerup",h,u),c.addEventListener("pointercancel",h,u);return}if(!f(this,Mo)){_(this,Mo,new AbortController);const a=AbortSignal.any([f(this,qc),f(this,Mo).signal]),l=f(this,fh),c={signal:a,capture:!1,passive:!1};l.addEventListener("touchmove",B(this,Wl,sj).bind(this),c);const u=B(this,Wl,oj).bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",cn,c),l.addEventListener("pointermove",cn,c),l.addEventListener("pointercancel",cn,c),l.addEventListener("pointerup",cn,c),(s=f(this,fy))==null||s.call(this)}if(cn(e),e.touches.length!==2||(o=f(this,hy))!=null&&o.call(this)){_(this,ko,null);return}let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]),_(this,ko,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:r.screenX,touch1Y:r.screenY})},sj=function(e){var I;if(!f(this,ko)||e.touches.length!==2)return;cn(e);let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]);const{screenX:i,screenY:s}=t,{screenX:o,screenY:a}=r,l=f(this,ko),{touch0X:c,touch0Y:u,touch1X:h,touch1Y:m}=l,v=h-c,C=m-u,T=o-i,E=a-s,x=Math.hypot(T,E)||1,P=Math.hypot(v,C)||1;if(!f(this,Zc)&&Math.abs(P-x)<=ER.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=i,l.touch0Y=s,l.touch1X=o,l.touch1Y=a,!f(this,Zc)){_(this,Zc,!0);return}const b=[(i+o)/2,(s+a)/2];(I=f(this,my))==null||I.call(this,b,P,x)},oj=function(e){var t;e.touches.length>=2||(f(this,Mo)&&(f(this,Mo).abort(),_(this,Mo,null),(t=f(this,gy))==null||t.call(this)),f(this,ko)&&(cn(e),_(this,ko,null),_(this,Zc,!1)))};let vA=ER;var Kc,rs,Zt,Mt,No,mh,ul,vy,Vn,Yc,Lo,Ni,dl,yy,Jc,Kr,Sy,Xc,Do,Us,gh,vh,Li,Qc,Cy,FA,Ve,cb,Ay,ub,BC,aj,lj,db,FC,hb,cj,uj,dj,pb,hj,fb,pj,fj,mj,mb,Av;const Je=class Je{constructor(e){L(this,Ve);L(this,Kc,null);L(this,rs,null);L(this,Zt,null);L(this,Mt,null);L(this,No,null);L(this,mh,!1);L(this,ul,null);L(this,vy,"");L(this,Vn,null);L(this,Yc,null);L(this,Lo,null);L(this,Ni,null);L(this,dl,null);L(this,yy,"");L(this,Jc,!1);L(this,Kr,null);L(this,Sy,!1);L(this,Xc,!1);L(this,Do,!1);L(this,Us,null);L(this,gh,0);L(this,vh,0);L(this,Li,null);L(this,Qc,null);q(this,"isSelected",!1);q(this,"_isCopy",!1);q(this,"_editToolbar",null);q(this,"_initialOptions",Object.create(null));q(this,"_initialData",null);q(this,"_isVisible",!0);q(this,"_uiManager",null);q(this,"_focusEventsAllowed",!0);L(this,Cy,!1);L(this,FA,Je._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,i],this.pageTranslation=[s,o];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Je.prototype._resizeWithKeyboard,t=Yu.TRANSLATE_SMALL,r=Yu.TRANSLATE_BIG;return Ye(this,"_resizerKeyboardManager",new ZS([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],Je.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ye(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new $V({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Je._l10n??(Je._l10n=e),Je._l10nResizer||(Je._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Je._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);Je._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Dt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return f(this,Cy)}set _isDraggable(e){var t;_(this,Cy,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=f(this,FA)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(B(this,Ve,Av).call(this),(t=f(this,Ni))==null||t.remove(),_(this,Ni,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(f(this,Jc)?_(this,Jc,!1):this.parent.setSelected(this))}focusout(e){var r;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,r,i){const[s,o]=this.parentDimensions;[r,i]=this.screenToPageTranslation(r,i),this.x=(e+r)/s,this.y=(t+i)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[r,i]=this.parentDimensions;this.setAt(e*r,t*i,this.width*r,this.height*i),this._onTranslated()}translate(e,t){B(this,Ve,cb).call(this,this.parentDimensions,e,t)}translateInPage(e,t){f(this,Kr)||_(this,Kr,[this.x,this.y,this.width,this.height]),B(this,Ve,cb).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){f(this,Kr)||_(this,Kr,[this.x,this.y,this.width,this.height]);const{div:r,parentDimensions:[i,s]}=this;if(this.x+=e/i,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[l,c]=this.getBaseTranslation();o+=l,a+=c;const{style:u}=r;u.left=`${(100*o).toFixed(2)}%`,u.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),r.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!f(this,Kr)&&(f(this,Kr)[0]!==this.x||f(this,Kr)[1]!==this.y)}get _hasBeenResized(){return!!f(this,Kr)&&(f(this,Kr)[2]!==this.width||f(this,Kr)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:r}=Je,i=r/e,s=r/t;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[r,i]}=this;let{x:s,y:o,width:a,height:l}=this;if(a*=r,l*=i,s*=r,o*=i,this._mustFixPosition)switch(e){case 0:s=Sr(s,0,r-a),o=Sr(o,0,i-l);break;case 90:s=Sr(s,0,r-l),o=Sr(o,a,i);break;case 180:s=Sr(s,a,r),o=Sr(o,l,i);break;case 270:s=Sr(s,l,r),o=Sr(o,0,i-a);break}this.x=s/=r,this.y=o/=i;const[c,u]=this.getBaseTranslation();s+=c,o+=u,t.left=`${(100*s).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var r;return B(r=Je,Ay,ub).call(r,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var r;return B(r=Je,Ay,ub).call(r,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,r]}=this;return[t*e,r*e]}setDims(){const{div:{style:e},width:t,height:r}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*r).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=f(this,Zt))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||f(this,Xc))return this._editToolbar;this._editToolbar=new eb(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,r]of e)await this._editToolbar.addButton(t,r);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=f(this,Zt))==null||t.destroy()}addContainer(e){var r;const t=(r=this._editToolbar)==null?void 0:r.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return f(this,Zt)||(gA.initialize(Je._l10n),_(this,Zt,new gA(this)),f(this,Kc)&&(f(this,Zt).data=f(this,Kc),_(this,Kc,null))),f(this,Zt)}get altTextData(){var e;return(e=f(this,Zt))==null?void 0:e.data}set altTextData(e){f(this,Zt)&&(f(this,Zt).data=e)}get guessedAltText(){var e;return(e=f(this,Zt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=f(this,Zt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=f(this,Zt))==null?void 0:t.serialize(e)}hasAltText(){return!!f(this,Zt)&&!f(this,Zt).isEmpty()}hasAltTextData(){var e;return((e=f(this,Zt))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=f(this,Mt))==null||e.focusButton()}addCommentButton(){return this.canAddComment?f(this,Mt)||_(this,Mt,new fC(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(f(this,No)){this._uiManager.isEditingMode()&&f(this,No).classList.remove("hidden");return}this.hasComment&&(_(this,No,f(this,Mt).renderForStandalone()),this.div.append(f(this,No)))}}removeStandaloneCommentButton(){f(this,Mt).removeStandaloneCommentButton(),_(this,No,null)}hideStandaloneCommentButton(){var e;(e=f(this,No))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:r,deleted:i}}=f(this,Mt);return{text:t,richText:e,date:r,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){f(this,Mt)||_(this,Mt,new fC(this)),f(this,Mt).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:r}){if(!t||(f(this,Mt)||_(this,Mt,new fC(this)),f(this,Mt).setInitialText(e,r),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return(e=f(this,Mt))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=f(this,Mt))==null?void 0:e.isDeleted()}get hasComment(){return!!f(this,Mt)&&!f(this,Mt).isEmpty()&&!f(this,Mt).isDeleted()}async editComment(e){f(this,Mt)||_(this,Mt,new fC(this)),f(this,Mt).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){f(this,Mt).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[s]=this.pageDimensions,[o]=this.pageTranslation,a=o+s+1,l=i-100,c=a+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[a,l,c,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){f(this,Mt).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var o;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=f(this,mh)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),B(this,Ve,fb).call(this);const[t,r]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*r/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/r).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),$F(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(f(this,Qc)||_(this,Qc,new vA({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:B(this,Ve,cj).bind(this),onPinching:B(this,Ve,uj).bind(this),onPinchEnd:B(this,Ve,dj).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(o=this._uiManager._editorUndoBar)==null||o.hide(),e}pointerdown(e){const{isMac:t}=Pn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(_(this,Jc,!0),this._isDraggable){B(this,Ve,hj).call(this,e);return}B(this,Ve,pb).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){f(this,Us)&&clearTimeout(f(this,Us)),_(this,Us,setTimeout(()=>{var e;_(this,Us,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,r){e.changeParent(this),this.x=t,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,r=this.rotation){const i=this.parentScale,[s,o]=this.pageDimensions,[a,l]=this.pageTranslation,c=e/i,u=t/i,h=this.x*s,m=this.y*o,v=this.width*s,C=this.height*o;switch(r){case 0:return[h+c+a,o-m-u-C+l,h+c+v+a,o-m-u+l];case 90:return[h+u+a,o-m+c+l,h+u+C+a,o-m+c+v+l];case 180:return[h-c-v+a,o-m+u+l,h-c+a,o-m+u+C+l];case 270:return[h-u-C+a,o-m-c-v+l,h-u+a,o-m-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[r,i,s,o]=e,a=s-r,l=o-i;switch(this.rotation){case 0:return[r,t-o,a,l];case 90:return[r,t-i,l,a];case 180:return[s,t-i,a,l];case 270:return[s,t-o,l,a];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Je._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=f(this,Mt))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:r,opacity:i,deleted:s,richText:o},uid:a,pageIndex:l,creationDate:c,modificationDate:u}=this;return{id:a,pageIndex:l,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:c,modificationDate:r||u,popupRef:!s,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),_(this,Xc,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),_(this,Xc,!1),!0):!1}isInEditMode(){return f(this,Xc)}shouldGetKeyboardEvents(){return f(this,Do)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:r,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:o}=window;return t<o&&i>0&&e<s&&r>0}rebuild(){B(this,Ve,fb).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var r;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((r=this._initialData)==null?void 0:r.popupRef)||""}}static async deserialize(e,t,r){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:r,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,_(i,Kc,e.accessibilityData),i._isCopy=e.isCopy||!1;const[s,o]=i.pageDimensions,[a,l,c,u]=i.getRectInCurrentCoords(e.rect,o);return i.x=a/s,i.y=l/o,i.width=c/s,i.height=u/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,r;if((e=f(this,dl))==null||e.abort(),_(this,dl,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),f(this,Us)&&(clearTimeout(f(this,Us)),_(this,Us,null)),B(this,Ve,Av).call(this),this.removeEditToolbar(),f(this,Li)){for(const i of f(this,Li).values())clearTimeout(i);_(this,Li,null)}this.parent=null,(t=f(this,Qc))==null||t.destroy(),_(this,Qc,null),(r=f(this,Ni))==null||r.remove(),_(this,Ni,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(B(this,Ve,aj).call(this),f(this,Vn).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[r,i,s,o]=this.getPDFRect();return[Je._round(r+(s-r)*e),Je._round(i+(o-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return f(this,Mt).commentPopupPositionInLayer}set commentPopupPosition(e){f(this,Mt).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return f(this,Mt).hasDefaultPopupPosition()}get commentButtonWidth(){return f(this,Mt).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=f(this,Mt))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),_(this,Lo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=f(this,Vn).children;if(!f(this,rs)){_(this,rs,Array.from(t));const o=B(this,Ve,pj).bind(this),a=B(this,Ve,fj).bind(this),l=this._uiManager._signal;for(const c of f(this,rs)){const u=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",o,{signal:l}),c.addEventListener("blur",a,{signal:l}),c.addEventListener("focus",B(this,Ve,mj).bind(this,u),{signal:l}),c.setAttribute("data-l10n-id",Je._l10nResizer[u])}}const r=f(this,rs)[0];let i=0;for(const o of t){if(o===r)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(f(this,rs).length/4);if(s!==i){if(s<i)for(let a=0;a<i-s;a++)f(this,Vn).append(f(this,Vn).firstElementChild);else if(s>i)for(let a=0;a<s-i;a++)f(this,Vn).firstElementChild.before(f(this,Vn).lastElementChild);let o=0;for(const a of t){const c=f(this,rs)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",Je._l10nResizer[c])}}B(this,Ve,mb).call(this,0),_(this,Do,!0),f(this,Vn).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){f(this,Do)&&B(this,Ve,hb).call(this,f(this,yy),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){B(this,Ve,Av).call(this),this.div.focus()}select(){var e,t,r;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(t=this._editToolbar)==null||t.show(),(r=f(this,Zt))==null||r.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,r,i,s;this.isSelected&&(this.isSelected=!1,(e=f(this,Vn))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(r=this.div)!=null&&r.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(s=f(this,Zt))==null||s.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return f(this,Sy)}set isEditing(e){_(this,Sy,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){f(this,Li)||_(this,Li,new Map);const{action:r}=e;let i=f(this,Li).get(r);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),f(this,Li).delete(r),f(this,Li).size===0&&_(this,Li,null)},Je._telemetryTimeout),f(this,Li).set(r,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),_(this,mh,!1)}disable(){this.div&&(this.div.tabIndex=-1),_(this,mh,!0)}updateFakeAnnotationElement(e){if(!f(this,Ni)&&!this.deleted){_(this,Ni,e.addFakeAnnotation(this));return}if(this.deleted){f(this,Ni).remove(),_(this,Ni,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&f(this,Ni).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const r=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),r.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Kc=new WeakMap,rs=new WeakMap,Zt=new WeakMap,Mt=new WeakMap,No=new WeakMap,mh=new WeakMap,ul=new WeakMap,vy=new WeakMap,Vn=new WeakMap,Yc=new WeakMap,Lo=new WeakMap,Ni=new WeakMap,dl=new WeakMap,yy=new WeakMap,Jc=new WeakMap,Kr=new WeakMap,Sy=new WeakMap,Xc=new WeakMap,Do=new WeakMap,Us=new WeakMap,gh=new WeakMap,vh=new WeakMap,Li=new WeakMap,Qc=new WeakMap,Cy=new WeakMap,FA=new WeakMap,Ve=new WeakSet,cb=function([e,t],r,i){[r,i]=this.screenToPageTranslation(r,i),this.x+=r/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Ay=new WeakSet,ub=function(e,t,r){switch(r){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},BC=function(e){switch(e){case 90:{const[t,r]=this.pageDimensions;return[0,-t/r,r/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,r]=this.pageDimensions;return[0,t/r,-r/t,0]}default:return[1,0,0,1]}},aj=function(){if(f(this,Vn))return;_(this,Vn,document.createElement("div")),f(this,Vn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const r of e){const i=document.createElement("div");f(this,Vn).append(i),i.classList.add("resizer",r),i.setAttribute("data-resizer-name",r),i.addEventListener("pointerdown",B(this,Ve,lj).bind(this,r),{signal:t}),i.addEventListener("contextmenu",zi,{signal:t}),i.tabIndex=-1}this.div.prepend(f(this,Vn))},lj=function(e,t){var u;t.preventDefault();const{isMac:r}=Pn.platform;if(t.button!==0||t.ctrlKey&&r)return;(u=f(this,Zt))==null||u.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,_(this,Yc,[t.screenX,t.screenY]);const s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",B(this,Ve,hb).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",cn,{passive:!1,signal:o}),window.addEventListener("contextmenu",zi,{signal:o}),_(this,Lo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var h;s.abort(),this.parent.togglePointerEvents(!0),(h=f(this,Zt))==null||h.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=a,this.div.style.cursor=l,B(this,Ve,FC).call(this)};window.addEventListener("pointerup",c,{signal:o}),window.addEventListener("blur",c,{signal:o})},db=function(e,t,r,i){this.width=r,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},FC=function(){if(!f(this,Lo))return;const{savedX:e,savedY:t,savedWidth:r,savedHeight:i}=f(this,Lo);_(this,Lo,null);const s=this.x,o=this.y,a=this.width,l=this.height;s===e&&o===t&&a===r&&l===i||this.addCommands({cmd:B(this,Ve,db).bind(this,s,o,a,l),undo:B(this,Ve,db).bind(this,e,t,r,i),mustExec:!0})},hb=function(e,t){const[r,i]=this.parentDimensions,s=this.x,o=this.y,a=this.width,l=this.height,c=Je.MIN_SIZE/r,u=Je.MIN_SIZE/i,h=B(this,Ve,BC).call(this,this.rotation),m=(G,X)=>[h[0]*G+h[2]*X,h[1]*G+h[3]*X],v=B(this,Ve,BC).call(this,360-this.rotation),C=(G,X)=>[v[0]*G+v[2]*X,v[1]*G+v[3]*X];let T,E,x=!1,P=!1;switch(e){case"topLeft":x=!0,T=(G,X)=>[0,0],E=(G,X)=>[G,X];break;case"topMiddle":T=(G,X)=>[G/2,0],E=(G,X)=>[G/2,X];break;case"topRight":x=!0,T=(G,X)=>[G,0],E=(G,X)=>[0,X];break;case"middleRight":P=!0,T=(G,X)=>[G,X/2],E=(G,X)=>[0,X/2];break;case"bottomRight":x=!0,T=(G,X)=>[G,X],E=(G,X)=>[0,0];break;case"bottomMiddle":T=(G,X)=>[G/2,X],E=(G,X)=>[G/2,0];break;case"bottomLeft":x=!0,T=(G,X)=>[0,X],E=(G,X)=>[G,0];break;case"middleLeft":P=!0,T=(G,X)=>[0,X/2],E=(G,X)=>[G,X/2];break}const b=T(a,l),I=E(a,l);let M=m(...I);const N=Je._round(s+M[0]),D=Je._round(o+M[1]);let j=1,F=1,z,W;if(t.fromKeyboard)({deltaX:z,deltaY:W}=t);else{const{screenX:G,screenY:X}=t,[Y,ce]=f(this,Yc);[z,W]=this.screenToPageTranslation(G-Y,X-ce),f(this,Yc)[0]=G,f(this,Yc)[1]=X}if([z,W]=C(z/r,W/i),x){const G=Math.hypot(a,l);j=F=Math.max(Math.min(Math.hypot(I[0]-b[0]-z,I[1]-b[1]-W)/G,1/a,1/l),c/a,u/l)}else P?j=Sr(Math.abs(I[0]-b[0]-z),c,1)/a:F=Sr(Math.abs(I[1]-b[1]-W),u,1)/l;const H=Je._round(a*j),V=Je._round(l*F);M=m(...E(H,V));const K=N-M[0],ee=D-M[1];f(this,Kr)||_(this,Kr,[this.x,this.y,this.width,this.height]),this.width=H,this.height=V,this.x=K,this.y=ee,this.setDims(),this.fixAndSetPosition(),this._onResizing()},cj=function(){var e;_(this,Lo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=f(this,Zt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},uj=function(e,t,r){let s=.7*(r/t)+1-.7;if(s===1)return;const o=B(this,Ve,BC).call(this,this.rotation),a=(N,D)=>[o[0]*N+o[2]*D,o[1]*N+o[3]*D],[l,c]=this.parentDimensions,u=this.x,h=this.y,m=this.width,v=this.height,C=Je.MIN_SIZE/l,T=Je.MIN_SIZE/c;s=Math.max(Math.min(s,1/m,1/v),C/m,T/v);const E=Je._round(m*s),x=Je._round(v*s);if(E===m&&x===v)return;f(this,Kr)||_(this,Kr,[u,h,m,v]);const P=a(m/2,v/2),b=Je._round(u+P[0]),I=Je._round(h+P[1]),M=a(E/2,x/2);this.x=b-M[0],this.y=I-M[1],this.width=E,this.height=x,this.setDims(),this.fixAndSetPosition(),this._onResizing()},dj=function(){var e;(e=f(this,Zt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),B(this,Ve,FC).call(this)},pb=function(e){const{isMac:t}=Pn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},hj=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let r=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:s},a=c=>{i.abort(),_(this,ul,null),_(this,Jc,!1),this._uiManager.endDragSession()||B(this,Ve,pb).call(this,c),r&&this._onStopDragging()};t&&(_(this,gh,e.clientX),_(this,vh,e.clientY),_(this,ul,e.pointerId),_(this,vy,e.pointerType),window.addEventListener("pointermove",c=>{r||(r=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:u,clientY:h,pointerId:m}=c;if(m!==f(this,ul)){cn(c);return}const[v,C]=this.screenToPageTranslation(u-f(this,gh),h-f(this,vh));_(this,gh,u),_(this,vh,h),this._uiManager.dragSelectedEditors(v,C)},o),window.addEventListener("touchmove",cn,o),window.addEventListener("pointerdown",c=>{c.pointerType===f(this,vy)&&(f(this,Qc)||c.isPrimary)&&a(c),cn(c)},o));const l=c=>{if(!f(this,ul)||f(this,ul)===c.pointerId){a(c);return}cn(c)};window.addEventListener("pointerup",l,{signal:s}),window.addEventListener("blur",l,{signal:s})},fb=function(){if(f(this,dl)||!this.div)return;_(this,dl,new AbortController);const e=this._uiManager.combinedSignal(f(this,dl));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},pj=function(e){Je._resizerKeyboardManager.exec(this,e)},fj=function(e){var t;f(this,Do)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==f(this,Vn)&&B(this,Ve,Av).call(this)},mj=function(e){_(this,yy,f(this,Do)?e:"")},mb=function(e){if(f(this,rs))for(const t of f(this,rs))t.tabIndex=e},Av=function(){_(this,Do,!1),B(this,Ve,mb).call(this,-1),B(this,Ve,FC).call(this)},L(Je,Ay),q(Je,"_l10n",null),q(Je,"_l10nResizer",null),q(Je,"_borderLineWidth",-1),q(Je,"_colorManager",new rb),q(Je,"_zIndex",1),q(Je,"_telemetryTimeout",1e3);let Ut=Je;class $V extends Ut{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const xD=3285377520,xi=4294901760,_s=65535;class gj{constructor(e){this.h1=e?e&4294967295:xD,this.h2=e?e&4294967295:xD}update(e){let t,r;if(typeof e=="string"){t=new Uint8Array(e.length*2),r=0;for(let T=0,E=e.length;T<E;T++){const x=e.charCodeAt(T);x<=255?t[r++]=x:(t[r++]=x>>>8,t[r++]=x&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),r=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=r>>2,s=r-i*4,o=new Uint32Array(t.buffer,0,i);let a=0,l=0,c=this.h1,u=this.h2;const h=3432918353,m=461845907,v=h&_s,C=m&_s;for(let T=0;T<i;T++)T&1?(a=o[T],a=a*h&xi|a*v&_s,a=a<<15|a>>>17,a=a*m&xi|a*C&_s,c^=a,c=c<<13|c>>>19,c=c*5+3864292196):(l=o[T],l=l*h&xi|l*v&_s,l=l<<15|l>>>17,l=l*m&xi|l*C&_s,u^=l,u=u<<13|u>>>19,u=u*5+3864292196);switch(a=0,s){case 3:a^=t[i*4+2]<<16;case 2:a^=t[i*4+1]<<8;case 1:a^=t[i*4],a=a*h&xi|a*v&_s,a=a<<15|a>>>17,a=a*m&xi|a*C&_s,i&1?c^=a:u^=a}this.h1=c,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&xi|e*36045&_s,t=t*4283543511&xi|((t<<16|e>>>16)*2950163797&xi)>>>16,e^=t>>>1,e=e*444984403&xi|e*60499&_s,t=t*3301882366&xi|((t<<16|e>>>16)*3120437893&xi)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const gb=Object.freeze({map:null,hash:"",transfer:void 0});var eu,tu,Oo,$n,jA,vj;class nR{constructor(){L(this,jA);L(this,eu,!1);L(this,tu,null);L(this,Oo,null);L(this,$n,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const r=f(this,$n).get(e);return r===void 0?t:Object.assign(t,r)}getRawValue(e){return f(this,$n).get(e)}remove(e){const t=f(this,$n).get(e);if(t!==void 0&&(t instanceof Ut&&f(this,Oo).delete(t.annotationElementId),f(this,$n).delete(e),f(this,$n).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const r of f(this,$n).values())if(r instanceof Ut)return;this.onAnnotationEditor(null)}}setValue(e,t){const r=f(this,$n).get(e);let i=!1;if(r!==void 0)for(const[s,o]of Object.entries(t))r[s]!==o&&(i=!0,r[s]=o);else i=!0,f(this,$n).set(e,t);i&&B(this,jA,vj).call(this),t instanceof Ut&&((f(this,Oo)||_(this,Oo,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return f(this,$n).has(e)}get size(){return f(this,$n).size}resetModified(){f(this,eu)&&(_(this,eu,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new yj(this)}get serializable(){if(f(this,$n).size===0)return gb;const e=new Map,t=new gj,r=[],i=Object.create(null);let s=!1;for(const[o,a]of f(this,$n)){const l=a instanceof Ut?a.serialize(!1,i):a;l&&(e.set(o,l),t.update(`${o}:${JSON.stringify(l)}`),s||(s=!!l.bitmap))}if(s)for(const o of e.values())o.bitmap&&r.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:r}:gb}get editorStats(){let e=null;const t=new Map;let r=0,i=0;for(const s of f(this,$n).values()){if(!(s instanceof Ut)){s.popup&&(s.popup.deleted?i+=1:r+=1);continue}s.isCommentDeleted?i+=1:s.hasEditedComment&&(r+=1);const o=s.telemetryFinalData;if(!o)continue;const{type:a}=o;t.has(a)||t.set(a,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const l=e[a]||(e[a]=new Map);for(const[c,u]of Object.entries(o)){if(c==="type")continue;let h=l.get(c);h||(h=new Map,l.set(c,h));const m=h.get(u)??0;h.set(u,m+1)}}if((i>0||r>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:r}),!e)return null;for(const[s,o]of t)e[s]=o.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){_(this,tu,null)}updateEditor(e,t){var i;const r=(i=f(this,Oo))==null?void 0:i.get(e);return r?(r.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=f(this,Oo))==null?void 0:t.get(e))||null}get modifiedIds(){if(f(this,tu))return f(this,tu);const e=[];if(f(this,Oo))for(const t of f(this,Oo).values())t.serialize()&&e.push(t.annotationElementId);return _(this,tu,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return f(this,$n).entries()}}eu=new WeakMap,tu=new WeakMap,Oo=new WeakMap,$n=new WeakMap,jA=new WeakSet,vj=function(){f(this,eu)||(_(this,eu,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Ty;class yj extends nR{constructor(t){super();L(this,Ty);const{map:r,hash:i,transfer:s}=t.serializable,o=structuredClone(r,s?{transfer:s}:null);_(this,Ty,{map:o,hash:i,transfer:s})}get print(){Dt("Should not call PrintAnnotationStorage.print")}get serializable(){return f(this,Ty)}get modifiedIds(){return Ye(this,"modifiedIds",{ids:new Set,hash:""})}}Ty=new WeakMap;var yh;class HV{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){L(this,yh,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),f(this,yh).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:r}){if(!(!e||f(this,yh).has(e.loadedName))){if(dt(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:o}=e,a=new FontFace(i,s,o);this.addNativeFontFace(a);try{await a.load(),f(this,yh).add(i),r==null||r(e)}catch{Ze(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Dt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw Ze(`Failed to load font '${r.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const i=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Ye(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Ye(this,"isSyncFontLoadingSupported",yr||Pn.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(dt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.length>0&&r[0].done;){const s=r.shift();setTimeout(s.callback,0)}}const{loadingRequests:r}=this,i={done:!1,complete:t,callback:e};return r.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ye(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function r(I,M){return I.charCodeAt(M)<<24|I.charCodeAt(M+1)<<16|I.charCodeAt(M+2)<<8|I.charCodeAt(M+3)&255}function i(I,M,N,D){const j=I.substring(0,M),F=I.substring(M+N);return j+D+F}let s,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let c=0;function u(I,M){if(++c>30){Ze("Load test font never loaded."),M();return}if(l.font="30px "+I,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){M();return}setTimeout(u.bind(null,I,M))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=i(m,976,h.length,h);const C=16,T=1482184792;let E=r(m,C);for(s=0,o=h.length-3;s<o;s+=4)E=E-T+r(h,s)|0;s<h.length&&(E=E-T+r(h+"XXX",s)|0),m=i(m,C,4,wV(E));const x=`url(data:font/opentype;base64,${btoa(m)});`,P=`@font-face {font-family:"${h}";src:${x}}`;this.insertRule(P);const b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(const I of[e.loadedName,h]){const M=this._document.createElement("span");M.textContent="Hi",M.style.fontFamily=I,b.append(M)}this._document.body.append(b),u(h,()=>{b.remove(),t.complete()})}}yh=new WeakMap;var Pt;class ZV{constructor(e,t=null,r,i){L(this,Pt);this.compiledGlyphs=Object.create(null),_(this,Pt,e),this._inspectFont=t,r&&Object.assign(this,r),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var r;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${DF(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(r=this._inspectFont)==null||r.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const r=this.loadedName+"_path_"+t;let i;try{i=e.get(r)}catch(o){Ze(`getPathGenerator - ignoring character: "${o}".`)}const s=FF(i==null?void 0:i.path);return this.fontExtraProperties||e.delete(r),this.compiledGlyphs[t]=s}get black(){return f(this,Pt).black}get bold(){return f(this,Pt).bold}get disableFontFace(){return f(this,Pt).disableFontFace??!1}set disableFontFace(e){Ye(this,"disableFontFace",!!e)}get fontExtraProperties(){return f(this,Pt).fontExtraProperties??!1}get isInvalidPDFjsFont(){return f(this,Pt).isInvalidPDFjsFont}get isType3Font(){return f(this,Pt).isType3Font}get italic(){return f(this,Pt).italic}get missingFile(){return f(this,Pt).missingFile}get remeasure(){return f(this,Pt).remeasure}get vertical(){return f(this,Pt).vertical}get ascent(){return f(this,Pt).ascent}get defaultWidth(){return f(this,Pt).defaultWidth}get descent(){return f(this,Pt).descent}get bbox(){return f(this,Pt).bbox}set bbox(e){Ye(this,"bbox",e)}get fontMatrix(){return f(this,Pt).fontMatrix}get fallbackName(){return f(this,Pt).fallbackName}get loadedName(){return f(this,Pt).loadedName}get mimetype(){return f(this,Pt).mimetype}get name(){return f(this,Pt).name}get data(){return f(this,Pt).data}clearData(){f(this,Pt).clearData()}get cssFontInfo(){return f(this,Pt).cssFontInfo}get systemFontInfo(){return f(this,Pt).systemFontInfo}get defaultVMetrics(){return f(this,Pt).defaultVMetrics}}Pt=new WeakMap;var Sh,Ch,Ey,Ah,jC;const Hd=class Hd{constructor(e){L(this,Ah);L(this,Sh);L(this,Ch);L(this,Ey);_(this,Sh,e),_(this,Ch,new DataView(f(this,Sh))),_(this,Ey,new TextDecoder)}static write(e){const t=new TextEncoder,r={};let i=0;for(const c of Hd.strings){const u=t.encode(e[c]);r[c]=u,i+=4+u.length}const s=new ArrayBuffer(i),o=new Uint8Array(s),a=new DataView(s);let l=0;for(const c of Hd.strings){const u=r[c],h=u.length;a.setUint32(l,h),o.set(u,l+4),l+=4+h}return dt(l===s.byteLength,"CssFontInfo.write: Buffer overflow"),s}get fontFamily(){return B(this,Ah,jC).call(this,0)}get fontWeight(){return B(this,Ah,jC).call(this,1)}get italicAngle(){return B(this,Ah,jC).call(this,2)}};Sh=new WeakMap,Ch=new WeakMap,Ey=new WeakMap,Ah=new WeakSet,jC=function(e){dt(e<Hd.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=f(this,Ch).getUint32(t)+4;const r=f(this,Ch).getUint32(t);return f(this,Ey).decode(new Uint8Array(f(this,Sh),t+4,r))},q(Hd,"strings",["fontFamily","fontWeight","italicAngle"]);let yA=Hd;var hl,zs,nu,ru,Tv;const Zd=class Zd{constructor(e){L(this,ru);L(this,hl);L(this,zs);L(this,nu);_(this,hl,e),_(this,zs,new DataView(f(this,hl))),_(this,nu,new TextDecoder)}static write(e){const t=new TextEncoder,r={};let i=0;for(const m of Zd.strings){const v=t.encode(e[m]);r[m]=v,i+=4+v.length}i+=4;let s,o,a=1+i;e.style&&(s=t.encode(e.style.style),o=t.encode(e.style.weight),a+=4+s.length+4+o.length);const l=new ArrayBuffer(a),c=new Uint8Array(l),u=new DataView(l);let h=0;u.setUint8(h++,e.guessFallback?1:0),u.setUint32(h,0),h+=4,i=0;for(const m of Zd.strings){const v=r[m],C=v.length;i+=4+C,u.setUint32(h,C),c.set(v,h+4),h+=4+C}return u.setUint32(h-i-4,i),e.style&&(u.setUint32(h,s.length),c.set(s,h+4),h+=4+s.length,u.setUint32(h,o.length),c.set(o,h+4),h+=4+o.length),dt(h<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(h)}get guessFallback(){return f(this,zs).getUint8(0)!==0}get css(){return B(this,ru,Tv).call(this,0)}get loadedName(){return B(this,ru,Tv).call(this,1)}get baseFontName(){return B(this,ru,Tv).call(this,2)}get src(){return B(this,ru,Tv).call(this,3)}get style(){let e=1;e+=4+f(this,zs).getUint32(e);const t=f(this,zs).getUint32(e),r=f(this,nu).decode(new Uint8Array(f(this,hl),e+4,t));e+=4+t;const i=f(this,zs).getUint32(e),s=f(this,nu).decode(new Uint8Array(f(this,hl),e+4,i));return{style:r,weight:s}}};hl=new WeakMap,zs=new WeakMap,nu=new WeakMap,ru=new WeakSet,Tv=function(e){dt(e<Zd.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=f(this,zs).getUint32(t)+4;const r=f(this,zs).getUint32(t);return f(this,nu).decode(new Uint8Array(f(this,hl),t+4,r))},q(Zd,"strings",["css","loadedName","baseFontName","src"]);let SA=Zd;var Th,Eh,xh,wh,Yr,Ws,xy,Rt,ln,Qi,UC,Ev;const Qe=class Qe{constructor({data:e,extra:t}){L(this,ln);L(this,Ws);L(this,xy);L(this,Rt);_(this,Ws,e),_(this,xy,new TextDecoder),_(this,Rt,new DataView(f(this,Ws))),t&&Object.assign(this,t)}get black(){return B(this,ln,Qi).call(this,0)}get bold(){return B(this,ln,Qi).call(this,1)}get disableFontFace(){return B(this,ln,Qi).call(this,2)}get fontExtraProperties(){return B(this,ln,Qi).call(this,3)}get isInvalidPDFjsFont(){return B(this,ln,Qi).call(this,4)}get isType3Font(){return B(this,ln,Qi).call(this,5)}get italic(){return B(this,ln,Qi).call(this,6)}get missingFile(){return B(this,ln,Qi).call(this,7)}get remeasure(){return B(this,ln,Qi).call(this,8)}get vertical(){return B(this,ln,Qi).call(this,9)}get ascent(){return B(this,ln,UC).call(this,0)}get defaultWidth(){return B(this,ln,UC).call(this,1)}get descent(){return B(this,ln,UC).call(this,2)}get bbox(){let e=f(Qe,Eh);if(f(this,Rt).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<4;i++)r.push(f(this,Rt).getInt16(e,!0)),e+=2;return r}get fontMatrix(){let e=f(Qe,xh);if(f(this,Rt).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<6;i++)r.push(f(this,Rt).getFloat64(e,!0)),e+=8;return r}get defaultVMetrics(){let e=f(Qe,wh);if(f(this,Rt).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<3;i++)r.push(f(this,Rt).getInt16(e,!0)),e+=2;return r}get fallbackName(){return B(this,ln,Ev).call(this,0)}get loadedName(){return B(this,ln,Ev).call(this,1)}get mimetype(){return B(this,ln,Ev).call(this,2)}get name(){return B(this,ln,Ev).call(this,3)}get data(){let e=f(Qe,Yr);const t=f(this,Rt).getUint32(e);e+=4+t;const r=f(this,Rt).getUint32(e);e+=4+r;const i=f(this,Rt).getUint32(e);e+=4+i;const s=f(this,Rt).getUint32(e);if(s!==0)return new Uint8Array(f(this,Ws),e+4,s)}clearData(){let e=f(Qe,Yr);const t=f(this,Rt).getUint32(e);e+=4+t;const r=f(this,Rt).getUint32(e);e+=4+r;const i=f(this,Rt).getUint32(e);e+=4+i;const s=f(this,Rt).getUint32(e);new Uint8Array(f(this,Ws),e+4,s).fill(0),f(this,Rt).setUint32(e,0)}get cssFontInfo(){let e=f(Qe,Yr);const t=f(this,Rt).getUint32(e);e+=4+t;const r=f(this,Rt).getUint32(e);e+=4+r;const i=f(this,Rt).getUint32(e);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(f(this,Ws),e+4,i)),new yA(s.buffer)}get systemFontInfo(){let e=f(Qe,Yr);const t=f(this,Rt).getUint32(e);e+=4+t;const r=f(this,Rt).getUint32(e);if(r===0)return null;const i=new Uint8Array(r);return i.set(new Uint8Array(f(this,Ws),e+4,r)),new SA(i.buffer)}static write(e){const t=e.systemFontInfo?SA.write(e.systemFontInfo):null,r=e.cssFontInfo?yA.write(e.cssFontInfo):null,i=new TextEncoder,s={};let o=0;for(const T of Qe.strings)s[T]=i.encode(e[T]),o+=4+s[T].length;const a=f(Qe,Yr)+4+o+4+(t?t.byteLength:0)+4+(r?r.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(a),c=new Uint8Array(l),u=new DataView(l);let h=0;const m=Qe.bools.length;let v=0,C=0;for(let T=0;T<m;T++){const E=e[Qe.bools[T]];v|=(E===void 0?0:E?2:1)<<C,C+=2,(C===8||T===m-1)&&(u.setUint8(h++,v),v=0,C=0)}dt(h===f(Qe,Th),"FontInfo.write: Boolean properties offset mismatch");for(const T of Qe.numbers)u.setFloat64(h,e[T]),h+=8;if(dt(h===f(Qe,Eh),"FontInfo.write: Number properties offset mismatch"),e.bbox){u.setUint8(h++,4);for(const T of e.bbox)u.setInt16(h,T,!0),h+=2}else u.setUint8(h++,0),h+=8;if(dt(h===f(Qe,xh),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){u.setUint8(h++,6);for(const T of e.fontMatrix)u.setFloat64(h,T,!0),h+=8}else u.setUint8(h++,0),h+=48;if(dt(h===f(Qe,wh),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){u.setUint8(h++,1);for(const T of e.defaultVMetrics)u.setInt16(h,T,!0),h+=2}else u.setUint8(h++,0),h+=6;dt(h===f(Qe,Yr),"FontInfo.write: DefaultVMetrics properties offset mismatch"),u.setUint32(f(Qe,Yr),0),h+=4;for(const T of Qe.strings){const E=s[T],x=E.length;u.setUint32(h,x),c.set(E,h+4),h+=4+x}if(u.setUint32(f(Qe,Yr),h-f(Qe,Yr)-4),!t)u.setUint32(h,0),h+=4;else{const T=t.byteLength;u.setUint32(h,T),dt(h+4+T<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),c.set(new Uint8Array(t),h+4),h+=4+T}if(!r)u.setUint32(h,0),h+=4;else{const T=r.byteLength;u.setUint32(h,T),dt(h+4+T<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),c.set(new Uint8Array(r),h+4),h+=4+T}return e.data===void 0?(u.setUint32(h,0),h+=4):(u.setUint32(h,e.data.length),c.set(e.data,h+4),h+=4+e.data.length),dt(h<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(h)}};Th=new WeakMap,Eh=new WeakMap,xh=new WeakMap,wh=new WeakMap,Yr=new WeakMap,Ws=new WeakMap,xy=new WeakMap,Rt=new WeakMap,ln=new WeakSet,Qi=function(e){dt(e<Qe.bools.length,"Invalid boolean index");const t=Math.floor(e/4),r=e*2%8,i=f(this,Rt).getUint8(t)>>r&3;return i===0?void 0:i===2},UC=function(e){return dt(e<Qe.numbers.length,"Invalid number index"),f(this,Rt).getFloat64(f(Qe,Th)+e*8)},Ev=function(e){dt(e<Qe.strings.length,"Invalid string index");let t=f(Qe,Yr)+4;for(let s=0;s<e;s++)t+=f(this,Rt).getUint32(t)+4;const r=f(this,Rt).getUint32(t),i=new Uint8Array(r);return i.set(new Uint8Array(f(this,Ws),t+4,r)),f(this,xy).decode(i)},q(Qe,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),q(Qe,"numbers",["ascent","defaultWidth","descent"]),q(Qe,"strings",["fallbackName","loadedName","mimetype","name"]),L(Qe,Th,Math.ceil(Qe.bools.length*2/8)),L(Qe,Eh,f(Qe,Th)+Qe.numbers.length*8),L(Qe,xh,f(Qe,Eh)+1+8),L(Qe,wh,f(Qe,xh)+1+48),L(Qe,Yr,f(Qe,wh)+1+6);let vb=Qe;var wy,by,Py,Ry,Iy,_y,ky,My;const Bt=class Bt{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,r=null,i=[],s=[],o=[],a=[],l=null,c=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,r=e[2],o=e[3],t===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,l=e[1],i=e[2],s=e[3],a=e[4]||[],r=e[6],c=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const u=Math.floor(i.length/2),h=Math.floor(s.length/3),m=o.length,v=a.length;let C=0;for(const M of a)C+=1,C=Math.ceil(C/4)*4,C+=4+M.coords.length*4,C+=4+M.colors.length*4,M.verticesPerRow!==void 0&&(C+=4);const T=20+u*8+h*3+m*8+(r?16:0)+(c?3:0)+C,E=new ArrayBuffer(T),x=new DataView(E),P=new Uint8Array(E);x.setUint8(f(Bt,wy),t),x.setUint8(f(Bt,by),r?1:0),x.setUint8(f(Bt,Py),c?1:0),x.setUint8(f(Bt,Ry),l),x.setUint32(f(Bt,Iy),u,!0),x.setUint32(f(Bt,_y),h,!0),x.setUint32(f(Bt,ky),m,!0),x.setUint32(f(Bt,My),v,!0);let b=20;new Float32Array(E,b,u*2).set(i),b+=u*8,P.set(s,b),b+=h*3;for(const[M,N]of o)x.setFloat32(b,M,!0),b+=4,x.setUint32(b,parseInt(N.slice(1),16),!0),b+=4;if(r)for(const M of r)x.setFloat32(b,M,!0),b+=4;c&&(P.set(c,b),b+=3);for(let M=0;M<a.length;M++){const N=a[M];x.setUint8(b,N.type),b+=1,b=Math.ceil(b/4)*4,x.setUint32(b,N.coords.length,!0),b+=4,new Int32Array(E,b,N.coords.length).set(N.coords),b+=N.coords.length*4,x.setUint32(b,N.colors.length,!0),b+=4,new Int32Array(E,b,N.colors.length).set(N.colors),b+=N.colors.length*4,N.verticesPerRow!==void 0&&(x.setUint32(b,N.verticesPerRow,!0),b+=4)}return E}getIR(){const e=this.view,t=this.data[f(Bt,wy)],r=!!this.data[f(Bt,by)],i=!!this.data[f(Bt,Py)],s=e.getUint32(f(Bt,Iy),!0),o=e.getUint32(f(Bt,_y),!0),a=e.getUint32(f(Bt,ky),!0),l=e.getUint32(f(Bt,My),!0);let c=20;const u=new Float32Array(this.buffer,c,s*2);c+=s*8;const h=new Uint8Array(this.buffer,c,o*3);c+=o*3;const m=[];for(let E=0;E<a;++E){const x=e.getFloat32(c,!0);c+=4;const P=e.getUint32(c,!0);c+=4,m.push([x,`#${P.toString(16).padStart(6,"0")}`])}let v=null;if(r){v=[];for(let E=0;E<4;++E)v.push(e.getFloat32(c,!0)),c+=4}let C=null;i&&(C=new Uint8Array(this.buffer,c,3),c+=3);const T=[];for(let E=0;E<l;++E){const x=e.getUint8(c);c+=1,c=Math.ceil(c/4)*4;const P=e.getUint32(c,!0);c+=4;const b=new Int32Array(this.buffer,c,P);c+=P*4;const I=e.getUint32(c,!0);c+=4;const M=new Int32Array(this.buffer,c,I);c+=I*4;const N={type:x,coords:b,colors:M};x===Kw.LATTICE&&(N.verticesPerRow=e.getUint32(c,!0),c+=4),T.push(N)}if(t===1)return["RadialAxial","axial",v,m,Array.from(u.slice(0,2)),Array.from(u.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",v,m,[u[0],u[1]],[u[3],u[4]],u[2],u[5]];if(t===3){const E=this.data[f(Bt,Ry)];let x=null;if(u.length>0){let P=u[0],b=u[0],I=u[1],M=u[1];for(let N=0;N<u.length;N+=2){const D=u[N],j=u[N+1];P=P>D?D:P,I=I>j?j:I,b=b<D?D:b,M=M<j?j:M}x=[P,I,b,M]}return["Mesh",E,u,h,T,x,v,C]}throw new Error(`Unsupported pattern kind: ${t}`)}};wy=new WeakMap,by=new WeakMap,Py=new WeakMap,Ry=new WeakMap,Iy=new WeakMap,_y=new WeakMap,ky=new WeakMap,My=new WeakMap,L(Bt,wy,0),L(Bt,by,1),L(Bt,Py,2),L(Bt,Ry,3),L(Bt,Iy,4),L(Bt,_y,8),L(Bt,ky,12),L(Bt,My,16);let yb=Bt;var bh;class qV{constructor(e){L(this,bh);_(this,bh,e)}static write(e){let t,r;return Pn.isFloat16ArraySupported?(r=new ArrayBuffer(e.length*2),t=new Float16Array(r)):(r=new ArrayBuffer(e.length*4),t=new Float32Array(r)),t.set(e),r}get path(){return Pn.isFloat16ArraySupported?new Float16Array(f(this,bh)):new Float32Array(f(this,bh))}}bh=new WeakMap;function GV(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(yr)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function KV(n){if(yr&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return WS(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function mC(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const Sb=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,YV=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",JV=_V.bind(null,Sb,YV);var Bo,UA;class XV{constructor(){L(this,Bo,new Map);L(this,UA,Promise.resolve())}postMessage(e,t){const r={data:structuredClone(e,t?{transfer:t}:null)};f(this,UA).then(()=>{for(const[i]of f(this,Bo))i.call(this,r)})}addEventListener(e,t,r=null){let i=null;if((r==null?void 0:r.signal)instanceof AbortSignal){const{signal:s}=r;if(s.aborted){Ze("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);i=()=>s.removeEventListener("abort",o),s.addEventListener("abort",o)}f(this,Bo).set(t,i)}removeEventListener(e,t){const r=f(this,Bo).get(t);r==null||r(),f(this,Bo).delete(t)}terminate(){for(const[,e]of f(this,Bo))e==null||e();f(this,Bo).clear()}}Bo=new WeakMap,UA=new WeakMap;const gC={DATA:1,ERROR:2},mn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function wD(){}function Ir(n){if(n instanceof Ul||n instanceof Yw||n instanceof vD||n instanceof fA||n instanceof ww)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Dt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Ul(n.message);case"InvalidPDFException":return new Yw(n.message);case"PasswordException":return new vD(n.message,n.code);case"ResponseException":return new fA(n.message,n.status,n.missing);case"UnknownErrorException":return new ww(n.message,n.details)}return new ww(n.message,n.toString())}var Ph,Ui,Sj,Cj,Aj,zC;class xv{constructor(e,t,r){L(this,Ui);L(this,Ph,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",B(this,Ui,Sj).bind(this),{signal:f(this,Ph).signal})}on(e,t){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},r)}catch(o){s.reject(o)}return s.promise}sendWithStream(e,t,r,i){const s=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const u=Promise.withResolvers();return this.streamControllers[s]={controller:c,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:e,streamId:s,data:t,desiredSize:c.desiredSize},i),u.promise},pull:c=>{const u=Promise.withResolvers();return this.streamControllers[s].pullCall=u,l.postMessage({sourceName:o,targetName:a,stream:mn.PULL,streamId:s,desiredSize:c.desiredSize}),u.promise},cancel:c=>{dt(c instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[s].cancelCall=u,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:mn.CANCEL,streamId:s,reason:Ir(c)}),u.promise}},r)}destroy(){var e;(e=f(this,Ph))==null||e.abort(),_(this,Ph,null)}}Ph=new WeakMap,Ui=new WeakSet,Sj=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){B(this,Ui,Aj).call(this,e);return}if(e.callback){const r=e.callbackId,i=this.callbackCapabilities[r];if(!i)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===gC.DATA)i.resolve(e.data);else if(e.callback===gC.ERROR)i.reject(Ir(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const r=this.sourceName,i=e.sourceName,s=this.comObj;Promise.try(t,e.data).then(function(o){s.postMessage({sourceName:r,targetName:i,callback:gC.DATA,callbackId:e.callbackId,data:o})},function(o){s.postMessage({sourceName:r,targetName:i,callback:gC.ERROR,callbackId:e.callbackId,reason:Ir(o)})});return}if(e.streamId){B(this,Ui,Cj).call(this,e);return}t(e.data)},Cj=function(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,o=this,a=this.actionHandler[e.action],l={enqueue(c,u=1,h){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=u,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:i,stream:mn.ENQUEUE,streamId:t,chunk:c},h)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:mn.CLOSE,streamId:t}),delete o.streamSinks[t])},error(c){dt(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:mn.ERROR,streamId:t,reason:Ir(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(a,e.data,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:mn.START_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:r,targetName:i,stream:mn.START_COMPLETE,streamId:t,reason:Ir(c)})})},Aj=function(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case mn.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Ir(e.reason));break;case mn.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Ir(e.reason));break;case mn.PULL:if(!a){s.postMessage({sourceName:r,targetName:i,stream:mn.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||wD).then(function(){s.postMessage({sourceName:r,targetName:i,stream:mn.PULL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:r,targetName:i,stream:mn.PULL_COMPLETE,streamId:t,reason:Ir(c)})});break;case mn.ENQUEUE:if(dt(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case mn.CLOSE:if(dt(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),B(this,Ui,zC).call(this,o,t);break;case mn.ERROR:dt(o,"error should have stream controller"),o.controller.error(Ir(e.reason)),B(this,Ui,zC).call(this,o,t);break;case mn.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Ir(e.reason)),B(this,Ui,zC).call(this,o,t);break;case mn.CANCEL:if(!a)break;const l=Ir(e.reason);Promise.try(a.onCancel||wD,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:mn.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:r,targetName:i,stream:mn.CANCEL_COMPLETE,streamId:t,reason:Ir(c)})}),a.sinkCapability.reject(l),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},zC=async function(e,t){var r,i,s;await Promise.allSettled([(r=e.startCall)==null?void 0:r.promise,(i=e.pullCall)==null?void 0:i.promise,(s=e.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[t]};var Ny;class Tj{constructor({enableHWA:e=!1}){L(this,Ny,!1);_(this,Ny,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(e,t);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!f(this,Ny)})}}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Dt("Abstract method `_createCanvas` called.")}}Ny=new WeakMap;class QV extends Tj{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const r=this._document.createElement("canvas");return r.width=e,r.height=t,r}}class Ej{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Dt("Abstract method `_fetch` called.")}}class bD extends Ej{async _fetch(e){const t=await VS(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):WS(t)}}et(2489);class xj{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,r,i,s){return"none"}destroy(e=!1){}}var iu,Rh,Fo,jo,ir,su,ou,Ne,er,wv,Md,WC,Nd,wj,Cb,Ld,bv,Pv,Ab,Rv;class e$ extends xj{constructor({docId:t,ownerDocument:r=globalThis.document}){super();L(this,Ne);L(this,iu);L(this,Rh);L(this,Fo);L(this,jo);L(this,ir);L(this,su);L(this,ou,0);_(this,jo,t),_(this,ir,r)}addFilter(t){if(!t)return"none";let r=f(this,Ne,er).get(t);if(r)return r;const[i,s,o]=B(this,Ne,WC).call(this,t),a=t.length===1?i:`${i}${s}${o}`;if(r=f(this,Ne,er).get(a),r)return f(this,Ne,er).set(t,r),r;const l=`g_${f(this,jo)}_transfer_map_${An(this,ou)._++}`,c=B(this,Ne,Nd).call(this,l);f(this,Ne,er).set(t,c),f(this,Ne,er).set(a,c);const u=B(this,Ne,Ld).call(this,l);return B(this,Ne,Pv).call(this,i,s,o,u),c}addHCMFilter(t,r){var C;const i=`${t}-${r}`,s="base";let o=f(this,Ne,wv).get(s);if((o==null?void 0:o.key)===i||(o?((C=o.filter)==null||C.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},f(this,Ne,wv).set(s,o)),!t||!r))return o.url;const a=B(this,Ne,Rv).call(this,t);t=ke.makeHexColor(...a);const l=B(this,Ne,Rv).call(this,r);if(r=ke.makeHexColor(...l),f(this,Ne,Md).style.color="",t==="#000000"&&r==="#ffffff"||t===r)return o.url;const c=new Array(256);for(let T=0;T<=255;T++){const E=T/255;c[T]=E<=.03928?E/12.92:((E+.055)/1.055)**2.4}const u=c.join(","),h=`g_${f(this,jo)}_hcm_filter`,m=o.filter=B(this,Ne,Ld).call(this,h);B(this,Ne,Pv).call(this,u,u,u,m),B(this,Ne,Cb).call(this,m);const v=(T,E)=>{const x=a[T]/255,P=l[T]/255,b=new Array(E+1);for(let I=0;I<=E;I++)b[I]=x+I/E*(P-x);return b.join(",")};return B(this,Ne,Pv).call(this,v(0,5),v(1,5),v(2,5),m),o.url=B(this,Ne,Nd).call(this,h),o.url}addAlphaFilter(t){let r=f(this,Ne,er).get(t);if(r)return r;const[i]=B(this,Ne,WC).call(this,[t]),s=`alpha_${i}`;if(r=f(this,Ne,er).get(s),r)return f(this,Ne,er).set(t,r),r;const o=`g_${f(this,jo)}_alpha_map_${An(this,ou)._++}`,a=B(this,Ne,Nd).call(this,o);f(this,Ne,er).set(t,a),f(this,Ne,er).set(s,a);const l=B(this,Ne,Ld).call(this,o);return B(this,Ne,Ab).call(this,i,l),a}addLuminosityFilter(t){let r=f(this,Ne,er).get(t||"luminosity");if(r)return r;let i,s;if(t?([i]=B(this,Ne,WC).call(this,[t]),s=`luminosity_${i}`):s="luminosity",r=f(this,Ne,er).get(s),r)return f(this,Ne,er).set(t,r),r;const o=`g_${f(this,jo)}_luminosity_map_${An(this,ou)._++}`,a=B(this,Ne,Nd).call(this,o);f(this,Ne,er).set(t,a),f(this,Ne,er).set(s,a);const l=B(this,Ne,Ld).call(this,o);return B(this,Ne,wj).call(this,l),t&&B(this,Ne,Ab).call(this,i,l),a}addHighlightHCMFilter(t,r,i,s,o){var P;const a=`${r}-${i}-${s}-${o}`;let l=f(this,Ne,wv).get(t);if((l==null?void 0:l.key)===a||(l?((P=l.filter)==null||P.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},f(this,Ne,wv).set(t,l)),!r||!i))return l.url;const[c,u]=[r,i].map(B(this,Ne,Rv).bind(this));let h=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),m=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[v,C]=[s,o].map(B(this,Ne,Rv).bind(this));m<h&&([h,m,v,C]=[m,h,C,v]),f(this,Ne,Md).style.color="";const T=(b,I,M)=>{const N=new Array(256),D=(m-h)/M,j=b/255,F=(I-b)/(255*M);let z=0;for(let W=0;W<=M;W++){const H=Math.round(h+W*D),V=j+W*F;for(let K=z;K<=H;K++)N[K]=V;z=H+1}for(let W=z;W<256;W++)N[W]=N[z-1];return N.join(",")},E=`g_${f(this,jo)}_hcm_${t}_filter`,x=l.filter=B(this,Ne,Ld).call(this,E);return B(this,Ne,Cb).call(this,x),B(this,Ne,Pv).call(this,T(v[0],C[0],5),T(v[1],C[1],5),T(v[2],C[2],5),x),l.url=B(this,Ne,Nd).call(this,E),l.url}destroy(t=!1){var r,i,s,o;t&&((r=f(this,su))!=null&&r.size)||((i=f(this,Fo))==null||i.parentNode.parentNode.remove(),_(this,Fo,null),(s=f(this,Rh))==null||s.clear(),_(this,Rh,null),(o=f(this,su))==null||o.clear(),_(this,su,null),_(this,ou,0))}}iu=new WeakMap,Rh=new WeakMap,Fo=new WeakMap,jo=new WeakMap,ir=new WeakMap,su=new WeakMap,ou=new WeakMap,Ne=new WeakSet,er=function(){return f(this,Rh)||_(this,Rh,new Map)},wv=function(){return f(this,su)||_(this,su,new Map)},Md=function(){if(!f(this,Fo)){const t=f(this,ir).createElement("div"),{style:r}=t;r.visibility="hidden",r.contain="strict",r.width=r.height=0,r.position="absolute",r.top=r.left=0,r.zIndex=-1;const i=f(this,ir).createElementNS(Co,"svg");i.setAttribute("width",0),i.setAttribute("height",0),_(this,Fo,f(this,ir).createElementNS(Co,"defs")),t.append(i),i.append(f(this,Fo)),f(this,ir).body.append(t)}return f(this,Fo)},WC=function(t){if(t.length===1){const c=t[0],u=new Array(256);for(let m=0;m<256;m++)u[m]=c[m]/255;const h=u.join(",");return[h,h,h]}const[r,i,s]=t,o=new Array(256),a=new Array(256),l=new Array(256);for(let c=0;c<256;c++)o[c]=r[c]/255,a[c]=i[c]/255,l[c]=s[c]/255;return[o.join(","),a.join(","),l.join(",")]},Nd=function(t){if(f(this,iu)===void 0){_(this,iu,"");const r=f(this,ir).URL;r!==f(this,ir).baseURI&&(oT(r)?Ze('#createUrl: ignore "data:"-URL for performance reasons.'):_(this,iu,MF(r,"")))}return`url(${f(this,iu)}#${t})`},wj=function(t){const r=f(this,ir).createElementNS(Co,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(r)},Cb=function(t){const r=f(this,ir).createElementNS(Co,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(r)},Ld=function(t){const r=f(this,ir).createElementNS(Co,"filter");return r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("id",t),f(this,Ne,Md).append(r),r},bv=function(t,r,i){const s=f(this,ir).createElementNS(Co,r);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),t.append(s)},Pv=function(t,r,i,s){const o=f(this,ir).createElementNS(Co,"feComponentTransfer");s.append(o),B(this,Ne,bv).call(this,o,"feFuncR",t),B(this,Ne,bv).call(this,o,"feFuncG",r),B(this,Ne,bv).call(this,o,"feFuncB",i)},Ab=function(t,r){const i=f(this,ir).createElementNS(Co,"feComponentTransfer");r.append(i),B(this,Ne,bv).call(this,i,"feFuncA",t)},Rv=function(t){return f(this,Ne,Md).style.color=t,HS(getComputedStyle(f(this,Ne,Md)).getPropertyValue("color"))};class bj{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Dt("Abstract method `_fetch` called.")}}class PD extends bj{async _fetch(e){const t=await VS(e,"arraybuffer");return new Uint8Array(t)}}class Pj{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Dt("Abstract method `_fetch` called.")}}class RD extends Pj{async _fetch(e){const t=await VS(e,"arraybuffer");return new Uint8Array(t)}}var lB;if(yr){let n;try{const e=process.getBuiltinModule("module").createRequire(import.meta.url);try{n=e("@napi-rs/canvas")}catch(t){Ze(`Cannot load "@napi-rs/canvas" package: "${t}".`)}}catch(e){Ze(`Cannot access the \`require\` function: "${e}".`)}globalThis.DOMMatrix||(n!=null&&n.DOMMatrix?globalThis.DOMMatrix=n.DOMMatrix:Ze("Cannot polyfill `DOMMatrix`, rendering may be broken.")),globalThis.ImageData||(n!=null&&n.ImageData?globalThis.ImageData=n.ImageData:Ze("Cannot polyfill `ImageData`, rendering may be broken.")),globalThis.Path2D||(n!=null&&n.Path2D?globalThis.Path2D=n.Path2D:Ze("Cannot polyfill `Path2D`, rendering may be broken.")),(lB=globalThis.navigator)!=null&&lB.language||(globalThis.navigator={language:"en-US",platform:"",userAgent:""})}async function rR(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class t$ extends xj{}class n$ extends Tj{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class r$ extends Ej{async _fetch(e){return rR(e)}}class i$ extends bj{async _fetch(e){return rR(e)}}class s$ extends Pj{async _fetch(e){return rR(e)}}et(7588);const Rd="__forcedDependency",{floor:ID,ceil:_D}=Math;function vC(n,e,t,r,i,s){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],r),n[e*4+2]=Math.max(n[e*4+2],i),n[e*4+3]=Math.max(n[e*4+3],s)}const Tb=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Ih,pl;class o${constructor(e,t){L(this,Ih);L(this,pl);_(this,Ih,e),_(this,pl,t)}get length(){return f(this,Ih).length}isEmpty(e){return f(this,Ih)[e]===Tb}minX(e){return f(this,pl)[e*4+0]/256}minY(e){return f(this,pl)[e*4+1]/256}maxX(e){return(f(this,pl)[e*4+2]+1)/256}maxY(e){return(f(this,pl)[e*4+3]+1)/256}}Ih=new WeakMap,pl=new WeakMap;const yC=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var Mr,Nr,au,is,lu,Uo,Et,It,zo,Lr,Ly,_h,cu,uu,Wo,sr,Vs,Dy,Eb;class a${constructor(e,t,r=!1){L(this,Dy);L(this,Mr,{__proto__:null});L(this,Nr,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Rd]:[]});L(this,au,new Map);L(this,is,[]);L(this,lu,[]);L(this,Uo,[[1,0,0,1,0,0]]);L(this,Et,[-1/0,-1/0,1/0,1/0]);L(this,It,new Float64Array([1/0,1/0,-1/0,-1/0]));L(this,zo,-1);L(this,Lr,new Set);L(this,Ly,new Map);L(this,_h,new Map);L(this,cu);L(this,uu);L(this,Wo);L(this,sr);L(this,Vs);_(this,cu,e.width),_(this,uu,e.height),B(this,Dy,Eb).call(this,t),r&&_(this,Vs,new Map)}growOperationsCount(e){e>=f(this,sr).length&&B(this,Dy,Eb).call(this,e,f(this,sr))}save(e){return _(this,Mr,{__proto__:f(this,Mr)}),_(this,Nr,{__proto__:f(this,Nr),transform:{__proto__:f(this,Nr).transform},moveText:{__proto__:f(this,Nr).moveText},sameLineText:{__proto__:f(this,Nr).sameLineText},[Rd]:{__proto__:f(this,Nr)[Rd]}}),_(this,Et,{__proto__:f(this,Et)}),f(this,is).push(e),this}restore(e){var i;const t=Object.getPrototypeOf(f(this,Mr));if(t===null)return this;_(this,Mr,t),_(this,Nr,Object.getPrototypeOf(f(this,Nr))),_(this,Et,Object.getPrototypeOf(f(this,Et)));const r=f(this,is).pop();return r!==void 0&&((i=yC(f(this,Vs),e))==null||i.dependencies.add(r),f(this,sr)[e]=f(this,sr)[r]),this}recordOpenMarker(e){return f(this,is).push(e),this}getOpenMarker(){return f(this,is).length===0?null:f(this,is).at(-1)}recordCloseMarker(e){var r;const t=f(this,is).pop();return t!==void 0&&((r=yC(f(this,Vs),e))==null||r.dependencies.add(t),f(this,sr)[e]=f(this,sr)[t]),this}beginMarkedContent(e){return f(this,lu).push(e),this}endMarkedContent(e){var r;const t=f(this,lu).pop();return t!==void 0&&((r=yC(f(this,Vs),e))==null||r.dependencies.add(t),f(this,sr)[e]=f(this,sr)[t]),this}pushBaseTransform(e){return f(this,Uo).push(ke.multiplyByDOMMatrix(f(this,Uo).at(-1),e.getTransform())),this}popBaseTransform(){return f(this,Uo).length>1&&f(this,Uo).pop(),this}recordSimpleData(e,t){return f(this,Mr)[e]=t,this}recordIncrementalData(e,t){return f(this,Nr)[e].push(t),this}resetIncrementalData(e,t){return f(this,Nr)[e].length=0,this}recordNamedData(e,t){return f(this,au).set(e,t),this}recordSimpleDataFromNamed(e,t,r){f(this,Mr)[e]=f(this,au).get(t)??r}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Rd,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in f(this,Mr)&&this.recordFutureForcedDependency(t,f(this,Mr)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of f(this,Lr))this.recordFutureForcedDependency(Rd,e);return this}resetBBox(e){return f(this,zo)!==e&&(_(this,zo,e),f(this,It)[0]=1/0,f(this,It)[1]=1/0,f(this,It)[2]=-1/0,f(this,It)[3]=-1/0),this}recordClipBox(e,t,r,i,s,o){const a=ke.multiplyByDOMMatrix(f(this,Uo).at(-1),t.getTransform()),l=[1/0,1/0,-1/0,-1/0];ke.axialAlignedBoundingBox([r,s,i,o],a,l);const c=ke.intersect(f(this,Et),l);return c?(f(this,Et)[0]=c[0],f(this,Et)[1]=c[1],f(this,Et)[2]=c[2],f(this,Et)[3]=c[3]):(f(this,Et)[0]=f(this,Et)[1]=1/0,f(this,Et)[2]=f(this,Et)[3]=-1/0),this}recordBBox(e,t,r,i,s,o){const a=f(this,Et);if(a[0]===1/0)return this;const l=ke.multiplyByDOMMatrix(f(this,Uo).at(-1),t.getTransform());if(a[0]===-1/0)return ke.axialAlignedBoundingBox([r,s,i,o],l,f(this,It)),this;const c=[1/0,1/0,-1/0,-1/0];return ke.axialAlignedBoundingBox([r,s,i,o],l,c),f(this,It)[0]=Math.min(f(this,It)[0],Math.max(c[0],a[0])),f(this,It)[1]=Math.min(f(this,It)[1],Math.max(c[1],a[1])),f(this,It)[2]=Math.max(f(this,It)[2],Math.min(c[2],a[2])),f(this,It)[3]=Math.max(f(this,It)[3],Math.min(c[3],a[3])),this}recordCharacterBBox(e,t,r,i=1,s=0,o=0,a){const l=r.bbox;let c,u;if(l&&(c=l[2]!==l[0]&&l[3]!==l[1]&&f(this,_h).get(r),c!==!1&&(u=[0,0,0,0],ke.axialAlignedBoundingBox(l,r.fontMatrix,u),(i!==1||s!==0||o!==0)&&ke.scaleMinMax([i,0,0,-i,s,o],u),c)))return this.recordBBox(e,t,u[0],u[2],u[1],u[3]);if(!a)return this.recordFullPageBBox(e);const h=a();return l&&u&&c===void 0&&(c=u[0]<=s-h.actualBoundingBoxLeft&&u[2]>=s+h.actualBoundingBoxRight&&u[1]<=o-h.actualBoundingBoxAscent&&u[3]>=o+h.actualBoundingBoxDescent,f(this,_h).set(r,c),c)?this.recordBBox(e,t,u[0],u[2],u[1],u[3]):this.recordBBox(e,t,s-h.actualBoundingBoxLeft,s+h.actualBoundingBoxRight,o-h.actualBoundingBoxAscent,o+h.actualBoundingBoxDescent)}recordFullPageBBox(e){return f(this,It)[0]=Math.max(0,f(this,Et)[0]),f(this,It)[1]=Math.max(0,f(this,Et)[1]),f(this,It)[2]=Math.min(f(this,cu),f(this,Et)[2]),f(this,It)[3]=Math.min(f(this,uu),f(this,Et)[3]),this}getSimpleIndex(e){return f(this,Mr)[e]}recordDependencies(e,t){const r=f(this,Lr),i=f(this,Mr),s=f(this,Nr);for(const o of t)o in f(this,Mr)?r.add(i[o]):o in s&&s[o].forEach(r.add,r);return this}recordNamedDependency(e,t){return f(this,au).has(t)&&f(this,Lr).add(f(this,au).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Rd]),f(this,Vs)){const r=yC(f(this,Vs),e),{dependencies:i}=r;f(this,Lr).forEach(i.add,i),f(this,is).forEach(i.add,i),f(this,lu).forEach(i.add,i),i.delete(e),r.isRenderingOperation=!0}if(f(this,zo)===e){const r=ID(f(this,It)[0]*256/f(this,cu)),i=ID(f(this,It)[1]*256/f(this,uu)),s=_D(f(this,It)[2]*256/f(this,cu)),o=_D(f(this,It)[3]*256/f(this,uu));vC(f(this,Wo),e,r,i,s,o);for(const a of f(this,Lr))a!==e&&vC(f(this,Wo),a,r,i,s,o);for(const a of f(this,is))a!==e&&vC(f(this,Wo),a,r,i,s,o);for(const a of f(this,lu))a!==e&&vC(f(this,Wo),a,r,i,s,o);t||(f(this,Lr).clear(),_(this,zo,-1))}return this}recordShowTextOperation(e,t=!1){const r=Array.from(f(this,Lr));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of r)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return f(this,zo)===e&&(_(this,zo,-1),f(this,Et)[0]=Math.max(f(this,Et)[0],f(this,It)[0]),f(this,Et)[1]=Math.max(f(this,Et)[1],f(this,It)[1]),f(this,Et)[2]=Math.min(f(this,Et)[2],f(this,It)[2]),f(this,Et)[3]=Math.min(f(this,Et)[3],f(this,It)[3]),t||f(this,Lr).clear()),this}_takePendingDependencies(){const e=f(this,Lr);return _(this,Lr,new Set),e}_extractOperation(e){const t=f(this,Ly).get(e);return f(this,Ly).delete(e),t}_pushPendingDependencies(e){for(const t of e)f(this,Lr).add(t)}take(){return f(this,_h).clear(),new o$(f(this,sr),f(this,Wo))}takeDebugMetadata(){return f(this,Vs)}}Mr=new WeakMap,Nr=new WeakMap,au=new WeakMap,is=new WeakMap,lu=new WeakMap,Uo=new WeakMap,Et=new WeakMap,It=new WeakMap,zo=new WeakMap,Lr=new WeakMap,Ly=new WeakMap,_h=new WeakMap,cu=new WeakMap,uu=new WeakMap,Wo=new WeakMap,sr=new WeakMap,Vs=new WeakMap,Dy=new WeakSet,Eb=function(e,t){const r=new ArrayBuffer(e*4);_(this,Wo,new Uint8ClampedArray(r)),_(this,sr,new Uint32Array(r)),t&&t.length>0?(f(this,sr).set(t),f(this,sr).fill(Tb,t.length)):f(this,sr).fill(Tb)};var Nt,rn,ss,kh,Mh;const xR=class xR{constructor(e,t,r){L(this,Nt);L(this,rn);L(this,ss);L(this,kh,0);L(this,Mh,0);if(e instanceof xR&&f(e,ss)===!!r)return e;_(this,Nt,e),_(this,rn,t),_(this,ss,!!r)}growOperationsCount(){throw new Error("Unreachable")}save(e){return An(this,Mh)._++,f(this,Nt).save(f(this,rn)),this}restore(e){return f(this,Mh)>0&&(f(this,Nt).restore(f(this,rn)),An(this,Mh)._--),this}recordOpenMarker(e){return An(this,kh)._++,this}getOpenMarker(){return f(this,kh)>0?f(this,rn):f(this,Nt).getOpenMarker()}recordCloseMarker(e){return An(this,kh)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return f(this,Nt).pushBaseTransform(e),this}popBaseTransform(){return f(this,Nt).popBaseTransform(),this}recordSimpleData(e,t){return f(this,Nt).recordSimpleData(e,f(this,rn)),this}recordIncrementalData(e,t){return f(this,Nt).recordIncrementalData(e,f(this,rn)),this}resetIncrementalData(e,t){return f(this,Nt).resetIncrementalData(e,f(this,rn)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,r){return f(this,Nt).recordSimpleDataFromNamed(e,t,f(this,rn)),this}recordFutureForcedDependency(e,t){return f(this,Nt).recordFutureForcedDependency(e,f(this,rn)),this}inheritSimpleDataAsFutureForcedDependencies(e){return f(this,Nt).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return f(this,Nt).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return f(this,ss)||f(this,Nt).resetBBox(f(this,rn)),this}recordClipBox(e,t,r,i,s,o){return f(this,ss)||f(this,Nt).recordClipBox(f(this,rn),t,r,i,s,o),this}recordBBox(e,t,r,i,s,o){return f(this,ss)||f(this,Nt).recordBBox(f(this,rn),t,r,i,s,o),this}recordCharacterBBox(e,t,r,i,s,o,a){return f(this,ss)||f(this,Nt).recordCharacterBBox(f(this,rn),t,r,i,s,o,a),this}recordFullPageBBox(e){return f(this,ss)||f(this,Nt).recordFullPageBBox(f(this,rn)),this}getSimpleIndex(e){return f(this,Nt).getSimpleIndex(e)}recordDependencies(e,t){return f(this,Nt).recordDependencies(f(this,rn),t),this}recordNamedDependency(e,t){return f(this,Nt).recordNamedDependency(f(this,rn),t),this}recordOperation(e){return f(this,Nt).recordOperation(f(this,rn),!0),this}recordShowTextOperation(e){return f(this,Nt).recordShowTextOperation(f(this,rn),!0),this}bboxToClipBoxDropOperation(e){return f(this,ss)||f(this,Nt).bboxToClipBoxDropOperation(f(this,rn),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};Nt=new WeakMap,rn=new WeakMap,ss=new WeakMap,kh=new WeakMap,Mh=new WeakMap;let CA=xR;const wi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},qn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function xb(n,e){if(!e)return;const t=e[2]-e[0],r=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,r),n.clip(i)}class iR{isModifyingCurrentTransform(){return!1}getPattern(){Dt("Abstract method `getPattern` called.")}}class l$ extends iR{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let r,i=this._p0,s=this._p1;if(t&&(i=i.slice(),s=s.slice(),ke.applyTransform(i,t),ke.applyTransform(s,t)),this._type==="axial")r=e.createLinearGradient(i[0],i[1],s[0],s[1]);else if(this._type==="radial"){let o=this._r0,a=this._r1;if(t){const l=new Float32Array(2);ke.singularValueDecompose2dScale(t,l),o*=l[0],a*=l[0]}r=e.createRadialGradient(i[0],i[1],o,s[0],s[1],a)}for(const o of this._colorStops)r.addColorStop(o[0],o[1]);return r}getPattern(e,t,r,i){let s;if(i===qn.STROKE||i===qn.FILL){if(this.isOriginBased()){let m=ke.transform(r,t.baseTransform);this.matrix&&(m=ke.transform(m,this.matrix));const v=.001,C=Math.hypot(m[0],m[1]),T=Math.hypot(m[2],m[3]),E=(m[0]*m[2]+m[1]*m[3])/(C*T);if(Math.abs(E)<v)if(this.isRadial()){if(Math.abs(C-T)<v)return this._createGradient(e,m)}else return this._createGradient(e,m)}const o=t.current.getClippedPathBoundingBox(i,Qt(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,c=t.cachedCanvases.getCanvas("pattern",a,l),u=c.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-o[0],-o[1]),r=ke.transform(r,[1,0,0,1,o[0],o[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),xb(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),s=e.createPattern(c.canvas,"no-repeat");const h=new DOMMatrix(r);s.setTransform(h)}else xb(e,this._bbox),s=this._createGradient(e);return s}}function Rw(n,e,t,r,i,s,o,a){const l=e.coords,c=e.colors,u=n.data,h=n.width*4;let m;l[t+1]>l[r+1]&&(m=t,t=r,r=m,m=s,s=o,o=m),l[r+1]>l[i+1]&&(m=r,r=i,i=m,m=o,o=a,a=m),l[t+1]>l[r+1]&&(m=t,t=r,r=m,m=s,s=o,o=m);const v=(l[t]+e.offsetX)*e.scaleX,C=(l[t+1]+e.offsetY)*e.scaleY,T=(l[r]+e.offsetX)*e.scaleX,E=(l[r+1]+e.offsetY)*e.scaleY,x=(l[i]+e.offsetX)*e.scaleX,P=(l[i+1]+e.offsetY)*e.scaleY;if(C>=P)return;const b=c[s],I=c[s+1],M=c[s+2],N=c[o],D=c[o+1],j=c[o+2],F=c[a],z=c[a+1],W=c[a+2],H=Math.round(C),V=Math.round(P);let K,ee,G,X,Y,ce,ae,$;for(let J=H;J<=V;J++){if(J<E){const se=J<C?0:(C-J)/(C-E);K=v-(v-T)*se,ee=b-(b-N)*se,G=I-(I-D)*se,X=M-(M-j)*se}else{let se;J>P?se=1:E===P?se=0:se=(E-J)/(E-P),K=T-(T-x)*se,ee=N-(N-F)*se,G=D-(D-z)*se,X=j-(j-W)*se}let de;J<C?de=0:J>P?de=1:de=(C-J)/(C-P),Y=v-(v-x)*de,ce=b-(b-F)*de,ae=I-(I-z)*de,$=M-(M-W)*de;const me=Math.round(Math.min(K,Y)),Te=Math.round(Math.max(K,Y));let le=h*J+me*4;for(let se=me;se<=Te;se++)de=(K-se)/(K-Y),de<0?de=0:de>1&&(de=1),u[le++]=ee-(ee-ce)*de|0,u[le++]=G-(G-ae)*de|0,u[le++]=X-(X-$)*de|0,u[le++]=255}}function c$(n,e,t){const r=e.coords,i=e.colors;let s,o;switch(e.type){case Kw.LATTICE:const a=e.verticesPerRow,l=Math.floor(r.length/a)-1,c=a-1;for(s=0;s<l;s++){let u=s*a;for(let h=0;h<c;h++,u++)Rw(n,t,r[u],r[u+1],r[u+a],i[u],i[u+1],i[u+a]),Rw(n,t,r[u+a+1],r[u+1],r[u+a],i[u+a+1],i[u+1],i[u+a])}break;case Kw.TRIANGLES:for(s=0,o=r.length;s<o;s+=3)Rw(n,t,r[s],r[s+1],r[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class u$ extends iR{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,r){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-a,u=Math.ceil(this._bounds[3])-l,h=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(u*e[1]*1.1)),3e3),v=c/h,C=u/m,T={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/v,scaleY:1/C},E=h+4,x=m+4,P=r.getCanvas("mesh",E,x),b=P.context,I=b.createImageData(h,m);if(t){const N=I.data;for(let D=0,j=N.length;D<j;D+=4)N[D]=t[0],N[D+1]=t[1],N[D+2]=t[2],N[D+3]=255}for(const N of this._figures)c$(I,N,T);return b.putImageData(I,2,2),{canvas:P.canvas,offsetX:a-2*v,offsetY:l-2*C,scaleX:v,scaleY:C}}isModifyingCurrentTransform(){return!0}getPattern(e,t,r,i){xb(e,this._bbox);const s=new Float32Array(2);if(i===qn.SHADING)ke.singularValueDecompose2dScale(Qt(e),s);else if(this.matrix){ke.singularValueDecompose2dScale(this.matrix,s);const[a,l]=s;ke.singularValueDecompose2dScale(t.baseTransform,s),s[0]*=a,s[1]*=l}else ke.singularValueDecompose2dScale(t.baseTransform,s);const o=this._createMeshCanvas(s,i===qn.SHADING?null:this._background,t.cachedCanvases);return i!==qn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class d$ extends iR{getPattern(){return"hotpink"}}function h$(n){switch(n[0]){case"RadialAxial":return new l$(n);case"Mesh":return new u$(n);case"Dummy":return new d$}throw new Error(`Unknown IR type: ${n[0]}`)}const kD={COLORED:1,UNCOLORED:2},zA=class zA{constructor(e,t,r,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=r,this.baseTransform=i}createPatternCanvas(e,t){var ce,ae;const{bbox:r,operatorList:i,paintType:s,tilingType:o,color:a,canvasGraphicsFactory:l}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),sT("TilingType: "+o);const h=r[0],m=r[1],v=r[2],C=r[3],T=v-h,E=C-m,x=new Float32Array(2);ke.singularValueDecompose2dScale(this.matrix,x);const[P,b]=x;ke.singularValueDecompose2dScale(this.baseTransform,x);const I=P*x[0],M=b*x[1];let N=T,D=E,j=!1,F=!1;const z=Math.ceil(c*I),W=Math.ceil(u*M),H=Math.ceil(T*I),V=Math.ceil(E*M);z>=H?N=c:j=!0,W>=V?D=u:F=!0;const K=this.getSizeAndScale(N,this.ctx.canvas.width,I),ee=this.getSizeAndScale(D,this.ctx.canvas.height,M),G=e.cachedCanvases.getCanvas("pattern",K.size,ee.size),X=G.context,Y=l.createCanvasGraphics(X,t);if(Y.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(Y,s,a),X.translate(-K.scale*h,-ee.scale*m),Y.transform(0,K.scale,0,0,ee.scale,0,0),X.save(),(ce=Y.dependencyTracker)==null||ce.save(),this.clipBbox(Y,h,m,v,C),Y.baseTransform=Qt(Y.ctx),Y.executeOperatorList(i),Y.endDrawing(),(ae=Y.dependencyTracker)==null||ae.restore(),X.restore(),j||F){const $=G.canvas;j&&(N=c),F&&(D=u);const J=this.getSizeAndScale(N,this.ctx.canvas.width,I),de=this.getSizeAndScale(D,this.ctx.canvas.height,M),me=J.size,Te=de.size,le=e.cachedCanvases.getCanvas("pattern-workaround",me,Te),se=le.context,ie=j?Math.floor(T/c):0,Se=F?Math.floor(E/u):0;for(let re=0;re<=ie;re++)for(let pe=0;pe<=Se;pe++)se.drawImage($,me*re,Te*pe,me,Te,0,0,me,Te);return{canvas:le.canvas,scaleX:J.scale,scaleY:de.scale,offsetX:h,offsetY:m}}return{canvas:G.canvas,scaleX:K.scale,scaleY:ee.scale,offsetX:h,offsetY:m}}getSizeAndScale(e,t,r){const i=Math.max(zA.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*r);return s>=i?s=i:r=s/e,{scale:r,size:s}}clipBbox(e,t,r,i,s){const o=i-t,a=s-r;e.ctx.rect(t,r,o,a),ke.axialAlignedBoundingBox([t,r,i,s],Qt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,r){const i=e.ctx,s=e.current;switch(t){case kD.COLORED:const{fillStyle:o,strokeStyle:a}=this.ctx;i.fillStyle=s.fillColor=o,i.strokeStyle=s.strokeColor=a;break;case kD.UNCOLORED:i.fillStyle=i.strokeStyle=r,s.fillColor=s.strokeColor=r;break;default:throw new xV(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,r,i,s){let o=r;i!==qn.SHADING&&(o=ke.transform(o,t.baseTransform),this.matrix&&(o=ke.transform(o,this.matrix)));const a=this.createPatternCanvas(t,s);let l=new DOMMatrix(o);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);const c=e.createPattern(a.canvas,"repeat");return c.setTransform(l),c}};q(zA,"MAX_PATTERN_SIZE",3e3);let wb=zA;function p$({src:n,srcPos:e=0,dest:t,width:r,height:i,nonBlackColor:s=4294967295,inverseDecode:o=!1}){const a=Pn.isLittleEndian?4278190080:255,[l,c]=o?[s,a]:[a,s],u=r>>3,h=r&7,m=n.length;t=new Uint32Array(t.buffer);let v=0;for(let C=0;C<i;C++){for(const E=e+u;e<E;e++){const x=e<m?n[e]:255;t[v++]=x&128?c:l,t[v++]=x&64?c:l,t[v++]=x&32?c:l,t[v++]=x&16?c:l,t[v++]=x&8?c:l,t[v++]=x&4?c:l,t[v++]=x&2?c:l,t[v++]=x&1?c:l}if(h===0)continue;const T=e<m?n[e++]:255;for(let E=0;E<h;E++)t[v++]=T&1<<7-E?c:l}return{srcPos:e,destPos:v}}const MD=16,ND=100,f$=15,LD=10,Br=16,Iw=new DOMMatrix,pi=new Float32Array(2),zd=new Float32Array([1/0,1/0,-1/0,-1/0]);function m$(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,r){e.translate(t,r),this.__originalTranslate(t,r)},n.scale=function(t,r){e.scale(t,r),this.__originalScale(t,r)},n.transform=function(t,r,i,s,o,a){e.transform(t,r,i,s,o,a),this.__originalTransform(t,r,i,s,o,a)},n.setTransform=function(t,r,i,s,o,a){e.setTransform(t,r,i,s,o,a),this.__originalSetTransform(t,r,i,s,o,a)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,r){e.moveTo(t,r),this.__originalMoveTo(t,r)},n.lineTo=function(t,r){e.lineTo(t,r),this.__originalLineTo(t,r)},n.bezierCurveTo=function(t,r,i,s,o,a){e.bezierCurveTo(t,r,i,s,o,a),this.__originalBezierCurveTo(t,r,i,s,o,a)},n.rect=function(t,r,i,s){e.rect(t,r,i,s),this.__originalRect(t,r,i,s)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class g${constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,r){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,r)):(i=this.canvasFactory.create(t,r),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function SC(n,e,t,r,i,s,o,a,l,c){const[u,h,m,v,C,T]=Qt(n);if(h===0&&m===0){const P=o*u+C,b=Math.round(P),I=a*v+T,M=Math.round(I),N=(o+l)*u+C,D=Math.abs(Math.round(N)-b)||1,j=(a+c)*v+T,F=Math.abs(Math.round(j)-M)||1;return n.setTransform(Math.sign(u),0,0,Math.sign(v),b,M),n.drawImage(e,t,r,i,s,0,0,D,F),n.setTransform(u,h,m,v,C,T),[D,F]}if(u===0&&v===0){const P=a*m+C,b=Math.round(P),I=o*h+T,M=Math.round(I),N=(a+c)*m+C,D=Math.abs(Math.round(N)-b)||1,j=(o+l)*h+T,F=Math.abs(Math.round(j)-M)||1;return n.setTransform(0,Math.sign(h),Math.sign(m),0,b,M),n.drawImage(e,t,r,i,s,0,0,F,D),n.setTransform(u,h,m,v,C,T),[F,D]}n.drawImage(e,t,r,i,s,o,a,l,c);const E=Math.hypot(u,h),x=Math.hypot(m,v);return[E*l,x*c]}class DD{constructor(e,t,r){q(this,"alphaIsShape",!1);q(this,"fontSize",0);q(this,"fontSizeScale",1);q(this,"textMatrix",null);q(this,"textMatrixScale",1);q(this,"fontMatrix",Gw);q(this,"leading",0);q(this,"x",0);q(this,"y",0);q(this,"lineX",0);q(this,"lineY",0);q(this,"charSpacing",0);q(this,"wordSpacing",0);q(this,"textHScale",1);q(this,"textRenderingMode",Tn.FILL);q(this,"textRise",0);q(this,"fillColor","#000000");q(this,"strokeColor","#000000");q(this,"patternFill",!1);q(this,"patternStroke",!1);q(this,"fillAlpha",1);q(this,"strokeAlpha",1);q(this,"lineWidth",1);q(this,"activeSMask",null);q(this,"transferMaps","none");r==null||r(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=zd.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=qn.FILL,t=null){const r=this.minMax.slice();if(e===qn.STROKE){t||Dt("Stroke bounding box must include transform."),ke.singularValueDecompose2dScale(t,pi);const i=pi[0]*this.lineWidth/2,s=pi[1]*this.lineWidth/2;r[0]-=i,r[1]-=s,r[2]+=i,r[3]+=s}return r}updateClipFromPath(){const e=ke.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(zd,0)}getClippedPathBoundingBox(e=qn.FILL,t=null){return ke.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function OD(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,r=e.width,i=t%Br,s=(t-i)/Br,o=i===0?s:s+1,a=n.createImageData(r,Br);let l=0,c;const u=e.data,h=a.data;let m,v,C,T;if(e.kind===MC.GRAYSCALE_1BPP){const E=u.byteLength,x=new Uint32Array(h.buffer,0,h.byteLength>>2),P=x.length,b=r+7>>3,I=4294967295,M=Pn.isLittleEndian?4278190080:255;for(m=0;m<o;m++){for(C=m<s?Br:i,c=0,v=0;v<C;v++){const N=E-l;let D=0;const j=N>b?r:N*8-7,F=j&-8;let z=0,W=0;for(;D<F;D+=8)W=u[l++],x[c++]=W&128?I:M,x[c++]=W&64?I:M,x[c++]=W&32?I:M,x[c++]=W&16?I:M,x[c++]=W&8?I:M,x[c++]=W&4?I:M,x[c++]=W&2?I:M,x[c++]=W&1?I:M;for(;D<j;D++)z===0&&(W=u[l++],z=128),x[c++]=W&z?I:M,z>>=1}for(;c<P;)x[c++]=0;n.putImageData(a,0,m*Br)}}else if(e.kind===MC.RGBA_32BPP){for(v=0,T=r*Br*4,m=0;m<s;m++)h.set(u.subarray(l,l+T)),l+=T,n.putImageData(a,0,v),v+=Br;m<o&&(T=r*i*4,h.set(u.subarray(l,l+T)),n.putImageData(a,0,v))}else if(e.kind===MC.RGB_24BPP)for(C=Br,T=r*C,m=0;m<o;m++){for(m>=s&&(C=i,T=r*C),c=0,v=T;v--;)h[c++]=u[l++],h[c++]=u[l++],h[c++]=u[l++],h[c++]=255;n.putImageData(a,0,m*Br)}else throw new Error(`bad image kind: ${e.kind}`)}function BD(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,r=e.width,i=t%Br,s=(t-i)/Br,o=i===0?s:s+1,a=n.createImageData(r,Br);let l=0;const c=e.data,u=a.data;for(let h=0;h<o;h++){const m=h<s?Br:i;({srcPos:l}=p$({src:c,srcPos:l,dest:u,width:r,height:m,nonBlackColor:0})),n.putImageData(a,0,h*Br)}}function av(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of t)n[r]!==void 0&&(e[r]=n[r]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function CC(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function FD(n,e){if(e)return!0;ke.singularValueDecompose2dScale(n,pi);const t=Math.fround(to.pixelRatio*zl.PDF_TO_CSS_UNITS);return pi[0]<=t&&pi[1]<=t}const v$=["butt","round","square"],y$=["miter","round","bevel"],S$={},jD={};var gs,bb,Pb,Rb;const wR=class wR{constructor(e,t,r,i,s,{optionalContentConfig:o,markedContentStack:a=null},l,c,u){L(this,gs);this.ctx=e,this.current=new DD(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new g$(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=u??null}getObject(e,t,r=null){var i;return typeof t=="string"?((i=this.dependencyTracker)==null||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):r}beginDrawing({transform:e,viewport:t,transparency:r=!1,background:i=null}){const s=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=a,r){const l=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Qt(this.compositeCtx))}this.ctx.save(),CC(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Qt(this.ctx)}executeOperatorList(e,t,r,i,s){var x;const o=e.argsArray,a=e.fnArray;let l=t||0;const c=o.length;if(c===l)return l;const u=c-l>LD&&typeof r=="function",h=u?Date.now()+f$:0;let m=0;const v=this.commonObjs,C=this.objs;let T,E;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,r),l;if(!s||s(l))if(T=a[l],E=o[l]??null,T!==Wv.dependency)E===null?this[T](l):this[T](l,...E);else for(const P of E){(x=this.dependencyTracker)==null||x.recordNamedData(P,l);const b=P.startsWith("g_")?v:C;if(!b.has(P))return b.get(P,r),l}if(l++,l===c)return l;if(u&&++m>LD){if(Date.now()>h)return r(),l;m=0}}}endDrawing(){B(this,gs,bb).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),B(this,gs,Pb).call(this)}_scaleImage(e,t){const r=e.width??e.displayWidth,i=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=r,l=i,c="prescale1",u,h;for(;s>2&&a>1||o>2&&l>1;){let m=a,v=l;s>2&&a>1&&(m=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),s/=a/m),o>2&&l>1&&(v=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/v),u=this.cachedCanvases.getCanvas(c,m,v),h=u.context,h.clearRect(0,0,m,v),h.drawImage(e,0,0,a,l,0,0,m,v),e=u.canvas,a=m,l=v,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e,t){var z,W;const r=this.ctx,{width:i,height:s}=t,o=this.current.fillColor,a=this.current.patternFill,l=Qt(r);let c,u,h,m;if((t.bitmap||t.data)&&t.count>1){const H=t.bitmap||t.data.buffer;u=JSON.stringify(a?l:[l.slice(0,4),o]),c=this._cachedBitmapsMap.get(H),c||(c=new Map,this._cachedBitmapsMap.set(H,c));const V=c.get(u);if(V&&!a){const K=Math.round(Math.min(l[0],l[2])+l[4]),ee=Math.round(Math.min(l[1],l[3])+l[5]);return(z=this.dependencyTracker)==null||z.recordDependencies(e,wi.transformAndFill),{canvas:V,offsetX:K,offsetY:ee}}h=V}h||(m=this.cachedCanvases.getCanvas("maskCanvas",i,s),BD(m.context,t));let v=ke.transform(l,[1/i,0,0,-1/s,0,0]);v=ke.transform(v,[1,0,0,1,0,-s]);const C=zd.slice();ke.axialAlignedBoundingBox([0,0,i,s],v,C);const[T,E,x,P]=C,b=Math.round(x-T)||1,I=Math.round(P-E)||1,M=this.cachedCanvases.getCanvas("fillCanvas",b,I),N=M.context,D=T,j=E;N.translate(-D,-j),N.transform(...v),h||(h=this._scaleImage(m.canvas,Is(N)),h=h.img,c&&a&&c.set(u,h)),N.imageSmoothingEnabled=FD(Qt(N),t.interpolate),SC(N,h,0,0,h.width,h.height,0,0,i,s),N.globalCompositeOperation="source-in";const F=ke.transform(Is(N),[1,0,0,1,-D,-j]);return N.fillStyle=a?o.getPattern(r,this,F,qn.FILL,e):o,N.fillRect(0,0,i,s),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,M.canvas)),(W=this.dependencyTracker)==null||W.recordDependencies(e,wi.transformAndFill),{canvas:M.canvas,offsetX:Math.round(D),offsetY:Math.round(j)}}setLineWidth(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineCap",e),this.ctx.lineCap=v$[t]}setLineJoin(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineJoin",e),this.ctx.lineJoin=y$[t]}setMiterLimit(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,r){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=r)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var r,i,s,o,a;for(const[l,c]of t)switch(l){case"LW":this.setLineWidth(e,c);break;case"LC":this.setLineCap(e,c);break;case"LJ":this.setLineJoin(e,c);break;case"ML":this.setMiterLimit(e,c);break;case"D":this.setDash(e,c[0],c[1]);break;case"RI":this.setRenderingIntent(e,c);break;case"FL":this.setFlatness(e,c);break;case"Font":this.setFont(e,c[0],c[1]);break;case"CA":(r=this.dependencyTracker)==null||r.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=c;break;case"ca":(i=this.dependencyTracker)==null||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=c;break;case"BM":(s=this.dependencyTracker)==null||s.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=c;break;case"SMask":(o=this.dependencyTracker)==null||o.recordSimpleData("SMask",e),this.current.activeSMask=c?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(a=this.dependencyTracker)==null||a.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(c);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,r=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,r);this.suspendedCtx=this.ctx;const o=this.ctx=s.context;o.setTransform(this.suspendedCtx.getTransform()),av(this.suspendedCtx,o),m$(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),av(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,r,i){const s=i[0],o=i[1],a=i[2]-s,l=i[3]-o;a===0||l===0||(this.genericComposeSMask(t.context,r,a,l,t.subtype,t.backdrop,t.transferMap,s,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,t,r,i,s,o,a,l,c,u,h){let m=e.canvas,v=l-u,C=c-h;if(o)if(v<0||C<0||v+r>m.width||C+i>m.height){const E=this.cachedCanvases.getCanvas("maskExtension",r,i),x=E.context;x.drawImage(m,-v,-C),x.globalCompositeOperation="destination-atop",x.fillStyle=o,x.fillRect(0,0,r,i),x.globalCompositeOperation="source-over",m=E.canvas,v=C=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(v,C,r,i),e.clip(E),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(v,C,r,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const T=new Path2D;T.rect(l,c,r,i),t.clip(T),t.globalCompositeOperation="destination-in",t.drawImage(m,v,C,r,i,l,c,r,i),t.restore()}save(e){var r;this.inSMaskMode&&av(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(r=this.dependencyTracker)==null||r.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&av(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,r,i,s,o,a){var l;(l=this.dependencyTracker)==null||l.recordIncrementalData("transform",e),this.ctx.transform(t,r,i,s,o,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,r,i){let[s]=r;if(!i){s||(s=r[0]=new Path2D),this[t](e,s);return}if(this.dependencyTracker!==null){const o=t===Wv.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-o,i[2]+o,i[1]-o,i[3]+o).recordDependencies(e,["transform"])}s instanceof Path2D||(s=r[0]=FF(s)),ke.axialAlignedBoundingBox(i,Qt(this.ctx),this.current.minMax),this[t](e,s),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,r=!0){var o;const i=this.ctx,s=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const a=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=s.getPattern(i,this,Is(i),qn.STROKE,e),a){const l=new Path2D;l.addPath(t,i.getTransform().invertSelf().multiplySelf(a)),t=l}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);(o=this.dependencyTracker)==null||o.recordDependencies(e,wi.stroke),r&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(qn.STROKE,Qt(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,r=!0){var c,u,h;const i=this.ctx,s=this.current.fillColor,o=this.current.patternFill;let a=!1;if(o){const m=s.isModifyingCurrentTransform()?i.getTransform():null;if((c=this.dependencyTracker)==null||c.save(e),i.save(),i.fillStyle=s.getPattern(i,this,Is(i),qn.FILL,e),m){const v=new Path2D;v.addPath(t,i.getTransform().invertSelf().multiplySelf(m)),t=v}a=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),(u=this.dependencyTracker)==null||u.recordDependencies(e,wi.fill),a&&(i.restore(),(h=this.dependencyTracker)==null||h.restore(e)),r&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var r;this.ctx.fill(t),(r=this.dependencyTracker)==null||r.recordDependencies(e,wi.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=S$}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=jD}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,r=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,s=r.getTransform().invertSelf();for(const{transform:o,x:a,y:l,fontSize:c,path:u}of t)u&&i.addPath(u,new DOMMatrix(o).preMultiplySelf(s).translate(a,l).scale(c,-c));r.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,r){var h,m;(h=this.dependencyTracker)==null||h.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=i.fontMatrix||Gw,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Ze("Invalid font matrix for font "+t),r<0?(r=-r,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=r,i.isType3Font)return;const o=i.loadedName||"sans-serif",a=((m=i.systemFontInfo)==null?void 0:m.css)||`"${o}", ${i.fallbackName}`;let l="normal";i.black?l="900":i.bold&&(l="bold");const c=i.italic?"italic":"normal";let u=r;r<MD?u=MD:r>ND&&(u=ND),this.current.fontSizeScale=r/u,this.ctx.font=`${c} ${l} ${u}px ${a}`}setTextRenderingMode(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,r){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=r}setLeadingMoveText(e,t,r){this.setLeading(e,-r),this.moveText(e,t,r)}setTextMatrix(e,t){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:r}=this;r.textMatrix=t,r.textMatrixScale=Math.hypot(t[0],t[1]),r.x=r.lineX=0,r.y=r.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,r,i,s,o){var x,P,b,I;const a=this.ctx,l=this.current,c=l.font,u=l.textRenderingMode,h=l.fontSize/l.fontSizeScale,m=u&Tn.FILL_STROKE_MASK,v=!!(u&Tn.ADD_TO_PATH_FLAG),C=l.patternFill&&!c.missingFile,T=l.patternStroke&&!c.missingFile;let E;if((c.disableFontFace||v||C||T)&&!c.missingFile&&(E=c.getPathGenerator(this.commonObjs,t)),E&&(c.disableFontFace||C||T)){a.save(),a.translate(r,i),a.scale(h,-h),(x=this.dependencyTracker)==null||x.recordCharacterBBox(e,a,c);let M;if(m===Tn.FILL||m===Tn.FILL_STROKE)if(s){M=a.getTransform(),a.setTransform(...s);const N=B(this,gs,Rb).call(this,E,M,s);a.fill(N)}else a.fill(E);if(m===Tn.STROKE||m===Tn.FILL_STROKE)if(o){M||(M=a.getTransform()),a.setTransform(...o);const{a:N,b:D,c:j,d:F}=M,z=ke.inverseTransform(o),W=ke.transform([N,D,j,F,0,0],z);ke.singularValueDecompose2dScale(W,pi),a.lineWidth*=Math.max(pi[0],pi[1])/h,a.stroke(B(this,gs,Rb).call(this,E,M,o))}else a.lineWidth/=h,a.stroke(E);a.restore()}else(m===Tn.FILL||m===Tn.FILL_STROKE)&&(a.fillText(t,r,i),(P=this.dependencyTracker)==null||P.recordCharacterBBox(e,a,c,h,r,i,()=>a.measureText(t))),(m===Tn.STROKE||m===Tn.FILL_STROKE)&&(this.dependencyTracker&&((b=this.dependencyTracker)==null||b.recordCharacterBBox(e,a,c,h,r,i,()=>a.measureText(t)).recordDependencies(e,wi.stroke)),a.strokeText(t,r,i));v&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Qt(a),x:r,y:i,fontSize:h,path:E}),(I=this.dependencyTracker)==null||I.recordCharacterBBox(e,a,c,h,r,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let r=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){r=!0;break}return Ye(this,"isFontSubpixelAAEnabled",r)}showText(e,t){var W,H,V,K;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,wi.showText).resetBBox(e),this.current.textRenderingMode&Tn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const r=this.current,i=r.font;if(i.isType3Font){this.showType3Text(e,t),(W=this.dependencyTracker)==null||W.recordShowTextOperation(e);return}const s=r.fontSize;if(s===0){(H=this.dependencyTracker)==null||H.recordOperation(e);return}const o=this.ctx,a=r.fontSizeScale,l=r.charSpacing,c=r.wordSpacing,u=r.fontDirection,h=r.textHScale*u,m=t.length,v=i.vertical,C=v?1:-1,T=i.defaultVMetrics,E=s*r.fontMatrix[0],x=r.textRenderingMode===Tn.FILL&&!i.disableFontFace&&!r.patternFill;o.save(),r.textMatrix&&o.transform(...r.textMatrix),o.translate(r.x,r.y+r.textRise),u>0?o.scale(h,-1):o.scale(h,1);let P,b;const I=r.textRenderingMode&Tn.FILL_STROKE_MASK,M=I===Tn.FILL||I===Tn.FILL_STROKE,N=I===Tn.STROKE||I===Tn.FILL_STROKE;if(M&&r.patternFill){o.save();const ee=r.fillColor.getPattern(o,this,Is(o),qn.FILL,e);P=Qt(o),o.restore(),o.fillStyle=ee}if(N&&r.patternStroke){o.save();const ee=r.strokeColor.getPattern(o,this,Is(o),qn.STROKE,e);b=Qt(o),o.restore(),o.strokeStyle=ee}let D=r.lineWidth;const j=r.textMatrixScale;if(j===0||D===0?N&&(D=this.getSinglePixelWidth()):D/=j,a!==1&&(o.scale(a,a),D/=a),o.lineWidth=D,i.isInvalidPDFjsFont){const ee=[];let G=0;for(const Y of t)ee.push(Y.unicode),G+=Y.width;const X=ee.join("");if(o.fillText(X,0,0),this.dependencyTracker!==null){const Y=o.measureText(X);this.dependencyTracker.recordBBox(e,this.ctx,-Y.actualBoundingBoxLeft,Y.actualBoundingBoxRight,-Y.actualBoundingBoxAscent,Y.actualBoundingBoxDescent).recordShowTextOperation(e)}r.x+=G*E*h,o.restore(),this.compose();return}let F=0,z;for(z=0;z<m;++z){const ee=t[z];if(typeof ee=="number"){F+=C*ee*s/1e3;continue}let G=!1;const X=(ee.isSpace?c:0)+l,Y=ee.fontChar,ce=ee.accent;let ae,$,J=ee.width;if(v){const Te=ee.vmetric||T,le=-(ee.vmetric?Te[1]:J*.5)*E,se=Te[2]*E;J=Te?-Te[0]:J,ae=le/a,$=(F+se)/a}else ae=F/a,$=0;let de;if(i.remeasure&&J>0){de=o.measureText(Y);const Te=de.width*1e3/s*a;if(J<Te&&this.isFontSubpixelAAEnabled){const le=J/Te;G=!0,o.save(),o.scale(le,1),ae/=le}else J!==Te&&(ae+=(J-Te)/2e3*s/a)}if(this.contentVisible&&(ee.isInFont||i.missingFile)){if(x&&!ce)o.fillText(Y,ae,$),(V=this.dependencyTracker)==null||V.recordCharacterBBox(e,o,de?{bbox:null}:i,s/a,ae,$,()=>de??o.measureText(Y));else if(this.paintChar(e,Y,ae,$,P,b),ce){const Te=ae+s*ce.offset.x/a,le=$-s*ce.offset.y/a;this.paintChar(e,ce.fontChar,Te,le,P,b)}}const me=v?J*E-X*u:J*E+X*u;F+=me,G&&o.restore()}v?r.y-=F:r.x+=F*h,o.restore(),this.compose(),(K=this.dependencyTracker)==null||K.recordShowTextOperation(e)}showType3Text(e,t){const r=this.ctx,i=this.current,s=i.font,o=i.fontSize,a=i.fontDirection,l=s.vertical?1:-1,c=i.charSpacing,u=i.wordSpacing,h=i.textHScale*a,m=i.fontMatrix||Gw,v=t.length,C=i.textRenderingMode===Tn.INVISIBLE;let T,E,x,P;if(C||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,r.save(),i.textMatrix&&r.transform(...i.textMatrix),r.translate(i.x,i.y+i.textRise),r.scale(h,a);const b=this.dependencyTracker;for(this.dependencyTracker=b?new CA(b,e):null,T=0;T<v;++T){if(E=t[T],typeof E=="number"){P=l*E*o/1e3,this.ctx.translate(P,0),i.x+=P*h;continue}const I=(E.isSpace?u:0)+c,M=s.charProcOperatorList[E.operatorListId];M?this.contentVisible&&(this.save(),r.scale(o,o),r.transform(...m),this.executeOperatorList(M),this.restore()):Ze(`Type3 character "${E.operatorListId}" is not available.`);const N=[E.width,0];ke.applyTransform(N,m),x=N[0]*o+I,r.translate(x,0),i.x+=x*h}r.restore(),b&&(this.dependencyTracker=b)}setCharWidth(e,t,r){}setCharWidthAndBounds(e,t,r,i,s,o,a){var c;const l=new Path2D;l.rect(i,s,o-i,a-s),this.ctx.clip(l),(c=this.dependencyTracker)==null||c.recordBBox(e,this.ctx,i,o,s,a).recordClipBox(e,this.ctx,i,o,s,a),this.endPath(e)}getColorN_Pattern(e,t){let r;if(t[0]==="TilingPattern"){const i=this.baseTransform||Qt(this.ctx),s={createCanvasGraphics:(o,a)=>new wR(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new CA(this.dependencyTracker,a,!0):null)};r=new wb(t,this.ctx,s,i)}else r=this._getPattern(e,t[1],t[2]);return r}setStrokeColorN(e,...t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,r=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=h$(this.getObject(e,t)),this.cachedPatterns.set(t,i)),r&&(i.matrix=r),i}shadingFill(e,t){var o;if(!this.contentVisible)return;const r=this.ctx;this.save(e);const i=this._getPattern(e,t);r.fillStyle=i.getPattern(r,this,Is(r),qn.SHADING,e);const s=Is(r);if(s){const{width:a,height:l}=r.canvas,c=zd.slice();ke.axialAlignedBoundingBox([0,0,a,l],s,c);const[u,h,m,v]=c;this.ctx.fillRect(u,h,m-u,v-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(o=this.dependencyTracker)==null||o.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,wi.transform).recordDependencies(e,wi.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Dt("Should not call beginInlineImage")}beginImageData(){Dt("Should not call beginImageData")}paintFormXObjectBegin(e,t,r){var i;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Qt(this.ctx),r)){ke.axialAlignedBoundingBox(r,this.baseTransform,this.current.minMax);const[s,o,a,l]=r,c=new Path2D;c.rect(s,o,a-s,l-o),this.ctx.clip(c),(i=this.dependencyTracker)==null||i.recordClipBox(e,this.ctx,s,a,o,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var b;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;t.isolated||sT("TODO: Support non-isolated groups."),t.knockout&&Ze("Knockout groups not supported.");const i=Qt(r);if(t.matrix&&r.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=zd.slice();ke.axialAlignedBoundingBox(t.bbox,Qt(r),s);const o=[0,0,r.canvas.width,r.canvas.height];s=ke.intersect(s,o)||[0,0,0,0];const a=Math.floor(s[0]),l=Math.floor(s[1]),c=Math.max(Math.ceil(s[2])-a,1),u=Math.max(Math.ceil(s[3])-l,1);this.current.startNewPathAndClipBox([0,0,c,u]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(h,c,u),v=m.context;v.translate(-a,-l),v.transform(...i);let C=new Path2D;const[T,E,x,P]=t.bbox;if(C.rect(T,E,x-T,P-E),t.matrix){const I=new Path2D;I.addPath(C,new DOMMatrix(t.matrix)),C=I}v.clip(C),t.smask&&this.smaskStack.push({canvas:m.canvas,context:v,offsetX:a,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(r.setTransform(1,0,0,1,0,0),r.translate(a,l),r.save()),av(r,v),this.ctx=v,(b=this.dependencyTracker)==null||b.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(r),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(e,t){var s;if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,(s=this.dependencyTracker)==null||s.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=Qt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const a=zd.slice();ke.axialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],o,a),this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,r,i,s,o){if(B(this,gs,bb).call(this),CC(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),r){const a=r[2]-r[0],l=r[3]-r[1];if(o&&this.annotationCanvasMap){i=i.slice(),i[4]-=r[0],i[5]-=r[1],r=r.slice(),r[0]=r[1]=0,r[2]=a,r[3]=l,ke.singularValueDecompose2dScale(Qt(this.ctx),pi);const{viewportScale:c}=this,u=Math.ceil(a*this.outputScaleX*c),h=Math.ceil(l*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(u,h);const{canvas:m,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(t,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(pi[0],0,0,-pi[1],0,l*pi[1]),CC(this.ctx)}else{CC(this.ctx),this.endPath(e);const c=new Path2D;c.rect(r[0],r[1],a,l),this.ctx.clip(c)}}this.current=new DD(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...s)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),B(this,gs,Pb).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var a;if(!this.contentVisible)return;const r=t.count;t=this.getObject(e,t.data,t),t.count=r;const i=this.ctx,s=this._createMaskCanvas(e,t),o=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(o,s.offsetX,s.offsetY),(a=this.dependencyTracker)==null||a.resetBBox(e).recordBBox(e,this.ctx,s.offsetX,s.offsetX+o.width,s.offsetY,s.offsetY+o.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,r,i=0,s=0,o,a){var h,m,v;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const l=this.ctx;l.save();const c=Qt(l);l.transform(r,i,s,o,0,0);const u=this._createMaskCanvas(e,t);l.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]),(h=this.dependencyTracker)==null||h.resetBBox(e);for(let C=0,T=a.length;C<T;C+=2){const E=ke.transform(c,[r,i,s,o,a[C],a[C+1]]);l.drawImage(u.canvas,E[4],E[5]),(m=this.dependencyTracker)==null||m.recordBBox(e,this.ctx,E[4],E[4]+u.canvas.width,E[5],E[5]+u.canvas.height)}l.restore(),this.compose(),(v=this.dependencyTracker)==null||v.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var o,a,l;if(!this.contentVisible)return;const r=this.ctx,i=this.current.fillColor,s=this.current.patternFill;(o=this.dependencyTracker)==null||o.resetBBox(e).recordDependencies(e,wi.transformAndFill);for(const c of t){const{data:u,width:h,height:m,transform:v}=c,C=this.cachedCanvases.getCanvas("maskCanvas",h,m),T=C.context;T.save();const E=this.getObject(e,u,c);BD(T,E),T.globalCompositeOperation="source-in",T.fillStyle=s?i.getPattern(T,this,Is(r),qn.FILL,e):i,T.fillRect(0,0,h,m),T.restore(),r.save(),r.transform(...v),r.scale(1,-1),SC(r,C.canvas,0,0,h,m,0,-1,1,1),(a=this.dependencyTracker)==null||a.recordBBox(e,r,0,h,0,m),r.restore()}this.compose(),(l=this.dependencyTracker)==null||l.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const r=this.getObject(e,t);if(!r){Ze("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,r)}paintImageXObjectRepeat(e,t,r,i,s){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){Ze("Dependent image isn't ready yet");return}const a=o.width,l=o.height,c=[];for(let u=0,h=s.length;u<h;u+=2)c.push({transform:[r,0,0,i,s[u],s[u+1]],x:0,y:0,w:a,h:l});this.paintInlineImageXObjectGroup(e,o,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:r,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",r,i),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",s.canvas}paintInlineImageXObject(e,t){var c;if(!this.contentVisible)return;const r=t.width,i=t.height,s=this.ctx;this.save(e);const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none"),s.scale(1/r,-1/i);let a;if(t.bitmap)a=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)a=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",r,i).context;OD(h,t),a=this.applyTransferMapsToCanvas(h)}const l=this._scaleImage(a,Is(s));s.imageSmoothingEnabled=FD(Qt(s),t.interpolate),(c=this.dependencyTracker)==null||c.resetBBox(e).recordBBox(e,s,0,r,-i,0).recordDependencies(e,wi.imageXObject).recordOperation(e),SC(s,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,r,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,r){var o,a,l;if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const c=t.width,u=t.height,m=this.cachedCanvases.getCanvas("inlineImage",c,u).context;OD(m,t),s=this.applyTransferMapsToCanvas(m)}(o=this.dependencyTracker)==null||o.resetBBox(e);for(const c of r)i.save(),i.transform(...c.transform),i.scale(1,-1),SC(i,s,c.x,c.y,c.w,c.h,0,-1,1,1),(a=this.dependencyTracker)==null||a.recordBBox(e,i,0,1,-1,0),i.restore();(l=this.dependencyTracker)==null||l.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,wi.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,r){}beginMarkedContent(e,t){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,r){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,r){var o,a;const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(r);const s=this.ctx;this.pendingClip?(i||(this.pendingClip===jD?s.clip(t,"evenodd"):s.clip(t)),this.pendingClip=null,(o=this.dependencyTracker)==null||o.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(a=this.dependencyTracker)==null||a.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Qt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:r,c:i,d:s}=this.ctx.getTransform();let o,a;if(r===0&&i===0){const l=Math.abs(t),c=Math.abs(s);if(l===c)if(e===0)o=a=1/l;else{const u=l*e;o=a=u<1?1/u:1}else if(e===0)o=1/l,a=1/c;else{const u=l*e,h=c*e;o=u<1?1/u:1,a=h<1?1/h:1}}else{const l=Math.abs(t*s-r*i),c=Math.hypot(t,r),u=Math.hypot(i,s);if(e===0)o=u/l,a=c/l;else{const h=e*l;o=u>h?u/h:1,a=c>h?c/h:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:r,current:{lineWidth:i}}=this,[s,o]=this.getScaleForStroking();if(s===o){r.lineWidth=(i||1)*s,r.stroke(e);return}const a=r.getLineDash();t&&r.save(),r.scale(s,o),Iw.a=1/s,Iw.d=1/o;const l=new Path2D;if(l.addPath(e,Iw),a.length>0){const c=Math.max(s,o);r.setLineDash(a.map(u=>u/c)),r.lineDashOffset/=c}r.lineWidth=i||1,r.stroke(l),t&&r.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};gs=new WeakSet,bb=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Pb=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Rb=function(e,t,r){const i=new Path2D;return i.addPath(e,new DOMMatrix(r).invertSelf().multiplySelf(t)),i};let Gd=wR;for(const n in Wv)Gd.prototype[n]!==void 0&&(Gd.prototype[Wv[n]]=Gd.prototype[n]);var Oy,By;class eo{static get workerPort(){return f(this,Oy)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");_(this,Oy,e)}static get workerSrc(){return f(this,By)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");_(this,By,e)}}Oy=new WeakMap,By=new WeakMap,L(eo,Oy,null),L(eo,By,"");var Nh,Fy;class C${constructor({parsedData:e,rawData:t}){L(this,Nh);L(this,Fy);_(this,Nh,e),_(this,Fy,t)}getRaw(){return f(this,Fy)}get(e){return f(this,Nh).get(e)??null}[Symbol.iterator](){return f(this,Nh).entries()}}Nh=new WeakMap,Fy=new WeakMap;const Dd=Symbol("INTERNAL");var jy,Uy,zy,Lh;class A${constructor(e,{name:t,intent:r,usage:i,rbGroups:s}){L(this,jy,!1);L(this,Uy,!1);L(this,zy,!1);L(this,Lh,!0);_(this,jy,!!(e&hi.DISPLAY)),_(this,Uy,!!(e&hi.PRINT)),this.name=t,this.intent=r,this.usage=i,this.rbGroups=s}get visible(){if(f(this,zy))return f(this,Lh);if(!f(this,Lh))return!1;const{print:e,view:t}=this.usage;return f(this,jy)?(t==null?void 0:t.viewState)!=="OFF":f(this,Uy)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,r=!1){e!==Dd&&Dt("Internal method `_setVisible` called."),_(this,zy,r),_(this,Lh,t)}}jy=new WeakMap,Uy=new WeakMap,zy=new WeakMap,Lh=new WeakMap;var fl,_t,Dh,Oh,Wy,Ib;class T${constructor(e,t=hi.DISPLAY){L(this,Wy);L(this,fl,null);L(this,_t,new Map);L(this,Dh,null);L(this,Oh,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,_(this,Oh,e.order);for(const r of e.groups)f(this,_t).set(r.id,new A$(t,r));if(e.baseState==="OFF")for(const r of f(this,_t).values())r._setVisible(Dd,!1);for(const r of e.on)f(this,_t).get(r)._setVisible(Dd,!0);for(const r of e.off)f(this,_t).get(r)._setVisible(Dd,!1);_(this,Dh,this.getHash())}}isVisible(e){if(f(this,_t).size===0)return!0;if(!e)return sT("Optional content group not defined."),!0;if(e.type==="OCG")return f(this,_t).has(e.id)?f(this,_t).get(e.id).visible:(Ze(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return B(this,Wy,Ib).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!f(this,_t).has(t))return Ze(`Optional content group not found: ${t}`),!0;if(f(this,_t).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!f(this,_t).has(t))return Ze(`Optional content group not found: ${t}`),!0;if(!f(this,_t).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!f(this,_t).has(t))return Ze(`Optional content group not found: ${t}`),!0;if(!f(this,_t).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!f(this,_t).has(t))return Ze(`Optional content group not found: ${t}`),!0;if(f(this,_t).get(t).visible)return!1}return!0}return Ze(`Unknown optional content policy ${e.policy}.`),!0}return Ze(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,r=!0){var s;const i=f(this,_t).get(e);if(!i){Ze(`Optional content group not found: ${e}`);return}if(r&&t&&i.rbGroups.length)for(const o of i.rbGroups)for(const a of o)a!==e&&((s=f(this,_t).get(a))==null||s._setVisible(Dd,!1,!0));i._setVisible(Dd,!!t,!0),_(this,fl,null)}setOCGState({state:e,preserveRB:t}){let r;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":r=i;continue}const s=f(this,_t).get(i);if(s)switch(r){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!s.visible,t);break}}_(this,fl,null)}get hasInitialVisibility(){return f(this,Dh)===null||this.getHash()===f(this,Dh)}getOrder(){return f(this,_t).size?f(this,Oh)?f(this,Oh).slice():[...f(this,_t).keys()]:null}getGroup(e){return f(this,_t).get(e)||null}getHash(){if(f(this,fl)!==null)return f(this,fl);const e=new gj;for(const[t,r]of f(this,_t))e.update(`${t}:${r.visible}`);return _(this,fl,e.hexdigest())}[Symbol.iterator](){return f(this,_t).entries()}}fl=new WeakMap,_t=new WeakMap,Dh=new WeakMap,Oh=new WeakMap,Wy=new WeakSet,Ib=function(e){const t=e.length;if(t<2)return!0;const r=e[0];for(let i=1;i<t;i++){const s=e[i];let o;if(Array.isArray(s))o=B(this,Wy,Ib).call(this,s);else if(f(this,_t).has(s))o=f(this,_t).get(s).visible;else return Ze(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return r==="And"};class E${constructor(e,{disableRange:t=!1,disableStream:r=!1}){dt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(s==null?void 0:s.length)>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const r=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(r),!0)});dt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,r,i,s;e.total===void 0?(r=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||r.call(t,{loaded:e.loaded}):(s=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||s.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){dt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new x$(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new w$(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeReaders.slice(0))r.cancel(e);this._pdfDataRangeTransport.abort()}}class x${constructor(e,t,r=!1,i=null){this._stream=e,this._done=r||!1,this._filename=tR(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class w${constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function b$(n){let e=!0,t=r("filename\\*","i").exec(n);if(t){t=t[1];let u=a(t);return u=unescape(u),u=l(u),u=c(u),s(u)}if(t=o(n),t){const u=c(t);return s(u)}if(t=r("filename","i").exec(n),t){t=t[1];let u=a(t);return u=c(u),s(u)}function r(u,h){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function i(u,h){if(u){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const m=new TextDecoder(u,{fatal:!0}),v=WS(h);h=m.decode(v),e=!1}catch{}}return h}function s(u){return e&&/[\x80-\xff]/.test(u)&&(u=i("utf-8",u),e&&(u=i("iso-8859-1",u))),u}function o(u){const h=[];let m;const v=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=v.exec(u))!==null;){let[,T,E,x]=m;if(T=parseInt(T,10),T in h){if(T===0)break;continue}h[T]=[E,x]}const C=[];for(let T=0;T<h.length&&T in h;++T){let[E,x]=h[T];x=a(x),E&&(x=unescape(x),T===0&&(x=l(x))),C.push(x)}return C.join("")}function a(u){if(u.startsWith('"')){const h=u.slice(1).split('\\"');for(let m=0;m<h.length;++m){const v=h[m].indexOf('"');v!==-1&&(h[m]=h[m].slice(0,v),h.length=m+1),h[m]=h[m].replaceAll(/\\(.)/g,"$1")}u=h.join('"')}return u}function l(u){const h=u.indexOf("'");if(h===-1)return u;const m=u.slice(0,h),C=u.slice(h+1).replace(/^[^']*'/,"");return i(m,C)}function c(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,m,v,C){if(v==="q"||v==="Q")return C=C.replaceAll("_"," "),C=C.replaceAll(/=([0-9a-fA-F]{2})/g,function(T,E){return String.fromCharCode(parseInt(E,16))}),i(m,C);try{C=atob(C)}catch{}return i(m,C)})}return""}function Rj(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const r in e){const i=e[r];i!==void 0&&t.append(r,i)}return t}function aT(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function Ij({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:r}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*t)||r||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function _j(n){const e=n.get("Content-Disposition");if(e){let t=b$(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(tR(t))return t}return null}function qS(n,e){return new fA(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function kj(n){return n===200||n===206}function Mj(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Nj(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Ze(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class P${constructor(e){q(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Rj(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return dt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new R$(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new I$(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class R${constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const r=new Headers(e.headers),i=t.url;fetch(i,Mj(r,this._withCredentials,this._abortController)).then(s=>{if(e._responseOrigin=aT(s.url),!kj(s.status))throw qS(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const o=s.headers,{allowRangeRequests:a,suggestedLength:l}=Ij({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=_j(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ul("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Nj(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class I${constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${t}-${r-1}`);const o=i.url;fetch(o,Mj(s,this._withCredentials,this._abortController)).then(a=>{const l=aT(a.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!kj(a.status))throw qS(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:Nj(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const _w=200,kw=206;function _$(n){const e=n.response;return typeof e!="string"?e:WS(e).buffer}class k${constructor({url:e,httpHeaders:t,withCredentials:r}){q(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Rj(this.isHttp,t),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,r=this.currXhrId++,i=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,o]of this.headers)t.setRequestHeader(s,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=kw):i.expectedStatus=_w,t.responseType="arraybuffer",dt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){var i;const r=this.pendingRequests[e];r&&((i=r.onProgress)==null||i.call(r,t))}onStateChange(e,t){const r=this.pendingRequests[e];if(!r)return;const i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){r.onError(i.status);return}const s=i.status||_w;if(!(s===_w&&r.expectedStatus===kw)&&s!==r.expectedStatus){r.onError(i.status);return}const a=_$(i);if(s===kw){const l=i.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?r.onDone({begin:parseInt(c[1],10),chunk:a}):(Ze('Missing or invalid "Content-Range" header.'),r.onError(0))}else a?r.onDone({begin:0,chunk:a}):r.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class M${constructor(e){this._source=e,this._manager=new k$(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return dt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new N$(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const r=new L$(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class N${constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=aT(t.responseURL);const r=t.getAllResponseHeaders(),i=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[l,...c]=a.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:o}=Ij({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=_j(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=qS(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L${constructor(e,t,r){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=aT((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=qS(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const D$=/^[a-z][a-z0-9\-+.]+:/i;function O$(n){if(D$.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class B${constructor(e){this.source=e,this.url=O$(e.url),dt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return dt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new F$(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new j$(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class F${constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=qS(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ul("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class j${constructor(e,t,r){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const lv=Symbol("INITIAL_DATA");var Jr,Vy,_b;class Lj{constructor(){L(this,Vy);L(this,Jr,Object.create(null))}get(e,t=null){if(t){const i=B(this,Vy,_b).call(this,e);return i.promise.then(()=>t(i.data)),null}const r=f(this,Jr)[e];if(!r||r.data===lv)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const t=f(this,Jr)[e];return!!t&&t.data!==lv}delete(e){const t=f(this,Jr)[e];return!t||t.data===lv?!1:(delete f(this,Jr)[e],!0)}resolve(e,t=null){const r=B(this,Vy,_b).call(this,e);r.data=t,r.resolve()}clear(){var e;for(const t in f(this,Jr)){const{data:r}=f(this,Jr)[t];(e=r==null?void 0:r.bitmap)==null||e.close()}_(this,Jr,Object.create(null))}*[Symbol.iterator](){for(const e in f(this,Jr)){const{data:t}=f(this,Jr)[e];t!==lv&&(yield[e,t])}}}Jr=new WeakMap,Vy=new WeakSet,_b=function(e){var t;return(t=f(this,Jr))[e]||(t[e]={...Promise.withResolvers(),data:lv})};const U$=1e5,UD=30;var cB,ml,Xr,$y,Hy,du,Vo,Zy,qy,hu,Gy,Bh,gl,Fh,Ky,jh,pu,Yy,Jy,Uh,fu,Xy,zh,Wh,ha,Dj,Oj,kb,mi,VC,Mb,Bj,Fj;const zn=class zn{constructor({textContentSource:e,container:t,viewport:r}){L(this,ha);L(this,ml,Promise.withResolvers());L(this,Xr,null);L(this,$y,!1);L(this,Hy,!!((cB=globalThis.FontInspector)!=null&&cB.enabled));L(this,du,null);L(this,Vo,null);L(this,Zy,0);L(this,qy,0);L(this,hu,null);L(this,Gy,null);L(this,Bh,0);L(this,gl,0);L(this,Fh,Object.create(null));L(this,Ky,[]);L(this,jh,null);L(this,pu,[]);L(this,Yy,new WeakMap);L(this,Jy,null);var l;if(e instanceof ReadableStream)_(this,jh,e);else if(typeof e=="object")_(this,jh,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');_(this,Xr,_(this,Gy,t)),_(this,gl,r.scale*to.pixelRatio),_(this,Bh,r.rotation),_(this,Vo,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:o,pageY:a}=r.rawDims;_(this,Jy,[1,0,0,-1,-o,a+s]),_(this,qy,i),_(this,Zy,s),B(l=zn,mi,Bj).call(l),t.style.setProperty("--min-font-size",f(zn,zh)),Ku(t,r),f(this,ml).promise.finally(()=>{f(zn,Wh).delete(this),_(this,Vo,null),_(this,Fh,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Pn.platform;return Ye(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{f(this,hu).read().then(({value:t,done:r})=>{if(r){f(this,ml).resolve();return}f(this,du)??_(this,du,t.lang),Object.assign(f(this,Fh),t.styles),B(this,ha,Dj).call(this,t.items),e()},f(this,ml).reject)};return _(this,hu,f(this,jh).getReader()),f(zn,Wh).add(this),e(),f(this,ml).promise}update({viewport:e,onBefore:t=null}){var s;const r=e.scale*to.pixelRatio,i=e.rotation;if(i!==f(this,Bh)&&(t==null||t(),_(this,Bh,i),Ku(f(this,Gy),{rotation:i})),r!==f(this,gl)){t==null||t(),_(this,gl,r);const o={div:null,properties:null,ctx:B(s=zn,mi,VC).call(s,f(this,du))};for(const a of f(this,pu))o.properties=f(this,Yy).get(a),o.div=a,B(this,ha,kb).call(this,o)}}cancel(){var t;const e=new Ul("TextLayer task cancelled.");(t=f(this,hu))==null||t.cancel(e).catch(()=>{}),_(this,hu,null),f(this,ml).reject(e)}get textDivs(){return f(this,pu)}get textContentItemsStr(){return f(this,Ky)}static cleanup(){if(!(f(this,Wh).size>0)){f(this,Uh).clear();for(const{canvas:e}of f(this,fu).values())e.remove();f(this,fu).clear()}}};ml=new WeakMap,Xr=new WeakMap,$y=new WeakMap,Hy=new WeakMap,du=new WeakMap,Vo=new WeakMap,Zy=new WeakMap,qy=new WeakMap,hu=new WeakMap,Gy=new WeakMap,Bh=new WeakMap,gl=new WeakMap,Fh=new WeakMap,Ky=new WeakMap,jh=new WeakMap,pu=new WeakMap,Yy=new WeakMap,Jy=new WeakMap,Uh=new WeakMap,fu=new WeakMap,Xy=new WeakMap,zh=new WeakMap,Wh=new WeakMap,ha=new WeakSet,Dj=function(e){var i,s;if(f(this,$y))return;(s=f(this,Vo)).ctx??(s.ctx=B(i=zn,mi,VC).call(i,f(this,du)));const t=f(this,pu),r=f(this,Ky);for(const o of e){if(t.length>U$){Ze("Ignoring additional textDivs for performance reasons."),_(this,$y,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=f(this,Xr);_(this,Xr,document.createElement("span")),f(this,Xr).classList.add("markedContent"),o.id&&f(this,Xr).setAttribute("id",`${o.id}`),a.append(f(this,Xr))}else o.type==="endMarkedContent"&&_(this,Xr,f(this,Xr).parentNode);continue}r.push(o.str),B(this,ha,Oj).call(this,o)}},Oj=function(e){var C;const t=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};f(this,pu).push(t);const i=ke.transform(f(this,Jy),e.transform);let s=Math.atan2(i[1],i[0]);const o=f(this,Fh)[e.fontName];o.vertical&&(s+=Math.PI/2);let a=f(this,Hy)&&o.fontSubstitution||o.fontFamily;a=zn.fontFamilyMap.get(a)||a;const l=Math.hypot(i[2],i[3]),c=l*B(C=zn,mi,Fj).call(C,a,o,f(this,du));let u,h;s===0?(u=i[4],h=i[5]-c):(u=i[4]+c*Math.sin(s),h=i[5]-c*Math.cos(s));const m=t.style;m.left=`${(100*u/f(this,qy)).toFixed(2)}%`,m.top=`${(100*h/f(this,Zy)).toFixed(2)}%`,m.setProperty("--font-height",`${l.toFixed(2)}px`),m.fontFamily=a,r.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,f(this,Hy)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),s!==0&&(r.angle=s*(180/Math.PI));let v=!1;if(e.str.length>1)v=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const T=Math.abs(e.transform[0]),E=Math.abs(e.transform[3]);T!==E&&Math.max(T,E)/Math.min(T,E)>1.5&&(v=!0)}if(v&&(r.canvasWidth=o.vertical?e.height:e.width),f(this,Yy).set(t,r),f(this,Vo).div=t,f(this,Vo).properties=r,B(this,ha,kb).call(this,f(this,Vo)),r.hasText&&f(this,Xr).append(t),r.hasEOL){const T=document.createElement("br");T.setAttribute("role","presentation"),f(this,Xr).append(T)}},kb=function(e){var o;const{div:t,properties:r,ctx:i}=e,{style:s}=t;if(r.canvasWidth!==0&&r.hasText){const{fontFamily:a}=s,{canvasWidth:l,fontSize:c}=r;B(o=zn,mi,Mb).call(o,i,c*f(this,gl),a);const{width:u}=i.measureText(t.textContent);u>0&&s.setProperty("--scale-x",l*f(this,gl)/u)}r.angle!==0&&s.setProperty("--rotate",`${r.angle}deg`)},mi=new WeakSet,VC=function(e=null){let t=f(this,fu).get(e||(e=""));if(!t){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),t=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),f(this,fu).set(e,t),f(this,Xy).set(t,{size:0,family:""})}return t},Mb=function(e,t,r){const i=f(this,Xy).get(e);t===i.size&&r===i.family||(e.font=`${t}px ${r}`,i.size=t,i.family=r)},Bj=function(){if(f(this,zh)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),_(this,zh,e.getBoundingClientRect().height),e.remove()},Fj=function(e,t,r){const i=f(this,Uh).get(e);if(i)return i;const s=B(this,mi,VC).call(this,r);s.canvas.width=s.canvas.height=UD,B(this,mi,Mb).call(this,s,UD,e);const o=s.measureText(""),a=o.fontBoundingBoxAscent,l=Math.abs(o.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let c=.8;return a?c=a/(a+l):(Pn.platform.isFirefox&&Ze("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),f(this,Uh).set(e,c),c},L(zn,mi),L(zn,Uh,new Map),L(zn,fu,new Map),L(zn,Xy,new WeakMap),L(zn,zh,null),L(zn,Wh,new Set);let $v=zn;const z$=100;function jj(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new Nb,{docId:t}=e,r=n.url?GV(n.url):null,i=n.data?KV(n.data):null,s=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,l=n.range instanceof Uj?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let u=n.worker instanceof Hv?n.worker:null;const h=n.verbosity,m=typeof n.docBaseUrl=="string"&&!oT(n.docBaseUrl)?n.docBaseUrl:null,v=mC(n.cMapUrl),C=n.cMapPacked!==!1,T=n.CMapReaderFactory||(yr?r$:bD),E=mC(n.iccUrl),x=mC(n.standardFontDataUrl),P=n.StandardFontDataFactory||(yr?i$:PD),b=mC(n.wasmUrl),I=n.WasmFactory||(yr?s$:RD),M=n.stopAtErrors!==!0,N=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,D=n.isEvalSupported!==!1,j=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!yr,F=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!yr&&(Pn.platform.isFirefox||!globalThis.chrome),z=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,W=typeof n.disableFontFace=="boolean"?n.disableFontFace:yr,H=n.fontExtraProperties===!0,V=n.enableXfa===!0,K=n.ownerDocument||globalThis.document,ee=n.disableRange===!0,G=n.disableStream===!0,X=n.disableAutoFetch===!0,Y=n.pdfBug===!0,ce=n.CanvasFactory||(yr?n$:QV),ae=n.FilterFactory||(yr?t$:e$),$=n.enableHWA===!0,J=n.useWasm!==!1,de=l?l.length:n.length??NaN,me=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!yr&&!W,Te=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(T===bD&&P===PD&&I===RD&&v&&x&&b&&gv(v,document.baseURI)&&gv(x,document.baseURI)&&gv(b,document.baseURI)),le=null;AV(h);const se={canvasFactory:new ce({ownerDocument:K,enableHWA:$}),filterFactory:new ae({docId:t,ownerDocument:K}),cMapReaderFactory:Te?null:new T({baseUrl:v,isCompressed:C}),standardFontDataFactory:Te?null:new P({baseUrl:x}),wasmFactory:Te?null:new I({baseUrl:b})};u||(u=Hv.create({verbosity:h,port:eo.workerPort}),e._worker=u);const ie={docId:t,apiVersion:"5.4.530",data:i,password:a,disableAutoFetch:X,rangeChunkSize:c,length:de,docBaseUrl:m,enableXfa:V,evaluatorOptions:{maxImageSize:N,disableFontFace:W,ignoreErrors:M,isEvalSupported:D,isOffscreenCanvasSupported:j,isImageDecoderSupported:F,canvasMaxAreaInBytes:z,fontExtraProperties:H,useSystemFonts:me,useWasm:J,useWorkerFetch:Te,cMapUrl:v,iccUrl:E,standardFontDataUrl:x,wasmUrl:b}},Se={ownerDocument:K,pdfBug:Y,styleElement:le,loadingParams:{disableAutoFetch:X,enableXfa:V}};return u.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const re=u.messageHandler.sendWithPromise("GetDocRequest",ie,i?[i.buffer]:null);let pe;if(l)pe=new E$(l,{disableRange:ee,disableStream:G});else if(!i){if(!r)throw new Error("getDocument - no `url` parameter provided.");const ne=gv(r)?P$:yr?B$:M$;pe=new ne({url:r,length:de,httpHeaders:s,withCredentials:o,rangeChunkSize:c,disableRange:ee,disableStream:G})}return re.then(ne=>{if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const ve=new xv(t,ne,u.port),ge=new $$(ve,e,pe,Se,se,$);e._transport=ge,ve.send("Ready",null)})}).catch(e._capability.reject),e}var WA;const VA=class VA{constructor(){q(this,"_capability",Promise.withResolvers());q(this,"_transport",null);q(this,"_worker",null);q(this,"docId",`d${An(VA,WA)._++}`);q(this,"destroyed",!1);q(this,"onPassword",null);q(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,r,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(s){throw(r=this._worker)!=null&&r.port&&delete this._worker._pendingDestroy,s}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};WA=new WeakMap,L(VA,WA,0);let Nb=VA;var mu,Qy,eS,tS,nS;class Uj{constructor(e,t,r=!1,i=null){L(this,mu,Promise.withResolvers());L(this,Qy,[]);L(this,eS,[]);L(this,tS,[]);L(this,nS,[]);this.length=e,this.initialData=t,this.progressiveDone=r,this.contentDispositionFilename=i}addRangeListener(e){f(this,nS).push(e)}addProgressListener(e){f(this,tS).push(e)}addProgressiveReadListener(e){f(this,eS).push(e)}addProgressiveDoneListener(e){f(this,Qy).push(e)}onDataRange(e,t){for(const r of f(this,nS))r(e,t)}onDataProgress(e,t){f(this,mu).promise.then(()=>{for(const r of f(this,tS))r(e,t)})}onDataProgressiveRead(e){f(this,mu).promise.then(()=>{for(const t of f(this,eS))t(e)})}onDataProgressiveDone(){f(this,mu).promise.then(()=>{for(const e of f(this,Qy))e()})}transportReady(){f(this,mu).resolve()}requestDataRange(e,t){Dt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}mu=new WeakMap,Qy=new WeakMap,eS=new WeakMap,tS=new WeakMap,nS=new WeakMap;class W${constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ye(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var $o,gu,Iv;class V${constructor(e,t,r,i=!1){L(this,gu);L(this,$o,!1);this._pageIndex=e,this._pageInfo=t,this._transport=r,this._stats=i?new SD:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new Lj,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:s=!1}={}){return new $S({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ye(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:r,intent:i="display",annotationMode:s=qa.ENABLE,transform:o=null,background:a=null,optionalContentConfigPromise:l=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:m=!1,recordOperations:v=!1,operationsFilter:C=null}){var F,z,W;(F=this._stats)==null||F.time("Overall");const T=this._transport.getRenderingIntent(i,s,h,m),{renderingIntent:E,cacheKey:x}=T;_(this,$o,!1),l||(l=this._transport.getOptionalContentConfig(E));let P=this._intentStates.get(x);P||(P=Object.create(null),this._intentStates.set(x,P)),P.streamReaderCancelTimeout&&(clearTimeout(P.streamReaderCancelTimeout),P.streamReaderCancelTimeout=null);const b=!!(E&hi.PRINT);P.displayReadyCapability||(P.displayReadyCapability=Promise.withResolvers(),P.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(z=this._stats)==null||z.time("Page Request"),this._pumpOperatorList(T));const I=!!(this._pdfBug&&((W=globalThis.StepperManager)!=null&&W.enabled)),M=!this.recordedBBoxes&&(v||I),N=H=>{var V,K;if(P.renderTasks.delete(D),M){const ee=(V=D.gfx)==null?void 0:V.dependencyTracker.take();ee&&(D.stepper&&D.stepper.setOperatorBBoxes(ee,D.gfx.dependencyTracker.takeDebugMetadata()),v&&(this.recordedBBoxes=ee))}b&&_(this,$o,!0),B(this,gu,Iv).call(this),H?(D.capability.reject(H),this._abortOperatorList({intentState:P,reason:H instanceof Error?H:new Error(H)})):D.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(K=globalThis.Stats)!=null&&K.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},D=new Lb({callback:N,params:{canvas:t,canvasContext:e,dependencyTracker:M?new a$(t,P.operatorList.length,I):null,viewport:r,transform:o,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:P.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:u,enableHWA:this._transport.enableHWA,operationsFilter:C});(P.renderTasks||(P.renderTasks=new Set)).add(D);const j=D.task;return Promise.all([P.displayReadyCapability.promise,l]).then(([H,V])=>{var K;if(this.destroyed){N();return}if((K=this._stats)==null||K.time("Rendering"),!(V.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");D.initializeGraphics({transparency:H,optionalContentConfig:V}),D.operatorListChanged()}).catch(N),j}getOperatorList({intent:e="display",annotationMode:t=qa.ENABLE,printAnnotationStorage:r=null,isEditing:i=!1}={}){var c;function s(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const o=this._transport.getRenderingIntent(e,t,r,i,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>Vv.textContent(r));const t=this.streamTextContent(e);return new Promise(function(r,i){function s(){o.read().then(function({value:l,done:c}){if(c){r(a);return}a.lang??(a.lang=l.lang),Object.assign(a.styles,l.styles),a.items.push(...l.items),s()},i)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const r of t.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),_(this,$o,!1),Promise.all(e)}cleanup(e=!1){_(this,$o,!0);const t=B(this,gu,Iv).call(this);return e&&t&&this._stats&&(this._stats=new SD),t}_startRenderPage(e,t){var i,s;const r=this._intentStates.get(t);r&&((i=this._stats)==null||i.timeEnd("Page Request"),(s=r.displayReadyCapability)==null||s.resolve(e))}_renderPageChunk(e,t){for(let r=0,i=e.length;r<i;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const r of t.renderTasks)r.operatorListChanged();e.lastChunk&&B(this,gu,Iv).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:r,modifiedIds:i}){const{map:s,transfer:o}=r,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:i},o).getReader(),c=this._intentStates.get(t);c.streamReader=l;const u=()=>{l.read().then(({value:h,done:m})=>{if(m){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,c),u())},h=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const m of c.renderTasks)m.operatorListChanged();B(this,gu,Iv).call(this)}if(c.displayReadyCapability)c.displayReadyCapability.reject(h);else if(c.opListReadCapability)c.opListReadCapability.reject(h);else throw h}})};u()}_abortOperatorList({intentState:e,reason:t,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(t instanceof eR){let i=z$;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Ul(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}$o=new WeakMap,gu=new WeakSet,Iv=function(){if(!f(this,$o)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),_(this,$o,!1),!0};var vl,os,Ho,vu,$A,yu,Su,Cr,$C,zj,Wj,_v,Vh,HC;const Ht=class Ht{constructor({name:e=null,port:t=null,verbosity:r=TV()}={}){L(this,Cr);L(this,vl,Promise.withResolvers());L(this,os,null);L(this,Ho,null);L(this,vu,null);if(this.name=e,this.destroyed=!1,this.verbosity=r,t){if(f(Ht,Su).has(t))throw new Error("Cannot use more than one PDFWorker per port.");f(Ht,Su).set(t,this),B(this,Cr,zj).call(this,t)}else B(this,Cr,Wj).call(this)}get promise(){return f(this,vl).promise}get port(){return f(this,Ho)}get messageHandler(){return f(this,os)}destroy(){var e,t;this.destroyed=!0,(e=f(this,vu))==null||e.terminate(),_(this,vu,null),f(Ht,Su).delete(f(this,Ho)),_(this,Ho,null),(t=f(this,os))==null||t.destroy(),_(this,os,null)}static create(e){const t=f(this,Su).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ht(e)}static get workerSrc(){if(eo.workerSrc)return eo.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ye(this,"_setupFakeWorkerGlobal",(async()=>f(this,Vh,HC)?f(this,Vh,HC):(await import(this.workerSrc)).WorkerMessageHandler)())}};vl=new WeakMap,os=new WeakMap,Ho=new WeakMap,vu=new WeakMap,$A=new WeakMap,yu=new WeakMap,Su=new WeakMap,Cr=new WeakSet,$C=function(){f(this,vl).resolve(),f(this,os).send("configure",{verbosity:this.verbosity})},zj=function(e){_(this,Ho,e),_(this,os,new xv("main","worker",e)),f(this,os).on("ready",()=>{}),B(this,Cr,$C).call(this)},Wj=function(){if(f(Ht,yu)||f(Ht,Vh,HC)){B(this,Cr,_v).call(this);return}let{workerSrc:e}=Ht;try{Ht._isSameOrigin(window.location,e)||(e=Ht._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),r=new xv("main","worker",t),i=()=>{s.abort(),r.destroy(),t.terminate(),this.destroyed?f(this,vl).reject(new Error("Worker was destroyed")):B(this,Cr,_v).call(this)},s=new AbortController;t.addEventListener("error",()=>{f(this,vu)||i()},{signal:s.signal}),r.on("test",a=>{if(s.abort(),this.destroyed||!a){i();return}_(this,os,r),_(this,Ho,t),_(this,vu,t),B(this,Cr,$C).call(this)}),r.on("ready",a=>{if(s.abort(),this.destroyed){i();return}try{o()}catch{B(this,Cr,_v).call(this)}});const o=()=>{const a=new Uint8Array;r.send("test",a,[a.buffer])};o();return}catch{sT("The worker has been disabled.")}B(this,Cr,_v).call(this)},_v=function(){f(Ht,yu)||(Ze("Setting up fake worker."),_(Ht,yu,!0)),Ht._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){f(this,vl).reject(new Error("Worker was destroyed"));return}const t=new XV;_(this,Ho,t);const r=`fake${An(Ht,$A)._++}`,i=new xv(r+"_worker",r,t);e.setup(i,t),_(this,os,new xv(r,r+"_worker",t)),B(this,Cr,$C).call(this)}).catch(e=>{f(this,vl).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Vh=new WeakSet,HC=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},L(Ht,Vh),L(Ht,$A,0),L(Ht,yu,!1),L(Ht,Su,new WeakMap),yr&&(_(Ht,yu,!0),eo.workerSrc||(eo.workerSrc="./pdf.worker.mjs")),Ht._isSameOrigin=(e,t)=>{const r=URL.parse(e);if(!(r!=null&&r.origin)||r.origin==="null")return!1;const i=new URL(t,r);return r.origin===i.origin},Ht._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Ht.fromPort=e=>{if(LV("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Ht.create(e)};let Hv=Ht;var Zo,$s,$h,Hh,qo,Cu,kv;class $${constructor(e,t,r,i,s,o){L(this,Cu);L(this,Zo,new Map);L(this,$s,new Map);L(this,$h,new Map);L(this,Hh,new Map);L(this,qo,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Lj,this.fontLoader=new HV({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}get annotationStorage(){return Ye(this,"annotationStorage",new nR)}getRenderingIntent(e,t=qa.ENABLE,r=null,i=!1,s=!1){let o=hi.DISPLAY,a=gb;switch(e){case"any":o=hi.ANY;break;case"display":break;case"print":o=hi.PRINT;break;default:Ze(`getRenderingIntent - invalid intent: ${e}`)}const l=o&hi.PRINT&&r instanceof yj?r:this.annotationStorage;switch(t){case qa.DISABLE:o+=hi.ANNOTATIONS_DISABLE;break;case qa.ENABLE:break;case qa.ENABLE_FORMS:o+=hi.ANNOTATIONS_FORMS;break;case qa.ENABLE_STORAGE:o+=hi.ANNOTATIONS_STORAGE,a=l.serializable;break;default:Ze(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(o+=hi.IS_EDITING),s&&(o+=hi.OPLIST);const{ids:c,hash:u}=l.modifiedIds,h=[o,a.hash,u];return{renderingIntent:o,cacheKey:h.join("_"),annotationStorageSerializable:a,modifiedIds:c}}destroy(){var r;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(r=f(this,qo))==null||r.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of f(this,$s).values())e.push(i._destroy());f(this,$s).clear(),f(this,$h).clear(),f(this,Hh).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,s;this.commonObjs.clear(),this.fontLoader.clear(),f(this,Zo).clear(),this.filterFactory.destroy(),$v.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Ul("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(r,i)=>{dt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){i.close();return}dt(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async r=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:o}=this._fullReader;return(!i||!s)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:o}}),e.on("GetRangeReader",(r,i)=>{dt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:o,done:a}){if(a){i.close();return}dt(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{s.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,t._capability.resolve(new W$(r,this))}),e.on("DocException",r=>{t._capability.reject(Ir(r))}),e.on("PasswordRequest",r=>{_(this,qo,Promise.withResolvers());try{if(!t.onPassword)throw Ir(r);const i=s=>{s instanceof Error?f(this,qo).reject(s):f(this,qo).resolve({password:s})};t.onPassword(i,r.code)}catch(i){f(this,qo).reject(i)}return f(this,qo).promise}),e.on("DataLoaded",r=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;f(this,$s).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,i,s])=>{var o;if(this.destroyed||this.commonObjs.has(r))return null;switch(i){case"Font":if("error"in s){const m=s.error;Ze(`Error during font loading: ${m}`),this.commonObjs.resolve(r,m);break}const a=new vb(s),l=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(m,v)=>globalThis.FontInspector.fontAdded(m,v):null,c=new ZV(a,l,s.extra,s.charProcOperatorList);this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!c.fontExtraProperties&&c.data&&c.clearData(),this.commonObjs.resolve(r,c)});break;case"CopyLocalImage":const{imageRef:u}=s;dt(u,"The imageRef must be defined.");for(const m of f(this,$s).values())for(const[,v]of m.objs)if((v==null?void 0:v.ref)===u)return v.dataLen?(this.commonObjs.resolve(r,structuredClone(v)),v.dataLen):null;break;case"FontPath":this.commonObjs.resolve(r,new qV(s));break;case"Image":this.commonObjs.resolve(r,s);break;case"Pattern":const h=new yb(s);this.commonObjs.resolve(r,h.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([r,i,s,o])=>{var l;if(this.destroyed)return;const a=f(this,$s).get(i);if(!a.objs.has(r)){if(a._intentStates.size===0){(l=o==null?void 0:o.bitmap)==null||l.close();return}switch(s){case"Image":case"Pattern":a.objs.resolve(r,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",r=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:r.loaded,total:r.total})}),e.on("FetchBinaryData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[r.type];if(!i)throw new Error(`${r.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r;this.annotationStorage.size<=0&&Ze("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((r=this._fullReader)==null?void 0:r.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,r=f(this,$h).get(t);if(r)return r;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&f(this,Hh).set(s.refStr,e);const o=new V$(t,s,this,this._params.pdfBug);return f(this,$s).set(t,o),o});return f(this,$h).set(t,i),i}getPageIndex(e){return Sb(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return B(this,Cu,kv).call(this,"GetFieldObjects")}hasJSActions(){return B(this,Cu,kv).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return B(this,Cu,kv).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return B(this,Cu,kv).call(this,"GetOptionalContentConfig").then(t=>new T$(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=f(this,Zo).get(e);if(t)return t;const r=this.messageHandler.sendWithPromise(e,null).then(i=>{var s,o;return{info:i[0],metadata:i[1]?new C$(i[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null,hasStructTree:i[2]}});return f(this,Zo).set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of f(this,$s).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),f(this,Zo).clear(),this.filterFactory.destroy(!0),$v.cleanup()}}cachedPageNumber(e){if(!Sb(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return f(this,Hh).get(t)??null}}Zo=new WeakMap,$s=new WeakMap,$h=new WeakMap,Hh=new WeakMap,qo=new WeakMap,Cu=new WeakSet,kv=function(e,t=null){const r=f(this,Zo).get(e);if(r)return r;const i=this.messageHandler.sendWithPromise(e,t);return f(this,Zo).set(e,i),i};var yl;class H${constructor(e){L(this,yl,null);q(this,"onContinue",null);q(this,"onError",null);_(this,yl,e)}get promise(){return f(this,yl).capability.promise}cancel(e=0){f(this,yl).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=f(this,yl).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=f(this,yl);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}yl=new WeakMap;var Sl,Au;const Mc=class Mc{constructor({callback:e,params:t,objs:r,commonObjs:i,annotationCanvasMap:s,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:h=!1,pageColors:m=null,enableHWA:v=!1,operationsFilter:C=null}){L(this,Sl,null);this.callback=e,this.params=t,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=h,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new H$(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=v,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=C}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var l,c;if(this.cancelled)return;if(this._canvas){if(f(Mc,Au).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");f(Mc,Au).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:r,transform:i,background:s,dependencyTracker:o}=this.params,a=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Gd(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:i,viewport:r,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var r,i,s;this.running=!1,this.cancelled=!0,(r=this.gfx)==null||r.endDrawing(),f(this,Sl)&&(window.cancelAnimationFrame(f(this,Sl)),_(this,Sl,null)),f(Mc,Au).delete(this._canvas),e||(e=new eR(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(s=(i=this.task).onError)==null||s.call(i,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?_(this,Sl,window.requestAnimationFrame(()=>{_(this,Sl,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),f(Mc,Au).delete(this._canvas),this.callback())))}};Sl=new WeakMap,Au=new WeakMap,L(Mc,Au,new WeakSet);let Lb=Mc;const Z$="5.4.530",q$="50cc4adac";var Qr,Tu,Zh,wn,rS,qh,Go,iS,Cl,as,sS,kt,Db,Ob,Bb,bc,Vj,Za;const _r=class _r{constructor({editor:e=null,uiManager:t=null}){L(this,kt);L(this,Qr,null);L(this,Tu,null);L(this,Zh);L(this,wn,null);L(this,rS,!1);L(this,qh,!1);L(this,Go,null);L(this,iS);L(this,Cl,null);L(this,as,null);var r,i;e?(_(this,qh,!1),_(this,Go,e)):_(this,qh,!0),_(this,as,(e==null?void 0:e._uiManager)||t),_(this,iS,f(this,as)._eventBus),_(this,Zh,((r=e==null?void 0:e.color)==null?void 0:r.toUpperCase())||((i=f(this,as))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),f(_r,sS)||_(_r,sS,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Ye(this,"_keyboardManager",new ZS([[["Escape","mac+Escape"],_r.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],_r.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],_r.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],_r.prototype._moveToPrevious],[["Home","mac+Home"],_r.prototype._moveToBeginning],[["End","mac+End"],_r.prototype._moveToEnd]]))}renderButton(){const e=_(this,Qr,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",f(this,Go)&&(e.ariaControls=`${f(this,Go).id}_colorpicker_dropdown`);const t=f(this,as)._signal;e.addEventListener("click",B(this,kt,bc).bind(this),{signal:t}),e.addEventListener("keydown",B(this,kt,Bb).bind(this),{signal:t});const r=_(this,Tu,document.createElement("span"));return r.className="swatch",r.ariaHidden="true",r.style.backgroundColor=f(this,Zh),e.append(r),e}renderMainDropdown(){const e=_(this,wn,B(this,kt,Db).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===f(this,Qr)){B(this,kt,bc).call(this,e);return}const t=e.target.getAttribute("data-color");t&&B(this,kt,Ob).call(this,t,e)}_moveToNext(e){var t,r;if(!f(this,kt,Za)){B(this,kt,bc).call(this,e);return}if(e.target===f(this,Qr)){(t=f(this,wn).firstElementChild)==null||t.focus();return}(r=e.target.nextSibling)==null||r.focus()}_moveToPrevious(e){var t,r;if(e.target===((t=f(this,wn))==null?void 0:t.firstElementChild)||e.target===f(this,Qr)){f(this,kt,Za)&&this._hideDropdownFromKeyboard();return}f(this,kt,Za)||B(this,kt,bc).call(this,e),(r=e.target.previousSibling)==null||r.focus()}_moveToBeginning(e){var t;if(!f(this,kt,Za)){B(this,kt,bc).call(this,e);return}(t=f(this,wn).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!f(this,kt,Za)){B(this,kt,bc).call(this,e);return}(t=f(this,wn).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=f(this,wn))==null||e.classList.add("hidden"),f(this,Qr).ariaExpanded="false",(t=f(this,Cl))==null||t.abort(),_(this,Cl,null)}_hideDropdownFromKeyboard(){var e;if(!f(this,qh)){if(!f(this,kt,Za)){(e=f(this,Go))==null||e.unselect();return}this.hideDropdown(),f(this,Qr).focus({preventScroll:!0,focusVisible:f(this,rS)})}}updateColor(e){if(f(this,Tu)&&(f(this,Tu).style.backgroundColor=e),!f(this,wn))return;const t=f(this,as).highlightColors.values();for(const r of f(this,wn).children)r.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=f(this,Qr))==null||e.remove(),_(this,Qr,null),_(this,Tu,null),(t=f(this,wn))==null||t.remove(),_(this,wn,null)}};Qr=new WeakMap,Tu=new WeakMap,Zh=new WeakMap,wn=new WeakMap,rS=new WeakMap,qh=new WeakMap,Go=new WeakMap,iS=new WeakMap,Cl=new WeakMap,as=new WeakMap,sS=new WeakMap,kt=new WeakSet,Db=function(){const e=document.createElement("div"),t=f(this,as)._signal;e.addEventListener("contextmenu",zi,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),f(this,Go)&&(e.id=`${f(this,Go).id}_colorpicker_dropdown`);for(const[r,i]of f(this,as).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=r,s.setAttribute("data-l10n-id",f(_r,sS)[r]);const o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=i,s.ariaSelected=i===f(this,Zh),s.addEventListener("click",B(this,kt,Ob).bind(this,i),{signal:t}),e.append(s)}return e.addEventListener("keydown",B(this,kt,Bb).bind(this),{signal:t}),e},Ob=function(e,t){t.stopPropagation(),f(this,iS).dispatch("switchannotationeditorparams",{source:this,type:ut.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},Bb=function(e){_r._keyboardManager.exec(this,e)},bc=function(e){if(f(this,kt,Za)){this.hideDropdown();return}if(_(this,rS,e.detail===0),f(this,Cl)||(_(this,Cl,new AbortController),window.addEventListener("pointerdown",B(this,kt,Vj).bind(this),{signal:f(this,as).combinedSignal(f(this,Cl))})),f(this,Qr).ariaExpanded="true",f(this,wn)){f(this,wn).classList.remove("hidden");return}const t=_(this,wn,B(this,kt,Db).call(this));f(this,Qr).append(t)},Vj=function(e){var t;(t=f(this,wn))!=null&&t.contains(e.target)||this.hideDropdown()},Za=function(){return f(this,wn)&&!f(this,wn).classList.contains("hidden")},L(_r,sS,null);let AA=_r;var Hs,oS,Gh,aS;const Nc=class Nc{constructor(e){L(this,Hs,null);L(this,oS,null);L(this,Gh,null);_(this,oS,e),_(this,Gh,e._uiManager),f(Nc,aS)||_(Nc,aS,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(f(this,Hs))return f(this,Hs);const{editorType:e,colorType:t,color:r}=f(this,oS),i=_(this,Hs,document.createElement("input"));return i.type="color",i.value=r||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",f(Nc,aS)[e]),i.addEventListener("input",()=>{f(this,Gh).updateParams(t,i.value)},{signal:f(this,Gh)._signal}),i}update(e){f(this,Hs)&&(f(this,Hs).value=e)}destroy(){var e;(e=f(this,Hs))==null||e.remove(),_(this,Hs,null)}hideDropdown(){}};Hs=new WeakMap,oS=new WeakMap,Gh=new WeakMap,aS=new WeakMap,L(Nc,aS,null);let TA=Nc;et(116);et(531);function zD(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function cv(n){return Math.max(0,Math.min(255,255*n))}class WD{static CMYK_G([e,t,r,i]){return["G",1-Math.min(1,.3*e+.59*r+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=cv(e),[e,e,e]}static G_HTML([e]){const t=zD(e);return`#${t}${t}${t}`}static RGB_G([e,t,r]){return["G",.3*e+.59*t+.11*r]}static RGB_rgb(e){return e.map(cv)}static RGB_HTML(e){return`#${e.map(zD).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,r,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,r+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,r,i]){return[cv(1-Math.min(1,e+i)),cv(1-Math.min(1,r+i)),cv(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,r]){const i=1-e,s=1-t,o=1-r,a=Math.min(i,s,o);return["CMYK",i,s,o,a]}}class G${create(e,t,r=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),r||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Dt("Abstract method `_createSVG` called.")}}class EA extends G${_createSVG(e){return document.createElementNS(Co,e)}}const K$=9,Ju=new WeakSet,Y$=new Date().getTimezoneOffset()*60*1e3;class Mw{static create(e){switch(e.data.annotationType){case gn.LINK:return new sR(e);case gn.TEXT:return new X$(e);case gn.WIDGET:switch(e.data.fieldType){case"Tx":return new Q$(e);case"Btn":return e.data.radioButton?new Zj(e):e.data.checkBox?new tH(e):new nH(e);case"Ch":return new rH(e);case"Sig":return new eH(e)}return new td(e);case gn.POPUP:return new jb(e);case gn.FREETEXT:return new Jj(e);case gn.LINE:return new sH(e);case gn.SQUARE:return new oH(e);case gn.CIRCLE:return new aH(e);case gn.POLYLINE:return new Xj(e);case gn.CARET:return new cH(e);case gn.INK:return new oR(e);case gn.POLYGON:return new lH(e);case gn.HIGHLIGHT:return new Qj(e);case gn.UNDERLINE:return new uH(e);case gn.SQUIGGLY:return new dH(e);case gn.STRIKEOUT:return new hH(e);case gn.STAMP:return new e4(e);case gn.FILEATTACHMENT:return new pH(e);default:return new en(e)}}}var Eu,Kh,Di,lS,Fb;const bR=class bR{constructor(e,{isRenderable:t=!1,ignoreBorder:r=!1,createQuadrilaterals:i=!1}={}){L(this,lS);L(this,Eu,null);L(this,Kh,!1);L(this,Di,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(r)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return bR._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var r;const{data:e}=this,t=(r=this.annotationStorage)==null?void 0:r.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var a;const e=(a=this.annotationStorage)==null?void 0:a.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:r,rect:i}=this.data;let s=-1/0,o=-1/0;if((t==null?void 0:t.length)>=8){for(let l=0;l<t.length;l+=8)t[l+1]>o?(o=t[l+1],s=t[l+2]):t[l+1]===o&&(s=Math.max(s,t[l+2]));return[s,o]}if((r==null?void 0:r.length)>=1){for(const l of r)for(let c=0,u=l.length;c<u;c+=2)l[c+1]>o?(o=l[c+1],s=l[c]):l[c+1]===o&&(s=Math.max(s,l[c]));if(s!==1/0)return[s,o]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-s)/r,e[1]=100*(e[1]-o)/i,e}get commentText(){var t,r,i;const{data:e}=this;return((r=(t=this.annotationStorage.getRawValue(`${zv}${e.id}`))==null?void 0:t.popup)==null?void 0:r.contents)||((i=e.contentsObj)==null?void 0:i.str)||""}set commentText(e){const{data:t}=this,r={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:r})||this.annotationStorage.setValue(`${zv}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:r,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=f(this,Di))==null?void 0:e.popup)||this.popup)==null||t.remove(),_(this,Di,this.popup=null)}updateEdited(e){var s;if(!this.container)return;e.rect&&(f(this,Eu)||_(this,Eu,{rect:this.data.rect.slice(0)}));const{rect:t,popup:r}=e;t&&B(this,lS,Fb).call(this,t);let i=((s=f(this,Di))==null?void 0:s.popup)||this.popup;!i&&(r!=null&&r.text)&&(this._createPopup(r),i=f(this,Di).popup),i&&(i.updateEdited(e),r!=null&&r.deleted&&(i.remove(),_(this,Di,null),this.popup=null))}resetEdited(){var e;f(this,Eu)&&(B(this,lS,Fb).call(this,f(this,Eu).rect),(e=f(this,Di))==null||e.popup.resetEdited(),_(this,Eu,null))}_createContainer(e){const{data:t,parent:{page:r,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),!(this instanceof td)&&!(this instanceof sR)&&(s.tabIndex=0);const{style:o}=s;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof jb){const{rotation:T}=t;return!t.hasOwnCanvas&&T!==0&&this.setRotation(T,s),s}const{width:a,height:l}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const T=t.borderStyle.horizontalCornerRadius,E=t.borderStyle.verticalCornerRadius;if(T>0||E>0){const P=`calc(${T}px * var(--total-scale-factor)) / calc(${E}px * var(--total-scale-factor))`;o.borderRadius=P}else if(this instanceof Zj){const P=`calc(${a}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;o.borderRadius=P}switch(t.borderStyle.style){case _d.SOLID:o.borderStyle="solid";break;case _d.DASHED:o.borderStyle="dashed";break;case _d.BEVELED:Ze("Unimplemented border style: beveled");break;case _d.INSET:Ze("Unimplemented border style: inset");break;case _d.UNDERLINE:o.borderBottomStyle="solid";break}const x=t.borderColor||null;x?(_(this,Kh,!0),o.borderColor=ke.makeHexColor(x[0]|0,x[1]|0,x[2]|0)):o.borderWidth=0}const c=ke.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]),{pageWidth:u,pageHeight:h,pageX:m,pageY:v}=i.rawDims;o.left=`${100*(c[0]-m)/u}%`,o.top=`${100*(c[1]-v)/h}%`;const{rotation:C}=t;return t.hasOwnCanvas||C===0?(o.width=`${100*a/u}%`,o.height=`${100*l/h}%`):this.setRotation(C,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:o}=this;e%180!==0&&([s,o]=[o,s]),t.style.width=`${100*s/r}%`,t.style.height=`${100*o/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,r,i)=>{const s=i.detail[t],o=s[0],a=s.slice(1);i.target.style[r]=WD[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[r]:WD[`${o}_rgb`](a)})};return Ye(this,"_commonActions",{display:t=>{const{display:r}=t.detail,i=r%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:r===1||r===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:r}=t.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const r=t.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,t){const r=this._commonActions;for(const i of Object.keys(t.detail)){const s=e[i]||r[i];s==null||s(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const r=this._commonActions;for(const[i,s]of Object.entries(t)){const o=r[i];if(o){const a={detail:{[i]:s},target:e};o(a),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,r,i,s]=this.data.rect.map(T=>Math.fround(T));if(e.length===8){const[T,E,x,P]=e.subarray(2,6);if(i===T&&s===E&&t===x&&r===P)return}const{style:o}=this.container;let a;if(f(this,Kh)){const{borderColor:T,borderWidth:E}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${T}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const l=i-t,c=s-r,{svgFactory:u}=this,h=u.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0),h.role="none";const m=u.createElement("defs");h.append(m);const v=u.createElement("clipPath"),C=`clippath_${this.data.id}`;v.setAttribute("id",C),v.setAttribute("clipPathUnits","objectBoundingBox"),m.append(v);for(let T=2,E=e.length;T<E;T+=8){const x=e[T],P=e[T+1],b=e[T+2],I=e[T+3],M=u.createElement("rect"),N=(b-t)/l,D=(s-P)/c,j=(x-b)/l,F=(P-I)/c;M.setAttribute("x",N),M.setAttribute("y",D),M.setAttribute("width",j),M.setAttribute("height",F),v.append(M),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${D}" width="${j}" height="${F}"/>`)}f(this,Kh)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(h),this.container.style.clipPath=`url(#${C})`}_createPopup(e=null){const{data:t}=this;let r,i;e?(r={str:e.text},i=e.date):(r=t.contentsObj,i=t.modificationDate),_(this,Di,new jb({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:r,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(f(this,Di)||this.popup||this.data.popupRef)}get extraPopupElement(){return f(this,Di)}render(){Dt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const r=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:s,id:o,exportValues:a}of i){if(s===-1||o===t)continue;const l=typeof a=="string"?a:null,c=document.querySelector(`[data-element-id="${o}"]`);if(c&&!Ju.has(c)){Ze(`_getElementsByName - element not allowed: ${o}`);continue}r.push({id:o,exportValue:l,domElement:c})}return r}for(const i of document.getElementsByName(e)){const{exportValue:s}=i,o=i.getAttribute("data-element-id");o!==t&&Ju.has(i)&&r.push({id:o,exportValue:s,domElement:i})}return r}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var r;(r=this.linkService.eventBus)==null||r.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Eu=new WeakMap,Kh=new WeakMap,Di=new WeakMap,lS=new WeakSet,Fb=function(e){const{container:{style:t},data:{rect:r,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:a,pageY:l}}}}=this;r==null||r.splice(0,4,...e),t.left=`${100*(e[0]-a)/s}%`,t.top=`${100*(o-e[3]+l)/o}%`,i===0?(t.width=`${100*(e[2]-e[0])/s}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(i)};let en=bR;class J$ extends en{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var fi,Pc,$j,Hj;class sR extends en{constructor(t,r=null){super(t,{isRenderable:!0,ignoreBorder:!!(r!=null&&r.ignoreBorder),createQuadrilaterals:!0});L(this,fi);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:r}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(r.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),s=!0):t.attachment?(B(this,fi,$j).call(this,i,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(B(this,fi,Hj).call(this,i,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=i,this.container.append(i)),this.container}_bindLink(t,r,i=""){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&B(this,fi,Pc).call(this),i&&(t.title=i)}_bindNamedAction(t,r,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),i&&(t.title=i),B(this,fi,Pc).call(this)}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(r.actions)){const o=i.get(s);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:s}}),!1})}r.overlaidText&&(t.title=r.overlaidText),t.onclick||(t.onclick=()=>!1),B(this,fi,Pc).call(this)}_bindResetFormAction(t,r){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),B(this,fi,Pc).call(this),!this._fieldObjects){Ze('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var h;i==null||i();const{fields:s,refs:o,include:a}=r,l=[];if(s.length!==0||o.length!==0){const m=new Set(o);for(const v of s){const C=this._fieldObjects[v]||[];for(const{id:T}of C)m.add(T)}for(const v of Object.values(this._fieldObjects))for(const C of v)m.has(C.id)===a&&l.push(C)}else for(const m of Object.values(this._fieldObjects))l.push(...m);const c=this.annotationStorage,u=[];for(const m of l){const{id:v}=m;switch(u.push(v),m.type){case"text":{const T=m.defaultValue||"";c.setValue(v,{value:T});break}case"checkbox":case"radiobutton":{const T=m.defaultValue===m.exportValues;c.setValue(v,{value:T});break}case"combobox":case"listbox":{const T=m.defaultValue||"";c.setValue(v,{value:T});break}default:continue}const C=document.querySelector(`[data-element-id="${v}"]`);if(C){if(!Ju.has(C)){Ze(`_bindResetFormAction - element not allowed: ${v}`);continue}}else continue;C.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}})),!1}}}fi=new WeakSet,Pc=function(){this.container.setAttribute("data-internal-link","")},$j=function(t,r,i="",s=null){t.href=this.linkService.getAnchorUrl(""),r.description?t.title=r.description:i&&(t.title=i),t.onclick=()=>{var o;return(o=this.downloadManager)==null||o.openOrDownloadData(r.content,r.filename,s),!1},B(this,fi,Pc).call(this)},Hj=function(t,r,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(r),!1),i&&(t.title=i),B(this,fi,Pc).call(this)};class X$ extends en{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class td extends en{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Pn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,r,i,s){r.includes("mouse")?e.addEventListener(r,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(r,o=>{var a;if(r==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(r==="focus"){if(t.focused)return;t.focused=!0}s&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o)}}))})}_setEventListeners(e,t,r,i){var s,o,a;for(const[l,c]of r)(c==="Action"||(s=this.data.actions)!=null&&s[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,c,i),c==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":ke.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||K$,s=e.style;let o;const a=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a),u=Math.round(c/(xw*i))||1,h=c/u;o=Math.min(i,l(h/xw))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(i,l(c/xw))}s.fontSize=`calc(${o}px * var(--total-scale-factor))`,s.color=ke.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class Q$ extends td{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,r,i){const s=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=r),s.setValue(o.id,{[i]:r})}render(){var i,s;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let c=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const u={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=c??a,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type=this.data.password?"password":"text",r.setAttribute("value",c??a),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),Ju.add(r),this.contentElement=r,r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=0;const{datetimeFormat:h,datetimeType:m,timeStep:v}=this.data,C=!!m&&this.enableScripting;h&&(r.title=h),this._setRequired(r,this.data.required),l&&(r.maxLength=l),r.addEventListener("input",E=>{e.setValue(t,{value:E.target.value}),this.setPropertyOnSiblings(r,"value",E.target.value,"value"),u.formattedValue=null}),r.addEventListener("resetform",E=>{const x=this.data.defaultFieldValue??"";r.value=u.userValue=x,u.formattedValue=null});let T=E=>{const{formattedValue:x}=u;x!=null&&(E.target.value=x),E.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",x=>{var b;if(u.focused)return;const{target:P}=x;if(C&&(P.type=m,v&&(P.step=v)),u.userValue){const I=u.userValue;if(C)if(m==="time"){const M=new Date(I),N=[M.getHours(),M.getMinutes(),M.getSeconds()];P.value=N.map(D=>D.toString().padStart(2,"0")).join(":")}else P.value=new Date(I-Y$).toISOString().split(m==="date"?"T":".",1)[0];else P.value=I}u.lastCommittedValue=P.value,u.commitKey=1,(b=this.data.actions)!=null&&b.Focus||(u.focused=!0)}),r.addEventListener("updatefromsandbox",x=>{this.showElementAndHideCanvas(x.target);const P={value(b){u.userValue=b.detail.value??"",C||e.setValue(t,{value:u.userValue.toString()}),b.target.value=u.userValue},formattedValue(b){const{formattedValue:I}=b.detail;u.formattedValue=I,I!=null&&b.target!==document.activeElement&&(b.target.value=I);const M={formattedValue:I};C&&(M.value=I),e.setValue(t,M)},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{var D;const{charLimit:I}=b.detail,{target:M}=b;if(I===0){M.removeAttribute("maxLength");return}M.setAttribute("maxLength",I);let N=u.userValue;!N||N.length<=I||(N=N.slice(0,I),M.value=u.userValue=N,e.setValue(t,{value:N}),(D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:N,willCommit:!0,commitKey:1,selStart:M.selectionStart,selEnd:M.selectionEnd}}))}};this._dispatchEventFromSandbox(P,x)}),r.addEventListener("keydown",x=>{var I;u.commitKey=1;let P=-1;if(x.key==="Escape"?P=0:x.key==="Enter"&&!this.data.multiLine?P=2:x.key==="Tab"&&(u.commitKey=3),P===-1)return;const{value:b}=x.target;u.lastCommittedValue!==b&&(u.lastCommittedValue=b,u.userValue=b,(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:P,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}))});const E=T;T=null,r.addEventListener("blur",x=>{var I,M;if(!u.focused||!x.relatedTarget)return;(I=this.data.actions)!=null&&I.Blur||(u.focused=!1);const{target:P}=x;let{value:b}=P;if(C){if(b&&m==="time"){const N=b.split(":").map(D=>parseInt(D,10));b=new Date(2e3,0,1,N[0],N[1],N[2]||0).valueOf(),P.step=""}else b.includes("T")||(b=`${b}T00:00`),b=new Date(b).valueOf();P.type="text"}u.userValue=b,u.lastCommittedValue!==b&&((M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:u.commitKey,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}})),E(x)}),(s=this.data.actions)!=null&&s.Keystroke&&r.addEventListener("beforeinput",x=>{var F;u.lastCommittedValue=null;const{data:P,target:b}=x,{value:I,selectionStart:M,selectionEnd:N}=b;let D=M,j=N;switch(x.inputType){case"deleteWordBackward":{const z=I.substring(0,M).match(/\w*[^\w]*$/);z&&(D-=z[0].length);break}case"deleteWordForward":{const z=I.substring(M).match(/^[^\w]*\w*/);z&&(j+=z[0].length);break}case"deleteContentBackward":M===N&&(D-=1);break;case"deleteContentForward":M===N&&(j+=1);break}x.preventDefault(),(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:I,change:P||"",willCommit:!1,selStart:D,selEnd:j}})}),this._setEventListeners(r,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],x=>x.target.value)}if(T&&r.addEventListener("blur",T),this.data.comb){const x=(this.data.rect[2]-this.data.rect[0])/l;r.classList.add("comb"),r.style.letterSpacing=`calc(${x}px * var(--total-scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class eH extends td{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class tH extends td{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(r,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Ju.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=0,s.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const c of this._getElementsByName(a,r)){const u=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=u),e.setValue(c.id,{value:u})}e.setValue(r,{value:l})}),s.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{const a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(r,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Zj extends td{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(r,{value:i})),i)for(const o of this._getElementsByName(t.fieldName,r))e.setValue(o.id,{value:!1});const s=document.createElement("input");if(Ju.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const c of this._getElementsByName(a,r))e.setValue(c.id,{value:!1});e.setValue(r,{value:l})}),s.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;s.addEventListener("updatefromsandbox",a=>{const l={value:c=>{const u=o===c.detail.value;for(const h of this._getElementsByName(c.target.name)){const m=u&&h.id===r;h.domElement&&(h.domElement.checked=m),e.setValue(h.id,{value:m})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class nH extends sR{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}}class rH extends td{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,r=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Ju.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",u=>{const h=this.data.defaultFieldValue;for(const m of i.options)m.selected=m.value===h});for(const u of this.data.options){const h=document.createElement("option");h.textContent=u.displayValue,h.value=u.exportValue,r.value.includes(u.exportValue)&&(h.setAttribute("selected",!0),s=!1),i.append(h)}let o=null;if(s){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),i.prepend(u),o=()=>{u.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const a=u=>{const h=u?"value":"textContent",{options:m,multiple:v}=i;return v?Array.prototype.filter.call(m,C=>C.selected).map(C=>C[h]):m.selectedIndex===-1?null:m[m.selectedIndex][h]};let l=a(!1);const c=u=>{const h=u.target.options;return Array.prototype.map.call(h,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",u=>{const h={value(m){o==null||o();const v=m.detail.value,C=new Set(Array.isArray(v)?v:[v]);for(const T of i.options)T.selected=C.has(T.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(m){i.multiple=!0},remove(m){const v=i.options,C=m.detail.remove;v[C].selected=!1,i.remove(C),v.length>0&&Array.prototype.findIndex.call(v,E=>E.selected)===-1&&(v[0].selected=!0),e.setValue(t,{value:a(!0),items:c(m)}),l=a(!1)},clear(m){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(m){const{index:v,displayValue:C,exportValue:T}=m.detail.insert,E=i.children[v],x=document.createElement("option");x.textContent=C,x.value=T,E?E.before(x):i.append(x),e.setValue(t,{value:a(!0),items:c(m)}),l=a(!1)},items(m){const{items:v}=m.detail;for(;i.length!==0;)i.remove(0);for(const C of v){const{displayValue:T,exportValue:E}=C,x=document.createElement("option");x.textContent=T,x.value=E,i.append(x)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:a(!0),items:c(m)}),l=a(!1)},indices(m){const v=new Set(m.detail.indices);for(const C of m.target.options)C.selected=v.has(C.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(h,u)}),i.addEventListener("input",u=>{var v;const h=a(!0),m=a(!1);e.setValue(t,{value:h}),u.preventDefault(),(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:m,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):i.addEventListener("input",function(u){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var cS,Ub;class jb extends en{constructor(t){const{data:r,elements:i,parent:s}=t,o=!!s._commentManager;super(t,{isRenderable:!o&&en._hasPopupData(r)});L(this,cS);if(this.elements=i,o&&en._hasPopupData(r)){const a=this.popup=B(this,cS,Ub).call(this);for(const l of i)l.popup=a}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const r=this.popup=B(this,cS,Ub).call(this),i=[];for(const s of this.elements)s.popup=r,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${Ud}${s}`).join(",")),this.container}}cS=new WeakSet,Ub=function(){return new iH({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var ei,Al,HA,ZA,Yh,Jh,sn,Zs,Tl,xu,Xh,Qh,qs,ti,Ko,Yo,on,Jo,El,uS,Xo,ep,wu,xl,Mn,wl,nt,ZC,zb,Wb,Vb,qC,$b,qj,Gj,Kj,Yj,GC,KC,Hb;class iH{constructor({container:e,color:t,elements:r,titleObj:i,modificationDate:s,contentsObj:o,richText:a,parent:l,rect:c,parentRect:u,open:h,commentManager:m=null}){L(this,nt);L(this,ei,null);L(this,Al,B(this,nt,Kj).bind(this));L(this,HA,B(this,nt,Hb).bind(this));L(this,ZA,B(this,nt,KC).bind(this));L(this,Yh,B(this,nt,GC).bind(this));L(this,Jh,null);L(this,sn,null);L(this,Zs,null);L(this,Tl,null);L(this,xu,null);L(this,Xh,null);L(this,Qh,null);L(this,qs,!1);L(this,ti,null);L(this,Ko,null);L(this,Yo,null);L(this,on,null);L(this,Jo,null);L(this,El,null);L(this,uS,null);L(this,Xo,null);L(this,ep,null);L(this,wu,null);L(this,xl,!1);L(this,Mn,null);L(this,wl,null);_(this,sn,e),_(this,ep,i),_(this,Zs,o),_(this,Xo,a),_(this,Xh,l),_(this,Jh,t),_(this,uS,c),_(this,Qh,u),_(this,xu,r),_(this,ei,m),_(this,Mn,r[0]),_(this,Tl,mA.toDateObject(s)),this.trigger=r.flatMap(v=>v.getElementsToTriggerPopup()),m||(B(this,nt,ZC).call(this),f(this,sn).hidden=!0,h&&B(this,nt,GC).call(this))}renderCommentButton(){if(f(this,on)){f(this,on).parentNode||f(this,Mn).container.after(f(this,on));return}if(f(this,Jo)||B(this,nt,zb).call(this),!f(this,Jo))return;const{signal:e}=_(this,Ko,new AbortController),t=f(this,Mn).hasOwnCommentButton,r=()=>{f(this,ei).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{f(this,ei).toggleCommentPopup(this,!1,!0,!t)},s=()=>{f(this,ei).toggleCommentPopup(this,!1,!1)};if(t){_(this,on,f(this,Mn).container);for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",f(this,Al),{signal:e}),o.addEventListener("click",r,{signal:e}),o.addEventListener("pointerenter",i,{signal:e}),o.addEventListener("pointerleave",s,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=_(this,on,document.createElement("button"));o.className="annotationCommentButton";const a=f(this,Mn).container;o.style.zIndex=a.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),B(this,nt,Vb).call(this),B(this,nt,Wb).call(this),o.addEventListener("keydown",f(this,Al),{signal:e}),o.addEventListener("click",r,{signal:e}),o.addEventListener("pointerenter",i,{signal:e}),o.addEventListener("pointerleave",s,{signal:e}),a.after(o)}}get commentButtonColor(){const{color:e,opacity:t}=f(this,Mn).commentData;return e?f(this,Xh)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=f(this,on))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:r,creationDate:i,modificationDate:s}=f(this,Mn).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:r,creationDate:i,modificationDate:s}}get elementBeforePopup(){return f(this,on)}get comment(){return f(this,wl)||_(this,wl,f(this,Mn).commentText),f(this,wl)}set comment(e){e!==this.comment&&(f(this,Mn).commentText=_(this,wl,e))}focus(){var e;(e=f(this,Mn).container)==null||e.focus()}get parentBoundingClientRect(){return f(this,Mn).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){f(this,on)&&(f(this,on).classList.toggle("selected",e),f(this,on).ariaExpanded=t)}setSelectedCommentButton(e){f(this,on).classList.toggle("selected",e)}get commentPopupPosition(){if(f(this,El))return f(this,El);const{x:e,y:t,height:r}=f(this,on).getBoundingClientRect(),{x:i,y:s,width:o,height:a}=f(this,Mn).layer.getBoundingClientRect();return[(e-i)/o,(t+r-s)/a]}set commentPopupPosition(e){_(this,El,e)}hasDefaultPopupPosition(){return f(this,El)===null}get commentButtonPosition(){return f(this,Jo)}get commentButtonWidth(){return f(this,on).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,r]=f(this,El)||this.commentButtonPosition.map(c=>c/100),i=this.parentBoundingClientRect,{x:s,y:o,width:a,height:l}=i;f(this,ei).showDialog(null,this,s+t*a,o+r*l,{...e,parentDimensions:i})}render(){var r,i;if(f(this,ti))return;const e=_(this,ti,document.createElement("div"));if(e.className="popup",f(this,Jh)){const s=e.style.outlineColor=ke.makeHexColor(...f(this,Jh));e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const t=document.createElement("span");if(t.className="header",(r=f(this,ep))!=null&&r.str){const s=document.createElement("span");s.className="title",t.append(s),{dir:s.dir,str:s.textContent}=f(this,ep)}if(e.append(t),f(this,Tl)){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:f(this,Tl).valueOf()})),s.dateTime=f(this,Tl).toISOString(),t.append(s)}BF({html:f(this,nt,qC)||f(this,Zs).str,dir:(i=f(this,Zs))==null?void 0:i.dir,className:"popupContent"},e),f(this,sn).append(e)}updateEdited({rect:e,popup:t,deleted:r}){var i;if(f(this,ei)){r?(this.remove(),_(this,wl,null)):t&&(t.deleted?this.remove():(B(this,nt,Vb).call(this),_(this,wl,t.text))),e&&(_(this,Jo,null),B(this,nt,zb).call(this),B(this,nt,Wb).call(this));return}if(r||t!=null&&t.deleted){this.remove();return}B(this,nt,ZC).call(this),f(this,wu)||_(this,wu,{contentsObj:f(this,Zs),richText:f(this,Xo)}),e&&_(this,Yo,null),t&&t.text&&(_(this,Xo,B(this,nt,Gj).call(this,t.text)),_(this,Tl,mA.toDateObject(t.date)),_(this,Zs,null)),(i=f(this,ti))==null||i.remove(),_(this,ti,null)}resetEdited(){var e;f(this,wu)&&({contentsObj:An(this,Zs)._,richText:An(this,Xo)._}=f(this,wu),_(this,wu,null),(e=f(this,ti))==null||e.remove(),_(this,ti,null),_(this,Yo,null))}remove(){var e,t,r;if((e=f(this,Ko))==null||e.abort(),_(this,Ko,null),(t=f(this,ti))==null||t.remove(),_(this,ti,null),_(this,xl,!1),_(this,qs,!1),(r=f(this,on))==null||r.remove(),_(this,on,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){_(this,xl,this.isVisible),f(this,xl)&&(f(this,sn).hidden=!0)}maybeShow(){f(this,ei)||(B(this,nt,ZC).call(this),f(this,xl)&&(f(this,ti)||B(this,nt,KC).call(this),_(this,xl,!1),f(this,sn).hidden=!1))}get isVisible(){return f(this,ei)?!1:f(this,sn).hidden===!1}}ei=new WeakMap,Al=new WeakMap,HA=new WeakMap,ZA=new WeakMap,Yh=new WeakMap,Jh=new WeakMap,sn=new WeakMap,Zs=new WeakMap,Tl=new WeakMap,xu=new WeakMap,Xh=new WeakMap,Qh=new WeakMap,qs=new WeakMap,ti=new WeakMap,Ko=new WeakMap,Yo=new WeakMap,on=new WeakMap,Jo=new WeakMap,El=new WeakMap,uS=new WeakMap,Xo=new WeakMap,ep=new WeakMap,wu=new WeakMap,xl=new WeakMap,Mn=new WeakMap,wl=new WeakMap,nt=new WeakSet,ZC=function(){var t;if(f(this,Ko))return;_(this,Ko,new AbortController);const{signal:e}=f(this,Ko);for(const r of this.trigger)r.addEventListener("click",f(this,Yh),{signal:e}),r.addEventListener("pointerenter",f(this,ZA),{signal:e}),r.addEventListener("pointerleave",f(this,HA),{signal:e}),r.classList.add("popupTriggerArea");for(const r of f(this,xu))(t=r.container)==null||t.addEventListener("keydown",f(this,Al),{signal:e})},zb=function(){const e=f(this,xu).find(t=>t.hasCommentButton);e&&_(this,Jo,e._normalizePoint(e.commentButtonPosition))},Wb=function(){if(f(this,Mn).extraPopupElement&&!f(this,Mn).editor)return;f(this,on)||this.renderCommentButton();const[e,t]=f(this,Jo),{style:r}=f(this,on);r.left=`calc(${e}%)`,r.top=`calc(${t}% - var(--comment-button-dim))`},Vb=function(){f(this,Mn).extraPopupElement||(f(this,on)||this.renderCommentButton(),f(this,on).style.backgroundColor=this.commentButtonColor||"")},qC=function(){const e=f(this,Xo),t=f(this,Zs);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&f(this,Xo).html||null},$b=function(){var e,t,r;return((r=(t=(e=f(this,nt,qC))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.fontSize)||0},qj=function(){var e,t,r;return((r=(t=(e=f(this,nt,qC))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.color)||null},Gj=function(e){const t=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:f(this,nt,qj),fontSize:f(this,nt,$b)?`calc(${f(this,nt,$b)}px * var(--total-scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:i});return r},Kj=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&f(this,qs))&&B(this,nt,GC).call(this)},Yj=function(){if(f(this,Yo)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:r,pageX:i,pageY:s}}}=f(this,Xh);let o=!!f(this,Qh),a=o?f(this,Qh):f(this,uS);for(const C of f(this,xu))if(!a||ke.intersect(C.data.rect,a)!==null){a=C.data.rect,o=!0;break}const l=ke.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),u=o?a[2]-a[0]+5:0,h=l[0]+u,m=l[1];_(this,Yo,[100*(h-i)/t,100*(m-s)/r]);const{style:v}=f(this,sn);v.left=`${f(this,Yo)[0]}%`,v.top=`${f(this,Yo)[1]}%`},GC=function(){if(f(this,ei)){f(this,ei).toggleCommentPopup(this,!1);return}_(this,qs,!f(this,qs)),f(this,qs)?(B(this,nt,KC).call(this),f(this,sn).addEventListener("click",f(this,Yh)),f(this,sn).addEventListener("keydown",f(this,Al))):(B(this,nt,Hb).call(this),f(this,sn).removeEventListener("click",f(this,Yh)),f(this,sn).removeEventListener("keydown",f(this,Al)))},KC=function(){f(this,ti)||this.render(),this.isVisible?f(this,qs)&&f(this,sn).classList.add("focused"):(B(this,nt,Yj).call(this),f(this,sn).hidden=!1,f(this,sn).style.zIndex=parseInt(f(this,sn).style.zIndex)+1e3)},Hb=function(){f(this,sn).classList.remove("focused"),!(f(this,qs)||!this.isVisible)&&(f(this,sn).hidden=!0,f(this,sn).style.zIndex=parseInt(f(this,sn).style.zIndex)-1e3)};class Jj extends en{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Xe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const r=document.createElement("span");r.textContent=t,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var dS;class sH extends en{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});L(this,dS,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),o=_(this,dS,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return f(this,dS)}addHighlightArea(){this.container.classList.add("highlightArea")}}dS=new WeakMap;var hS;class oH extends en{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});L(this,hS,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),o=t.borderStyle.width,a=_(this,hS,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",r-o),a.setAttribute("height",i-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return f(this,hS)}addHighlightArea(){this.container.classList.add("highlightArea")}}hS=new WeakMap;var pS;class aH extends en{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});L(this,pS,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),o=t.borderStyle.width,a=_(this,pS,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",r/2),a.setAttribute("cy",i/2),a.setAttribute("rx",r/2-o/2),a.setAttribute("ry",i/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return f(this,pS)}addHighlightArea(){this.container.classList.add("highlightArea")}}pS=new WeakMap;var fS;class Xj extends en{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});L(this,fS,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:r,borderStyle:i,popupRef:s},width:o,height:a}=this;if(!r)return this.container;const l=this.svgFactory.create(o,a,!0);let c=[];for(let h=0,m=r.length;h<m;h+=2){const v=r[h]-t[0],C=t[3]-r[h+1];c.push(`${v},${C}`)}c=c.join(" ");const u=_(this,fS,this.svgFactory.createElement(this.svgElementName));return u.setAttribute("points",c),u.setAttribute("stroke-width",i.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),l.append(u),this.container.append(l),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return f(this,fS)}addHighlightArea(){this.container.classList.add("highlightArea")}}fS=new WeakMap;class lH extends Xj{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class cH extends en{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var mS,bu,gS,Zb;class oR extends en{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});L(this,gS);L(this,mS,null);L(this,bu,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Xe.HIGHLIGHT:Xe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:r,inkLists:i,borderStyle:s,popupRef:o}}=this,{transform:a,width:l,height:c}=B(this,gS,Zb).call(this,r,t),u=this.svgFactory.create(l,c,!0),h=_(this,mS,this.svgFactory.createElement("svg:g"));u.append(h),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",a);for(let m=0,v=i.length;m<v;m++){const C=this.svgFactory.createElement(this.svgElementName);f(this,bu).push(C),C.setAttribute("points",i[m].join(",")),h.append(C)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:r,points:i,rect:s}=t,o=f(this,mS);if(r>=0&&o.setAttribute("stroke-width",r||1),i)for(let a=0,l=f(this,bu).length;a<l;a++)f(this,bu)[a].setAttribute("points",i[a].join(","));if(s){const{transform:a,width:l,height:c}=B(this,gS,Zb).call(this,this.data.rotation,s);o.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return f(this,bu)}addHighlightArea(){this.container.classList.add("highlightArea")}}mS=new WeakMap,bu=new WeakMap,gS=new WeakSet,Zb=function(t,r){switch(t){case 90:return{transform:`rotate(90) translate(${-r[0]},${r[1]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};case 180:return{transform:`rotate(180) translate(${-r[2]},${r[1]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]};case 270:return{transform:`rotate(270) translate(${-r[2]},${r[3]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};default:return{transform:`translate(${-r[0]},${r[3]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]}}};class Qj extends en{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Xe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const r=document.createElement("mark");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class uH extends en{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class dH extends en{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class hH extends en{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const r=document.createElement("s");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class e4 extends en{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Xe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var vS,yS,qb;class pH extends en{constructor(t){var i;super(t,{isRenderable:!0});L(this,yS);L(this,vS,null);const{file:r}=this.data;this.filename=r.filename,this.content=r.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:r}=this;let i;r.hasAppearance||r.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(r.name)?"paperclip":"pushpin"}.svg`,r.fillAlpha&&r.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(r.fillAlpha*100)}%);`)),i.addEventListener("dblclick",B(this,yS,qb).bind(this)),_(this,vS,i);const{isMac:s}=Pn.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&B(this,yS,qb).call(this)}),!r.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return f(this,vS)}addHighlightArea(){this.container.classList.add("highlightArea")}}vS=new WeakMap,yS=new WeakSet,qb=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Pu,Ru,tp,bl,SS,Iu,ni,CS,la,YC,Kb;const PR=class PR{constructor({div:e,accessibilityManager:t,annotationCanvasMap:r,annotationEditorUIManager:i,page:s,viewport:o,structTreeLayer:a,commentManager:l,linkService:c,annotationStorage:u}){L(this,la);L(this,Pu,null);L(this,Ru,null);L(this,tp,null);L(this,bl,new Map);L(this,SS,null);L(this,Iu,null);L(this,ni,[]);L(this,CS,!1);this.div=e,_(this,Pu,t),_(this,Ru,r),_(this,SS,a||null),_(this,Iu,c||null),_(this,tp,u||new nR),this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=l||null}hasEditableAnnotations(){return f(this,bl).size>0}async render(e){var a;const{annotations:t}=e,r=this.div;Ku(r,this.viewport);const i=new Map,s=[],o={data:null,layer:r,linkService:f(this,Iu),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new EA,annotationStorage:f(this,tp),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const c=l.annotationType===gn.POPUP;if(c){const m=i.get(l.id);if(!m)continue;if(!this._commentManager){s.push(l);continue}o.elements=m}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;o.data=l;const u=Mw.create(o);if(!u.isRenderable)continue;if(!c&&(f(this,ni).push(u),l.popupRef)){const m=i.get(l.popupRef);m?m.push(u):i.set(l.popupRef,[u])}const h=u.render();l.hidden&&(h.style.visibility="hidden"),u._isEditable&&(f(this,bl).set(u.data.id,u),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(u))}await B(this,la,YC).call(this);for(const l of s){const c=o.elements=i.get(l.id);o.data=l;const u=Mw.create(o);if(!u.isRenderable)continue;const h=u.render();u.contentElement.id=`${Ud}${l.id}`,l.hidden&&(h.style.visibility="hidden"),c.at(-1).container.after(h)}B(this,la,Kb).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:f(this,Iu),svgFactory:new EA,parent:this};for(const r of e){r.borderStyle||(r.borderStyle=PR._defaultBorderStyle),t.data=r;const i=Mw.create(t);i.isRenderable&&(i.render(),i.contentElement.id=`${Ud}${r.id}`,f(this,ni).push(i))}await B(this,la,YC).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Ku(t,{rotation:e.rotation}),B(this,la,Kb).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(f(this,bl).values())}getEditableAnnotation(e){return f(this,bl).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:r,rotation:i}=e,s=new J$({data:{id:r,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:f(this,Iu),annotationStorage:f(this,tp)});return s.render(),s.contentElement.id=`${Ud}${r}`,s.createOrUpdatePopup(),f(this,ni).push(s),s}removeAnnotation(e){var i;const t=f(this,ni).findIndex(s=>s.data.id===e);if(t<0)return;const[r]=f(this,ni).splice(t,1);(i=f(this,Pu))==null||i.removePointerInTextLayer(r.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);B(this,la,YC).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return Ye(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:_d.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};Pu=new WeakMap,Ru=new WeakMap,tp=new WeakMap,bl=new WeakMap,SS=new WeakMap,Iu=new WeakMap,ni=new WeakMap,CS=new WeakMap,la=new WeakSet,YC=async function(){var r,i,s;if(f(this,ni).length===0)return;this.div.replaceChildren();const e=[];if(!f(this,CS)){_(this,CS,!0);for(const{contentElement:o,data:{id:a}}of f(this,ni)){const l=o.id=`${Ud}${a}`;e.push((r=f(this,SS))==null?void 0:r.getAriaAttributes(l).then(c=>{if(c)for(const[u,h]of c)o.setAttribute(u,h)}))}}f(this,ni).sort(({data:{rect:[o,a,l,c]}},{data:{rect:[u,h,m,v]}})=>{if(o===l&&a===c)return 1;if(u===m&&h===v)return-1;const C=c,T=a,E=(a+c)/2,x=v,P=h,b=(h+v)/2;if(E>=x&&b<=T)return-1;if(b>=C&&E<=P)return 1;const I=(o+l)/2,M=(u+m)/2;return I-M});const t=document.createDocumentFragment();for(const o of f(this,ni))t.append(o.container),this._commentManager?(s=((i=o.extraPopupElement)==null?void 0:i.popup)||o.popup)==null||s.renderCommentButton():o.extraPopupElement&&t.append(o.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),f(this,Pu))for(const o of f(this,ni))f(this,Pu).addPointerInTextLayer(o.contentElement,!1)},Kb=function(){var t;if(!f(this,Ru))return;const e=this.div;for(const[r,i]of f(this,Ru)){const s=e.querySelector(`[data-annotation-id="${r}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:o}=s;o?o.nodeName==="CANVAS"?o.replaceWith(i):o.classList.contains("annotationContent")?o.after(i):o.before(i):s.append(i);const a=f(this,bl).get(r);a&&(a._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(r,s.id,i),a._hasNoCanvas=!1):a.canvas=i)}f(this,Ru).clear()};let Gb=PR;const AC=/\r\n?|\n/g;var ri,AS,_u,ii,yn,t4,n4,r4,JC,ca,XC,QC,i4,Jb,s4;const Vt=class Vt extends Ut{constructor(t){super({...t,name:"freeTextEditor"});L(this,yn);L(this,ri,"");L(this,AS,`${this.id}-editor`);L(this,_u,null);L(this,ii);q(this,"_colorPicker",null);this.color=t.color||Vt._defaultColor||Ut._defaultLineColor,_(this,ii,t.fontSize||Vt._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=Vt.prototype,r=o=>o.isEmpty(),i=Yu.TRANSLATE_SMALL,s=Yu.TRANSLATE_BIG;return Ye(this,"_keyboardManager",new ZS([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:r}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:r}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:r}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:r}]]))}static initialize(t,r){Ut.initialize(t,r);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,r){switch(t){case ut.FREETEXT_SIZE:Vt._defaultFontSize=r;break;case ut.FREETEXT_COLOR:Vt._defaultColor=r;break}}updateParams(t,r){switch(t){case ut.FREETEXT_SIZE:B(this,yn,t4).call(this,r);break;case ut.FREETEXT_COLOR:B(this,yn,n4).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[ut.FREETEXT_SIZE,Vt._defaultFontSize],[ut.FREETEXT_COLOR,Vt._defaultColor||Ut._defaultLineColor]]}get propertiesToUpdate(){return[[ut.FREETEXT_SIZE,f(this,ii)],[ut.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new TA(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ut.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,r){this._uiManager.translateSelectedEditors(t,r,!0)}getInitialTranslation(){const t=this.parentScale;return[-Vt._internalPadding*t,-(Vt._internalPadding+f(this,ii))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),_(this,_u,new AbortController);const t=this._uiManager.combinedSignal(f(this,_u));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",f(this,AS)),this._isDraggable=!0,(t=f(this,_u))==null||t.abort(),_(this,_u,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var r;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=f(this,ri),r=_(this,ri,B(this,yn,r4).call(this).trimEnd());if(t===r)return;const i=s=>{if(_(this,ri,s),!s){this.remove();return}B(this,yn,QC).call(this),this._uiManager.rebuild(this),B(this,yn,JC).call(this)};this.addCommands({cmd:()=>{i(r)},undo:()=>{i(t)},mustExec:!1}),B(this,yn,JC).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Vt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,r;(this._isCopy||this.annotationElementId)&&(t=this.x,r=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",f(this,AS)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${f(this,ii)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[u,h]=this.pageDimensions,[m,v]=this.pageTranslation;let C,T;switch(this.rotation){case 0:C=t+(a[0]-m)/u,T=r+this.height-(a[1]-v)/h;break;case 90:C=t+(a[0]-m)/u,T=r-(a[1]-v)/h,[l,c]=[c,-l];break;case 180:C=t-this.width+(a[0]-m)/u,T=r-(a[1]-v)/h,[l,c]=[-l,-c];break;case 270:C=t+(a[0]-m-this.height*h)/u,T=r+(a[1]-v-this.width*u)/h,[l,c]=[-c,l];break}this.setAt(C*s,T*o,l,c)}else this._moveAfterPaste(t,r);B(this,yn,QC).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var C,T,E;const r=t.clipboardData||window.clipboardData,{types:i}=r;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const s=B(C=Vt,ca,Jb).call(C,r.getData("text")||"").replaceAll(AC,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!s.includes(`
`)){a.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:l,startOffset:c}=a,u=[],h=[];if(l.nodeType===Node.TEXT_NODE){const x=l.parentElement;if(h.push(l.nodeValue.slice(c).replaceAll(AC,"")),x!==this.editorDiv){let P=u;for(const b of this.editorDiv.childNodes){if(b===x){P=h;continue}P.push(B(T=Vt,ca,XC).call(T,b))}}u.push(l.nodeValue.slice(0,c).replaceAll(AC,""))}else if(l===this.editorDiv){let x=u,P=0;for(const b of this.editorDiv.childNodes)P++===c&&(x=h),x.push(B(E=Vt,ca,XC).call(E,b))}_(this,ri,`${u.join(`
`)}${s}${h.join(`
`)}`),B(this,yn,QC).call(this);const m=new Range;let v=Math.sumPrecise(u.map(x=>x.length));for(const{firstChild:x}of this.editorDiv.childNodes)if(x.nodeType===Node.TEXT_NODE){const P=x.nodeValue.length;if(v<=P){m.setStart(x,v),m.setEnd(x,v);break}v-=P}o.removeAllRanges(),o.addRange(m)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Vt._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,r,i){var a;let s=null;if(t instanceof Jj){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:u,rotation:h,id:m,popupRef:v,richText:C,contentsObj:T,creationDate:E,modificationDate:x},textContent:P,textPosition:b,parent:{page:{pageNumber:I}}}=t;if(!P||P.length===0)return null;s=t={annotationType:Xe.FREETEXT,color:Array.from(c),fontSize:l,value:P.join(`
`),position:b,pageIndex:I-1,rect:u.slice(0),rotation:h,annotationElementId:m,id:m,deleted:!1,popupRef:v,comment:(T==null?void 0:T.str)||null,richText:C,creationDate:E,modificationDate:x}}const o=await super.deserialize(t,r,i);return _(o,ii,t.fontSize),o.color=ke.makeHexColor(...t.color),_(o,ri,B(a=Vt,ca,Jb).call(a,t.value)),o._initialData=s,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=Ut._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:r,fontSize:f(this,ii),value:B(this,yn,i4).call(this)});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!B(this,yn,s4).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const r=super.renderAnnotationElement(t);if(!r)return null;const{style:i}=r;i.fontSize=`calc(${f(this,ii)}px * var(--total-scale-factor))`,i.color=this.color,r.replaceChildren();for(const s of f(this,ri).split(`
`)){const o=document.createElement("div");o.append(s?document.createTextNode(s):document.createElement("br")),r.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:f(this,ri)}}),r}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};ri=new WeakMap,AS=new WeakMap,_u=new WeakMap,ii=new WeakMap,yn=new WeakSet,t4=function(t){const r=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-f(this,ii))*this.parentScale),_(this,ii,s),B(this,yn,JC).call(this)},i=f(this,ii);this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ut.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},n4=function(t){const r=s=>{this.color=s,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ut.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},r4=function(){var i;const t=[];this.editorDiv.normalize();let r=null;for(const s of this.editorDiv.childNodes)(r==null?void 0:r.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(B(i=Vt,ca,XC).call(i,s)),r=s);return t.join(`
`)},JC=function(){const[t,r]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,a=o.style.display,l=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/r):(this.width=i.height/t,this.height=i.width/r),this.fixAndSetPosition()},ca=new WeakSet,XC=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(AC,"")},QC=function(){if(this.editorDiv.replaceChildren(),!!f(this,ri))for(const t of f(this,ri).split(`
`)){const r=document.createElement("div");r.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(r)}},i4=function(){return f(this,ri).replaceAll(""," ")},Jb=function(t){return t.replaceAll(" ","")},s4=function(t){const{value:r,fontSize:i,color:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==r||t.fontSize!==i||t.color.some((a,l)=>a!==s[l])||t.pageIndex!==o},L(Vt,ca),q(Vt,"_freeTextDefaultContent",""),q(Vt,"_internalPadding",0),q(Vt,"_defaultColor",null),q(Vt,"_defaultFontSize",10),q(Vt,"_type","freetext"),q(Vt,"_editorType",Xe.FREETEXT);let Yb=Vt;class Le{toSVGPath(){Dt("Abstract method `toSVGPath` must be implemented.")}get box(){Dt("Abstract getter `box` must be implemented.")}serialize(e,t){Dt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,r,i,s,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a]*i,o[a+1]=r+e[a+1]*s;return o}static _rescaleAndSwap(e,t,r,i,s,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a+1]*i,o[a+1]=r+e[a]*s;return o}static _translate(e,t,r,i){i||(i=new Float32Array(e.length));for(let s=0,o=e.length;s<o;s+=2)i[s]=t+e[s],i[s+1]=r+e[s+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,r,i,s){switch(s){case 90:return[1-t/r,e/i];case 180:return[1-e/r,1-t/i];case 270:return[t/r,1-e/i];default:return[e/r,t/i]}}static _normalizePagePoint(e,t,r){switch(r){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,r,i,s,o){return[(e+5*r)/6,(t+5*i)/6,(5*r+s)/6,(5*i+o)/6,(r+s)/2,(i+o)/2]}}q(Le,"PRECISION",1e-4);var si,ls,np,rp,Gs,it,ku,Mu,TS,ES,ip,sp,Pl,xS,qA,GA,bn,Mv,o4,a4,l4,c4,u4,d4;const xo=class xo{constructor({x:e,y:t},r,i,s,o,a=0){L(this,bn);L(this,si);L(this,ls,[]);L(this,np);L(this,rp);L(this,Gs,[]);L(this,it,new Float32Array(18));L(this,ku);L(this,Mu);L(this,TS);L(this,ES);L(this,ip);L(this,sp);L(this,Pl,[]);_(this,si,r),_(this,sp,s*i),_(this,rp,o),f(this,it).set([NaN,NaN,NaN,NaN,e,t],6),_(this,np,a),_(this,ES,f(xo,xS)*i),_(this,TS,f(xo,GA)*i),_(this,ip,i),f(this,Pl).push(e,t)}isEmpty(){return isNaN(f(this,it)[8])}add({x:e,y:t}){var F;_(this,ku,e),_(this,Mu,t);const[r,i,s,o]=f(this,si);let[a,l,c,u]=f(this,it).subarray(8,12);const h=e-c,m=t-u,v=Math.hypot(h,m);if(v<f(this,TS))return!1;const C=v-f(this,ES),T=C/v,E=T*h,x=T*m;let P=a,b=l;a=c,l=u,c+=E,u+=x,(F=f(this,Pl))==null||F.push(e,t);const I=-x/C,M=E/C,N=I*f(this,sp),D=M*f(this,sp);return f(this,it).set(f(this,it).subarray(2,8),0),f(this,it).set([c+N,u+D],4),f(this,it).set(f(this,it).subarray(14,18),12),f(this,it).set([c-N,u-D],16),isNaN(f(this,it)[6])?(f(this,Gs).length===0&&(f(this,it).set([a+N,l+D],2),f(this,Gs).push(NaN,NaN,NaN,NaN,(a+N-r)/s,(l+D-i)/o),f(this,it).set([a-N,l-D],14),f(this,ls).push(NaN,NaN,NaN,NaN,(a-N-r)/s,(l-D-i)/o)),f(this,it).set([P,b,a,l,c,u],6),!this.isEmpty()):(f(this,it).set([P,b,a,l,c,u],6),Math.abs(Math.atan2(b-l,P-a)-Math.atan2(x,E))<Math.PI/2?([a,l,c,u]=f(this,it).subarray(2,6),f(this,Gs).push(NaN,NaN,NaN,NaN,((a+c)/2-r)/s,((l+u)/2-i)/o),[a,l,P,b]=f(this,it).subarray(14,18),f(this,ls).push(NaN,NaN,NaN,NaN,((P+a)/2-r)/s,((b+l)/2-i)/o),!0):([P,b,a,l,c,u]=f(this,it).subarray(0,6),f(this,Gs).push(((P+5*a)/6-r)/s,((b+5*l)/6-i)/o,((5*a+c)/6-r)/s,((5*l+u)/6-i)/o,((a+c)/2-r)/s,((l+u)/2-i)/o),[c,u,a,l,P,b]=f(this,it).subarray(12,18),f(this,ls).push(((P+5*a)/6-r)/s,((b+5*l)/6-i)/o,((5*a+c)/6-r)/s,((5*l+u)/6-i)/o,((a+c)/2-r)/s,((l+u)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=f(this,Gs),t=f(this,ls);if(isNaN(f(this,it)[6])&&!this.isEmpty())return B(this,bn,o4).call(this);const r=[];r.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?r.push(`L${e[i+4]} ${e[i+5]}`):r.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);B(this,bn,l4).call(this,r);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?r.push(`L${t[i+4]} ${t[i+5]}`):r.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return B(this,bn,a4).call(this,r),r.join(" ")}newFreeDrawOutline(e,t,r,i,s,o){return new h4(e,t,r,i,s,o)}getOutlines(){var h;const e=f(this,Gs),t=f(this,ls),r=f(this,it),[i,s,o,a]=f(this,si),l=new Float32Array((((h=f(this,Pl))==null?void 0:h.length)??0)+2);for(let m=0,v=l.length-2;m<v;m+=2)l[m]=(f(this,Pl)[m]-i)/o,l[m+1]=(f(this,Pl)[m+1]-s)/a;if(l[l.length-2]=(f(this,ku)-i)/o,l[l.length-1]=(f(this,Mu)-s)/a,isNaN(r[6])&&!this.isEmpty())return B(this,bn,c4).call(this,l);const c=new Float32Array(f(this,Gs).length+24+f(this,ls).length);let u=e.length;for(let m=0;m<u;m+=2){if(isNaN(e[m])){c[m]=c[m+1]=NaN;continue}c[m]=e[m],c[m+1]=e[m+1]}u=B(this,bn,d4).call(this,c,u);for(let m=t.length-6;m>=6;m-=6)for(let v=0;v<6;v+=2){if(isNaN(t[m+v])){c[u]=c[u+1]=NaN,u+=2;continue}c[u]=t[m+v],c[u+1]=t[m+v+1],u+=2}return B(this,bn,u4).call(this,c,u),this.newFreeDrawOutline(c,l,f(this,si),f(this,ip),f(this,np),f(this,rp))}};si=new WeakMap,ls=new WeakMap,np=new WeakMap,rp=new WeakMap,Gs=new WeakMap,it=new WeakMap,ku=new WeakMap,Mu=new WeakMap,TS=new WeakMap,ES=new WeakMap,ip=new WeakMap,sp=new WeakMap,Pl=new WeakMap,xS=new WeakMap,qA=new WeakMap,GA=new WeakMap,bn=new WeakSet,Mv=function(){const e=f(this,it).subarray(4,6),t=f(this,it).subarray(16,18),[r,i,s,o]=f(this,si);return[(f(this,ku)+(e[0]-t[0])/2-r)/s,(f(this,Mu)+(e[1]-t[1])/2-i)/o,(f(this,ku)+(t[0]-e[0])/2-r)/s,(f(this,Mu)+(t[1]-e[1])/2-i)/o]},o4=function(){const[e,t,r,i]=f(this,si),[s,o,a,l]=B(this,bn,Mv).call(this);return`M${(f(this,it)[2]-e)/r} ${(f(this,it)[3]-t)/i} L${(f(this,it)[4]-e)/r} ${(f(this,it)[5]-t)/i} L${s} ${o} L${a} ${l} L${(f(this,it)[16]-e)/r} ${(f(this,it)[17]-t)/i} L${(f(this,it)[14]-e)/r} ${(f(this,it)[15]-t)/i} Z`},a4=function(e){const t=f(this,ls);e.push(`L${t[4]} ${t[5]} Z`)},l4=function(e){const[t,r,i,s]=f(this,si),o=f(this,it).subarray(4,6),a=f(this,it).subarray(16,18),[l,c,u,h]=B(this,bn,Mv).call(this);e.push(`L${(o[0]-t)/i} ${(o[1]-r)/s} L${l} ${c} L${u} ${h} L${(a[0]-t)/i} ${(a[1]-r)/s}`)},c4=function(e){const t=f(this,it),[r,i,s,o]=f(this,si),[a,l,c,u]=B(this,bn,Mv).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-r)/s,(t[3]-i)/o,NaN,NaN,NaN,NaN,(t[4]-r)/s,(t[5]-i)/o,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,(t[16]-r)/s,(t[17]-i)/o,NaN,NaN,NaN,NaN,(t[14]-r)/s,(t[15]-i)/o],0),this.newFreeDrawOutline(h,e,f(this,si),f(this,ip),f(this,np),f(this,rp))},u4=function(e,t){const r=f(this,ls);return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],t),t+=6},d4=function(e,t){const r=f(this,it).subarray(4,6),i=f(this,it).subarray(16,18),[s,o,a,l]=f(this,si),[c,u,h,m]=B(this,bn,Mv).call(this);return e.set([NaN,NaN,NaN,NaN,(r[0]-s)/a,(r[1]-o)/l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,h,m,NaN,NaN,NaN,NaN,(i[0]-s)/a,(i[1]-o)/l],t),t+=24},L(xo,xS,8),L(xo,qA,2),L(xo,GA,f(xo,xS)+f(xo,qA));let xA=xo;var op,Nu,Qo,wS,oi,bS,pn,KA,p4;class h4 extends Le{constructor(t,r,i,s,o,a){super();L(this,KA);L(this,op);L(this,Nu,new Float32Array(4));L(this,Qo);L(this,wS);L(this,oi);L(this,bS);L(this,pn);_(this,pn,t),_(this,oi,r),_(this,op,i),_(this,bS,s),_(this,Qo,o),_(this,wS,a),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],B(this,KA,p4).call(this,a);const[l,c,u,h]=f(this,Nu);for(let m=0,v=t.length;m<v;m+=2)t[m]=(t[m]-l)/u,t[m+1]=(t[m+1]-c)/h;for(let m=0,v=r.length;m<v;m+=2)r[m]=(r[m]-l)/u,r[m+1]=(r[m+1]-c)/h}toSVGPath(){const t=[`M${f(this,pn)[4]} ${f(this,pn)[5]}`];for(let r=6,i=f(this,pn).length;r<i;r+=6){if(isNaN(f(this,pn)[r])){t.push(`L${f(this,pn)[r+4]} ${f(this,pn)[r+5]}`);continue}t.push(`C${f(this,pn)[r]} ${f(this,pn)[r+1]} ${f(this,pn)[r+2]} ${f(this,pn)[r+3]} ${f(this,pn)[r+4]} ${f(this,pn)[r+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,r,i,s],o){const a=i-t,l=s-r;let c,u;switch(o){case 0:c=Le._rescale(f(this,pn),t,s,a,-l),u=Le._rescale(f(this,oi),t,s,a,-l);break;case 90:c=Le._rescaleAndSwap(f(this,pn),t,r,a,l),u=Le._rescaleAndSwap(f(this,oi),t,r,a,l);break;case 180:c=Le._rescale(f(this,pn),i,r,-a,l),u=Le._rescale(f(this,oi),i,r,-a,l);break;case 270:c=Le._rescaleAndSwap(f(this,pn),i,s,-a,-l),u=Le._rescaleAndSwap(f(this,oi),i,s,-a,-l);break}return{outline:Array.from(c),points:[Array.from(u)]}}get box(){return f(this,Nu)}newOutliner(t,r,i,s,o,a=0){return new xA(t,r,i,s,o,a)}getNewOutline(t,r){const[i,s,o,a]=f(this,Nu),[l,c,u,h]=f(this,op),m=o*u,v=a*h,C=i*u+l,T=s*h+c,E=this.newOutliner({x:f(this,oi)[0]*m+C,y:f(this,oi)[1]*v+T},f(this,op),f(this,bS),t,f(this,wS),r??f(this,Qo));for(let x=2;x<f(this,oi).length;x+=2)E.add({x:f(this,oi)[x]*m+C,y:f(this,oi)[x+1]*v+T});return E.getOutlines()}}op=new WeakMap,Nu=new WeakMap,Qo=new WeakMap,wS=new WeakMap,oi=new WeakMap,bS=new WeakMap,pn=new WeakMap,KA=new WeakSet,p4=function(t){const r=f(this,pn);let i=r[4],s=r[5];const o=[i,s,i,s];let a=i,l=s,c=i,u=s;const h=t?Math.max:Math.min,m=new Float32Array(4);for(let C=6,T=r.length;C<T;C+=6){const E=r[C+4],x=r[C+5];isNaN(r[C])?(ke.pointBoundingBox(E,x,o),l>x?(a=E,l=x):l===x&&(a=h(a,E)),u<x?(c=E,u=x):u===x&&(c=h(c,E))):(m[0]=m[1]=1/0,m[2]=m[3]=-1/0,ke.bezierBoundingBox(i,s,...r.slice(C,C+6),m),ke.rectBoundingBox(m[0],m[1],m[2],m[3],o),l>m[1]?(a=m[0],l=m[1]):l===m[1]&&(a=h(a,m[0])),u<m[3]?(c=m[2],u=m[3]):u===m[3]&&(c=h(c,m[2]))),i=E,s=x}const v=f(this,Nu);v[0]=o[0]-f(this,Qo),v[1]=o[1]-f(this,Qo),v[2]=o[2]-o[0]+2*f(this,Qo),v[3]=o[3]-o[1]+2*f(this,Qo),this.firstPoint=[a,l],this.lastPoint=[c,u]};var PS,RS,IS,Rl,cs,Ar,f4,eA,m4,g4,Qb;class Xb{constructor(e,t=0,r=0,i=!0){L(this,Ar);L(this,PS);L(this,RS);L(this,IS);L(this,Rl,[]);L(this,cs,[]);const s=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:T,y:E,width:x,height:P}of e){const b=Math.floor((T-t)/o)*o,I=Math.ceil((T+x+t)/o)*o,M=Math.floor((E-t)/o)*o,N=Math.ceil((E+P+t)/o)*o,D=[b,M,N,!0],j=[I,M,N,!1];f(this,Rl).push(D,j),ke.rectBoundingBox(b,M,I,N,s)}const a=s[2]-s[0]+2*r,l=s[3]-s[1]+2*r,c=s[0]-r,u=s[1]-r;let h=i?-1/0:1/0,m=1/0;const v=f(this,Rl).at(i?-1:-2),C=[v[0],v[2]];for(const T of f(this,Rl)){const[E,x,P,b]=T;!b&&i?x<m?(m=x,h=E):x===m&&(h=Math.max(h,E)):b&&!i&&(x<m?(m=x,h=E):x===m&&(h=Math.min(h,E))),T[0]=(E-c)/a,T[1]=(x-u)/l,T[2]=(P-u)/l}_(this,PS,new Float32Array([c,u,a,l])),_(this,RS,[h,m]),_(this,IS,C)}getOutlines(){f(this,Rl).sort((t,r)=>t[0]-r[0]||t[1]-r[1]||t[2]-r[2]);const e=[];for(const t of f(this,Rl))t[3]?(e.push(...B(this,Ar,Qb).call(this,t)),B(this,Ar,m4).call(this,t)):(B(this,Ar,g4).call(this,t),e.push(...B(this,Ar,Qb).call(this,t)));return B(this,Ar,f4).call(this,e)}}PS=new WeakMap,RS=new WeakMap,IS=new WeakMap,Rl=new WeakMap,cs=new WeakMap,Ar=new WeakSet,f4=function(e){const t=[],r=new Set;for(const o of e){const[a,l,c]=o;t.push([a,l,o],[a,c,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const l=t[o][2],c=t[o+1][2];l.push(c),c.push(l),r.add(l),r.add(c)}const i=[];let s;for(;r.size>0;){const o=r.values().next().value;let[a,l,c,u,h]=o;r.delete(o);let m=a,v=l;for(s=[a,c],i.push(s);;){let C;if(r.has(u))C=u;else if(r.has(h))C=h;else break;r.delete(C),[a,l,c,u,h]=C,m!==a&&(s.push(m,v,a,v===l?l:c),m=a),v=v===l?c:l}s.push(m,v)}return new fH(i,f(this,PS),f(this,RS),f(this,IS))},eA=function(e){const t=f(this,cs);let r=0,i=t.length-1;for(;r<=i;){const s=r+i>>1,o=t[s][0];if(o===e)return s;o<e?r=s+1:i=s-1}return i+1},m4=function([,e,t]){const r=B(this,Ar,eA).call(this,e);f(this,cs).splice(r,0,[e,t])},g4=function([,e,t]){const r=B(this,Ar,eA).call(this,e);for(let i=r;i<f(this,cs).length;i++){const[s,o]=f(this,cs)[i];if(s!==e)break;if(s===e&&o===t){f(this,cs).splice(i,1);return}}for(let i=r-1;i>=0;i--){const[s,o]=f(this,cs)[i];if(s!==e)break;if(s===e&&o===t){f(this,cs).splice(i,1);return}}},Qb=function(e){const[t,r,i]=e,s=[[t,r,i]],o=B(this,Ar,eA).call(this,i);for(let a=0;a<o;a++){const[l,c]=f(this,cs)[a];for(let u=0,h=s.length;u<h;u++){const[,m,v]=s[u];if(!(c<=m||v<=l)){if(m>=l){if(v>c)s[u][1]=c;else{if(h===1)return[];s.splice(u,1),u--,h--}continue}s[u][2]=l,v>c&&s.push([t,c,v])}}}return s};var _S,ap;class fH extends Le{constructor(t,r,i,s){super();L(this,_S);L(this,ap);_(this,ap,t),_(this,_S,r),this.firstPoint=i,this.lastPoint=s}toSVGPath(){const t=[];for(const r of f(this,ap)){let[i,s]=r;t.push(`M${i} ${s}`);for(let o=2;o<r.length;o+=2){const a=r[o],l=r[o+1];a===i?(t.push(`V${l}`),s=l):l===s&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,r,i,s],o){const a=[],l=i-t,c=s-r;for(const u of f(this,ap)){const h=new Array(u.length);for(let m=0;m<u.length;m+=2)h[m]=t+u[m]*l,h[m+1]=s-u[m+1]*c;a.push(h)}return a}get box(){return f(this,_S)}get classNamesForOutlining(){return["highlightOutline"]}}_S=new WeakMap,ap=new WeakMap;class eP extends xA{newFreeDrawOutline(e,t,r,i,s,o){return new mH(e,t,r,i,s,o)}}class mH extends h4{newOutliner(e,t,r,i,s,o=0){return new eP(e,t,r,i,s,o)}}var lp,kS,ea,Lu,MS,Dr,NS,LS,Du,ai,li,Hn,cp,up,or,dp,Oi,DS,tt,tP,tA,v4,y4,S4,nP,Rc,Fi,Od,C4,nA,rA,A4,T4,E4,x4,w4;const St=class St extends Ut{constructor(t){super({...t,name:"highlightEditor"});L(this,tt);L(this,lp,null);L(this,kS,0);L(this,ea);L(this,Lu,null);L(this,MS,null);L(this,Dr,null);L(this,NS,null);L(this,LS,0);L(this,Du,null);L(this,ai,null);L(this,li,null);L(this,Hn,!1);L(this,cp,null);L(this,up,null);L(this,or,null);L(this,dp,"");L(this,Oi);L(this,DS,"");this.color=t.color||St._defaultColor,_(this,Oi,t.thickness||St._defaultThickness),this.opacity=t.opacity||St._defaultOpacity,_(this,ea,t.boxes||null),_(this,DS,t.methodOfCreation||""),_(this,dp,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(_(this,Hn,!0),B(this,tt,tA).call(this,t),B(this,tt,Rc).call(this)):f(this,ea)&&(_(this,lp,t.anchorNode),_(this,kS,t.anchorOffset),_(this,NS,t.focusNode),_(this,LS,t.focusOffset),B(this,tt,tP).call(this),B(this,tt,Rc).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=St.prototype;return Ye(this,"_keyboardManager",new ZS([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:f(this,Hn)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:f(this,Oi),methodOfCreation:f(this,DS)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,r){var i;Ut.initialize(t,r),St._defaultColor||(St._defaultColor=((i=r.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,r){switch(t){case ut.HIGHLIGHT_COLOR:St._defaultColor=r;break;case ut.HIGHLIGHT_THICKNESS:St._defaultThickness=r;break}}translateInPage(t,r){}get toolbarPosition(){return f(this,up)}get commentButtonPosition(){return f(this,cp)}updateParams(t,r){switch(t){case ut.HIGHLIGHT_COLOR:B(this,tt,v4).call(this,r);break;case ut.HIGHLIGHT_THICKNESS:B(this,tt,y4).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[ut.HIGHLIGHT_COLOR,St._defaultColor],[ut.HIGHLIGHT_THICKNESS,St._defaultThickness]]}get propertiesToUpdate(){return[[ut.HIGHLIGHT_COLOR,this.color||St._defaultColor],[ut.HIGHLIGHT_THICKNESS,f(this,Oi)||St._defaultThickness],[ut.HIGHLIGHT_FREE,f(this,Hn)]]}onUpdatedColor(){var t,r;(t=this.parent)==null||t.drawLayer.updateProperties(f(this,li),{root:{fill:this.color,"fill-opacity":this.opacity}}),(r=f(this,MS))==null||r.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",_(this,MS,new AA({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(B(this,tt,rA).call(this))}getBaseTranslation(){return[0,0]}getRect(t,r){return super.getRect(t,r,B(this,tt,rA).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){B(this,tt,nP).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(B(this,tt,Rc).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let r=!1;this.parent&&!t?B(this,tt,nP).call(this):t&&(B(this,tt,Rc).call(this,t),r=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),r&&this.select()}rotate(t){var s,o,a;const{drawLayer:r}=this.parent;let i;f(this,Hn)?(t=(t-this.rotation+360)%360,i=B(s=St,Fi,Od).call(s,f(this,ai).box,t)):i=B(o=St,Fi,Od).call(o,[this.x,this.y,this.width,this.height],t),r.updateProperties(f(this,li),{bbox:i,root:{"data-main-rotation":t}}),r.updateProperties(f(this,or),{bbox:B(a=St,Fi,Od).call(a,f(this,Dr).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();f(this,dp)&&(t.setAttribute("aria-label",f(this,dp)),t.setAttribute("role","mark")),f(this,Hn)?t.classList.add("free"):this.div.addEventListener("keydown",B(this,tt,C4).bind(this),{signal:this._uiManager._signal});const r=_(this,Du,document.createElement("div"));return t.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",r.style.clipPath=f(this,Lu),this.setDims(),$F(this,f(this,Du),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(f(this,or),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(f(this,or),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:B(this,tt,nA).call(this,!0);break;case 1:case 3:B(this,tt,nA).call(this,!1);break}}select(){var t;super.select(),f(this,or)&&((t=this.parent)==null||t.drawLayer.updateProperties(f(this,or),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),f(this,or)&&((t=this.parent)==null||t.drawLayer.updateProperties(f(this,or),{rootClass:{selected:!1}}),f(this,Hn)||B(this,tt,nA).call(this,!1))}get _mustFixPosition(){return!f(this,Hn)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(f(this,li),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(f(this,or),{rootClass:{hidden:!t}}))}static startHighlighting(t,r,{target:i,x:s,y:o}){const{x:a,y:l,width:c,height:u}=i.getBoundingClientRect(),h=new AbortController,m=t.combinedSignal(h),v=C=>{h.abort(),B(this,Fi,x4).call(this,t,C)};window.addEventListener("blur",v,{signal:m}),window.addEventListener("pointerup",v,{signal:m}),window.addEventListener("pointerdown",cn,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",zi,{signal:m}),i.addEventListener("pointermove",B(this,Fi,E4).bind(this,t),{signal:m}),this._freeHighlight=new eP({x:s,y:o},[a,l,c,u],t.scale,this._defaultThickness/2,r,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,r,i){var T,E,x,P;let s=null;if(t instanceof Qj){const{data:{quadPoints:b,rect:I,rotation:M,id:N,color:D,opacity:j,popupRef:F,richText:z,contentsObj:W,creationDate:H,modificationDate:V},parent:{page:{pageNumber:K}}}=t;s=t={annotationType:Xe.HIGHLIGHT,color:Array.from(D),opacity:j,quadPoints:b,boxes:null,pageIndex:K-1,rect:I.slice(0),rotation:M,annotationElementId:N,id:N,deleted:!1,popupRef:F,richText:z,comment:(W==null?void 0:W.str)||null,creationDate:H,modificationDate:V}}else if(t instanceof oR){const{data:{inkLists:b,rect:I,rotation:M,id:N,color:D,borderStyle:{rawWidth:j},popupRef:F,richText:z,contentsObj:W,creationDate:H,modificationDate:V},parent:{page:{pageNumber:K}}}=t;s=t={annotationType:Xe.HIGHLIGHT,color:Array.from(D),thickness:j,inkLists:b,boxes:null,pageIndex:K-1,rect:I.slice(0),rotation:M,annotationElementId:N,id:N,deleted:!1,popupRef:F,richText:z,comment:(W==null?void 0:W.str)||null,creationDate:H,modificationDate:V}}const{color:o,quadPoints:a,inkLists:l,opacity:c}=t,u=await super.deserialize(t,r,i);u.color=ke.makeHexColor(...o),u.opacity=c||1,l&&_(u,Oi,t.thickness),u._initialData=s,t.comment&&u.setCommentData(t);const[h,m]=u.pageDimensions,[v,C]=u.pageTranslation;if(a){const b=_(u,ea,[]);for(let I=0;I<a.length;I+=8)b.push({x:(a[I]-v)/h,y:1-(a[I+1]-C)/m,width:(a[I+2]-a[I])/h,height:(a[I+1]-a[I+5])/m});B(T=u,tt,tP).call(T),B(E=u,tt,Rc).call(E),u.rotate(u.rotation)}else if(l){_(u,Hn,!0);const b=l[0],I={x:b[0]-v,y:m-(b[1]-C)},M=new eP(I,[0,0,h,m],1,f(u,Oi)/2,!0,.001);for(let j=0,F=b.length;j<F;j+=2)I.x=b[j]-v,I.y=m-(b[j+1]-C),M.add(I);const{id:N,clipPathId:D}=r.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:M.toSVGPath()}},!0,!0);B(x=u,tt,tA).call(x,{highlightOutlines:M.getOutlines(),highlightId:N,clipPathId:D}),B(P=u,tt,Rc).call(P),u.rotate(u.parentRotation)}return u}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const r=Ut._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:r,opacity:this.opacity,thickness:f(this,Oi),quadPoints:B(this,tt,A4).call(this),outlines:B(this,tt,T4).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!B(this,tt,w4).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};lp=new WeakMap,kS=new WeakMap,ea=new WeakMap,Lu=new WeakMap,MS=new WeakMap,Dr=new WeakMap,NS=new WeakMap,LS=new WeakMap,Du=new WeakMap,ai=new WeakMap,li=new WeakMap,Hn=new WeakMap,cp=new WeakMap,up=new WeakMap,or=new WeakMap,dp=new WeakMap,Oi=new WeakMap,DS=new WeakMap,tt=new WeakSet,tP=function(){const t=new Xb(f(this,ea),.001);_(this,ai,t.getOutlines()),[this.x,this.y,this.width,this.height]=f(this,ai).box;const r=new Xb(f(this,ea),.0025,.001,this._uiManager.direction==="ltr");_(this,Dr,r.getOutlines());const{firstPoint:i}=f(this,ai);_(this,cp,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:s}=f(this,Dr);_(this,up,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},tA=function({highlightOutlines:t,highlightId:r,clipPathId:i}){var m,v;if(_(this,ai,t),_(this,Dr,t.getNewOutline(f(this,Oi)/2+1.5,.0025)),r>=0)_(this,li,r),_(this,Lu,i),this.parent.drawLayer.finalizeDraw(r,{bbox:t.box,path:{d:t.toSVGPath()}}),_(this,or,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:f(this,Dr).box,path:{d:f(this,Dr).toSVGPath()}},!0));else if(this.parent){const C=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(f(this,li),{bbox:B(m=St,Fi,Od).call(m,f(this,ai).box,(C-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(f(this,or),{bbox:B(v=St,Fi,Od).call(v,f(this,Dr).box,C),path:{d:f(this,Dr).toSVGPath()}})}const[o,a,l,c]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=l,this.height=c;break;case 90:{const[C,T]=this.parentDimensions;this.x=a,this.y=1-o,this.width=l*T/C,this.height=c*C/T;break}case 180:this.x=1-o,this.y=1-a,this.width=l,this.height=c;break;case 270:{const[C,T]=this.parentDimensions;this.x=1-a,this.y=o,this.width=l*T/C,this.height=c*C/T;break}}const{firstPoint:u}=t;_(this,cp,[(u[0]-o)/l,(u[1]-a)/c]);const{lastPoint:h}=f(this,Dr);_(this,up,[(h[0]-o)/l,(h[1]-a)/c])},v4=function(t){const r=(o,a)=>{this.color=o,this.opacity=a,this.onUpdatedColor()},i=this.color,s=this.opacity;this.addCommands({cmd:r.bind(this,t,St._defaultOpacity),undo:r.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ut.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},y4=function(t){const r=f(this,Oi),i=s=>{_(this,Oi,s),B(this,tt,S4).call(this,s)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ut.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},S4=function(t){f(this,Hn)&&(B(this,tt,tA).call(this,{highlightOutlines:f(this,ai).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},nP=function(){f(this,li)===null||!this.parent||(this.parent.drawLayer.remove(f(this,li)),_(this,li,null),this.parent.drawLayer.remove(f(this,or)),_(this,or,null))},Rc=function(t=this.parent){f(this,li)===null&&({id:An(this,li)._,clipPathId:An(this,Lu)._}=t.drawLayer.draw({bbox:f(this,ai).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:f(this,Hn)},path:{d:f(this,ai).toSVGPath()}},!1,!0),_(this,or,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:f(this,Hn)},bbox:f(this,Dr).box,path:{d:f(this,Dr).toSVGPath()}},f(this,Hn))),f(this,Du)&&(f(this,Du).style.clipPath=f(this,Lu)))},Fi=new WeakSet,Od=function([t,r,i,s],o){switch(o){case 90:return[1-r-s,t,s,i];case 180:return[1-t-i,1-r-s,i,s];case 270:return[r,1-t-i,s,i]}return[t,r,i,s]},C4=function(t){St._keyboardManager.exec(this,t)},nA=function(t){if(!f(this,lp))return;const r=window.getSelection();t?r.setPosition(f(this,lp),f(this,kS)):r.setPosition(f(this,NS),f(this,LS))},rA=function(){return f(this,Hn)?this.rotation:0},A4=function(){if(f(this,Hn))return null;const[t,r]=this.pageDimensions,[i,s]=this.pageTranslation,o=f(this,ea),a=new Float32Array(o.length*8);let l=0;for(const{x:c,y:u,width:h,height:m}of o){const v=c*t+i,C=(1-u)*r+s;a[l]=a[l+4]=v,a[l+1]=a[l+3]=C,a[l+2]=a[l+6]=v+h*t,a[l+5]=a[l+7]=C-m*r,l+=8}return a},T4=function(t){return f(this,ai).serialize(t,B(this,tt,rA).call(this))},E4=function(t,r){this._freeHighlight.add(r)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},x4=function(t,r){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(r,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},w4=function(t){const{color:r}=this._initialData;return this.hasEditedComment||t.color.some((i,s)=>i!==r[s])},L(St,Fi),q(St,"_defaultColor",null),q(St,"_defaultOpacity",1),q(St,"_defaultThickness",12),q(St,"_type","highlight"),q(St,"_editorType",Xe.HIGHLIGHT),q(St,"_freeHighlightId",-1),q(St,"_freeHighlight",null),q(St,"_freeHighlightClipId","");let wA=St;var Ou;class b4{constructor(){L(this,Ou,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,r]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,r)}updateSVGProperty(e,t){f(this,Ou)[e]=t}toSVGProperties(){const e=f(this,Ou);return _(this,Ou,Object.create(null)),{root:e}}reset(){_(this,Ou,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Dt("Not implemented")}}Ou=new WeakMap;var ci,hp,Nn,Bu,Fu,ft,rP,iP,sP,Nv,P4,iA,Lv,Bd;const ct=class ct extends Ut{constructor(t){super(t);L(this,ft);L(this,ci,null);L(this,hp);q(this,"_colorPicker",null);q(this,"_drawId",null);_(this,hp,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(B(this,ft,rP).call(this,t),B(this,ft,Nv).call(this))}static _mergeSVGProperties(t,r){const i=new Set(Object.keys(t));for(const[s,o]of Object.entries(r))i.has(s)?Object.assign(t[s],o):t[s]=o;return t}static getDefaultDrawingOptions(t){Dt("Not implemented")}static get typesMap(){Dt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,r){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,r),this._currentParent&&(f(ct,Nn).updateProperty(i,r),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,r){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,r)}static get defaultPropertiesToUpdate(){const t=[],r=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)t.push([i,r[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:r}=this;for(const[i,s]of this.constructor.typesMap)t.push([i,r[s]]);return t}_updateProperty(t,r,i){const s=this._drawingOptions,o=s[r],a=l=>{var u;s.updateProperty(r,l);const c=f(this,ci).updateProperty(r,l);c&&B(this,ft,Lv).call(this,c),(u=this.parent)==null||u.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ct._mergeSVGProperties(f(this,ci).getPathResizingSVGProperties(B(this,ft,iA).call(this)),{bbox:B(this,ft,Bd).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ct._mergeSVGProperties(f(this,ci).getPathResizedSVGProperties(B(this,ft,iA).call(this)),{bbox:B(this,ft,Bd).call(this)}))}_onTranslating(t,r){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:B(this,ft,Bd).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ct._mergeSVGProperties(f(this,ci).getPathTranslatedSVGProperties(B(this,ft,iA).call(this),this.parentDimensions),{bbox:B(this,ft,Bd).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,f(this,hp)&&(_(this,hp,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){B(this,ft,sP).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(B(this,ft,Nv).call(this),B(this,ft,Lv).call(this,f(this,ci).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let r=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),B(this,ft,sP).call(this)):t&&(this._uiManager.addShouldRescale(this),B(this,ft,Nv).call(this,t),r=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),r&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ct._mergeSVGProperties({bbox:B(this,ft,Bd).call(this)},f(this,ci).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&B(this,ft,Lv).call(this,f(this,ci).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,r;this._isCopy&&(t=this.x,r=this.y);const i=super.render();i.classList.add("draw");const s=document.createElement("div");return i.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,r),i}static createDrawerInstance(t,r,i,s,o){Dt("Not implemented")}static startDrawing(t,r,i,s){var E;const{target:o,offsetX:a,offsetY:l,pointerId:c,pointerType:u}=s;if(tr.isInitializedAndDifferentPointerType(u))return;const{viewport:{rotation:h}}=t,{width:m,height:v}=o.getBoundingClientRect(),C=_(ct,Bu,new AbortController),T=t.combinedSignal(C);if(tr.setPointer(u,c),window.addEventListener("pointerup",x=>{tr.isSamePointerIdOrRemove(x.pointerId)&&this._endDraw(x)},{signal:T}),window.addEventListener("pointercancel",x=>{tr.isSamePointerIdOrRemove(x.pointerId)&&this._currentParent.endDrawingSession()},{signal:T}),window.addEventListener("pointerdown",x=>{tr.isSamePointerType(x.pointerType)&&(tr.initializeAndAddPointerId(x.pointerId),f(ct,Nn).isCancellable()&&(f(ct,Nn).removeLastElement(),f(ct,Nn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:T}),window.addEventListener("contextmenu",zi,{signal:T}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:T}),o.addEventListener("touchmove",x=>{tr.isSameTimeStamp(x.timeStamp)&&cn(x)},{signal:T}),t.toggleDrawing(),(E=r._editorUndoBar)==null||E.hide(),f(ct,Nn)){t.drawLayer.updateProperties(this._currentDrawId,f(ct,Nn).startNew(a,l,m,v,h));return}r.updateUIForDefaultProperties(this),_(ct,Nn,this.createDrawerInstance(a,l,m,v,h)),_(ct,Fu,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(f(ct,Fu).toSVGProperties(),f(ct,Nn).defaultSVGProperties),!0,!1)}static _drawMove(t){if(tr.isSameTimeStamp(t.timeStamp),!f(ct,Nn))return;const{offsetX:r,offsetY:i,pointerId:s}=t;if(tr.isSamePointerId(s)){if(tr.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,f(ct,Nn).add(r,i)),tr.setTimeStamp(t.timeStamp),cn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,_(ct,Nn,null),_(ct,Fu,null),tr.clearTimeStamp()),f(ct,Bu)&&(f(ct,Bu).abort(),_(ct,Bu,null),tr.clearPointerIds())}static _endDraw(t){const r=this._currentParent;if(r){if(r.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===r.div&&r.drawLayer.updateProperties(this._currentDrawId,f(ct,Nn).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=f(ct,Nn),s=this._currentDrawId,o=i.getLastElement();r.addCommands({cmd:()=>{r.drawLayer.updateProperties(s,i.setLastElement(o))},undo:()=>{r.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:ut.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const r=this._currentParent;if(!r)return null;if(r.toggleDrawing(!0),r.cleanUndoStack(ut.DRAW_STEP),!f(ct,Nn).isEmpty()){const{pageDimensions:[i,s],scale:o}=r,a=r.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:f(ct,Nn).getOutlines(i*o,s*o,o,this._INNER_MARGIN),drawingOptions:f(ct,Fu),mustBeCommitted:!t});return this._cleanup(!0),a}return r.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,r,i,s,o,a){Dt("Not implemented")}static async deserialize(t,r,i){var h,m;const{rawDims:{pageWidth:s,pageHeight:o,pageX:a,pageY:l}}=r.viewport,c=this.deserializeDraw(a,l,s,o,this._INNER_MARGIN,t),u=await super.deserialize(t,r,i);return u.createDrawingOptions(t),B(h=u,ft,rP).call(h,{drawOutlines:c}),B(m=u,ft,Nv).call(m),u.onScaleChanging(),u.rotate(),u}serializeDraw(t){const[r,i]=this.pageTranslation,[s,o]=this.pageDimensions;return f(this,ci).serialize([r,i,s,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};ci=new WeakMap,hp=new WeakMap,Nn=new WeakMap,Bu=new WeakMap,Fu=new WeakMap,ft=new WeakSet,rP=function({drawOutlines:t,drawId:r,drawingOptions:i}){_(this,ci,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),r>=0?(this._drawId=r,this.parent.drawLayer.finalizeDraw(r,t.defaultProperties)):this._drawId=B(this,ft,iP).call(this,t,this.parent),B(this,ft,Lv).call(this,t.box)},iP=function(t,r){const{id:i}=r.drawLayer.draw(ct._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},sP=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Nv=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=B(this,ft,iP).call(this,f(this,ci),t)}},P4=function([t,r,i,s]){const{parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[r,1-t,i*(a/o),s*(o/a)];case 180:return[1-t,1-r,i,s];case 270:return[1-r,t,i*(a/o),s*(o/a)];default:return[t,r,i,s]}},iA=function(){const{x:t,y:r,width:i,height:s,parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[1-r,t,i*(o/a),s*(a/o)];case 180:return[1-t,1-r,i,s];case 270:return[r,1-t,i*(o/a),s*(a/o)];default:return[t,r,i,s]}},Lv=function(t){[this.x,this.y,this.width,this.height]=B(this,ft,P4).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Bd=function(){const{x:t,y:r,width:i,height:s,rotation:o,parentRotation:a,parentDimensions:[l,c]}=this;switch((o*4+a)/90){case 1:return[1-r-s,t,s,i];case 2:return[1-t-i,1-r-s,i,s];case 3:return[r,1-t-i,s,i];case 4:return[t,r-i*(l/c),s*(c/l),i*(l/c)];case 5:return[1-r,t,i*(l/c),s*(c/l)];case 6:return[1-t-s*(c/l),1-r,s*(c/l),i*(l/c)];case 7:return[r-i*(l/c),1-t-s*(c/l),i*(l/c),s*(c/l)];case 8:return[t-i,r-s,i,s];case 9:return[1-r,t-i,s,i];case 10:return[1-t,1-r,i,s];case 11:return[r-s,1-t,s,i];case 12:return[t-s*(c/l),r,s*(c/l),i*(l/c)];case 13:return[1-r-i*(l/c),t-s*(c/l),i*(l/c),s*(c/l)];case 14:return[1-t,1-r-i*(l/c),s*(c/l),i*(l/c)];case 15:return[r,1-t,i*(l/c),s*(c/l)];default:return[t,r,i,s]}},q(ct,"_currentDrawId",-1),q(ct,"_currentParent",null),L(ct,Nn,null),L(ct,Bu,null),L(ct,Fu,null),q(ct,"_INNER_MARGIN",3);let bA=ct;var Ks,Ln,Dn,ju,pp,fr,Zn,Bi,Uu,zu,Wu,fp,sA;class gH{constructor(e,t,r,i,s,o){L(this,fp);L(this,Ks,new Float64Array(6));L(this,Ln);L(this,Dn);L(this,ju);L(this,pp);L(this,fr);L(this,Zn,"");L(this,Bi,0);L(this,Uu,new GS);L(this,zu);L(this,Wu);_(this,zu,r),_(this,Wu,i),_(this,ju,s),_(this,pp,o),[e,t]=B(this,fp,sA).call(this,e,t);const a=_(this,Ln,[NaN,NaN,NaN,NaN,e,t]);_(this,fr,[e,t]),_(this,Dn,[{line:a,points:f(this,fr)}]),f(this,Ks).set(a,0)}updateProperty(e,t){e==="stroke-width"&&_(this,pp,t)}isEmpty(){return!f(this,Dn)||f(this,Dn).length===0}isCancellable(){return f(this,fr).length<=10}add(e,t){[e,t]=B(this,fp,sA).call(this,e,t);const[r,i,s,o]=f(this,Ks).subarray(2,6),a=e-s,l=t-o;return Math.hypot(f(this,zu)*a,f(this,Wu)*l)<=2?null:(f(this,fr).push(e,t),isNaN(r)?(f(this,Ks).set([s,o,e,t],2),f(this,Ln).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(f(this,Ks)[0])&&f(this,Ln).splice(6,6),f(this,Ks).set([r,i,s,o,e,t],0),f(this,Ln).push(...Le.createBezierPoints(r,i,s,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const r=this.add(e,t);return r||(f(this,fr).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,r,i,s){_(this,zu,r),_(this,Wu,i),_(this,ju,s),[e,t]=B(this,fp,sA).call(this,e,t);const o=_(this,Ln,[NaN,NaN,NaN,NaN,e,t]);_(this,fr,[e,t]);const a=f(this,Dn).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),f(this,Dn).push({line:o,points:f(this,fr)}),f(this,Ks).set(o,0),_(this,Bi,0),this.toSVGPath(),null}getLastElement(){return f(this,Dn).at(-1)}setLastElement(e){return f(this,Dn)?(f(this,Dn).push(e),_(this,Ln,e.line),_(this,fr,e.points),_(this,Bi,0),{path:{d:this.toSVGPath()}}):f(this,Uu).setLastElement(e)}removeLastElement(){if(!f(this,Dn))return f(this,Uu).removeLastElement();f(this,Dn).pop(),_(this,Zn,"");for(let e=0,t=f(this,Dn).length;e<t;e++){const{line:r,points:i}=f(this,Dn)[e];_(this,Ln,r),_(this,fr,i),_(this,Bi,0),this.toSVGPath()}return{path:{d:f(this,Zn)}}}toSVGPath(){const e=Le.svgRound(f(this,Ln)[4]),t=Le.svgRound(f(this,Ln)[5]);if(f(this,fr).length===2)return _(this,Zn,`${f(this,Zn)} M ${e} ${t} Z`),f(this,Zn);if(f(this,fr).length<=6){const i=f(this,Zn).lastIndexOf("M");_(this,Zn,`${f(this,Zn).slice(0,i)} M ${e} ${t}`),_(this,Bi,6)}if(f(this,fr).length===4){const i=Le.svgRound(f(this,Ln)[10]),s=Le.svgRound(f(this,Ln)[11]);return _(this,Zn,`${f(this,Zn)} L ${i} ${s}`),_(this,Bi,12),f(this,Zn)}const r=[];f(this,Bi)===0&&(r.push(`M ${e} ${t}`),_(this,Bi,6));for(let i=f(this,Bi),s=f(this,Ln).length;i<s;i+=6){const[o,a,l,c,u,h]=f(this,Ln).slice(i,i+6).map(Le.svgRound);r.push(`C${o} ${a} ${l} ${c} ${u} ${h}`)}return _(this,Zn,f(this,Zn)+r.join(" ")),_(this,Bi,f(this,Ln).length),f(this,Zn)}getOutlines(e,t,r,i){const s=f(this,Dn).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),f(this,Uu).build(f(this,Dn),e,t,r,f(this,ju),f(this,pp),i),_(this,Ks,null),_(this,Ln,null),_(this,Dn,null),_(this,Zn,null),f(this,Uu)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Ks=new WeakMap,Ln=new WeakMap,Dn=new WeakMap,ju=new WeakMap,pp=new WeakMap,fr=new WeakMap,Zn=new WeakMap,Bi=new WeakMap,Uu=new WeakMap,zu=new WeakMap,Wu=new WeakMap,fp=new WeakSet,sA=function(e,t){return Le._normalizePoint(e,t,f(this,zu),f(this,Wu),f(this,ju))};var mr,OS,BS,ui,Ys,Js,mp,gp,Vu,Gn,To,R4,I4,_4;class GS extends Le{constructor(){super(...arguments);L(this,Gn);L(this,mr);L(this,OS,0);L(this,BS);L(this,ui);L(this,Ys);L(this,Js);L(this,mp);L(this,gp);L(this,Vu)}build(t,r,i,s,o,a,l){_(this,Ys,r),_(this,Js,i),_(this,mp,s),_(this,gp,o),_(this,Vu,a),_(this,BS,l??0),_(this,ui,t),B(this,Gn,I4).call(this)}get thickness(){return f(this,Vu)}setLastElement(t){return f(this,ui).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return f(this,ui).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:r}of f(this,ui)){if(t.push(`M${Le.svgRound(r[4])} ${Le.svgRound(r[5])}`),r.length===6){t.push("Z");continue}if(r.length===12&&isNaN(r[6])){t.push(`L${Le.svgRound(r[10])} ${Le.svgRound(r[11])}`);continue}for(let i=6,s=r.length;i<s;i+=6){const[o,a,l,c,u,h]=r.subarray(i,i+6).map(Le.svgRound);t.push(`C${o} ${a} ${l} ${c} ${u} ${h}`)}}return t.join("")}serialize([t,r,i,s],o){const a=[],l=[],[c,u,h,m]=B(this,Gn,R4).call(this);let v,C,T,E,x,P,b,I,M;switch(f(this,gp)){case 0:M=Le._rescale,v=t,C=r+s,T=i,E=-s,x=t+c*i,P=r+(1-u-m)*s,b=t+(c+h)*i,I=r+(1-u)*s;break;case 90:M=Le._rescaleAndSwap,v=t,C=r,T=i,E=s,x=t+u*i,P=r+c*s,b=t+(u+m)*i,I=r+(c+h)*s;break;case 180:M=Le._rescale,v=t+i,C=r,T=-i,E=s,x=t+(1-c-h)*i,P=r+u*s,b=t+(1-c)*i,I=r+(u+m)*s;break;case 270:M=Le._rescaleAndSwap,v=t+i,C=r+s,T=-i,E=-s,x=t+(1-u-m)*i,P=r+(1-c-h)*s,b=t+(1-u)*i,I=r+(1-c)*s;break}for(const{line:N,points:D}of f(this,ui))a.push(M(N,v,C,T,E,o?new Array(N.length):null)),l.push(M(D,v,C,T,E,o?new Array(D.length):null));return{lines:a,points:l,rect:[x,P,b,I]}}static deserialize(t,r,i,s,o,{paths:{lines:a,points:l},rotation:c,thickness:u}){const h=[];let m,v,C,T,E;switch(c){case 0:E=Le._rescale,m=-t/i,v=r/s+1,C=1/i,T=-1/s;break;case 90:E=Le._rescaleAndSwap,m=-r/s,v=-t/i,C=1/s,T=1/i;break;case 180:E=Le._rescale,m=t/i+1,v=-r/s,C=-1/i,T=1/s;break;case 270:E=Le._rescaleAndSwap,m=r/s+1,v=t/i+1,C=-1/s,T=-1/i;break}if(!a){a=[];for(const P of l){const b=P.length;if(b===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,P[0],P[1]]));continue}if(b===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,P[0],P[1],NaN,NaN,NaN,NaN,P[2],P[3]]));continue}const I=new Float32Array(3*(b-2));a.push(I);let[M,N,D,j]=P.subarray(0,4);I.set([NaN,NaN,NaN,NaN,M,N],0);for(let F=4;F<b;F+=2){const z=P[F],W=P[F+1];I.set(Le.createBezierPoints(M,N,D,j,z,W),(F-2)*3),[M,N,D,j]=[D,j,z,W]}}}for(let P=0,b=a.length;P<b;P++)h.push({line:E(a[P].map(I=>I??NaN),m,v,C,T),points:E(l[P].map(I=>I??NaN),m,v,C,T)});const x=new this.prototype.constructor;return x.build(h,i,s,1,c,u,o),x}get box(){return f(this,mr)}updateProperty(t,r){return t==="stroke-width"?B(this,Gn,_4).call(this,r):null}updateParentDimensions([t,r],i){const[s,o]=B(this,Gn,To).call(this);_(this,Ys,t),_(this,Js,r),_(this,mp,i);const[a,l]=B(this,Gn,To).call(this),c=a-s,u=l-o,h=f(this,mr);return h[0]-=c,h[1]-=u,h[2]+=2*c,h[3]+=2*u,h}updateRotation(t){return _(this,OS,t),{path:{transform:this.rotationTransform}}}get viewBox(){return f(this,mr).map(Le.svgRound).join(" ")}get defaultProperties(){const[t,r]=f(this,mr);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Le.svgRound(t)} ${Le.svgRound(r)}`}}}get rotationTransform(){const[,,t,r]=f(this,mr);let i=0,s=0,o=0,a=0,l=0,c=0;switch(f(this,OS)){case 90:s=r/t,o=-t/r,l=t;break;case 180:i=-1,a=-1,l=t,c=r;break;case 270:s=-r/t,o=t/r,c=r;break;default:return""}return`matrix(${i} ${s} ${o} ${a} ${Le.svgRound(l)} ${Le.svgRound(c)})`}getPathResizingSVGProperties([t,r,i,s]){const[o,a]=B(this,Gn,To).call(this),[l,c,u,h]=f(this,mr);if(Math.abs(u-o)<=Le.PRECISION||Math.abs(h-a)<=Le.PRECISION){const E=t+i/2-(l+u/2),x=r+s/2-(c+h/2);return{path:{"transform-origin":`${Le.svgRound(t)} ${Le.svgRound(r)}`,transform:`${this.rotationTransform} translate(${E} ${x})`}}}const m=(i-2*o)/(u-2*o),v=(s-2*a)/(h-2*a),C=u/i,T=h/s;return{path:{"transform-origin":`${Le.svgRound(l)} ${Le.svgRound(c)}`,transform:`${this.rotationTransform} scale(${C} ${T}) translate(${Le.svgRound(o)} ${Le.svgRound(a)}) scale(${m} ${v}) translate(${Le.svgRound(-o)} ${Le.svgRound(-a)})`}}}getPathResizedSVGProperties([t,r,i,s]){const[o,a]=B(this,Gn,To).call(this),l=f(this,mr),[c,u,h,m]=l;if(l[0]=t,l[1]=r,l[2]=i,l[3]=s,Math.abs(h-o)<=Le.PRECISION||Math.abs(m-a)<=Le.PRECISION){const x=t+i/2-(c+h/2),P=r+s/2-(u+m/2);for(const{line:b,points:I}of f(this,ui))Le._translate(b,x,P,b),Le._translate(I,x,P,I);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Le.svgRound(t)} ${Le.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(i-2*o)/(h-2*o),C=(s-2*a)/(m-2*a),T=-v*(c+o)+t+o,E=-C*(u+a)+r+a;if(v!==1||C!==1||T!==0||E!==0)for(const{line:x,points:P}of f(this,ui))Le._rescale(x,T,E,v,C,x),Le._rescale(P,T,E,v,C,P);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Le.svgRound(t)} ${Le.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,r],i){const[s,o]=i,a=f(this,mr),l=t-a[0],c=r-a[1];if(f(this,Ys)===s&&f(this,Js)===o)for(const{line:u,points:h}of f(this,ui))Le._translate(u,l,c,u),Le._translate(h,l,c,h);else{const u=f(this,Ys)/s,h=f(this,Js)/o;_(this,Ys,s),_(this,Js,o);for(const{line:m,points:v}of f(this,ui))Le._rescale(m,l,c,u,h,m),Le._rescale(v,l,c,u,h,v);a[2]*=u,a[3]*=h}return a[0]=t,a[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Le.svgRound(t)} ${Le.svgRound(r)}`}}}get defaultSVGProperties(){const t=f(this,mr);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Le.svgRound(t[0])} ${Le.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}mr=new WeakMap,OS=new WeakMap,BS=new WeakMap,ui=new WeakMap,Ys=new WeakMap,Js=new WeakMap,mp=new WeakMap,gp=new WeakMap,Vu=new WeakMap,Gn=new WeakSet,To=function(t=f(this,Vu)){const r=f(this,BS)+t/2*f(this,mp);return f(this,gp)%180===0?[r/f(this,Ys),r/f(this,Js)]:[r/f(this,Js),r/f(this,Ys)]},R4=function(){const[t,r,i,s]=f(this,mr),[o,a]=B(this,Gn,To).call(this,0);return[t+o,r+a,i-2*o,s-2*a]},I4=function(){const t=_(this,mr,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of f(this,ui)){if(s.length<=12){for(let l=4,c=s.length;l<c;l+=6)ke.pointBoundingBox(s[l],s[l+1],t);continue}let o=s[4],a=s[5];for(let l=6,c=s.length;l<c;l+=6){const[u,h,m,v,C,T]=s.subarray(l,l+6);ke.bezierBoundingBox(o,a,u,h,m,v,C,T,t),o=C,a=T}}const[r,i]=B(this,Gn,To).call(this);t[0]=Sr(t[0]-r,0,1),t[1]=Sr(t[1]-i,0,1),t[2]=Sr(t[2]+r,0,1),t[3]=Sr(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},_4=function(t){const[r,i]=B(this,Gn,To).call(this);_(this,Vu,t);const[s,o]=B(this,Gn,To).call(this),[a,l]=[s-r,o-i],c=f(this,mr);return c[0]-=a,c[1]-=l,c[2]+=2*a,c[3]+=2*l,c};class lT extends b4{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Ut._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new lT(this._viewParameters);return e.updateAll(this),e}}var YA,k4;const qd=class qd extends bA{constructor(t){super({...t,name:"inkEditor"});L(this,YA);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,r){Ut.initialize(t,r),this._defaultDrawingOptions=new lT(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ye(this,"typesMap",new Map([[ut.INK_THICKNESS,"stroke-width"],[ut.INK_COLOR,"stroke"],[ut.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,r,i,s,o){return new gH(t,r,i,s,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,r,i,s,o,a){return GS.deserialize(t,r,i,s,o,a)}static async deserialize(t,r,i){let s=null;if(t instanceof oR){const{data:{inkLists:a,rect:l,rotation:c,id:u,color:h,opacity:m,borderStyle:{rawWidth:v},popupRef:C,richText:T,contentsObj:E,creationDate:x,modificationDate:P},parent:{page:{pageNumber:b}}}=t;s=t={annotationType:Xe.INK,color:Array.from(h),thickness:v,opacity:m,paths:{points:a},boxes:null,pageIndex:b-1,rect:l.slice(0),rotation:c,annotationElementId:u,id:u,deleted:!1,popupRef:C,richText:T,comment:(E==null?void 0:E.str)||null,creationDate:x,modificationDate:P}}const o=await super.deserialize(t,r,i);return o._initialData=s,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new TA(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ut.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:r,parent:i}=this;r.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,r.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:r,opacity:i}){this._drawingOptions=qd.getDefaultDrawingOptions({stroke:ke.makeHexColor(...t),"stroke-width":r,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:r,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":o,"stroke-width":a}}=this,l=Object.assign(super.serialize(t),{color:Ut._colorManager.convert(s),opacity:o,thickness:a,paths:{lines:r,points:i}});return this.addComment(l),t?(l.isCopy=!0,l):this.annotationElementId&&!B(this,YA,k4).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:r,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:r,popup:this.comment}),null}};YA=new WeakSet,k4=function(t){const{color:r,thickness:i,opacity:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((a,l)=>a!==r[l])||t.thickness!==i||t.opacity!==s||t.pageIndex!==o},q(qd,"_type","ink"),q(qd,"_editorType",Xe.INK),q(qd,"_defaultDrawingOptions",null);let oP=qd;class aP extends GS{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const TC=8,uv=3;var $u,Ct,lP,us,M4,N4,cP,oA,L4,D4,O4,uP,dP,B4;class oa{static extractContoursFromText(e,{fontFamily:t,fontStyle:r,fontWeight:i},s,o,a,l){let c=new OffscreenCanvas(1,1),u=c.getContext("2d",{alpha:!1});const h=200,m=u.font=`${r} ${i} ${h}px ${t}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:C,actualBoundingBoxAscent:T,actualBoundingBoxDescent:E,fontBoundingBoxAscent:x,fontBoundingBoxDescent:P,width:b}=u.measureText(e),I=1.5,M=Math.ceil(Math.max(Math.abs(v)+Math.abs(C)||0,b)*I),N=Math.ceil(Math.max(Math.abs(T)+Math.abs(E)||h,Math.abs(x)+Math.abs(P)||h)*I);c=new OffscreenCanvas(M,N),u=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),u.font=m,u.filter="grayscale(1)",u.fillStyle="white",u.fillRect(0,0,M,N),u.fillStyle="black",u.fillText(e,M*(I-1)/2,N*(3-I)/2);const D=B(this,Ct,uP).call(this,u.getImageData(0,0,M,N).data),j=B(this,Ct,O4).call(this,D),F=B(this,Ct,dP).call(this,j),z=B(this,Ct,cP).call(this,D,M,N,F);return this.processDrawnLines({lines:{curves:z,width:M,height:N},pageWidth:s,pageHeight:o,rotation:a,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,r,i,s){const[o,a,l]=B(this,Ct,B4).call(this,e),[c,u]=B(this,Ct,D4).call(this,o,a,l,Math.hypot(a,l)*f(this,$u).sigmaSFactor,f(this,$u).sigmaR,f(this,$u).kernelSize),h=B(this,Ct,dP).call(this,u),m=B(this,Ct,cP).call(this,c,a,l,h);return this.processDrawnLines({lines:{curves:m,width:a,height:l},pageWidth:t,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:o,areContours:a}){i%180!==0&&([t,r]=[r,t]);const{curves:l,width:c,height:u}=e,h=e.thickness??0,m=[],v=Math.min(t/c,r/u),C=v/t,T=v/r,E=[];for(const{points:P}of l){const b=o?B(this,Ct,L4).call(this,P):P;if(!b)continue;E.push(b);const I=b.length,M=new Float32Array(I),N=new Float32Array(3*(I===2?2:I-2));if(m.push({line:N,points:M}),I===2){M[0]=b[0]*C,M[1]=b[1]*T,N.set([NaN,NaN,NaN,NaN,M[0],M[1]],0);continue}let[D,j,F,z]=b;D*=C,j*=T,F*=C,z*=T,M.set([D,j,F,z],0),N.set([NaN,NaN,NaN,NaN,D,j],0);for(let W=4;W<I;W+=2){const H=M[W]=b[W]*C,V=M[W+1]=b[W+1]*T;N.set(Le.createBezierPoints(D,j,F,z,H,V),(W-2)*3),[D,j,F,z]=[F,z,H,V]}}if(m.length===0)return null;const x=a?new aP:new GS;return x.build(m,t,r,1,i,a?0:h,s),{outline:x,newCurves:E,areContours:a,thickness:h,width:c,height:u}}static async compressSignature({outlines:e,areContours:t,thickness:r,width:i,height:s}){let o=1/0,a=-1/0,l=0;for(const b of e){l+=b.length;for(let I=2,M=b.length;I<M;I++){const N=b[I]-b[I-2];o=Math.min(o,N),a=Math.max(a,N)}}let c;o>=-128&&a<=127?c=Int8Array:o>=-32768&&a<=32767?c=Int16Array:c=Int32Array;const u=e.length,h=TC+uv*u,m=new Uint32Array(h);let v=0;m[v++]=h*Uint32Array.BYTES_PER_ELEMENT+(l-2*u)*c.BYTES_PER_ELEMENT,m[v++]=0,m[v++]=i,m[v++]=s,m[v++]=t?0:1,m[v++]=Math.max(0,Math.floor(r??0)),m[v++]=u,m[v++]=c.BYTES_PER_ELEMENT;for(const b of e)m[v++]=b.length-2,m[v++]=b[0],m[v++]=b[1];const C=new CompressionStream("deflate-raw"),T=C.writable.getWriter();await T.ready,T.write(m);const E=c.prototype.constructor;for(const b of e){const I=new E(b.length-2);for(let M=2,N=b.length;M<N;M++)I[M-2]=b[M]-b[M-2];T.write(I)}T.close();const x=await new Response(C.readable).arrayBuffer(),P=new Uint8Array(x);return DF(P)}static async decompressSignature(e){try{const t=kV(e),{readable:r,writable:i}=new DecompressionStream("deflate-raw"),s=i.getWriter();await s.ready,s.write(t).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let o=null,a=0;for await(const b of r)o||(o=new Uint8Array(new Uint32Array(b.buffer,0,4)[0])),o.set(b,a),a+=b.length;const l=new Uint32Array(o.buffer,0,o.length>>2),c=l[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const u=l[2],h=l[3],m=l[4]===0,v=l[5],C=l[6],T=l[7],E=[],x=(TC+uv*C)*Uint32Array.BYTES_PER_ELEMENT;let P;switch(T){case Int8Array.BYTES_PER_ELEMENT:P=new Int8Array(o.buffer,x);break;case Int16Array.BYTES_PER_ELEMENT:P=new Int16Array(o.buffer,x);break;case Int32Array.BYTES_PER_ELEMENT:P=new Int32Array(o.buffer,x);break}a=0;for(let b=0;b<C;b++){const I=l[uv*b+TC],M=new Float32Array(I+2);E.push(M);for(let N=0;N<uv-1;N++)M[N]=l[uv*b+TC+N+1];for(let N=0;N<I;N++)M[N+2]=M[N]+P[a++]}return{areContours:m,thickness:v,outlines:E,width:u,height:h}}catch(t){return Ze(`decompressSignature: ${t}`),null}}}$u=new WeakMap,Ct=new WeakSet,lP=function(e,t,r,i){return r-=e,i-=t,r===0?i>0?0:4:r===1?i+6:2-i},us=new WeakMap,M4=function(e,t,r,i,s,o,a){const l=B(this,Ct,lP).call(this,r,i,s,o);for(let c=0;c<8;c++){const u=(-c+l-a+16)%8,h=f(this,us)[2*u],m=f(this,us)[2*u+1];if(e[(r+h)*t+(i+m)]!==0)return u}return-1},N4=function(e,t,r,i,s,o,a){const l=B(this,Ct,lP).call(this,r,i,s,o);for(let c=0;c<8;c++){const u=(c+l+a+16)%8,h=f(this,us)[2*u],m=f(this,us)[2*u+1];if(e[(r+h)*t+(i+m)]!==0)return u}return-1},cP=function(e,t,r,i){const s=e.length,o=new Int32Array(s);for(let u=0;u<s;u++)o[u]=e[u]<=i?1:0;for(let u=1;u<r-1;u++)o[u*t]=o[u*t+t-1]=0;for(let u=0;u<t;u++)o[u]=o[t*r-1-u]=0;let a=1,l;const c=[];for(let u=1;u<r-1;u++){l=1;for(let h=1;h<t-1;h++){const m=u*t+h,v=o[m];if(v===0)continue;let C=u,T=h;if(v===1&&o[m-1]===0)a+=1,T-=1;else if(v>=1&&o[m+1]===0)a+=1,T+=1,v>1&&(l=v);else{v!==1&&(l=Math.abs(v));continue}const E=[h,u],x=T===h+1,P={isHole:x,points:E,id:a,parent:0};c.push(P);let b;for(const W of c)if(W.id===l){b=W;break}b?b.isHole?P.parent=x?b.parent:l:P.parent=x?l:b.parent:P.parent=x?l:0;const I=B(this,Ct,M4).call(this,o,t,u,h,C,T,0);if(I===-1){o[m]=-a,o[m]!==1&&(l=Math.abs(o[m]));continue}let M=f(this,us)[2*I],N=f(this,us)[2*I+1];const D=u+M,j=h+N;C=D,T=j;let F=u,z=h;for(;;){const W=B(this,Ct,N4).call(this,o,t,F,z,C,T,1);M=f(this,us)[2*W],N=f(this,us)[2*W+1];const H=F+M,V=z+N;E.push(V,H);const K=F*t+z;if(o[K+1]===0?o[K]=-a:o[K]===1&&(o[K]=a),H===u&&V===h&&F===D&&z===j){o[m]!==1&&(l=Math.abs(o[m]));break}else C=F,T=z,F=H,z=V}}}return c},oA=function(e,t,r,i){if(r-t<=4){for(let D=t;D<r-2;D+=2)i.push(e[D],e[D+1]);return}const s=e[t],o=e[t+1],a=e[r-4]-s,l=e[r-3]-o,c=Math.hypot(a,l),u=a/c,h=l/c,m=u*o-h*s,v=l/a,C=1/c,T=Math.atan(v),E=Math.cos(T),x=Math.sin(T),P=C*(Math.abs(E)+Math.abs(x)),b=C*(1-P+P**2),I=Math.max(Math.atan(Math.abs(x+E)*b),Math.atan(Math.abs(x-E)*b));let M=0,N=t;for(let D=t+2;D<r-2;D+=2){const j=Math.abs(m-u*e[D+1]+h*e[D]);j>M&&(N=D,M=j)}M>(c*I)**2?(B(this,Ct,oA).call(this,e,t,N+2,i),B(this,Ct,oA).call(this,e,N,r,i)):i.push(s,o)},L4=function(e){const t=[],r=e.length;return B(this,Ct,oA).call(this,e,0,r,t),t.push(e[r-2],e[r-1]),t.length<=4?null:t},D4=function(e,t,r,i,s,o){const a=new Float32Array(o**2),l=-2*i**2,c=o>>1;for(let T=0;T<o;T++){const E=(T-c)**2;for(let x=0;x<o;x++)a[T*o+x]=Math.exp((E+(x-c)**2)/l)}const u=new Float32Array(256),h=-2*s**2;for(let T=0;T<256;T++)u[T]=Math.exp(T**2/h);const m=e.length,v=new Uint8Array(m),C=new Uint32Array(256);for(let T=0;T<r;T++)for(let E=0;E<t;E++){const x=T*t+E,P=e[x];let b=0,I=0;for(let N=0;N<o;N++){const D=T+N-c;if(!(D<0||D>=r))for(let j=0;j<o;j++){const F=E+j-c;if(F<0||F>=t)continue;const z=e[D*t+F],W=a[N*o+j]*u[Math.abs(z-P)];b+=z*W,I+=W}}const M=v[x]=Math.round(b/I);C[M]++}return[v,C]},O4=function(e){const t=new Uint32Array(256);for(const r of e)t[r]++;return t},uP=function(e){const t=e.length,r=new Uint8ClampedArray(t>>2);let i=-1/0,s=1/0;for(let a=0,l=r.length;a<l;a++){const c=r[a]=e[a<<2];i=Math.max(i,c),s=Math.min(s,c)}const o=255/(i-s);for(let a=0,l=r.length;a<l;a++)r[a]=(r[a]-s)*o;return r},dP=function(e){let t,r=-1/0,i=-1/0;const s=e.findIndex(l=>l!==0);let o=s,a=s;for(t=s;t<256;t++){const l=e[t];l>r&&(t-o>i&&(i=t-o,a=t-1),r=l,o=t)}for(t=a-1;t>=0&&!(e[t]>e[t+1]);t--);return t},B4=function(e){const t=e,{width:r,height:i}=e,{maxDim:s}=f(this,$u);let o=r,a=i;if(r>s||i>s){let m=r,v=i,C=Math.log2(Math.max(r,i)/s);const T=Math.floor(C);C=C===T?T-1:T;for(let x=0;x<C;x++){o=Math.ceil(m/2),a=Math.ceil(v/2);const P=new OffscreenCanvas(o,a);P.getContext("2d").drawImage(e,0,0,m,v,0,0,o,a),m=o,v=a,e!==t&&e.close(),e=P.transferToImageBitmap()}const E=Math.min(s/o,s/a);o=Math.round(o*E),a=Math.round(a*E)}const c=new OffscreenCanvas(o,a).getContext("2d",{willReadFrequently:!0});c.fillStyle="white",c.fillRect(0,0,o,a),c.filter="grayscale(1)",c.drawImage(e,0,0,e.width,e.height,0,0,o,a);const u=c.getImageData(0,0,o,a).data;return[B(this,Ct,uP).call(this,u),o,a]},L(oa,Ct),L(oa,$u,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),L(oa,us,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class aR extends b4{constructor(){super(),super.updateProperties({fill:Ut._defaultLineColor,"stroke-width":0})}clone(){const e=new aR;return e.updateAll(this),e}}class lR extends lT{constructor(e){super(e),super.updateProperties({stroke:Ut._defaultLineColor,"stroke-width":1})}clone(){const e=new lR(this._viewParameters);return e.updateAll(this),e}}var Il,Xs,_l,Hu;const Zr=class Zr extends bA{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});L(this,Il,!1);L(this,Xs,null);L(this,_l,null);L(this,Hu,null);this._willKeepAspectRatio=!0,_(this,_l,t.signatureData||null),_(this,Xs,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,r){Ut.initialize(t,r),this._defaultDrawingOptions=new aR,this._defaultDrawnSignatureOptions=new lR(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ye(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!f(this,Xs)}}static computeTelemetryFinalData(t){const r=t.get("hasDescription");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,r;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,r=this.y),super.render(),this._drawId===null)if(f(this,_l)){const{lines:s,mustSmooth:o,areContours:a,description:l,uuid:c,heightInPage:u}=f(this,_l),{rawDims:{pageWidth:h,pageHeight:m},rotation:v}=this.parent.viewport,C=oa.processDrawnLines({lines:s,pageWidth:h,pageHeight:m,rotation:v,innerMargin:Zr._INNER_MARGIN,mustSmooth:o,areContours:a});this.addSignature(C,u,l,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:f(this,Xs)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,r)),this.div}setUuid(t){_(this,Hu,t),this.addEditToolbar()}getUuid(){return f(this,Hu)}get description(){return f(this,Xs)}set description(t){_(this,Xs,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(r=>{r==null||r.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:r,thickness:i,width:s,height:o}=f(this,_l),a=Math.max(s,o),l=oa.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:i,width:s,height:o},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:r});return{areContours:r,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,r,i,s){const{x:o,y:a}=this,{outline:l}=_(this,_l,t);_(this,Il,l instanceof aP),this.description=i;let c;f(this,Il)?c=Zr.getDefaultDrawingOptions():(c=Zr._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:c});const[,u]=this.pageDimensions;let h=r/u;h=h>=1?.5:h,this.width*=h/this.height,this.width>=1&&(h*=.9/this.width,this.width=.9),this.height=h,this.setDims(),this.x=o,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return oa.process(t,r,i,s,Zr._INNER_MARGIN)}getFromText(t,r){const{rawDims:{pageWidth:i,pageHeight:s},rotation:o}=this.parent.viewport;return oa.extractContoursFromText(t,r,i,s,o,Zr._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return oa.processDrawnLines({lines:t,pageWidth:r,pageHeight:i,rotation:s,innerMargin:Zr._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:r}){t?this._drawingOptions=Zr.getDefaultDrawingOptions():(this._drawingOptions=Zr._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":r}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:r,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:f(this,Il),color:[0,0,0],thickness:f(this,Il)?0:s});return this.addComment(o),t?(o.paths={lines:r,points:i},o.uuid=f(this,Hu),o.isCopy=!0):o.lines=r,f(this,Xs)&&(o.accessibilityData={type:"Figure",alt:f(this,Xs)}),o}static deserializeDraw(t,r,i,s,o,a){return a.areContours?aP.deserialize(t,r,i,s,o,a):GS.deserialize(t,r,i,s,o,a)}static async deserialize(t,r,i){var o;const s=await super.deserialize(t,r,i);return _(s,Il,t.areContours),s.description=((o=t.accessibilityData)==null?void 0:o.alt)||"",_(s,Hu,t.uuid),s}};Il=new WeakMap,Xs=new WeakMap,_l=new WeakMap,Hu=new WeakMap,q(Zr,"_type","signature"),q(Zr,"_editorType",Xe.SIGNATURE),q(Zr,"_defaultDrawingOptions",null);let hP=Zr;var qt,On,kl,ta,Ml,vp,na,Zu,Qs,di,yp,mt,Dv,Ov,aA,lA,cA,fP,uA,F4;class pP extends Ut{constructor(t){super({...t,name:"stampEditor"});L(this,mt);L(this,qt,null);L(this,On,null);L(this,kl,null);L(this,ta,null);L(this,Ml,null);L(this,vp,"");L(this,na,null);L(this,Zu,!1);L(this,Qs,null);L(this,di,!1);L(this,yp,!1);_(this,ta,t.bitmapUrl),_(this,Ml,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,r){Ut.initialize(t,r)}static isHandlingMimeForPasting(t){return Xw.includes(t)}static paste(t,r){r.pasteEditor({mode:Xe.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const r=t.get("hasAltText");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}async mlGuessAltText(t=null,r=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:s,width:o,height:a,channels:s.length/(o*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),r&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;f(this,On)&&(_(this,qt,null),this._uiManager.imageManager.deleteId(f(this,On)),(t=f(this,na))==null||t.remove(),_(this,na,null),f(this,Qs)&&(clearTimeout(f(this,Qs)),_(this,Qs,null))),super.remove()}rebuild(){if(!this.parent){f(this,On)&&B(this,mt,aA).call(this);return}super.rebuild(),this.div!==null&&(f(this,On)&&f(this,na)===null&&B(this,mt,aA).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(f(this,kl)||f(this,qt)||f(this,ta)||f(this,Ml)||f(this,On)||f(this,Zu))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,r;return this._isCopy&&(t=this.x,r=this.y),super.render(),this.div.hidden=!0,this.createAltText(),f(this,Zu)||(f(this,qt)?B(this,mt,lA).call(this):B(this,mt,aA).call(this)),this._isCopy&&this._moveAfterPaste(t,r),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,r){const{id:i,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,r);r.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(_(this,On,i),s&&_(this,qt,s),_(this,Zu,!1),B(this,mt,lA).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;f(this,Qs)!==null&&clearTimeout(f(this,Qs)),_(this,Qs,setTimeout(()=>{_(this,Qs,null),B(this,mt,fP).call(this)},200))}copyCanvas(t,r,i=!1){t||(t=224);const{width:s,height:o}=f(this,qt),a=new to;let l=f(this,qt),c=s,u=o,h=null;if(r){if(s>r||o>r){const D=Math.min(r/s,r/o);c=Math.floor(s*D),u=Math.floor(o*D)}h=document.createElement("canvas");const v=h.width=Math.ceil(c*a.sx),C=h.height=Math.ceil(u*a.sy);f(this,di)||(l=B(this,mt,cA).call(this,v,C));const T=h.getContext("2d");T.filter=this._uiManager.hcmFilter;let E="white",x="#cfcfd8";this._uiManager.hcmFilter!=="none"?x="black":BV.isDarkMode&&(E="#8f8f9d",x="#42414d");const P=15,b=P*a.sx,I=P*a.sy,M=new OffscreenCanvas(b*2,I*2),N=M.getContext("2d");N.fillStyle=E,N.fillRect(0,0,b*2,I*2),N.fillStyle=x,N.fillRect(0,0,b,I),N.fillRect(b,I,b,I),T.fillStyle=T.createPattern(M,"repeat"),T.fillRect(0,0,v,C),T.drawImage(l,0,0,l.width,l.height,0,0,v,C)}let m=null;if(i){let v,C;if(a.symmetric&&l.width<t&&l.height<t)v=l.width,C=l.height;else if(l=f(this,qt),s>t||o>t){const x=Math.min(t/s,t/o);v=Math.floor(s*x),C=Math.floor(o*x),f(this,di)||(l=B(this,mt,cA).call(this,v,C))}const E=new OffscreenCanvas(v,C).getContext("2d",{willReadFrequently:!0});E.drawImage(l,0,0,l.width,l.height,0,0,v,C),m={width:v,height:C,data:E.getImageData(0,0,v,C).data}}return{canvas:h,width:c,height:u,imageData:m}}static async deserialize(t,r,i){var E;let s=null,o=!1;if(t instanceof e4){const{data:{rect:x,rotation:P,id:b,structParent:I,popupRef:M,richText:N,contentsObj:D,creationDate:j,modificationDate:F},container:z,parent:{page:{pageNumber:W}},canvas:H}=t;let V,K;H?(delete t.canvas,{id:V,bitmap:K}=i.imageManager.getFromCanvas(z.id,H),H.remove()):(o=!0,t._hasNoCanvas=!0);const ee=((E=await r._structTree.getAriaAttributes(`${Ud}${b}`))==null?void 0:E.get("aria-label"))||"";s=t={annotationType:Xe.STAMP,bitmapId:V,bitmap:K,pageIndex:W-1,rect:x.slice(0),rotation:P,annotationElementId:b,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:ee},isSvg:!1,structParent:I,popupRef:M,richText:N,comment:(D==null?void 0:D.str)||null,creationDate:j,modificationDate:F}}const a=await super.deserialize(t,r,i),{rect:l,bitmap:c,bitmapUrl:u,bitmapId:h,isSvg:m,accessibilityData:v}=t;o?(i.addMissingCanvas(t.id,a),_(a,Zu,!0)):h&&i.imageManager.isValidId(h)?(_(a,On,h),c&&_(a,qt,c)):_(a,ta,u),_(a,di,m);const[C,T]=a.pageDimensions;return a.width=(l[2]-l[0])/C,a.height=(l[3]-l[1])/T,v&&(a.altTextData=v),a._initialData=s,t.comment&&a.setCommentData(t),_(a,yp,!!s),a}serialize(t=!1,r=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:f(this,On),isSvg:f(this,di)});if(this.addComment(i),t)return i.bitmapUrl=B(this,mt,uA).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const l=B(this,mt,F4).call(this,i);return l.isSame?null:(l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(r===null)return i;r.stamps||(r.stamps=new Map);const a=f(this,di)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!r.stamps.has(f(this,On)))r.stamps.set(f(this,On),{area:a,serialized:i}),i.bitmap=B(this,mt,uA).call(this,!1);else if(f(this,di)){const l=r.stamps.get(f(this,On));a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=B(this,mt,uA).call(this,!1))}return i}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}qt=new WeakMap,On=new WeakMap,kl=new WeakMap,ta=new WeakMap,Ml=new WeakMap,vp=new WeakMap,na=new WeakMap,Zu=new WeakMap,Qs=new WeakMap,di=new WeakMap,yp=new WeakMap,mt=new WeakSet,Dv=function(t,r=!1){if(!t){this.remove();return}_(this,qt,t.bitmap),r||(_(this,On,t.id),_(this,di,t.isSvg)),t.file&&_(this,vp,t.file.name),B(this,mt,lA).call(this)},Ov=function(){if(_(this,kl,null),this._uiManager.enableWaiting(!1),!!f(this,na)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&f(this,qt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&f(this,qt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},aA=function(){if(f(this,On)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(f(this,On)).then(i=>B(this,mt,Dv).call(this,i,!0)).finally(()=>B(this,mt,Ov).call(this));return}if(f(this,ta)){const i=f(this,ta);_(this,ta,null),this._uiManager.enableWaiting(!0),_(this,kl,this._uiManager.imageManager.getFromUrl(i).then(s=>B(this,mt,Dv).call(this,s)).finally(()=>B(this,mt,Ov).call(this)));return}if(f(this,Ml)){const i=f(this,Ml);_(this,Ml,null),this._uiManager.enableWaiting(!0),_(this,kl,this._uiManager.imageManager.getFromFile(i).then(s=>B(this,mt,Dv).call(this,s)).finally(()=>B(this,mt,Ov).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Xw.join(",");const r=this._uiManager._signal;_(this,kl,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),B(this,mt,Dv).call(this,s)}i()},{signal:r}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:r})}).finally(()=>B(this,mt,Ov).call(this))),t.click()},lA=function(){var c;const{div:t}=this;let{width:r,height:i}=f(this,qt);const[s,o]=this.pageDimensions,a=.75;if(this.width)r=this.width*s,i=this.height*o;else if(r>a*s||i>a*o){const u=Math.min(a*s/r,a*o/i);r*=u,i*=u}this._uiManager.enableWaiting(!1);const l=_(this,na,document.createElement("canvas"));l.setAttribute("role","img"),this.addContainer(l),this.width=r/s,this.height=i/o,this.setDims(),(c=this._initialOptions)!=null&&c.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),B(this,mt,fP).call(this),f(this,yp)||(this.parent.addUndoableEditor(this),_(this,yp,!0)),this._reportTelemetry({action:"inserted_image"}),f(this,vp)&&this.div.setAttribute("aria-description",f(this,vp)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},cA=function(t,r){const{width:i,height:s}=f(this,qt);let o=i,a=s,l=f(this,qt);for(;o>2*t||a>2*r;){const c=o,u=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*r&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const h=new OffscreenCanvas(o,a);h.getContext("2d").drawImage(l,0,0,c,u,0,0,o,a),l=h.transferToImageBitmap()}return l},fP=function(){const[t,r]=this.parentDimensions,{width:i,height:s}=this,o=new to,a=Math.ceil(i*t*o.sx),l=Math.ceil(s*r*o.sy),c=f(this,na);if(!c||c.width===a&&c.height===l)return;c.width=a,c.height=l;const u=f(this,di)?f(this,qt):B(this,mt,cA).call(this,a,l),h=c.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(u,0,0,u.width,u.height,0,0,a,l)},uA=function(t){if(t){if(f(this,di)){const s=this._uiManager.imageManager.getSvgUrl(f(this,On));if(s)return s}const r=document.createElement("canvas");return{width:r.width,height:r.height}=f(this,qt),r.getContext("2d").drawImage(f(this,qt),0,0),r.toDataURL()}if(f(this,di)){const[r,i]=this.pageDimensions,s=Math.round(this.width*r*zl.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*zl.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(s,o);return a.getContext("2d").drawImage(f(this,qt),0,0,f(this,qt).width,f(this,qt).height,0,0,s,o),a.transferToImageBitmap()}return structuredClone(f(this,qt))},F4=function(t){var a;const{pageIndex:r,accessibilityData:{altText:i}}=this._initialData,s=t.pageIndex===r,o=(((a=t.accessibilityData)==null?void 0:a.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&o,isSameAltText:o}},q(pP,"_type","stamp"),q(pP,"_editorType",Xe.STAMP);var qu,Sp,Nl,Ll,ra,Or,Dl,Cp,Ap,ds,ia,Bn,sa,Ol,Tp,Fe,Bl,Lt,gP,j4,ks,vP,yP,dA;const es=class es{constructor({uiManager:e,pageIndex:t,div:r,structTreeLayer:i,accessibilityManager:s,annotationLayer:o,drawLayer:a,textLayer:l,viewport:c,l10n:u}){L(this,Lt);L(this,qu);L(this,Sp,!1);L(this,Nl,null);L(this,Ll,null);L(this,ra,null);L(this,Or,new Map);L(this,Dl,!1);L(this,Cp,!1);L(this,Ap,!1);L(this,ds,null);L(this,ia,null);L(this,Bn,null);L(this,sa,null);L(this,Ol,null);L(this,Tp,-1);L(this,Fe);const h=[...f(es,Bl).values()];if(!es._initialized){es._initialized=!0;for(const m of h)m.initialize(u,e)}e.registerEditorTypes(h),_(this,Fe,e),this.pageIndex=t,this.div=r,_(this,qu,s),_(this,Nl,o),this.viewport=c,_(this,Bn,l),this.drawLayer=a,this._structTree=i,f(this,Fe).addLayer(this)}get isEmpty(){return f(this,Or).size===0}get isInvisible(){return this.isEmpty&&f(this,Fe).getMode()===Xe.NONE}updateToolbar(e){f(this,Fe).updateToolbar(e)}updateMode(e=f(this,Fe).getMode()){switch(B(this,Lt,dA).call(this),e){case Xe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Xe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Xe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Xe.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const r of f(es,Bl).values())t.toggle(`${r._type}Editing`,e===r._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=f(this,Bn))==null?void 0:t.div)}setEditingState(e){f(this,Fe).setEditingState(e)}addCommands(e){f(this,Fe).addCommands(e)}cleanUndoStack(e){f(this,Fe).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=f(this,Nl))==null||t.togglePointerEvents(e)}async enable(){var r;_(this,Ap,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(r=f(this,Ol))==null||r.abort(),_(this,Ol,null);const e=new Set;for(const i of f(this,Lt,gP))i.enableEditing(),i.show(!0),i.annotationElementId&&(f(this,Fe).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const t=f(this,Nl);if(t)for(const i of t.getEditableAnnotations()){if(i.hide(),f(this,Fe).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}_(this,Ap,!1),f(this,Fe)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var i;if(_(this,Cp,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),f(this,Bn)&&!f(this,Ol)){_(this,Ol,new AbortController);const s=f(this,Fe).combinedSignal(f(this,Ol));f(this,Bn).div.addEventListener("pointerdown",o=>{const{clientX:l,clientY:c,timeStamp:u}=o,h=f(this,Tp);if(u-h>500){_(this,Tp,u);return}_(this,Tp,-1);const{classList:m}=this.div;m.toggle("getElements",!0);const v=document.elementsFromPoint(l,c);if(m.toggle("getElements",!1),!this.div.contains(v[0]))return;let C;const T=new RegExp(`^${zv}[0-9]+$`);for(const x of v)if(T.test(x.id)){C=x.id;break}if(!C)return;const E=f(this,Or).get(C);(E==null?void 0:E.annotationElementId)===null&&(o.stopPropagation(),o.preventDefault(),E.dblclick(o))},{signal:s,capture:!0})}const e=f(this,Nl),t=[];if(e){const s=new Map,o=new Map;for(const l of f(this,Lt,gP)){if(l.disableEditing(),!l.annotationElementId){t.push(l);continue}if(l.serialize()!==null){s.set(l.annotationElementId,l);continue}else o.set(l.annotationElementId,l);(i=this.getEditableAnnotation(l.annotationElementId))==null||i.show(),l.remove()}const a=e.getEditableAnnotations();for(const l of a){const{id:c}=l.data;if(f(this,Fe).isDeletedAnnotationElement(c)){l.updateEdited({deleted:!0});continue}let u=o.get(c);if(u){u.resetAnnotationElement(l),u.show(!1),l.show();continue}u=s.get(c),u&&(f(this,Fe).addChangedExistingAnnotation(u),u.renderAnnotationElement(l)&&u.show(!1)),l.show()}}B(this,Lt,dA).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const s of f(es,Bl).values())r.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),_(this,Cp,!1)}getEditableAnnotation(e){var t;return((t=f(this,Nl))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){f(this,Fe).getActive()!==e&&f(this,Fe).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=f(this,Bn))!=null&&e.div&&!f(this,sa)){_(this,sa,new AbortController);const t=f(this,Fe).combinedSignal(f(this,sa));f(this,Bn).div.addEventListener("pointerdown",B(this,Lt,j4).bind(this),{signal:t}),f(this,Bn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=f(this,Bn))!=null&&e.div&&f(this,sa)&&(f(this,sa).abort(),_(this,sa,null),f(this,Bn).div.classList.remove("highlighting"))}enableClick(){if(f(this,Ll))return;_(this,Ll,new AbortController);const e=f(this,Fe).combinedSignal(f(this,Ll));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=f(this,Ll))==null||e.abort(),_(this,Ll,null)}attach(e){f(this,Or).set(e.id,e);const{annotationElementId:t}=e;t&&f(this,Fe).isDeletedAnnotationElement(t)&&f(this,Fe).removeDeletedAnnotationElement(e)}detach(e){var t;f(this,Or).delete(e.id),(t=f(this,qu))==null||t.removePointerInTextLayer(e.contentDiv),!f(this,Cp)&&e.annotationElementId&&f(this,Fe).addDeletedAnnotationElement(e)}remove(e){this.detach(e),f(this,Fe).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(f(this,Fe).addDeletedAnnotationElement(e),Ut.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),f(this,Fe).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!f(this,Ap)),f(this,Fe).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var r;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!f(this,ra)&&(e._focusEventsAllowed=!1,_(this,ra,setTimeout(()=>{_(this,ra,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:f(this,Fe)._signal}),t.focus())},0))),e._structTreeParentId=(r=f(this,qu))==null?void 0:r.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),r=()=>{e.remove()};this.addCommands({cmd:t,undo:r,mustExec:!1})}getEditorByUID(e){for(const t of f(this,Or).values())if(t.uid===e)return t;return null}getNextId(){return f(this,Fe).getId()}combinedSignal(e){return f(this,Fe).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=f(this,Lt,ks))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await f(this,Fe).updateMode(e.mode);const{offsetX:r,offsetY:i}=B(this,Lt,yP).call(this),s=this.getNextId(),o=B(this,Lt,vP).call(this,{parent:this,id:s,x:r,y:i,uiManager:f(this,Fe),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=f(es,Bl).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,f(this,Fe)))||null}createAndAddNewEditor(e,t,r={}){const i=this.getNextId(),s=B(this,Lt,vP).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:f(this,Fe),isCentered:t,...r});return s&&this.add(s),s}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(B(this,Lt,yP).call(this),!0,e)}setSelected(e){f(this,Fe).setSelected(e)}toggleSelected(e){f(this,Fe).toggleSelected(e)}unselect(e){f(this,Fe).unselect(e)}pointerup(e){var i;const{isMac:t}=Pn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!f(this,Dl)||(_(this,Dl,!1),(i=f(this,Lt,ks))!=null&&i.isDrawer&&f(this,Lt,ks).supportMultipleDrawings))return;if(!f(this,Sp)){_(this,Sp,!0);return}const r=f(this,Fe).getMode();if(r===Xe.STAMP||r===Xe.SIGNATURE){f(this,Fe).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(f(this,Fe).getMode()===Xe.HIGHLIGHT&&this.enableTextSelection(),f(this,Dl)){_(this,Dl,!1);return}const{isMac:t}=Pn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(_(this,Dl,!0),(i=f(this,Lt,ks))!=null&&i.isDrawer){this.startDrawingSession(e);return}const r=f(this,Fe).getActive();_(this,Sp,!r||r.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),f(this,ds)){f(this,Lt,ks).startDrawing(this,f(this,Fe),!1,e);return}f(this,Fe).setCurrentDrawingSession(this),_(this,ds,new AbortController);const t=f(this,Fe).combinedSignal(f(this,ds));this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(_(this,ia,null),this.commitOrRemove())},{signal:t}),f(this,Lt,ks).startDrawing(this,f(this,Fe),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&_(this,ia,t);return}f(this,ia)&&setTimeout(()=>{var t;(t=f(this,ia))==null||t.focus(),_(this,ia,null)},0)}endDrawingSession(e=!1){return f(this,ds)?(f(this,Fe).setCurrentDrawingSession(null),f(this,ds).abort(),_(this,ds,null),_(this,ia,null),f(this,Lt,ks).endDrawing(e)):null}findNewParent(e,t,r){const i=f(this,Fe).findParent(t,r);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return f(this,ds)?(this.endDrawingSession(),!0):!1}onScaleChanging(){f(this,ds)&&f(this,Lt,ks).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=f(this,Fe).getActive())==null?void 0:e.parent)===this&&(f(this,Fe).commitOrRemove(),f(this,Fe).setActiveEditor(null)),f(this,ra)&&(clearTimeout(f(this,ra)),_(this,ra,null));for(const r of f(this,Or).values())(t=f(this,qu))==null||t.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,f(this,Or).clear(),f(this,Fe).removeLayer(this)}render({viewport:e}){this.viewport=e,Ku(this.div,e);for(const t of f(this,Fe).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){f(this,Fe).commitOrRemove(),B(this,Lt,dA).call(this);const t=this.viewport.rotation,r=e.rotation;if(this.viewport=e,Ku(this.div,{rotation:r}),t!==r)for(const i of f(this,Or).values())i.rotate(r)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return f(this,Fe).viewParameters.realScale}};qu=new WeakMap,Sp=new WeakMap,Nl=new WeakMap,Ll=new WeakMap,ra=new WeakMap,Or=new WeakMap,Dl=new WeakMap,Cp=new WeakMap,Ap=new WeakMap,ds=new WeakMap,ia=new WeakMap,Bn=new WeakMap,sa=new WeakMap,Ol=new WeakMap,Tp=new WeakMap,Fe=new WeakMap,Bl=new WeakMap,Lt=new WeakSet,gP=function(){return f(this,Or).size!==0?f(this,Or).values():f(this,Fe).getEditors(this.pageIndex)},j4=function(e){f(this,Fe).unselectAll();const{target:t}=e;if(t===f(this,Bn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&f(this,Bn).div.contains(t)){const{isMac:r}=Pn.platform;if(e.button!==0||e.ctrlKey&&r)return;f(this,Fe).showAllEditors("highlight",!0,!0),f(this,Bn).div.classList.add("free"),this.toggleDrawing(),wA.startHighlighting(this,f(this,Fe).direction==="ltr",{target:f(this,Bn).div,x:e.x,y:e.y}),f(this,Bn).div.addEventListener("pointerup",()=>{f(this,Bn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:f(this,Fe)._signal}),e.preventDefault()}},ks=function(){return f(es,Bl).get(f(this,Fe).getMode())},vP=function(e){const t=f(this,Lt,ks);return t?new t.prototype.constructor(e):null},yP=function(){const{x:e,y:t,width:r,height:i}=this.boundingClientRect,s=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+r),l=Math.min(window.innerHeight,t+i),c=(s+a)/2-e,u=(o+l)/2-t,[h,m]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:h,offsetY:m}},dA=function(){for(const e of f(this,Or).values())e.isEmpty()&&e.remove()},q(es,"_initialized",!1),L(es,Bl,new Map([Yb,oP,pP,wA,hP].map(e=>[e._editorType,e])));let mP=es;var hs,gr,Gu,FS,JA,U4,no,CP,z4,AP;const En=class En{constructor({pageIndex:e}){L(this,no);L(this,hs,null);L(this,gr,new Map);L(this,Gu,new Map);this.pageIndex=e}setParent(e){if(!f(this,hs)){_(this,hs,e);return}if(f(this,hs)!==e){if(f(this,gr).size>0)for(const t of f(this,gr).values())t.remove(),e.append(t);_(this,hs,e)}}static get _svgFactory(){return Ye(this,"_svgFactory",new EA)}draw(e,t=!1,r=!1){const i=An(En,FS)._++,s=B(this,no,CP).call(this),o=En._svgFactory.createElement("defs");s.append(o);const a=En._svgFactory.createElement("path");o.append(a);const l=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t&&f(this,Gu).set(i,a);const c=r?B(this,no,z4).call(this,o,l):null,u=En._svgFactory.createElement("use");return s.append(u),u.setAttribute("href",`#${l}`),this.updateProperties(s,e),f(this,gr).set(i,s),{id:i,clipPathId:`url(#${c})`}}drawOutline(e,t){const r=An(En,FS)._++,i=B(this,no,CP).call(this),s=En._svgFactory.createElement("defs");i.append(s);const o=En._svgFactory.createElement("path");s.append(o);const a=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const h=En._svgFactory.createElement("mask");s.append(h),l=`mask_p${this.pageIndex}_${r}`,h.setAttribute("id",l),h.setAttribute("maskUnits","objectBoundingBox");const m=En._svgFactory.createElement("rect");h.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const v=En._svgFactory.createElement("use");h.append(v),v.setAttribute("href",`#${a}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const c=En._svgFactory.createElement("use");i.append(c),c.setAttribute("href",`#${a}`),l&&c.setAttribute("mask",`url(#${l})`);const u=c.cloneNode();return i.append(u),c.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(i,e),f(this,gr).set(r,i),r}finalizeDraw(e,t){f(this,Gu).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:r,bbox:i,rootClass:s,path:o}=t,a=typeof e=="number"?f(this,gr).get(e):e;if(a){if(r&&B(this,no,AP).call(this,a,r),i&&B(l=En,JA,U4).call(l,a,i),s){const{classList:c}=a;for(const[u,h]of Object.entries(s))c.toggle(u,h)}if(o){const u=a.firstElementChild.firstElementChild;B(this,no,AP).call(this,u,o)}}}updateParent(e,t){if(t===this)return;const r=f(this,gr).get(e);r&&(f(t,hs).append(r),f(this,gr).delete(e),f(t,gr).set(e,r))}remove(e){f(this,Gu).delete(e),f(this,hs)!==null&&(f(this,gr).get(e).remove(),f(this,gr).delete(e))}destroy(){_(this,hs,null);for(const e of f(this,gr).values())e.remove();f(this,gr).clear(),f(this,Gu).clear()}};hs=new WeakMap,gr=new WeakMap,Gu=new WeakMap,FS=new WeakMap,JA=new WeakSet,U4=function(e,[t,r,i,s]){const{style:o}=e;o.top=`${100*r}%`,o.left=`${100*t}%`,o.width=`${100*i}%`,o.height=`${100*s}%`},no=new WeakSet,CP=function(){const e=En._svgFactory.create(1,1,!0);return f(this,hs).append(e),e.setAttribute("aria-hidden",!0),e},z4=function(e,t){const r=En._svgFactory.createElement("clipPath");e.append(r);const i=`clip_${t}`;r.setAttribute("id",i),r.setAttribute("clipPathUnits","objectBoundingBox");const s=En._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),i},AP=function(e,t){for(const[r,i]of Object.entries(t))i===null?e.removeAttribute(r):e.setAttribute(r,i)},L(En,JA),L(En,FS,0);let SP=En;globalThis._pdfjsTestingUtils={HighlightOutliner:Xb};globalThis.pdfjsLib={AbortException:Ul,AnnotationEditorLayer:mP,AnnotationEditorParamsType:ut,AnnotationEditorType:Xe,AnnotationEditorUIManager:Yu,AnnotationLayer:Gb,AnnotationMode:qa,AnnotationType:gn,applyOpacity:jV,build:q$,ColorPicker:AA,createValidAbsoluteUrl:kF,CSSConstants:FV,DOMSVGFactory:EA,DrawLayer:SP,FeatureTest:Pn,fetchData:VS,findContrastColor:UV,getDocument:jj,getFilenameFromUrl:MV,getPdfFilenameFromUrl:NV,getRGB:HS,getUuid:LF,getXfaPageViewport:DV,GlobalWorkerOptions:eo,ImageKind:MC,InvalidPDFException:Yw,isDataScheme:oT,isPdfFile:tR,isValidExplicitDest:JV,MathClamp:Sr,noContextMenu:zi,normalizeUnicode:IV,OPS:Wv,OutputScale:to,PasswordResponses:CV,PDFDataRangeTransport:Uj,PDFDateString:mA,PDFWorker:Hv,PermissionFlag:SV,PixelsPerInch:zl,RenderingCancelledException:eR,renderRichText:BF,ResponseException:fA,setLayerDimensions:Ku,shadow:Ye,SignatureExtractor:oa,stopEvent:cn,SupportedImageMimeTypes:Xw,TextLayer:$v,TouchManager:vA,updateUrlHash:MF,Util:ke,VerbosityLevel:rT,version:Z$,XfaLayer:OF};function vH(n){return new Worker("/AzureVoicePlayground/assets/pdf.worker-C5jlnIh9.js",{name:n==null?void 0:n.name})}eo.workerPort=new vH;function yH(n){const e=n.toLowerCase();return e.endsWith(".pdf")||e.includes(".pdf?")}async function SH(n){try{const e=await jj({data:n}).promise;let t="";const r=Math.min(e.numPages,20);console.log("PDF has",e.numPages,"pages, extracting up to",r);for(let i=1;i<=r;i++){const a=(await(await e.getPage(i)).getTextContent()).items.map(l=>l.str).join(" ");t+=a+`
`}return t.replace(/\s+/g," ").trim().substring(0,1e5)}catch(e){throw new Error(`Failed to extract PDF content: ${e instanceof Error?e.message:"Unknown error"}`)}}function CH(n){var s;const t=new DOMParser().parseFromString(n,"text/html");return t.querySelectorAll("script, style, nav, header, footer, aside").forEach(o=>o.remove()),(((s=t.body)==null?void 0:s.textContent)||"").replace(/\s+/g," ").trim().substring(0,1e5)}async function AH(n){let e;try{const t=await fetch(n);if(!t.ok)throw new Error(`Failed to fetch URL: ${t.status}`);const r=t.headers.get("content-type")||"",i=yH(n)||r.includes("application/pdf");if(console.log("=== URL FETCH INFO ==="),console.log("URL:",n),console.log("Content-Type:",r),console.log("Is PDF:",i),i){const s=await t.arrayBuffer();e=await SH(s)}else{const s=await t.text();e=CH(s)}}catch(t){throw new Error(`Failed to fetch URL content: ${t instanceof Error?t.message:"Unknown error"}`)}return console.log("Content length:",e.length,"characters"),console.log("--- Content Preview (first 2000 chars) ---"),console.log(e.substring(0,2e3)),console.log("--- End Preview ---"),e.length>2e3&&console.log("... [truncated, total",e.length,"characters]"),console.log("================================="),e}async function TH(n,e){var T,E,x;const t=await AH(e.url);if(!t||t.length<50)throw new Error("Could not extract enough content from the URL");const r=e.speakers.join(", "),i=e.language||"English",s=e.speakers[0]||"speaker1",o=e.speakers[1]||"speaker2",a=i==="Chinese"?'"", "", "", "", "", "", ""':i==="Japanese"?'"", "", "", "", ""':i==="Korean"?'"", "", "", "", ""':'"yeah", "right", "oh", "mm-hmm", "I see", "exactly", "uh-huh"',l=`You are a podcast script writer. Your task is to create an engaging, natural-sounding podcast dialogue script based on the provided content.

Rules:
1. Write in ${i}
2. Use exactly these speaker names: ${r}
3. Format each line as "speakername: dialog text" (lowercase speaker name, colon, then the text)

Script style guidelines:
- Start with a friendly greeting and introduction to the topic
- Break down the content into conversational exchanges
- ${s} (first speaker) typically leads, asks questions, and drives the conversation
- ${o} (second speaker) provides answers, explanations, and insights
- **Use backchanneling as separate lines** to show active listening and engagement:
  - Use expressions like: ${a}
  - Insert these as **separate lines** by the listener during longer explanations
  - Example format:
    ${s}: So the framework has three main components...
    ${o}: 
    ${s}: First, they use something called LoRA...
    ${o}: 
- Add 3-5 backchanneling turns throughout the conversation to create natural interaction
- End with key takeaways and a friendly goodbye
- Make it sound natural and engaging, like a real podcast conversation
- Keep the script between 15-30 lines total
- Do not include any stage directions, actions, or parenthetical notes - only dialog text`,c=`Create a podcast script discussing the following content:

${t}

Remember:
- Use speakers: ${r}
- Format: speakername: dialog text
- Include 3-5 backchanneling responses (short acknowledgments like ${a}) as separate lines
- Make it conversational and engaging`,u=[{role:"system",content:l},{role:"user",content:c}],h=`${n.endpoint}/openai/deployments/${n.deploymentName}/chat/completions?api-version=2024-02-15-preview`,m=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json","api-key":n.apiKey},body:JSON.stringify({messages:u,max_tokens:2e3,temperature:.7})});if(!m.ok){const P=await m.text();throw new Error(`Azure OpenAI API error: ${m.status} - ${P}`)}const C=(x=(E=(T=(await m.json()).choices)==null?void 0:T[0])==null?void 0:E.message)==null?void 0:x.content;if(!C)throw new Error("No script generated from Azure OpenAI");return C.trim()}const EH=`ava: Welcome to Tech Talk! I'm your host, and today we're diving into artificial intelligence.
andrew: Thanks for having me! AI is such a fascinating topic these days.
ava: Absolutely! Can you explain what makes modern AI so powerful?
andrew: Of course! The key is deep learning, which allows computers to learn patterns from massive amounts of data.
ava: That sounds incredible. What are some practical applications?
andrew: We see AI everywhere now - voice assistants, recommendation systems, autonomous vehicles, and more.`;function xH({settings:n,onSettingsChange:e,isConfigured:t,history:r,addToHistory:i,removeFromHistory:s,clearHistory:o}){const{enableMAIVoices:a}=XP(),[l,c]=O.useState(EH),[u,h]=O.useState({female:"ava",male:"andrew",display:"Ava & Andrew"}),[m,v]=O.useState(!1),[C,T]=O.useState(!1),[E,x]=O.useState("en-US"),[P,b]=O.useState(null),I=O.useRef(null),M=O.useRef(null),[N,D]=O.useState(()=>localStorage.getItem("podcast_url")||""),[j,F]=O.useState(!1),[z,W]=O.useState(""),[H,V]=O.useState(!1),[K,ee]=O.useState(()=>localStorage.getItem("aoai_endpoint")||""),[G,X]=O.useState(()=>localStorage.getItem("aoai_apikey")||""),[Y,ce]=O.useState(()=>localStorage.getItem("aoai_deployment")||"gpt-5");O.useEffect(()=>{localStorage.setItem("podcast_url",N)},[N]);const{state:ae,error:$,audioData:J,synthesize:de,pause:me,resume:Te,stop:le}=gV({apiKey:n.apiKey,region:n.region}),ie=["eastus","southeastasia","westeurope"].includes(n.region.toLowerCase()),Se=fe=>{if(x(fe),fe&&u){const xe=Wa(u);if(xe){const $e=Ew.find(Ge=>Ge.locale===fe);if($e){const Ge=mD($e,xe.speakers);c(Ge)}}}};O.useEffect(()=>{if(u&&E){const fe=Wa(u);if(fe){const xe=Ew.find($e=>$e.locale===E);if(xe){const $e=mD(xe,fe.speakers);c($e)}}}},[u,E]),O.useEffect(()=>{if(J&&J!==I.current&&u){I.current=J;const fe=Wa(u);tT(J).then(xe=>{i({timestamp:Date.now(),text:l,voice:(fe==null?void 0:fe.displayName)||u.display,region:n.region,audioData:J,duration:xe})}).catch(xe=>{console.error("Failed to get audio duration:",xe);const $e=J.byteLength*8/48e3;i({timestamp:Date.now(),text:l,voice:(fe==null?void 0:fe.displayName)||u.display,region:n.region,audioData:J,duration:$e})})}},[J,l,u,n.region,i]);const re=()=>{if(u){const fe=Wa(u);fe&&de(l,fe.voiceName,fe.locale,fe.speakers)}},pe=()=>{localStorage.setItem("aoai_endpoint",K),localStorage.setItem("aoai_apikey",G),localStorage.setItem("aoai_deployment",Y),V(!1)},ne=async()=>{if(!N.trim()){W("Please enter a URL");return}if(!K||!G){W("Please configure Azure OpenAI settings first"),V(!0);return}if(!u){W("Please select a speaker pair first");return}F(!0),W("");try{const fe={endpoint:K,apiKey:G,deploymentName:Y},xe=Wa(u);if(!xe)throw new Error("Failed to get voice details");const Ge=(E||xe.locale||"en-US").split("-")[0].toLowerCase(),gt={zh:"Chinese",ja:"Japanese",ko:"Korean",de:"German",fr:"French",es:"Spanish",pt:"Portuguese",it:"Italian",en:"English"}[Ge]||"English",vi=await TH(fe,{url:N,speakers:xe.speakers,language:gt});c(vi),x("")}catch(fe){W(fe instanceof Error?fe.message:"Failed to generate script")}finally{F(!1)}},ve=fe=>{const xe=new Blob([fe.audioData],{type:"audio/mpeg"}),$e=URL.createObjectURL(xe),Ge=document.createElement("a");Ge.href=$e,Ge.download=`multitalker-${fe.voice}-${Date.now()}.mp3`,document.body.appendChild(Ge),Ge.click(),document.body.removeChild(Ge),URL.revokeObjectURL($e)},ge=fe=>{if(P===fe.id&&M.current){M.current.pause(),M.current=null,b(null);return}M.current&&(M.current.pause(),M.current=null);const xe=new Blob([fe.audioData],{type:"audio/mpeg"}),$e=URL.createObjectURL(xe),Ge=new Audio($e);M.current=Ge,b(fe.id),Ge.play(),Ge.onended=()=>{URL.revokeObjectURL($e),b(null),M.current=null},Ge.onerror=()=>{URL.revokeObjectURL($e),b(null),M.current=null}},Ie=ae;return g.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[g.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[g.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 shadow-md",children:[g.jsx("h1",{className:"text-3xl font-bold",children:"Multi Talker"}),g.jsx("p",{className:"text-purple-100 mt-1",children:"Create multi-speaker dialog content with AI-powered voices"})]}),g.jsxs("div",{className:"flex-1 flex flex-col gap-4 p-6 overflow-y-auto",children:[t&&!ie&&g.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("svg",{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-semibold text-amber-800",children:"Region Not Supported"}),g.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Multi Talker is currently only available in the following regions:"}),g.jsxs("ul",{className:"text-sm text-amber-700 mt-2 list-disc list-inside",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"East US"})," (eastus)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"West Europe"})," (westeurope)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Southeast Asia"})," (southeastasia)"]})]}),g.jsxs("p",{className:"text-sm text-amber-700 mt-2",children:["Your current region is ",g.jsx("strong",{children:n.region}),". Please update your region in the sidebar settings."]})]})]})}),(!t||ie)&&g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"border border-purple-200 rounded-lg p-4 bg-purple-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsx("label",{className:"text-sm font-medium text-purple-700",children:"Generate Script from URL"}),g.jsxs("button",{onClick:()=>V(!H),className:"text-xs text-purple-600 hover:text-purple-800 underline",children:[H?"Hide":"Configure"," Azure OpenAI"]})]}),H&&g.jsxs("div",{className:"mb-3 p-3 bg-white border border-purple-200 rounded-md space-y-2",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Endpoint"}),g.jsx("input",{type:"text",value:K,onChange:fe=>ee(fe.target.value),placeholder:"https://your-resource.openai.azure.com",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-purple-500"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"API Key"}),g.jsx("input",{type:"password",value:G,onChange:fe=>X(fe.target.value),placeholder:"Enter API key",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-purple-500"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Deployment Name"}),g.jsx("input",{type:"text",value:Y,onChange:fe=>ce(fe.target.value),placeholder:"gpt-5",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-purple-500"})]}),g.jsx("button",{onClick:pe,className:"px-3 py-1 text-xs font-medium text-white bg-purple-600 rounded hover:bg-purple-700",children:"Save Config"})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("input",{type:"url",value:N,onChange:fe=>D(fe.target.value),placeholder:"Enter URL to generate podcast script from...",className:"flex-1 px-3 py-2 border border-purple-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",disabled:j}),g.jsx("button",{onClick:ne,disabled:j||!N.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:j?g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Generating..."]}):"Generate Script"})]}),z&&g.jsx("p",{className:"mt-2 text-xs text-red-600",children:z})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Podcast Script Preset:"}),g.jsxs("select",{value:E,onChange:fe=>Se(fe.target.value),className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",disabled:ae==="synthesizing"||ae==="playing",children:[g.jsx("option",{value:"",children:"-- Select a preset --"}),Ew.map(fe=>g.jsx("option",{value:fe.locale,children:fe.language},fe.locale))]}),E&&g.jsx("button",{onClick:()=>{x("")},className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear"})]}),g.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700",children:m?"SSML Preview":"Dialog Text"}),u&&!m&&(()=>{const fe=Wa(u);return fe?g.jsxs("div",{className:"text-xs text-gray-500",children:["Format: ",g.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"speaker: text"})," | Speakers: ",fe.speakers.map((xe,$e)=>g.jsx("code",{className:"bg-purple-100 text-purple-700 px-1 rounded mx-0.5",children:xe},xe))]}):null})()]}),g.jsx("textarea",{value:(()=>{if(m&&u){const fe=Wa(u);return fe?_F(l,fe.voiceName,fe.locale,fe.speakers):l}return l})(),onChange:fe=>!m&&c(fe.target.value),placeholder:`Enter dialog text with speaker prefixes:
speaker1: Hello!
speaker2: Hi there!`,className:`flex-1 w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm resize-none ${m?"bg-gray-900 text-green-400":""}`,disabled:ae==="synthesizing"||ae==="playing",readOnly:m}),g.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[g.jsxs("div",{className:"text-xs text-gray-500",children:[l.split(`
`).filter(fe=>fe.trim()).length," lines | ",l.length," characters"]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("button",{onClick:()=>v(!m),disabled:!u||!l,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Show Plain Text":"Show SSML"}),g.jsx("button",{onClick:()=>c(""),disabled:!l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Clear Text"})]})]})]}),g.jsx("div",{className:"border-t border-gray-200 pt-4",children:g.jsx(mF,{state:Ie,error:$,audioData:J,hasText:l.trim().length>0,isConfigured:t&&u!==null,onPlay:re,onPause:me,onResume:Te,onStop:le})})]})]}),g.jsxs("div",{className:"border-t border-gray-200 bg-gray-50",children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-gray-100",onClick:()=>T(!C),children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Synthesis History"}),r.length>0&&g.jsx("span",{className:"px-2 py-1 text-xs font-medium text-white bg-purple-600 rounded-full",children:r.length})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[r.length>0&&g.jsx("button",{onClick:fe=>{fe.stopPropagation(),window.confirm("Clear all history?")&&o()},className:"px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors",children:"Clear All"}),g.jsx("svg",{className:`w-5 h-5 text-gray-600 transform transition-transform ${C?"rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]}),C&&g.jsx("div",{className:"max-h-64 overflow-y-auto",children:r.length===0?g.jsx("div",{className:"px-4 py-8 text-center text-gray-500 text-sm",children:"No synthesis history yet"}):g.jsx("div",{className:"divide-y divide-gray-200",children:r.map(fe=>g.jsxs("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-100",children:[g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:"text-sm font-medium text-gray-800 truncate",children:fe.voice}),g.jsxs("div",{className:"text-xs text-gray-500",children:[new Date(fe.timestamp).toLocaleTimeString()," |"," ",fe.duration.toFixed(1),"s |"," ",fe.text.substring(0,50),"..."]})]}),g.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[g.jsx("button",{onClick:()=>ge(fe),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md transition-colors",title:P===fe.id?"Pause":"Play",children:P===fe.id?g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M5 4h3v12H5V4zm7 0h3v12h-3V4z"})}):g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),g.jsx("button",{onClick:()=>ve(fe),className:"p-2 text-gray-600 hover:bg-gray-200 rounded-full",title:"Download",children:g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})}),g.jsx("button",{onClick:()=>s(fe.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-full",title:"Delete",children:g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]},fe.id))})})]}),g.jsxs("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3 flex items-center justify-between",children:[g.jsx("p",{className:"text-xs text-gray-600",children:"Multi Talker uses Azure Speech Service with DragonHDLatestNeural model."}),g.jsx(gF,{text:l,selectedVoice:(()=>{const fe=Wa(u);return(fe==null?void 0:fe.displayName)||""})(),region:n.region,audioData:J})]})]}),g.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-hidden",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Speaker Pair Selection"}),g.jsx("div",{className:"flex-1 min-h-0",children:g.jsx(vV,{selectedPair:u,onPairChange:h})})]})]})}const VD=[{tier:"pro",id:"gpt-realtime"},{tier:"pro",id:"gpt-4o"},{tier:"pro",id:"gpt-4.1"},{tier:"pro",id:"gpt-5"},{tier:"pro",id:"gpt-5-chat"},{tier:"basic",id:"gpt-realtime-mini"},{tier:"basic",id:"gpt-4o-mini"},{tier:"basic",id:"gpt-4.1-mini"},{tier:"basic",id:"gpt-5-mini"},{tier:"lite",id:"gpt-5-nano"},{tier:"lite",id:"phi4-mm-realtime"},{tier:"lite",id:"phi4-mini"}],wH=[{code:"en",label:"English"},{code:"zh",label:""},{code:"ja",label:""},{code:"ko",label:""},{code:"fr",label:"Franais"},{code:"de",label:"Deutsch"},{code:"es",label:"Espaol"},{code:"it",label:"Italiano"},{code:"pt",label:"Portugus"},{code:"ru",label:""},{code:"ar",label:""},{code:"hi",label:""},{code:"id",label:"Bahasa Indonesia"},{code:"vi",label:"Ting Vit"},{code:"th",label:""},{code:"tr",label:"Trke"},{code:"nl",label:"Nederlands"},{code:"sv",label:"Svenska"},{code:"no",label:"Norsk"},{code:"da",label:"Dansk"},{code:"fi",label:"Suomi"},{code:"pl",label:"Polski"},{code:"cs",label:"etina"},{code:"hu",label:"Magyar"},{code:"ro",label:"Romn"},{code:"el",label:""},{code:"he",label:""}],Nw={endpoint:"",apiKey:"",model:"gpt-4.1-mini",targetLanguage:"en",asrModel:"azure-speech",asrLanguages:"",voiceProvider:"azure-standard",voiceName:"en-US-AvaMultilingualNeural",prompt:"",turnDetectionType:"azure_semantic_vad",threshold:.5,prefixPaddingInMs:300,silenceDurationInMs:200,speechDurationInMs:80,removeFillerWords:!1,eouModel:"semantic_detection_v1",eouThresholdLevel:"default",eouTimeoutInMs:1e3};function Id(n){return["You are a simultaneous interpreter.",`Target language: ${n}.`,"","Rules:","1) Translate sentence by sentence (output each sentence as it completes).","2) Keep context consistent across turns (pronouns, terms, tone, references).","3) Preserve meaning faithfully; do not add explanations or extra content.","4) Keep proper nouns, numbers, and code as-is unless a standard translation is obvious.","5) Output translation text only."].join(`
`)}function $D(n){const t=(n.asrModel==="azure-speech"?"azure_semantic_vad":n.turnDetectionType)==="server_vad"?{type:"server_vad",threshold:n.threshold,prefixPaddingInMs:n.prefixPaddingInMs,silenceDurationInMs:n.silenceDurationInMs,createResponse:!0,interruptResponse:!1}:{type:"azure_semantic_vad",threshold:n.threshold,prefixPaddingInMs:n.prefixPaddingInMs,silenceDurationInMs:n.silenceDurationInMs,speechDurationInMs:n.speechDurationInMs,removeFillerWords:n.removeFillerWords,createResponse:!0,interruptResponse:!1},r=n.asrLanguages.split(",").map(i=>i.trim()).filter(Boolean).join(",");return{model:n.model,modalities:["audio","text"],instructions:n.prompt,inputAudioFormat:"pcm16",inputAudioSamplingRate:16e3,outputAudioFormat:"pcm16",turnDetection:t,inputAudioTranscription:n.asrModel==="azure-speech"?{model:"azure-speech",language:r||void 0}:{model:n.asrModel},voice:n.voiceProvider==="openai"?{type:"openai",name:n.voiceName}:{type:"azure-standard",name:n.voiceName}}}function HD(n){if(!n)return 24e3;const e=n.toLowerCase();return e==="pcm16"?24e3:e==="pcm16-16000hz"?16e3:e==="pcm16-8000hz"?8e3:24e3}function bH(n){const e=new Int16Array(n.length);for(let t=0;t<n.length;t++){const r=Math.max(-1,Math.min(1,n[t]??0));e[t]=r<0?r*32768:r*32767}return e}function PH(n){return new Uint8Array(n.buffer)}function RH(n){const e=new DataView(n.buffer,n.byteOffset,n.byteLength),t=Math.floor(n.byteLength/2),r=new Float32Array(t);for(let i=0;i<t;i++){const s=e.getInt16(i*2,!0);r[i]=s/32768}return r}class IH{constructor(e,t){q(this,"mediaStream");q(this,"audioContext");q(this,"processor");q(this,"source");q(this,"config");q(this,"callbacks");this.config=e,this.callbacks=t}async start(){this.callbacks.onState("starting");try{this.mediaStream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=new AudioContext({sampleRate:this.config.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.mediaStream),this.processor=this.audioContext.createScriptProcessor(this.config.bufferSize,1,1),this.processor.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0),r=bH(t),i=PH(r),s=r.length/this.config.sampleRate;this.callbacks.onChunk(i,s)},this.source.connect(this.processor),this.processor.connect(this.audioContext.destination),this.callbacks.onState("started")}catch(e){const t=e instanceof Error?e.message:String(e);this.callbacks.onState("error",t),await this.stop()}}async stop(){var e,t,r,i;this.callbacks.onState("stopping");try{(e=this.processor)==null||e.disconnect(),(t=this.source)==null||t.disconnect(),this.processor=void 0,this.source=void 0,await((r=this.audioContext)==null?void 0:r.close()),this.audioContext=void 0,(i=this.mediaStream)==null||i.getTracks().forEach(s=>s.stop()),this.mediaStream=void 0}finally{this.callbacks.onState("stopped")}}}class W4{constructor(e){q(this,"_key");if(!e)throw new Error("key must be a non-empty string");this._key=e}get key(){return this._key}update(e){this._key=e}}function _H(n,e){switch(e){case"utf-8":return kH(n);case"base64":return V4(n);case"base64url":return MH(n);case"hex":return NH(n)}}function kH(n){return new TextEncoder().encode(n)}function V4(n){return new Uint8Array([...atob(n)].map(e=>e.charCodeAt(0)))}function MH(n){const e=n.replace(/-/g,"+").replace(/_/g,"/");return V4(e)}const ZD=new Set("0123456789abcdefABCDEF");function NH(n){const e=new Uint8Array(n.length/2);for(let t=0;t<n.length/2;++t){const r=n[2*t],i=n[2*t+1];if(!ZD.has(r)||!ZD.has(i))return e.slice(0,t);e[t]=parseInt(`${r}${i}`,16)}return e}function LH(n,e){return _H(n,e)}function DH(n){return{code:n.code,message:n.message,param:n.param,type:n.type,eventId:n.event_id}}function OH(n){return{token:n.token,logprob:n.logprob,bytes:n.bytes.map(e=>e)}}function BH(n){return{type:n.type,event_id:n.eventId}}function FH(n){switch(n.type){case"session.update":return jH(n);case"session.avatar.connect":return FZ(n);case"input_audio.turn.start":return jZ(n);case"input_audio.turn.append":return UZ(n);case"input_audio.turn.end":return zZ(n);case"input_audio.turn.cancel":return WZ(n);case"input_audio.clear":return VZ(n);case"input_audio_buffer.append":return $Z(n);case"input_audio_buffer.commit":return HZ(n);case"input_audio_buffer.clear":return ZZ(n);case"conversation.item.create":return qZ(n);case"conversation.item.truncate":return a7(n);case"conversation.item.delete":return l7(n);case"response.create":return c7(n);case"response.cancel":return d7(n);case"conversation.item.retrieve":return h7(n);default:return BH(n)}}var wo;(function(n){n.SessionUpdate="session.update",n.InputAudioBufferAppend="input_audio_buffer.append",n.InputAudioBufferCommit="input_audio_buffer.commit",n.InputAudioBufferClear="input_audio_buffer.clear",n.InputAudioTurnStart="input_audio.turn.start",n.InputAudioTurnAppend="input_audio.turn.append",n.InputAudioTurnEnd="input_audio.turn.end",n.InputAudioTurnCancel="input_audio.turn.cancel",n.InputAudioClear="input_audio.clear",n.ConversationItemCreate="conversation.item.create",n.ConversationItemRetrieve="conversation.item.retrieve",n.ConversationItemTruncate="conversation.item.truncate",n.ConversationItemDelete="conversation.item.delete",n.ResponseCreate="response.create",n.ResponseCancel="response.cancel",n.SessionAvatarConnect="session.avatar.connect",n.McpApprovalResponse="mcp_approval_response"})(wo||(wo={}));function jH(n){return{type:n.type,event_id:n.eventId,session:UH(n.session)}}function UH(n){return{model:n.model,modalities:n.modalities?n.modalities.map(e=>e):n.modalities,animation:n.animation?zH(n.animation):n.animation,voice:n.voice?n.voice:n.voice,instructions:n.instructions,input_audio_sampling_rate:n.inputAudioSamplingRate,input_audio_format:n.inputAudioFormat,output_audio_format:n.outputAudioFormat,turn_detection:n.turnDetection?HH(n.turnDetection):n.turnDetection,input_audio_noise_reduction:n.inputAudioNoiseReduction?cZ(n.inputAudioNoiseReduction):n.inputAudioNoiseReduction,input_audio_echo_cancellation:n.inputAudioEchoCancellation?dZ(n.inputAudioEchoCancellation):n.inputAudioEchoCancellation,avatar:n.avatar?pZ(n.avatar):n.avatar,input_audio_transcription:n.inputAudioTranscription?PZ(n.inputAudioTranscription):n.inputAudioTranscription,output_audio_timestamp_types:n.outputAudioTimestampTypes?n.outputAudioTimestampTypes.map(e=>e):n.outputAudioTimestampTypes,tools:n.tools?$4(n.tools):n.tools,tool_choice:n.toolChoice?n.toolChoice:n.toolChoice,temperature:n.temperature,max_response_output_tokens:n.maxResponseOutputTokens?n.maxResponseOutputTokens:n.maxResponseOutputTokens}}var qD;(function(n){n.Text="text",n.Audio="audio",n.Animation="animation",n.Avatar="avatar"})(qD||(qD={}));function zH(n){return{model_name:n.modelName,outputs:n.outputs?n.outputs.map(e=>e):n.outputs}}function WH(n){return{modelName:n.model_name,outputs:n.outputs?n.outputs.map(e=>e):n.outputs}}var GD;(function(n){n.Blendshapes="blendshapes",n.VisemeId="viseme_id"})(GD||(GD={}));var KD;(function(n){n.Alloy="alloy",n.Ash="ash",n.Ballad="ballad",n.Coral="coral",n.Echo="echo",n.Sage="sage",n.Shimmer="shimmer",n.Verse="verse",n.Marin="marin",n.Cedar="cedar"})(KD||(KD={}));var YD;(function(n){n.AzureCustom="azure-custom",n.AzureStandard="azure-standard",n.AzurePersonal="azure-personal"})(YD||(YD={}));var JD;(function(n){n.DragonLatestNeural="DragonLatestNeural",n.PhoenixLatestNeural="PhoenixLatestNeural",n.PhoenixV2Neural="PhoenixV2Neural"})(JD||(JD={}));var XD;(function(n){n.Pcm16="pcm16",n.G711Ulaw="g711_ulaw",n.G711Alaw="g711_alaw"})(XD||(XD={}));var QD;(function(n){n.Pcm16="pcm16",n.Pcm168000Hz="pcm16-8000hz",n.Pcm1616000Hz="pcm16-16000hz",n.G711Ulaw="g711_ulaw",n.G711Alaw="g711_alaw"})(QD||(QD={}));function VH(n){return{type:n.type}}function $H(n){return{type:n.type}}function HH(n){switch(n.type){case"server_vad":return qH(n);case"azure_semantic_vad":return rZ(n);case"azure_semantic_vad_en":return sZ(n);case"azure_semantic_vad_multilingual":return aZ(n);default:return VH(n)}}function ZH(n){switch(n.type){case"server_vad":return GH(n);case"azure_semantic_vad":return iZ(n);case"azure_semantic_vad_en":return oZ(n);case"azure_semantic_vad_multilingual":return lZ(n);default:return $H(n)}}var e2;(function(n){n.ServerVad="server_vad",n.AzureSemanticVad="azure_semantic_vad",n.AzureSemanticVadEn="azure_semantic_vad_en",n.AzureSemanticVadMultilingual="azure_semantic_vad_multilingual"})(e2||(e2={}));function qH(n){return{type:n.type,threshold:n.threshold,prefix_padding_ms:n.prefixPaddingInMs,silence_duration_ms:n.silenceDurationInMs,end_of_utterance_detection:n.endOfUtteranceDetection?cT(n.endOfUtteranceDetection):n.endOfUtteranceDetection,auto_truncate:n.autoTruncate,create_response:n.createResponse,interrupt_response:n.interruptResponse}}function GH(n){return{type:n.type,threshold:n.threshold,prefixPaddingInMs:n.prefix_padding_ms,silenceDurationInMs:n.silence_duration_ms,endOfUtteranceDetection:n.end_of_utterance_detection?uT(n.end_of_utterance_detection):n.end_of_utterance_detection,autoTruncate:n.auto_truncate,createResponse:n.create_response,interruptResponse:n.interrupt_response}}function KH(n){return{model:n.model}}function YH(n){return{model:n.model}}function cT(n){switch(n.model){case"semantic_detection_v1":return JH(n);case"semantic_detection_v1_en":return QH(n);case"semantic_detection_v1_multilingual":return tZ(n);default:return KH(n)}}function uT(n){switch(n.model){case"semantic_detection_v1":return XH(n);case"semantic_detection_v1_en":return eZ(n);case"semantic_detection_v1_multilingual":return nZ(n);default:return YH(n)}}function JH(n){return{model:n.model,threshold_level:n.thresholdLevel,timeout_ms:n.timeoutInMs}}function XH(n){return{model:n.model,thresholdLevel:n.threshold_level,timeoutInMs:n.timeout_ms}}var t2;(function(n){n.Low="low",n.Medium="medium",n.High="high",n.Default="default"})(t2||(t2={}));function QH(n){return{model:n.model,threshold_level:n.thresholdLevel,timeout_ms:n.timeoutInMs}}function eZ(n){return{model:n.model,thresholdLevel:n.threshold_level,timeoutInMs:n.timeout_ms}}function tZ(n){return{model:n.model,threshold_level:n.thresholdLevel,timeout_ms:n.timeoutInMs}}function nZ(n){return{model:n.model,thresholdLevel:n.threshold_level,timeoutInMs:n.timeout_ms}}function rZ(n){return{type:n.type,threshold:n.threshold,prefix_padding_ms:n.prefixPaddingInMs,silence_duration_ms:n.silenceDurationInMs,end_of_utterance_detection:n.endOfUtteranceDetection?cT(n.endOfUtteranceDetection):n.endOfUtteranceDetection,speech_duration_ms:n.speechDurationInMs,remove_filler_words:n.removeFillerWords,languages:n.languages?n.languages.map(e=>e):n.languages,auto_truncate:n.autoTruncate,create_response:n.createResponse,interrupt_response:n.interruptResponse}}function iZ(n){return{type:n.type,threshold:n.threshold,prefixPaddingInMs:n.prefix_padding_ms,silenceDurationInMs:n.silence_duration_ms,endOfUtteranceDetection:n.end_of_utterance_detection?uT(n.end_of_utterance_detection):n.end_of_utterance_detection,speechDurationInMs:n.speech_duration_ms,removeFillerWords:n.remove_filler_words,languages:n.languages?n.languages.map(e=>e):n.languages,autoTruncate:n.auto_truncate,createResponse:n.create_response,interruptResponse:n.interrupt_response}}function sZ(n){return{type:n.type,threshold:n.threshold,prefix_padding_ms:n.prefixPaddingInMs,silence_duration_ms:n.silenceDurationInMs,end_of_utterance_detection:n.endOfUtteranceDetection?cT(n.endOfUtteranceDetection):n.endOfUtteranceDetection,speech_duration_ms:n.speechDurationInMs,remove_filler_words:n.removeFillerWords,auto_truncate:n.autoTruncate,create_response:n.createResponse,interrupt_response:n.interruptResponse}}function oZ(n){return{type:n.type,threshold:n.threshold,prefixPaddingInMs:n.prefix_padding_ms,silenceDurationInMs:n.silence_duration_ms,endOfUtteranceDetection:n.end_of_utterance_detection?uT(n.end_of_utterance_detection):n.end_of_utterance_detection,speechDurationInMs:n.speech_duration_ms,removeFillerWords:n.remove_filler_words,autoTruncate:n.auto_truncate,createResponse:n.create_response,interruptResponse:n.interrupt_response}}function aZ(n){return{type:n.type,threshold:n.threshold,prefix_padding_ms:n.prefixPaddingInMs,silence_duration_ms:n.silenceDurationInMs,end_of_utterance_detection:n.endOfUtteranceDetection?cT(n.endOfUtteranceDetection):n.endOfUtteranceDetection,speech_duration_ms:n.speechDurationInMs,remove_filler_words:n.removeFillerWords,languages:n.languages?n.languages.map(e=>e):n.languages,auto_truncate:n.autoTruncate,create_response:n.createResponse,interrupt_response:n.interruptResponse}}function lZ(n){return{type:n.type,threshold:n.threshold,prefixPaddingInMs:n.prefix_padding_ms,silenceDurationInMs:n.silence_duration_ms,endOfUtteranceDetection:n.end_of_utterance_detection?uT(n.end_of_utterance_detection):n.end_of_utterance_detection,speechDurationInMs:n.speech_duration_ms,removeFillerWords:n.remove_filler_words,languages:n.languages?n.languages.map(e=>e):n.languages,autoTruncate:n.auto_truncate,createResponse:n.create_response,interruptResponse:n.interrupt_response}}function cZ(n){return{type:n.type}}function uZ(n){return{type:n.type}}function dZ(n){return{type:n.type}}function hZ(n){return{type:n.type}}function pZ(n){return{type:n.type,ice_servers:n.iceServers?mZ(n.iceServers):n.iceServers,character:n.character,style:n.style,model:n.model,customized:n.customized,video:n.video?SZ(n.video):n.video,output_protocol:n.outputProtocol}}function fZ(n){return{type:n.type,iceServers:n.ice_servers?gZ(n.ice_servers):n.ice_servers,character:n.character,style:n.style,model:n.model,customized:n.customized,video:n.video?CZ(n.video):n.video,outputProtocol:n.output_protocol}}var n2;(function(n){n.VideoAvatar="video-avatar",n.PhotoAvatar="photo-avatar"})(n2||(n2={}));function mZ(n){return n.map(e=>vZ(e))}function gZ(n){return n.map(e=>yZ(e))}function vZ(n){return{urls:n.urls.map(e=>e),username:n.username,credential:n.credential}}function yZ(n){return{urls:n.urls.map(e=>e),username:n.username,credential:n.credential}}var r2;(function(n){n.Vasa1="vasa-1"})(r2||(r2={}));function SZ(n){return{bitrate:n.bitrate,codec:n.codec,crop:n.crop?AZ(n.crop):n.crop,resolution:n.resolution?EZ(n.resolution):n.resolution,background:n.background?wZ(n.background):n.background,gop_size:n.gopSize}}function CZ(n){return{bitrate:n.bitrate,codec:n.codec,crop:n.crop?TZ(n.crop):n.crop,resolution:n.resolution?xZ(n.resolution):n.resolution,background:n.background?bZ(n.background):n.background,gopSize:n.gop_size}}function AZ(n){return{top_left:n.topLeft.map(e=>e),bottom_right:n.bottomRight.map(e=>e)}}function TZ(n){return{topLeft:n.top_left.map(e=>e),bottomRight:n.bottom_right.map(e=>e)}}function EZ(n){return{width:n.width,height:n.height}}function xZ(n){return{width:n.width,height:n.height}}function wZ(n){return{color:n.color,image_url:n.imageUrl}}function bZ(n){return{color:n.color,imageUrl:n.image_url}}var i2;(function(n){n.Webrtc="webrtc",n.Websocket="websocket"})(i2||(i2={}));function PZ(n){return{model:n.model,language:n.language,custom_speech:n.customSpeech,phrase_list:n.phraseList?n.phraseList.map(e=>e):n.phraseList}}function RZ(n){return{model:n.model,language:n.language,customSpeech:n.custom_speech?Object.fromEntries(Object.entries(n.custom_speech).map(([e,t])=>[e,t])):n.custom_speech,phraseList:n.phrase_list?n.phrase_list.map(e=>e):n.phrase_list}}var s2;(function(n){n.Word="word"})(s2||(s2={}));function $4(n){return n.map(e=>MZ(e))}function IZ(n){return n.map(e=>NZ(e))}function _Z(n){return{type:n.type}}function kZ(n){return{type:n.type}}function MZ(n){switch(n.type){case"function":return LZ(n);case"mcp":return OZ(n);default:return _Z(n)}}function NZ(n){switch(n.type){case"function":return DZ(n);case"mcp":return BZ(n);default:return kZ(n)}}var o2;(function(n){n.Function="function",n.Mcp="mcp"})(o2||(o2={}));function LZ(n){return{type:n.type,name:n.name,description:n.description,parameters:n.parameters}}function DZ(n){return{type:n.type,name:n.name,description:n.description,parameters:n.parameters}}function OZ(n){return{type:n.type,server_label:n.serverLabel,server_url:n.serverUrl,authorization:n.authorization,headers:n.headers,allowed_tools:n.allowedTools?n.allowedTools.map(e=>e):n.allowedTools,require_approval:n.requireApproval?n.requireApproval:n.requireApproval}}function BZ(n){return{type:n.type,serverLabel:n.server_label,serverUrl:n.server_url,authorization:n.authorization,headers:n.headers?Object.fromEntries(Object.entries(n.headers).map(([e,t])=>[e,t])):n.headers,allowedTools:n.allowed_tools?n.allowed_tools.map(e=>e):n.allowed_tools,requireApproval:n.require_approval?n.require_approval:n.require_approval}}var a2;(function(n){n.Never="never",n.Always="always"})(a2||(a2={}));var l2;(function(n){n.Auto="auto",n.None="none",n.Required="required"})(l2||(l2={}));function FZ(n){return{type:n.type,event_id:n.eventId,client_sdp:n.clientSdp}}function jZ(n){return{type:n.type,event_id:n.eventId,turn_id:n.turnId}}function UZ(n){return{type:n.type,event_id:n.eventId,turn_id:n.turnId,audio:n.audio}}function zZ(n){return{type:n.type,event_id:n.eventId,turn_id:n.turnId}}function WZ(n){return{type:n.type,event_id:n.eventId,turn_id:n.turnId}}function VZ(n){return{type:n.type,event_id:n.eventId}}function $Z(n){return{type:n.type,event_id:n.eventId,audio:n.audio}}function HZ(n){return{type:n.type,event_id:n.eventId}}function ZZ(n){return{type:n.type,event_id:n.eventId}}function qZ(n){return{type:n.type,event_id:n.eventId,previous_item_id:n.previousItemId,item:n.item?H4(n.item):n.item}}function GZ(n){return{type:n.type,id:n.id}}function H4(n){switch(n.type){case"message":return YZ(n);case"function_call":return i7(n);case"function_call_output":return s7(n);case"mcp_approval_response":return o7(n);default:return GZ(n)}}var c2;(function(n){n.Message="message",n.FunctionCall="function_call",n.FunctionCallOutput="function_call_output",n.McpListTools="mcp_list_tools",n.McpCall="mcp_call",n.McpApprovalRequest="mcp_approval_request",n.McpApprovalResponse="mcp_approval_response"})(c2||(c2={}));function KZ(n){return{type:n.type,id:n.id,role:n.role,content:dT(n.content),status:n.status}}function YZ(n){switch(n.role){case"assistant":return Z4(n);case"system":return n7(n);case"user":return r7(n);default:return KZ(n)}}var u2;(function(n){n.System="system",n.User="user",n.Assistant="assistant"})(u2||(u2={}));function dT(n){return n.map(e=>XZ(e))}function JZ(n){return{type:n.type}}function XZ(n){switch(n.type){case"input_text":return QZ(n);case"input_audio":return e7(n);case"text":return t7(n);default:return JZ(n)}}var d2;(function(n){n.InputText="input_text",n.InputAudio="input_audio",n.InputImage="input_image",n.Text="text",n.Audio="audio"})(d2||(d2={}));function QZ(n){return{type:n.type,text:n.text}}function e7(n){return{type:n.type,audio:n.audio,transcript:n.transcript}}function t7(n){return{type:n.type,text:n.text}}var h2;(function(n){n.Completed="completed",n.Incomplete="incomplete"})(h2||(h2={}));function Z4(n){return{type:n.type,role:n.role,content:dT(n.content),status:n.status,id:n.id}}function n7(n){return{type:n.type,role:n.role,content:dT(n.content),status:n.status,id:n.id}}function r7(n){return{type:n.type,role:n.role,content:dT(n.content),status:n.status,id:n.id}}function i7(n){return{type:n.type,id:n.id,name:n.name,call_id:n.callId,arguments:n.arguments,status:n.status}}function s7(n){return{type:n.type,id:n.id,call_id:n.callId,output:n.output,status:n.status}}function o7(n){return{type:n.type,id:n.id,approval_request_id:n.approvalRequestId,approve:n.approve}}function a7(n){return{type:n.type,event_id:n.eventId,item_id:n.itemId,content_index:n.contentIndex,audio_end_ms:n.audioEndInMs}}function l7(n){return{type:n.type,event_id:n.eventId,item_id:n.itemId}}function c7(n){return{type:n.type,event_id:n.eventId,response:n.response?u7(n.response):n.response,additional_instructions:n.additionalInstructions}}function u7(n){return{commit:n.commit,cancel_previous:n.cancelPrevious,append_input_items:n.appendInputItems?p2(n.appendInputItems):n.appendInputItems,input_items:n.inputItems?p2(n.inputItems):n.inputItems,modalities:n.modalities?n.modalities.map(e=>e):n.modalities,instructions:n.instructions,voice:n.voice?n.voice:n.voice,output_audio_format:n.outputAudioFormat,tools:n.tools?$4(n.tools):n.tools,tool_choice:n.toolChoice,temperature:n.temperature,max_output_tokens:n.maxOutputTokens?n.maxOutputTokens:n.maxOutputTokens,pre_generated_assistant_message:n.preGeneratedAssistantMessage?Z4(n.preGeneratedAssistantMessage):n.preGeneratedAssistantMessage}}function p2(n){return n.map(e=>H4(e))}function d7(n){return{type:n.type,event_id:n.eventId,response_id:n.responseId}}function h7(n){return{type:n.type,event_id:n.eventId,item_id:n.itemId}}function q4(n){return{id:n.id,object:n.object,status:n.status,statusDetails:n.status_details?f7(n.status_details):n.status_details,output:n.output?y7(n.output):n.output,usage:n.usage?O7(n.usage):n.usage,conversationId:n.conversation_id,voice:n.voice?n.voice:n.voice,modalities:n.modalities?n.modalities.map(e=>e):n.modalities,outputAudioFormat:n.output_audio_format,temperature:n.temperature,maxOutputTokens:n.max_output_tokens?n.max_output_tokens:n.max_output_tokens}}var f2;(function(n){n.Completed="completed",n.Cancelled="cancelled",n.Failed="failed",n.Incomplete="incomplete",n.InProgress="in_progress"})(f2||(f2={}));function p7(n){return{type:n.type}}function f7(n){switch(n.type){case"cancelled":return m7(n);case"incomplete":return g7(n);case"failed":return v7(n);default:return p7(n)}}function m7(n){return{type:n.type,reason:n.reason}}function g7(n){return{type:n.type,reason:n.reason}}function v7(n){return{type:n.type,error:n.error}}function y7(n){return n.map(e=>KS(e))}function S7(n){return{type:n.type,id:n.id,object:n.object}}function KS(n){switch(n.type){case"message":return C7(n);case"function_call":return R7(n);case"function_call_output":return I7(n);case"mcp_list_tools":return _7(n);case"mcp_call":return N7(n);case"mcp_approval_request":return L7(n);case"mcp_approval_response":return D7(n);default:return S7(n)}}function C7(n){return{type:n.type,id:n.id,object:n.object,role:n.role,content:A7(n.content),status:n.status}}function A7(n){return n.map(e=>cR(e))}function T7(n){return{type:n.type}}function cR(n){switch(n.type){case"input_image":return E7(n);case"input_text":return x7(n);case"input_audio":return w7(n);case"text":return b7(n);case"audio":return P7(n);default:return T7(n)}}function E7(n){return{type:n.type,url:n.url,detail:n.detail}}var m2;(function(n){n.Auto="auto",n.Low="low",n.High="high"})(m2||(m2={}));function x7(n){return{type:n.type,text:n.text}}function w7(n){return{type:n.type,transcript:n.transcript}}function b7(n){return{type:n.type,text:n.text}}function P7(n){return{type:n.type,transcript:n.transcript}}var g2;(function(n){n.InProgress="in_progress",n.Completed="completed",n.Incomplete="incomplete"})(g2||(g2={}));function R7(n){return{type:n.type,id:n.id,object:n.object,name:n.name,callId:n.call_id,arguments:n.arguments,status:n.status}}function I7(n){return{type:n.type,id:n.id,object:n.object,callId:n.call_id,output:n.output}}function _7(n){return{type:n.type,id:n.id,object:n.object,tools:k7(n.tools),serverLabel:n.server_label}}function k7(n){return n.map(e=>M7(e))}function M7(n){return{name:n.name,description:n.description,inputSchema:n.input_schema,annotations:n.annotations}}function N7(n){return{type:n.type,id:n.id,object:n.object,approvalRequestId:n.approval_request_id,arguments:n.arguments,serverLabel:n.server_label,name:n.name,output:n.output,error:n.error}}function L7(n){return{type:n.type,id:n.id,object:n.object,arguments:n.arguments,name:n.name,serverLabel:n.server_label}}function D7(n){return{type:n.type,id:n.id,object:n.object,approvalRequestId:n.approval_request_id,approve:n.approve,reason:n.reason}}function O7(n){return{totalTokens:n.total_tokens,inputTokens:n.input_tokens,outputTokens:n.output_tokens,inputTokenDetails:B7(n.input_token_details),outputTokenDetails:j7(n.output_token_details)}}function B7(n){return{cachedTokens:n.cached_tokens,textTokens:n.text_tokens,audioTokens:n.audio_tokens,imageTokens:n.image_tokens,cachedTokensDetails:F7(n.cached_tokens_details)}}function F7(n){return{textTokens:n.text_tokens,audioTokens:n.audio_tokens,imageTokens:n.image_tokens}}function j7(n){return{textTokens:n.text_tokens,audioTokens:n.audio_tokens}}function U7(n){return{type:n.type,eventId:n.event_id}}function z7(n){switch(n.type){case"error":return W7(n);case"session.created":return $7(n);case"session.updated":return Z7(n);case"session.avatar.connecting":return q7(n);case"input_audio_buffer.committed":return G7(n);case"input_audio_buffer.cleared":return K7(n);case"input_audio_buffer.speech_started":return Y7(n);case"input_audio_buffer.speech_stopped":return J7(n);case"conversation.item.created":return X7(n);case"conversation.item.input_audio_transcription.completed":return Q7(n);case"conversation.item.input_audio_transcription.failed":return eq(n);case"conversation.item.truncated":return tq(n);case"conversation.item.deleted":return nq(n);case"response.created":return rq(n);case"response.done":return iq(n);case"response.output_item.added":return sq(n);case"response.output_item.done":return oq(n);case"response.content_part.added":return aq(n);case"response.content_part.done":return lq(n);case"response.text.delta":return cq(n);case"response.text.done":return uq(n);case"response.audio_transcript.delta":return dq(n);case"response.audio_transcript.done":return hq(n);case"response.audio.delta":return pq(n);case"response.audio.done":return fq(n);case"response.animation_blendshapes.delta":return mq(n);case"response.animation_blendshapes.done":return gq(n);case"response.audio_timestamp.delta":return vq(n);case"response.audio_timestamp.done":return yq(n);case"response.animation_viseme.delta":return Sq(n);case"response.animation_viseme.done":return Cq(n);case"conversation.item.input_audio_transcription.delta":return Aq(n);case"conversation.item.retrieved":return Eq(n);case"response.function_call_arguments.delta":return xq(n);case"response.function_call_arguments.done":return wq(n);case"mcp_list_tools.in_progress":return bq(n);case"mcp_list_tools.completed":return Pq(n);case"mcp_list_tools.failed":return Rq(n);case"response.mcp_call_arguments.delta":return Iq(n);case"response.mcp_call_arguments.done":return _q(n);case"response.mcp_call.in_progress":return kq(n);case"response.mcp_call.completed":return Mq(n);case"response.mcp_call.failed":return Nq(n);default:return U7(n)}}var Zv;(function(n){n.Error="error",n.SessionAvatarConnecting="session.avatar.connecting",n.SessionCreated="session.created",n.SessionUpdated="session.updated",n.ConversationItemInputAudioTranscriptionCompleted="conversation.item.input_audio_transcription.completed",n.ConversationItemInputAudioTranscriptionDelta="conversation.item.input_audio_transcription.delta",n.ConversationItemInputAudioTranscriptionFailed="conversation.item.input_audio_transcription.failed",n.ConversationItemCreated="conversation.item.created",n.ConversationItemRetrieved="conversation.item.retrieved",n.ConversationItemTruncated="conversation.item.truncated",n.ConversationItemDeleted="conversation.item.deleted",n.InputAudioBufferCommitted="input_audio_buffer.committed",n.InputAudioBufferCleared="input_audio_buffer.cleared",n.InputAudioBufferSpeechStarted="input_audio_buffer.speech_started",n.InputAudioBufferSpeechStopped="input_audio_buffer.speech_stopped",n.ResponseCreated="response.created",n.ResponseDone="response.done",n.ResponseOutputItemAdded="response.output_item.added",n.ResponseOutputItemDone="response.output_item.done",n.ResponseContentPartAdded="response.content_part.added",n.ResponseContentPartDone="response.content_part.done",n.ResponseTextDelta="response.text.delta",n.ResponseTextDone="response.text.done",n.ResponseAudioTranscriptDelta="response.audio_transcript.delta",n.ResponseAudioTranscriptDone="response.audio_transcript.done",n.ResponseAudioDelta="response.audio.delta",n.ResponseAudioDone="response.audio.done",n.ResponseAnimationBlendshapesDelta="response.animation_blendshapes.delta",n.ResponseAnimationBlendshapesDone="response.animation_blendshapes.done",n.ResponseAudioTimestampDelta="response.audio_timestamp.delta",n.ResponseAudioTimestampDone="response.audio_timestamp.done",n.ResponseAnimationVisemeDelta="response.animation_viseme.delta",n.ResponseAnimationVisemeDone="response.animation_viseme.done",n.ResponseFunctionCallArgumentsDelta="response.function_call_arguments.delta",n.ResponseFunctionCallArgumentsDone="response.function_call_arguments.done",n.McpListToolsInProgress="mcp_list_tools.in_progress",n.McpListToolsCompleted="mcp_list_tools.completed",n.McpListToolsFailed="mcp_list_tools.failed",n.ResponseMcpCallArgumentsDelta="response.mcp_call_arguments.delta",n.ResponseMcpCallArgumentsDone="response.mcp_call_arguments.done",n.McpApprovalRequest="mcp_approval_request",n.McpApprovalResponse="mcp_approval_response",n.ResponseMcpCallInProgress="response.mcp_call.in_progress",n.ResponseMcpCallCompleted="response.mcp_call.completed",n.ResponseMcpCallFailed="response.mcp_call.failed"})(Zv||(Zv={}));function W7(n){return{type:n.type,eventId:n.event_id,error:V7(n.error)}}function V7(n){return{type:n.type,code:n.code,message:n.message,param:n.param,eventId:n.event_id}}function $7(n){return{type:n.type,eventId:n.event_id,session:G4(n.session)}}function G4(n){return{model:n.model,modalities:n.modalities?n.modalities.map(e=>e):n.modalities,animation:n.animation?WH(n.animation):n.animation,voice:n.voice?n.voice:n.voice,instructions:n.instructions,inputAudioSamplingRate:n.input_audio_sampling_rate,inputAudioFormat:n.input_audio_format,outputAudioFormat:n.output_audio_format,turnDetection:n.turn_detection?ZH(n.turn_detection):n.turn_detection,inputAudioNoiseReduction:n.input_audio_noise_reduction?uZ(n.input_audio_noise_reduction):n.input_audio_noise_reduction,inputAudioEchoCancellation:n.input_audio_echo_cancellation?hZ(n.input_audio_echo_cancellation):n.input_audio_echo_cancellation,avatar:n.avatar?fZ(n.avatar):n.avatar,inputAudioTranscription:n.input_audio_transcription?RZ(n.input_audio_transcription):n.input_audio_transcription,outputAudioTimestampTypes:n.output_audio_timestamp_types?n.output_audio_timestamp_types.map(e=>e):n.output_audio_timestamp_types,tools:n.tools?IZ(n.tools):n.tools,toolChoice:n.tool_choice?n.tool_choice:n.tool_choice,temperature:n.temperature,maxResponseOutputTokens:n.max_response_output_tokens?n.max_response_output_tokens:n.max_response_output_tokens,agent:n.agent?H7(n.agent):n.agent,id:n.id}}function H7(n){return{type:n.type,name:n.name,description:n.description,agentId:n.agent_id,threadId:n.thread_id}}function Z7(n){return{type:n.type,eventId:n.event_id,session:G4(n.session)}}function q7(n){return{type:n.type,eventId:n.event_id,serverSdp:n.server_sdp}}function G7(n){return{type:n.type,eventId:n.event_id,previousItemId:n.previous_item_id,itemId:n.item_id}}function K7(n){return{type:n.type,eventId:n.event_id}}function Y7(n){return{type:n.type,eventId:n.event_id,audioStartInMs:n.audio_start_ms,itemId:n.item_id}}function J7(n){return{type:n.type,eventId:n.event_id,audioEndInMs:n.audio_end_ms,itemId:n.item_id}}function X7(n){return{type:n.type,eventId:n.event_id,previousItemId:n.previous_item_id,item:n.item?KS(n.item):n.item}}function Q7(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,contentIndex:n.content_index,transcript:n.transcript}}function eq(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,contentIndex:n.content_index,error:DH(n.error)}}function tq(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,contentIndex:n.content_index,audioEndInMs:n.audio_end_ms}}function nq(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id}}function rq(n){return{type:n.type,eventId:n.event_id,response:q4(n.response)}}function iq(n){return{type:n.type,eventId:n.event_id,response:q4(n.response)}}function sq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,outputIndex:n.output_index,item:n.item?KS(n.item):n.item}}function oq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,outputIndex:n.output_index,item:n.item?KS(n.item):n.item}}function aq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,part:cR(n.part)}}function lq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,part:cR(n.part)}}function cq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,delta:n.delta}}function uq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,text:n.text}}function dq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,delta:n.delta}}function hq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,transcript:n.transcript}}function pq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,delta:typeof n.delta=="string"?LH(n.delta,"base64"):n.delta}}function fq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index}}function mq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,frames:n.frames,frameIndex:n.frame_index}}function gq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index}}function vq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,audioOffsetInMs:n.audio_offset_ms,audioDurationInMs:n.audio_duration_ms,text:n.text,timestampType:n.timestamp_type}}function yq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index}}function Sq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index,audioOffsetInMs:n.audio_offset_ms,visemeId:n.viseme_id}}function Cq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,contentIndex:n.content_index}}function Aq(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,contentIndex:n.content_index,delta:n.delta,logprobs:n.logprobs?Tq(n.logprobs):n.logprobs}}function Tq(n){return n.map(e=>OH(e))}function Eq(n){return{type:n.type,eventId:n.event_id,item:n.item?KS(n.item):n.item}}function xq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,callId:n.call_id,delta:n.delta}}function wq(n){return{type:n.type,eventId:n.event_id,responseId:n.response_id,itemId:n.item_id,outputIndex:n.output_index,callId:n.call_id,arguments:n.arguments,name:n.name}}function bq(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id}}function Pq(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id}}function Rq(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id}}function Iq(n){return{type:n.type,eventId:n.event_id,delta:n.delta,itemId:n.item_id,responseId:n.response_id,outputIndex:n.output_index,obfuscation:n.obfuscation}}function _q(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,responseId:n.response_id,outputIndex:n.output_index,arguments:n.arguments}}function kq(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,outputIndex:n.output_index}}function Mq(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,outputIndex:n.output_index}}function Nq(n){return{type:n.type,eventId:n.event_id,itemId:n.item_id,outputIndex:n.output_index}}var xt;(function(n){n.ConnectionFailed="CONNECTION_FAILED",n.ConnectionTimeout="CONNECTION_TIMEOUT",n.ConnectionLost="CONNECTION_LOST",n.AlreadyConnected="ALREADY_CONNECTED",n.NotConnected="NOT_CONNECTED",n.WebSocketError="WEBSOCKET_ERROR",n.AuthenticationFailed="AUTHENTICATION_FAILED",n.InvalidCredentials="INVALID_CREDENTIALS",n.Unauthorized="UNAUTHORIZED",n.Forbidden="FORBIDDEN",n.InvalidMessage="INVALID_MESSAGE",n.MessageTooLarge="MESSAGE_TOO_LARGE",n.ProtocolError="PROTOCOL_ERROR",n.BufferOverflow="BUFFER_OVERFLOW",n.OperationCancelled="OPERATION_CANCELLED",n.InvalidState="INVALID_STATE"})(xt||(xt={}));class ht extends Error{constructor(t,r,i="websocket",s=!1,o){super(t);q(this,"code");q(this,"context");q(this,"recoverable");q(this,"cause");q(this,"timestamp");this.name="VoiceLiveConnectionError",this.code=r,this.context=i,this.recoverable=s,this.cause=o,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,ht),Object.defineProperty(this,"message",{enumerable:!0}),Object.defineProperty(this,"name",{enumerable:!0}),Object.defineProperty(this,"stack",{enumerable:!0})}}class dv extends ht{constructor(e,t,r){super(e,t,"authentication",!1,r),this.name="VoiceLiveAuthenticationError"}}function Lq(n,e){switch(n){case 1e3:return new ht("WebSocket connection closed normally",xt.ConnectionLost,"websocket_close",!1);case 1001:case 1006:return new ht(`WebSocket connection lost: ${e||"Abnormal closure"}`,xt.ConnectionLost,"websocket_close",!0);case 1008:return new ht(`WebSocket policy violation: ${e}`,xt.WebSocketError,"websocket_close",!1);case 1011:return new ht(`WebSocket server error: ${e}`,xt.WebSocketError,"websocket_close",!0);default:return new ht(`WebSocket closed with code ${n}: ${e}`,xt.ConnectionLost,"websocket_close",!0)}}function v2(n){if(n instanceof ht)return n;if(n instanceof Error){if(n.message.includes("timeout"))return new ht(`Connection timeout: ${n.message}`,xt.ConnectionTimeout,"connection",!0,n);if(n.message.includes("ECONNREFUSED")||n.message.includes("ENOTFOUND"))return new ht(`Connection failed: ${n.message}`,xt.ConnectionFailed,"connection",!0,n)}return new ht(`Unknown connection error: ${n instanceof Error?n.message:String(n)}`,xt.ConnectionFailed,"connection",!0,n instanceof Error?n:new Error(String(n)))}function Dq(...n){if(n.length>0){const e=String(n[0]);e.includes(":error")?console.error(...n):e.includes(":warning")?console.warn(...n):e.includes(":info")?console.info(...n):e.includes(":verbose")?console.debug(...n):console.debug(...n)}}var y2={};const S2=typeof process<"u"&&y2&&y2.DEBUG||void 0;let K4,TP=[],EP=[];const PA=[];S2&&uR(S2);const Fd=Object.assign(n=>Y4(n),{enable:uR,enabled:dR,disable:Oq,log:Dq});function uR(n){K4=n,TP=[],EP=[];const e=n.split(",").map(t=>t.trim());for(const t of e)t.startsWith("-")?EP.push(t.substring(1)):TP.push(t);for(const t of PA)t.enabled=dR(t.namespace)}function dR(n){if(n.endsWith("*"))return!0;for(const e of EP)if(C2(n,e))return!1;for(const e of TP)if(C2(n,e))return!0;return!1}function C2(n,e){if(e.indexOf("*")===-1)return n===e;let t=e;if(e.indexOf("**")!==-1){const m=[];let v="";for(const C of e)C==="*"&&v==="*"||(v=C,m.push(C));t=m.join("")}let r=0,i=0;const s=t.length,o=n.length;let a=-1,l=-1;for(;r<o&&i<s;)if(t[i]==="*"){if(a=i,i++,i===s)return!0;for(;n[r]!==t[i];)if(r++,r===o)return!1;l=r,r++,i++;continue}else if(t[i]===n[r])i++,r++;else if(a>=0){if(i=a+1,r=l+1,r===o)return!1;for(;n[r]!==t[i];)if(r++,r===o)return!1;l=r,r++,i++;continue}else return!1;const c=r===n.length,u=i===t.length,h=i===t.length-1&&t[i]==="*";return c&&(u||h)}function Oq(){const n=K4||"";return uR(""),n}function Y4(n){const e=Object.assign(t,{enabled:dR(n),destroy:Bq,log:Fd.log,namespace:n,extend:Fq});function t(...r){e.enabled&&(r.length>0&&(r[0]=`${n} ${r[0]}`),e.log(...r))}return PA.push(e),e}function Bq(){const n=PA.indexOf(this);return n>=0?(PA.splice(n,1),!0):!1}function Fq(n){const e=Y4(`${this.namespace}:${n}`);return e.log=this.log,e}var A2={};const xP=["verbose","info","warning","error"],T2={verbose:400,info:300,warning:200,error:100};function E2(n,e){e.log=(...t)=>{n.log(...t)}}function x2(n){return xP.includes(n)}function J4(n){const e=new Set,t=typeof process<"u"&&A2&&A2[n.logLevelEnvVarName]||void 0;let r;const i=Fd(n.namespace);i.log=(...u)=>{Fd.log(...u)};function s(u){if(u&&!x2(u))throw new Error(`Unknown log level '${u}'. Acceptable values: ${xP.join(",")}`);r=u;const h=[];for(const m of e)o(m)&&h.push(m.namespace);Fd.enable(h.join(","))}t&&(x2(t)?s(t):console.error(`${n.logLevelEnvVarName} set to unknown log level '${t}'; logging is not enabled. Acceptable values: ${xP.join(", ")}.`));function o(u){return!!(r&&T2[u.level]<=T2[r])}function a(u,h){const m=Object.assign(u.extend(h),{level:h});if(E2(u,m),o(m)){const v=Fd.disable();Fd.enable(v+","+m.namespace)}return e.add(m),m}function l(){return r}function c(u){const h=i.extend(u);return E2(i,h),{error:a(h,"error"),warning:a(h,"warning"),info:a(h,"info"),verbose:a(h,"verbose")}}return{setLogLevel:s,getLogLevel:l,createClientLogger:c,logger:i}}J4({logLevelEnvVarName:"TYPESPEC_RUNTIME_LOG_LEVEL",namespace:"typeSpecRuntime"});const jq=J4({logLevelEnvVarName:"AZURE_LOG_LEVEL",namespace:"azure"});function Uq(n){return jq.createClientLogger(n)}const at=Uq("ai-voicelive");var an;(function(n){n.Disconnected="disconnected",n.Connecting="connecting",n.Connected="connected",n.Disconnecting="disconnecting"})(an||(an={}));class zq{constructor(e,t,r={}){q(this,"_websocketFactory");q(this,"_options");q(this,"_eventHandlers");q(this,"_state",an.Disconnected);q(this,"_previousState",an.Disconnected);q(this,"_websocket");q(this,"_abortController");this._websocketFactory=e,this._options=t,this._eventHandlers=r}async connect(e){if(this._state!==an.Connected){if(this._state===an.Connecting)throw new ht("Connection attempt already in progress",xt.InvalidState);this._setState(an.Connecting),this._abortController=new AbortController,e&&(e.aborted?this._abortController.abort():e.addEventListener("abort",()=>{var t;(t=this._abortController)==null||t.abort()}));try{this._websocket=this._websocketFactory(),this._setupWebSocketHandlers(),await this._websocket.connect(this._options.endpoint,this._options.protocols,this._abortController.signal),this._setState(an.Connected)}catch(t){throw this._setState(an.Disconnected),t instanceof ht?t:new ht(`Failed to connect: ${t instanceof Error?t.message:"Unknown error"}`,xt.ConnectionFailed,"connection_attempt",!0,t instanceof Error?t:new Error(String(t)))}}}async disconnect(e){var t;if(this._state!==an.Disconnected){(t=this._abortController)==null||t.abort(),this._setState(an.Disconnecting);try{this._websocket&&await this._websocket.disconnect(1e3,"Client disconnect")}finally{this._setState(an.Disconnected)}}}async send(e,t){if(!this._websocket||this._state!==an.Connected)throw new ht("Cannot send message: WebSocket not connected",xt.NotConnected);return this._websocket.send(e,t)}_setupWebSocketHandlers(){this._websocket&&(at.info("Setting up WebSocket event handlers"),this._websocket.onOpen(()=>{at.info("WebSocket connection opened")}),this._websocket.onClose((e,t)=>{this._handleConnectionLost(e,t)}),this._websocket.onError(e=>{this._handleConnectionError(e)}),this._websocket.onMessage(e=>{var t,r;(r=(t=this._eventHandlers).onMessage)==null||r.call(t,e)}))}_handleConnectionLost(e,t){var i,s;if(this._state===an.Disconnecting){this._setState(an.Disconnected);return}this._setState(an.Disconnected);let r;e===1e3?r=new ht("WebSocket connection closed unexpectedly",xt.ConnectionLost,"connection_lost"):r=Lq(e,t),(s=(i=this._eventHandlers).onError)==null||s.call(i,r)}_handleConnectionError(e){var r,i;const t=new ht(`WebSocket error: ${e.message}`,xt.WebSocketError,"websocket_error",!0,e);(i=(r=this._eventHandlers).onError)==null||i.call(r,t)}_setState(e){var t,r;this._state!==e&&(this._previousState=this._state,this._state=e,(r=(t=this._eventHandlers).onStateChange)==null||r.call(t,e,this._previousState))}get state(){return this._state}get isConnected(){return this._state===an.Connected}updateEventHandlers(e){Object.assign(this._eventHandlers,e)}}var wP;(function(n){n[n.Connecting=0]="Connecting",n[n.Open=1]="Open",n[n.Closing=2]="Closing",n[n.Closed=3]="Closed"})(wP||(wP={}));class Wq{constructor(e={}){q(this,"_ws");q(this,"_url");q(this,"_options");q(this,"_onOpen");q(this,"_onClose");q(this,"_onMessage");q(this,"_onError");this._options={connectionTimeoutInMs:3e4,maxMessageSize:1024*1024,...e}}async connect(e,t,r){if(this._ws&&this._ws.readyState!==WebSocket.CLOSED)throw new ht("WebSocket is already connected or connecting",xt.AlreadyConnected);return new Promise((i,s)=>{const o=setTimeout(()=>{s(new ht(`WebSocket connection timeout after ${this._options.connectionTimeoutInMs}ms`,xt.ConnectionTimeout))},this._options.connectionTimeoutInMs),a=()=>{clearTimeout(o),this._ws&&this._ws.close(),s(new ht("WebSocket connection aborted",xt.OperationCancelled))};if(r){if(r.aborted){a();return}r.addEventListener("abort",a)}try{const l=this._addHeadersToUrl(e,this._options.headers);this._ws=new WebSocket(l,t),this._ws.binaryType="arraybuffer",this._url=e,this._ws.addEventListener("open",()=>{var c;clearTimeout(o),r&&r.removeEventListener("abort",a),(c=this._onOpen)==null||c.call(this),i()}),this._ws.addEventListener("close",c=>{var u;clearTimeout(o),r&&r.removeEventListener("abort",a),(u=this._onClose)==null||u.call(this,c.code,c.reason)}),this._ws.addEventListener("message",c=>{var u,h;if(typeof c.data=="string")(u=this._onMessage)==null||u.call(this,c.data);else if(c.data instanceof ArrayBuffer)(h=this._onMessage)==null||h.call(this,c.data);else if(c.data instanceof Blob){const m=new FileReader;m.onload=()=>{var v;m.result instanceof ArrayBuffer&&((v=this._onMessage)==null||v.call(this,m.result))},m.onerror=()=>{var v;(v=this._onError)==null||v.call(this,new ht("Failed to read blob data",xt.WebSocketError,"blob_read"))},m.readAsArrayBuffer(c.data)}}),this._ws.addEventListener("error",()=>{var u;clearTimeout(o),r&&r.removeEventListener("abort",a);const c=new ht("WebSocket connection failed",xt.WebSocketError,"websocket_connection",!0);(u=this._onError)==null||u.call(this,c),s(c)})}catch(l){clearTimeout(o),r&&r.removeEventListener("abort",a),s(new ht(`Failed to create WebSocket: ${l instanceof Error?l.message:"Unknown error"}`,xt.ConnectionFailed,"websocket_creation",!1,l instanceof Error?l:new Error(String(l))))}})}async disconnect(e=1e3,t){if(!(!this._ws||this._ws.readyState===WebSocket.CLOSED))return new Promise(r=>{const i=()=>{r()};this._ws.readyState===WebSocket.CLOSING?this._ws.addEventListener("close",i,{once:!0}):(this._ws.addEventListener("close",i,{once:!0}),this._ws.close(e,t))})}async send(e,t){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)throw new ht("WebSocket is not connected",xt.NotConnected);if(t!=null&&t.aborted)throw new ht("Send operation aborted",xt.OperationCancelled);return new Promise((r,i)=>{const s=()=>{i(new ht("Send operation aborted",xt.OperationCancelled))};t&&t.addEventListener("abort",s,{once:!0});try{this._ws.send(e),t&&t.removeEventListener("abort",s),r()}catch(o){t&&t.removeEventListener("abort",s),i(new ht(`Failed to send WebSocket message: ${o instanceof Error?o.message:"Unknown error"}`,xt.WebSocketError,"message_send",!0,o instanceof Error?o:new Error(String(o))))}})}onOpen(e){this._onOpen=e}onClose(e){this._onClose=e}onMessage(e){this._onMessage=e}onError(e){this._onError=e}get isConnected(){var e;return((e=this._ws)==null?void 0:e.readyState)===WebSocket.OPEN}get readyState(){return this._ws?this._ws.readyState:wP.Closed}get url(){return this._url}_addHeadersToUrl(e,t){if(!t||Object.keys(t).length===0)return e;const r=new URL(e);for(const[i,s]of Object.entries(t)){const o=i.toLowerCase();if(o==="authorization")r.searchParams.set("authorization",s);else if(o==="api-key")r.searchParams.set("api-key",s);else if(o==="x-ms-client-request-id")r.searchParams.set("client-request-id",s);else{if(o==="user-agent")continue;r.searchParams.set(`h-${o}`,s)}}return r.toString()}}class Vq{create(e){return new Wq(e)}}class $q{parseIncomingMessage(e){try{let t;e instanceof ArrayBuffer?t=new TextDecoder().decode(e):t=e;const r=JSON.parse(t);return this._isServerEvent(r)?{type:"server",event:z7(r),raw:e}:this._isClientEvent(r)?{type:"client",event:r,raw:e}:null}catch(t){return at.error("Failed to parse incoming message:",t),{type:"server",event:{type:Zv.Error,error:{type:"error",code:"MessageParsingError",message:"Failed to parse incoming message data. "+(t instanceof Error?t.message:String(t))}},raw:e}}}serializeOutgoingMessage(e){return JSON.stringify(FH(e))}_isServerEvent(e){return e&&typeof e.type=="string"&&this._isValidServerEventType(e.type)}_isClientEvent(e){return e&&typeof e.type=="string"&&this._isValidClientEventType(e.type)}_isValidServerEventType(e){return Object.values(Zv).includes(e)}_isValidClientEventType(e){return Object.values(wo).includes(e)}}function Hq(n){return"key"in n&&typeof n.key=="string"}class Zq{constructor(e,t){q(this,"_accessToken");q(this,"_scope");q(this,"_tokenRefreshBuffer",300*1e3);q(this,"_credential");q(this,"_isApiKey");this._credential=e,this._isApiKey=Hq(e),this._scope=t||"https://cognitiveservices.azure.com/.default",at.info("CredentialHandler initialized",{credentialType:this._isApiKey?"KeyCredential":"TokenCredential",scope:this._scope})}async getAccessToken(){if(this._isApiKey){const t=this._credential;return at.info("Using API key for authentication"),t.key}const e=this._credential;if(this._accessToken&&this._isTokenValid(this._accessToken))return this._accessToken.token;try{at.info("Acquiring new access token",{scope:this._scope});const t=await e.getToken(this._scope);if(!t)throw new dv("Failed to acquire access token - credential returned null",xt.AuthenticationFailed);return this._accessToken=t,at.info("Successfully acquired access token",{expiresAt:new Date(this._accessToken.expiresOnTimestamp)}),this._accessToken.token}catch(t){throw at.error("Failed to obtain access token",{error:t,scope:this._scope}),t instanceof dv?t:new dv(`Failed to obtain access token: ${t instanceof Error?t.message:"Unknown error"}`,xt.AuthenticationFailed,t instanceof Error?t:new Error(String(t)))}}async getWebSocketUrl(e,t,r){const i=await this.getAccessToken(),s=new URL(e);return s.protocol=s.protocol==="https:"?"wss:":"ws:",s.pathname="/voice-live/realtime",s.searchParams.set("api-version",t),r&&s.searchParams.set("model",r),this._isApiKey&&s.searchParams.set("api-key",i),s.toString()}async getAuthHeaders(){const e=await this.getAccessToken(),t={"X-MS-Client-Request-ID":this._generateRequestId(),"User-Agent":"Azure-Voice-Live-SDK-JS/1.0.0"};return this._isApiKey?t["api-key"]=e:t.Authorization=`Bearer ${e}`,t}get credentialType(){return this._isApiKey?"key":"token"}get isApiKey(){return this._isApiKey}updateApiKey(e){if(!this._isApiKey)throw new dv("Cannot update API key on TokenCredential",xt.InvalidCredentials);const t=this._credential;if("update"in t&&typeof t.update=="function")t.update(e),at.info("API key updated");else throw new dv("KeyCredential does not support key updates",xt.InvalidCredentials)}_isTokenValid(e){const t=e.expiresOnTimestamp,r=Date.now();return t>r+this._tokenRefreshBuffer}_generateRequestId(){return`${Date.now()}-${Math.random().toString(36).substring(2,11)}`}}class qq{constructor(e,t){q(this,"_isActive",!0);q(this,"_handlers");q(this,"_subscriptionId");this._handlers=e,this._subscriptionId=t}get isActive(){return this._isActive}get subscriptionId(){return this._subscriptionId}async close(){this._isActive&&(this._isActive=!1,at.info("VoiceLive subscription closed",{subscriptionId:this._subscriptionId}))}async processConnectionEvent(e,t,r){var i,s,o,a,l,c;if(this._isActive)try{switch(e){case"connected":await((s=(i=this._handlers).onConnected)==null?void 0:s.call(i,t,r));break;case"disconnected":await((a=(o=this._handlers).onDisconnected)==null?void 0:a.call(o,t,r));break;case"error":await((c=(l=this._handlers).onError)==null?void 0:c.call(l,t,r));break}}catch(u){at.error(`Error in ${e} handler`,{error:u,subscriptionId:this._subscriptionId})}}async processServerEvent(e,t){var r,i,s,o,a,l,c,u,h,m,v,C,T,E,x,P,b,I,M,N,D,j,F,z,W,H,V,K,ee,G,X,Y,ce,ae,$,J,de,me,Te,le,se,ie,Se,re,pe,ne,ve,ge,Ie,fe,xe,$e,Ge,be,gt,vi,Ss,Cs,As,ye,st,wt,lr,Ts,Es,rd,Hl,Zl,id,ya,Sa,Ca;if(this._isActive)try{switch(await((i=(r=this._handlers).onServerEvent)==null?void 0:i.call(r,e,t)),e.type){case"session.created":await((o=(s=this._handlers).onSessionCreated)==null?void 0:o.call(s,e,t));break;case"session.updated":await((l=(a=this._handlers).onSessionUpdated)==null?void 0:l.call(a,e,t));break;case"session.avatar.connecting":await((u=(c=this._handlers).onSessionAvatarConnecting)==null?void 0:u.call(c,e,t));break;case"input_audio_buffer.committed":await((m=(h=this._handlers).onInputAudioBufferCommitted)==null?void 0:m.call(h,e,t));break;case"input_audio_buffer.cleared":await((C=(v=this._handlers).onInputAudioBufferCleared)==null?void 0:C.call(v,e,t));break;case"input_audio_buffer.speech_started":await((E=(T=this._handlers).onInputAudioBufferSpeechStarted)==null?void 0:E.call(T,e,t));break;case"input_audio_buffer.speech_stopped":await((P=(x=this._handlers).onInputAudioBufferSpeechStopped)==null?void 0:P.call(x,e,t));break;case"conversation.item.created":await((I=(b=this._handlers).onConversationItemCreated)==null?void 0:I.call(b,e,t));break;case"conversation.item.input_audio_transcription.completed":await((N=(M=this._handlers).onConversationItemInputAudioTranscriptionCompleted)==null?void 0:N.call(M,e,t));break;case"conversation.item.input_audio_transcription.failed":await((j=(D=this._handlers).onConversationItemInputAudioTranscriptionFailed)==null?void 0:j.call(D,e,t));break;case"conversation.item.input_audio_transcription.delta":await((z=(F=this._handlers).onConversationItemInputAudioTranscriptionDelta)==null?void 0:z.call(F,e,t));break;case"conversation.item.truncated":await((H=(W=this._handlers).onConversationItemTruncated)==null?void 0:H.call(W,e,t));break;case"conversation.item.deleted":await((K=(V=this._handlers).onConversationItemDeleted)==null?void 0:K.call(V,e,t));break;case"conversation.item.retrieved":await((G=(ee=this._handlers).onConversationItemRetrieved)==null?void 0:G.call(ee,e,t));break;case"response.created":await((Y=(X=this._handlers).onResponseCreated)==null?void 0:Y.call(X,e,t));break;case"response.done":await((ae=(ce=this._handlers).onResponseDone)==null?void 0:ae.call(ce,e,t));break;case"response.output_item.added":await((J=($=this._handlers).onResponseOutputItemAdded)==null?void 0:J.call($,e,t));break;case"response.output_item.done":await((me=(de=this._handlers).onResponseOutputItemDone)==null?void 0:me.call(de,e,t));break;case"response.content_part.added":await((le=(Te=this._handlers).onResponseContentPartAdded)==null?void 0:le.call(Te,e,t));break;case"response.content_part.done":await((ie=(se=this._handlers).onResponseContentPartDone)==null?void 0:ie.call(se,e,t));break;case"response.text.delta":await((re=(Se=this._handlers).onResponseTextDelta)==null?void 0:re.call(Se,e,t));break;case"response.text.done":await((ne=(pe=this._handlers).onResponseTextDone)==null?void 0:ne.call(pe,e,t));break;case"response.audio.delta":await((ge=(ve=this._handlers).onResponseAudioDelta)==null?void 0:ge.call(ve,e,t));break;case"response.audio.done":await((fe=(Ie=this._handlers).onResponseAudioDone)==null?void 0:fe.call(Ie,e,t));break;case"response.audio_transcript.delta":await(($e=(xe=this._handlers).onResponseAudioTranscriptDelta)==null?void 0:$e.call(xe,e,t));break;case"response.audio_transcript.done":await((be=(Ge=this._handlers).onResponseAudioTranscriptDone)==null?void 0:be.call(Ge,e,t));break;case"response.animation_blendshapes.delta":await((vi=(gt=this._handlers).onResponseAnimationBlendshapeDelta)==null?void 0:vi.call(gt,e,t));break;case"response.animation_blendshapes.done":await((Cs=(Ss=this._handlers).onResponseAnimationBlendshapeDone)==null?void 0:Cs.call(Ss,e,t));break;case"response.animation_viseme.delta":await((ye=(As=this._handlers).onResponseAnimationVisemeDelta)==null?void 0:ye.call(As,e,t));break;case"response.animation_viseme.done":await((wt=(st=this._handlers).onResponseAnimationVisemeDone)==null?void 0:wt.call(st,e,t));break;case"response.audio_timestamp.delta":await((Ts=(lr=this._handlers).onResponseAudioTimestampDelta)==null?void 0:Ts.call(lr,e,t));break;case"response.audio_timestamp.done":await((rd=(Es=this._handlers).onResponseAudioTimestampDone)==null?void 0:rd.call(Es,e,t));break;case"response.function_call_arguments.delta":await((Zl=(Hl=this._handlers).onResponseFunctionCallArgumentsDelta)==null?void 0:Zl.call(Hl,e,t));break;case"response.function_call_arguments.done":await((ya=(id=this._handlers).onResponseFunctionCallArgumentsDone)==null?void 0:ya.call(id,e,t));break;case"error":await((Ca=(Sa=this._handlers).onServerError)==null?void 0:Ca.call(Sa,e,t));break}}catch(ql){at.error(`Error in server event handler for ${e.type}`,{error:ql,eventType:e.type,subscriptionId:this._subscriptionId})}}}class Gq{constructor(){q(this,"_subscriptions",new Map);q(this,"_nextSubscriptionId",1)}createSubscription(e){const t=`sub_${this._nextSubscriptionId++}`,r=new qq(e,t);return this._subscriptions.set(t,r),at.info("VoiceLive subscription created",{subscriptionId:t}),r}removeSubscription(e){this._subscriptions.delete(e),at.info("VoiceLive subscription removed",{subscriptionId:e})}async processConnectionEvent(e,t,r){const i=Array.from(this._subscriptions.values()).filter(s=>s.isActive);await Promise.allSettled(i.map(s=>s.processConnectionEvent(e,t,r)))}async processServerEvent(e,t){const r=Array.from(this._subscriptions.values()).filter(i=>i.isActive);await Promise.allSettled(r.map(i=>i.processServerEvent(e,t)))}async closeAll(){const e=Array.from(this._subscriptions.values());await Promise.allSettled(e.map(t=>t.close())),this._subscriptions.clear()}get activeCount(){return Array.from(this._subscriptions.values()).filter(e=>e.isActive).length}}class Kq{constructor(e,t,r,i,s={}){q(this,"_endpoint");q(this,"_credentialHandler");q(this,"_options");q(this,"_messageParser");q(this,"_model");q(this,"_apiVersion");q(this,"_connectionManager");q(this,"_sessionId");q(this,"_activeTurnId");q(this,"_disposed",!1);q(this,"_subscriptionManager");this._endpoint=this._normalizeEndpoint(e),this._credentialHandler=new Zq(t),this._options=this._buildDefaultOptions(s),this._messageParser=new $q,this._model=i,this._apiVersion=r,this._subscriptionManager=new Gq,at.info("VoiceLiveSession created",{endpoint:this._endpoint,model:this._model,apiVersion:r,enableDebugLogging:this._options.enableDebugLogging})}async connect(e={}){if(this._ensureNotDisposed(),this.isConnected){at.info("VoiceLiveSession already connected");return}try{at.info("Connecting to Voice Live service",{endpoint:this._endpoint,model:this._model});const t=await this._credentialHandler.getWebSocketUrl(this._endpoint,this._apiVersion,this._model),r=await this._credentialHandler.getAuthHeaders(),i=new Vq;this._connectionManager=new zq(()=>i.create({headers:{...r},connectionTimeoutInMs:this._options.connectionTimeoutInMs,compression:!0}),{endpoint:t,connectionTimeout:e.timeoutInMs||this._options.connectionTimeoutInMs}),this._setupConnectionEventHandlers(),await this._connectionManager.connect(e.abortSignal),at.info("Successfully connected to Voice Live service")}catch(t){throw at.error("Failed to connect to Voice Live service",{error:t}),t instanceof ht?t:v2(t)}}async disconnect(){if(this._connectionManager){at.info("Disconnecting from Voice Live service");try{await this._connectionManager.disconnect()}catch(e){at.error("Error during disconnect",{error:e})}finally{this._connectionManager=void 0,this._sessionId=void 0,this._activeTurnId=void 0,at.info("Disconnected from Voice Live service")}}}subscribe(e){return this._ensureNotDisposed(),at.info("Creating VoiceLive session subscription"),this._subscriptionManager.createSubscription(e)}async sendEvent(e,t={}){this._ensureConnected(),await this._sendEvent(e,t)}async updateSession(e,t={}){this._ensureConnected();const r={type:wo.SessionUpdate,session:e,eventId:this._generateEventId()};await this._sendEvent(r,t)}async sendAudio(e,t={}){this._ensureConnected();const r=this._arrayBufferToBase64(e);if(t.turnId){const i={type:wo.InputAudioTurnAppend,audio:r,turnId:t.turnId,eventId:this._generateEventId()};await this._sendEvent(i,t)}else{const i={type:wo.InputAudioBufferAppend,audio:r,eventId:this._generateEventId()};await this._sendEvent(i,t)}}async startAudioTurn(e={}){this._ensureConnected();const t=e.turnId||this._generateTurnId();this._activeTurnId=t;const r={type:wo.InputAudioTurnStart,turnId:t,eventId:this._generateEventId()};return await this._sendEvent(r,e),t}async endAudioTurn(e,t={}){this._ensureConnected();const r=e||this._activeTurnId;if(!r)throw new ht("No active audio turn to end","INVALID_STATE");const i={type:wo.InputAudioTurnEnd,turnId:r,eventId:this._generateEventId()};await this._sendEvent(i,t),r===this._activeTurnId&&(this._activeTurnId=void 0)}async addConversationItem(e,t={}){this._ensureConnected();const r={type:wo.ConversationItemCreate,item:e,eventId:this._generateEventId()};await this._sendEvent(r,t)}get isConnected(){var e;return((e=this._connectionManager)==null?void 0:e.isConnected)||!1}get connectionState(){var e;return((e=this._connectionManager)==null?void 0:e.state)||an.Disconnected}get sessionId(){return this._sessionId}get activeTurnId(){return this._activeTurnId}async dispose(){if(!this._disposed){at.info("Disposing VoiceLiveSession");try{await this._subscriptionManager.closeAll(),await this.disconnect()}catch(e){at.error("Error during session disposal",{error:e})}finally{this._disposed=!0,at.info("VoiceLiveSession disposed")}}}_buildDefaultOptions(e){return{connectionTimeoutInMs:e.connectionTimeoutInMs||3e4,enableDebugLogging:e.enableDebugLogging??!1}}_normalizeEndpoint(e){return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`https://${e}`),e.replace(/\/$/,"")}_setupConnectionEventHandlers(){this._connectionManager&&this._connectionManager.updateEventHandlers({onStateChange:(e,t)=>{at.info("Connection state changed",{state:e,previousState:t}),e===an.Connected&&t===an.Connecting?this._notifyConnectionEvent("connected",{connectionId:`conn_${Date.now()}`,timestamp:new Date}):e===an.Disconnected&&t===an.Connected&&(this._notifyConnectionEvent("disconnected",{code:1006,reason:"Connection lost during session",wasClean:!1,timestamp:new Date}),this._markSessionAsDead("Connection lost during session - session is permanently unusable"))},onMessage:e=>{this._handleIncomingMessage(e)},onError:e=>{at.error("Connection error - marking session as dead",{error:e}),this._notifyConnectionEvent("error",{error:e,context:"WebSocket connection error",recoverable:!1,timestamp:new Date}),this._markSessionAsDead(`Connection error: ${e.message}`)}})}_markSessionAsDead(e){this._disposed||(at.error("Session marked as permanently dead",{reason:e}),this._disposed=!0,this._connectionManager=void 0,this._sessionId=void 0,this._activeTurnId=void 0)}_handleIncomingMessage(e){try{at.info("Message received",{type:typeof e,size:typeof e=="string"?e.length:e.byteLength});const t=this._messageParser.parseIncomingMessage(e);t&&t.type==="server"&&this._handleServerEvent(t.event)}catch(t){at.error("Error handling incoming message",{error:t})}}_handleServerEvent(e){var t;e.type===Zv.SessionCreated&&((t=e.session)!=null&&t.id)&&(this._sessionId=e.session.id,at.info("Session created",{sessionId:this._sessionId})),this._notifyServerEvent(e)}_notifyConnectionEvent(e,t){const r={endpoint:this._endpoint,sessionId:this._sessionId,timestamp:new Date,model:this._model};this._subscriptionManager.processConnectionEvent(e,t,r).catch(i=>{at.error("Error processing connection event in handlers",{eventType:e,error:i})})}_notifyServerEvent(e){if(!this._sessionId)return;const t={endpoint:this._endpoint,sessionId:this._sessionId,timestamp:new Date,model:this._model,conversationId:void 0};this._subscriptionManager.processServerEvent(e,t).catch(r=>{at.error("Error processing server event in handlers",{eventType:e.type,error:r})})}async _sendEvent(e,t){var r;if(!((r=this._connectionManager)!=null&&r.isConnected))throw new ht("Not connected to Voice Live service","NOT_CONNECTED");try{const i=this._messageParser.serializeOutgoingMessage(e);await this._connectionManager.send(i,t.abortSignal),at.info("Sent event",{type:e.type,eventId:e.eventId})}catch(i){throw i instanceof ht?i:v2(i)}}_ensureConnected(){if(this._ensureNotDisposed(),!this.isConnected)throw new ht("Must be connected to Voice Live service","NOT_CONNECTED")}_ensureNotDisposed(){if(this._disposed)throw new ht("Session is permanently dead and cannot be used. Create a new session to continue.","SESSION_DEAD")}_generateEventId(){return`evt_${Date.now()}_${Math.random().toString(36).substring(2,11)}`}_generateTurnId(){return`turn_${Date.now()}_${Math.random().toString(36).substring(2,11)}`}_arrayBufferToBase64(e){const t=e instanceof ArrayBuffer?new Uint8Array(e):e;let r="";for(let i=0;i<t.byteLength;i++)r+=String.fromCharCode(t[i]);return btoa(r)}}class X4{constructor(e,t,r={}){q(this,"_endpoint");q(this,"_credential");q(this,"_options");this._endpoint=this._normalizeEndpoint(e),this._credential=t,this._options=this._buildDefaultOptions(r),at.info("VoiceLiveClient created",{endpoint:this._endpoint,apiVersion:this._options.apiVersion})}createSession(e,t){const r=typeof e=="string"?e:e.model;if(!r)throw new Error("Model name is required. Provide either a model string or RequestSession with model property.");const i={...this._options.defaultSessionOptions,...t},s=new Kq(this._endpoint,this._credential,this._options.apiVersion,r,i);return typeof e!="string"&&(s._initialSessionConfig=e),at.info("VoiceLiveSession created",{model:r}),s}async startSession(e,t){const r=this.createSession(e,t);return await r.connect(),typeof e!="string"&&await r.updateSession(e),r}get endpoint(){return this._endpoint}get apiVersion(){return this._options.apiVersion}_buildDefaultOptions(e){return{apiVersion:e.apiVersion||"2025-10-01",defaultSessionOptions:e.defaultSessionOptions||{}}}_normalizeEndpoint(e){return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`https://${e}`),e.replace(/\/$/,"")}}class Q4{constructor(){q(this,"audioContext");q(this,"analyser");q(this,"dataArray");q(this,"nextStartTime",0);q(this,"sources",[]);q(this,"animationFrameId",null);q(this,"onVolume",null);q(this,"onPlaybackComplete",null);q(this,"onPlaybackStart",null);q(this,"hasStartedPlayback",!1);q(this,"firstChunkQueueTime",0);this.audioContext=new AudioContext,this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2048,this.analyser.smoothingTimeConstant=.85,this.analyser.connect(this.audioContext.destination),this.dataArray=new Uint8Array(this.analyser.frequencyBinCount)}setVolumeCallback(e){this.onVolume=e}setPlaybackCompleteCallback(e){this.onPlaybackComplete=e}setPlaybackStartCallback(e){this.onPlaybackStart=e}async resume(){this.audioContext.state==="closed"&&(this.audioContext=new AudioContext,this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2048,this.analyser.smoothingTimeConstant=.85,this.analyser.connect(this.audioContext.destination),this.dataArray=new Uint8Array(this.analyser.frequencyBinCount)),this.audioContext.state!=="running"&&await this.audioContext.resume()}startVolumeMonitoring(){if(this.animationFrameId!==null)return;const e=()=>{this.analyser.getByteFrequencyData(this.dataArray);let t=0;for(let i=0;i<this.dataArray.length;i++)t+=this.dataArray[i];const r=t/this.dataArray.length;this.onVolume&&this.onVolume(r),this.sources.length>0?this.animationFrameId=requestAnimationFrame(e):(this.animationFrameId=null,this.onVolume&&this.onVolume(0),this.onPlaybackComplete&&this.onPlaybackComplete())};this.animationFrameId=requestAnimationFrame(e)}enqueuePcm16(e,t=16e3){const r=RH(e),i=this.audioContext.createBuffer(1,r.length,t);i.getChannelData(0).set(r);const s=this.audioContext.createBufferSource();s.buffer=i,s.connect(this.analyser);const o=this.audioContext.currentTime;this.hasStartedPlayback?this.nextStartTime<o&&(this.nextStartTime=o):this.nextStartTime=o+.05;const a=this.nextStartTime;if(this.nextStartTime+=i.duration,!this.hasStartedPlayback){this.hasStartedPlayback=!0,this.firstChunkQueueTime=performance.now();const l=(a-o)*1e3;if(console.log(`[PCM Player] First chunk queued - will start in ${l.toFixed(0)}ms (buffer duration: ${(i.duration*1e3).toFixed(0)}ms)`),this.onPlaybackStart){const c=this.firstChunkQueueTime+l;this.onPlaybackStart(c)}}s.onended=()=>{this.sources=this.sources.filter(l=>l!==s)},this.sources.push(s),s.start(a),this.startVolumeMonitoring()}stop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null);for(const e of this.sources)try{e.stop()}catch{}this.sources=[],this.nextStartTime=0,this.hasStartedPlayback=!1,this.onVolume&&this.onVolume(0)}}const Yq={turns:0,sessionStartMs:0,inputAudioSeconds:0,cachedAudioSeconds:0,outputAudioSeconds:0,inputTextTokens:0,cachedTextTokens:0,outputTextTokens:0,inputAudioTokens:0,cachedAudioTokens:0,outputAudioTokens:0,startLatencies:[],endLatencies:[]};function Jq(n,e){const t=n.inputAudioTokens+e.inputTokenDetails.audioTokens,r=n.outputAudioTokens+e.outputTokenDetails.audioTokens;return{...n,inputTextTokens:n.inputTextTokens+e.inputTokenDetails.textTokens,inputAudioTokens:t,inputAudioSeconds:t/10,cachedTextTokens:n.cachedTextTokens+e.inputTokenDetails.cachedTokensDetails.textTokens,cachedAudioTokens:n.cachedAudioTokens+e.inputTokenDetails.cachedTokensDetails.audioTokens,outputTextTokens:n.outputTextTokens+e.outputTokenDetails.textTokens,outputAudioTokens:r,outputAudioSeconds:r/20}}function Xq(n,e){if(n.length===0)return 0;const t=[...n].sort((i,s)=>i-s),r=Math.ceil(e/100*t.length)-1;return t[Math.max(0,r)]}function w2(n){return n.length===0?0:n.reduce((e,t)=>e+t,0)/n.length}const Qq={pro:{text:{inputText:5.5,cachedText:2.75,outputText:22,inputAudio:17,cachedAudio:2.75,outputAudio:38},"azure-standard":{inputText:5.5,cachedText:2.75,outputText:22,inputAudio:17,cachedAudio:2.75,outputAudio:38},"native-audio":{inputText:5.5,cachedText:2.75,outputText:22,inputAudio:44,cachedAudio:2.75,outputAudio:88}},standard:{text:{inputText:.66,cachedText:.33,outputText:2.64,inputAudio:15,cachedAudio:.33,outputAudio:33},"azure-standard":{inputText:.66,cachedText:.33,outputText:2.64,inputAudio:15,cachedAudio:.33,outputAudio:33},"native-audio":{inputText:.66,cachedText:.33,outputText:2.64,inputAudio:11,cachedAudio:.33,outputAudio:22}},lite:{text:{inputText:.11,cachedText:.04,outputText:.44,inputAudio:15,cachedAudio:.04,outputAudio:33},"azure-standard":{inputText:.11,cachedText:.04,outputText:.44,inputAudio:15,cachedAudio:.04,outputAudio:33},"native-audio":{inputText:.11,cachedText:.04,outputText:.44,inputAudio:4,cachedAudio:.04,outputAudio:8}}};function eG(n,e="standard",t="azure-standard"){const r=t==="openai"?"native-audio":"azure-standard",i=Qq[e][r],s=n.inputTextTokens/1e6*i.inputText,o=n.cachedTextTokens/1e6*i.cachedText,a=n.outputTextTokens/1e6*i.outputText,l=n.inputAudioTokens/1e6*i.inputAudio,c=n.cachedAudioTokens/1e6*i.cachedAudio,u=n.outputAudioTokens/1e6*i.outputAudio;return s+o+a+l+c+u}class tG{constructor(e){q(this,"client");q(this,"session");q(this,"subscription");q(this,"state",{isConnected:!1,isMicOn:!1,logs:[],turns:[],totals:Yq});q(this,"turnMap",new Map);q(this,"pcmPlayer",new Q4);q(this,"outputSampleRateHz",24e3);q(this,"currentSpeechStartMs",0);q(this,"currentSpeechStopMs",0);q(this,"events");this.events=e}get snapshot(){return this.state}setState(e){this.state={...this.state,...e},this.events.onState(this.state)}log(e,t){const r={id:`${Date.now()}_${Math.random().toString(16).slice(2)}`,ts:Date.now(),level:e,text:t},i=[...this.state.logs,r].slice(-2e3);this.setState({logs:i})}async connect(e){if(this.state.isConnected)return;if(!e.endpoint.trim())throw new Error("Missing endpoint");if(!e.apiKey.trim())throw new Error("Missing API key");this.log("info","Connecting"),this.client=new X4(e.endpoint.trim(),new W4(e.apiKey.trim()),{apiVersion:"2025-10-01",defaultSessionOptions:{enableDebugLogging:!1}});const t=$D(e);this.outputSampleRateHz=HD(t.outputAudioFormat),this.session=await this.client.startSession(t,{connectionTimeoutInMs:3e4}),await this.pcmPlayer.resume();const r={onConnected:async(i,s)=>{console.log("[VoiceLive Event] onConnected",{args:i,context:s}),this.log("info",`Connected (sessionId=${s.sessionId??"n/a"})`)},onDisconnected:async i=>{console.log("[VoiceLive Event] onDisconnected",i),this.log("info",`Disconnected (code=${i.code} reason=${i.reason})`)},onServerError:async i=>{console.log("[VoiceLive Event] onServerError",i),this.log("error",`Server error: ${i.error.message}`)},onConversationItemInputAudioTranscriptionDelta:async i=>{console.log("[VoiceLive Event] onConversationItemInputAudioTranscriptionDelta",i),i.delta&&this.log("input",i.delta)},onConversationItemInputAudioTranscriptionCompleted:async i=>{console.log("[VoiceLive Event] onConversationItemInputAudioTranscriptionCompleted",i),this.log("input",` ${i.transcript}`)},onInputAudioBufferSpeechStarted:async()=>{console.log("[VoiceLive Event] onInputAudioBufferSpeechStarted"),this.currentSpeechStartMs=Date.now(),this.log("info","Speech detected")},onInputAudioBufferSpeechStopped:async()=>{console.log("[VoiceLive Event] onInputAudioBufferSpeechStopped"),this.currentSpeechStopMs=Date.now(),this.log("info","Speech stopped")},onResponseCreated:async i=>{console.log("[VoiceLive Event] onResponseCreated",i);const s=i.response.id??`resp_${Date.now()}`,o={responseId:s,startedAtMs:Date.now(),speechStartedAtMs:this.currentSpeechStartMs,speechStoppedAtMs:this.currentSpeechStopMs};this.turnMap.set(s,{metrics:o,textBuffer:""}),this.log("info",`Response created (${s})`)},onResponseTextDelta:async i=>{console.log("[VoiceLive Event] onResponseTextDelta",i);const s=this.turnMap.get(i.responseId);s&&(s.metrics.firstTextDeltaAtMs||(s.metrics.firstTextDeltaAtMs=Date.now(),s.metrics.firstTokenLatencyMs=s.metrics.firstTextDeltaAtMs-s.metrics.startedAtMs),s.textBuffer+=i.delta,this.turnMap.set(i.responseId,s),this.events.onState(this.state))},onResponseTextDone:async i=>{console.log("[VoiceLive Event] onResponseTextDone",i);const s=i.responseId,o=this.turnMap.get(s),a=(i.text??"").trim();a&&(o&&(o.textBuffer=a,o.ttsLogged=!0,this.turnMap.set(s,o)),this.log("output",` ${a}`))},onResponseAudioDelta:async i=>{console.log("[VoiceLive Event] onResponseAudioDelta",{...i,delta:i.delta instanceof Uint8Array?`Uint8Array(${i.delta.length})`:i.delta});const s=i.delta;if(s instanceof Uint8Array){const o=this.turnMap.get(i.responseId);if(o&&!o.metrics.firstAudioDeltaAtMs){const a=Date.now();o.metrics.firstAudioDeltaAtMs=a,o.metrics.speechStartedAtMs&&(o.metrics.startLatencyMs=a-o.metrics.speechStartedAtMs),o.metrics.speechStoppedAtMs&&(o.metrics.endLatencyMs=a-o.metrics.speechStoppedAtMs),this.turnMap.set(i.responseId,o)}this.pcmPlayer.enqueuePcm16(s,this.outputSampleRateHz)}},onResponseDone:async i=>{console.log("[VoiceLive Event] onResponseDone",i);const s=i.response.id??"unknown",o=this.turnMap.get(s),a=Date.now();if(o){o.metrics.finishedAtMs=a,o.metrics.latencyMs=a-o.metrics.startedAtMs,o.metrics.assistantText=o.textBuffer.trim(),o.metrics.usage=i.response.usage;const l=[...this.state.turns,o.metrics];let c={...this.state.totals};if(c.turns=c.turns+1,o.metrics.startLatencyMs&&(c.startLatencies=[...c.startLatencies,o.metrics.startLatencyMs]),o.metrics.endLatencyMs&&(c.endLatencies=[...c.endLatencies,o.metrics.endLatencyMs]),i.response.usage&&(c=Jq(c,i.response.usage),c.cachedAudioSeconds=c.cachedAudioTokens/10),this.setState({turns:l,totals:c}),this.log("info",`Turn latency: ${o.metrics.latencyMs??0}ms; first-token: ${o.metrics.firstTokenLatencyMs??0}ms`),!o.ttsLogged){let u="(no text)";if(i.response.output&&i.response.output.length>0){const h=i.response.output[0];if(h!=null&&h.content&&Array.isArray(h.content)){const m=h.content.find(v=>v.type==="audio"&&v.transcript);m!=null&&m.transcript&&(u=m.transcript)}}this.log("output",` ${u}`)}i.response.usage&&this.log("info",`Usage: in=${i.response.usage.inputTokens} out=${i.response.usage.outputTokens} total=${i.response.usage.totalTokens}`)}else this.log("info",`Response done (${s})`);this.turnMap.delete(s)},onError:async i=>{console.log("[VoiceLive Event] onError",i),this.log("error",`${i.context}: ${i.error.message}`)}};this.subscription=this.session.subscribe(r),await this.session.updateSession(t),this.setState({isConnected:!0,totals:{...this.state.totals,sessionStartMs:Date.now()}}),this.log("info",`Session configured (model=${e.model})`)}async disconnect(){var e,t;this.setState({isMicOn:!1});try{this.pcmPlayer.stop(),await((e=this.subscription)==null?void 0:e.close()),this.subscription=void 0,await((t=this.session)==null?void 0:t.dispose()),this.session=void 0,this.client=void 0}finally{this.turnMap.clear(),this.setState({isConnected:!1}),this.log("info","Disconnected")}}async applyConfig(e){if(!this.session)throw new Error("Not connected");const t=$D(e);this.outputSampleRateHz=HD(t.outputAudioFormat),await this.session.updateSession(t),this.log("info","Session updated")}async sendText(e){if(!this.session)throw new Error("Not connected");const t=e.trim();t&&(this.log("user",t),await this.session.addConversationItem({type:"message",role:"user",content:[{type:"input_text",text:t}]}),await this.session.sendEvent({type:"response.create",response:{modalities:["text","audio"]}}))}async sendMicPcmChunk(e){this.session&&await this.session.sendAudio(e)}}function b2(n){return Number.isFinite(n)?n<1e3?`${n.toFixed(0)}ms`:`${(n/1e3).toFixed(2)}s`:"-"}function nG({endpoint:n,apiKey:e}){var Ss,Cs,As;const[t,r]=O.useState(()=>{var st;const ye=localStorage.getItem("voicelive.translator.config");if(!ye){const wt={...Nw};return wt.prompt=Id(wt.targetLanguage),wt}try{const wt=JSON.parse(ye),lr={...Nw,...wt};return lr.prompt=(st=lr.prompt)!=null&&st.trim()?lr.prompt:Id(lr.targetLanguage),lr}catch{const wt={...Nw};return wt.prompt=Id(wt.targetLanguage),wt}}),[i,s]=O.useState(""),[o,a]=O.useState(!1),[l,c]=O.useState(!1),[u,h]=O.useState([]),[m,v]=O.useState(!1),[C,T]=O.useState(!1),[E,x]=O.useState(()=>0),[P,b]=O.useState(()=>0),[I,M]=O.useState(()=>0),[N,D]=O.useState(()=>0),[j,F]=O.useState(()=>0),[z,W]=O.useState(()=>0),[H,V]=O.useState(()=>0),[K,ee]=O.useState(()=>0),[G,X]=O.useState(()=>0),[Y,ce]=O.useState(()=>0),[ae,$]=O.useState(()=>0),[J,de]=O.useState(()=>[]),[me,Te]=O.useState(()=>[]),le=O.useRef(null),se=O.useRef(null),ie=O.useRef(null),Se=O.useRef(t.targetLanguage);le.current||(le.current=new tG({onState:ye=>{a(ye.isConnected),h(ye.logs),x(ye.totals.turns),b(ye.totals.sessionStartMs),M(ye.totals.inputAudioSeconds),D(ye.totals.inputAudioTokens),F(ye.totals.cachedAudioSeconds),W(ye.totals.cachedAudioTokens),V(ye.totals.outputAudioSeconds),ee(ye.totals.outputAudioTokens),X(ye.totals.inputTextTokens),ce(ye.totals.cachedTextTokens),$(ye.totals.outputTextTokens),de(ye.totals.startLatencies),Te(ye.totals.endLatencies)}}));const re=le.current;O.useEffect(()=>{localStorage.setItem("voicelive.translator.config",JSON.stringify(t))},[t]),O.useEffect(()=>()=>{const ye=le.current;ye!=null&&ye.snapshot.isConnected&&(console.log("[VoiceLive Translator] Disconnecting on unmount"),ye.disconnect().catch(console.error))},[]),O.useEffect(()=>{const ye=Se.current;if(ye===t.targetLanguage)return;const st=Id(ye);t.prompt.trim()===st.trim()&&r(wt=>({...wt,prompt:Id(wt.targetLanguage)})),Se.current=t.targetLanguage},[t.targetLanguage,t.prompt]),O.useEffect(()=>{const ye=ie.current;ye&&(ye.scrollTop=ye.scrollHeight)},[u.length]);const pe=P>0?(Date.now()-P)/1e3:0,ne=J.length>0?w2(J):0,ve=J.length>0?Xq(J,90):0;me.length>0&&w2(me);const ge=O.useMemo(()=>{const ye=VD.find(st=>st.id===t.model);return!ye||ye.tier==="basic"?"standard":ye.tier},[t.model]),Ie=eG({inputAudioTokens:N,cachedAudioTokens:z,outputAudioTokens:K,inputTextTokens:G,cachedTextTokens:Y,outputTextTokens:ae},ge,t.voiceProvider),fe=pe>0?Ie/pe:0,xe=O.useMemo(()=>m?u:u.filter(ye=>ye.level!=="info"),[u,m]),$e=O.useMemo(()=>{var st;const ye={};for(const wt of VD)ye[st=wt.tier]??(ye[st]=[]),ye[wt.tier].push(wt.id);return ye},[]);async function Ge(){s("Connecting");try{await re.connect({...t,endpoint:n,apiKey:e}),s("Connected"),await gt()}catch(ye){s(ye instanceof Error?ye.message:String(ye))}}async function be(){s("Disconnecting");try{await vi(),await re.disconnect(),s("Disconnected")}catch(ye){s(ye instanceof Error?ye.message:String(ye))}}async function gt(){if(!l){if(!re.snapshot.isConnected){s("Connect first");return}se.current=new IH({sampleRate:16e3,bufferSize:4096},{onChunk:ye=>{re.sendMicPcmChunk(ye)},onState:(ye,st)=>{ye==="started"&&c(!0),ye==="stopped"&&c(!1),ye==="error"&&s(st??"Mic error")}}),await se.current.start()}}async function vi(){if(!se.current){c(!1);return}await se.current.stop(),se.current=null,c(!1)}return g.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[g.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[g.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 shadow-md",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-3xl font-bold",children:"Voice Live Translator"}),g.jsx("p",{className:"text-blue-100 mt-1",children:"Real-time voice translation powered by Azure Voice Live"})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${o?"bg-green-500/20 text-green-100":"bg-white/20 text-white/80"}`,children:[g.jsx("span",{className:`w-2 h-2 rounded-full ${o?"bg-green-400":"bg-white/60"}`}),o?"Connected":"Disconnected"]}),l&&g.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium bg-red-500/20 text-red-100",children:[g.jsx("span",{className:"w-2 h-2 rounded-full bg-red-400 animate-pulse"}),"Recording"]})]})]})}),g.jsx("div",{className:"bg-white border-b border-gray-200 p-4",children:g.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3",children:[g.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[g.jsx("p",{className:"text-xs text-gray-500",children:"Turns"}),g.jsx("p",{className:"text-sm font-semibold text-gray-900",children:E})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[g.jsx("p",{className:"text-xs text-gray-500",children:"Session"}),g.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[pe.toFixed(1),"s"]})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[g.jsx("p",{className:"text-xs text-gray-500",children:"Cost"}),g.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["$",Ie.toFixed(4)]})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[g.jsx("p",{className:"text-xs text-gray-500",children:"Cost/sec"}),g.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["$",fe.toFixed(5)]})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[g.jsx("p",{className:"text-xs text-gray-500",children:"Avg Latency"}),g.jsx("p",{className:"text-sm font-semibold text-gray-900",children:b2(ne)})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[g.jsx("p",{className:"text-xs text-gray-500",children:"P90 Latency"}),g.jsx("p",{className:"text-sm font-semibold text-gray-900",children:b2(ve)})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[g.jsx("p",{className:"text-xs text-gray-500",children:"Input Audio"}),g.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[I.toFixed(1),"s"]})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[g.jsx("p",{className:"text-xs text-gray-500",children:"Output Audio"}),g.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[H.toFixed(1),"s"]})]})]})}),g.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden p-4",children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsx("h2",{className:"font-medium text-gray-900",children:"Conversation Log"}),g.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[g.jsx("input",{type:"checkbox",checked:m,onChange:ye=>v(ye.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Show INFO"]})]}),g.jsxs("div",{ref:ie,className:"flex-1 overflow-y-auto bg-gray-900 rounded-lg p-4 font-mono text-sm",children:[xe.map(ye=>g.jsxs("div",{className:"flex gap-2 py-0.5",children:[g.jsx("span",{className:"text-gray-500 shrink-0",children:new Date(ye.ts).toLocaleTimeString()}),g.jsx("span",{className:`shrink-0 w-14 ${ye.level==="error"?"text-red-400":ye.level==="input"?"text-blue-400":ye.level==="output"?"text-green-400":ye.level==="user"?"text-yellow-400":"text-gray-400"}`,children:ye.level.toUpperCase()}),g.jsx("span",{className:"text-gray-100 break-all",children:ye.text})]},ye.id)),xe.length===0&&g.jsx("p",{className:"text-gray-500 text-center py-8",children:"No logs yet. Click Start to begin translation."})]})]}),g.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:g.jsx("div",{className:"flex items-center justify-between",children:g.jsx("p",{className:"text-xs text-gray-600",children:i||"Ready to translate"})})})]}),g.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-y-auto",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuration"}),g.jsxs("div",{className:"space-y-4 flex-1",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model"}),g.jsxs("select",{value:t.model,onChange:ye=>r(st=>({...st,model:ye.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[g.jsx("optgroup",{label:"Voice Live Pro",children:(Ss=$e.pro)==null?void 0:Ss.map(ye=>g.jsx("option",{value:ye,children:ye},ye))}),g.jsx("optgroup",{label:"Voice Live Basic",children:(Cs=$e.basic)==null?void 0:Cs.map(ye=>g.jsx("option",{value:ye,children:ye},ye))}),g.jsx("optgroup",{label:"Voice Live Lite",children:(As=$e.lite)==null?void 0:As.map(ye=>g.jsx("option",{value:ye,children:ye},ye))})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Language"}),g.jsx("select",{value:t.targetLanguage,onChange:ye=>r(st=>({...st,targetLanguage:ye.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:wH.map(ye=>g.jsxs("option",{value:ye.code,children:[ye.label," (",ye.code,")"]},ye.code))})]}),g.jsx("div",{className:"pt-2",children:o?g.jsxs("button",{onClick:be,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{d:"M6 6h12v12H6z"})}),"Stop"]}):g.jsxs("button",{onClick:Ge,disabled:!n||!e,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Translation"]})}),o&&g.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-md ${l?"bg-green-50 border border-green-200":"bg-gray-100 border border-gray-200"}`,children:[g.jsx("svg",{className:`w-5 h-5 ${l?"text-green-600":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),g.jsx("span",{className:`text-sm font-medium ${l?"text-green-700":"text-gray-500"}`,children:l?"Microphone active":"Microphone off"})]}),g.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[g.jsxs("button",{onClick:()=>T(!C),className:"flex items-center justify-between w-full text-sm font-medium text-gray-700",children:[g.jsx("span",{children:"Advanced Settings"}),g.jsx("svg",{className:`w-5 h-5 transition-transform ${C?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),C&&g.jsxs("div",{className:"mt-4 space-y-4",children:[g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prompt"}),g.jsx("button",{onClick:()=>r(ye=>({...ye,prompt:Id(ye.targetLanguage)})),className:"text-xs text-blue-600 hover:text-blue-800",children:"Reset"})]}),g.jsx("textarea",{value:t.prompt,onChange:ye=>r(st=>({...st,prompt:ye.target.value})),rows:6,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ASR Model"}),g.jsxs("select",{value:t.asrModel,onChange:ye=>r(st=>({...st,asrModel:ye.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[g.jsx("option",{value:"azure-speech",children:"azure-speech"}),g.jsx("option",{value:"gpt-4o-mini-transcribe",children:"gpt-4o-mini-transcribe"}),g.jsx("option",{value:"gpt-4o-transcribe",children:"gpt-4o-transcribe"}),g.jsx("option",{value:"whisper-1",children:"whisper-1"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ASR Languages"}),g.jsx("input",{type:"text",value:t.asrLanguages,onChange:ye=>r(st=>({...st,asrLanguages:ye.target.value})),placeholder:"en,zh or en-US,zh-CN",disabled:t.asrModel!=="azure-speech",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Voice Provider"}),g.jsxs("select",{value:t.voiceProvider,onChange:ye=>{const st=ye.target.value;r(wt=>({...wt,voiceProvider:st,voiceName:st==="openai"?"alloy":"en-US-AvaMultilingualNeural"}))},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[g.jsx("option",{value:"openai",children:"OpenAI"}),g.jsx("option",{value:"azure-standard",children:"Azure Neural"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Voice"}),g.jsx("select",{value:t.voiceName,onChange:ye=>r(st=>({...st,voiceName:ye.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:t.voiceProvider==="openai"?g.jsxs(g.Fragment,{children:[g.jsx("option",{value:"alloy",children:"Alloy (OpenAI)"}),g.jsx("option",{value:"echo",children:"Echo (OpenAI)"}),g.jsx("option",{value:"fable",children:"Fable (OpenAI)"}),g.jsx("option",{value:"nova",children:"Nova (OpenAI)"}),g.jsx("option",{value:"shimmer",children:"Shimmer (OpenAI)"})]}):g.jsxs(g.Fragment,{children:[g.jsx("option",{value:"en-US-AvaMultilingualNeural",children:"Ava (Female, conversational)"}),g.jsx("option",{value:"en-US-Ava:DragonHDLatestNeural",children:"Ava HD (Female, friendly)"}),g.jsx("option",{value:"en-US-AndrewMultilingualNeural",children:"Andrew (Male, conversational)"}),g.jsx("option",{value:"en-US-GuyMultilingualNeural",children:"Guy (Male, professional)"}),g.jsx("option",{value:"zh-CN-XiaochenMultilingualNeural",children:"Xiaochen (Female, assistant)"})]})})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Turn Detection"}),g.jsxs("select",{value:t.turnDetectionType,onChange:ye=>r(st=>({...st,turnDetectionType:ye.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[g.jsx("option",{value:"server_vad",children:"server_vad"}),g.jsx("option",{value:"azure_semantic_vad",children:"azure_semantic_vad"})]})]})]})]})]})]})]})}const rG={enabled:!1,type:"video",character:"lisa",style:"casual-sitting",customized:!1},Lw={endpoint:"",apiKey:"",model:"gpt-realtime",instructions:`You are a helpful and friendly AI assistant. Be concise and natural in your responses.

Please only respond in English.

Before calling weather, say something to acknowledge in A FEW words.`,voice:"en-us-ava:DragonHDLatestNeural",recognitionLanguage:"auto",turnDetectionType:"server_vad",removeFillerWords:!1,useNoiseSuppression:!1,useEchoCancellation:!1,temperature:.9,avatar:{...rG},enableFunctionCalling:!0,functions:{enableDateTime:!0,enableWeatherForecast:!0}},iG=[{id:"gpt-realtime",name:"GPT Realtime"},{id:"gpt-realtime-mini",name:"GPT Realtime Mini"},{id:"gpt-4o",name:"GPT-4o"},{id:"gpt-4o-mini",name:"GPT-4o Mini"},{id:"gpt-4.1",name:"GPT-4.1"},{id:"gpt-4.1-mini",name:"GPT-4.1 Mini"},{id:"gpt-5-chat",name:"GPT-5"},{id:"gpt-5-mini",name:"GPT-5 Mini"}],sG=[{code:"auto",name:"Auto Detect"},{code:"en-US",name:"English (US)"},{code:"en-GB",name:"English (UK)"},{code:"zh-CN",name:"Chinese (Simplified)"},{code:"zh-TW",name:"Chinese (Traditional)"},{code:"ja-JP",name:"Japanese"},{code:"ko-KR",name:"Korean"},{code:"de-DE",name:"German"},{code:"fr-FR",name:"French"},{code:"es-ES",name:"Spanish (Spain)"},{code:"es-MX",name:"Spanish (Mexico)"},{code:"it-IT",name:"Italian"},{code:"pt-BR",name:"Portuguese (Brazil)"},{code:"hi-IN",name:"Hindi"}],P2=[{id:"en-us-ava:DragonHDLatestNeural",name:"Ava (DragonHD)"},{id:"en-us-andrew:DragonHDLatestNeural",name:"Andrew (DragonHD)"},{id:"en-us-emma:DragonHDLatestNeural",name:"Emma (DragonHD)"},{id:"en-us-steffan:DragonHDLatestNeural",name:"Steffan (DragonHD)"},{id:"zh-cn-xiaochen:DragonHDLatestNeural",name:"Xiaochen (DragonHD)"},{id:"ja-jp-masaru:DragonHDLatestNeural",name:"Masaru (DragonHD)"},{id:"de-DE-Seraphina:DragonHDLatestNeural",name:"Seraphina (DragonHD)"},{id:"en-US-AvaMultilingualNeural",name:"Ava Multilingual"},{id:"en-US-AndrewMultilingualNeural",name:"Andrew Multilingual"},{id:"en-US-EmmaMultilingualNeural",name:"Emma Multilingual"},{id:"en-US-BrianMultilingualNeural",name:"Brian Multilingual"},{id:"zh-CN-XiaoxiaoMultilingualNeural",name:"Xiaoxiao Multilingual"},{id:"en-us-phoebe:MAI-Voice-1",name:"Phoebe (MAI)"},{id:"en-us-benjamin:MAI-Voice-1",name:"Benjamin (MAI)"},{id:"alloy",name:"Alloy (OpenAI)"},{id:"ash",name:"Ash (OpenAI)"},{id:"ballad",name:"Ballad (OpenAI)"},{id:"coral",name:"Coral (OpenAI)"},{id:"echo",name:"Echo (OpenAI)"},{id:"sage",name:"Sage (OpenAI)"},{id:"shimmer",name:"Shimmer (OpenAI)"},{id:"verse",name:"Verse (OpenAI)"}];function eU(n=!1){return n?P2:P2.filter(e=>!e.id.includes(":MAI-Voice-"))}eU(!1);const EC=[{id:"lisa-casual-sitting",name:"Lisa (Casual Sitting)",character:"lisa",style:"casual-sitting"},{id:"harry-business",name:"Harry (Business)",character:"harry",style:"business"},{id:"harry-casual",name:"Harry (Casual)",character:"harry",style:"casual"},{id:"harry-youthful",name:"Harry (Youthful)",character:"harry",style:"youthful"},{id:"jeff-business",name:"Jeff (Business)",character:"jeff",style:"business"},{id:"jeff-formal",name:"Jeff (Formal)",character:"jeff",style:"formal"},{id:"lori-casual",name:"Lori (Casual)",character:"lori",style:"casual"},{id:"lori-formal",name:"Lori (Formal)",character:"lori",style:"formal"},{id:"lori-graceful",name:"Lori (Graceful)",character:"lori",style:"graceful"},{id:"max-business",name:"Max (Business)",character:"max",style:"business"},{id:"max-casual",name:"Max (Casual)",character:"max",style:"casual"},{id:"max-formal",name:"Max (Formal)",character:"max",style:"formal"},{id:"meg-business",name:"Meg (Business)",character:"meg",style:"business"},{id:"meg-casual",name:"Meg (Casual)",character:"meg",style:"casual"},{id:"meg-formal",name:"Meg (Formal)",character:"meg",style:"formal"}],R2=[{id:"adrian",name:"Adrian"},{id:"amara",name:"Amara"},{id:"amira",name:"Amira"},{id:"anika",name:"Anika"},{id:"bianca",name:"Bianca"},{id:"camila",name:"Camila"},{id:"carlos",name:"Carlos"},{id:"clara",name:"Clara"},{id:"darius",name:"Darius"},{id:"diego",name:"Diego"},{id:"elise",name:"Elise"},{id:"farhan",name:"Farhan"},{id:"faris",name:"Faris"},{id:"gabrielle",name:"Gabrielle"},{id:"hyejin",name:"Hyejin"},{id:"imran",name:"Imran"},{id:"isabella",name:"Isabella"},{id:"layla",name:"Layla"},{id:"ling",name:"Ling"},{id:"liwei",name:"Liwei"},{id:"marcus",name:"Marcus"},{id:"matteo",name:"Matteo"},{id:"rahul",name:"Rahul"},{id:"rana",name:"Rana"},{id:"ren",name:"Ren"},{id:"riya",name:"Riya"},{id:"sakura",name:"Sakura"},{id:"simone",name:"Simone"},{id:"zayd",name:"Zayd"},{id:"zoe",name:"Zoe"}];function I2(){return`${Date.now()}_${Math.random().toString(16).slice(2)}`}class oG{constructor(e){q(this,"client");q(this,"session");q(this,"subscription");q(this,"pcmPlayer",new Q4);q(this,"peerConnection");q(this,"avatarConfig");q(this,"pendingIceServers");q(this,"state",{isConnected:!1,isRecording:!1,isSpeaking:!1,isAvatarConnected:!1,messages:[],statusText:"",sessionId:""});q(this,"currentResponseText","");q(this,"currentResponseId","");q(this,"currentResponseMessageId","");q(this,"currentFunctionCallName","");q(this,"currentFunctionCallArgs","");q(this,"currentFunctionCallId","");q(this,"pendingFunctionResult",null);q(this,"currentUserTranscript","");q(this,"currentUserMessageId","");q(this,"isResponseInProgress",!1);q(this,"userSpeechEndTime",null);q(this,"firstAudioReceived",!1);q(this,"currentTurnLatency",null);q(this,"events");this.events=e}get snapshot(){return this.state}getCurrentTurnLatency(){return this.currentTurnLatency}getUserSpeechEndTime(){return this.userSpeechEndTime}setCurrentTurnLatency(e){this.currentTurnLatency=e}markSpeechEndByClientVAD(){this.userSpeechEndTime=performance.now(),this.firstAudioReceived=!1;const e=new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3});console.log(` [VoiceLive] Speech end detected by client VAD at ${e} - starting latency measurement`)}setPlaybackVolumeCallback(e){this.pcmPlayer.setVolumeCallback(e)}setPlaybackCompleteCallback(e){this.pcmPlayer.setPlaybackCompleteCallback(e)}setPlaybackStartCallback(e){this.pcmPlayer.setPlaybackStartCallback(e)}setState(e){this.state={...this.state,...e},this.events.onState(this.state)}addMessage(e,t){const r={id:I2(),type:e,content:t,timestamp:Date.now()};return this.setState({messages:[...this.state.messages,r]}),r.id}addStatusMessage(e){this.addMessage("status",e)}updateLastMessage(e){console.log("[VoiceLive Chat] Updating last message with:",e);const t=[...this.state.messages];if(t.length>0){const r=t[t.length-1];console.log("[VoiceLive Chat] Last message type:",r.type),t[t.length-1]={...r,content:e},this.setState({messages:t})}else console.warn("[VoiceLive Chat] No messages to update!")}updateMessageById(e,t){const r=[...this.state.messages],i=r.findIndex(s=>s.id===e);i!==-1?(r[i]={...r[i],content:t},this.setState({messages:r})):console.warn("[VoiceLive Chat] Message not found:",e)}async sendPendingFunctionResult(){if(this.pendingFunctionResult&&this.session){console.log("[VoiceLive Chat] Sending pending function result to server...");const{callId:e,output:t}=this.pendingFunctionResult;this.pendingFunctionResult=null,await this.session.addConversationItem({type:"function_call_output",callId:e,output:t}),console.log("[VoiceLive Chat] Triggering response for function result..."),await this.session.sendEvent({type:"response.create",response:{modalities:["text","audio"]}})}}buildAvatarConfig(e){if(!e.enabled||e.type==="none")return;const t={codec:"h264"};return e.customized&&e.customAvatarName?e.type==="photo"?{type:"photo-avatar",model:"vasa-1",character:e.customAvatarName,customized:!0,video:t}:{type:"video-avatar",character:e.customAvatarName,customized:!0,video:t}:e.type==="photo"?{type:"photo-avatar",model:"vasa-1",character:e.character,customized:!1,video:t}:{type:"video-avatar",character:e.character,style:e.style,customized:!1,video:t}}buildSessionConfig(e){const t=!e.voice.includes("-")&&!e.voice.includes(":"),r=this.buildAvatarConfig(e.avatar),i=["text","audio"];r&&i.push("avatar");const o=e.model.includes("gpt-5")?1:e.temperature,a=[];return e.enableFunctionCalling&&(e.functions.enableDateTime&&a.push({type:"function",name:"getCurrentDateTime",description:"Get the current date and time in ISO 8601 format with timezone information",parameters:{type:"object",properties:{},required:[]}}),e.functions.enableWeatherForecast&&a.push({type:"function",name:"getWeatherForecast",description:"Get a detailed 7-day weather forecast for the user's location. This is a long-running operation that takes about 10 seconds to fetch comprehensive weather data.",parameters:{type:"object",properties:{},required:[]}})),{modalities:i,model:e.model,instructions:e.instructions,voice:t?e.voice:{name:e.voice,type:"azure-standard"},inputAudioFormat:"pcm16",outputAudioFormat:"pcm16",inputAudioTranscription:{model:e.model.includes("gpt")&&e.model.includes("realtime")?"whisper-1":"azure-speech",language:e.recognitionLanguage==="auto"?void 0:e.recognitionLanguage},turnDetection:{type:e.turnDetectionType,removeFillerWords:e.removeFillerWords},temperature:o,inputAudioNoiseReduction:e.useNoiseSuppression?{type:"azure_deep_noise_suppression"}:void 0,inputAudioEchoCancellation:e.useEchoCancellation?{type:"server_echo_cancellation"}:void 0,avatar:r,tools:a.length>0?a:void 0}}async initPeerConnectionWithIceServers(e){var i;console.log("[VoiceLive Chat] initPeerConnectionWithIceServers called"),console.log("[VoiceLive Chat] ICE servers count:",e.length),this.peerConnection=new RTCPeerConnection({iceServers:e}),console.log("[VoiceLive Chat] RTCPeerConnection created"),this.peerConnection.ontrack=s=>{console.log("[VoiceLive Chat] ontrack event - track kind:",s.track.kind,"streams:",s.streams.length),this.events.onAvatarTrack&&this.events.onAvatarTrack(s)},this.peerConnection.oniceconnectionstatechange=()=>{var s,o,a,l;console.log("[VoiceLive Chat] ICE connection state:",(s=this.peerConnection)==null?void 0:s.iceConnectionState),((o=this.peerConnection)==null?void 0:o.iceConnectionState)==="connected"?this.setState({isAvatarConnected:!0,statusText:"Avatar connected"}):(((a=this.peerConnection)==null?void 0:a.iceConnectionState)==="disconnected"||((l=this.peerConnection)==null?void 0:l.iceConnectionState)==="failed")&&this.setState({isAvatarConnected:!1})},this.peerConnection.onconnectionstatechange=()=>{var s;console.log("[VoiceLive Chat] Connection state:",(s=this.peerConnection)==null?void 0:s.connectionState)},this.peerConnection.onsignalingstatechange=()=>{var s;console.log("[VoiceLive Chat] Signaling state:",(s=this.peerConnection)==null?void 0:s.signalingState)},this.peerConnection.addTransceiver("video",{direction:"sendrecv"}),this.peerConnection.addTransceiver("audio",{direction:"sendrecv"}),console.log("[VoiceLive Chat] Transceivers added"),this.peerConnection.createDataChannel("eventChannel"),console.log("[VoiceLive Chat] Data channel created"),this.peerConnection.addEventListener("datachannel",s=>{const o=s.channel;console.log("[VoiceLive Chat] Data channel received:",o.label),o.onmessage=a=>{console.log("[VoiceLive Chat] WebRTC data channel message:",a.data)},o.onclose=()=>{console.log("[VoiceLive Chat] Data channel closed")}}),console.log("[VoiceLive Chat] Creating offer...");const t=await this.peerConnection.createOffer();console.log("[VoiceLive Chat] Offer created, type:",t.type),await this.peerConnection.setLocalDescription(t),console.log("[VoiceLive Chat] Local description set"),console.log("[VoiceLive Chat] Waiting for ICE gathering..."),await new Promise(s=>{var o;((o=this.peerConnection)==null?void 0:o.iceGatheringState)==="complete"?(console.log("[VoiceLive Chat] ICE gathering already complete"),s()):(this.peerConnection.onicegatheringstatechange=()=>{var a,l;console.log("[VoiceLive Chat] ICE gathering state:",(a=this.peerConnection)==null?void 0:a.iceGatheringState),((l=this.peerConnection)==null?void 0:l.iceGatheringState)==="complete"&&s()},setTimeout(()=>{console.log("[VoiceLive Chat] ICE gathering timeout (2s)"),s()},2e3))});const r=this.peerConnection.localDescription;if(console.log("[VoiceLive Chat] Local description:",r==null?void 0:r.type,"SDP length:",(i=r==null?void 0:r.sdp)==null?void 0:i.length),r&&this.session){const s=btoa(JSON.stringify(r));console.log("[VoiceLive Chat] Sending client SDP (base64 encoded), length:",s.length);const o={type:"session.avatar.connect",clientSdp:s};await this.session.sendEvent(o),console.log("[VoiceLive Chat] Client SDP sent successfully")}else console.error("[VoiceLive Chat] Cannot send SDP - no local description or session")}async handleServerSdpAnswer(e){if(!this.peerConnection){console.error("[VoiceLive Chat] No peer connection when receiving server SDP");return}try{const t=new RTCSessionDescription(JSON.parse(atob(e)));console.log("[VoiceLive Chat] Setting remote description (answer)"),await this.peerConnection.setRemoteDescription(t),console.log("[VoiceLive Chat] Remote description set successfully")}catch(t){throw console.error("[VoiceLive Chat] Failed to set remote description:",t),t}}closePeerConnection(){this.peerConnection&&(this.peerConnection.close(),this.peerConnection=void 0,this.setState({isAvatarConnected:!1}))}async executeFunction(e,t){if(console.log("[VoiceLive Chat] Executing function:",e,"with args:",t),e==="getCurrentDateTime"){const r=new Date,i={datetime:r.toISOString(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,timestamp:r.getTime()};return JSON.stringify(i)}if(e==="getWeatherForecast"){console.log("[VoiceLive Chat] Starting weather forecast fetch (10 second operation)...");const r=Date.now();await new Promise(o=>setTimeout(o,1e4));const i=Date.now();console.log(`[VoiceLive Chat] Weather forecast completed. Actual time: ${i-r}ms`);const s={location:"Seattle, WA",current:{temperature:52,condition:"Partly Cloudy",humidity:65,windSpeed:12},forecast:[{day:"Today",high:55,low:48,condition:"Partly Cloudy",precipitation:20},{day:"Tomorrow",high:58,low:50,condition:"Sunny",precipitation:5},{day:"Wednesday",high:60,low:52,condition:"Sunny",precipitation:0},{day:"Thursday",high:57,low:49,condition:"Cloudy",precipitation:30},{day:"Friday",high:54,low:47,condition:"Rainy",precipitation:75},{day:"Saturday",high:56,low:48,condition:"Partly Cloudy",precipitation:40},{day:"Sunday",high:59,low:51,condition:"Sunny",precipitation:10}],fetchedAt:new Date().toISOString()};return JSON.stringify(s)}return JSON.stringify({error:"Unknown function"})}async connect(e){if(this.state.isConnected)return;if(!e.endpoint.trim())throw new Error("Missing endpoint");if(!e.apiKey.trim())throw new Error("Missing API key");this.avatarConfig=e.avatar,this.setState({statusText:"Connecting..."}),this.client=new X4(e.endpoint.trim(),new W4(e.apiKey.trim()),{apiVersion:"2025-05-01-preview",defaultSessionOptions:{enableDebugLogging:!1}});const t=this.buildSessionConfig(e);console.log("[VoiceLive Chat] Session config:",JSON.stringify(t,null,2)),this.session=this.client.createSession(e.model,{connectionTimeoutInMs:3e4}),console.log("[VoiceLive Chat] Session created, subscribing to handlers...");const r={onConnected:async(i,s)=>{console.log("[VoiceLive Chat] Connected",{sessionId:s.sessionId,ctx:s}),this.setState({statusText:"Connected"})},onDisconnected:async i=>{console.log("[VoiceLive Chat] Disconnected",i),this.closePeerConnection(),this.setState({statusText:`Disconnected: ${i.reason}`})},onServerError:async i=>{console.error("[VoiceLive Chat] Server error",i.error),console.error("[VoiceLive Chat] Error details:",JSON.stringify(i.error,null,2)),this.addMessage("error",`Server Error: ${i.error.message}`),this.setState({statusText:`Error: ${i.error.message}`})},onSessionCreated:async i=>{console.log("[VoiceLive Chat] Session created",JSON.stringify(i.session,null,2));const s=i.session.id||"";console.log("[VoiceLive Chat] Extracted session ID:",s),s&&this.setState({sessionId:s}),i.session.avatar&&console.log("[VoiceLive Chat] Avatar in created session:",JSON.stringify(i.session.avatar,null,2))},onSessionUpdated:async i=>{if(console.log("[VoiceLive Chat] Session updated",JSON.stringify(i.session,null,2)),i.session.avatar){console.log("[VoiceLive Chat] Avatar configured in session:",JSON.stringify(i.session.avatar,null,2));const s=i.session.avatar.iceServers;if(console.log("[VoiceLive Chat] ICE servers from avatar:",s),s&&Array.isArray(s))if(console.log("[VoiceLive Chat] Received ICE servers:",JSON.stringify(s,null,2)),s.every(o=>typeof o=="object"&&o.urls)){console.log("[VoiceLive Chat] ICE servers valid, initializing peer connection...");try{await this.initPeerConnectionWithIceServers(s),console.log("[VoiceLive Chat] Peer connection initialized successfully")}catch(o){console.error("[VoiceLive Chat] Failed to init peer connection:",o),this.addMessage("error",`Avatar setup failed: ${o}`)}}else console.error("[VoiceLive Chat] Invalid ICE servers format:",s);else console.log("[VoiceLive Chat] No ICE servers in avatar config yet")}else console.log("[VoiceLive Chat] No avatar in session update")},onSessionAvatarConnecting:async i=>{var s,o;console.log("[VoiceLive Chat] Avatar connecting event received"),console.log("[VoiceLive Chat] Server SDP length:",(s=i.serverSdp)==null?void 0:s.length),console.log("[VoiceLive Chat] Server SDP preview:",(o=i.serverSdp)==null?void 0:o.substring(0,100));try{await this.handleServerSdpAnswer(i.serverSdp),console.log("[VoiceLive Chat] Server SDP handled successfully")}catch(a){console.error("[VoiceLive Chat] Failed to handle server SDP:",a),this.addMessage("error",`Avatar connection failed: ${a}`)}},onConversationItemInputAudioTranscriptionDelta:async i=>{console.log("[VoiceLive Chat] User transcription delta:",i.delta),this.currentUserMessageId||(this.currentUserMessageId=this.addMessage("user","")),this.currentUserTranscript+=i.delta,this.updateMessageById(this.currentUserMessageId,this.currentUserTranscript)},onConversationItemInputAudioTranscriptionCompleted:async i=>{var s;console.log("[VoiceLive Chat] Transcription completed",i.transcript),!this.currentUserMessageId&&((s=i.transcript)!=null&&s.trim())&&this.addMessage("user",i.transcript),this.currentUserTranscript="",this.currentUserMessageId=""},onInputAudioBufferSpeechStarted:async()=>{console.log("[VoiceLive Chat] Speech started - interrupting playback"),this.pcmPlayer.stop(),this.setState({isSpeaking:!0})},onInputAudioBufferSpeechStopped:async()=>{console.log("[VoiceLive Chat] Speech stopped"),this.setState({isSpeaking:!1})},onResponseCreated:async i=>{console.log("[VoiceLive Chat] Response created",i),this.isResponseInProgress=!0,this.currentResponseId=i.response.id??I2(),this.currentResponseText="",this.currentResponseMessageId="",this.currentFunctionCallName="",this.currentFunctionCallArgs="",this.currentFunctionCallId=""},onResponseTextDelta:async i=>{console.log("[VoiceLive Chat] Text delta:",i.delta),this.currentResponseMessageId||(this.currentResponseMessageId=this.addMessage("assistant","")),this.currentResponseText+=i.delta,this.updateMessageById(this.currentResponseMessageId,this.currentResponseText)},onResponseTextDone:async i=>{console.log("[VoiceLive Chat] Response text done",i)},onResponseFunctionCallArgumentsDelta:async i=>{console.log("[VoiceLive Chat] Function call arguments delta",i),this.currentFunctionCallArgs+=i.delta,this.currentFunctionCallId=i.callId},onResponseFunctionCallArgumentsDone:async i=>{console.log("[VoiceLive Chat] Function call arguments done",i),this.addMessage("assistant",` Calling ${i.name}()...`),this.executeFunction(i.name,i.arguments).then(async s=>{console.log("[VoiceLive Chat] Function result:",s),this.addMessage("status",` ${i.name}() completed`),this.pendingFunctionResult={callId:i.callId,output:s},this.isResponseInProgress?console.log("[VoiceLive Chat] Response in progress, waiting for onResponseDone to send function result..."):(console.log("[VoiceLive Chat] No response in progress, sending function result immediately..."),await this.sendPendingFunctionResult())}).catch(s=>{console.error("[VoiceLive Chat] Function execution error:",s),this.addMessage("error",`Function error: ${s.message}`)}),this.currentFunctionCallName="",this.currentFunctionCallArgs="",this.currentFunctionCallId=""},onResponseAudioDelta:async i=>{var s,o,a;if(this.firstAudioReceived||(o=(s=this.events).onResponseStart)==null||o.call(s),this.firstAudioReceived=!0,!((a=this.avatarConfig)!=null&&a.enabled)){const l=i.delta;l instanceof Uint8Array&&this.pcmPlayer.enqueuePcm16(l,24e3)}},onResponseAudioTranscriptDelta:async i=>{console.log("[VoiceLive Chat] Audio transcript delta:",i.delta),this.currentResponseMessageId||(this.currentResponseMessageId=this.addMessage("assistant","")),this.currentResponseText+=i.delta,this.updateMessageById(this.currentResponseMessageId,this.currentResponseText)},onResponseAudioTranscriptDone:async i=>{console.log("[VoiceLive Chat] Audio transcript done",i)},onResponseDone:async i=>{var s,o,a;if(console.log("[VoiceLive Chat] Response done",i),this.isResponseInProgress=!1,i.response.status==="failed"){const l=i.response.statusDetails,c=((s=l==null?void 0:l.error)==null?void 0:s.message)||"Response failed";console.error("[VoiceLive Chat] Response failed:",l),this.addMessage("error",`Response Error: ${c}`),this.setState({statusText:`Error: ${c}`}),this.currentResponseText="",this.currentResponseId="";return}if(!this.currentResponseText.trim()&&i.response.output&&i.response.output.length>0){const l=i.response.output[0];if(l!=null&&l.content&&Array.isArray(l.content)){const c=l.content.find(u=>u.type==="audio"&&u.transcript||u.type==="text");c!=null&&c.transcript?this.updateLastMessage(c.transcript):c!=null&&c.text&&this.updateLastMessage(c.text)}}this.currentResponseText="",this.currentResponseId="",this.currentResponseMessageId="",this.pendingFunctionResult&&(console.log("[VoiceLive Chat] Response complete, sending pending function result..."),await this.sendPendingFunctionResult()),(a=(o=this.events).onResponseComplete)==null||a.call(o),this.userSpeechEndTime=null,this.firstAudioReceived=!1,this.currentTurnLatency=null},onError:async i=>{console.log("[VoiceLive Chat] Error",i),this.addMessage("error",`${i.context}: ${i.error.message}`)}};this.subscription=this.session.subscribe(r),console.log("[VoiceLive Chat] Handlers subscribed, connecting...");try{await this.session.connect(),console.log("[VoiceLive Chat] WebSocket connected, sending session config..."),await this.session.updateSession(t),console.log("[VoiceLive Chat] Session config sent successfully")}catch(i){throw console.error("[VoiceLive Chat] Failed to connect or update session:",i),i}e.avatar.enabled||await this.pcmPlayer.resume(),this.setState({isConnected:!0,statusText:e.avatar.enabled?"Connecting avatar...":"Ready"})}async disconnect(){var e,t;this.setState({isRecording:!1,isSpeaking:!1});try{this.closePeerConnection(),this.pcmPlayer.stop(),await((e=this.subscription)==null?void 0:e.close()),this.subscription=void 0,await((t=this.session)==null?void 0:t.dispose()),this.session=void 0,this.client=void 0}finally{this.setState({isConnected:!1,isAvatarConnected:!1,statusText:"Disconnected"})}}async sendText(e){if(!this.session)throw new Error("Not connected");const t=e.trim();t&&(this.addMessage("user",t),await this.session.addConversationItem({type:"message",role:"user",content:[{type:"input_text",text:t}]}),await this.session.sendEvent({type:"response.create",response:{modalities:["text","audio"]}}))}async sendAudio(e){!this.session||!this.session.isConnected||await this.session.sendAudio(e)}clearMessages(){this.setState({messages:[]})}}class aG{constructor(){q(this,"context");q(this,"workletNode",null);q(this,"stream",null);q(this,"source",null);q(this,"sampleRate",24e3);q(this,"nextPlayTime",0);q(this,"isPlaying",!1);q(this,"playbackQueue",[]);q(this,"analysisNode",null);q(this,"dataArray",null);q(this,"animationFrameId",null);q(this,"circleElement",null);this.context=new AudioContext({sampleRate:this.sampleRate})}async initialize(){this.context.state==="closed"&&(this.context=new AudioContext({sampleRate:this.sampleRate})),await this.context.audioWorklet.addModule("/AzureVoicePlayground/audio-processor.js"),this.analysisNode=this.context.createAnalyser(),this.analysisNode.fftSize=2048,this.analysisNode.smoothingTimeConstant=.85,this.dataArray=new Uint8Array(this.analysisNode.frequencyBinCount)}getSampleRate(){return this.sampleRate}setCircleElement(e){this.circleElement=e}async startRecording(e){try{this.workletNode||await this.initialize(),this.stream=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:this.sampleRate,echoCancellation:!0,noiseSuppression:!0}}),await this.context.resume(),this.source=this.context.createMediaStreamSource(this.stream),this.workletNode=new AudioWorkletNode(this.context,"audio-recorder-processor"),this.workletNode.port.onmessage=t=>{if(t.data.eventType==="audio"){const r=t.data.audioData,i=new Int16Array(r.length);for(let o=0;o<r.length;o++){const a=Math.max(-1,Math.min(1,r[o]));i[o]=a<0?a*32768:a*32767}const s=new Uint8Array(i.buffer);e(s)}},this.source.connect(this.workletNode),this.analysisNode&&this.circleElement&&(this.source.connect(this.analysisNode),this.startAnimation("record")),this.workletNode.connect(this.context.destination),this.workletNode.port.postMessage({command:"START_RECORDING"})}catch(t){throw console.error("Error starting recording:",t),t}}stopRecording(){!this.workletNode||!this.source||!this.stream||(this.workletNode.port.postMessage({command:"STOP_RECORDING"}),this.workletNode.disconnect(),this.source.disconnect(),this.stream.getTracks().forEach(e=>e.stop()),this.workletNode=null,this.source=null,this.stream=null,this.stopAnimation())}startStreamingPlayback(){this.isPlaying=!0,this.nextPlayTime=this.context.currentTime}stopStreamingPlayback(){this.isPlaying=!1,this.playbackQueue.forEach(e=>e.stop()),this.playbackQueue=[]}playChunk(e,t){if(!this.isPlaying)return;const r=new Int16Array(e.buffer),i=new Float32Array(r.length);for(let l=0;l<r.length;l++)i[l]=r[l]/(r[l]<0?32768:32767);const s=this.context.createBuffer(1,i.length,this.sampleRate);s.getChannelData(0).set(i);const o=this.context.createBufferSource();o.buffer=s,o.connect(this.context.destination),this.analysisNode&&this.circleElement&&(o.connect(this.analysisNode),this.startAnimation("play"));const a=s.length/this.sampleRate;this.nextPlayTime<this.context.currentTime&&(this.nextPlayTime=this.context.currentTime),o.start(this.nextPlayTime),this.playbackQueue.push(o),o.onended=()=>{t==null||t();const l=this.playbackQueue.indexOf(o);l>-1&&this.playbackQueue.splice(l,1),this.playbackQueue.length===0&&this.stream&&this.circleElement&&this.startAnimation("record")},this.nextPlayTime+=a}startAnimation(e){this.stopAnimation();const t=()=>{if(!this.analysisNode||!this.dataArray||!this.circleElement)return;this.analysisNode.getByteFrequencyData(this.dataArray);const r=Array.from(this.dataArray).reduce((i,s)=>i+s,0)/this.dataArray.length;this.updateCircle(r,e),this.animationFrameId=requestAnimationFrame(t)};t()}stopAnimation(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}updateCircle(e,t){if(!this.circleElement)return;const i=120+e*.8,s=Math.min(e/128,1);let o;if(t==="record"){const a=160+s*20,l=180+s*30,c=60+s*40,u=70-s*20;o=`linear-gradient(135deg, hsl(${a}, ${c}%, ${u}%), hsl(${l}, ${c}%, ${u}%))`}else{const a=260+s*20,l=300+s*30,c=60+s*40,u=70-s*20;o=`linear-gradient(135deg, hsl(${a}, ${c}%, ${u}%), hsl(${l}, ${c}%, ${u}%))`}this.circleElement.style.background=o,this.circleElement.style.width=`${i}px`,this.circleElement.style.height=`${i}px`,this.circleElement.style.boxShadow=`0 0 ${20+s*30}px rgba(${t==="record"?"20, 184, 166":"168, 85, 247"}, ${.3+s*.4})`}async close(){this.stopAnimation(),this.stopRecording(),this.stopStreamingPlayback(),await this.context.close()}}async function lG(){if(!window.vad)return await new Promise((n,e)=>{const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.19.0/dist/ort.min.js",t.onload=()=>n(),t.onerror=()=>e(new Error("Failed to load ONNX Runtime script")),document.head.appendChild(t)}),new Promise((n,e)=>{const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/@ricky0123/vad-web@0.0.30/dist/bundle.min.js",t.onload=()=>n(),t.onerror=()=>e(new Error("Failed to load VAD script")),document.head.appendChild(t)})}function cG({endpoint:n,apiKey:e}){const{enableMAIVoices:t}=XP(),r=eU(t),[i,s]=O.useState(()=>{const ne=localStorage.getItem("voicelive.chat.config");if(!ne)return{...Lw};try{const ve=JSON.parse(ne);return{...Lw,...ve}}catch{return{...Lw}}}),[o,a]=O.useState(!1),[l,c]=O.useState(!1),[u,h]=O.useState(!1),[m,v]=O.useState(!1),[C,T]=O.useState(!1),[E,x]=O.useState([]),[P,b]=O.useState(""),[I,M]=O.useState(""),[N,D]=O.useState(""),[j,F]=O.useState(!1),[z,W]=O.useState(()=>localStorage.getItem("voicelive.show-latency")==="true"),[H,V]=O.useState(null),K=O.useRef(null),ee=O.useRef(null),G=O.useRef(null),X=O.useRef(null),Y=O.useRef(null),ce=O.useRef(z),ae=O.useRef(null),$=O.useRef(500),J=O.useCallback(ne=>{console.log("[Playground] Received avatar track:",ne.track.kind,"streams:",ne.streams.length),ne.track.kind==="video"&&ne.streams[0]&&(console.log("[Playground] Setting avatar video stream"),V(ne.streams[0]))},[]);O.useEffect(()=>{Y.current&&H&&(console.log("[Playground] Attaching stream to video element"),Y.current.srcObject=H)},[H]),K.current||(K.current=new oG({onState:ne=>{console.log("[Playground] State update received, sessionId:",ne.sessionId),a(ne.isConnected),c(ne.isRecording),h(ne.isSpeaking),T(ne.isAvatarConnected),x(ne.messages),b(ne.statusText),M(ne.sessionId)},onAvatarTrack:J,onResponseComplete:()=>{var ne,ve;if(ce.current){const ge=(ne=K.current)==null?void 0:ne.getCurrentTurnLatency(),Ie=$.current;if(console.log(`[VoiceLive] onResponseComplete - Total latency: ${ge}ms, VAD delay: ${Ie}ms`),ge!=null){const fe=Math.round(ge+Ie);(ve=K.current)==null||ve.addStatusMessage(`Response latency: ${Math.round(ge)}ms (Voice Live) + ${Ie}ms (VAD) = ${fe}ms (total)`)}}},onResponseStart:()=>{var ne;console.log("[VAD]  Pausing VAD during assistant playback"),(ne=ae.current)==null||ne.pause()}}));const de=K.current;O.useEffect(()=>{localStorage.setItem("voicelive.chat.config",JSON.stringify(i))},[i]),O.useEffect(()=>{localStorage.setItem("voicelive.show-latency",z.toString()),ce.current=z},[z]),O.useEffect(()=>()=>{const ne=K.current,ve=ee.current,ge=ae.current;ne!=null&&ne.snapshot.isConnected&&(console.log("[VoiceLive Chat] Disconnecting on unmount"),ne.disconnect().catch(console.error)),ve&&ve.close().catch(console.error),ge&&ge.destroy()},[]),O.useEffect(()=>{de.setPlaybackCompleteCallback(()=>{var ne;console.log("[VAD]  Playback complete, resuming VAD"),(ne=ae.current)==null||ne.start()}),de.setPlaybackStartCallback(ne=>{var ge,Ie;const ve=(ge=K.current)==null?void 0:ge.getUserSpeechEndTime();if(ve!=null){const fe=ne-ve;(Ie=K.current)==null||Ie.setCurrentTurnLatency(fe);const xe=new Date(ne).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3});console.log(` [VoiceLive] Audio playback will start at ${xe}`),console.log(`   - Response latency: ${fe.toFixed(0)}ms (from VAD speech end to playback start)`)}})},[de]),O.useEffect(()=>{var ne;(ne=G.current)==null||ne.scrollIntoView({behavior:"smooth"})},[E.length]),O.useEffect(()=>{ee.current&&X.current&&ee.current.setCircleElement(X.current)},[]);const me=O.useCallback(ne=>{if(v(ne>0),!X.current)return;const ge=120+ne*.8,Ie=Math.min(ne/128,1),fe=260+Ie*20,xe=300+Ie*30,$e=60+Ie*40,Ge=70-Ie*20,be=`linear-gradient(135deg, hsl(${fe}, ${$e}%, ${Ge}%), hsl(${xe}, ${$e}%, ${Ge}%))`;X.current.style.background=be,X.current.style.width=`${ge}px`,X.current.style.height=`${ge}px`,X.current.style.boxShadow=`0 0 ${20+Ie*30}px rgba(168, 85, 247, ${.3+Ie*.4})`},[]);O.useEffect(()=>(de.setPlaybackVolumeCallback(me),()=>{de.setPlaybackVolumeCallback(null)}),[de,me]);async function Te(){if(!o){b("Connecting...");try{await de.connect({...i,endpoint:n,apiKey:e}),b("Connected");const ne=lG();if(await se(),await ne,!window.vad)console.warn("[VAD] Failed to load VAD library, latency measurement will not include client VAD delay");else{console.log("[VAD] Starting VAD initialization...");const ve="/AzureVoicePlayground/";let ge=null;const Ie=.5,fe=Math.round(Ie*1e3);$.current=fe;try{const xe=await window.vad.MicVAD.new({onSpeechStart:()=>{ge=performance.now(),console.log("[VAD]  Speech start detected")},onFrameProcessed:$e=>{if($e.isSpeech>.5){const Ge=ge;if(ge=performance.now(),Ge!==null){const be=ge-Ge;be>100&&console.log(`[VAD] Large gap between speech frames: ${be.toFixed(0)}ms`)}}},onSpeechEnd:()=>{const $e=performance.now(),Ge=new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3});if(ge!==null){const be=$e-ge;$.current=Math.round(be),console.log(`[VAD]  Speech end detected at ${Ge} - VAD delay: ${be.toFixed(0)}ms (stored in ref)`)}else console.log(`[VAD]  Speech end detected at ${Ge} - no lastAudioChunkTime, using default: ${fe}ms`);de.markSpeechEndByClientVAD(),ge=null},model:"v5",positiveSpeechThreshold:.8,negativeSpeechThreshold:Ie,redemptionMs:500,preSpeechPadMs:100,minSpeechMs:250,onnxWASMBasePath:`${window.location.origin}${ve}onnx/`,baseAssetPath:`${window.location.origin}${ve}vad/`});ae.current=xe,xe.start(),console.log("[VAD]  VAD initialized and started for latency measurement")}catch(xe){console.error("[VAD]  Failed to initialize VAD:",xe)}}}catch(ne){const ve=ne instanceof Error?ne.message:String(ne);console.error("[Playground] Connection error:",ve),b(`Error: ${ve}`)}}}async function le(){b("Disconnecting...");try{await ie(),ae.current&&(ae.current.destroy(),ae.current=null),await de.disconnect(),V(null),b("Disconnected")}catch(ne){b(ne instanceof Error?ne.message:String(ne))}}async function se(){if(!l){if(!de.snapshot.isConnected){b("Connect first");return}ee.current||(ee.current=new aG,X.current&&ee.current.setCircleElement(X.current));try{await ee.current.startRecording(ne=>{de.sendAudio(ne)}),c(!0)}catch(ne){b(ne instanceof Error?ne.message:String(ne))}}}async function ie(){if(ee.current)try{ee.current.stopRecording(),c(!1)}catch(ne){console.error("Error stopping recording:",ne)}}async function Se(){if(N.trim()){if(!o){b("Connect first");return}try{await de.sendText(N),D("")}catch(ne){b(ne instanceof Error?ne.message:String(ne))}}}function re(){de.clearMessages(),x([])}function pe(ne){switch(ne){case"user":return"bg-blue-100 text-blue-900 ml-auto";case"assistant":return"bg-gray-100 text-gray-900 mr-auto";case"status":return"bg-yellow-100 text-yellow-800 mx-auto";case"error":return"bg-red-100 text-red-800 mx-auto";default:return"bg-gray-100 text-gray-900"}}return g.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[g.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[g.jsx("div",{className:"bg-gradient-to-r from-teal-600 to-cyan-600 text-white p-6 shadow-md",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-3xl font-bold",children:"Voice Live Chat"}),g.jsx("p",{className:"text-teal-100 mt-1",children:"Real-time voice conversation with AI"})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${o?"bg-green-500/20 text-green-100":"bg-white/20 text-white/80"}`,children:[g.jsx("span",{className:`w-2 h-2 rounded-full ${o?"bg-green-400":"bg-white/60"}`}),o?"Connected":"Disconnected"]}),l&&g.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium bg-red-500/20 text-red-100",children:[g.jsx("span",{className:"w-2 h-2 rounded-full bg-red-400 animate-pulse"}),"Recording"]})]})]})}),!i.avatar.enabled&&g.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center py-4 bg-white border-b border-gray-100",style:{height:"200px"},children:[g.jsx("div",{ref:X,className:"rounded-full transition-all duration-150 ease-out flex items-center justify-center",style:{width:"120px",height:"120px",backgroundColor:"#e5e7eb"},children:m?g.jsx("svg",{className:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})}):g.jsx("svg",{className:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),!o&&g.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Click Start to begin conversation"})]}),i.avatar.enabled&&g.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center py-4 bg-white border-b border-gray-100",style:{height:"480px"},children:[g.jsx("div",{className:"rounded-lg overflow-hidden bg-gray-900 flex items-center justify-center",style:{width:"400px",height:"400px"},children:H?g.jsx("video",{ref:Y,autoPlay:!0,playsInline:!0,muted:!1,style:{width:"100%",height:"100%",objectFit:"cover"}}):g.jsxs("div",{className:"text-gray-400 text-center",children:[g.jsx("svg",{className:"w-16 h-16 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),g.jsx("p",{children:o?"Connecting avatar...":"Avatar will appear here"})]})}),C&&g.jsxs("span",{className:"mt-2 inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:[g.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),"Avatar Connected"]})]}),o&&g.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:g.jsxs("p",{className:"text-xs font-mono text-gray-500",children:["Session: ",I||"Loading..."]})}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-white",children:E.length===0?g.jsx("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:g.jsx("p",{className:"text-sm",children:"Speak naturally and the AI will respond"})}):g.jsxs(g.Fragment,{children:[E.map(ne=>g.jsxs("div",{className:`max-w-[80%] px-4 py-2 rounded-lg ${pe(ne.type)}`,children:[g.jsx("p",{className:"whitespace-pre-wrap",children:ne.content}),g.jsx("p",{className:"text-xs opacity-60 mt-1",children:new Date(ne.timestamp).toLocaleTimeString()})]},ne.id)),g.jsx("div",{ref:G})]})}),g.jsxs("div",{className:"bg-gray-50 border-t border-gray-200 p-4",children:[g.jsxs("div",{className:"flex gap-2 mb-2",children:[g.jsx("input",{type:"text",value:N,onChange:ne=>D(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&!ne.shiftKey&&(ne.preventDefault(),Se())},placeholder:"Type a message (or just speak)...",disabled:!o,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed"}),g.jsx("button",{onClick:Se,disabled:!o||!N.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})}),g.jsx("button",{onClick:re,disabled:E.length===0,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Clear chat",children:g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),g.jsx("p",{className:"text-xs text-gray-500",children:P||"Ready"})]})]}),g.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-y-auto",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuration"}),g.jsxs("div",{className:"space-y-4 flex-1",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model"}),g.jsx("select",{value:i.model,onChange:ne=>s(ve=>({...ve,model:ne.target.value})),disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:iG.map(ne=>g.jsx("option",{value:ne.id,children:ne.name},ne.id))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Voice"}),g.jsx("select",{value:i.voice,onChange:ne=>s(ve=>({...ve,voice:ne.target.value})),disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:r.map(ne=>g.jsx("option",{value:ne.id,children:ne.name},ne.id))})]}),!i.model.includes("realtime")&&g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recognition Language"}),g.jsx("select",{value:i.recognitionLanguage,onChange:ne=>s(ve=>({...ve,recognitionLanguage:ne.target.value})),disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:sG.map(ne=>g.jsx("option",{value:ne.code,children:ne.name},ne.code))})]}),g.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[g.jsxs("label",{className:"flex items-center gap-2 mb-3",children:[g.jsx("input",{type:"checkbox",checked:i.enableFunctionCalling,onChange:ne=>s(ve=>({...ve,enableFunctionCalling:ne.target.checked})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),g.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Function Calling"})]}),i.enableFunctionCalling&&g.jsxs("div",{className:"space-y-2 pl-6",children:[g.jsxs("label",{className:"flex items-center gap-2",children:[g.jsx("input",{type:"checkbox",checked:i.functions.enableDateTime,onChange:ne=>s(ve=>({...ve,functions:{...ve.functions,enableDateTime:ne.target.checked}})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),g.jsx("span",{className:"text-xs text-gray-700",children:"getCurrentDateTime()"})]}),g.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Get current date, time, and timezone"}),g.jsxs("label",{className:"flex items-center gap-2 mt-2",children:[g.jsx("input",{type:"checkbox",checked:i.functions.enableWeatherForecast,onChange:ne=>s(ve=>({...ve,functions:{...ve.functions,enableWeatherForecast:ne.target.checked}})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),g.jsx("span",{className:"text-xs text-gray-700",children:"getWeatherForecast()"})]}),g.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Get 7-day weather forecast (10s delay)"})]})]}),g.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[g.jsxs("label",{className:"flex items-center gap-2 mb-3",children:[g.jsx("input",{type:"checkbox",checked:i.avatar.enabled,onChange:ne=>s(ve=>({...ve,avatar:{...ve.avatar,enabled:ne.target.checked}})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),g.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Avatar"})]}),i.avatar.enabled&&g.jsxs("div",{className:"space-y-3 pl-1",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Avatar Type"}),g.jsxs("select",{value:i.avatar.type,onChange:ne=>s(ve=>({...ve,avatar:{...ve.avatar,type:ne.target.value,character:ne.target.value==="photo"?R2[0].id:EC[0].character,style:ne.target.value==="video"?EC[0].style:void 0}})),disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[g.jsx("option",{value:"video",children:"Video Avatar"}),g.jsx("option",{value:"photo",children:"Photo Avatar (VASA-1)"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:i.avatar.type==="photo"?"Photo Avatar":"Video Avatar"}),g.jsx("select",{value:i.avatar.type==="photo"?i.avatar.character:`${i.avatar.character}-${i.avatar.style}`,onChange:ne=>{if(i.avatar.type==="photo")s(ve=>({...ve,avatar:{...ve.avatar,character:ne.target.value,style:void 0}}));else{const ve=EC.find(ge=>ge.id===ne.target.value);ve&&s(ge=>({...ge,avatar:{...ge.avatar,character:ve.character,style:ve.style}}))}},disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:i.avatar.type==="photo"?R2.map(ne=>g.jsx("option",{value:ne.id,children:ne.name},ne.id)):EC.map(ne=>g.jsx("option",{value:ne.id,children:ne.name},ne.id))})]})]})]}),g.jsx("div",{className:"pt-2",children:o?g.jsxs("button",{onClick:le,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{d:"M6 6h12v12H6z"})}),"Stop"]}):g.jsxs("button",{onClick:Te,disabled:!n||!e,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Conversation"]})}),o&&g.jsx("div",{className:"pt-2",children:g.jsxs("button",{onClick:l?ie:se,className:`w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-md transition-colors ${l?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),l?"Mute Microphone":"Unmute Microphone"]})}),o&&u&&g.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-md",children:[g.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),g.jsx("span",{className:"text-sm text-blue-700",children:"Speaking detected..."})]}),g.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[g.jsxs("button",{onClick:()=>F(!j),className:"flex items-center justify-between w-full text-sm font-medium text-gray-700",children:[g.jsx("span",{children:"Advanced Settings"}),g.jsx("svg",{className:`w-5 h-5 transition-transform ${j?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),j&&g.jsxs("div",{className:"mt-4 space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"System Instructions"}),g.jsx("textarea",{value:i.instructions,onChange:ne=>s(ve=>({...ve,instructions:ne.target.value})),disabled:o,rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",placeholder:"You are a helpful assistant..."})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Turn Detection"}),g.jsxs("select",{value:i.turnDetectionType,onChange:ne=>s(ve=>({...ve,turnDetectionType:ne.target.value})),disabled:o,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[g.jsx("option",{value:"server_vad",children:"Server VAD"}),g.jsx("option",{value:"azure_semantic_vad",children:"Azure Semantic VAD"})]})]}),g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Temperature: ",i.temperature.toFixed(1)]}),g.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:i.temperature,onChange:ne=>s(ve=>({...ve,temperature:parseFloat(ne.target.value)})),disabled:o,className:"w-full"})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("label",{className:"flex items-center gap-2",children:[g.jsx("input",{type:"checkbox",checked:i.removeFillerWords,onChange:ne=>s(ve=>({...ve,removeFillerWords:ne.target.checked})),disabled:o||i.turnDetectionType!=="azure_semantic_vad",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),g.jsx("span",{className:"text-sm text-gray-700",children:"Remove filler words"})]}),g.jsxs("label",{className:"flex items-center gap-2",children:[g.jsx("input",{type:"checkbox",checked:i.useNoiseSuppression,onChange:ne=>s(ve=>({...ve,useNoiseSuppression:ne.target.checked})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),g.jsx("span",{className:"text-sm text-gray-700",children:"Noise suppression"})]}),g.jsxs("label",{className:"flex items-center gap-2",children:[g.jsx("input",{type:"checkbox",checked:i.useEchoCancellation,onChange:ne=>s(ve=>({...ve,useEchoCancellation:ne.target.checked})),disabled:o,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),g.jsx("span",{className:"text-sm text-gray-700",children:"Echo cancellation"})]}),g.jsxs("label",{className:"flex items-center gap-2",children:[g.jsx("input",{type:"checkbox",checked:z,onChange:ne=>W(ne.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),g.jsx("span",{className:"text-sm text-gray-700",children:"Show response latency"})]})]})]})]})]})]})]})}function uG({settings:n}){const[e,t]=O.useState("audio"),[r,i]=O.useState(()=>{const re=localStorage.getItem("voicecreation.config");if(!re)return{...Tw};try{return{...Tw,...JSON.parse(re)}}catch{return{...Tw}}}),[s,o]=O.useState(null),[a,l]=O.useState(null),[c,u]=O.useState(!1),[h,m]=O.useState(""),[v,C]=O.useState(null),[T,E]=O.useState(""),[x,P]=O.useState([]),[b,I]=O.useState([]),[M,N]=O.useState(!1),[D,j]=O.useState(null),[F,z]=O.useState(`Hello, this is my personal voice speaking.
I can speak different languages.


Hola, esta es mi voz personal.
Bonjour, ceci est ma voix personnelle.`),[W,H]=O.useState("DragonLatestNeural"),[V,K]=O.useState(!1),[ee,G]=O.useState(null),[X,Y]=O.useState(!1),ce=O.useRef(null),ae=n.apiKey&&n.region,J=["eastus","eastus2","westeurope","southeastasia","swedencentral"].includes(n.region.toLowerCase()),de={apiKey:n.apiKey,region:n.region};O.useEffect(()=>{localStorage.setItem("voicecreation.config",JSON.stringify(r))},[r]);const me=O.useCallback(async()=>{if(ae){N(!0);try{const[re,pe]=await Promise.all([pF(de,r.projectId),u9(de,r.projectId)]);P(re),I(pe)}catch(re){console.error("Failed to load voices:",re)}finally{N(!1)}}},[ae,n.apiKey,n.region,r.projectId]);O.useEffect(()=>{me()},[me]);const Te=async()=>{await l9(de,r.projectId)||await c9(de,r.projectId)},le=async()=>{if(!s||!a||!r.voiceTalentName||!r.voiceName){C("Please complete all steps and provide a voice name");return}u(!0),C(null);try{m("Creating project..."),await Te();const re=`consent-${Date.now()}`;if(m("Uploading consent..."),await h9(de,{projectId:r.projectId,consentId:re,voiceTalentName:r.voiceTalentName,companyName:r.companyName,audioFile:s,locale:r.locale}),m("Verifying consent..."),(await v9(de,re)).status==="Failed")throw new Error("Consent verification failed. Please ensure the audio clearly states the consent statement.");const ne=r.voiceName.trim().replace(/\s+/g,"-").toLowerCase();if(m("Creating personal voice..."),await m9(de,{projectId:r.projectId,personalVoiceId:ne,consentId:re,audioFiles:[a]}),m("Training voice model..."),(await y9(de,ne)).status==="Failed")throw new Error("Voice creation failed. Please try with a different audio sample. Ensure it is the same person as the consent audio.");m("Voice created successfully!"),await me(),setTimeout(()=>{m("")},3e3)}catch(re){console.error("Voice creation failed:",re);let pe="Voice creation failed";re instanceof Error&&(re.message.includes("409")?pe="A voice with this name already exists. Please use a different voice name.":pe=re.message),C(pe),m("")}finally{u(!1)}},se=async re=>{if(confirm(`Delete voice "${re.id}"? This cannot be undone.`))try{await g9(de,re.id);try{await p9(de,re.consentId)}catch{}await me(),(D==null?void 0:D.id)===re.id&&j(null)}catch(pe){console.error("Failed to delete voice:",pe),alert("Failed to delete voice")}},ie=async()=>{if(!(!D||!F.trim())){K(!0),G(null);try{const re=await S9(de,F,D.speakerProfileId,r.locale,W),pe=new Blob([re],{type:"audio/mp3"}),ne=URL.createObjectURL(pe);ce.current&&(ce.current.src=ne,await ce.current.play())}catch(re){console.error("Synthesis failed:",re),G(re instanceof Error?re.message:"Synthesis failed")}finally{K(!1)}}},Se=()=>`I ${r.voiceTalentName||"[your name]"} am aware that recordings of my voice will be used by ${r.companyName} to create and use a synthetic version of my voice.`;return g.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[g.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[g.jsxs("div",{className:"bg-gradient-to-r from-emerald-600 to-teal-600 text-white p-6 shadow-md",children:[g.jsx("h1",{className:"text-3xl font-bold",children:"Voice Creation"}),g.jsx("p",{className:"text-emerald-100 mt-1",children:"Create your custom AI voice from audio samples or text prompt"})]}),g.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:ae?g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"flex-[3] min-h-0 border-b border-gray-200 flex flex-col",children:[g.jsxs("div",{className:"flex border-b border-gray-200 bg-gray-50 flex-shrink-0",children:[g.jsx("button",{onClick:()=>t("audio"),className:`flex-1 px-4 py-2 text-sm font-medium transition-colors ${e==="audio"?"text-emerald-600 border-b-2 border-emerald-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:g.jsxs("div",{className:"flex items-center justify-center gap-2",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),"Audio Based"]})}),g.jsx("button",{onClick:()=>t("text-prompt"),className:`flex-1 px-4 py-2 text-sm font-medium transition-colors ${e==="text-prompt"?"text-emerald-600 border-b-2 border-emerald-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:g.jsxs("div",{className:"flex items-center justify-center gap-2",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Text Prompt"]})})]}),g.jsx("div",{className:"flex-1 min-h-0 p-4 overflow-hidden",children:e==="audio"?g.jsx("div",{className:"h-full flex flex-col gap-3",children:J?g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-md px-3 py-2 flex items-center gap-2 text-sm flex-shrink-0",children:[g.jsx("svg",{className:"w-4 h-4 text-amber-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),g.jsxs("span",{className:"text-amber-800",children:["Audio-based voice creation requires gating approval."," ",g.jsx("a",{href:"https://learn.microsoft.com/en-us/azure/ai-services/speech-service/custom-neural-voice",target:"_blank",rel:"noopener noreferrer",className:"text-amber-700 underline hover:text-amber-900 font-medium",children:"Learn more and apply for access"})]})]}),g.jsxs("div",{className:"flex gap-4 items-end flex-shrink-0",children:[g.jsxs("div",{className:"flex-1",children:[g.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Voice Name ",g.jsx("span",{className:"text-red-500",children:"*"})]}),g.jsx("input",{type:"text",value:r.voiceName,onChange:re=>i(pe=>({...pe,voiceName:re.target.value})),placeholder:"my-custom-voice",className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500"})]}),g.jsxs("div",{className:"flex-1",children:[g.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Your Name ",g.jsx("span",{className:"text-red-500",children:"*"})]}),g.jsx("input",{type:"text",value:r.voiceTalentName,onChange:re=>i(pe=>({...pe,voiceTalentName:re.target.value})),placeholder:"John Doe",className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500"})]}),g.jsxs("div",{className:"w-32",children:[g.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Language"}),g.jsx("select",{value:r.locale,onChange:re=>i(pe=>({...pe,locale:re.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500",children:lD.map(re=>g.jsx("option",{value:re.code,children:re.name},re.code))})]})]}),g.jsxs("div",{className:"flex-1 min-h-0 max-h-[250px] grid grid-cols-2 gap-3 overflow-auto",children:[g.jsxs("div",{className:"flex flex-col rounded-lg border border-gray-200 bg-white p-3",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-shrink-0",children:[g.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${s?"bg-emerald-500 text-white":"bg-gray-200 text-gray-600"}`,children:s?"":"1"}),g.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Consent"})]}),g.jsxs("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded text-xs flex-shrink-0",children:[g.jsx("p",{className:"text-blue-800 font-medium",children:"Read aloud:"}),g.jsxs("p",{className:"text-blue-900 italic mt-0.5 line-clamp-2",children:['"',Se(),'"']})]}),g.jsx("div",{className:"flex-shrink-0",children:g.jsx(qw,{onRecordingComplete:o,maxDuration:30,minDuration:3,disabled:c})})]}),g.jsxs("div",{className:"flex flex-col rounded-lg border border-gray-200 bg-white p-3",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-shrink-0",children:[g.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${a?"bg-emerald-500 text-white":"bg-gray-200 text-gray-600"}`,children:a?"":"2"}),g.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Voice Sample"})]}),g.jsxs("div",{className:"text-xs text-gray-600 mb-2 flex-shrink-0 space-y-1",children:[g.jsx("p",{className:"font-medium",children:"Recording Guidelines (5-90 seconds):"}),g.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-gray-500",children:[g.jsx("li",{children:"Record in a quiet environment with minimal background noise"}),g.jsx("li",{children:"Speak naturally in the style you want for your voice"}),g.jsx("li",{children:"Maintain consistent volume and microphone distance"})]})]}),g.jsx("div",{className:"flex-shrink-0",children:g.jsx(qw,{onRecordingComplete:l,maxDuration:90,minDuration:5,disabled:c})})]})]}),g.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[g.jsx("button",{onClick:le,disabled:c||!a||!s||!r.voiceTalentName.trim()||!r.voiceName.trim(),className:"px-4 py-2 bg-emerald-600 text-white text-sm rounded-lg hover:bg-emerald-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium",children:c?"Creating...":"Create My Voice"}),v&&g.jsx("p",{className:"text-sm text-red-600",children:v}),c&&h&&g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("svg",{className:"w-4 h-4 animate-spin text-emerald-600",fill:"none",viewBox:"0 0 24 24",children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),g.jsx("p",{className:"text-sm text-emerald-700",children:h})]})]})]}):g.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("svg",{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-semibold text-amber-800",children:"Region Not Supported"}),g.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Audio-based voice creation is currently only available in the following regions:"}),g.jsxs("ul",{className:"text-sm text-amber-700 mt-2 list-disc list-inside",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"East US"})," (eastus)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"East US 2"})," (eastus2)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"West Europe"})," (westeurope)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Southeast Asia"})," (southeastasia)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Sweden Central"})," (swedencentral)"]})]}),g.jsxs("p",{className:"text-sm text-amber-700 mt-2",children:["Your current region is ",g.jsx("strong",{children:n.region}),". Please update your region in the sidebar settings."]})]})]})})}):g.jsxs("div",{className:"h-full flex flex-col gap-3",children:[g.jsxs("div",{className:"flex gap-4 items-end flex-shrink-0",children:[g.jsxs("div",{className:"flex-1",children:[g.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Voice Name"}),g.jsx("input",{type:"text",value:r.voiceName,onChange:re=>i(pe=>({...pe,voiceName:re.target.value})),placeholder:"my-custom-voice",className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500"})]}),g.jsxs("div",{className:"w-32",children:[g.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Language"}),g.jsx("select",{value:r.locale,onChange:re=>i(pe=>({...pe,locale:re.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500",children:lD.map(re=>g.jsx("option",{value:re.code,children:re.name},re.code))})]})]}),g.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[g.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Voice Description ",g.jsx("span",{className:"text-red-500",children:"*"})]}),g.jsx("textarea",{value:T,onChange:re=>E(re.target.value),placeholder:"e.g., A warm, friendly female voice with a slight British accent. Middle-aged, calm and professional tone, suitable for audiobooks and narration.",className:"flex-1 min-h-[80px] w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 resize-none"})]}),g.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[g.jsx("button",{disabled:!T.trim()||c,className:"px-4 py-1.5 bg-emerald-600 text-white text-sm rounded hover:bg-emerald-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium",children:"Generate Voice"}),g.jsx("span",{className:"text-xs text-amber-600",children:"This feature is in development (coming soon)"})]})]})})]}),g.jsx("div",{className:"flex-[2] min-h-0 p-4 bg-gray-50 flex flex-col",children:g.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 flex-1 min-h-0 flex flex-col",children:[g.jsxs("div",{className:"flex items-center justify-between mb-3 flex-shrink-0",children:[g.jsx("h2",{className:"text-sm font-semibold text-gray-800",children:"Test Voice"}),D&&g.jsxs("span",{className:"text-xs text-gray-500",children:["Using: ",g.jsx("span",{className:"font-medium text-gray-700",children:D.id})]})]}),D?g.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[g.jsxs("div",{className:"flex gap-3 items-end flex-shrink-0",children:[g.jsxs("div",{className:"w-36",children:[g.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Model"}),g.jsx("select",{value:W,onChange:re=>H(re.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500",children:SF.map(re=>g.jsx("option",{value:re.id,children:re.name},re.id))})]}),g.jsx("button",{onClick:ie,disabled:V||!F.trim(),className:"flex items-center gap-2 px-4 py-1.5 bg-emerald-600 text-white text-sm rounded hover:bg-emerald-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium",children:V?g.jsxs(g.Fragment,{children:[g.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Synthesizing..."]}):g.jsxs(g.Fragment,{children:[g.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{d:"M8 5v14l11-7z"})}),"Speak"]})}),g.jsxs("button",{onClick:()=>Y(!X),className:`flex items-center gap-1.5 px-3 py-1.5 text-sm rounded border ${X?"bg-gray-100 border-gray-400 text-gray-700":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"SSML"]}),g.jsxs("button",{onClick:()=>{const re=Uv(F,D.speakerProfileId,r.locale,W),pe=`
Voice Name: ${D.id}
Speaker Name: ${r.voiceTalentName}
Model: ${W}
Language: ${r.locale}

Test Text:
${F}

SSML:
${re}

[Please attach the audio file if available]
                            `.trim(),ne=encodeURIComponent(`Personal Voice Feedback - ${D.id}`),ve=encodeURIComponent(pe),ge=`mailto:ttsvoicefeedback@microsoft.com?subject=${ne}&body=${ve}`;navigator.clipboard&&navigator.clipboard.writeText(re),window.open(ge,"_blank")},className:"flex items-center gap-1.5 px-3 py-1.5 text-sm rounded border bg-green-600 border-green-600 text-white hover:bg-green-700",title:"Send feedback email",children:[g.jsxs("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:[g.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),g.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),"Feedback"]}),ee&&g.jsx("span",{className:"text-xs text-red-600",children:ee})]}),g.jsxs("div",{className:"flex-1 min-h-0 flex gap-3",children:[g.jsx("div",{className:`flex-1 min-h-0 ${X?"w-1/2":"w-full"}`,children:g.jsx("textarea",{value:F,onChange:re=>z(re.target.value),placeholder:"Enter text to speak...",className:"w-full h-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 resize-none"})}),X&&g.jsx("div",{className:"flex-1 min-h-0 w-1/2",children:g.jsx("pre",{className:"w-full h-full px-2 py-1.5 bg-gray-900 text-gray-100 rounded text-xs font-mono overflow-auto whitespace-pre-wrap",children:Uv(F,D.speakerProfileId,r.locale,W)})})]}),g.jsx("audio",{ref:ce,className:"hidden"})]}):g.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:g.jsxs("div",{className:"text-center",children:[g.jsx("svg",{className:"w-10 h-10 mx-auto mb-2 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})}),g.jsx("p",{className:"text-sm",children:"Select a voice from the panel to test"})]})})]})})]}):g.jsx("div",{className:"flex items-center justify-center h-full",children:g.jsxs("div",{className:"text-center text-gray-500",children:[g.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),g.jsx("p",{className:"text-lg",children:"Please configure your Azure API key and region"})]})})})]}),g.jsx("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 flex flex-col overflow-hidden",children:g.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"My Voices"}),g.jsx("button",{onClick:me,disabled:M||!ae,className:"p-2 text-gray-500 hover:text-gray-700 disabled:opacity-50",title:"Refresh",children:g.jsx("svg",{className:`w-5 h-5 ${M?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),x.length===0?g.jsxs("div",{className:"text-center text-gray-500 py-8",children:[g.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),g.jsx("p",{children:"No voices created yet"}),g.jsx("p",{className:"text-sm mt-1",children:"Create your first voice above"})]}):g.jsx("div",{className:"space-y-2",children:x.map(re=>g.jsx("div",{onClick:()=>re.status==="Succeeded"&&j(re),className:`p-3 rounded-lg border cursor-pointer transition-colors ${(D==null?void 0:D.id)===re.id?"border-emerald-500 bg-emerald-50":"border-gray-200 bg-white hover:border-gray-300"} ${re.status!=="Succeeded"?"opacity-60 cursor-not-allowed":""}`,children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),g.jsx("span",{className:"font-medium text-gray-800 text-sm",children:re.id})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${re.status==="Succeeded"?"bg-green-100 text-green-700":re.status==="Failed"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:re.status}),g.jsx("button",{onClick:pe=>{pe.stopPropagation(),se(re)},className:"p-1 text-gray-400 hover:text-red-600",title:"Delete voice",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},re.id))})]})})]})}const dG=[".mp4"],hG=5;function pG({onFileSelected:n,onUploadComplete:e,disabled:t=!1,maxSizeGB:r=hG,acceptedFormats:i=dG}){const[s,o]=O.useState(!1),[a,l]=O.useState(null),[c,u]=O.useState(null),[h,m]=O.useState(null),[v,C]=O.useState(null),T=O.useRef(null),E=O.useRef(null),x=r*1024*1024*1024;O.useEffect(()=>()=>{c&&URL.revokeObjectURL(c)},[c]);const P=O.useCallback(H=>{var K;const V="."+((K=H.name.split(".").pop())==null?void 0:K.toLowerCase());return i.includes(V)?H.size>x?`File too large. Maximum size: ${r}GB`:null:`Invalid file format. Accepted formats: ${i.join(", ")}`},[i,x,r]),b=O.useCallback(H=>{const V=P(H);if(V){m(V);return}m(null),l(H),c&&URL.revokeObjectURL(c);const K=URL.createObjectURL(H);u(K),n(H)},[P,n,c]),I=O.useCallback(H=>{H.preventDefault(),t||o(!0)},[t]),M=O.useCallback(H=>{H.preventDefault(),o(!1)},[]),N=O.useCallback(H=>{if(H.preventDefault(),o(!1),t)return;const V=H.dataTransfer.files;V.length>0&&b(V[0])},[t,b]),D=O.useCallback(H=>{const V=H.target.files;V&&V.length>0&&b(V[0])},[b]),j=O.useCallback(()=>{!t&&T.current&&T.current.click()},[t]),F=O.useCallback(()=>{if(E.current){const H=E.current.duration,V=Math.floor(H/60),K=Math.floor(H%60);C(`${V}:${K.toString().padStart(2,"0")}`)}},[]),z=O.useCallback(()=>{l(null),c&&URL.revokeObjectURL(c),u(null),C(null),m(null),T.current&&(T.current.value="")},[c]),W=H=>H<1024?H+" B":H<1024*1024?(H/1024).toFixed(1)+" KB":H<1024*1024*1024?(H/(1024*1024)).toFixed(1)+" MB":(H/(1024*1024*1024)).toFixed(2)+" GB";return g.jsxs("div",{className:"space-y-4",children:[a?g.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[g.jsx("div",{className:"bg-black aspect-video",children:g.jsx("video",{ref:E,src:c||void 0,className:"w-full h-full",controls:!0,onLoadedMetadata:F})}),g.jsxs("div",{className:"p-4 bg-gray-50 flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center space-x-3",children:[g.jsx("svg",{className:"h-8 w-8 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-900 truncate max-w-xs",children:a.name}),g.jsxs("p",{className:"text-xs text-gray-500",children:[W(a.size),v&&`  ${v}`]})]})]}),g.jsx("button",{onClick:z,disabled:t,className:"text-gray-400 hover:text-gray-600 disabled:opacity-50",children:g.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}):g.jsxs("div",{onClick:j,onDragOver:I,onDragLeave:M,onDrop:N,className:`
            border-2 border-dashed rounded-lg p-8 text-center cursor-pointer
            transition-colors duration-200
            ${s?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:border-gray-400"}
            ${t?"opacity-50 cursor-not-allowed":""}
          `,children:[g.jsx("input",{ref:T,type:"file",accept:i.join(","),onChange:D,className:"hidden",disabled:t}),g.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),g.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[g.jsx("span",{className:"font-medium text-indigo-600",children:"Click to upload"})," or drag and drop"]}),g.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["MP4 video files up to ",r,"GB"]})]}),h&&g.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-3",children:h})]})}const xp="2024-05-20-preview";function wp(n){return`https://${n}.api.cognitive.microsoft.com/videotranslation`}function bp(n,e){const t={"Ocp-Apim-Subscription-Key":n,"Content-Type":"application/json"};return e&&(t["Operation-Id"]=e),t}async function Pp(n){var e,t;if(!n.ok){let r=`API Error: ${n.status} ${n.statusText}`;try{const i=await n.json();console.error("API Error Response:",i),(e=i.error)!=null&&e.message?r=i.error.message:i.message?r=i.message:(t=i.error)!=null&&t.code&&(r=`${i.error.code}: ${JSON.stringify(i.error)}`)}catch{}throw new Error(r)}return n.status===204?{}:n.json()}async function fG(n,e){const t=`${wp(n.region)}/translations/${e.translationId}?api-version=${xp}`,r={targetLocale:e.input.targetLocale,voiceKind:e.input.voiceKind};e.input.videoFileUrl!==void 0&&(r.videoFileUrl=e.input.videoFileUrl),e.input.audioFileUrl!==void 0&&(r.audioFileUrl=e.input.audioFileUrl),e.input.sourceLocale!==void 0&&e.input.sourceLocale!==""&&(r.sourceLocale=e.input.sourceLocale),e.input.speakerCount!==void 0&&(r.speakerCount=e.input.speakerCount),e.input.subtitleMaxCharCountPerSegment!==void 0&&(r.subtitleMaxCharCountPerSegment=e.input.subtitleMaxCharCountPerSegment),e.input.exportSubtitleInVideo!==void 0&&(r.exportSubtitleInVideo=e.input.exportSubtitleInVideo),e.input.enableLipSync!==void 0&&(r.enableLipSync=e.input.enableLipSync);const i={input:r};e.displayName!==void 0&&(i.displayName=e.displayName),e.description!==void 0&&(i.description=e.description);const s=crypto.randomUUID(),o=await fetch(t,{method:"PUT",headers:bp(n.apiKey,s),body:JSON.stringify(i)}),a=o.headers.get("Operation-Location")||"";return{translation:await Pp(o),operationLocation:a}}async function tU(n,e){const t=`${wp(n.region)}/translations/${e}?api-version=${xp}`,r=await fetch(t,{method:"GET",headers:bp(n.apiKey)});return Pp(r)}async function mG(n,e){const t=`${wp(n.region)}/translations?api-version=${xp}`,r=await fetch(t,{method:"GET",headers:bp(n.apiKey)});return Pp(r)}async function gG(n,e){const t=`${wp(n.region)}/translations/${e}?api-version=${xp}`,r=await fetch(t,{method:"DELETE",headers:bp(n.apiKey)});await Pp(r)}async function vG(n,e,t){var u,h,m,v;const r=`${wp(n.region)}/translations/${e}/iterations/${t.iterationId}?api-version=${xp}`,i={};((u=t.input)==null?void 0:u.speakerCount)!==void 0&&(i.speakerCount=t.input.speakerCount),((h=t.input)==null?void 0:h.exportSubtitleInVideo)!==void 0&&(i.exportSubtitleInVideo=t.input.exportSubtitleInVideo),((m=t.input)==null?void 0:m.subtitleMaxCharCountPerSegment)!==void 0&&(i.subtitleMaxCharCountPerSegment=t.input.subtitleMaxCharCountPerSegment),((v=t.input)==null?void 0:v.webvttFile)!==void 0&&(i.webvttFile=t.input.webvttFile);const s={input:i};t.description!==void 0&&(s.description=t.description),console.log("Creating iteration with body:",JSON.stringify(s));const o=crypto.randomUUID(),a=await fetch(r,{method:"PUT",headers:bp(n.apiKey,o),body:JSON.stringify(s)}),l=a.headers.get("Operation-Location")||"";return{iteration:await Pp(a),operationLocation:l}}async function yG(n,e,t){const r=`${wp(n.region)}/translations/${e}/iterations/${t}?api-version=${xp}`,i=await fetch(r,{method:"GET",headers:bp(n.apiKey)});return Pp(i)}async function SG(n,e,t,r=36e5,i=5e3){const s=Date.now();for(;Date.now()-s<r;){const o=await tU(n,e);if(t&&t(o),o.status==="Succeeded"||o.status==="Failed"||o.status==="Canceled")return o;await new Promise(a=>setTimeout(a,i))}throw new Error("Translation timed out")}async function CG(n,e,t,r,i=36e5,s=5e3){const o=Date.now();for(;Date.now()-o<i;){const a=await yG(n,e,t);if(r&&r(a),a.status==="Succeeded"||a.status==="Failed"||a.status==="Canceled")return a;await new Promise(l=>setTimeout(l,s))}throw new Error("Iteration timed out")}const nU="video-translation-history";function AG(){try{const n=localStorage.getItem(nU);return n?JSON.parse(n):[]}catch{return[]}}function xC(n){localStorage.setItem(nU,JSON.stringify(n))}function TG({apiKey:n,region:e}){const[t,r]=O.useState("idle"),[i,s]=O.useState({step:0,totalSteps:4,message:""}),[o,a]=O.useState(null),[l,c]=O.useState(null),[u,h]=O.useState(null),[m,v]=O.useState([]),[C,T]=O.useState(AG),E=O.useRef(!1),x=O.useCallback(()=>({region:e,apiKey:n}),[e,n]),P=O.useCallback(H=>{const V={...H,id:crypto.randomUUID()};return T(K=>{const ee=[V,...K].slice(0,50);return xC(ee),ee}),V.id},[]),b=O.useCallback((H,V)=>{T(K=>{const ee=K.map(G=>G.id===H?{...G,...V}:G);return xC(ee),ee})},[]),I=O.useCallback(H=>{T(V=>{const K=V.filter(ee=>ee.id!==H);return xC(K),K})},[]),M=O.useCallback(()=>{T([]),xC([])},[]),N=O.useCallback(async(H,V,K)=>{var Y,ce,ae,$;E.current=!1,a(null),r("creating"),s({step:1,totalSteps:4,message:"Creating translation..."});const ee=crypto.randomUUID(),G=crypto.randomUUID(),X=P({translationId:ee,displayName:K||`Translation ${new Date().toLocaleString()}`,sourceLocale:V.sourceLocale||"auto",targetLocale:V.targetLocale,voiceKind:V.voiceKind,status:"Running",createdAt:new Date().toISOString(),videoUrl:H});try{const J=x(),{translation:de}=await fG(J,{translationId:ee,displayName:K||`Translation ${new Date().toLocaleString()}`,input:{videoFileUrl:H,sourceLocale:V.sourceLocale||void 0,targetLocale:V.targetLocale,voiceKind:V.voiceKind,speakerCount:V.speakerCount,subtitleMaxCharCountPerSegment:V.subtitleMaxCharCountPerSegment,exportSubtitleInVideo:V.exportSubtitleInVideo,enableLipSync:V.enableLipSync}});if(c(de),s({step:1,totalSteps:4,message:"Translation created, waiting for processing...",translationId:ee}),E.current){r("cancelled"),b(X,{status:"Canceled"});return}r("processing"),s({step:2,totalSteps:4,message:"Processing video...",translationId:ee});const me=await SG(J,ee,se=>{if(c(se),s({step:2,totalSteps:4,message:`Processing video... (${se.status})`,translationId:ee}),console.log("Translation status:",se.status,se),E.current)throw new Error("Cancelled")});if(me.status==="Failed")throw new Error(me.failureReason||"Translation failed");if(E.current){r("cancelled"),b(X,{status:"Canceled"});return}r("iterating"),s({step:3,totalSteps:4,message:"Creating iteration...",translationId:ee});const{iteration:Te}=await vG(J,ee,{iterationId:G});h(Te),s({step:3,totalSteps:4,message:"Generating translated video...",translationId:ee,iterationId:G});const le=await CG(J,ee,G,se=>{if(h(se),s({step:3,totalSteps:4,message:`Generating translated video... (${se.status})`,translationId:ee,iterationId:G}),console.log("Iteration status:",se.status,se),E.current)throw new Error("Cancelled")});if(le.status==="Failed")throw new Error(le.failureReason||"Iteration failed");return r("completed"),s({step:4,totalSteps:4,message:"Translation completed!",translationId:ee,iterationId:G}),h(le),b(X,{status:"Succeeded",completedAt:new Date().toISOString(),resultVideoUrl:(Y=le.result)==null?void 0:Y.translatedVideoFileUrl,sourceSubtitleUrl:(ce=le.result)==null?void 0:ce.sourceLocaleSubtitleWebvttFileUrl,targetSubtitleUrl:(ae=le.result)==null?void 0:ae.targetLocaleSubtitleWebvttFileUrl,metadataUrl:($=le.result)==null?void 0:$.metadataJsonWebvttFileUrl}),le}catch(J){const de=J instanceof Error?J.message:"Unknown error occurred";de==="Cancelled"?(r("cancelled"),b(X,{status:"Canceled"})):(a(de),r("error"),b(X,{status:"Failed",error:de}))}},[x,P,b]),D=O.useCallback(()=>{E.current=!0},[]),j=O.useCallback(async()=>{try{const H=x(),V=await mG(H);return v(V.value),V.value}catch(H){const V=H instanceof Error?H.message:"Failed to load translations";return a(V),[]}},[x]),F=O.useCallback(async H=>{try{const V=x(),K=await tU(V,H);return c(K),K}catch(V){const K=V instanceof Error?V.message:"Failed to refresh translation";return a(K),null}},[x]),z=O.useCallback(async H=>{try{const V=x();return await gG(V,H),v(K=>K.filter(ee=>ee.id!==H)),!0}catch(V){const K=V instanceof Error?V.message:"Failed to delete translation";return a(K),!1}},[x]),W=O.useCallback(()=>{r("idle"),s({step:0,totalSteps:4,message:""}),a(null),c(null),h(null),E.current=!1},[]);return{status:t,progress:i,error:o,currentTranslation:l,currentIteration:u,translations:m,history:C,startTranslation:N,cancelTranslation:D,loadTranslations:j,refreshTranslation:F,deleteTranslation:z,reset:W,removeFromHistory:I,clearHistory:M}}const rU=[{code:"",label:"Auto-detect"},{code:"en-US",label:"English (US)"},{code:"en-GB",label:"English (UK)"},{code:"zh-CN",label:"Chinese (Simplified)"},{code:"zh-TW",label:"Chinese (Traditional)"},{code:"ja-JP",label:"Japanese"},{code:"ko-KR",label:"Korean"},{code:"es-ES",label:"Spanish (Spain)"},{code:"es-MX",label:"Spanish (Mexico)"},{code:"fr-FR",label:"French (France)"},{code:"de-DE",label:"German"},{code:"it-IT",label:"Italian"},{code:"pt-BR",label:"Portuguese (Brazil)"},{code:"pt-PT",label:"Portuguese (Portugal)"},{code:"ru-RU",label:"Russian"},{code:"ar-SA",label:"Arabic (Saudi Arabia)"},{code:"hi-IN",label:"Hindi"},{code:"th-TH",label:"Thai"},{code:"vi-VN",label:"Vietnamese"},{code:"id-ID",label:"Indonesian"},{code:"ms-MY",label:"Malay"},{code:"nl-NL",label:"Dutch"},{code:"pl-PL",label:"Polish"},{code:"tr-TR",label:"Turkish"},{code:"sv-SE",label:"Swedish"},{code:"da-DK",label:"Danish"},{code:"fi-FI",label:"Finnish"},{code:"nb-NO",label:"Norwegian"},{code:"uk-UA",label:"Ukrainian"},{code:"cs-CZ",label:"Czech"},{code:"he-IL",label:"Hebrew"}],EG=rU.filter(n=>n.code!==""),xG=["centralus","eastus","japaneast","northcentralus","southcentralus","southeastasia","westcentralus","westeurope","westus","westus2","westus3"],iU="video-translation-config";function wG(){try{const n=localStorage.getItem(iU);return n?JSON.parse(n):{}}catch{return{}}}function bG(n){localStorage.setItem(iU,JSON.stringify(n))}function PG({settings:n,isConfigured:e}){const[t,r]=O.useState("upload"),[i,s]=O.useState(null),[o,a]=O.useState(""),[l,c]=O.useState(null),[u,h]=O.useState(!1),[m,v]=O.useState(null),[C,T]=O.useState(RF),[E,x]=O.useState(!1),P=wG(),[b,I]=O.useState(P.sourceLocale||""),[M,N]=O.useState(P.targetLocale||"en-US"),[D,j]=O.useState(P.voiceKind||"PlatformVoice"),[F,z]=O.useState(P.enableLipSync||!1),[W,H]=O.useState(P.exportSubtitleInVideo||!1),[V,K]=O.useState(P.speakerCount),[ee,G]=O.useState(P.subtitleMaxCharCountPerSegment),[X,Y]=O.useState(!1),[ce,ae]=O.useState(!1),{status:$,progress:J,error:de,currentIteration:me,history:Te,startTranslation:le,cancelTranslation:se,reset:ie,removeFromHistory:Se,clearHistory:re}=TG({apiKey:n.apiKey,region:n.region});O.useEffect(()=>{bG({sourceLocale:b,targetLocale:M,voiceKind:D,enableLipSync:F,exportSubtitleInVideo:W,speakerCount:V,subtitleMaxCharCountPerSegment:ee})},[b,M,D,F,W,V,ee]),O.useEffect(()=>{IF(C)},[C]);const pe=O.useCallback(be=>{s(be),c(null),v(null)},[]),ne=O.useCallback(async()=>{if(!i)return;const be=PF(C);if(be){v(be),x(!0);return}h(!0),v(null);try{const gt=await bF(i,C);c(gt)}catch(gt){v(gt instanceof Error?gt.message:"Failed to upload video")}finally{h(!1)}},[i,C]),ve=O.useCallback(async()=>{let be="";if(t==="upload"){if(!l){v("Please upload the video to blob storage first");return}be=l}else{if(!o.trim()){v("Please enter a video URL");return}be=o.trim()}await le(be,{sourceLocale:b,targetLocale:M,voiceKind:D,enableLipSync:F,exportSubtitleInVideo:W,speakerCount:V,subtitleMaxCharCountPerSegment:ee})},[t,l,o,b,M,D,F,W,V,ee,le]),ge=O.useCallback(()=>{ie(),s(null),c(null),a(""),v(null)},[ie]),Ie=be=>{switch(be){case"completed":return"text-green-600";case"error":return"text-red-600";case"cancelled":return"text-yellow-600";default:return"text-blue-600"}},fe=be=>new Date(be).toLocaleString(),xe=["creating","processing","iterating","uploading"].includes($),$e=xG.includes(n.region.toLowerCase()),Ge=e&&$e&&!xe&&(t==="upload"&&l||t==="url"&&o.trim());return e?g.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[g.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-6",children:[g.jsx("h1",{className:"text-2xl font-bold",children:"Video Translation"}),g.jsx("p",{className:"text-indigo-100 mt-1",children:"Translate videos into different languages with AI-powered voice dubbing"})]}),g.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[g.jsx("div",{className:"flex-1 overflow-auto p-6",children:g.jsxs("div",{className:"space-y-6",children:[e&&!$e&&g.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("svg",{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-semibold text-amber-800",children:"Region Not Supported"}),g.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Video Translation is currently only available in the following regions:"}),g.jsxs("ul",{className:"text-sm text-amber-700 mt-2 list-disc list-inside grid grid-cols-2 gap-x-4",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Central US"})," (centralus)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"East US"})," (eastus)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Japan East"})," (japaneast)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"North Central US"})," (northcentralus)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"South Central US"})," (southcentralus)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Southeast Asia"})," (southeastasia)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"West Central US"})," (westcentralus)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"West Europe"})," (westeurope)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"West US"})," (westus)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"West US 2"})," (westus2)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"West US 3"})," (westus3)"]})]}),g.jsxs("p",{className:"text-sm text-amber-700 mt-2",children:["Your current region: ",g.jsx("strong",{children:n.region}),". Please change your region in the sidebar settings."]})]})]})}),g.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[g.jsxs("button",{onClick:()=>x(!E),className:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-gray-50",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("svg",{className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})}),g.jsx("span",{className:"font-medium text-gray-700",children:"Blob Storage Configuration"}),C.accountName&&g.jsx("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-0.5 rounded",children:"Configured"})]}),g.jsx("svg",{className:`h-5 w-5 text-gray-400 transform transition-transform ${E?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),E&&g.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t",children:[g.jsxs("div",{className:"pt-3",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Storage Account Name"}),g.jsx("input",{type:"text",value:C.accountName,onChange:be=>T({...C,accountName:be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"mystorageaccount"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Container Name"}),g.jsx("input",{type:"text",value:C.containerName,onChange:be=>T({...C,containerName:be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"videos"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SAS Token"}),g.jsx("input",{type:"password",value:C.sasToken,onChange:be=>T({...C,sasToken:be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"?sv=2021-06-08&ss=b..."})]})]})]}),g.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[g.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Video Source"}),g.jsxs("div",{className:"flex space-x-4 mb-4",children:[g.jsx("button",{onClick:()=>r("upload"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${t==="upload"?"bg-indigo-100 text-indigo-700":"text-gray-600 hover:bg-gray-100"}`,children:"Upload from Local"}),g.jsx("button",{onClick:()=>r("url"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${t==="url"?"bg-indigo-100 text-indigo-700":"text-gray-600 hover:bg-gray-100"}`,children:"From URL"})]}),t==="upload"?g.jsxs("div",{className:"space-y-4",children:[g.jsx(pG,{onFileSelected:pe,disabled:xe}),i&&!l&&g.jsx("button",{onClick:ne,disabled:u||xe,className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:u?g.jsxs(g.Fragment,{children:[g.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),g.jsx("span",{children:"Uploading to Blob..."})]}):g.jsxs(g.Fragment,{children:[g.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),g.jsx("span",{children:"Upload to Blob Storage"})]})}),l&&g.jsxs("div",{className:"flex items-center space-x-2 text-sm text-green-600 bg-green-50 p-3 rounded-md",children:[g.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),g.jsx("span",{children:"Video uploaded to blob storage"})]})]}):g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Video URL"}),g.jsx("input",{type:"url",value:o,onChange:be=>a(be.target.value),placeholder:"https://example.com/video.mp4",disabled:xe,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"})]}),g.jsx("p",{className:"text-xs text-gray-500",children:"Enter a direct URL to an MP4 video file. The URL must be publicly accessible."})]}),m&&g.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-3",children:m})]}),g.jsxs("div",{className:"flex space-x-4",children:[g.jsxs("button",{onClick:ve,disabled:!Ge,className:"flex-1 px-6 py-3 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[g.jsxs("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),g.jsx("span",{children:"Start Translation"})]}),xe&&g.jsx("button",{onClick:se,className:"px-6 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700",children:"Cancel"})]}),$!=="idle"&&g.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[g.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Translation Progress"}),J.translationId&&g.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["Translation ID: ",g.jsx("code",{className:"bg-gray-100 px-2 py-0.5 rounded",children:J.translationId})]}),g.jsxs("div",{className:"mb-4",children:[g.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[g.jsx("span",{className:Ie($),children:J.message}),g.jsxs("span",{children:[Math.round(J.step/J.totalSteps*100),"%"]})]}),g.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:g.jsx("div",{className:`h-full transition-all duration-500 ${$==="error"?"bg-red-500":$==="completed"?"bg-green-500":"bg-indigo-500"}`,style:{width:`${J.step/J.totalSteps*100}%`}})})]}),g.jsx("div",{className:"space-y-2",children:["Upload video to blob","Create translation","Generate translated video","Download results"].map((be,gt)=>g.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[J.step>gt+1?g.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):J.step===gt+1&&xe?g.jsxs("svg",{className:"animate-spin h-5 w-5 text-indigo-500",fill:"none",viewBox:"0 0 24 24",children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):g.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-gray-300"}),g.jsxs("span",{className:J.step>gt?"text-gray-900":"text-gray-400",children:[gt+1,". ",be]})]},gt))}),de&&g.jsx("div",{className:"mt-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-3",children:de})]}),$==="completed"&&(me==null?void 0:me.result)&&g.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[g.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Results"}),g.jsxs("div",{className:"mb-6",children:[g.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Translated Video"}),me.result.translatedVideoFileUrl?g.jsxs("div",{className:"space-y-3",children:[g.jsx("video",{src:me.result.translatedVideoFileUrl,controls:!0,className:"w-full max-h-[480px] rounded-lg bg-black object-contain"}),g.jsxs("a",{href:me.result.translatedVideoFileUrl,download:!0,className:"inline-flex items-center space-x-2 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm",children:[g.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),g.jsx("span",{children:"Download Video"})]})]}):g.jsx("p",{className:"text-sm text-gray-500",children:"Video not available"})]}),g.jsxs("div",{className:"border-t pt-4",children:[g.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Subtitles & Metadata"}),g.jsxs("div",{className:"flex flex-wrap gap-4",children:[me.result.sourceLocaleSubtitleWebvttFileUrl&&g.jsxs("a",{href:me.result.sourceLocaleSubtitleWebvttFileUrl,download:!0,className:"flex items-center space-x-2 text-sm text-indigo-600 hover:text-indigo-800 bg-indigo-50 px-3 py-2 rounded-md",children:[g.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),g.jsx("span",{children:"Source Subtitles (WebVTT)"})]}),me.result.targetLocaleSubtitleWebvttFileUrl&&g.jsxs("a",{href:me.result.targetLocaleSubtitleWebvttFileUrl,download:!0,className:"flex items-center space-x-2 text-sm text-indigo-600 hover:text-indigo-800 bg-indigo-50 px-3 py-2 rounded-md",children:[g.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),g.jsx("span",{children:"Target Subtitles (WebVTT)"})]}),me.result.metadataJsonWebvttFileUrl&&g.jsxs("a",{href:me.result.metadataJsonWebvttFileUrl,download:!0,className:"flex items-center space-x-2 text-sm text-indigo-600 hover:text-indigo-800 bg-indigo-50 px-3 py-2 rounded-md",children:[g.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),g.jsx("span",{children:"Metadata JSON"})]})]})]}),g.jsx("div",{className:"mt-4 pt-4 border-t",children:g.jsx("button",{onClick:ge,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded-md hover:bg-gray-50",children:"Start New Translation"})})]}),g.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[g.jsxs("button",{onClick:()=>ae(!ce),className:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-gray-50",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("svg",{className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),g.jsx("span",{className:"font-medium text-gray-700",children:"Translation History"}),g.jsxs("span",{className:"text-xs text-gray-500",children:["(",Te.length,")"]})]}),g.jsx("svg",{className:`h-5 w-5 text-gray-400 transform transition-transform ${ce?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ce&&g.jsx("div",{className:"border-t",children:Te.length===0?g.jsx("p",{className:"p-4 text-sm text-gray-500 text-center",children:"No translation history yet"}):g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"max-h-64 overflow-auto",children:g.jsxs("table",{className:"w-full text-sm",children:[g.jsx("thead",{className:"bg-gray-50 sticky top-0",children:g.jsxs("tr",{children:[g.jsx("th",{className:"px-4 py-2 text-left text-gray-600",children:"Name"}),g.jsx("th",{className:"px-4 py-2 text-left text-gray-600",children:"Source"}),g.jsx("th",{className:"px-4 py-2 text-left text-gray-600",children:"Target"}),g.jsx("th",{className:"px-4 py-2 text-left text-gray-600",children:"Status"}),g.jsx("th",{className:"px-4 py-2 text-left text-gray-600",children:"Created"}),g.jsx("th",{className:"px-4 py-2 text-right text-gray-600",children:"Actions"})]})}),g.jsx("tbody",{className:"divide-y",children:Te.map(be=>g.jsxs("tr",{className:"hover:bg-gray-50",children:[g.jsx("td",{className:"px-4 py-2 truncate max-w-[150px]",title:be.displayName,children:be.displayName||be.translationId.slice(0,8)}),g.jsx("td",{className:"px-4 py-2",children:be.sourceLocale||"Auto"}),g.jsx("td",{className:"px-4 py-2",children:be.targetLocale}),g.jsx("td",{className:"px-4 py-2",children:g.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${be.status==="Succeeded"?"bg-green-100 text-green-800":be.status==="Failed"?"bg-red-100 text-red-800":be.status==="Running"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:be.status})}),g.jsx("td",{className:"px-4 py-2 text-gray-500",children:fe(be.createdAt)}),g.jsx("td",{className:"px-4 py-2 text-right",children:g.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[be.resultVideoUrl&&g.jsx("a",{href:be.resultVideoUrl,download:!0,className:"text-indigo-600 hover:text-indigo-800",title:"Download video",children:g.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),g.jsx("button",{onClick:()=>Se(be.id),className:"text-red-600 hover:text-red-800",title:"Remove from history",children:g.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},be.id))})]})}),g.jsx("div",{className:"p-2 border-t bg-gray-50",children:g.jsx("button",{onClick:re,className:"text-sm text-red-600 hover:text-red-800",children:"Clear All History"})})]})})]})]})}),g.jsxs("div",{className:"w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 overflow-auto",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Translation Settings"}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Language"}),g.jsx("select",{value:b,onChange:be=>I(be.target.value),disabled:xe,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100",children:rU.map(be=>g.jsx("option",{value:be.code,children:be.label},be.code))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Language"}),g.jsx("select",{value:M,onChange:be=>N(be.target.value),disabled:xe,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100",children:EG.map(be=>g.jsx("option",{value:be.code,children:be.label},be.code))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Voice Type"}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("label",{className:"flex items-center",children:[g.jsx("input",{type:"radio",value:"PlatformVoice",checked:D==="PlatformVoice",onChange:be=>j(be.target.value),disabled:xe,className:"mr-2"}),g.jsx("span",{className:"text-sm text-gray-700",children:"Platform Voice (Standard)"})]}),g.jsxs("label",{className:"flex items-center",children:[g.jsx("input",{type:"radio",value:"PersonalVoice",checked:D==="PersonalVoice",onChange:be=>j(be.target.value),disabled:xe,className:"mr-2"}),g.jsx("span",{className:"text-sm text-gray-700",children:"Personal Voice"})]})]})]}),g.jsxs("div",{className:"border-t pt-4",children:[g.jsxs("button",{onClick:()=>Y(!X),className:"flex items-center space-x-2 text-sm text-gray-600 hover:text-gray-900 w-full",children:[g.jsx("svg",{className:`h-4 w-4 transform transition-transform ${X?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),g.jsx("span",{children:"Advanced Options"})]}),X&&g.jsxs("div",{className:"mt-4 space-y-4",children:[g.jsxs("label",{className:"flex items-center",children:[g.jsx("input",{type:"checkbox",checked:F,onChange:be=>z(be.target.checked),disabled:xe,className:"mr-2"}),g.jsx("span",{className:"text-sm text-gray-700",children:"Enable Lip Sync"})]}),g.jsxs("label",{className:"flex items-center",children:[g.jsx("input",{type:"checkbox",checked:W,onChange:be=>H(be.target.checked),disabled:xe,className:"mr-2"}),g.jsx("span",{className:"text-sm text-gray-700",children:"Burn Subtitles in Video"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Speaker Count"}),g.jsx("input",{type:"number",min:"1",max:"10",value:V||"",onChange:be=>K(be.target.value?parseInt(be.target.value):void 0),placeholder:"Auto-detect",disabled:xe,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subtitle Max Chars"}),g.jsx("input",{type:"number",min:"10",max:"100",value:ee||"",onChange:be=>G(be.target.value?parseInt(be.target.value):void 0),placeholder:"Default",disabled:xe,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"})]})]})]})]})]})]})]}):g.jsx("div",{className:"p-8",children:g.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[g.jsx("h3",{className:"text-lg font-medium text-yellow-800 mb-2",children:"Configuration Required"}),g.jsx("p",{className:"text-yellow-700",children:"Please configure your Azure Speech API key and region in the settings panel to use Video Translation."})]})})}const Dw=1*1024*1024,_2=50*1024*1024;function RG({onContentChange:n,disabled:e=!1}){const[t,r]=O.useState("text"),[i,s]=O.useState(""),[o,a]=O.useState(""),[l,c]=O.useState(null),[u,h]=O.useState(!1),[m,v]=O.useState(null),C=O.useRef(null),T=z=>{if(v(null),!z){n(null);return}if(z.type==="text"&&z.text&&z.text.length>Dw){v(`Text is too long. Maximum ${(Dw/1024/1024).toFixed(0)}MB allowed.`);return}if(z.type==="file"&&z.file){if(z.file.size>_2){v(`File is too large. Maximum ${(_2/1024/1024).toFixed(0)}MB allowed.`);return}const W=z.file.name.toLowerCase();if(!W.endsWith(".pdf")&&!W.endsWith(".txt")){v("Only PDF and TXT files are supported.");return}}if(z.type==="url"&&z.url)try{new URL(z.url)}catch{v("Please enter a valid URL.");return}n(z)},E=z=>{s(z),z.trim()?T({type:"text",text:z.trim()}):T(null)},x=z=>{a(z),z.trim()?T({type:"url",url:z.trim()}):T(null)},P=z=>{c(z),T({type:"file",file:z,fileName:z.name})},b=z=>{var H;const W=(H=z.target.files)==null?void 0:H[0];W&&P(W)},I=z=>{z.preventDefault(),z.stopPropagation(),z.type==="dragenter"||z.type==="dragover"?h(!0):z.type==="dragleave"&&h(!1)},M=z=>{var H;z.preventDefault(),z.stopPropagation(),h(!1);const W=(H=z.dataTransfer.files)==null?void 0:H[0];W&&P(W)},N=()=>{c(null),C.current&&(C.current.value=""),T(null)},D=z=>{r(z),v(null),n(null)},F=t==="text"&&i?i.substring(0,200)+(i.length>200?"...":""):t==="url"&&o?o:t==="file"&&l?`${l.name} (${(l.size/1024).toFixed(1)} KB)`:null;return g.jsxs("div",{className:"space-y-3",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Content Source"}),g.jsxs("div",{className:"flex border-b border-gray-200",children:[g.jsx("button",{onClick:()=>D("text"),disabled:e,className:`px-4 py-2 text-sm font-medium transition-colors ${t==="text"?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-500 hover:text-gray-700"} ${e?"opacity-50 cursor-not-allowed":""}`,children:"Text Input"}),g.jsx("button",{onClick:()=>D("url"),disabled:e,className:`px-4 py-2 text-sm font-medium transition-colors ${t==="url"?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-500 hover:text-gray-700"} ${e?"opacity-50 cursor-not-allowed":""}`,children:"URL"}),g.jsx("button",{onClick:()=>D("file"),disabled:e,className:`px-4 py-2 text-sm font-medium transition-colors ${t==="file"?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-500 hover:text-gray-700"} ${e?"opacity-50 cursor-not-allowed":""}`,children:"File Upload"})]}),g.jsxs("div",{className:"mt-3",children:[t==="text"&&g.jsxs("div",{children:[g.jsx("textarea",{value:i,onChange:z=>E(z.target.value),disabled:e,placeholder:"Paste your text content here (up to 1MB)...",className:"w-full h-48 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed resize-none"}),g.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[i.length.toLocaleString()," / ",Dw.toLocaleString()," characters"]})]}),t==="url"&&g.jsxs("div",{children:[g.jsx("input",{type:"url",value:o,onChange:z=>x(z.target.value),disabled:e,placeholder:"https://example.com/document.pdf",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed"}),g.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Enter a public URL to a PDF or HTML document"})]}),t==="file"&&g.jsxs("div",{children:[l?g.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center space-x-3",children:[g.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.name}),g.jsxs("div",{className:"text-xs text-gray-500",children:[(l.size/1024).toFixed(1)," KB"]})]})]}),g.jsx("button",{onClick:N,disabled:e,className:"text-red-600 hover:text-red-800 disabled:opacity-50",children:g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}):g.jsxs("div",{onDragEnter:I,onDragLeave:I,onDragOver:I,onDrop:M,onClick:()=>{var z;return!e&&((z=C.current)==null?void 0:z.click())},className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${u?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:border-indigo-400 hover:bg-gray-50"} ${e?"opacity-50 cursor-not-allowed":""}`,children:[g.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),g.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[g.jsx("span",{className:"font-medium text-indigo-600",children:"Click to upload"})," or drag and drop"]}),g.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"PDF or TXT files up to 50MB"})]}),g.jsx("input",{ref:C,type:"file",accept:".pdf,.txt",onChange:b,disabled:e,className:"hidden"})]})]}),m&&g.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-md",children:[g.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),g.jsx("div",{className:"text-sm text-red-800",children:m})]}),F&&!m&&g.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md",children:[g.jsx("div",{className:"text-xs text-blue-600 font-medium mb-1",children:"Selected Content:"}),g.jsx("div",{className:"text-sm text-blue-800 break-all",children:F})]})]})}const IG=[{female:"ava",male:"andrew",display:"Ava & Andrew"},{female:"ava",male:"brian",display:"Ava & Brian"},{female:"ava",male:"davis",display:"Ava & Davis"},{female:"ava",male:"steffan",display:"Ava & Steffan"},{female:"ada",male:"andrew",display:"Ada & Andrew"},{female:"ada",male:"brian",display:"Ada & Brian"},{female:"ada",male:"davis",display:"Ada & Davis"},{female:"ada",male:"steffan",display:"Ada & Steffan"},{female:"emma",male:"andrew",display:"Emma & Andrew"},{female:"emma",male:"brian",display:"Emma & Brian"},{female:"emma",male:"davis",display:"Emma & Davis"},{female:"emma",male:"steffan",display:"Emma & Steffan"},{female:"jane",male:"andrew",display:"Jane & Andrew"},{female:"jane",male:"brian",display:"Jane & Brian"},{female:"jane",male:"davis",display:"Jane & Davis"},{female:"jane",male:"steffan",display:"Jane & Steffan"}];function _G({locale:n,selectedPair:e,onPairChange:t,disabled:r=!1}){const[i,s]=O.useState(""),o=O.useMemo(()=>IG,[]),a=O.useMemo(()=>{if(!i)return o;const l=i.toLowerCase();return o.filter(c=>c.display.toLowerCase().includes(l)||c.female.toLowerCase().includes(l)||c.male.toLowerCase().includes(l))},[o,i]);return g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Voice Pair"}),g.jsx("input",{type:"text",placeholder:"Search voice pairs...",value:i,onChange:l=>s(l.target.value),disabled:r,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed"}),e&&g.jsxs("div",{className:"p-2 bg-purple-50 border border-purple-200 rounded-md",children:[g.jsx("div",{className:"text-xs text-purple-600 font-medium",children:"Selected:"}),g.jsx("div",{className:"text-sm text-purple-800",children:e.display}),g.jsxs("div",{className:"text-xs text-purple-600 mt-0.5",children:["Female: ",e.female," | Male: ",e.male]})]}),g.jsxs("div",{className:"border border-gray-200 rounded-md max-h-64 overflow-y-auto",children:[a.length===0&&g.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:i?"No voice pairs found matching search":"No voice pairs available"}),a.map((l,c)=>g.jsx("button",{onClick:()=>t(l),disabled:r,className:`w-full px-4 py-3 text-left border-b border-gray-100 last:border-b-0 transition-colors ${(e==null?void 0:e.female)===l.female&&(e==null?void 0:e.male)===l.male?"bg-purple-50 border-l-4 border-l-purple-600":"hover:bg-gray-50"} ${r?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex-1",children:[g.jsx("div",{className:"flex items-center gap-2",children:g.jsx("span",{className:"text-sm font-medium text-gray-800",children:l.display})}),g.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Female: ",g.jsx("span",{className:"text-pink-600 font-medium",children:l.female})," | Male: ",g.jsxs("span",{className:"text-blue-600 font-medium",children:[" ",l.male]})]})]}),(e==null?void 0:e.female)===l.female&&(e==null?void 0:e.male)===l.male&&g.jsx("svg",{className:"w-5 h-5 text-purple-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:g.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]})},`${l.female}-${l.male}`))]}),g.jsxs("div",{className:"text-xs text-gray-500",children:[a.length," voice pair",a.length!==1?"s":""," available",i&&` (filtered from ${o.length})`]})]})}function kG(n,e){return n?{voiceName:"",speakerNames:`${n.female},${n.male}`}:null}const sU="2026-01-01-preview";function oU(n){return`https://${n}.api.cognitive.microsoft.com/podcast`}function aU(n,e){const t={"Ocp-Apim-Subscription-Key":n,"Content-Type":"application/json"};return e&&(t["Operation-Id"]=e),t}async function lU(n){var e,t;if(!n.ok){let r=`API Error: ${n.status} ${n.statusText}`;try{const i=await n.json();console.error("Podcast API Error Response:",i),(e=i.error)!=null&&e.message?r=i.error.message:i.message?r=i.message:(t=i.error)!=null&&t.code&&(r=`${i.error.code}: ${JSON.stringify(i.error)}`)}catch{}throw new Error(r)}return n.status===204?{}:n.json()}async function MG(n){return new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{const s=r.result.split(",")[1];e(s)},r.onerror=t,r.readAsDataURL(n)})}async function NG(n){if(n.type==="text")return{kind:"PlainText",text:n.text,fileFormat:"Txt"};if(n.type==="url"){const e=n.url.toLowerCase(),t=e.endsWith(".pdf")||e.includes(".pdf?");return{kind:"AzureStorageBlobPublicUrl",url:n.url,fileFormat:t?"Pdf":"Txt"}}if(n.type==="file"&&n.file){const e=await MG(n.file),t=n.file.type==="application/pdf"||n.file.name.toLowerCase().endsWith(".pdf");return{kind:"FileBase64",base64Text:e,fileFormat:t?"Pdf":"Txt"}}throw new Error("Invalid content source")}async function LG(n,e){const t=`${oU(n.region)}/generations/${e.generationId}?api-version=${sU}`,r=crypto.randomUUID(),i={locale:e.locale,host:e.host,content:e.content};e.displayName!==void 0&&(i.displayName=e.displayName),e.scriptGeneration!==void 0&&(i.scriptGeneration=e.scriptGeneration),e.tts!==void 0&&(i.tts=e.tts),console.log("Creating podcast generation:",e.generationId),console.log("Request body:",JSON.stringify(i,null,2));const s=await fetch(t,{method:"PUT",headers:aU(n.apiKey,r),body:JSON.stringify(i)}),o=await lU(s),a=s.headers.get("Operation-Location")||"";return{generation:o,operationLocation:a}}async function DG(n,e){const t=`${oU(n.region)}/generations/${e}?api-version=${sU}`,r=await fetch(t,{method:"GET",headers:aU(n.apiKey)});return lU(r)}async function OG(n,e,t,r=1800*1e3,i=3e3){const s=Date.now();for(;Date.now()-s<r;){const o=await DG(n,e);if(t&&t(o),o.status==="Succeeded")return console.log("Generation succeeded:",e),o;if(o.status==="Failed"){const a=o.failureReason||"Generation failed";throw console.error("Generation failed:",a),new Error(a)}console.log(`Generation ${e} status: ${o.status}`),await new Promise(a=>setTimeout(a,i))}throw new Error(`Generation timed out after ${r/1e3} seconds`)}function BG(){return crypto.randomUUID()}function FG({apiKey:n,region:e}){const[t,r]=O.useState("idle"),[i,s]=O.useState({step:0,totalSteps:5,message:""}),[o,a]=O.useState(null),[l,c]=O.useState(null),u=O.useRef(!1),h=O.useCallback(()=>({region:e,apiKey:n}),[e,n]),m=O.useCallback(async(T,E,x,P,b)=>{var I,M,N;try{a(null),r("creating"),s({step:1,totalSteps:5,message:"Preparing content..."}),u.current=!1,console.log("Starting podcast generation with config:",E);const D=h(),j=BG(),F=await NG(T);if(u.current){r("cancelled");return}s({step:2,totalSteps:5,message:"Creating generation..."}),r("creating");const z={generationId:j,locale:E.locale,host:E.hostType,displayName:`Podcast ${new Date().toLocaleString()}`,content:F,scriptGeneration:{style:E.style,length:E.length,additionalInstructions:E.additionalInstructions||void 0},tts:E.hostType==="TwoHosts"&&x&&P?{voiceName:x,multiTalkerVoiceSpeakerNames:P}:void 0};console.log("Creating generation with params:",z);const{generation:W}=await LG(D,z);if(u.current){r("cancelled");return}s({step:3,totalSteps:5,message:"Generating script..."}),r("processing");const H=await OG(D,j,V=>{if(u.current)throw new Error("Cancelled by user");V.status==="Running"&&s({step:4,totalSteps:5,message:"Converting to audio..."}),c(V)},1800*1e3,3e3);if(u.current){r("cancelled");return}if(s({step:5,totalSteps:5,message:"Completed!"}),r("completed"),c(H),b&&((I=H.output)!=null&&I.audioFileUrl)){const V=T.type==="text"?((M=T.text)==null?void 0:M.substring(0,100))||"":T.type==="url"?T.url||"":((N=T.file)==null?void 0:N.name)||"";b({generationId:H.id,timestamp:Date.now(),displayName:H.displayName||"Podcast",locale:H.locale,hostType:H.host,voiceName:x,style:E.style,length:E.length,status:H.status,audioUrl:H.output.audioFileUrl,contentPreview:V})}return H}catch(D){const j=D instanceof Error?D.message:"Unknown error occurred";throw console.error("Podcast generation failed:",D),j.includes("Cancelled")?(r("cancelled"),a("Generation cancelled")):(r("error"),a(j)),D}},[h]),v=O.useCallback(()=>{console.log("Cancelling podcast generation"),u.current=!0,r("cancelled"),s({step:0,totalSteps:5,message:"Cancelled"})},[]),C=O.useCallback(()=>{r("idle"),s({step:0,totalSteps:5,message:""}),a(null),c(null),u.current=!1},[]);return{status:t,progress:i,error:o,currentGeneration:l,startGeneration:m,cancelGeneration:v,reset:C}}async function jG(n){return new Promise((e,t)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>e(r),r.onerror=i=>t(new Error(`Failed to load image: ${i}`)),r.src=n})}function UG(n,e,t,r){const i=n.getContext("2d");if(!i)return;const s=r||["#667eea","#764ba2","#f093fb"],o=i.createLinearGradient(0,0,e,t);s.length===2?(o.addColorStop(0,s[0]),o.addColorStop(1,s[1])):s.length===3?(o.addColorStop(0,s[0]),o.addColorStop(.5,s[1]),o.addColorStop(1,s[2])):s.forEach((a,l)=>{o.addColorStop(l/(s.length-1),a)}),i.fillStyle=o,i.fillRect(0,0,e,t),i.fillStyle="rgba(255, 255, 255, 0.03)";for(let a=0;a<1e3;a++){const l=Math.random()*e,c=Math.random()*t,u=Math.random()*2;i.fillRect(l,c,u,u)}}function zG(n,e,t){UG(n,e,t,["#667eea","#764ba2","#f093fb"])}class WG{constructor(e){q(this,"canvas");q(this,"ctx");q(this,"audioElement");q(this,"audioContext",null);q(this,"mediaRecorder",null);q(this,"recordedChunks",[]);q(this,"isRecording",!1);q(this,"backgroundImage",null);q(this,"backgroundImageUrl",null);q(this,"audioBlobUrl",null);this.options=e;const t=e.width||1280,r=e.height||720;this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=r;const i=this.canvas.getContext("2d");if(!i)throw new Error("Failed to get canvas 2D context");this.ctx=i,this.audioElement=new Audio}async fetchBingImageUrl(){try{const r=Math.floor(Math.random()*7),i=await fetch(`https://bing.biturl.top/?resolution=1280&format=json&index=${r}&mkt=en-US`);if(i.ok){const s=await i.json();if(s.url)return console.log("Using Bing image (Method 1 - wallpaper API):",s.url),s.url}}catch(r){console.warn("Method 1 (wallpaper API) failed:",r)}try{const r="https://api.allorigins.win/raw?url=",i=encodeURIComponent("https://www.bing.com/HPImageArchive.aspx?format=js&idx=0&n=1&mkt=en-US"),s=await fetch(`${r}${i}`);if(s.ok){const o=await s.json();if(o.images&&o.images.length>0){const a=`https://www.bing.com${o.images[0].url}`;return console.log("Using Bing image (Method 2 - CORS proxy):",a),a}}}catch(r){console.warn("Method 2 (CORS proxy) failed:",r)}const e=["https://www.bing.com/th?id=OHR.NaplesBasilica_EN-US0488733664_1920x1080.jpg","https://www.bing.com/th?id=OHR.AuroraReine_EN-US9682343142_1920x1080.jpg","https://www.bing.com/th?id=OHR.LicancaburVolcano_EN-US9749384708_1920x1080.jpg","https://www.bing.com/th?id=OHR.SnowdoniaSnow_EN-US9892342479_1920x1080.jpg","https://www.bing.com/th?id=OHR.RedRocksArches_EN-US0089294623_1920x1080.jpg"],t=e[Math.floor(Math.random()*e.length)];return console.log("Using fallback Bing image:",t),t}initializeAudioContext(){this.audioContext||(this.audioContext=new AudioContext)}async drawBackground(){try{this.backgroundImageUrl||(this.backgroundImageUrl=await this.fetchBingImageUrl()),this.backgroundImage||(this.backgroundImage=await jG(this.backgroundImageUrl));const e=this.backgroundImage,t=Math.max(this.canvas.width/e.width,this.canvas.height/e.height),r=(this.canvas.width-e.width*t)/2,i=(this.canvas.height-e.height*t)/2;this.ctx.drawImage(e,r,i,e.width*t,e.height*t)}catch(e){console.warn("Failed to load image, using fallback gradient:",e),zG(this.canvas,this.canvas.width,this.canvas.height)}}async generate(){var e,t;try{console.log("Fetching audio from:",this.options.audioUrl);const i="https://api.allorigins.win/raw?url="+encodeURIComponent(this.options.audioUrl);console.log("Fetching via proxy:",i);const s=await fetch(i);if(!s.ok)throw new Error(`Failed to fetch audio via proxy: ${s.status} ${s.statusText}`);const o=await s.blob(),a=URL.createObjectURL(o);this.audioBlobUrl=a,this.audioElement=new Audio,this.audioElement.src=a,await this.audioElement.load(),await new Promise(C=>{this.audioElement.addEventListener("loadedmetadata",C,{once:!0})}),this.initializeAudioContext(),await this.drawBackground();const l=this.canvas.captureStream(1),c=this.audioContext.createMediaStreamDestination(),u=this.audioContext.createMediaElementSource(this.audioElement);u.connect(c),u.connect(this.audioContext.destination);const h=new MediaStream([...l.getVideoTracks(),...c.stream.getAudioTracks()]),m=["video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/webm"];let v="";for(const C of m)if(MediaRecorder.isTypeSupported(C)){v=C;break}if(!v)throw new Error("No supported video MIME type found");this.mediaRecorder=new MediaRecorder(h,{mimeType:v,videoBitsPerSecond:5e5}),this.recordedChunks=[],this.mediaRecorder.ondataavailable=C=>{C.data.size>0&&this.recordedChunks.push(C.data)},this.mediaRecorder.onstop=()=>{var T,E;const C=new Blob(this.recordedChunks,{type:v});(E=(T=this.options).onComplete)==null||E.call(T,C),this.cleanup()},this.isRecording=!0,this.mediaRecorder.start(),this.audioElement.play(),this.audioElement.addEventListener("timeupdate",()=>{var T,E;const C=this.audioElement.duration>0?this.audioElement.currentTime/this.audioElement.duration:0;(E=(T=this.options).onProgress)==null||E.call(T,C)}),this.audioElement.addEventListener("ended",()=>{this.stop()},{once:!0})}catch(r){console.error("Video generation error:",r),(t=(e=this.options).onError)==null||t.call(e,r),this.cleanup()}}stop(){this.isRecording=!1,this.mediaRecorder&&this.mediaRecorder.state!=="inactive"&&this.mediaRecorder.stop(),this.audioElement.pause()}cleanup(){this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.audioBlobUrl&&(URL.revokeObjectURL(this.audioBlobUrl),this.audioBlobUrl=null)}cancel(){this.stop(),this.cleanup()}}const VG=["eastus","westeurope","southeastasia"],$G=[{code:"en-US",label:"English (US)"},{code:"zh-CN",label:"Chinese (Simplified)"},{code:"ja-JP",label:"Japanese"},{code:"ko-KR",label:"Korean"},{code:"es-ES",label:"Spanish (Spain)"},{code:"fr-FR",label:"French (France)"},{code:"de-DE",label:"German"},{code:"it-IT",label:"Italian"},{code:"pt-BR",label:"Portuguese (Brazil)"}],HG=[{value:"OneHost",label:"Single Host",description:"One narrator guides the podcast"},{value:"TwoHosts",label:"Two Hosts",description:"Conversational format with two speakers"}],ZG=[{value:"Default",label:"Default"},{value:"Professional",label:"Professional"},{value:"Casual",label:"Casual"}],qG=[{value:"VeryShort",label:"Very Short",description:"~1 min"},{value:"Short",label:"Short",description:"~3 min"},{value:"Medium",label:"Medium",description:"~5 min"},{value:"Long",label:"Long",description:"~10 min"},{value:"VeryLong",label:"Very Long",description:"~15+ min"}],cU="podcast-agent-config";function GG(){try{const n=localStorage.getItem(cU);return n?JSON.parse(n):{}}catch{return{}}}function KG(n){localStorage.setItem(cU,JSON.stringify(n))}function YG({settings:n,isConfigured:e,history:t,addToHistory:r,removeFromHistory:i,clearHistory:s}){var ve;const o=GG(),[a,l]=O.useState(null),[c,u]=O.useState(o.locale||"en-US"),[h,m]=O.useState(o.hostType||"TwoHosts"),[v,C]=O.useState(o.voicePair||null),[T,E]=O.useState(o.style||"Default"),[x,P]=O.useState(o.length||"Medium"),[b,I]=O.useState(o.additionalInstructions||""),[M,N]=O.useState(!1),[D,j]=O.useState(!1),[F,z]=O.useState(0),[W,H]=O.useState(null),[V,K]=O.useState(null),ee=O.useRef(null),{status:G,progress:X,error:Y,currentGeneration:ce,startGeneration:ae,cancelGeneration:$,reset:J}=FG({apiKey:n.apiKey,region:n.region});O.useEffect(()=>{KG({locale:c,hostType:h,style:T,length:x,additionalInstructions:b,voicePair:v||void 0})},[c,h,T,x,b,v]),O.useEffect(()=>{C(null)},[c,h]);const de=O.useCallback(async()=>{if(!a)return;const ge={locale:c,hostType:h,style:T,length:x,additionalInstructions:b.trim()||void 0},Ie=h==="TwoHosts"?kG(v):null,fe=Ie==null?void 0:Ie.voiceName,xe=Ie==null?void 0:Ie.speakerNames;await ae(a,ge,fe,xe,r)},[a,c,h,T,x,b,v,ae,r]),me=O.useCallback(()=>{J(),l(null)},[J]),Te=O.useCallback(ge=>{ge.audioUrl&&window.open(ge.audioUrl,"_blank")},[]),le=O.useCallback(async()=>{var ge;if((ge=ce==null?void 0:ce.output)!=null&&ge.audioFileUrl)try{j(!0),z(0),H(null),K(null);const Ie=ce.displayName||"AI Podcast",fe=new WG({audioUrl:ce.output.audioFileUrl,podcastTitle:Ie,width:1280,height:720,onProgress:xe=>{z(xe)},onComplete:xe=>{K(xe),j(!1),console.log("Video generation completed!",xe)},onError:xe=>{H(xe.message),j(!1),console.error("Video generation error:",xe)}});ee.current=fe,await fe.generate()}catch(Ie){const fe=Ie instanceof Error?Ie.message:"Unknown error occurred";H(fe),j(!1)}},[ce]),se=O.useCallback(()=>{ee.current&&(ee.current.cancel(),ee.current=null),j(!1),z(0)},[]),ie=O.useCallback(()=>{if(!V)return;const ge=URL.createObjectURL(V),Ie=document.createElement("a");Ie.href=ge,Ie.download=`podcast-${Date.now()}.webm`,document.body.appendChild(Ie),Ie.click(),document.body.removeChild(Ie),URL.revokeObjectURL(ge)},[V]),Se=ge=>new Date(ge).toLocaleString(),re=["uploading","creating","processing"].includes(G),pe=VG.includes(n.region.toLowerCase()),ne=e&&pe&&!re&&a!==null&&(h==="OneHost"||h==="TwoHosts"&&v!==null);return e?g.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[g.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6",children:[g.jsx("h1",{className:"text-2xl font-bold",children:"Podcast Agent"}),g.jsx("p",{className:"text-purple-100 mt-1",children:"Generate AI podcasts from your content with natural conversational speech"})]}),g.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[g.jsx("div",{className:"flex-1 overflow-auto p-6",children:g.jsxs("div",{className:"space-y-6",children:[e&&!pe&&g.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("svg",{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-semibold text-amber-800",children:"Region Not Supported"}),g.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Podcast Agent is currently only available in the following regions:"}),g.jsxs("ul",{className:"text-sm text-amber-700 mt-2 list-disc list-inside",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"East US"})," (eastus)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"West Europe"})," (westeurope)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Southeast Asia"})," (southeastasia)"]})]}),g.jsxs("p",{className:"text-sm text-amber-700 mt-2",children:["Your current region: ",g.jsx("strong",{children:n.region}),". Please change your region in the sidebar settings."]})]})]})}),g.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[g.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Content Source"}),g.jsx(RG,{onContentChange:l,disabled:re})]}),g.jsxs("div",{className:"flex space-x-3",children:[g.jsx("button",{onClick:de,disabled:!ne,className:"flex-1 px-6 py-3 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium flex items-center justify-center space-x-2",children:re?g.jsxs(g.Fragment,{children:[g.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),g.jsx("span",{children:"Generating..."})]}):g.jsxs(g.Fragment,{children:[g.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),g.jsx("span",{children:"Generate Podcast"})]})}),re&&g.jsx("button",{onClick:$,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 font-medium",children:"Cancel"}),G!=="idle"&&!re&&g.jsx("button",{onClick:me,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 font-medium",children:"Reset"})]}),re&&g.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[g.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[g.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),g.jsx("span",{className:"text-sm font-medium text-blue-900",children:X.message})]}),g.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:g.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${X.step/X.totalSteps*100}%`}})}),g.jsxs("div",{className:"mt-2 text-xs text-blue-700",children:["Step ",X.step," of ",X.totalSteps]})]}),Y&&g.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-medium text-red-800",children:"Generation Failed"}),g.jsx("p",{className:"text-sm text-red-700 mt-1",children:Y})]})]})}),G==="completed"&&((ve=ce==null?void 0:ce.output)==null?void 0:ve.audioFileUrl)&&g.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[g.jsx("h3",{className:"font-medium text-green-900 mb-3",children:"Podcast Generated Successfully!"}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("audio",{controls:!0,className:"w-full",src:ce.output.audioFileUrl,children:"Your browser does not support the audio element."}),g.jsxs("div",{className:"flex gap-2",children:[g.jsxs("a",{href:ce.output.audioFileUrl,download:!0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm font-medium",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),g.jsx("span",{children:"Download Audio"})]}),g.jsxs("button",{onClick:le,disabled:D,className:"inline-flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),g.jsx("span",{children:"Generate Video"})]})]})]})]}),D&&g.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[g.jsxs("div",{className:"flex items-center justify-between mb-3",children:[g.jsx("h3",{className:"font-medium text-purple-900",children:"Generating Video..."}),g.jsx("button",{onClick:se,className:"text-sm text-purple-700 hover:text-purple-900 font-medium",children:"Cancel"})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("div",{className:"w-full bg-purple-200 rounded-full h-2",children:g.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${F*100}%`}})}),g.jsxs("div",{className:"text-xs text-purple-700",children:[Math.round(F*100),"% complete"]}),g.jsx("div",{className:"text-xs text-purple-600",children:"This may take as long as the audio duration. The video is being recorded in real-time."})]})]}),W&&g.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-medium text-red-800",children:"Video Generation Failed"}),g.jsx("p",{className:"text-sm text-red-700 mt-1",children:W})]})]})}),V&&!D&&g.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[g.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"Video Generated Successfully!"}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("video",{controls:!0,className:"w-full rounded",src:URL.createObjectURL(V),children:"Your browser does not support the video element."}),g.jsxs("button",{onClick:ie,className:"inline-flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm font-medium",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),g.jsx("span",{children:"Download Video (WebM)"})]}),g.jsxs("div",{className:"text-xs text-blue-600",children:["Video size: ",(V.size/1024/1024).toFixed(2)," MB"]})]})]})]})}),g.jsx("div",{className:"w-96 border-l border-gray-200 overflow-auto p-6",children:g.jsxs("div",{className:"space-y-6",children:[g.jsx("div",{children:g.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Podcast Configuration"})}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language"}),g.jsx("select",{value:c,onChange:ge=>u(ge.target.value),disabled:re,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:$G.map(ge=>g.jsx("option",{value:ge.code,children:ge.label},ge.code))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Host Type"}),g.jsx("div",{className:"space-y-2",children:HG.map(ge=>g.jsxs("label",{className:`flex items-start p-3 border rounded-md cursor-pointer transition-colors ${h===ge.value?"border-purple-600 bg-purple-50":"border-gray-200 hover:border-purple-300"} ${re?"opacity-50 cursor-not-allowed":""}`,children:[g.jsx("input",{type:"radio",value:ge.value,checked:h===ge.value,onChange:Ie=>m(Ie.target.value),disabled:re,className:"mt-1 h-4 w-4 text-purple-600 focus:ring-purple-500"}),g.jsxs("div",{className:"ml-3",children:[g.jsx("div",{className:"text-sm font-medium text-gray-900",children:ge.label}),g.jsx("div",{className:"text-xs text-gray-500",children:ge.description})]})]},ge.value))})]}),h==="TwoHosts"&&g.jsx(_G,{locale:c,selectedPair:v,onPairChange:C,disabled:re}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Style"}),g.jsx("select",{value:T,onChange:ge=>E(ge.target.value),disabled:re,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:ZG.map(ge=>g.jsx("option",{value:ge.value,children:ge.label},ge.value))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Length"}),g.jsx("select",{value:x,onChange:ge=>P(ge.target.value),disabled:re,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:qG.map(ge=>g.jsxs("option",{value:ge.value,children:[ge.label," ",ge.description]},ge.value))})]}),g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Additional Instructions",g.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(optional)"})]}),g.jsx("textarea",{value:b,onChange:ge=>I(ge.target.value),disabled:re,placeholder:"e.g., Focus on technical details, use casual tone, include examples...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed resize-none"}),g.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[b.length," / 1000 characters"]})]})]})})]}),g.jsxs("div",{className:"border-t border-gray-200",children:[g.jsxs("button",{onClick:()=>N(!M),className:"w-full px-6 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),g.jsx("span",{className:"font-medium text-gray-700",children:"Generation History"}),g.jsxs("span",{className:"text-xs text-gray-500",children:["(",t.length,")"]})]}),g.jsx("svg",{className:`w-5 h-5 text-gray-400 transform transition-transform ${M?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),M&&g.jsx("div",{className:"max-h-96 overflow-auto bg-white",children:t.length===0?g.jsxs("div",{className:"p-8 text-center text-gray-500",children:[g.jsx("p",{children:"No podcast generations yet"}),g.jsx("p",{className:"text-sm mt-1",children:"Your generated podcasts will appear here"})]}):g.jsxs("div",{children:[g.jsxs("div",{className:"px-6 py-3 border-b border-gray-200 flex justify-between items-center",children:[g.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t.length," generation",t.length!==1?"s":""]}),g.jsx("button",{onClick:s,className:"text-xs text-red-600 hover:text-red-800 font-medium",children:"Clear All"})]}),g.jsx("div",{className:"divide-y divide-gray-200",children:t.map(ge=>g.jsx("div",{className:"p-4 hover:bg-gray-50",children:g.jsxs("div",{className:"flex items-start justify-between",children:[g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[g.jsx("span",{className:"text-sm font-medium text-gray-900",children:ge.displayName}),g.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${ge.status==="Succeeded"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ge.status})]}),g.jsxs("div",{className:"text-xs text-gray-500 space-y-0.5",children:[g.jsxs("div",{children:[ge.locale,"  ",ge.hostType,"  ",ge.style,"  ",ge.length]}),ge.voiceName&&g.jsxs("div",{className:"truncate",children:["Voice: ",ge.voiceName]}),g.jsx("div",{children:Se(ge.timestamp)}),g.jsxs("div",{className:"truncate italic",children:['"',ge.contentPreview,'"']})]})]}),g.jsxs("div",{className:"ml-3 flex space-x-2",children:[ge.audioUrl&&g.jsx("button",{onClick:()=>Te(ge),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Play",children:g.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),g.jsx("button",{onClick:()=>i(ge.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",title:"Remove",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},ge.id))})]})})]})]}):g.jsx("div",{className:"p-8",children:g.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[g.jsx("h3",{className:"text-lg font-medium text-yellow-800 mb-2",children:"Configuration Required"}),g.jsx("p",{className:"text-yellow-700",children:"Please configure your Azure Speech API key and region in the settings panel to use Podcast Agent."})]})})}var JG={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let XG,QG;function eK(){return{geminiUrl:XG,vertexUrl:QG}}function tK(n,e,t,r){var i,s;if(!(n!=null&&n.baseUrl)){const o=eK();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:t:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ga{}function _e(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function A(n,e,t){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in n))if(Array.isArray(t))n[a]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[a])){const l=n[a];if(Array.isArray(t))for(let c=0;c<l.length;c++){const u=l[c];A(u,e.slice(s+1),t[c])}else for(const c of l)A(c,e.slice(s+1),t)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in n||(n[a]=[{}]);const l=n[a];A(l[0],e.slice(s+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const r=e[e.length-1],i=n[r];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[r]=t}function S(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let r=0;r<e.length;r++){if(typeof n!="object"||n===null)return t;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in n){const o=n[s];return Array.isArray(o)?o.map(a=>S(a,e.slice(r+1),t)):t}else return t}else n=n[i]}return n}catch(r){if(r instanceof TypeError)return t;throw r}}function nK(n,e){for(const[t,r]of Object.entries(e)){const i=t.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const c=s[l];c!=="*"&&!c.endsWith("[]")&&!c.endsWith("[0]")&&o.add(c)}bP(n,i,s,0,o)}}function bP(n,e,t,r,i){if(r>=e.length||typeof n!="object"||n===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=n;if(o in a&&Array.isArray(a[o]))for(const l of a[o])bP(l,e,t,r+1,i)}else if(s==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const o=n,a=Object.keys(o).filter(c=>!c.startsWith("_")&&!i.has(c)),l={};for(const c of a)l[c]=o[c];for(const[c,u]of Object.entries(l)){const h=[];for(const m of t.slice(r))m==="*"?h.push(c):h.push(m);A(o,h,u)}for(const c of a)delete o[c]}}else{const o=n;s in o&&bP(o[s],e,t,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hR(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rK(n){const e={},t=S(n,["operationName"]);t!=null&&A(e,["operationName"],t);const r=S(n,["resourceName"]);return r!=null&&A(e,["_url","resourceName"],r),e}function iK(n){const e={},t=S(n,["name"]);t!=null&&A(e,["name"],t);const r=S(n,["metadata"]);r!=null&&A(e,["metadata"],r);const i=S(n,["done"]);i!=null&&A(e,["done"],i);const s=S(n,["error"]);s!=null&&A(e,["error"],s);const o=S(n,["response","generateVideoResponse"]);return o!=null&&A(e,["response"],oK(o)),e}function sK(n){const e={},t=S(n,["name"]);t!=null&&A(e,["name"],t);const r=S(n,["metadata"]);r!=null&&A(e,["metadata"],r);const i=S(n,["done"]);i!=null&&A(e,["done"],i);const s=S(n,["error"]);s!=null&&A(e,["error"],s);const o=S(n,["response"]);return o!=null&&A(e,["response"],aK(o)),e}function oK(n){const e={},t=S(n,["generatedSamples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>lK(o))),A(e,["generatedVideos"],s)}const r=S(n,["raiMediaFilteredCount"]);r!=null&&A(e,["raiMediaFilteredCount"],r);const i=S(n,["raiMediaFilteredReasons"]);return i!=null&&A(e,["raiMediaFilteredReasons"],i),e}function aK(n){const e={},t=S(n,["videos"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>cK(o))),A(e,["generatedVideos"],s)}const r=S(n,["raiMediaFilteredCount"]);r!=null&&A(e,["raiMediaFilteredCount"],r);const i=S(n,["raiMediaFilteredReasons"]);return i!=null&&A(e,["raiMediaFilteredReasons"],i),e}function lK(n){const e={},t=S(n,["video"]);return t!=null&&A(e,["video"],mK(t)),e}function cK(n){const e={},t=S(n,["_self"]);return t!=null&&A(e,["video"],gK(t)),e}function uK(n){const e={},t=S(n,["operationName"]);return t!=null&&A(e,["_url","operationName"],t),e}function dK(n){const e={},t=S(n,["operationName"]);return t!=null&&A(e,["_url","operationName"],t),e}function hK(n){const e={},t=S(n,["name"]);t!=null&&A(e,["name"],t);const r=S(n,["metadata"]);r!=null&&A(e,["metadata"],r);const i=S(n,["done"]);i!=null&&A(e,["done"],i);const s=S(n,["error"]);s!=null&&A(e,["error"],s);const o=S(n,["response"]);return o!=null&&A(e,["response"],pK(o)),e}function pK(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["parent"]);r!=null&&A(e,["parent"],r);const i=S(n,["documentName"]);return i!=null&&A(e,["documentName"],i),e}function uU(n){const e={},t=S(n,["name"]);t!=null&&A(e,["name"],t);const r=S(n,["metadata"]);r!=null&&A(e,["metadata"],r);const i=S(n,["done"]);i!=null&&A(e,["done"],i);const s=S(n,["error"]);s!=null&&A(e,["error"],s);const o=S(n,["response"]);return o!=null&&A(e,["response"],fK(o)),e}function fK(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["parent"]);r!=null&&A(e,["parent"],r);const i=S(n,["documentName"]);return i!=null&&A(e,["documentName"],i),e}function mK(n){const e={},t=S(n,["uri"]);t!=null&&A(e,["uri"],t);const r=S(n,["encodedVideo"]);r!=null&&A(e,["videoBytes"],hR(r));const i=S(n,["encoding"]);return i!=null&&A(e,["mimeType"],i),e}function gK(n){const e={},t=S(n,["gcsUri"]);t!=null&&A(e,["uri"],t);const r=S(n,["bytesBase64Encoded"]);r!=null&&A(e,["videoBytes"],hR(r));const i=S(n,["mimeType"]);return i!=null&&A(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var k2;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(k2||(k2={}));var M2;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(M2||(M2={}));var N2;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(N2||(N2={}));var jl;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(jl||(jl={}));var L2;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(L2||(L2={}));var D2;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(D2||(D2={}));var O2;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(O2||(O2={}));var B2;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(B2||(B2={}));var F2;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(F2||(F2={}));var j2;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(j2||(j2={}));var U2;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(U2||(U2={}));var z2;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(z2||(z2={}));var W2;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(W2||(W2={}));var V2;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(V2||(V2={}));var $2;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})($2||($2={}));var H2;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(H2||(H2={}));var Z2;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Z2||(Z2={}));var q2;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(q2||(q2={}));var G2;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(G2||(G2={}));var K2;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(K2||(K2={}));var Y2;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Y2||(Y2={}));var qv;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(qv||(qv={}));var J2;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(J2||(J2={}));var X2;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(X2||(X2={}));var Q2;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Q2||(Q2={}));var PP;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(PP||(PP={}));var eO;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(eO||(eO={}));var tO;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(tO||(tO={}));var RP;(function(n){n.COLLECTION="COLLECTION"})(RP||(RP={}));var nO;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(nO||(nO={}));var rO;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(rO||(rO={}));var iO;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(iO||(iO={}));var sO;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(sO||(sO={}));var oO;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(oO||(oO={}));var aO;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(aO||(aO={}));var lO;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(lO||(lO={}));var cO;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(cO||(cO={}));var uO;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(uO||(uO={}));var dO;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(dO||(dO={}));var hO;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(hO||(hO={}));var pO;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(pO||(pO={}));var fO;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(fO||(fO={}));var mO;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(mO||(mO={}));var gO;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(gO||(gO={}));var vO;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(vO||(vO={}));var yO;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED",n.REGISTERED="REGISTERED"})(yO||(yO={}));var SO;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(SO||(SO={}));var CO;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(CO||(CO={}));var AO;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(AO||(AO={}));var TO;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.ACTIVITY_START="ACTIVITY_START",n.ACTIVITY_END="ACTIVITY_END"})(TO||(TO={}));var Fv;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Fv||(Fv={}));var jv;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(jv||(jv={}));var EO;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(EO||(EO={}));var xO;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(xO||(xO={}));var wO;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(wO||(wO={}));var bO;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(bO||(bO={}));var Wd;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Wd||(Wd={}));class IP{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class hv{get text(){var e,t,r,i,s,o,a,l;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",u=!1;const h=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[v,C]of Object.entries(m))v!=="text"&&v!=="thought"&&v!=="thoughtSignature"&&(C!==null||C!==void 0)&&h.push(v);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;u=!0,c+=m.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?c:void 0}get data(){var e,t,r,i,s,o,a,l;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const u=[];for(const h of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[m,v]of Object.entries(h))m!=="inlineData"&&(v!==null||v!==void 0)&&u.push(m);h.inlineData&&typeof h.inlineData.data=="string"&&(c+=atob(h.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,t,r,i,s,o,a,l;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(u=>u.functionCall).map(u=>u.functionCall).filter(u=>u!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,t,r,i,s,o,a,l,c;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((u==null?void 0:u.length)!==0)return(c=u==null?void 0:u[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,t,r,i,s,o,a,l,c;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((u==null?void 0:u.length)!==0)return(c=u==null?void 0:u[0])===null||c===void 0?void 0:c.output}}class PO{}class RO{}class vK{}class yK{}class SK{}class CK{}class IO{}class _O{}class kO{}class AK{}class RA{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new RA;let i;const s=e;return t?i=sK(s):i=iK(s),Object.assign(r,i),r}}class MO{}class NO{}class LO{}class DO{}class TK{}class EK{}class xK{}class pR{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new pR,s=hK(e);return Object.assign(r,s),r}}class wK{}class bK{}class PK{}class OO{}class RK{get text(){var e,t,r;let i="",s=!1;const o=[];for(const a of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(a))l!=="text"&&l!=="thought"&&c!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,t,r;let i="";const s=[];for(const o of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class IK{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class fR{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new fR,s=uU(e);return Object.assign(r,s),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function dU(n,e){const t=yt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function hU(n){return Array.isArray(n)?n.map(e=>IA(e)):[IA(n)]}function IA(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function pU(n){const e=IA(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function fU(n){const e=IA(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function BO(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function mU(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>BO(e)):[BO(n)]}function _P(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function FO(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function jO(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function ar(n){if(n==null)throw new Error("ContentUnion is required");return _P(n)?n:{role:"user",parts:mU(n)}}function mR(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=ar(t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=ar(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>ar(t)):[ar(e)]}function ji(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(FO(n)||jO(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ar(n)]}const e=[],t=[],r=_P(n[0]);for(const i of n){const s=_P(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(FO(i)||jO(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(i)}}return r||e.push({role:"user",parts:mU(t)}),e}function _K(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(r=>r!=="null");if(t.length===1)e.type=Object.values(jl).includes(t[0].toUpperCase())?t[0].toUpperCase():jl.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of t)e.anyOf.push({type:Object.values(jl).includes(r.toUpperCase())?r.toUpperCase():jl.TYPE_UNSPECIFIED})}}function Kd(n){const e={},t=["items"],r=["anyOf"],i=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=n.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,n=s[1]):s[1].type==="null"&&(e.nullable=!0,n=s[0])),n.type instanceof Array&&_K(n.type,e);for(const[o,a]of Object.entries(n))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(jl).includes(a.toUpperCase())?a.toUpperCase():jl.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=Kd(a);else if(r.includes(o)){const l=[];for(const c of a){if(c.type=="null"){e.nullable=!0;continue}l.push(Kd(c))}e[o]=l}else if(i.includes(o)){const l={};for(const[c,u]of Object.entries(a))l[c]=Kd(u);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function gR(n){return Kd(n)}function vR(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function yR(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Rp(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Kd(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Kd(e.response));return n}function Ip(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function kK(n,e,t,r=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:i?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function va(n,e){if(typeof e!="string")throw new Error("name must be a string");return kK(n,e,"cachedContents")}function gU(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function $l(n){return hR(n)}function MK(n){return n!=null&&typeof n=="object"&&"name"in n}function NK(n){return n!=null&&typeof n=="object"&&"video"in n}function LK(n){return n!=null&&typeof n=="object"&&"uri"in n}function vU(n){var e;let t;if(MK(n)&&(t=n.name),!(LK(n)&&(t=n.uri,t===void 0))&&!(NK(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const i=t.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${t}`);t=i[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function yU(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function SU(n){for(const e of["models","tunedModels","publisherModels"])if(DK(n,e))return n[e];return[]}function DK(n,e){return n!==null&&typeof n=="object"&&e in n}function OK(n,e={}){const t=n,r={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(r.responseJsonSchema=t.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function BK(n,e={}){const t=[],r=new Set;for(const i of n){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=OK(i,e);o.functionDeclarations&&t.push(...o.functionDeclarations)}return{functionDeclarations:t}}function CU(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const r=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,i=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function FK(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function AU(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const i=t.inlinedResponses;if(!Array.isArray(i)||i.length===0)return n;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function _p(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function TU(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jK(n){const e={},t=S(n,["responsesFile"]);t!=null&&A(e,["fileName"],t);const r=S(n,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>SY(o))),A(e,["inlinedResponses"],s)}const i=S(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),A(e,["inlinedEmbedContentResponses"],s)}return e}function UK(n){const e={},t=S(n,["predictionsFormat"]);t!=null&&A(e,["format"],t);const r=S(n,["gcsDestination","outputUriPrefix"]);r!=null&&A(e,["gcsUri"],r);const i=S(n,["bigqueryDestination","outputUri"]);return i!=null&&A(e,["bigqueryUri"],i),e}function zK(n){const e={},t=S(n,["format"]);t!=null&&A(e,["predictionsFormat"],t);const r=S(n,["gcsUri"]);r!=null&&A(e,["gcsDestination","outputUriPrefix"],r);const i=S(n,["bigqueryUri"]);if(i!=null&&A(e,["bigqueryDestination","outputUri"],i),S(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(S(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(S(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function hA(n){const e={},t=S(n,["name"]);t!=null&&A(e,["name"],t);const r=S(n,["metadata","displayName"]);r!=null&&A(e,["displayName"],r);const i=S(n,["metadata","state"]);i!=null&&A(e,["state"],TU(i));const s=S(n,["metadata","createTime"]);s!=null&&A(e,["createTime"],s);const o=S(n,["metadata","endTime"]);o!=null&&A(e,["endTime"],o);const a=S(n,["metadata","updateTime"]);a!=null&&A(e,["updateTime"],a);const l=S(n,["metadata","model"]);l!=null&&A(e,["model"],l);const c=S(n,["metadata","output"]);return c!=null&&A(e,["dest"],jK(AU(c))),e}function kP(n){const e={},t=S(n,["name"]);t!=null&&A(e,["name"],t);const r=S(n,["displayName"]);r!=null&&A(e,["displayName"],r);const i=S(n,["state"]);i!=null&&A(e,["state"],TU(i));const s=S(n,["error"]);s!=null&&A(e,["error"],s);const o=S(n,["createTime"]);o!=null&&A(e,["createTime"],o);const a=S(n,["startTime"]);a!=null&&A(e,["startTime"],a);const l=S(n,["endTime"]);l!=null&&A(e,["endTime"],l);const c=S(n,["updateTime"]);c!=null&&A(e,["updateTime"],c);const u=S(n,["model"]);u!=null&&A(e,["model"],u);const h=S(n,["inputConfig"]);h!=null&&A(e,["src"],WK(h));const m=S(n,["outputConfig"]);m!=null&&A(e,["dest"],UK(AU(m)));const v=S(n,["completionStats"]);return v!=null&&A(e,["completionStats"],v),e}function WK(n){const e={},t=S(n,["instancesFormat"]);t!=null&&A(e,["format"],t);const r=S(n,["gcsSource","uris"]);r!=null&&A(e,["gcsUri"],r);const i=S(n,["bigquerySource","inputUri"]);return i!=null&&A(e,["bigqueryUri"],i),e}function VK(n,e){const t={};if(S(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(S(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(S(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=S(e,["fileName"]);r!=null&&A(t,["fileName"],r);const i=S(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>yY(n,o))),A(t,["requests","requests"],s)}return t}function $K(n){const e={},t=S(n,["format"]);t!=null&&A(e,["instancesFormat"],t);const r=S(n,["gcsUri"]);r!=null&&A(e,["gcsSource","uris"],r);const i=S(n,["bigqueryUri"]);if(i!=null&&A(e,["bigquerySource","inputUri"],i),S(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(S(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function HK(n){const e={},t=S(n,["data"]);if(t!=null&&A(e,["data"],t),S(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function ZK(n,e){const t={},r=S(e,["name"]);return r!=null&&A(t,["_url","name"],_p(n,r)),t}function qK(n,e){const t={},r=S(e,["name"]);return r!=null&&A(t,["_url","name"],_p(n,r)),t}function GK(n){const e={},t=S(n,["content"]);t!=null&&A(e,["content"],t);const r=S(n,["citationMetadata"]);r!=null&&A(e,["citationMetadata"],KK(r));const i=S(n,["tokenCount"]);i!=null&&A(e,["tokenCount"],i);const s=S(n,["finishReason"]);s!=null&&A(e,["finishReason"],s);const o=S(n,["avgLogprobs"]);o!=null&&A(e,["avgLogprobs"],o);const a=S(n,["groundingMetadata"]);a!=null&&A(e,["groundingMetadata"],a);const l=S(n,["index"]);l!=null&&A(e,["index"],l);const c=S(n,["logprobsResult"]);c!=null&&A(e,["logprobsResult"],c);const u=S(n,["safetyRatings"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(v=>v)),A(e,["safetyRatings"],m)}const h=S(n,["urlContextMetadata"]);return h!=null&&A(e,["urlContextMetadata"],h),e}function KK(n){const e={},t=S(n,["citationSources"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),A(e,["citations"],r)}return e}function EU(n){const e={},t=S(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>bY(s))),A(e,["parts"],i)}const r=S(n,["role"]);return r!=null&&A(e,["role"],r),e}function YK(n,e){const t={},r=S(n,["displayName"]);if(e!==void 0&&r!=null&&A(e,["batch","displayName"],r),S(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function JK(n,e){const t={},r=S(n,["displayName"]);e!==void 0&&r!=null&&A(e,["displayName"],r);const i=S(n,["dest"]);return e!==void 0&&i!=null&&A(e,["outputConfig"],zK(FK(i))),t}function UO(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["src"]);i!=null&&A(t,["batch","inputConfig"],VK(n,CU(n,i)));const s=S(e,["config"]);return s!=null&&YK(s,t),t}function XK(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["model"],yt(n,r));const i=S(e,["src"]);i!=null&&A(t,["inputConfig"],$K(CU(n,i)));const s=S(e,["config"]);return s!=null&&JK(s,t),t}function QK(n,e){const t={},r=S(n,["displayName"]);return e!==void 0&&r!=null&&A(e,["batch","displayName"],r),t}function eY(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["src"]);i!=null&&A(t,["batch","inputConfig"],aY(n,i));const s=S(e,["config"]);return s!=null&&QK(s,t),t}function tY(n,e){const t={},r=S(e,["name"]);return r!=null&&A(t,["_url","name"],_p(n,r)),t}function nY(n,e){const t={},r=S(e,["name"]);return r!=null&&A(t,["_url","name"],_p(n,r)),t}function rY(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["name"]);r!=null&&A(e,["name"],r);const i=S(n,["done"]);i!=null&&A(e,["done"],i);const s=S(n,["error"]);return s!=null&&A(e,["error"],s),e}function iY(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["name"]);r!=null&&A(e,["name"],r);const i=S(n,["done"]);i!=null&&A(e,["done"],i);const s=S(n,["error"]);return s!=null&&A(e,["error"],s),e}function sY(n,e){const t={},r=S(e,["contents"]);if(r!=null){let s=mR(n,r);Array.isArray(s)&&(s=s.map(o=>o)),A(t,["requests[]","request","content"],s)}const i=S(e,["config"]);return i!=null&&(A(t,["_self"],oY(i,t)),nK(t,{"requests[].*":"requests[].request.*"})),t}function oY(n,e){const t={},r=S(n,["taskType"]);e!==void 0&&r!=null&&A(e,["requests[]","taskType"],r);const i=S(n,["title"]);e!==void 0&&i!=null&&A(e,["requests[]","title"],i);const s=S(n,["outputDimensionality"]);if(e!==void 0&&s!=null&&A(e,["requests[]","outputDimensionality"],s),S(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(S(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function aY(n,e){const t={},r=S(e,["fileName"]);r!=null&&A(t,["file_name"],r);const i=S(e,["inlinedRequests"]);return i!=null&&A(t,["requests"],sY(n,i)),t}function lY(n){const e={};if(S(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=S(n,["fileUri"]);t!=null&&A(e,["fileUri"],t);const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function cY(n){const e={},t=S(n,["id"]);t!=null&&A(e,["id"],t);const r=S(n,["args"]);r!=null&&A(e,["args"],r);const i=S(n,["name"]);if(i!=null&&A(e,["name"],i),S(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(S(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function uY(n){const e={},t=S(n,["allowedFunctionNames"]);t!=null&&A(e,["allowedFunctionNames"],t);const r=S(n,["mode"]);if(r!=null&&A(e,["mode"],r),S(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function dY(n,e,t){const r={},i=S(e,["systemInstruction"]);t!==void 0&&i!=null&&A(t,["systemInstruction"],EU(ar(i)));const s=S(e,["temperature"]);s!=null&&A(r,["temperature"],s);const o=S(e,["topP"]);o!=null&&A(r,["topP"],o);const a=S(e,["topK"]);a!=null&&A(r,["topK"],a);const l=S(e,["candidateCount"]);l!=null&&A(r,["candidateCount"],l);const c=S(e,["maxOutputTokens"]);c!=null&&A(r,["maxOutputTokens"],c);const u=S(e,["stopSequences"]);u!=null&&A(r,["stopSequences"],u);const h=S(e,["responseLogprobs"]);h!=null&&A(r,["responseLogprobs"],h);const m=S(e,["logprobs"]);m!=null&&A(r,["logprobs"],m);const v=S(e,["presencePenalty"]);v!=null&&A(r,["presencePenalty"],v);const C=S(e,["frequencyPenalty"]);C!=null&&A(r,["frequencyPenalty"],C);const T=S(e,["seed"]);T!=null&&A(r,["seed"],T);const E=S(e,["responseMimeType"]);E!=null&&A(r,["responseMimeType"],E);const x=S(e,["responseSchema"]);x!=null&&A(r,["responseSchema"],gR(x));const P=S(e,["responseJsonSchema"]);if(P!=null&&A(r,["responseJsonSchema"],P),S(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(S(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=S(e,["safetySettings"]);if(t!==void 0&&b!=null){let V=b;Array.isArray(V)&&(V=V.map(K=>PY(K))),A(t,["safetySettings"],V)}const I=S(e,["tools"]);if(t!==void 0&&I!=null){let V=Ip(I);Array.isArray(V)&&(V=V.map(K=>IY(Rp(K)))),A(t,["tools"],V)}const M=S(e,["toolConfig"]);if(t!==void 0&&M!=null&&A(t,["toolConfig"],RY(M)),S(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const N=S(e,["cachedContent"]);t!==void 0&&N!=null&&A(t,["cachedContent"],va(n,N));const D=S(e,["responseModalities"]);D!=null&&A(r,["responseModalities"],D);const j=S(e,["mediaResolution"]);j!=null&&A(r,["mediaResolution"],j);const F=S(e,["speechConfig"]);if(F!=null&&A(r,["speechConfig"],vR(F)),S(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const z=S(e,["thinkingConfig"]);z!=null&&A(r,["thinkingConfig"],z);const W=S(e,["imageConfig"]);W!=null&&A(r,["imageConfig"],vY(W));const H=S(e,["enableEnhancedCivicAnswers"]);if(H!=null&&A(r,["enableEnhancedCivicAnswers"],H),S(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function hY(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>GK(c))),A(e,["candidates"],l)}const i=S(n,["modelVersion"]);i!=null&&A(e,["modelVersion"],i);const s=S(n,["promptFeedback"]);s!=null&&A(e,["promptFeedback"],s);const o=S(n,["responseId"]);o!=null&&A(e,["responseId"],o);const a=S(n,["usageMetadata"]);return a!=null&&A(e,["usageMetadata"],a),e}function pY(n,e){const t={},r=S(e,["name"]);return r!=null&&A(t,["_url","name"],_p(n,r)),t}function fY(n,e){const t={},r=S(e,["name"]);return r!=null&&A(t,["_url","name"],_p(n,r)),t}function mY(n){const e={};if(S(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=S(n,["enableWidget"]);return t!=null&&A(e,["enableWidget"],t),e}function gY(n){const e={};if(S(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(S(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=S(n,["timeRangeFilter"]);return t!=null&&A(e,["timeRangeFilter"],t),e}function vY(n){const e={},t=S(n,["aspectRatio"]);t!=null&&A(e,["aspectRatio"],t);const r=S(n,["imageSize"]);if(r!=null&&A(e,["imageSize"],r),S(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(S(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(S(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function yY(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["request","model"],yt(n,r));const i=S(e,["contents"]);if(i!=null){let a=ji(i);Array.isArray(a)&&(a=a.map(l=>EU(l))),A(t,["request","contents"],a)}const s=S(e,["metadata"]);s!=null&&A(t,["metadata"],s);const o=S(e,["config"]);return o!=null&&A(t,["request","generationConfig"],dY(n,o,S(t,["request"],{}))),t}function SY(n){const e={},t=S(n,["response"]);t!=null&&A(e,["response"],hY(t));const r=S(n,["error"]);return r!=null&&A(e,["error"],r),e}function CY(n,e){const t={},r=S(n,["pageSize"]);e!==void 0&&r!=null&&A(e,["_query","pageSize"],r);const i=S(n,["pageToken"]);if(e!==void 0&&i!=null&&A(e,["_query","pageToken"],i),S(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function AY(n,e){const t={},r=S(n,["pageSize"]);e!==void 0&&r!=null&&A(e,["_query","pageSize"],r);const i=S(n,["pageToken"]);e!==void 0&&i!=null&&A(e,["_query","pageToken"],i);const s=S(n,["filter"]);return e!==void 0&&s!=null&&A(e,["_query","filter"],s),t}function TY(n){const e={},t=S(n,["config"]);return t!=null&&CY(t,e),e}function EY(n){const e={},t=S(n,["config"]);return t!=null&&AY(t,e),e}function xY(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["nextPageToken"]);r!=null&&A(e,["nextPageToken"],r);const i=S(n,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>hA(o))),A(e,["batchJobs"],s)}return e}function wY(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["nextPageToken"]);r!=null&&A(e,["nextPageToken"],r);const i=S(n,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>kP(o))),A(e,["batchJobs"],s)}return e}function bY(n){const e={},t=S(n,["mediaResolution"]);t!=null&&A(e,["mediaResolution"],t);const r=S(n,["codeExecutionResult"]);r!=null&&A(e,["codeExecutionResult"],r);const i=S(n,["executableCode"]);i!=null&&A(e,["executableCode"],i);const s=S(n,["fileData"]);s!=null&&A(e,["fileData"],lY(s));const o=S(n,["functionCall"]);o!=null&&A(e,["functionCall"],cY(o));const a=S(n,["functionResponse"]);a!=null&&A(e,["functionResponse"],a);const l=S(n,["inlineData"]);l!=null&&A(e,["inlineData"],HK(l));const c=S(n,["text"]);c!=null&&A(e,["text"],c);const u=S(n,["thought"]);u!=null&&A(e,["thought"],u);const h=S(n,["thoughtSignature"]);h!=null&&A(e,["thoughtSignature"],h);const m=S(n,["videoMetadata"]);return m!=null&&A(e,["videoMetadata"],m),e}function PY(n){const e={},t=S(n,["category"]);if(t!=null&&A(e,["category"],t),S(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=S(n,["threshold"]);return r!=null&&A(e,["threshold"],r),e}function RY(n){const e={},t=S(n,["retrievalConfig"]);t!=null&&A(e,["retrievalConfig"],t);const r=S(n,["functionCallingConfig"]);return r!=null&&A(e,["functionCallingConfig"],uY(r)),e}function IY(n){const e={};if(S(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=S(n,["computerUse"]);t!=null&&A(e,["computerUse"],t);const r=S(n,["fileSearch"]);r!=null&&A(e,["fileSearch"],r);const i=S(n,["codeExecution"]);if(i!=null&&A(e,["codeExecution"],i),S(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=S(n,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(h=>h)),A(e,["functionDeclarations"],u)}const o=S(n,["googleMaps"]);o!=null&&A(e,["googleMaps"],mY(o));const a=S(n,["googleSearch"]);a!=null&&A(e,["googleSearch"],gY(a));const l=S(n,["googleSearchRetrieval"]);l!=null&&A(e,["googleSearchRetrieval"],l);const c=S(n,["urlContext"]);return c!=null&&A(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ua;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(ua||(ua={}));class nd{constructor(e,t,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,i)}init(e,t,r){var i,s;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _Y extends ga{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new nd(ua.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=UO(this.apiClient,e),r=t._url,i=_e("{model}:batchGenerateContent",r),a=t.batch.inputConfig.requests,l=a.requests,c=[];for(const u of l){const h=Object.assign({},u);if(h.systemInstruction){const m=h.systemInstruction;delete h.systemInstruction;const v=h.request;v.systemInstruction=m,h.request=v}c.push(h)}return a.requests=c,delete t.config,delete t._url,delete t._query,{path:i,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const r=t?Object.assign({},t):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=XK(this.apiClient,e);return a=_e("batchPredictionJobs",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>kP(u))}else{const c=UO(this.apiClient,e);return a=_e("{model}:batchGenerateContent",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>hA(u))}}async createEmbeddingsInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=eY(this.apiClient,e);return s=_e("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>hA(l))}}async get(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=fY(this.apiClient,e);return a=_e("batchPredictionJobs/{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>kP(u))}else{const c=pY(this.apiClient,e);return a=_e("batches/{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>hA(u))}}async cancel(e){var t,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=qK(this.apiClient,e);o=_e("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=ZK(this.apiClient,e);o=_e("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=EY(e);return a=_e("batchPredictionJobs",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=wY(u),m=new OO;return Object.assign(m,h),m})}else{const c=TY(e);return a=_e("batches",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=xY(u),m=new OO;return Object.assign(m,h),m})}}async delete(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=nY(this.apiClient,e);return a=_e("batchPredictionJobs/{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>iY(u))}else{const c=tY(this.apiClient,e);return a=_e("batches/{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>rY(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kY(n){const e={},t=S(n,["data"]);if(t!=null&&A(e,["data"],t),S(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function zO(n){const e={},t=S(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>eJ(s))),A(e,["parts"],i)}const r=S(n,["role"]);return r!=null&&A(e,["role"],r),e}function MY(n,e){const t={},r=S(n,["ttl"]);e!==void 0&&r!=null&&A(e,["ttl"],r);const i=S(n,["expireTime"]);e!==void 0&&i!=null&&A(e,["expireTime"],i);const s=S(n,["displayName"]);e!==void 0&&s!=null&&A(e,["displayName"],s);const o=S(n,["contents"]);if(e!==void 0&&o!=null){let u=ji(o);Array.isArray(u)&&(u=u.map(h=>zO(h))),A(e,["contents"],u)}const a=S(n,["systemInstruction"]);e!==void 0&&a!=null&&A(e,["systemInstruction"],zO(ar(a)));const l=S(n,["tools"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(h=>nJ(h))),A(e,["tools"],u)}const c=S(n,["toolConfig"]);if(e!==void 0&&c!=null&&A(e,["toolConfig"],tJ(c)),S(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function NY(n,e){const t={},r=S(n,["ttl"]);e!==void 0&&r!=null&&A(e,["ttl"],r);const i=S(n,["expireTime"]);e!==void 0&&i!=null&&A(e,["expireTime"],i);const s=S(n,["displayName"]);e!==void 0&&s!=null&&A(e,["displayName"],s);const o=S(n,["contents"]);if(e!==void 0&&o!=null){let h=ji(o);Array.isArray(h)&&(h=h.map(m=>m)),A(e,["contents"],h)}const a=S(n,["systemInstruction"]);e!==void 0&&a!=null&&A(e,["systemInstruction"],ar(a));const l=S(n,["tools"]);if(e!==void 0&&l!=null){let h=l;Array.isArray(h)&&(h=h.map(m=>rJ(m))),A(e,["tools"],h)}const c=S(n,["toolConfig"]);e!==void 0&&c!=null&&A(e,["toolConfig"],c);const u=S(n,["kmsKeyName"]);return e!==void 0&&u!=null&&A(e,["encryption_spec","kmsKeyName"],u),t}function LY(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["model"],dU(n,r));const i=S(e,["config"]);return i!=null&&MY(i,t),t}function DY(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["model"],dU(n,r));const i=S(e,["config"]);return i!=null&&NY(i,t),t}function OY(n,e){const t={},r=S(e,["name"]);return r!=null&&A(t,["_url","name"],va(n,r)),t}function BY(n,e){const t={},r=S(e,["name"]);return r!=null&&A(t,["_url","name"],va(n,r)),t}function FY(n){const e={},t=S(n,["sdkHttpResponse"]);return t!=null&&A(e,["sdkHttpResponse"],t),e}function jY(n){const e={},t=S(n,["sdkHttpResponse"]);return t!=null&&A(e,["sdkHttpResponse"],t),e}function UY(n){const e={};if(S(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=S(n,["fileUri"]);t!=null&&A(e,["fileUri"],t);const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function zY(n){const e={},t=S(n,["id"]);t!=null&&A(e,["id"],t);const r=S(n,["args"]);r!=null&&A(e,["args"],r);const i=S(n,["name"]);if(i!=null&&A(e,["name"],i),S(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(S(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function WY(n){const e={},t=S(n,["allowedFunctionNames"]);t!=null&&A(e,["allowedFunctionNames"],t);const r=S(n,["mode"]);if(r!=null&&A(e,["mode"],r),S(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function VY(n){const e={},t=S(n,["description"]);t!=null&&A(e,["description"],t);const r=S(n,["name"]);r!=null&&A(e,["name"],r);const i=S(n,["parameters"]);i!=null&&A(e,["parameters"],i);const s=S(n,["parametersJsonSchema"]);s!=null&&A(e,["parametersJsonSchema"],s);const o=S(n,["response"]);o!=null&&A(e,["response"],o);const a=S(n,["responseJsonSchema"]);if(a!=null&&A(e,["responseJsonSchema"],a),S(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function $Y(n,e){const t={},r=S(e,["name"]);return r!=null&&A(t,["_url","name"],va(n,r)),t}function HY(n,e){const t={},r=S(e,["name"]);return r!=null&&A(t,["_url","name"],va(n,r)),t}function ZY(n){const e={};if(S(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=S(n,["enableWidget"]);return t!=null&&A(e,["enableWidget"],t),e}function qY(n){const e={};if(S(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(S(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=S(n,["timeRangeFilter"]);return t!=null&&A(e,["timeRangeFilter"],t),e}function GY(n,e){const t={},r=S(n,["pageSize"]);e!==void 0&&r!=null&&A(e,["_query","pageSize"],r);const i=S(n,["pageToken"]);return e!==void 0&&i!=null&&A(e,["_query","pageToken"],i),t}function KY(n,e){const t={},r=S(n,["pageSize"]);e!==void 0&&r!=null&&A(e,["_query","pageSize"],r);const i=S(n,["pageToken"]);return e!==void 0&&i!=null&&A(e,["_query","pageToken"],i),t}function YY(n){const e={},t=S(n,["config"]);return t!=null&&GY(t,e),e}function JY(n){const e={},t=S(n,["config"]);return t!=null&&KY(t,e),e}function XY(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["nextPageToken"]);r!=null&&A(e,["nextPageToken"],r);const i=S(n,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),A(e,["cachedContents"],s)}return e}function QY(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["nextPageToken"]);r!=null&&A(e,["nextPageToken"],r);const i=S(n,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),A(e,["cachedContents"],s)}return e}function eJ(n){const e={},t=S(n,["mediaResolution"]);t!=null&&A(e,["mediaResolution"],t);const r=S(n,["codeExecutionResult"]);r!=null&&A(e,["codeExecutionResult"],r);const i=S(n,["executableCode"]);i!=null&&A(e,["executableCode"],i);const s=S(n,["fileData"]);s!=null&&A(e,["fileData"],UY(s));const o=S(n,["functionCall"]);o!=null&&A(e,["functionCall"],zY(o));const a=S(n,["functionResponse"]);a!=null&&A(e,["functionResponse"],a);const l=S(n,["inlineData"]);l!=null&&A(e,["inlineData"],kY(l));const c=S(n,["text"]);c!=null&&A(e,["text"],c);const u=S(n,["thought"]);u!=null&&A(e,["thought"],u);const h=S(n,["thoughtSignature"]);h!=null&&A(e,["thoughtSignature"],h);const m=S(n,["videoMetadata"]);return m!=null&&A(e,["videoMetadata"],m),e}function tJ(n){const e={},t=S(n,["retrievalConfig"]);t!=null&&A(e,["retrievalConfig"],t);const r=S(n,["functionCallingConfig"]);return r!=null&&A(e,["functionCallingConfig"],WY(r)),e}function nJ(n){const e={};if(S(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=S(n,["computerUse"]);t!=null&&A(e,["computerUse"],t);const r=S(n,["fileSearch"]);r!=null&&A(e,["fileSearch"],r);const i=S(n,["codeExecution"]);if(i!=null&&A(e,["codeExecution"],i),S(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=S(n,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(h=>h)),A(e,["functionDeclarations"],u)}const o=S(n,["googleMaps"]);o!=null&&A(e,["googleMaps"],ZY(o));const a=S(n,["googleSearch"]);a!=null&&A(e,["googleSearch"],qY(a));const l=S(n,["googleSearchRetrieval"]);l!=null&&A(e,["googleSearchRetrieval"],l);const c=S(n,["urlContext"]);return c!=null&&A(e,["urlContext"],c),e}function rJ(n){const e={},t=S(n,["retrieval"]);t!=null&&A(e,["retrieval"],t);const r=S(n,["computerUse"]);if(r!=null&&A(e,["computerUse"],r),S(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=S(n,["codeExecution"]);i!=null&&A(e,["codeExecution"],i);const s=S(n,["enterpriseWebSearch"]);s!=null&&A(e,["enterpriseWebSearch"],s);const o=S(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(m=>VY(m))),A(e,["functionDeclarations"],h)}const a=S(n,["googleMaps"]);a!=null&&A(e,["googleMaps"],a);const l=S(n,["googleSearch"]);l!=null&&A(e,["googleSearch"],l);const c=S(n,["googleSearchRetrieval"]);c!=null&&A(e,["googleSearchRetrieval"],c);const u=S(n,["urlContext"]);return u!=null&&A(e,["urlContext"],u),e}function iJ(n,e){const t={},r=S(n,["ttl"]);e!==void 0&&r!=null&&A(e,["ttl"],r);const i=S(n,["expireTime"]);return e!==void 0&&i!=null&&A(e,["expireTime"],i),t}function sJ(n,e){const t={},r=S(n,["ttl"]);e!==void 0&&r!=null&&A(e,["ttl"],r);const i=S(n,["expireTime"]);return e!==void 0&&i!=null&&A(e,["expireTime"],i),t}function oJ(n,e){const t={},r=S(e,["name"]);r!=null&&A(t,["_url","name"],va(n,r));const i=S(e,["config"]);return i!=null&&iJ(i,t),t}function aJ(n,e){const t={},r=S(e,["name"]);r!=null&&A(t,["_url","name"],va(n,r));const i=S(e,["config"]);return i!=null&&sJ(i,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lJ extends ga{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new nd(ua.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=DY(this.apiClient,e);return a=_e("cachedContents",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>u)}else{const c=LY(this.apiClient,e);return a=_e("cachedContents",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async get(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=HY(this.apiClient,e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>u)}else{const c=$Y(this.apiClient,e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async delete(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=BY(this.apiClient,e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=jY(u),m=new LO;return Object.assign(m,h),m})}else{const c=OY(this.apiClient,e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=FY(u),m=new LO;return Object.assign(m,h),m})}}async update(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=aJ(this.apiClient,e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>u)}else{const c=oJ(this.apiClient,e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async listInternal(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=JY(e);return a=_e("cachedContents",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=QY(u),m=new DO;return Object.assign(m,h),m})}else{const c=YY(e);return a=_e("cachedContents",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=XY(u),m=new DO;return Object.assign(m,h),m})}}}function _A(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function WO(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ke(n){return this instanceof Ke?(this.v=n,this):new Ke(n)}function fs(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(C){return Promise.resolve(C).then(v,h)}}function a(v,C){r[v]&&(i[v]=function(T){return new Promise(function(E,x){s.push([v,T,E,x])>1||l(v,T)})},C&&(i[v]=C(i[v])))}function l(v,C){try{c(r[v](C))}catch(T){m(s[0][3],T)}}function c(v){v.value instanceof Ke?Promise.resolve(v.value.v).then(u,h):m(s[0][2],v)}function u(v){l("next",v)}function h(v){l("throw",v)}function m(v,C){v(C),s.shift(),s.length&&l(s[0][0],s[0][1])}}function ms(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof WO=="function"?WO(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){o=n[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cJ(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:xU(t)}function xU(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function uJ(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function VO(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0;for(;r<t;)if(n[r].role==="user")e.push(n[r]),r++;else{const i=[];let s=!0;for(;r<t&&n[r].role==="model";)i.push(n[r]),s&&!xU(n[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class dJ{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new hJ(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class hJ{constructor(e,t,r,i={},s=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),uJ(s)}async sendMessage(e){var t;await this.sendPromise;const r=ar(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,c=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,u=l.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let m=[];u!=null&&(m=(a=u.slice(h))!==null&&a!==void 0?a:[]);const v=c?[c]:[];this.recordHistory(r,v,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;const r=ar(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const t=e?VO(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return fs(this,arguments,function*(){var i,s,o,a,l,c;const u=[];try{for(var h=!0,m=ms(e),v;v=yield Ke(m.next()),i=v.done,!i;h=!0){a=v.value,h=!1;const C=a;if(cJ(C)){const T=(c=(l=C.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content;T!==void 0&&u.push(T)}yield yield Ke(C)}}catch(C){s={error:C}}finally{try{!h&&!i&&(o=m.return)&&(yield Ke(o.call(m)))}finally{if(s)throw s.error}}this.recordHistory(t,u)})}recordHistory(e,t,r){let i=[];t.length>0&&t.every(s=>s.role!==void 0)?i=t:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...VO(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gv extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Gv.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pJ(n){const e={},t=S(n,["file"]);return t!=null&&A(e,["file"],t),e}function fJ(n){const e={},t=S(n,["sdkHttpResponse"]);return t!=null&&A(e,["sdkHttpResponse"],t),e}function mJ(n){const e={},t=S(n,["name"]);return t!=null&&A(e,["_url","file"],vU(t)),e}function gJ(n){const e={},t=S(n,["sdkHttpResponse"]);return t!=null&&A(e,["sdkHttpResponse"],t),e}function vJ(n){const e={},t=S(n,["name"]);return t!=null&&A(e,["_url","file"],vU(t)),e}function yJ(n,e){const t={},r=S(n,["pageSize"]);e!==void 0&&r!=null&&A(e,["_query","pageSize"],r);const i=S(n,["pageToken"]);return e!==void 0&&i!=null&&A(e,["_query","pageToken"],i),t}function SJ(n){const e={},t=S(n,["config"]);return t!=null&&yJ(t,e),e}function CJ(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["nextPageToken"]);r!=null&&A(e,["nextPageToken"],r);const i=S(n,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),A(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AJ extends ga{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new nd(ua.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=SJ(e);return s=_e("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),i.then(l=>{const c=CJ(l),u=new wK;return Object.assign(u,c),u})}}async createInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=pJ(e);return s=_e("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const c=fJ(l),u=new bK;return Object.assign(u,c),u})}}async get(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=vJ(e);return s=_e("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=mJ(e);return s=_e("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),i.then(l=>{const c=gJ(l),u=new PK;return Object.assign(u,c),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pA(n){const e={},t=S(n,["data"]);if(t!=null&&A(e,["data"],t),S(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function TJ(n){const e={},t=S(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>FJ(s))),A(e,["parts"],i)}const r=S(n,["role"]);return r!=null&&A(e,["role"],r),e}function EJ(n){const e={};if(S(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=S(n,["fileUri"]);t!=null&&A(e,["fileUri"],t);const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function xJ(n){const e={},t=S(n,["id"]);t!=null&&A(e,["id"],t);const r=S(n,["args"]);r!=null&&A(e,["args"],r);const i=S(n,["name"]);if(i!=null&&A(e,["name"],i),S(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(S(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function wJ(n){const e={},t=S(n,["description"]);t!=null&&A(e,["description"],t);const r=S(n,["name"]);r!=null&&A(e,["name"],r);const i=S(n,["parameters"]);i!=null&&A(e,["parameters"],i);const s=S(n,["parametersJsonSchema"]);s!=null&&A(e,["parametersJsonSchema"],s);const o=S(n,["response"]);o!=null&&A(e,["response"],o);const a=S(n,["responseJsonSchema"]);if(a!=null&&A(e,["responseJsonSchema"],a),S(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function bJ(n){const e={},t=S(n,["modelSelectionConfig"]);t!=null&&A(e,["modelConfig"],t);const r=S(n,["responseJsonSchema"]);r!=null&&A(e,["responseJsonSchema"],r);const i=S(n,["audioTimestamp"]);i!=null&&A(e,["audioTimestamp"],i);const s=S(n,["candidateCount"]);s!=null&&A(e,["candidateCount"],s);const o=S(n,["enableAffectiveDialog"]);o!=null&&A(e,["enableAffectiveDialog"],o);const a=S(n,["frequencyPenalty"]);a!=null&&A(e,["frequencyPenalty"],a);const l=S(n,["logprobs"]);l!=null&&A(e,["logprobs"],l);const c=S(n,["maxOutputTokens"]);c!=null&&A(e,["maxOutputTokens"],c);const u=S(n,["mediaResolution"]);u!=null&&A(e,["mediaResolution"],u);const h=S(n,["presencePenalty"]);h!=null&&A(e,["presencePenalty"],h);const m=S(n,["responseLogprobs"]);m!=null&&A(e,["responseLogprobs"],m);const v=S(n,["responseMimeType"]);v!=null&&A(e,["responseMimeType"],v);const C=S(n,["responseModalities"]);C!=null&&A(e,["responseModalities"],C);const T=S(n,["responseSchema"]);T!=null&&A(e,["responseSchema"],T);const E=S(n,["routingConfig"]);E!=null&&A(e,["routingConfig"],E);const x=S(n,["seed"]);x!=null&&A(e,["seed"],x);const P=S(n,["speechConfig"]);P!=null&&A(e,["speechConfig"],P);const b=S(n,["stopSequences"]);b!=null&&A(e,["stopSequences"],b);const I=S(n,["temperature"]);I!=null&&A(e,["temperature"],I);const M=S(n,["thinkingConfig"]);M!=null&&A(e,["thinkingConfig"],M);const N=S(n,["topK"]);N!=null&&A(e,["topK"],N);const D=S(n,["topP"]);if(D!=null&&A(e,["topP"],D),S(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function PJ(n){const e={};if(S(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=S(n,["enableWidget"]);return t!=null&&A(e,["enableWidget"],t),e}function RJ(n){const e={};if(S(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(S(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=S(n,["timeRangeFilter"]);return t!=null&&A(e,["timeRangeFilter"],t),e}function IJ(n,e){const t={},r=S(n,["generationConfig"]);e!==void 0&&r!=null&&A(e,["setup","generationConfig"],r);const i=S(n,["responseModalities"]);e!==void 0&&i!=null&&A(e,["setup","generationConfig","responseModalities"],i);const s=S(n,["temperature"]);e!==void 0&&s!=null&&A(e,["setup","generationConfig","temperature"],s);const o=S(n,["topP"]);e!==void 0&&o!=null&&A(e,["setup","generationConfig","topP"],o);const a=S(n,["topK"]);e!==void 0&&a!=null&&A(e,["setup","generationConfig","topK"],a);const l=S(n,["maxOutputTokens"]);e!==void 0&&l!=null&&A(e,["setup","generationConfig","maxOutputTokens"],l);const c=S(n,["mediaResolution"]);e!==void 0&&c!=null&&A(e,["setup","generationConfig","mediaResolution"],c);const u=S(n,["seed"]);e!==void 0&&u!=null&&A(e,["setup","generationConfig","seed"],u);const h=S(n,["speechConfig"]);e!==void 0&&h!=null&&A(e,["setup","generationConfig","speechConfig"],yR(h));const m=S(n,["thinkingConfig"]);e!==void 0&&m!=null&&A(e,["setup","generationConfig","thinkingConfig"],m);const v=S(n,["enableAffectiveDialog"]);e!==void 0&&v!=null&&A(e,["setup","generationConfig","enableAffectiveDialog"],v);const C=S(n,["systemInstruction"]);e!==void 0&&C!=null&&A(e,["setup","systemInstruction"],TJ(ar(C)));const T=S(n,["tools"]);if(e!==void 0&&T!=null){let N=Ip(T);Array.isArray(N)&&(N=N.map(D=>UJ(Rp(D)))),A(e,["setup","tools"],N)}const E=S(n,["sessionResumption"]);e!==void 0&&E!=null&&A(e,["setup","sessionResumption"],jJ(E));const x=S(n,["inputAudioTranscription"]);e!==void 0&&x!=null&&A(e,["setup","inputAudioTranscription"],x);const P=S(n,["outputAudioTranscription"]);e!==void 0&&P!=null&&A(e,["setup","outputAudioTranscription"],P);const b=S(n,["realtimeInputConfig"]);e!==void 0&&b!=null&&A(e,["setup","realtimeInputConfig"],b);const I=S(n,["contextWindowCompression"]);e!==void 0&&I!=null&&A(e,["setup","contextWindowCompression"],I);const M=S(n,["proactivity"]);if(e!==void 0&&M!=null&&A(e,["setup","proactivity"],M),S(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function _J(n,e){const t={},r=S(n,["generationConfig"]);e!==void 0&&r!=null&&A(e,["setup","generationConfig"],bJ(r));const i=S(n,["responseModalities"]);e!==void 0&&i!=null&&A(e,["setup","generationConfig","responseModalities"],i);const s=S(n,["temperature"]);e!==void 0&&s!=null&&A(e,["setup","generationConfig","temperature"],s);const o=S(n,["topP"]);e!==void 0&&o!=null&&A(e,["setup","generationConfig","topP"],o);const a=S(n,["topK"]);e!==void 0&&a!=null&&A(e,["setup","generationConfig","topK"],a);const l=S(n,["maxOutputTokens"]);e!==void 0&&l!=null&&A(e,["setup","generationConfig","maxOutputTokens"],l);const c=S(n,["mediaResolution"]);e!==void 0&&c!=null&&A(e,["setup","generationConfig","mediaResolution"],c);const u=S(n,["seed"]);e!==void 0&&u!=null&&A(e,["setup","generationConfig","seed"],u);const h=S(n,["speechConfig"]);e!==void 0&&h!=null&&A(e,["setup","generationConfig","speechConfig"],yR(h));const m=S(n,["thinkingConfig"]);e!==void 0&&m!=null&&A(e,["setup","generationConfig","thinkingConfig"],m);const v=S(n,["enableAffectiveDialog"]);e!==void 0&&v!=null&&A(e,["setup","generationConfig","enableAffectiveDialog"],v);const C=S(n,["systemInstruction"]);e!==void 0&&C!=null&&A(e,["setup","systemInstruction"],ar(C));const T=S(n,["tools"]);if(e!==void 0&&T!=null){let D=Ip(T);Array.isArray(D)&&(D=D.map(j=>zJ(Rp(j)))),A(e,["setup","tools"],D)}const E=S(n,["sessionResumption"]);e!==void 0&&E!=null&&A(e,["setup","sessionResumption"],E);const x=S(n,["inputAudioTranscription"]);e!==void 0&&x!=null&&A(e,["setup","inputAudioTranscription"],x);const P=S(n,["outputAudioTranscription"]);e!==void 0&&P!=null&&A(e,["setup","outputAudioTranscription"],P);const b=S(n,["realtimeInputConfig"]);e!==void 0&&b!=null&&A(e,["setup","realtimeInputConfig"],b);const I=S(n,["contextWindowCompression"]);e!==void 0&&I!=null&&A(e,["setup","contextWindowCompression"],I);const M=S(n,["proactivity"]);e!==void 0&&M!=null&&A(e,["setup","proactivity"],M);const N=S(n,["explicitVadSignal"]);return e!==void 0&&N!=null&&A(e,["setup","explicitVadSignal"],N),t}function kJ(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["setup","model"],yt(n,r));const i=S(e,["config"]);return i!=null&&A(t,["config"],IJ(i,t)),t}function MJ(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["setup","model"],yt(n,r));const i=S(e,["config"]);return i!=null&&A(t,["config"],_J(i,t)),t}function NJ(n){const e={},t=S(n,["musicGenerationConfig"]);return t!=null&&A(e,["musicGenerationConfig"],t),e}function LJ(n){const e={},t=S(n,["weightedPrompts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),A(e,["weightedPrompts"],r)}return e}function DJ(n){const e={},t=S(n,["media"]);if(t!=null){let c=hU(t);Array.isArray(c)&&(c=c.map(u=>pA(u))),A(e,["mediaChunks"],c)}const r=S(n,["audio"]);r!=null&&A(e,["audio"],pA(fU(r)));const i=S(n,["audioStreamEnd"]);i!=null&&A(e,["audioStreamEnd"],i);const s=S(n,["video"]);s!=null&&A(e,["video"],pA(pU(s)));const o=S(n,["text"]);o!=null&&A(e,["text"],o);const a=S(n,["activityStart"]);a!=null&&A(e,["activityStart"],a);const l=S(n,["activityEnd"]);return l!=null&&A(e,["activityEnd"],l),e}function OJ(n){const e={},t=S(n,["media"]);if(t!=null){let c=hU(t);Array.isArray(c)&&(c=c.map(u=>u)),A(e,["mediaChunks"],c)}const r=S(n,["audio"]);r!=null&&A(e,["audio"],fU(r));const i=S(n,["audioStreamEnd"]);i!=null&&A(e,["audioStreamEnd"],i);const s=S(n,["video"]);s!=null&&A(e,["video"],pU(s));const o=S(n,["text"]);o!=null&&A(e,["text"],o);const a=S(n,["activityStart"]);a!=null&&A(e,["activityStart"],a);const l=S(n,["activityEnd"]);return l!=null&&A(e,["activityEnd"],l),e}function BJ(n){const e={},t=S(n,["setupComplete"]);t!=null&&A(e,["setupComplete"],t);const r=S(n,["serverContent"]);r!=null&&A(e,["serverContent"],r);const i=S(n,["toolCall"]);i!=null&&A(e,["toolCall"],i);const s=S(n,["toolCallCancellation"]);s!=null&&A(e,["toolCallCancellation"],s);const o=S(n,["usageMetadata"]);o!=null&&A(e,["usageMetadata"],WJ(o));const a=S(n,["goAway"]);a!=null&&A(e,["goAway"],a);const l=S(n,["sessionResumptionUpdate"]);l!=null&&A(e,["sessionResumptionUpdate"],l);const c=S(n,["voiceActivityDetectionSignal"]);c!=null&&A(e,["voiceActivityDetectionSignal"],c);const u=S(n,["voiceActivity"]);return u!=null&&A(e,["voiceActivity"],VJ(u)),e}function FJ(n){const e={},t=S(n,["mediaResolution"]);t!=null&&A(e,["mediaResolution"],t);const r=S(n,["codeExecutionResult"]);r!=null&&A(e,["codeExecutionResult"],r);const i=S(n,["executableCode"]);i!=null&&A(e,["executableCode"],i);const s=S(n,["fileData"]);s!=null&&A(e,["fileData"],EJ(s));const o=S(n,["functionCall"]);o!=null&&A(e,["functionCall"],xJ(o));const a=S(n,["functionResponse"]);a!=null&&A(e,["functionResponse"],a);const l=S(n,["inlineData"]);l!=null&&A(e,["inlineData"],pA(l));const c=S(n,["text"]);c!=null&&A(e,["text"],c);const u=S(n,["thought"]);u!=null&&A(e,["thought"],u);const h=S(n,["thoughtSignature"]);h!=null&&A(e,["thoughtSignature"],h);const m=S(n,["videoMetadata"]);return m!=null&&A(e,["videoMetadata"],m),e}function jJ(n){const e={},t=S(n,["handle"]);if(t!=null&&A(e,["handle"],t),S(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function UJ(n){const e={};if(S(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=S(n,["computerUse"]);t!=null&&A(e,["computerUse"],t);const r=S(n,["fileSearch"]);r!=null&&A(e,["fileSearch"],r);const i=S(n,["codeExecution"]);if(i!=null&&A(e,["codeExecution"],i),S(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=S(n,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(h=>h)),A(e,["functionDeclarations"],u)}const o=S(n,["googleMaps"]);o!=null&&A(e,["googleMaps"],PJ(o));const a=S(n,["googleSearch"]);a!=null&&A(e,["googleSearch"],RJ(a));const l=S(n,["googleSearchRetrieval"]);l!=null&&A(e,["googleSearchRetrieval"],l);const c=S(n,["urlContext"]);return c!=null&&A(e,["urlContext"],c),e}function zJ(n){const e={},t=S(n,["retrieval"]);t!=null&&A(e,["retrieval"],t);const r=S(n,["computerUse"]);if(r!=null&&A(e,["computerUse"],r),S(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=S(n,["codeExecution"]);i!=null&&A(e,["codeExecution"],i);const s=S(n,["enterpriseWebSearch"]);s!=null&&A(e,["enterpriseWebSearch"],s);const o=S(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(m=>wJ(m))),A(e,["functionDeclarations"],h)}const a=S(n,["googleMaps"]);a!=null&&A(e,["googleMaps"],a);const l=S(n,["googleSearch"]);l!=null&&A(e,["googleSearch"],l);const c=S(n,["googleSearchRetrieval"]);c!=null&&A(e,["googleSearchRetrieval"],c);const u=S(n,["urlContext"]);return u!=null&&A(e,["urlContext"],u),e}function WJ(n){const e={},t=S(n,["promptTokenCount"]);t!=null&&A(e,["promptTokenCount"],t);const r=S(n,["cachedContentTokenCount"]);r!=null&&A(e,["cachedContentTokenCount"],r);const i=S(n,["candidatesTokenCount"]);i!=null&&A(e,["responseTokenCount"],i);const s=S(n,["toolUsePromptTokenCount"]);s!=null&&A(e,["toolUsePromptTokenCount"],s);const o=S(n,["thoughtsTokenCount"]);o!=null&&A(e,["thoughtsTokenCount"],o);const a=S(n,["totalTokenCount"]);a!=null&&A(e,["totalTokenCount"],a);const l=S(n,["promptTokensDetails"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(C=>C)),A(e,["promptTokensDetails"],v)}const c=S(n,["cacheTokensDetails"]);if(c!=null){let v=c;Array.isArray(v)&&(v=v.map(C=>C)),A(e,["cacheTokensDetails"],v)}const u=S(n,["candidatesTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(C=>C)),A(e,["responseTokensDetails"],v)}const h=S(n,["toolUsePromptTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(C=>C)),A(e,["toolUsePromptTokensDetails"],v)}const m=S(n,["trafficType"]);return m!=null&&A(e,["trafficType"],m),e}function VJ(n){const e={},t=S(n,["type"]);return t!=null&&A(e,["voiceActivityType"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $J(n){const e={},t=S(n,["data"]);if(t!=null&&A(e,["data"],t),S(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function HJ(n){const e={},t=S(n,["content"]);t!=null&&A(e,["content"],t);const r=S(n,["citationMetadata"]);r!=null&&A(e,["citationMetadata"],ZJ(r));const i=S(n,["tokenCount"]);i!=null&&A(e,["tokenCount"],i);const s=S(n,["finishReason"]);s!=null&&A(e,["finishReason"],s);const o=S(n,["avgLogprobs"]);o!=null&&A(e,["avgLogprobs"],o);const a=S(n,["groundingMetadata"]);a!=null&&A(e,["groundingMetadata"],a);const l=S(n,["index"]);l!=null&&A(e,["index"],l);const c=S(n,["logprobsResult"]);c!=null&&A(e,["logprobsResult"],c);const u=S(n,["safetyRatings"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(v=>v)),A(e,["safetyRatings"],m)}const h=S(n,["urlContextMetadata"]);return h!=null&&A(e,["urlContextMetadata"],h),e}function ZJ(n){const e={},t=S(n,["citationSources"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),A(e,["citations"],r)}return e}function qJ(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["contents"]);if(i!=null){let s=ji(i);Array.isArray(s)&&(s=s.map(o=>o)),A(t,["contents"],s)}return t}function GJ(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),A(e,["tokensInfo"],i)}return e}function KJ(n){const e={},t=S(n,["values"]);t!=null&&A(e,["values"],t);const r=S(n,["statistics"]);return r!=null&&A(e,["statistics"],YJ(r)),e}function YJ(n){const e={},t=S(n,["truncated"]);t!=null&&A(e,["truncated"],t);const r=S(n,["token_count"]);return r!=null&&A(e,["tokenCount"],r),e}function hT(n){const e={},t=S(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>sQ(s))),A(e,["parts"],i)}const r=S(n,["role"]);return r!=null&&A(e,["role"],r),e}function JJ(n){const e={},t=S(n,["controlType"]);t!=null&&A(e,["controlType"],t);const r=S(n,["enableControlImageComputation"]);return r!=null&&A(e,["computeControl"],r),e}function XJ(n){const e={};if(S(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(S(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(S(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function QJ(n,e){const t={},r=S(n,["systemInstruction"]);e!==void 0&&r!=null&&A(e,["systemInstruction"],ar(r));const i=S(n,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>RU(a))),A(e,["tools"],o)}const s=S(n,["generationConfig"]);return e!==void 0&&s!=null&&A(e,["generationConfig"],$X(s)),t}function eX(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["contents"]);if(i!=null){let o=ji(i);Array.isArray(o)&&(o=o.map(a=>hT(a))),A(t,["contents"],o)}const s=S(e,["config"]);return s!=null&&XJ(s),t}function tX(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["contents"]);if(i!=null){let o=ji(i);Array.isArray(o)&&(o=o.map(a=>a)),A(t,["contents"],o)}const s=S(e,["config"]);return s!=null&&QJ(s,t),t}function nX(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["totalTokens"]);r!=null&&A(e,["totalTokens"],r);const i=S(n,["cachedContentTokenCount"]);return i!=null&&A(e,["cachedContentTokenCount"],i),e}function rX(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["totalTokens"]);return r!=null&&A(e,["totalTokens"],r),e}function iX(n,e){const t={},r=S(e,["model"]);return r!=null&&A(t,["_url","name"],yt(n,r)),t}function sX(n,e){const t={},r=S(e,["model"]);return r!=null&&A(t,["_url","name"],yt(n,r)),t}function oX(n){const e={},t=S(n,["sdkHttpResponse"]);return t!=null&&A(e,["sdkHttpResponse"],t),e}function aX(n){const e={},t=S(n,["sdkHttpResponse"]);return t!=null&&A(e,["sdkHttpResponse"],t),e}function lX(n,e){const t={},r=S(n,["outputGcsUri"]);e!==void 0&&r!=null&&A(e,["parameters","storageUri"],r);const i=S(n,["negativePrompt"]);e!==void 0&&i!=null&&A(e,["parameters","negativePrompt"],i);const s=S(n,["numberOfImages"]);e!==void 0&&s!=null&&A(e,["parameters","sampleCount"],s);const o=S(n,["aspectRatio"]);e!==void 0&&o!=null&&A(e,["parameters","aspectRatio"],o);const a=S(n,["guidanceScale"]);e!==void 0&&a!=null&&A(e,["parameters","guidanceScale"],a);const l=S(n,["seed"]);e!==void 0&&l!=null&&A(e,["parameters","seed"],l);const c=S(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&A(e,["parameters","safetySetting"],c);const u=S(n,["personGeneration"]);e!==void 0&&u!=null&&A(e,["parameters","personGeneration"],u);const h=S(n,["includeSafetyAttributes"]);e!==void 0&&h!=null&&A(e,["parameters","includeSafetyAttributes"],h);const m=S(n,["includeRaiReason"]);e!==void 0&&m!=null&&A(e,["parameters","includeRaiReason"],m);const v=S(n,["language"]);e!==void 0&&v!=null&&A(e,["parameters","language"],v);const C=S(n,["outputMimeType"]);e!==void 0&&C!=null&&A(e,["parameters","outputOptions","mimeType"],C);const T=S(n,["outputCompressionQuality"]);e!==void 0&&T!=null&&A(e,["parameters","outputOptions","compressionQuality"],T);const E=S(n,["addWatermark"]);e!==void 0&&E!=null&&A(e,["parameters","addWatermark"],E);const x=S(n,["labels"]);e!==void 0&&x!=null&&A(e,["labels"],x);const P=S(n,["editMode"]);e!==void 0&&P!=null&&A(e,["parameters","editMode"],P);const b=S(n,["baseSteps"]);return e!==void 0&&b!=null&&A(e,["parameters","editConfig","baseSteps"],b),t}function cX(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["prompt"]);i!=null&&A(t,["instances[0]","prompt"],i);const s=S(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>dQ(l))),A(t,["instances[0]","referenceImages"],a)}const o=S(e,["config"]);return o!=null&&lX(o,t),t}function uX(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>pT(s))),A(e,["generatedImages"],i)}return e}function dX(n,e){const t={},r=S(n,["taskType"]);e!==void 0&&r!=null&&A(e,["requests[]","taskType"],r);const i=S(n,["title"]);e!==void 0&&i!=null&&A(e,["requests[]","title"],i);const s=S(n,["outputDimensionality"]);if(e!==void 0&&s!=null&&A(e,["requests[]","outputDimensionality"],s),S(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(S(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function hX(n,e){const t={},r=S(n,["taskType"]);e!==void 0&&r!=null&&A(e,["instances[]","task_type"],r);const i=S(n,["title"]);e!==void 0&&i!=null&&A(e,["instances[]","title"],i);const s=S(n,["outputDimensionality"]);e!==void 0&&s!=null&&A(e,["parameters","outputDimensionality"],s);const o=S(n,["mimeType"]);e!==void 0&&o!=null&&A(e,["instances[]","mimeType"],o);const a=S(n,["autoTruncate"]);return e!==void 0&&a!=null&&A(e,["parameters","autoTruncate"],a),t}function pX(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["contents"]);if(i!=null){let a=mR(n,i);Array.isArray(a)&&(a=a.map(l=>l)),A(t,["requests[]","content"],a)}const s=S(e,["config"]);s!=null&&dX(s,t);const o=S(e,["model"]);return o!==void 0&&A(t,["requests[]","model"],yt(n,o)),t}function fX(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["contents"]);if(i!=null){let o=mR(n,i);Array.isArray(o)&&(o=o.map(a=>a)),A(t,["instances[]","content"],o)}const s=S(e,["config"]);return s!=null&&hX(s,t),t}function mX(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),A(e,["embeddings"],s)}const i=S(n,["metadata"]);return i!=null&&A(e,["metadata"],i),e}function gX(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>KJ(o))),A(e,["embeddings"],s)}const i=S(n,["metadata"]);return i!=null&&A(e,["metadata"],i),e}function vX(n){const e={},t=S(n,["endpoint"]);t!=null&&A(e,["name"],t);const r=S(n,["deployedModelId"]);return r!=null&&A(e,["deployedModelId"],r),e}function yX(n){const e={};if(S(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=S(n,["fileUri"]);t!=null&&A(e,["fileUri"],t);const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function SX(n){const e={},t=S(n,["id"]);t!=null&&A(e,["id"],t);const r=S(n,["args"]);r!=null&&A(e,["args"],r);const i=S(n,["name"]);if(i!=null&&A(e,["name"],i),S(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(S(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function CX(n){const e={},t=S(n,["allowedFunctionNames"]);t!=null&&A(e,["allowedFunctionNames"],t);const r=S(n,["mode"]);if(r!=null&&A(e,["mode"],r),S(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function AX(n){const e={},t=S(n,["description"]);t!=null&&A(e,["description"],t);const r=S(n,["name"]);r!=null&&A(e,["name"],r);const i=S(n,["parameters"]);i!=null&&A(e,["parameters"],i);const s=S(n,["parametersJsonSchema"]);s!=null&&A(e,["parametersJsonSchema"],s);const o=S(n,["response"]);o!=null&&A(e,["response"],o);const a=S(n,["responseJsonSchema"]);if(a!=null&&A(e,["responseJsonSchema"],a),S(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function TX(n,e,t){const r={},i=S(e,["systemInstruction"]);t!==void 0&&i!=null&&A(t,["systemInstruction"],hT(ar(i)));const s=S(e,["temperature"]);s!=null&&A(r,["temperature"],s);const o=S(e,["topP"]);o!=null&&A(r,["topP"],o);const a=S(e,["topK"]);a!=null&&A(r,["topK"],a);const l=S(e,["candidateCount"]);l!=null&&A(r,["candidateCount"],l);const c=S(e,["maxOutputTokens"]);c!=null&&A(r,["maxOutputTokens"],c);const u=S(e,["stopSequences"]);u!=null&&A(r,["stopSequences"],u);const h=S(e,["responseLogprobs"]);h!=null&&A(r,["responseLogprobs"],h);const m=S(e,["logprobs"]);m!=null&&A(r,["logprobs"],m);const v=S(e,["presencePenalty"]);v!=null&&A(r,["presencePenalty"],v);const C=S(e,["frequencyPenalty"]);C!=null&&A(r,["frequencyPenalty"],C);const T=S(e,["seed"]);T!=null&&A(r,["seed"],T);const E=S(e,["responseMimeType"]);E!=null&&A(r,["responseMimeType"],E);const x=S(e,["responseSchema"]);x!=null&&A(r,["responseSchema"],gR(x));const P=S(e,["responseJsonSchema"]);if(P!=null&&A(r,["responseJsonSchema"],P),S(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(S(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=S(e,["safetySettings"]);if(t!==void 0&&b!=null){let V=b;Array.isArray(V)&&(V=V.map(K=>hQ(K))),A(t,["safetySettings"],V)}const I=S(e,["tools"]);if(t!==void 0&&I!=null){let V=Ip(I);Array.isArray(V)&&(V=V.map(K=>SQ(Rp(K)))),A(t,["tools"],V)}const M=S(e,["toolConfig"]);if(t!==void 0&&M!=null&&A(t,["toolConfig"],yQ(M)),S(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const N=S(e,["cachedContent"]);t!==void 0&&N!=null&&A(t,["cachedContent"],va(n,N));const D=S(e,["responseModalities"]);D!=null&&A(r,["responseModalities"],D);const j=S(e,["mediaResolution"]);j!=null&&A(r,["mediaResolution"],j);const F=S(e,["speechConfig"]);if(F!=null&&A(r,["speechConfig"],vR(F)),S(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const z=S(e,["thinkingConfig"]);z!=null&&A(r,["thinkingConfig"],z);const W=S(e,["imageConfig"]);W!=null&&A(r,["imageConfig"],KX(W));const H=S(e,["enableEnhancedCivicAnswers"]);if(H!=null&&A(r,["enableEnhancedCivicAnswers"],H),S(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function EX(n,e,t){const r={},i=S(e,["systemInstruction"]);t!==void 0&&i!=null&&A(t,["systemInstruction"],ar(i));const s=S(e,["temperature"]);s!=null&&A(r,["temperature"],s);const o=S(e,["topP"]);o!=null&&A(r,["topP"],o);const a=S(e,["topK"]);a!=null&&A(r,["topK"],a);const l=S(e,["candidateCount"]);l!=null&&A(r,["candidateCount"],l);const c=S(e,["maxOutputTokens"]);c!=null&&A(r,["maxOutputTokens"],c);const u=S(e,["stopSequences"]);u!=null&&A(r,["stopSequences"],u);const h=S(e,["responseLogprobs"]);h!=null&&A(r,["responseLogprobs"],h);const m=S(e,["logprobs"]);m!=null&&A(r,["logprobs"],m);const v=S(e,["presencePenalty"]);v!=null&&A(r,["presencePenalty"],v);const C=S(e,["frequencyPenalty"]);C!=null&&A(r,["frequencyPenalty"],C);const T=S(e,["seed"]);T!=null&&A(r,["seed"],T);const E=S(e,["responseMimeType"]);E!=null&&A(r,["responseMimeType"],E);const x=S(e,["responseSchema"]);x!=null&&A(r,["responseSchema"],gR(x));const P=S(e,["responseJsonSchema"]);P!=null&&A(r,["responseJsonSchema"],P);const b=S(e,["routingConfig"]);b!=null&&A(r,["routingConfig"],b);const I=S(e,["modelSelectionConfig"]);I!=null&&A(r,["modelConfig"],I);const M=S(e,["safetySettings"]);if(t!==void 0&&M!=null){let X=M;Array.isArray(X)&&(X=X.map(Y=>Y)),A(t,["safetySettings"],X)}const N=S(e,["tools"]);if(t!==void 0&&N!=null){let X=Ip(N);Array.isArray(X)&&(X=X.map(Y=>RU(Rp(Y)))),A(t,["tools"],X)}const D=S(e,["toolConfig"]);t!==void 0&&D!=null&&A(t,["toolConfig"],D);const j=S(e,["labels"]);t!==void 0&&j!=null&&A(t,["labels"],j);const F=S(e,["cachedContent"]);t!==void 0&&F!=null&&A(t,["cachedContent"],va(n,F));const z=S(e,["responseModalities"]);z!=null&&A(r,["responseModalities"],z);const W=S(e,["mediaResolution"]);W!=null&&A(r,["mediaResolution"],W);const H=S(e,["speechConfig"]);H!=null&&A(r,["speechConfig"],vR(H));const V=S(e,["audioTimestamp"]);V!=null&&A(r,["audioTimestamp"],V);const K=S(e,["thinkingConfig"]);K!=null&&A(r,["thinkingConfig"],K);const ee=S(e,["imageConfig"]);if(ee!=null&&A(r,["imageConfig"],YX(ee)),S(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const G=S(e,["modelArmorConfig"]);return t!==void 0&&G!=null&&A(t,["modelArmorConfig"],G),r}function $O(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["contents"]);if(i!=null){let o=ji(i);Array.isArray(o)&&(o=o.map(a=>hT(a))),A(t,["contents"],o)}const s=S(e,["config"]);return s!=null&&A(t,["generationConfig"],TX(n,s,t)),t}function HO(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["contents"]);if(i!=null){let o=ji(i);Array.isArray(o)&&(o=o.map(a=>a)),A(t,["contents"],o)}const s=S(e,["config"]);return s!=null&&A(t,["generationConfig"],EX(n,s,t)),t}function ZO(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>HJ(c))),A(e,["candidates"],l)}const i=S(n,["modelVersion"]);i!=null&&A(e,["modelVersion"],i);const s=S(n,["promptFeedback"]);s!=null&&A(e,["promptFeedback"],s);const o=S(n,["responseId"]);o!=null&&A(e,["responseId"],o);const a=S(n,["usageMetadata"]);return a!=null&&A(e,["usageMetadata"],a),e}function qO(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(u=>u)),A(e,["candidates"],c)}const i=S(n,["createTime"]);i!=null&&A(e,["createTime"],i);const s=S(n,["modelVersion"]);s!=null&&A(e,["modelVersion"],s);const o=S(n,["promptFeedback"]);o!=null&&A(e,["promptFeedback"],o);const a=S(n,["responseId"]);a!=null&&A(e,["responseId"],a);const l=S(n,["usageMetadata"]);return l!=null&&A(e,["usageMetadata"],l),e}function xX(n,e){const t={};if(S(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(S(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=S(n,["numberOfImages"]);e!==void 0&&r!=null&&A(e,["parameters","sampleCount"],r);const i=S(n,["aspectRatio"]);e!==void 0&&i!=null&&A(e,["parameters","aspectRatio"],i);const s=S(n,["guidanceScale"]);if(e!==void 0&&s!=null&&A(e,["parameters","guidanceScale"],s),S(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=S(n,["safetyFilterLevel"]);e!==void 0&&o!=null&&A(e,["parameters","safetySetting"],o);const a=S(n,["personGeneration"]);e!==void 0&&a!=null&&A(e,["parameters","personGeneration"],a);const l=S(n,["includeSafetyAttributes"]);e!==void 0&&l!=null&&A(e,["parameters","includeSafetyAttributes"],l);const c=S(n,["includeRaiReason"]);e!==void 0&&c!=null&&A(e,["parameters","includeRaiReason"],c);const u=S(n,["language"]);e!==void 0&&u!=null&&A(e,["parameters","language"],u);const h=S(n,["outputMimeType"]);e!==void 0&&h!=null&&A(e,["parameters","outputOptions","mimeType"],h);const m=S(n,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&A(e,["parameters","outputOptions","compressionQuality"],m),S(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(S(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=S(n,["imageSize"]);if(e!==void 0&&v!=null&&A(e,["parameters","sampleImageSize"],v),S(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function wX(n,e){const t={},r=S(n,["outputGcsUri"]);e!==void 0&&r!=null&&A(e,["parameters","storageUri"],r);const i=S(n,["negativePrompt"]);e!==void 0&&i!=null&&A(e,["parameters","negativePrompt"],i);const s=S(n,["numberOfImages"]);e!==void 0&&s!=null&&A(e,["parameters","sampleCount"],s);const o=S(n,["aspectRatio"]);e!==void 0&&o!=null&&A(e,["parameters","aspectRatio"],o);const a=S(n,["guidanceScale"]);e!==void 0&&a!=null&&A(e,["parameters","guidanceScale"],a);const l=S(n,["seed"]);e!==void 0&&l!=null&&A(e,["parameters","seed"],l);const c=S(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&A(e,["parameters","safetySetting"],c);const u=S(n,["personGeneration"]);e!==void 0&&u!=null&&A(e,["parameters","personGeneration"],u);const h=S(n,["includeSafetyAttributes"]);e!==void 0&&h!=null&&A(e,["parameters","includeSafetyAttributes"],h);const m=S(n,["includeRaiReason"]);e!==void 0&&m!=null&&A(e,["parameters","includeRaiReason"],m);const v=S(n,["language"]);e!==void 0&&v!=null&&A(e,["parameters","language"],v);const C=S(n,["outputMimeType"]);e!==void 0&&C!=null&&A(e,["parameters","outputOptions","mimeType"],C);const T=S(n,["outputCompressionQuality"]);e!==void 0&&T!=null&&A(e,["parameters","outputOptions","compressionQuality"],T);const E=S(n,["addWatermark"]);e!==void 0&&E!=null&&A(e,["parameters","addWatermark"],E);const x=S(n,["labels"]);e!==void 0&&x!=null&&A(e,["labels"],x);const P=S(n,["imageSize"]);e!==void 0&&P!=null&&A(e,["parameters","sampleImageSize"],P);const b=S(n,["enhancePrompt"]);return e!==void 0&&b!=null&&A(e,["parameters","enhancePrompt"],b),t}function bX(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["prompt"]);i!=null&&A(t,["instances[0]","prompt"],i);const s=S(e,["config"]);return s!=null&&xX(s,t),t}function PX(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["prompt"]);i!=null&&A(t,["instances[0]","prompt"],i);const s=S(e,["config"]);return s!=null&&wX(s,t),t}function RX(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>UX(o))),A(e,["generatedImages"],s)}const i=S(n,["positivePromptSafetyAttributes"]);return i!=null&&A(e,["positivePromptSafetyAttributes"],bU(i)),e}function IX(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>pT(o))),A(e,["generatedImages"],s)}const i=S(n,["positivePromptSafetyAttributes"]);return i!=null&&A(e,["positivePromptSafetyAttributes"],PU(i)),e}function _X(n,e){const t={},r=S(n,["numberOfVideos"]);if(e!==void 0&&r!=null&&A(e,["parameters","sampleCount"],r),S(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(S(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=S(n,["durationSeconds"]);if(e!==void 0&&i!=null&&A(e,["parameters","durationSeconds"],i),S(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=S(n,["aspectRatio"]);e!==void 0&&s!=null&&A(e,["parameters","aspectRatio"],s);const o=S(n,["resolution"]);e!==void 0&&o!=null&&A(e,["parameters","resolution"],o);const a=S(n,["personGeneration"]);if(e!==void 0&&a!=null&&A(e,["parameters","personGeneration"],a),S(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=S(n,["negativePrompt"]);e!==void 0&&l!=null&&A(e,["parameters","negativePrompt"],l);const c=S(n,["enhancePrompt"]);if(e!==void 0&&c!=null&&A(e,["parameters","enhancePrompt"],c),S(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const u=S(n,["lastFrame"]);e!==void 0&&u!=null&&A(e,["instances[0]","lastFrame"],fT(u));const h=S(n,["referenceImages"]);if(e!==void 0&&h!=null){let m=h;Array.isArray(m)&&(m=m.map(v=>MQ(v))),A(e,["instances[0]","referenceImages"],m)}if(S(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(S(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function kX(n,e){const t={},r=S(n,["numberOfVideos"]);e!==void 0&&r!=null&&A(e,["parameters","sampleCount"],r);const i=S(n,["outputGcsUri"]);e!==void 0&&i!=null&&A(e,["parameters","storageUri"],i);const s=S(n,["fps"]);e!==void 0&&s!=null&&A(e,["parameters","fps"],s);const o=S(n,["durationSeconds"]);e!==void 0&&o!=null&&A(e,["parameters","durationSeconds"],o);const a=S(n,["seed"]);e!==void 0&&a!=null&&A(e,["parameters","seed"],a);const l=S(n,["aspectRatio"]);e!==void 0&&l!=null&&A(e,["parameters","aspectRatio"],l);const c=S(n,["resolution"]);e!==void 0&&c!=null&&A(e,["parameters","resolution"],c);const u=S(n,["personGeneration"]);e!==void 0&&u!=null&&A(e,["parameters","personGeneration"],u);const h=S(n,["pubsubTopic"]);e!==void 0&&h!=null&&A(e,["parameters","pubsubTopic"],h);const m=S(n,["negativePrompt"]);e!==void 0&&m!=null&&A(e,["parameters","negativePrompt"],m);const v=S(n,["enhancePrompt"]);e!==void 0&&v!=null&&A(e,["parameters","enhancePrompt"],v);const C=S(n,["generateAudio"]);e!==void 0&&C!=null&&A(e,["parameters","generateAudio"],C);const T=S(n,["lastFrame"]);e!==void 0&&T!=null&&A(e,["instances[0]","lastFrame"],ys(T));const E=S(n,["referenceImages"]);if(e!==void 0&&E!=null){let b=E;Array.isArray(b)&&(b=b.map(I=>NQ(I))),A(e,["instances[0]","referenceImages"],b)}const x=S(n,["mask"]);e!==void 0&&x!=null&&A(e,["instances[0]","mask"],kQ(x));const P=S(n,["compressionQuality"]);return e!==void 0&&P!=null&&A(e,["parameters","compressionQuality"],P),t}function MX(n){const e={},t=S(n,["name"]);t!=null&&A(e,["name"],t);const r=S(n,["metadata"]);r!=null&&A(e,["metadata"],r);const i=S(n,["done"]);i!=null&&A(e,["done"],i);const s=S(n,["error"]);s!=null&&A(e,["error"],s);const o=S(n,["response","generateVideoResponse"]);return o!=null&&A(e,["response"],OX(o)),e}function NX(n){const e={},t=S(n,["name"]);t!=null&&A(e,["name"],t);const r=S(n,["metadata"]);r!=null&&A(e,["metadata"],r);const i=S(n,["done"]);i!=null&&A(e,["done"],i);const s=S(n,["error"]);s!=null&&A(e,["error"],s);const o=S(n,["response"]);return o!=null&&A(e,["response"],BX(o)),e}function LX(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["prompt"]);i!=null&&A(t,["instances[0]","prompt"],i);const s=S(e,["image"]);s!=null&&A(t,["instances[0]","image"],fT(s));const o=S(e,["video"]);o!=null&&A(t,["instances[0]","video"],IU(o));const a=S(e,["source"]);a!=null&&FX(a,t);const l=S(e,["config"]);return l!=null&&_X(l,t),t}function DX(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["prompt"]);i!=null&&A(t,["instances[0]","prompt"],i);const s=S(e,["image"]);s!=null&&A(t,["instances[0]","image"],ys(s));const o=S(e,["video"]);o!=null&&A(t,["instances[0]","video"],_U(o));const a=S(e,["source"]);a!=null&&jX(a,t);const l=S(e,["config"]);return l!=null&&kX(l,t),t}function OX(n){const e={},t=S(n,["generatedSamples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>WX(o))),A(e,["generatedVideos"],s)}const r=S(n,["raiMediaFilteredCount"]);r!=null&&A(e,["raiMediaFilteredCount"],r);const i=S(n,["raiMediaFilteredReasons"]);return i!=null&&A(e,["raiMediaFilteredReasons"],i),e}function BX(n){const e={},t=S(n,["videos"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>VX(o))),A(e,["generatedVideos"],s)}const r=S(n,["raiMediaFilteredCount"]);r!=null&&A(e,["raiMediaFilteredCount"],r);const i=S(n,["raiMediaFilteredReasons"]);return i!=null&&A(e,["raiMediaFilteredReasons"],i),e}function FX(n,e){const t={},r=S(n,["prompt"]);e!==void 0&&r!=null&&A(e,["instances[0]","prompt"],r);const i=S(n,["image"]);e!==void 0&&i!=null&&A(e,["instances[0]","image"],fT(i));const s=S(n,["video"]);return e!==void 0&&s!=null&&A(e,["instances[0]","video"],IU(s)),t}function jX(n,e){const t={},r=S(n,["prompt"]);e!==void 0&&r!=null&&A(e,["instances[0]","prompt"],r);const i=S(n,["image"]);e!==void 0&&i!=null&&A(e,["instances[0]","image"],ys(i));const s=S(n,["video"]);return e!==void 0&&s!=null&&A(e,["instances[0]","video"],_U(s)),t}function UX(n){const e={},t=S(n,["_self"]);t!=null&&A(e,["image"],JX(t));const r=S(n,["raiFilteredReason"]);r!=null&&A(e,["raiFilteredReason"],r);const i=S(n,["_self"]);return i!=null&&A(e,["safetyAttributes"],bU(i)),e}function pT(n){const e={},t=S(n,["_self"]);t!=null&&A(e,["image"],wU(t));const r=S(n,["raiFilteredReason"]);r!=null&&A(e,["raiFilteredReason"],r);const i=S(n,["_self"]);i!=null&&A(e,["safetyAttributes"],PU(i));const s=S(n,["prompt"]);return s!=null&&A(e,["enhancedPrompt"],s),e}function zX(n){const e={},t=S(n,["_self"]);t!=null&&A(e,["mask"],wU(t));const r=S(n,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),A(e,["labels"],i)}return e}function WX(n){const e={},t=S(n,["video"]);return t!=null&&A(e,["video"],IQ(t)),e}function VX(n){const e={},t=S(n,["_self"]);return t!=null&&A(e,["video"],_Q(t)),e}function $X(n){const e={},t=S(n,["modelSelectionConfig"]);t!=null&&A(e,["modelConfig"],t);const r=S(n,["responseJsonSchema"]);r!=null&&A(e,["responseJsonSchema"],r);const i=S(n,["audioTimestamp"]);i!=null&&A(e,["audioTimestamp"],i);const s=S(n,["candidateCount"]);s!=null&&A(e,["candidateCount"],s);const o=S(n,["enableAffectiveDialog"]);o!=null&&A(e,["enableAffectiveDialog"],o);const a=S(n,["frequencyPenalty"]);a!=null&&A(e,["frequencyPenalty"],a);const l=S(n,["logprobs"]);l!=null&&A(e,["logprobs"],l);const c=S(n,["maxOutputTokens"]);c!=null&&A(e,["maxOutputTokens"],c);const u=S(n,["mediaResolution"]);u!=null&&A(e,["mediaResolution"],u);const h=S(n,["presencePenalty"]);h!=null&&A(e,["presencePenalty"],h);const m=S(n,["responseLogprobs"]);m!=null&&A(e,["responseLogprobs"],m);const v=S(n,["responseMimeType"]);v!=null&&A(e,["responseMimeType"],v);const C=S(n,["responseModalities"]);C!=null&&A(e,["responseModalities"],C);const T=S(n,["responseSchema"]);T!=null&&A(e,["responseSchema"],T);const E=S(n,["routingConfig"]);E!=null&&A(e,["routingConfig"],E);const x=S(n,["seed"]);x!=null&&A(e,["seed"],x);const P=S(n,["speechConfig"]);P!=null&&A(e,["speechConfig"],P);const b=S(n,["stopSequences"]);b!=null&&A(e,["stopSequences"],b);const I=S(n,["temperature"]);I!=null&&A(e,["temperature"],I);const M=S(n,["thinkingConfig"]);M!=null&&A(e,["thinkingConfig"],M);const N=S(n,["topK"]);N!=null&&A(e,["topK"],N);const D=S(n,["topP"]);if(D!=null&&A(e,["topP"],D),S(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function HX(n,e){const t={},r=S(e,["model"]);return r!=null&&A(t,["_url","name"],yt(n,r)),t}function ZX(n,e){const t={},r=S(e,["model"]);return r!=null&&A(t,["_url","name"],yt(n,r)),t}function qX(n){const e={};if(S(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=S(n,["enableWidget"]);return t!=null&&A(e,["enableWidget"],t),e}function GX(n){const e={};if(S(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(S(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=S(n,["timeRangeFilter"]);return t!=null&&A(e,["timeRangeFilter"],t),e}function KX(n){const e={},t=S(n,["aspectRatio"]);t!=null&&A(e,["aspectRatio"],t);const r=S(n,["imageSize"]);if(r!=null&&A(e,["imageSize"],r),S(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(S(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(S(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function YX(n){const e={},t=S(n,["aspectRatio"]);t!=null&&A(e,["aspectRatio"],t);const r=S(n,["imageSize"]);r!=null&&A(e,["imageSize"],r);const i=S(n,["personGeneration"]);i!=null&&A(e,["personGeneration"],i);const s=S(n,["outputMimeType"]);s!=null&&A(e,["imageOutputOptions","mimeType"],s);const o=S(n,["outputCompressionQuality"]);return o!=null&&A(e,["imageOutputOptions","compressionQuality"],o),e}function JX(n){const e={},t=S(n,["bytesBase64Encoded"]);t!=null&&A(e,["imageBytes"],$l(t));const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function wU(n){const e={},t=S(n,["gcsUri"]);t!=null&&A(e,["gcsUri"],t);const r=S(n,["bytesBase64Encoded"]);r!=null&&A(e,["imageBytes"],$l(r));const i=S(n,["mimeType"]);return i!=null&&A(e,["mimeType"],i),e}function fT(n){const e={};if(S(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=S(n,["imageBytes"]);t!=null&&A(e,["bytesBase64Encoded"],$l(t));const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function ys(n){const e={},t=S(n,["gcsUri"]);t!=null&&A(e,["gcsUri"],t);const r=S(n,["imageBytes"]);r!=null&&A(e,["bytesBase64Encoded"],$l(r));const i=S(n,["mimeType"]);return i!=null&&A(e,["mimeType"],i),e}function XX(n,e,t){const r={},i=S(e,["pageSize"]);t!==void 0&&i!=null&&A(t,["_query","pageSize"],i);const s=S(e,["pageToken"]);t!==void 0&&s!=null&&A(t,["_query","pageToken"],s);const o=S(e,["filter"]);t!==void 0&&o!=null&&A(t,["_query","filter"],o);const a=S(e,["queryBase"]);return t!==void 0&&a!=null&&A(t,["_url","models_url"],yU(n,a)),r}function QX(n,e,t){const r={},i=S(e,["pageSize"]);t!==void 0&&i!=null&&A(t,["_query","pageSize"],i);const s=S(e,["pageToken"]);t!==void 0&&s!=null&&A(t,["_query","pageToken"],s);const o=S(e,["filter"]);t!==void 0&&o!=null&&A(t,["_query","filter"],o);const a=S(e,["queryBase"]);return t!==void 0&&a!=null&&A(t,["_url","models_url"],yU(n,a)),r}function eQ(n,e){const t={},r=S(e,["config"]);return r!=null&&XX(n,r,t),t}function tQ(n,e){const t={},r=S(e,["config"]);return r!=null&&QX(n,r,t),t}function nQ(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["nextPageToken"]);r!=null&&A(e,["nextPageToken"],r);const i=S(n,["_self"]);if(i!=null){let s=SU(i);Array.isArray(s)&&(s=s.map(o=>MP(o))),A(e,["models"],s)}return e}function rQ(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["nextPageToken"]);r!=null&&A(e,["nextPageToken"],r);const i=S(n,["_self"]);if(i!=null){let s=SU(i);Array.isArray(s)&&(s=s.map(o=>NP(o))),A(e,["models"],s)}return e}function iQ(n){const e={},t=S(n,["maskMode"]);t!=null&&A(e,["maskMode"],t);const r=S(n,["segmentationClasses"]);r!=null&&A(e,["maskClasses"],r);const i=S(n,["maskDilation"]);return i!=null&&A(e,["dilation"],i),e}function MP(n){const e={},t=S(n,["name"]);t!=null&&A(e,["name"],t);const r=S(n,["displayName"]);r!=null&&A(e,["displayName"],r);const i=S(n,["description"]);i!=null&&A(e,["description"],i);const s=S(n,["version"]);s!=null&&A(e,["version"],s);const o=S(n,["_self"]);o!=null&&A(e,["tunedModelInfo"],CQ(o));const a=S(n,["inputTokenLimit"]);a!=null&&A(e,["inputTokenLimit"],a);const l=S(n,["outputTokenLimit"]);l!=null&&A(e,["outputTokenLimit"],l);const c=S(n,["supportedGenerationMethods"]);c!=null&&A(e,["supportedActions"],c);const u=S(n,["temperature"]);u!=null&&A(e,["temperature"],u);const h=S(n,["maxTemperature"]);h!=null&&A(e,["maxTemperature"],h);const m=S(n,["topP"]);m!=null&&A(e,["topP"],m);const v=S(n,["topK"]);v!=null&&A(e,["topK"],v);const C=S(n,["thinking"]);return C!=null&&A(e,["thinking"],C),e}function NP(n){const e={},t=S(n,["name"]);t!=null&&A(e,["name"],t);const r=S(n,["displayName"]);r!=null&&A(e,["displayName"],r);const i=S(n,["description"]);i!=null&&A(e,["description"],i);const s=S(n,["versionId"]);s!=null&&A(e,["version"],s);const o=S(n,["deployedModels"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(m=>vX(m))),A(e,["endpoints"],h)}const a=S(n,["labels"]);a!=null&&A(e,["labels"],a);const l=S(n,["_self"]);l!=null&&A(e,["tunedModelInfo"],AQ(l));const c=S(n,["defaultCheckpointId"]);c!=null&&A(e,["defaultCheckpointId"],c);const u=S(n,["checkpoints"]);if(u!=null){let h=u;Array.isArray(h)&&(h=h.map(m=>m)),A(e,["checkpoints"],h)}return e}function sQ(n){const e={},t=S(n,["mediaResolution"]);t!=null&&A(e,["mediaResolution"],t);const r=S(n,["codeExecutionResult"]);r!=null&&A(e,["codeExecutionResult"],r);const i=S(n,["executableCode"]);i!=null&&A(e,["executableCode"],i);const s=S(n,["fileData"]);s!=null&&A(e,["fileData"],yX(s));const o=S(n,["functionCall"]);o!=null&&A(e,["functionCall"],SX(o));const a=S(n,["functionResponse"]);a!=null&&A(e,["functionResponse"],a);const l=S(n,["inlineData"]);l!=null&&A(e,["inlineData"],$J(l));const c=S(n,["text"]);c!=null&&A(e,["text"],c);const u=S(n,["thought"]);u!=null&&A(e,["thought"],u);const h=S(n,["thoughtSignature"]);h!=null&&A(e,["thoughtSignature"],h);const m=S(n,["videoMetadata"]);return m!=null&&A(e,["videoMetadata"],m),e}function oQ(n){const e={},t=S(n,["productImage"]);return t!=null&&A(e,["image"],ys(t)),e}function aQ(n,e){const t={},r=S(n,["numberOfImages"]);e!==void 0&&r!=null&&A(e,["parameters","sampleCount"],r);const i=S(n,["baseSteps"]);e!==void 0&&i!=null&&A(e,["parameters","baseSteps"],i);const s=S(n,["outputGcsUri"]);e!==void 0&&s!=null&&A(e,["parameters","storageUri"],s);const o=S(n,["seed"]);e!==void 0&&o!=null&&A(e,["parameters","seed"],o);const a=S(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&A(e,["parameters","safetySetting"],a);const l=S(n,["personGeneration"]);e!==void 0&&l!=null&&A(e,["parameters","personGeneration"],l);const c=S(n,["addWatermark"]);e!==void 0&&c!=null&&A(e,["parameters","addWatermark"],c);const u=S(n,["outputMimeType"]);e!==void 0&&u!=null&&A(e,["parameters","outputOptions","mimeType"],u);const h=S(n,["outputCompressionQuality"]);e!==void 0&&h!=null&&A(e,["parameters","outputOptions","compressionQuality"],h);const m=S(n,["enhancePrompt"]);e!==void 0&&m!=null&&A(e,["parameters","enhancePrompt"],m);const v=S(n,["labels"]);return e!==void 0&&v!=null&&A(e,["labels"],v),t}function lQ(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["source"]);i!=null&&uQ(i,t);const s=S(e,["config"]);return s!=null&&aQ(s,t),t}function cQ(n){const e={},t=S(n,["predictions"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>pT(i))),A(e,["generatedImages"],r)}return e}function uQ(n,e){const t={},r=S(n,["prompt"]);e!==void 0&&r!=null&&A(e,["instances[0]","prompt"],r);const i=S(n,["personImage"]);e!==void 0&&i!=null&&A(e,["instances[0]","personImage","image"],ys(i));const s=S(n,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>oQ(a))),A(e,["instances[0]","productImages"],o)}return t}function dQ(n){const e={},t=S(n,["referenceImage"]);t!=null&&A(e,["referenceImage"],ys(t));const r=S(n,["referenceId"]);r!=null&&A(e,["referenceId"],r);const i=S(n,["referenceType"]);i!=null&&A(e,["referenceType"],i);const s=S(n,["maskImageConfig"]);s!=null&&A(e,["maskImageConfig"],iQ(s));const o=S(n,["controlImageConfig"]);o!=null&&A(e,["controlImageConfig"],JJ(o));const a=S(n,["styleImageConfig"]);a!=null&&A(e,["styleImageConfig"],a);const l=S(n,["subjectImageConfig"]);return l!=null&&A(e,["subjectImageConfig"],l),e}function bU(n){const e={},t=S(n,["safetyAttributes","categories"]);t!=null&&A(e,["categories"],t);const r=S(n,["safetyAttributes","scores"]);r!=null&&A(e,["scores"],r);const i=S(n,["contentType"]);return i!=null&&A(e,["contentType"],i),e}function PU(n){const e={},t=S(n,["safetyAttributes","categories"]);t!=null&&A(e,["categories"],t);const r=S(n,["safetyAttributes","scores"]);r!=null&&A(e,["scores"],r);const i=S(n,["contentType"]);return i!=null&&A(e,["contentType"],i),e}function hQ(n){const e={},t=S(n,["category"]);if(t!=null&&A(e,["category"],t),S(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=S(n,["threshold"]);return r!=null&&A(e,["threshold"],r),e}function pQ(n){const e={},t=S(n,["image"]);return t!=null&&A(e,["image"],ys(t)),e}function fQ(n,e){const t={},r=S(n,["mode"]);e!==void 0&&r!=null&&A(e,["parameters","mode"],r);const i=S(n,["maxPredictions"]);e!==void 0&&i!=null&&A(e,["parameters","maxPredictions"],i);const s=S(n,["confidenceThreshold"]);e!==void 0&&s!=null&&A(e,["parameters","confidenceThreshold"],s);const o=S(n,["maskDilation"]);e!==void 0&&o!=null&&A(e,["parameters","maskDilation"],o);const a=S(n,["binaryColorThreshold"]);e!==void 0&&a!=null&&A(e,["parameters","binaryColorThreshold"],a);const l=S(n,["labels"]);return e!==void 0&&l!=null&&A(e,["labels"],l),t}function mQ(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["source"]);i!=null&&vQ(i,t);const s=S(e,["config"]);return s!=null&&fQ(s,t),t}function gQ(n){const e={},t=S(n,["predictions"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>zX(i))),A(e,["generatedMasks"],r)}return e}function vQ(n,e){const t={},r=S(n,["prompt"]);e!==void 0&&r!=null&&A(e,["instances[0]","prompt"],r);const i=S(n,["image"]);e!==void 0&&i!=null&&A(e,["instances[0]","image"],ys(i));const s=S(n,["scribbleImage"]);return e!==void 0&&s!=null&&A(e,["instances[0]","scribble"],pQ(s)),t}function yQ(n){const e={},t=S(n,["retrievalConfig"]);t!=null&&A(e,["retrievalConfig"],t);const r=S(n,["functionCallingConfig"]);return r!=null&&A(e,["functionCallingConfig"],CX(r)),e}function SQ(n){const e={};if(S(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=S(n,["computerUse"]);t!=null&&A(e,["computerUse"],t);const r=S(n,["fileSearch"]);r!=null&&A(e,["fileSearch"],r);const i=S(n,["codeExecution"]);if(i!=null&&A(e,["codeExecution"],i),S(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=S(n,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(h=>h)),A(e,["functionDeclarations"],u)}const o=S(n,["googleMaps"]);o!=null&&A(e,["googleMaps"],qX(o));const a=S(n,["googleSearch"]);a!=null&&A(e,["googleSearch"],GX(a));const l=S(n,["googleSearchRetrieval"]);l!=null&&A(e,["googleSearchRetrieval"],l);const c=S(n,["urlContext"]);return c!=null&&A(e,["urlContext"],c),e}function RU(n){const e={},t=S(n,["retrieval"]);t!=null&&A(e,["retrieval"],t);const r=S(n,["computerUse"]);if(r!=null&&A(e,["computerUse"],r),S(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=S(n,["codeExecution"]);i!=null&&A(e,["codeExecution"],i);const s=S(n,["enterpriseWebSearch"]);s!=null&&A(e,["enterpriseWebSearch"],s);const o=S(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(m=>AX(m))),A(e,["functionDeclarations"],h)}const a=S(n,["googleMaps"]);a!=null&&A(e,["googleMaps"],a);const l=S(n,["googleSearch"]);l!=null&&A(e,["googleSearch"],l);const c=S(n,["googleSearchRetrieval"]);c!=null&&A(e,["googleSearchRetrieval"],c);const u=S(n,["urlContext"]);return u!=null&&A(e,["urlContext"],u),e}function CQ(n){const e={},t=S(n,["baseModel"]);t!=null&&A(e,["baseModel"],t);const r=S(n,["createTime"]);r!=null&&A(e,["createTime"],r);const i=S(n,["updateTime"]);return i!=null&&A(e,["updateTime"],i),e}function AQ(n){const e={},t=S(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&A(e,["baseModel"],t);const r=S(n,["createTime"]);r!=null&&A(e,["createTime"],r);const i=S(n,["updateTime"]);return i!=null&&A(e,["updateTime"],i),e}function TQ(n,e){const t={},r=S(n,["displayName"]);e!==void 0&&r!=null&&A(e,["displayName"],r);const i=S(n,["description"]);e!==void 0&&i!=null&&A(e,["description"],i);const s=S(n,["defaultCheckpointId"]);return e!==void 0&&s!=null&&A(e,["defaultCheckpointId"],s),t}function EQ(n,e){const t={},r=S(n,["displayName"]);e!==void 0&&r!=null&&A(e,["displayName"],r);const i=S(n,["description"]);e!==void 0&&i!=null&&A(e,["description"],i);const s=S(n,["defaultCheckpointId"]);return e!==void 0&&s!=null&&A(e,["defaultCheckpointId"],s),t}function xQ(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","name"],yt(n,r));const i=S(e,["config"]);return i!=null&&TQ(i,t),t}function wQ(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["config"]);return i!=null&&EQ(i,t),t}function bQ(n,e){const t={},r=S(n,["outputGcsUri"]);e!==void 0&&r!=null&&A(e,["parameters","storageUri"],r);const i=S(n,["safetyFilterLevel"]);e!==void 0&&i!=null&&A(e,["parameters","safetySetting"],i);const s=S(n,["personGeneration"]);e!==void 0&&s!=null&&A(e,["parameters","personGeneration"],s);const o=S(n,["includeRaiReason"]);e!==void 0&&o!=null&&A(e,["parameters","includeRaiReason"],o);const a=S(n,["outputMimeType"]);e!==void 0&&a!=null&&A(e,["parameters","outputOptions","mimeType"],a);const l=S(n,["outputCompressionQuality"]);e!==void 0&&l!=null&&A(e,["parameters","outputOptions","compressionQuality"],l);const c=S(n,["enhanceInputImage"]);e!==void 0&&c!=null&&A(e,["parameters","upscaleConfig","enhanceInputImage"],c);const u=S(n,["imagePreservationFactor"]);e!==void 0&&u!=null&&A(e,["parameters","upscaleConfig","imagePreservationFactor"],u);const h=S(n,["labels"]);e!==void 0&&h!=null&&A(e,["labels"],h);const m=S(n,["numberOfImages"]);e!==void 0&&m!=null&&A(e,["parameters","sampleCount"],m);const v=S(n,["mode"]);return e!==void 0&&v!=null&&A(e,["parameters","mode"],v),t}function PQ(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["_url","model"],yt(n,r));const i=S(e,["image"]);i!=null&&A(t,["instances[0]","image"],ys(i));const s=S(e,["upscaleFactor"]);s!=null&&A(t,["parameters","upscaleConfig","upscaleFactor"],s);const o=S(e,["config"]);return o!=null&&bQ(o,t),t}function RQ(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>pT(s))),A(e,["generatedImages"],i)}return e}function IQ(n){const e={},t=S(n,["uri"]);t!=null&&A(e,["uri"],t);const r=S(n,["encodedVideo"]);r!=null&&A(e,["videoBytes"],$l(r));const i=S(n,["encoding"]);return i!=null&&A(e,["mimeType"],i),e}function _Q(n){const e={},t=S(n,["gcsUri"]);t!=null&&A(e,["uri"],t);const r=S(n,["bytesBase64Encoded"]);r!=null&&A(e,["videoBytes"],$l(r));const i=S(n,["mimeType"]);return i!=null&&A(e,["mimeType"],i),e}function kQ(n){const e={},t=S(n,["image"]);t!=null&&A(e,["_self"],ys(t));const r=S(n,["maskMode"]);return r!=null&&A(e,["maskMode"],r),e}function MQ(n){const e={},t=S(n,["image"]);t!=null&&A(e,["image"],fT(t));const r=S(n,["referenceType"]);return r!=null&&A(e,["referenceType"],r),e}function NQ(n){const e={},t=S(n,["image"]);t!=null&&A(e,["image"],ys(t));const r=S(n,["referenceType"]);return r!=null&&A(e,["referenceType"],r),e}function IU(n){const e={},t=S(n,["uri"]);t!=null&&A(e,["uri"],t);const r=S(n,["videoBytes"]);r!=null&&A(e,["encodedVideo"],$l(r));const i=S(n,["mimeType"]);return i!=null&&A(e,["encoding"],i),e}function _U(n){const e={},t=S(n,["uri"]);t!=null&&A(e,["gcsUri"],t);const r=S(n,["videoBytes"]);r!=null&&A(e,["bytesBase64Encoded"],$l(r));const i=S(n,["mimeType"]);return i!=null&&A(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LQ(n,e){const t={},r=S(n,["displayName"]);return e!==void 0&&r!=null&&A(e,["displayName"],r),t}function DQ(n){const e={},t=S(n,["config"]);return t!=null&&LQ(t,e),e}function OQ(n,e){const t={},r=S(n,["force"]);return e!==void 0&&r!=null&&A(e,["_query","force"],r),t}function BQ(n){const e={},t=S(n,["name"]);t!=null&&A(e,["_url","name"],t);const r=S(n,["config"]);return r!=null&&OQ(r,e),e}function FQ(n){const e={},t=S(n,["name"]);return t!=null&&A(e,["_url","name"],t),e}function jQ(n,e){const t={},r=S(n,["customMetadata"]);if(e!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),A(e,["customMetadata"],s)}const i=S(n,["chunkingConfig"]);return e!==void 0&&i!=null&&A(e,["chunkingConfig"],i),t}function UQ(n){const e={},t=S(n,["name"]);t!=null&&A(e,["name"],t);const r=S(n,["metadata"]);r!=null&&A(e,["metadata"],r);const i=S(n,["done"]);i!=null&&A(e,["done"],i);const s=S(n,["error"]);s!=null&&A(e,["error"],s);const o=S(n,["response"]);return o!=null&&A(e,["response"],WQ(o)),e}function zQ(n){const e={},t=S(n,["fileSearchStoreName"]);t!=null&&A(e,["_url","file_search_store_name"],t);const r=S(n,["fileName"]);r!=null&&A(e,["fileName"],r);const i=S(n,["config"]);return i!=null&&jQ(i,e),e}function WQ(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["parent"]);r!=null&&A(e,["parent"],r);const i=S(n,["documentName"]);return i!=null&&A(e,["documentName"],i),e}function VQ(n,e){const t={},r=S(n,["pageSize"]);e!==void 0&&r!=null&&A(e,["_query","pageSize"],r);const i=S(n,["pageToken"]);return e!==void 0&&i!=null&&A(e,["_query","pageToken"],i),t}function $Q(n){const e={},t=S(n,["config"]);return t!=null&&VQ(t,e),e}function HQ(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["nextPageToken"]);r!=null&&A(e,["nextPageToken"],r);const i=S(n,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),A(e,["fileSearchStores"],s)}return e}function kU(n,e){const t={},r=S(n,["mimeType"]);e!==void 0&&r!=null&&A(e,["mimeType"],r);const i=S(n,["displayName"]);e!==void 0&&i!=null&&A(e,["displayName"],i);const s=S(n,["customMetadata"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),A(e,["customMetadata"],a)}const o=S(n,["chunkingConfig"]);return e!==void 0&&o!=null&&A(e,["chunkingConfig"],o),t}function ZQ(n){const e={},t=S(n,["fileSearchStoreName"]);t!=null&&A(e,["_url","file_search_store_name"],t);const r=S(n,["config"]);return r!=null&&kU(r,e),e}function qQ(n){const e={},t=S(n,["sdkHttpResponse"]);return t!=null&&A(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GQ="Content-Type",KQ="X-Server-Timeout",YQ="User-Agent",LP="x-goog-api-client",JQ="1.38.0",XQ=`google-genai-sdk/${JQ}`,QQ="v1beta1",eee="v1beta";class tee{constructor(e){var t,r,i;this.clientOptions=Object.assign({},e),this.customBaseUrl=(t=e.httpOptions)===null||t===void 0?void 0:t.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const s={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const a=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!a?(s.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?s.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(s.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:QQ}else{if(!this.clientOptions.apiKey)throw new Gv({message:"API key must be set when using the Gemini API.",status:403});s.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:eee,s.baseUrl="https://generativelanguage.googleapis.com/"}s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const i=[this.getRequestUrlInternal(t)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e,t){return!(t.baseUrl&&t.baseUrlResourceScope===RP.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e,t),i=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(t))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e,t),i=this.constructUrl(e.path,t,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r,i){if(t&&t.timeout||i){const s=new AbortController,o=s.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const a=setTimeout(()=>s.abort(),t.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=o}return t&&t.extraBody!==null&&nee(e,t.extraBody),e.headers=await this.getHeadersInternal(t,r),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await GO(i),new IP(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await GO(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return fs(this,arguments,function*(){var r;const i=(r=e==null?void 0:e.body)===null||r===void 0?void 0:r.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";const a="data:",l=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:c,value:u}=yield Ke(i.read());if(c){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=s.decode(u,{stream:!0});try{const C=JSON.parse(h);if("error"in C){const T=JSON.parse(JSON.stringify(C.error)),E=T.status,x=T.code,P=`got status: ${E}. ${JSON.stringify(C)}`;if(x>=400&&x<600)throw new Gv({message:P,status:x})}}catch(C){if(C.name==="ApiError")throw C}o+=h;let m=-1,v=0;for(;;){m=-1,v=0;for(const E of l){const x=o.indexOf(E);x!==-1&&(m===-1||x<m)&&(m=x,v=E.length)}if(m===-1)break;const C=o.substring(0,m);o=o.substring(m+v);const T=C.trim();if(T.startsWith(a)){const E=T.substring(a.length).trim();try{const x=new Response(E,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Ke(new IP(x))}catch(x){throw new Error(`exception parsing stream chunk ${E}. ${x}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=XQ+" "+this.clientOptions.userAgentExtra;return e[YQ]=t,e[LP]=t,e[GQ]="application/json",e}async getHeadersInternal(e,t){const r=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))r.append(i,s);e.timeout&&e.timeout>0&&r.append(KQ,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,t),r}getFileName(e){var t;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(t=r.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),r}async uploadFile(e,t){var r;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(e);i.sizeBytes=String(o.size);const a=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l={file:i},c=this.getFileName(e),u=_e("upload/v1beta/files",l._url),h=await this.fetchUploadUrl(u,i.sizeBytes,i.mimeType,c,l,t==null?void 0:t.httpOptions);return s.upload(e,h,this)}async uploadFileToFileSearchStore(e,t,r){var i;const s=this.clientOptions.uploader,o=await s.stat(t),a=String(o.size),l=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const c=`upload/v1beta/${e}:uploadToFileSearchStore`,u=this.getFileName(t),h={};r!=null&&kU(r,h);const m=await this.fetchUploadUrl(c,a,l,u,h,r==null?void 0:r.httpOptions);return s.uploadToFileSearchStore(t,m,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,r,i,s,o){var a;let l={};o?l=o:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const c=await this.request({path:e,body:JSON.stringify(s),httpMethod:"POST",httpOptions:l});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(a=c==null?void 0:c.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function GO(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let r;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await n.json():r={error:{message:await n.text(),code:n.status,status:n.statusText}};const i=JSON.stringify(r);throw t>=400&&t<600?new Gv({message:i,status:t}):new Error(i)}}function nee(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const s=JSON.parse(n.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))t=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const c=o[l],u=a[l];c&&typeof c=="object"&&!Array.isArray(c)&&u&&typeof u=="object"&&!Array.isArray(u)?a[l]=r(u,c):(u&&c&&typeof u!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof u}, New type: ${typeof c}. Overwriting.`),a[l]=c)}return a}const i=r(t,e);n.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ree="mcp_used/unknown";let iee=!1;function MU(n){for(const e of n)if(see(e)||typeof e=="object"&&"inputSchema"in e)return!0;return iee}function NU(n){var e;const t=(e=n[LP])!==null&&e!==void 0?e:"";n[LP]=(t+` ${ree}`).trimStart()}function see(n){return n!==null&&typeof n=="object"&&n instanceof SR}function oee(n){return fs(this,arguments,function*(t,r=100){let i,s=0;for(;s<r;){const o=yield Ke(t.listTools({cursor:i}));for(const a of o.tools)yield yield Ke(a),s++;if(!o.nextCursor)break;i=o.nextCursor}})}class SR{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new SR(e,t)}async initialize(){var e,t,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const u of this.mcpClients)try{for(var a=!0,l=(t=void 0,ms(oee(u))),c;c=await l.next(),e=c.done,!e;a=!0){i=c.value,a=!1;const h=i;o.push(h);const m=h.name;if(s[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);s[m]=u}}catch(h){t={error:h}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(t)throw t.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),BK(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);t.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function aee(n,e,t){const r=new IK;let i;t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),Object.assign(r,i),e(r)}class lee{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=dee(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let c=()=>{};const u=new Promise(b=>{c=b}),h=e.callbacks,m=function(){c({})},v=this.apiClient,C={onopen:m,onmessage:b=>{aee(v,h.onmessage,b)},onerror:(t=h==null?void 0:h.onerror)!==null&&t!==void 0?t:function(b){},onclose:(r=h==null?void 0:h.onclose)!==null&&r!==void 0?r:function(b){}},T=this.webSocketFactory.create(l,uee(o),C);T.connect(),await u;const P={setup:{model:yt(this.apiClient,e.model)}};return T.send(JSON.stringify(P)),new cee(T,this.apiClient)}}class cee{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=LJ(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=NJ(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Wd.PLAY)}pause(){this.sendPlaybackControl(Wd.PAUSE)}stop(){this.sendPlaybackControl(Wd.STOP)}resetContext(){this.sendPlaybackControl(Wd.RESET_CONTEXT)}close(){this.conn.close()}}function uee(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function dee(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hee="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function pee(n,e,t){const r=new RK;let i;t.data instanceof Blob?i=await t.data.text():t.data instanceof ArrayBuffer?i=new TextDecoder().decode(t.data):i=t.data;const s=JSON.parse(i);if(n.isVertexAI()){const o=BJ(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class fee{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new lee(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let u;const h=this.apiClient.getHeaders();e.config&&e.config.tools&&MU(e.config.tools)&&NU(h);const m=yee(h);if(this.apiClient.isVertexAI()){const F=this.apiClient.getProject(),z=this.apiClient.getLocation(),W=this.apiClient.getApiKey(),H=!!F&&!!z||!!W;this.apiClient.getCustomBaseUrl()&&!H?u=l:(u=`${l}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m,u))}else{const F=this.apiClient.getApiKey();let z="BidiGenerateContent",W="key";F!=null&&F.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),c!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),z="BidiGenerateContentConstrained",W="access_token"),u=`${l}/ws/google.ai.generativelanguage.${c}.GenerativeService.${z}?${W}=${F}`}let v=()=>{};const C=new Promise(F=>{v=F}),T=e.callbacks,E=function(){var F;(F=T==null?void 0:T.onopen)===null||F===void 0||F.call(T),v({})},x=this.apiClient,P={onopen:E,onmessage:F=>{pee(x,T.onmessage,F)},onerror:(t=T==null?void 0:T.onerror)!==null&&t!==void 0?t:function(F){},onclose:(r=T==null?void 0:T.onclose)!==null&&r!==void 0?r:function(F){}},b=this.webSocketFactory.create(u,vee(m),P);b.connect(),await C;let I=yt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&I.startsWith("publishers/")){const F=this.apiClient.getProject(),z=this.apiClient.getLocation();F&&z&&(I=`projects/${F}/locations/${z}/`+I)}let M={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[qv.AUDIO]}:e.config.responseModalities=[qv.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const N=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],D=[];for(const F of N)if(this.isCallableTool(F)){const z=F;D.push(await z.tool())}else D.push(F);D.length>0&&(e.config.tools=D);const j={model:I,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?M=MJ(this.apiClient,j):M=kJ(this.apiClient,j),delete M.config,b.send(JSON.stringify(M)),new gee(b,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const mee={turnComplete:!0};class gee{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=ji(t.turns),e.isVertexAI()||(r=r.map(i=>hT(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(hee)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},mee),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:OJ(e)}:t={realtimeInput:DJ(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function vee(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function yee(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KO=10;function YO(n){var e,t,r;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(Yd(o)){i=!0;break}if(!i)return!0;const s=(r=n==null?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Yd(n){return"callTool"in n&&typeof n.callTool=="function"}function See(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>Yd(i)))!==null&&r!==void 0?r:!1}function JO(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((r,i)=>{if(Yd(r))return;const s=r;s.functionDeclarations&&s.functionDeclarations.length>0&&t.push(i)}),t}function XO(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Cee extends ga{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!See(t)||YO(t.config))return await this.generateContentInternal(l);const c=JO(t);if(c.length>0){const T=c.map(E=>`tools[${E}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${T}.`)}let u,h;const m=ji(l.contents),v=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:KO;let C=0;for(;C<v&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const T=u.candidates[0].content,E=[];for(const x of(a=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(Yd(x)){const b=await x.callTool(u.functionCalls);E.push(...b)}C++,h={role:"user",parts:E},l.contents=ji(l.contents),l.contents.push(T),l.contents.push(h),XO(l.config)&&(m.push(T),m.push(h))}return XO(l.config)&&(u.automaticFunctionCallingHistory=m),u},this.generateContentStream=async t=>{var r,i,s,o,a;if(this.maybeMoveToResponseJsonSchem(t),YO(t.config)){const h=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(h)}const l=JO(t);if(l.length>0){const h=l.map(m=>`tools[${m}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const c=(s=(i=(r=t==null?void 0:t.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,u=(a=(o=t==null?void 0:t.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(c&&!u)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new nd(ua.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async t=>{var r,i,s,o,a,l;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=t.video)===null||r===void 0)&&r.uri&&(!((i=t.video)===null||i===void 0)&&i.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((o=(s=t.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=t.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,r,i;const s=(t=e.config)===null||t===void 0?void 0:t.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>Yd(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&MU(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let c=Object.assign({},l);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),NU(c),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:c})}return a}async initAfcToolsMap(e){var t,r,i;const s=new Map;for(const o of(r=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&r!==void 0?r:[])if(Yd(o)){const a=o,l=await a.tool();for(const c of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!c.name)throw new Error("Function declaration name is required.");if(s.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);s.set(c.name,a)}}return s}async processAfcStream(e){var t,r,i;const s=(i=(r=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:KO;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return(function(c,u,h){return fs(this,arguments,function*(){for(var m,v,C,T,E,x;a<s;){o&&(a++,o=!1);const M=yield Ke(c.processParamsMaybeAddMcpUsage(h)),N=yield Ke(c.generateContentStreamInternal(M)),D=[],j=[];try{for(var P=!0,b=(v=void 0,ms(N)),I;I=yield Ke(b.next()),m=I.done,!m;P=!0){T=I.value,P=!1;const F=T;if(yield yield Ke(F),F.candidates&&(!((E=F.candidates[0])===null||E===void 0)&&E.content)){j.push(F.candidates[0].content);for(const z of(x=F.candidates[0].content.parts)!==null&&x!==void 0?x:[])if(a<s&&z.functionCall){if(!z.functionCall.name)throw new Error("Function call name was not returned by the model.");if(u.has(z.functionCall.name)){const W=yield Ke(u.get(z.functionCall.name).callTool([z.functionCall]));D.push(...W)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${u.keys()}, mising tool: ${z.functionCall.name}`)}}}}catch(F){v={error:F}}finally{try{!P&&!m&&(C=b.return)&&(yield Ke(C.call(b)))}finally{if(v)throw v.error}}if(D.length>0){o=!0;const F=new hv;F.candidates=[{content:{role:"user",parts:D}}],yield yield Ke(F);const z=[];z.push(...j),z.push({role:"user",parts:D});const W=ji(h.contents).concat(z);h.contents=W}else break}})})(this,l,e)}async generateContentInternal(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=HO(this.apiClient,e);return a=_e("{model}:generateContent",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=qO(u),m=new hv;return Object.assign(m,h),m})}else{const c=$O(this.apiClient,e);return a=_e("{model}:generateContent",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=ZO(u),m=new hv;return Object.assign(m,h),m})}}async generateContentStreamInternal(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=HO(this.apiClient,e);return a=_e("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(h){return fs(this,arguments,function*(){var m,v,C,T;try{for(var E=!0,x=ms(h),P;P=yield Ke(x.next()),m=P.done,!m;E=!0){T=P.value,E=!1;const b=T,I=qO(yield Ke(b.json()));I.sdkHttpResponse={headers:b.headers};const M=new hv;Object.assign(M,I),yield yield Ke(M)}}catch(b){v={error:b}}finally{try{!E&&!m&&(C=x.return)&&(yield Ke(C.call(x)))}finally{if(v)throw v.error}}})})}else{const c=$O(this.apiClient,e);return a=_e("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(h){return fs(this,arguments,function*(){var m,v,C,T;try{for(var E=!0,x=ms(h),P;P=yield Ke(x.next()),m=P.done,!m;E=!0){T=P.value,E=!1;const b=T,I=ZO(yield Ke(b.json()));I.sdkHttpResponse={headers:b.headers};const M=new hv;Object.assign(M,I),yield yield Ke(M)}}catch(b){v={error:b}}finally{try{!E&&!m&&(C=x.return)&&(yield Ke(C.call(x)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=fX(this.apiClient,e);return a=_e("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=gX(u),m=new PO;return Object.assign(m,h),m})}else{const c=pX(this.apiClient,e);return a=_e("{model}:batchEmbedContents",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=mX(u),m=new PO;return Object.assign(m,h),m})}}async generateImagesInternal(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=PX(this.apiClient,e);return a=_e("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=IX(u),m=new RO;return Object.assign(m,h),m})}else{const c=bX(this.apiClient,e);return a=_e("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=RX(u),m=new RO;return Object.assign(m,h),m})}}async editImageInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=cX(this.apiClient,e);return s=_e("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),i.then(l=>{const c=uX(l),u=new vK;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=PQ(this.apiClient,e);return s=_e("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),i.then(l=>{const c=RQ(l),u=new yK;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=lQ(this.apiClient,e);return s=_e("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const c=cQ(l),u=new SK;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=mQ(this.apiClient,e);return s=_e("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const c=gQ(l),u=new CK;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=ZX(this.apiClient,e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>NP(u))}else{const c=HX(this.apiClient,e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>MP(u))}}async listInternal(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=tQ(this.apiClient,e);return a=_e("{models_url}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=rQ(u),m=new IO;return Object.assign(m,h),m})}else{const c=eQ(this.apiClient,e);return a=_e("{models_url}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=nQ(u),m=new IO;return Object.assign(m,h),m})}}async update(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=wQ(this.apiClient,e);return a=_e("{model}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>NP(u))}else{const c=xQ(this.apiClient,e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>MP(u))}}async delete(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=sX(this.apiClient,e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=aX(u),m=new _O;return Object.assign(m,h),m})}else{const c=iX(this.apiClient,e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=oX(u),m=new _O;return Object.assign(m,h),m})}}async countTokens(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=tX(this.apiClient,e);return a=_e("{model}:countTokens",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=rX(u),m=new kO;return Object.assign(m,h),m})}else{const c=eX(this.apiClient,e);return a=_e("{model}:countTokens",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=nX(u),m=new kO;return Object.assign(m,h),m})}}async computeTokens(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=qJ(this.apiClient,e);return s=_e("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),i.then(l=>{const c=GJ(l),u=new AK;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=DX(this.apiClient,e);return a=_e("{model}:predictLongRunning",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>{const h=NX(u),m=new RA;return Object.assign(m,h),m})}else{const c=LX(this.apiClient,e);return a=_e("{model}:predictLongRunning",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>{const h=MX(u),m=new RA;return Object.assign(m,h),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Aee extends ga{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=dK(e);return a=_e("{operationName}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o}else{const c=uK(e);return a=_e("{operationName}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o}}async fetchPredictVideosOperationInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=rK(e);return s=_e("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tee(n){const e={},t=S(n,["data"]);if(t!=null&&A(e,["data"],t),S(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function Eee(n){const e={},t=S(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>Mee(s))),A(e,["parts"],i)}const r=S(n,["role"]);return r!=null&&A(e,["role"],r),e}function xee(n,e,t){const r={},i=S(e,["expireTime"]);t!==void 0&&i!=null&&A(t,["expireTime"],i);const s=S(e,["newSessionExpireTime"]);t!==void 0&&s!=null&&A(t,["newSessionExpireTime"],s);const o=S(e,["uses"]);t!==void 0&&o!=null&&A(t,["uses"],o);const a=S(e,["liveConnectConstraints"]);t!==void 0&&a!=null&&A(t,["bidiGenerateContentSetup"],kee(n,a));const l=S(e,["lockAdditionalFields"]);return t!==void 0&&l!=null&&A(t,["fieldMask"],l),r}function wee(n,e){const t={},r=S(e,["config"]);return r!=null&&A(t,["config"],xee(n,r,t)),t}function bee(n){const e={};if(S(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=S(n,["fileUri"]);t!=null&&A(e,["fileUri"],t);const r=S(n,["mimeType"]);return r!=null&&A(e,["mimeType"],r),e}function Pee(n){const e={},t=S(n,["id"]);t!=null&&A(e,["id"],t);const r=S(n,["args"]);r!=null&&A(e,["args"],r);const i=S(n,["name"]);if(i!=null&&A(e,["name"],i),S(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(S(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Ree(n){const e={};if(S(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=S(n,["enableWidget"]);return t!=null&&A(e,["enableWidget"],t),e}function Iee(n){const e={};if(S(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(S(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=S(n,["timeRangeFilter"]);return t!=null&&A(e,["timeRangeFilter"],t),e}function _ee(n,e){const t={},r=S(n,["generationConfig"]);e!==void 0&&r!=null&&A(e,["setup","generationConfig"],r);const i=S(n,["responseModalities"]);e!==void 0&&i!=null&&A(e,["setup","generationConfig","responseModalities"],i);const s=S(n,["temperature"]);e!==void 0&&s!=null&&A(e,["setup","generationConfig","temperature"],s);const o=S(n,["topP"]);e!==void 0&&o!=null&&A(e,["setup","generationConfig","topP"],o);const a=S(n,["topK"]);e!==void 0&&a!=null&&A(e,["setup","generationConfig","topK"],a);const l=S(n,["maxOutputTokens"]);e!==void 0&&l!=null&&A(e,["setup","generationConfig","maxOutputTokens"],l);const c=S(n,["mediaResolution"]);e!==void 0&&c!=null&&A(e,["setup","generationConfig","mediaResolution"],c);const u=S(n,["seed"]);e!==void 0&&u!=null&&A(e,["setup","generationConfig","seed"],u);const h=S(n,["speechConfig"]);e!==void 0&&h!=null&&A(e,["setup","generationConfig","speechConfig"],yR(h));const m=S(n,["thinkingConfig"]);e!==void 0&&m!=null&&A(e,["setup","generationConfig","thinkingConfig"],m);const v=S(n,["enableAffectiveDialog"]);e!==void 0&&v!=null&&A(e,["setup","generationConfig","enableAffectiveDialog"],v);const C=S(n,["systemInstruction"]);e!==void 0&&C!=null&&A(e,["setup","systemInstruction"],Eee(ar(C)));const T=S(n,["tools"]);if(e!==void 0&&T!=null){let N=Ip(T);Array.isArray(N)&&(N=N.map(D=>Lee(Rp(D)))),A(e,["setup","tools"],N)}const E=S(n,["sessionResumption"]);e!==void 0&&E!=null&&A(e,["setup","sessionResumption"],Nee(E));const x=S(n,["inputAudioTranscription"]);e!==void 0&&x!=null&&A(e,["setup","inputAudioTranscription"],x);const P=S(n,["outputAudioTranscription"]);e!==void 0&&P!=null&&A(e,["setup","outputAudioTranscription"],P);const b=S(n,["realtimeInputConfig"]);e!==void 0&&b!=null&&A(e,["setup","realtimeInputConfig"],b);const I=S(n,["contextWindowCompression"]);e!==void 0&&I!=null&&A(e,["setup","contextWindowCompression"],I);const M=S(n,["proactivity"]);if(e!==void 0&&M!=null&&A(e,["setup","proactivity"],M),S(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function kee(n,e){const t={},r=S(e,["model"]);r!=null&&A(t,["setup","model"],yt(n,r));const i=S(e,["config"]);return i!=null&&A(t,["config"],_ee(i,t)),t}function Mee(n){const e={},t=S(n,["mediaResolution"]);t!=null&&A(e,["mediaResolution"],t);const r=S(n,["codeExecutionResult"]);r!=null&&A(e,["codeExecutionResult"],r);const i=S(n,["executableCode"]);i!=null&&A(e,["executableCode"],i);const s=S(n,["fileData"]);s!=null&&A(e,["fileData"],bee(s));const o=S(n,["functionCall"]);o!=null&&A(e,["functionCall"],Pee(o));const a=S(n,["functionResponse"]);a!=null&&A(e,["functionResponse"],a);const l=S(n,["inlineData"]);l!=null&&A(e,["inlineData"],Tee(l));const c=S(n,["text"]);c!=null&&A(e,["text"],c);const u=S(n,["thought"]);u!=null&&A(e,["thought"],u);const h=S(n,["thoughtSignature"]);h!=null&&A(e,["thoughtSignature"],h);const m=S(n,["videoMetadata"]);return m!=null&&A(e,["videoMetadata"],m),e}function Nee(n){const e={},t=S(n,["handle"]);if(t!=null&&A(e,["handle"],t),S(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Lee(n){const e={};if(S(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=S(n,["computerUse"]);t!=null&&A(e,["computerUse"],t);const r=S(n,["fileSearch"]);r!=null&&A(e,["fileSearch"],r);const i=S(n,["codeExecution"]);if(i!=null&&A(e,["codeExecution"],i),S(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=S(n,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(h=>h)),A(e,["functionDeclarations"],u)}const o=S(n,["googleMaps"]);o!=null&&A(e,["googleMaps"],Ree(o));const a=S(n,["googleSearch"]);a!=null&&A(e,["googleSearch"],Iee(a));const l=S(n,["googleSearchRetrieval"]);l!=null&&A(e,["googleSearchRetrieval"],l);const c=S(n,["urlContext"]);return c!=null&&A(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Dee(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=n[t];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${t}.${s}`);e.push(...i)}else e.push(t)}return e.join(",")}function Oee(n,e){let t=null;const r=n.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(n.bidiGenerateContentSetup=s,t=s):delete n.bidiGenerateContentSetup}else r!==void 0&&delete n.bidiGenerateContentSetup;const i=n.fieldMask;if(t){const s=Dee(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?n.fieldMask=s:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(c=>o.includes(c)?`generationConfig.${c}`:c));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?n.fieldMask=l.join(","):delete n.fieldMask}else delete n.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?n.fieldMask=i.join(","):delete n.fieldMask;return n}class Bee extends ga{constructor(e){super(),this.apiClient=e}async create(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=wee(this.apiClient,e);s=_e("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=Oee(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>c)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fee(n,e){const t={},r=S(n,["force"]);return e!==void 0&&r!=null&&A(e,["_query","force"],r),t}function jee(n){const e={},t=S(n,["name"]);t!=null&&A(e,["_url","name"],t);const r=S(n,["config"]);return r!=null&&Fee(r,e),e}function Uee(n){const e={},t=S(n,["name"]);return t!=null&&A(e,["_url","name"],t),e}function zee(n,e){const t={},r=S(n,["pageSize"]);e!==void 0&&r!=null&&A(e,["_query","pageSize"],r);const i=S(n,["pageToken"]);return e!==void 0&&i!=null&&A(e,["_query","pageToken"],i),t}function Wee(n){const e={},t=S(n,["parent"]);t!=null&&A(e,["_url","parent"],t);const r=S(n,["config"]);return r!=null&&zee(r,e),e}function Vee(n){const e={},t=S(n,["sdkHttpResponse"]);t!=null&&A(e,["sdkHttpResponse"],t);const r=S(n,["nextPageToken"]);r!=null&&A(e,["nextPageToken"],r);const i=S(n,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),A(e,["documents"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $ee extends ga{constructor(e){super(),this.apiClient=e,this.list=async t=>new nd(ua.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:t.parent,config:r.config}),await this.listInternal(t),t)}async get(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Uee(e);return s=_e("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var t,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=jee(e);i=_e("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Wee(e);return s=_e("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const c=Vee(l),u=new TK;return Object.assign(u,c),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hee extends ga{constructor(e,t=new $ee(e)){super(),this.apiClient=e,this.documents=t,this.list=async(r={})=>new nd(ua.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=DQ(e);return s=_e("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async get(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=FQ(e);return s=_e("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var t,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=BQ(e);i=_e("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=$Q(e);return s=_e("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const c=HQ(l),u=new EK;return Object.assign(u,c),u})}}async uploadToFileSearchStoreInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=ZQ(e);return s=_e("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const c=qQ(l),u=new xK;return Object.assign(u,c),u})}}async importFile(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=zQ(e);return s=_e("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const c=UQ(l),u=new pR;return Object.assign(u,c),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let LU=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return LU=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^t()&15>>+r/4).toString(16))};const Zee=()=>LU();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DP(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const OP=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wi extends Error{}class Tr extends Wi{constructor(e,t,r,i){super(`${Tr.makeMessage(e,t,r)}`),this.status=e,this.headers=i,this.error=t}static makeMessage(e,t,r){const i=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,r,i){if(!e||!i)return new mT({message:r,cause:OP(t)});const s=t;return e===400?new OU(e,s,r,i):e===401?new BU(e,s,r,i):e===403?new FU(e,s,r,i):e===404?new jU(e,s,r,i):e===409?new UU(e,s,r,i):e===422?new zU(e,s,r,i):e===429?new WU(e,s,r,i):e>=500?new VU(e,s,r,i):new Tr(e,s,r,i)}}class BP extends Tr{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class mT extends Tr{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class DU extends mT{constructor({message:e}={}){super({message:e??"Request timed out."})}}class OU extends Tr{}class BU extends Tr{}class FU extends Tr{}class jU extends Tr{}class UU extends Tr{}class zU extends Tr{}class WU extends Tr{}class VU extends Tr{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qee=/^[a-z][a-z0-9+.-]*:/i,Gee=n=>qee.test(n);let FP=n=>(FP=Array.isArray,FP(n));const Kee=FP;let Yee=Kee;const QO=Yee;function Jee(n){if(!n)return!0;for(const e in n)return!1;return!0}function Xee(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const Qee=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Wi(`${n} must be an integer`);if(e<0)throw new Wi(`${n} must be a positive integer`);return e},ete=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tte=n=>new Promise(e=>setTimeout(e,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jd="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nte(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const rte=()=>{var n,e,t,r,i;const s=nte();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jd,"X-Stainless-OS":tB(Deno.build.os),"X-Stainless-Arch":eB(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jd,"X-Stainless-OS":tB((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":eB((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const o=ite();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${o.browser}`,"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function ite(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const i=r[1]||0,s=r[2]||0,o=r[3]||0;return{browser:e,version:`${i}.${s}.${o}`}}}return null}const eB=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",tB=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let wC;const ste=()=>wC??(wC=rte());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ote(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function $U(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function ate(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return $U({start(){},async pull(t){const{done:r,value:i}=await e.next();r?t.close():t.enqueue(i)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function HU(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function lte(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const r=n.getReader(),i=r.cancel();r.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cte=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ZU=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e==null?void 0:e.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Ow(n,e,t){return ZU(),new File(n,e??"unknown_file",t)}function ute(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const dte=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qU=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",hte=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&qU(n),pte=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function fte(n,e,t){if(ZU(),n=await n,hte(n))return n instanceof File?n:Ow([await n.arrayBuffer()],n.name);if(pte(n)){const i=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),Ow(await jP(i),e,t)}const r=await jP(n);if(e||(e=ute(n)),!(t!=null&&t.type)){const i=r.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof i=="string"&&(t=Object.assign(Object.assign({},t),{type:i}))}return Ow(r,e,t)}async function jP(n){var e,t,r,i,s;let o=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)o.push(n);else if(qU(n))o.push(n instanceof Blob?n:await n.arrayBuffer());else if(dte(n))try{for(var a=!0,l=ms(n),c;c=await l.next(),e=c.done,!e;a=!0){i=c.value,a=!1;const u=i;o.push(...await jP(u))}}catch(u){t={error:u}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(t)throw t.error}}else{const u=(s=n==null?void 0:n.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof n}${u?`; constructor: ${u}`:""}${mte(n)}`)}return o}function mte(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GU{constructor(e){this._client=e}}GU._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KU(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const nB=Object.freeze(Object.create(null)),gte=(n=KU)=>(function(t,...r){if(t.length===1)return t[0];let i=!1;const s=[],o=t.reduce((u,h,m)=>{var v,C,T;/[?#]/.test(h)&&(i=!0);const E=r[m];let x=(i?encodeURIComponent:n)(""+E);return m!==r.length&&(E==null||typeof E=="object"&&E.toString===((T=Object.getPrototypeOf((C=Object.getPrototypeOf((v=E.hasOwnProperty)!==null&&v!==void 0?v:nB))!==null&&C!==void 0?C:nB))===null||T===void 0?void 0:T.toString))&&(x=E+"",s.push({start:u.length+h.length,length:x.length,error:`Value of type ${Object.prototype.toString.call(E).slice(8,-1)} is not a valid path parameter`})),u+h+(m===r.length?"":x)},""),a=o.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=l.exec(a))!==null;)s.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(s.sort((u,h)=>u.start-h.start),s.length>0){let u=0;const h=s.reduce((m,v)=>{const C=" ".repeat(v.start-u),T="^".repeat(v.length);return u=v.start+v.length,m+C+T},"");throw new Wi(`Path parameters result in path with invalid segments:
${s.map(m=>m.error).join(`
`)}
${o}
${h}`)}return o}),bC=gte(KU);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YU extends GU{create(e,t){var r;const{api_version:i=this._client.apiVersion}=e,s=_A(e,["api_version"]);if("model"in s&&"agent_config"in s)throw new Wi("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new Wi("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(bC`/${i}/interactions`,Object.assign(Object.assign({body:s},t),{stream:(r=e.stream)!==null&&r!==void 0?r:!1}))}delete(e,t={},r){const{api_version:i=this._client.apiVersion}=t??{};return this._client.delete(bC`/${i}/interactions/${e}`,r)}cancel(e,t={},r){const{api_version:i=this._client.apiVersion}=t??{};return this._client.post(bC`/${i}/interactions/${e}/cancel`,r)}get(e,t={},r){var i;const s=t??{},{api_version:o=this._client.apiVersion}=s,a=_A(s,["api_version"]);return this._client.get(bC`/${o}/interactions/${e}`,Object.assign(Object.assign({query:a},r),{stream:(i=t==null?void 0:t.stream)!==null&&i!==void 0?i:!1}))}}YU._key=Object.freeze(["interactions"]);class JU extends YU{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vte(n){let e=0;for(const i of n)e+=i.length;const t=new Uint8Array(e);let r=0;for(const i of n)t.set(i,r),r+=i.length;return t}let PC;function CR(n){let e;return(PC??(e=new globalThis.TextEncoder,PC=e.encode.bind(e)))(n)}let RC;function rB(n){let e;return(RC??(e=new globalThis.TextDecoder,RC=e.decode.bind(e)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gT{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?CR(e):e;this.buffer=vte([this.buffer,t]);const r=[];let i;for(;(i=yte(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){r.push(rB(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,o=rB(this.buffer.subarray(0,s));r.push(o),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}}gT.NEWLINE_CHARS=new Set([`
`,"\r"]);gT.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function yte(n,e){for(let i=e??0;i<n.length;i++){if(n[i]===10)return{preceding:i,index:i+1,carriage:!1};if(n[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function Ste(n){for(let r=0;r<n.length-1;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kA={off:0,error:200,warn:300,info:400,debug:500},iB=(n,e,t)=>{if(n){if(Xee(kA,n))return n;vr(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(kA))}`)}};function Bv(){}function IC(n,e,t){return!e||kA[n]>kA[t]?Bv:e[n].bind(e)}const Cte={error:Bv,warn:Bv,info:Bv,debug:Bv};let sB=new WeakMap;function vr(n){var e;const t=n.logger,r=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return Cte;const i=sB.get(t);if(i&&i[0]===r)return i[1];const s={error:IC("error",t,r),warn:IC("warn",t,r),info:IC("info",t,r),debug:IC("debug",t,r)};return sB.set(t,[r,s]),s}const Ic=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vd{constructor(e,t,r){this.iterator=e,this.controller=t,this.client=r}static fromSSEResponse(e,t,r){let i=!1;const s=r?vr(r):console;function o(){return fs(this,arguments,function*(){var l,c,u,h;if(i)throw new Wi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let m=!1;try{try{for(var v=!0,C=ms(Ate(e,t)),T;T=yield Ke(C.next()),l=T.done,!l;v=!0){h=T.value,v=!1;const E=h;if(!m)if(E.data.startsWith("[DONE]")){m=!0;continue}else try{yield yield Ke(JSON.parse(E.data))}catch(x){throw s.error("Could not parse message into JSON:",E.data),s.error("From chunk:",E.raw),x}}}catch(E){c={error:E}}finally{try{!v&&!l&&(u=C.return)&&(yield Ke(u.call(C)))}finally{if(c)throw c.error}}m=!0}catch(E){if(DP(E))return yield Ke(void 0);throw E}finally{m||t.abort()}})}return new Vd(o,t,r)}static fromReadableStream(e,t,r){let i=!1;function s(){return fs(this,arguments,function*(){var l,c,u,h;const m=new gT,v=HU(e);try{for(var C=!0,T=ms(v),E;E=yield Ke(T.next()),l=E.done,!l;C=!0){h=E.value,C=!1;const x=h;for(const P of m.decode(x))yield yield Ke(P)}}catch(x){c={error:x}}finally{try{!C&&!l&&(u=T.return)&&(yield Ke(u.call(T)))}finally{if(c)throw c.error}}for(const x of m.flush())yield yield Ke(x)})}function o(){return fs(this,arguments,function*(){var l,c,u,h;if(i)throw new Wi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let m=!1;try{try{for(var v=!0,C=ms(s()),T;T=yield Ke(C.next()),l=T.done,!l;v=!0){h=T.value,v=!1;const E=h;m||E&&(yield yield Ke(JSON.parse(E)))}}catch(E){c={error:E}}finally{try{!v&&!l&&(u=C.return)&&(yield Ke(u.call(C)))}finally{if(c)throw c.error}}m=!0}catch(E){if(DP(E))return yield Ke(void 0);throw E}finally{m||t.abort()}})}return new Vd(o,t,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),i=s=>({next:()=>{if(s.length===0){const o=r.next();e.push(o),t.push(o)}return s.shift()}});return[new Vd(()=>i(e),this.controller,this.client),new Vd(()=>i(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return $U({async start(){t=e[Symbol.asyncIterator]()},async pull(r){try{const{value:i,done:s}=await t.next();if(s)return r.close();const o=CR(JSON.stringify(i)+`
`);r.enqueue(o)}catch(i){r.error(i)}},async cancel(){var r;await((r=t.return)===null||r===void 0?void 0:r.call(t))}})}}function Ate(n,e){return fs(this,arguments,function*(){var r,i,s,o;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Wi("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Wi("Attempted to iterate over a response with no body");const a=new Ete,l=new gT,c=HU(n.body);try{for(var u=!0,h=ms(Tte(c)),m;m=yield Ke(h.next()),r=m.done,!r;u=!0){o=m.value,u=!1;const v=o;for(const C of l.decode(v)){const T=a.decode(C);T&&(yield yield Ke(T))}}}catch(v){i={error:v}}finally{try{!u&&!r&&(s=h.return)&&(yield Ke(s.call(h)))}finally{if(i)throw i.error}}for(const v of l.flush()){const C=a.decode(v);C&&(yield yield Ke(C))}})}function Tte(n){return fs(this,arguments,function*(){var t,r,i,s;let o=new Uint8Array;try{for(var a=!0,l=ms(n),c;c=yield Ke(l.next()),t=c.done,!t;a=!0){s=c.value,a=!1;const u=s;if(u==null)continue;const h=u instanceof ArrayBuffer?new Uint8Array(u):typeof u=="string"?CR(u):u;let m=new Uint8Array(o.length+h.length);m.set(o),m.set(h,o.length),o=m;let v;for(;(v=Ste(o))!==-1;)yield yield Ke(o.slice(0,v)),o=o.slice(v)}}catch(u){r={error:u}}finally{try{!a&&!t&&(i=l.return)&&(yield Ke(i.call(l)))}finally{if(r)throw r.error}}o.length>0&&(yield yield Ke(o))})}class Ete{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,i]=xte(e,":");return i.startsWith(" ")&&(i=i.substring(1)),t==="event"?this.event=i:t==="data"&&this.data.push(i),null}}function xte(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function wte(n,e){const{response:t,requestLogID:r,retryOfRequestLogID:i,startTime:s}=e,o=await(async()=>{var a;if(e.options.stream)return vr(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):Vd.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const l=t.headers.get("content-type"),c=(a=l==null?void 0:l.split(";")[0])===null||a===void 0?void 0:a.trim();return(c==null?void 0:c.includes("application/json"))||(c==null?void 0:c.endsWith("+json"))?await t.json():await t.text()})();return vr(n).debug(`[${r}] response parsed`,Ic({retryOfRequestLogID:i,url:t.url,status:t.status,body:o,durationMs:Date.now()-s})),o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AR extends Promise{constructor(e,t,r=wte){super(i=>{i(null)}),this.responsePromise=t,this.parseResponse=r,this.client=e}_thenUnwrap(e){return new AR(this.client,this.responsePromise,async(t,r)=>e(await this.parseResponse(t,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const XU=Symbol("brand.privateNullableHeaders");function*bte(n){if(!n)return;if(XU in n){const{values:r,nulls:i}=n;yield*r.entries();for(const s of i)yield[s,null];return}let e=!1,t;n instanceof Headers?t=n.entries():QO(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let r of t){const i=r[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const s=QO(r[1])?r[1]:[r[1]];let o=!1;for(const a of s)a!==void 0&&(e&&!o&&(o=!0,yield[i,null]),yield[i,a])}}const pv=n=>{const e=new Headers,t=new Set;for(const r of n){const i=new Set;for(const[s,o]of bte(r)){const a=s.toLowerCase();i.has(a)||(e.delete(s),i.add(a)),o===null?(e.delete(s),t.add(a)):(e.append(s,o),t.delete(a))}}return{[XU]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Bw=n=>{var e,t,r,i,s,o;if(typeof globalThis.process<"u")return(r=(t=(e=JG)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(o=(s=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||s===void 0?void 0:s.call(i,n))===null||o===void 0?void 0:o.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var QU;class vT{constructor(e){var t,r,i,s,o,a,l,{baseURL:c=Bw("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:u=(t=Bw("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:h="v1beta"}=e,m=_A(e,["baseURL","apiKey","apiVersion"]);const v=Object.assign(Object.assign({apiKey:u,apiVersion:h},m),{baseURL:c||"https://generativelanguage.googleapis.com"});this.baseURL=v.baseURL,this.timeout=(r=v.timeout)!==null&&r!==void 0?r:vT.DEFAULT_TIMEOUT,this.logger=(i=v.logger)!==null&&i!==void 0?i:console;const C="warn";this.logLevel=C,this.logLevel=(o=(s=iB(v.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:iB(Bw("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&o!==void 0?o:C,this.fetchOptions=v.fetchOptions,this.maxRetries=(a=v.maxRetries)!==null&&a!==void 0?a:2,this.fetch=(l=v.fetch)!==null&&l!==void 0?l:ote(),this.encoder=cte,this._options=v,this.apiKey=u,this.apiVersion=h,this.clientAdapter=v.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=pv([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return pv([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return pv([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new Wi(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${jd}`}defaultIdempotencyKey(){return`stainless-node-retry-${Zee()}`}makeStatusError(e,t,r,i){return Tr.generate(e,t,r,i)}buildURL(e,t,r){const i=!this.baseURLOverridden()&&r||this.baseURL,s=Gee(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return Jee(o)||(t=Object.assign(Object.assign({},o),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:r}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(i=>Object.assign({method:e,path:t},i)))}request(e,t=null){return new AR(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,r){var i,s,o;const a=await e,l=(i=a.maxRetries)!==null&&i!==void 0?i:this.maxRetries;t==null&&(t=l),await this.prepareOptions(a);const{req:c,url:u,timeout:h}=await this.buildRequest(a,{retryCount:l-t});await this.prepareRequest(c,{url:u,options:a});const m="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),v=r===void 0?"":`, retryOf: ${r}`,C=Date.now();if(vr(this).debug(`[${m}] sending request`,Ic({retryOfRequestLogID:r,method:a.method,url:u,options:a,headers:c.headers})),!((s=a.signal)===null||s===void 0)&&s.aborted)throw new BP;const T=new AbortController,E=await this.fetchWithTimeout(u,c,h,T).catch(OP),x=Date.now();if(E instanceof globalThis.Error){const b=`retrying, ${t} attempts remaining`;if(!((o=a.signal)===null||o===void 0)&&o.aborted)throw new BP;const I=DP(E)||/timed? ?out/i.test(String(E)+("cause"in E?String(E.cause):""));if(t)return vr(this).info(`[${m}] connection ${I?"timed out":"failed"} - ${b}`),vr(this).debug(`[${m}] connection ${I?"timed out":"failed"} (${b})`,Ic({retryOfRequestLogID:r,url:u,durationMs:x-C,message:E.message})),this.retryRequest(a,t,r??m);throw vr(this).info(`[${m}] connection ${I?"timed out":"failed"} - error; no more retries left`),vr(this).debug(`[${m}] connection ${I?"timed out":"failed"} (error; no more retries left)`,Ic({retryOfRequestLogID:r,url:u,durationMs:x-C,message:E.message})),I?new DU:new mT({cause:E})}const P=`[${m}${v}] ${c.method} ${u} ${E.ok?"succeeded":"failed"} with status ${E.status} in ${x-C}ms`;if(!E.ok){const b=await this.shouldRetry(E);if(t&&b){const F=`retrying, ${t} attempts remaining`;return await lte(E.body),vr(this).info(`${P} - ${F}`),vr(this).debug(`[${m}] response error (${F})`,Ic({retryOfRequestLogID:r,url:E.url,status:E.status,headers:E.headers,durationMs:x-C})),this.retryRequest(a,t,r??m,E.headers)}const I=b?"error; no more retries left":"error; not retryable";vr(this).info(`${P} - ${I}`);const M=await E.text().catch(F=>OP(F).message),N=ete(M),D=N?void 0:M;throw vr(this).debug(`[${m}] response error (${I})`,Ic({retryOfRequestLogID:r,url:E.url,status:E.status,headers:E.headers,message:D,durationMs:Date.now()-C})),this.makeStatusError(E.status,N,D,E.headers)}return vr(this).info(P),vr(this).debug(`[${m}] response start`,Ic({retryOfRequestLogID:r,url:E.url,status:E.status,headers:E.headers,durationMs:x-C})),{response:E,options:a,controller:T,requestLogID:m,retryOfRequestLogID:r,startTime:C}}async fetchWithTimeout(e,t,r,i){const s=t||{},{signal:o,method:a}=s,l=_A(s,["signal","method"]);o&&o.addEventListener("abort",()=>i.abort());const c=setTimeout(()=>i.abort(),r),u=globalThis.ReadableStream&&l.body instanceof globalThis.ReadableStream||typeof l.body=="object"&&l.body!==null&&Symbol.asyncIterator in l.body,h=Object.assign(Object.assign(Object.assign({signal:i.signal},u?{duplex:"half"}:{}),{method:"GET"}),l);a&&(h.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,h)}finally{clearTimeout(c)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r,i){var s;let o;const a=i==null?void 0:i.get("retry-after-ms");if(a){const c=parseFloat(a);Number.isNaN(c)||(o=c)}const l=i==null?void 0:i.get("retry-after");if(l&&!o){const c=parseFloat(l);Number.isNaN(c)?o=Date.parse(l)-Date.now():o=c*1e3}if(!(o&&0<=o&&o<60*1e3)){const c=(s=e.maxRetries)!==null&&s!==void 0?s:this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(t,c)}return await tte(o),this.makeRequest(e,t-1,r)}calculateDefaultRetryTimeoutMillis(e,t){const s=t-e,o=Math.min(.5*Math.pow(2,s),8),a=1-Math.random()*.25;return o*a*1e3}async buildRequest(e,{retryCount:t=0}={}){var r,i,s;const o=Object.assign({},e),{method:a,path:l,query:c,defaultBaseURL:u}=o,h=this.buildURL(l,c,u);"timeout"in o&&Qee("timeout",o.timeout),o.timeout=(r=o.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:m,body:v}=this.buildBody({options:o}),C=await this.buildHeaders({options:e,method:a,bodyHeaders:m,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:a,headers:C},o.signal&&{signal:o.signal}),globalThis.ReadableStream&&v instanceof globalThis.ReadableStream&&{duplex:"half"}),v&&{body:v}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(s=o.fetchOptions)!==null&&s!==void 0?s:{}),url:h,timeout:o.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:r,retryCount:i}){let s={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);const o=await this.authHeaders(e);let a=pv([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),ste()),this._options.defaultHeaders,r,e.headers,o]);return this.validateHeaders(a),a.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=pv([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:ate(e)}:this.encoder({body:e,headers:r})}}vT.DEFAULT_TIMEOUT=6e4;class Fn extends vT{constructor(){super(...arguments),this.interactions=new JU(this)}}QU=Fn;Fn.GeminiNextGenAPIClient=QU;Fn.GeminiNextGenAPIClientError=Wi;Fn.APIError=Tr;Fn.APIConnectionError=mT;Fn.APIConnectionTimeoutError=DU;Fn.APIUserAbortError=BP;Fn.NotFoundError=jU;Fn.ConflictError=UU;Fn.RateLimitError=WU;Fn.BadRequestError=OU;Fn.AuthenticationError=BU;Fn.InternalServerError=VU;Fn.PermissionDeniedError=FU;Fn.UnprocessableEntityError=zU;Fn.toFile=fte;Fn.Interactions=JU;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pte(n,e){const t={},r=S(n,["name"]);return r!=null&&A(t,["_url","name"],r),t}function Rte(n,e){const t={},r=S(n,["name"]);return r!=null&&A(t,["_url","name"],r),t}function Ite(n,e){const t={},r=S(n,["sdkHttpResponse"]);return r!=null&&A(t,["sdkHttpResponse"],r),t}function _te(n,e){const t={},r=S(n,["sdkHttpResponse"]);return r!=null&&A(t,["sdkHttpResponse"],r),t}function kte(n,e,t){const r={};if(S(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=S(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&A(e,["displayName"],i),S(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=S(n,["epochCount"]);e!==void 0&&s!=null&&A(e,["tuningTask","hyperparameters","epochCount"],s);const o=S(n,["learningRateMultiplier"]);if(o!=null&&A(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),S(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(S(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(S(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=S(n,["batchSize"]);e!==void 0&&a!=null&&A(e,["tuningTask","hyperparameters","batchSize"],a);const l=S(n,["learningRate"]);if(e!==void 0&&l!=null&&A(e,["tuningTask","hyperparameters","learningRate"],l),S(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(S(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function Mte(n,e,t){const r={};let i=S(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const v=S(n,["validationDataset"]);e!==void 0&&v!=null&&A(e,["supervisedTuningSpec"],oB(v))}else if(i==="PREFERENCE_TUNING"){const v=S(n,["validationDataset"]);e!==void 0&&v!=null&&A(e,["preferenceOptimizationSpec"],oB(v))}const s=S(n,["tunedModelDisplayName"]);e!==void 0&&s!=null&&A(e,["tunedModelDisplayName"],s);const o=S(n,["description"]);e!==void 0&&o!=null&&A(e,["description"],o);let a=S(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const v=S(n,["epochCount"]);e!==void 0&&v!=null&&A(e,["supervisedTuningSpec","hyperParameters","epochCount"],v)}else if(a==="PREFERENCE_TUNING"){const v=S(n,["epochCount"]);e!==void 0&&v!=null&&A(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],v)}let l=S(t,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const v=S(n,["learningRateMultiplier"]);e!==void 0&&v!=null&&A(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],v)}else if(l==="PREFERENCE_TUNING"){const v=S(n,["learningRateMultiplier"]);e!==void 0&&v!=null&&A(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],v)}let c=S(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const v=S(n,["exportLastCheckpointOnly"]);e!==void 0&&v!=null&&A(e,["supervisedTuningSpec","exportLastCheckpointOnly"],v)}else if(c==="PREFERENCE_TUNING"){const v=S(n,["exportLastCheckpointOnly"]);e!==void 0&&v!=null&&A(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],v)}let u=S(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const v=S(n,["adapterSize"]);e!==void 0&&v!=null&&A(e,["supervisedTuningSpec","hyperParameters","adapterSize"],v)}else if(u==="PREFERENCE_TUNING"){const v=S(n,["adapterSize"]);e!==void 0&&v!=null&&A(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],v)}if(S(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(S(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=S(n,["labels"]);e!==void 0&&h!=null&&A(e,["labels"],h);const m=S(n,["beta"]);return e!==void 0&&m!=null&&A(e,["preferenceOptimizationSpec","hyperParameters","beta"],m),r}function Nte(n,e){const t={},r=S(n,["baseModel"]);r!=null&&A(t,["baseModel"],r);const i=S(n,["preTunedModel"]);i!=null&&A(t,["preTunedModel"],i);const s=S(n,["trainingDataset"]);s!=null&&$te(s);const o=S(n,["config"]);return o!=null&&kte(o,t),t}function Lte(n,e){const t={},r=S(n,["baseModel"]);r!=null&&A(t,["baseModel"],r);const i=S(n,["preTunedModel"]);i!=null&&A(t,["preTunedModel"],i);const s=S(n,["trainingDataset"]);s!=null&&Hte(s,t,e);const o=S(n,["config"]);return o!=null&&Mte(o,t,e),t}function Dte(n,e){const t={},r=S(n,["name"]);return r!=null&&A(t,["_url","name"],r),t}function Ote(n,e){const t={},r=S(n,["name"]);return r!=null&&A(t,["_url","name"],r),t}function Bte(n,e,t){const r={},i=S(n,["pageSize"]);e!==void 0&&i!=null&&A(e,["_query","pageSize"],i);const s=S(n,["pageToken"]);e!==void 0&&s!=null&&A(e,["_query","pageToken"],s);const o=S(n,["filter"]);return e!==void 0&&o!=null&&A(e,["_query","filter"],o),r}function Fte(n,e,t){const r={},i=S(n,["pageSize"]);e!==void 0&&i!=null&&A(e,["_query","pageSize"],i);const s=S(n,["pageToken"]);e!==void 0&&s!=null&&A(e,["_query","pageToken"],s);const o=S(n,["filter"]);return e!==void 0&&o!=null&&A(e,["_query","filter"],o),r}function jte(n,e){const t={},r=S(n,["config"]);return r!=null&&Bte(r,t),t}function Ute(n,e){const t={},r=S(n,["config"]);return r!=null&&Fte(r,t),t}function zte(n,e){const t={},r=S(n,["sdkHttpResponse"]);r!=null&&A(t,["sdkHttpResponse"],r);const i=S(n,["nextPageToken"]);i!=null&&A(t,["nextPageToken"],i);const s=S(n,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>ez(a))),A(t,["tuningJobs"],o)}return t}function Wte(n,e){const t={},r=S(n,["sdkHttpResponse"]);r!=null&&A(t,["sdkHttpResponse"],r);const i=S(n,["nextPageToken"]);i!=null&&A(t,["nextPageToken"],i);const s=S(n,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>UP(a))),A(t,["tuningJobs"],o)}return t}function Vte(n,e){const t={},r=S(n,["name"]);r!=null&&A(t,["model"],r);const i=S(n,["name"]);return i!=null&&A(t,["endpoint"],i),t}function $te(n,e){const t={};if(S(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(S(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=S(n,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),A(t,["examples","examples"],i)}return t}function Hte(n,e,t){const r={};let i=S(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=S(n,["gcsUri"]);e!==void 0&&o!=null&&A(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=S(n,["gcsUri"]);e!==void 0&&o!=null&&A(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=S(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=S(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&A(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=S(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&A(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(S(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function ez(n,e){const t={},r=S(n,["sdkHttpResponse"]);r!=null&&A(t,["sdkHttpResponse"],r);const i=S(n,["name"]);i!=null&&A(t,["name"],i);const s=S(n,["state"]);s!=null&&A(t,["state"],gU(s));const o=S(n,["createTime"]);o!=null&&A(t,["createTime"],o);const a=S(n,["tuningTask","startTime"]);a!=null&&A(t,["startTime"],a);const l=S(n,["tuningTask","completeTime"]);l!=null&&A(t,["endTime"],l);const c=S(n,["updateTime"]);c!=null&&A(t,["updateTime"],c);const u=S(n,["description"]);u!=null&&A(t,["description"],u);const h=S(n,["baseModel"]);h!=null&&A(t,["baseModel"],h);const m=S(n,["_self"]);return m!=null&&A(t,["tunedModel"],Vte(m)),t}function UP(n,e){const t={},r=S(n,["sdkHttpResponse"]);r!=null&&A(t,["sdkHttpResponse"],r);const i=S(n,["name"]);i!=null&&A(t,["name"],i);const s=S(n,["state"]);s!=null&&A(t,["state"],gU(s));const o=S(n,["createTime"]);o!=null&&A(t,["createTime"],o);const a=S(n,["startTime"]);a!=null&&A(t,["startTime"],a);const l=S(n,["endTime"]);l!=null&&A(t,["endTime"],l);const c=S(n,["updateTime"]);c!=null&&A(t,["updateTime"],c);const u=S(n,["error"]);u!=null&&A(t,["error"],u);const h=S(n,["description"]);h!=null&&A(t,["description"],h);const m=S(n,["baseModel"]);m!=null&&A(t,["baseModel"],m);const v=S(n,["tunedModel"]);v!=null&&A(t,["tunedModel"],v);const C=S(n,["preTunedModel"]);C!=null&&A(t,["preTunedModel"],C);const T=S(n,["supervisedTuningSpec"]);T!=null&&A(t,["supervisedTuningSpec"],T);const E=S(n,["preferenceOptimizationSpec"]);E!=null&&A(t,["preferenceOptimizationSpec"],E);const x=S(n,["tuningDataStats"]);x!=null&&A(t,["tuningDataStats"],x);const P=S(n,["encryptionSpec"]);P!=null&&A(t,["encryptionSpec"],P);const b=S(n,["partnerModelTuningSpec"]);b!=null&&A(t,["partnerModelTuningSpec"],b);const I=S(n,["customBaseModel"]);I!=null&&A(t,["customBaseModel"],I);const M=S(n,["experiment"]);M!=null&&A(t,["experiment"],M);const N=S(n,["labels"]);N!=null&&A(t,["labels"],N);const D=S(n,["outputUri"]);D!=null&&A(t,["outputUri"],D);const j=S(n,["pipelineJob"]);j!=null&&A(t,["pipelineJob"],j);const F=S(n,["serviceAccount"]);F!=null&&A(t,["serviceAccount"],F);const z=S(n,["tunedModelDisplayName"]);z!=null&&A(t,["tunedModelDisplayName"],z);const W=S(n,["veoTuningSpec"]);return W!=null&&A(t,["veoTuningSpec"],W),t}function Zte(n,e){const t={},r=S(n,["sdkHttpResponse"]);r!=null&&A(t,["sdkHttpResponse"],r);const i=S(n,["name"]);i!=null&&A(t,["name"],i);const s=S(n,["metadata"]);s!=null&&A(t,["metadata"],s);const o=S(n,["done"]);o!=null&&A(t,["done"],o);const a=S(n,["error"]);return a!=null&&A(t,["error"],a),t}function oB(n,e){const t={},r=S(n,["gcsUri"]);r!=null&&A(t,["validationDatasetUri"],r);const i=S(n,["vertexDatasetResource"]);return i!=null&&A(t,["validationDatasetUri"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qte extends ga{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new nd(ua.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var r;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const i={tunedModelName:t.baseModel};!((r=t.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=t.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},t),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},t);return await this.tuneInternal(i)}else{const i=Object.assign({},t),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:PP.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=Ote(e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>UP(u))}else{const c=Dte(e);return a=_e("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>ez(u))}}async listInternal(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=Ute(e);return a=_e("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=Wte(u),m=new MO;return Object.assign(m,h),m})}else{const c=jte(e);return a=_e("tunedModels",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=zte(u),m=new MO;return Object.assign(m,h),m})}}async cancel(e){var t,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=Rte(e);return a=_e("{name}:cancel",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=_te(u),m=new NO;return Object.assign(m,h),m})}else{const c=Pte(e);return a=_e("{name}:cancel",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const h=Ite(u),m=new NO;return Object.assign(m,h),m})}}async tuneInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Lte(e,e);return s=_e("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),i.then(l=>UP(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Nte(e);return s=_e("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),i.then(l=>Zte(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gte{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Kte=1024*1024*8,Yte=3,Jte=1e3,Xte=2,MA="x-goog-upload-status";async function Qte(n,e,t){var r;const i=await tz(n,e,t),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[MA])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function ene(n,e,t){var r;const i=await tz(n,e,t),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[MA])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=uU(s),a=new fR;return Object.assign(a,o),a}async function tz(n,e,t){var r,i;let s=0,o=0,a=new IP(new Response),l="upload";for(s=n.size;o<s;){const c=Math.min(Kte,s-o),u=n.slice(o,o+c);o+c>=s&&(l+=", finalize");let h=0,m=Jte;for(;h<Yte&&(a=await t.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(c)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[MA]));)h++,await nne(m),m=m*Xte;if(o+=c,((i=a==null?void 0:a.headers)===null||i===void 0?void 0:i[MA])!=="active")break;if(s<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function tne(n){return{size:n.size,type:n.type}}function nne(n){return new Promise(e=>setTimeout(e,n))}class rne{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Qte(e,t,r)}async uploadToFileSearchStore(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await ene(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await tne(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ine{create(e,t,r){return new sne(e,t,r)}}class sne{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const aB="x-goog-api-key";class one{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(aB)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(aB,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ane="gl-node/";class lne{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new Fn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=tK(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new one(this.apiKey);this.apiClient=new tee({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:ane+"web",uploader:new rne,downloader:new Gte}),this.models=new Cee(this.apiClient),this.live=new fee(this.apiClient,i,new ine),this.batches=new _Y(this.apiClient),this.chats=new dJ(this.models,this.apiClient),this.caches=new lJ(this.apiClient),this.files=new AJ(this.apiClient),this.operations=new Aee(this.apiClient),this.authTokens=new Bee(this.apiClient),this.tunings=new qte(this.apiClient),this.fileSearchStores=new Hee(this.apiClient)}}const zP=16e3,Fw=24e3,cne=4096;class une{constructor(){q(this,"recordingContext");q(this,"playbackContext");q(this,"mediaStream",null);q(this,"sourceNode",null);q(this,"processorNode",null);q(this,"analyserNode",null);q(this,"playbackAnalyser",null);q(this,"onAudioData",null);q(this,"isRecording",!1);q(this,"playbackQueue",[]);q(this,"nextPlayTime",0);q(this,"isPlaybackStarted",!1);q(this,"circleElement",null);q(this,"animationFrameId",null);q(this,"dataArray",null);q(this,"currentAnimationType",null);this.recordingContext=new AudioContext({sampleRate:zP}),this.playbackContext=new AudioContext({sampleRate:Fw})}setCircleElement(e){this.circleElement=e}async startRecording(e){this.onAudioData=e;try{this.mediaStream=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:zP,channelCount:1,echoCancellation:!0,noiseSuppression:!0}}),this.recordingContext.state==="suspended"&&await this.recordingContext.resume(),this.sourceNode=this.recordingContext.createMediaStreamSource(this.mediaStream),this.analyserNode=this.recordingContext.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.7,this.analyserNode.minDecibels=-90,this.analyserNode.maxDecibels=-10,this.dataArray=new Uint8Array(this.analyserNode.frequencyBinCount),this.processorNode=this.recordingContext.createScriptProcessor(cne,1,1),this.processorNode.onaudioprocess=t=>{if(!this.isRecording||!this.onAudioData)return;const r=t.inputBuffer.getChannelData(0),i=new Int16Array(r.length);for(let s=0;s<r.length;s++){const o=Math.max(-1,Math.min(1,r[s]));i[s]=o<0?o*32768:o*32767}this.onAudioData(i.buffer)},this.sourceNode.connect(this.analyserNode),this.analyserNode.connect(this.processorNode),this.processorNode.connect(this.recordingContext.destination),this.isRecording=!0,this.circleElement&&this.startAnimation("record"),console.log("[Gemini Audio] Recording started")}catch(t){throw console.error("[Gemini Audio] Error starting recording:",t),t}}stopRecording(){this.isRecording=!1,this.processorNode&&(this.processorNode.disconnect(),this.processorNode=null),this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=null),this.mediaStream&&(this.mediaStream.getTracks().forEach(e=>e.stop()),this.mediaStream=null),this.stopAnimation(),console.log("[Gemini Audio] Recording stopped")}queueAudioForPlayback(e){try{this.playbackContext.state==="suspended"&&this.playbackContext.resume();const t=new Int16Array(e),r=new Float32Array(t.length);for(let l=0;l<t.length;l++)r[l]=t[l]/32768;const i=this.playbackContext.createBuffer(1,r.length,Fw);i.getChannelData(0).set(r);const s=this.playbackContext.createBufferSource();s.buffer=i,this.playbackAnalyser||(this.playbackAnalyser=this.playbackContext.createAnalyser(),this.playbackAnalyser.fftSize=2048,this.playbackAnalyser.smoothingTimeConstant=.7,this.playbackAnalyser.minDecibels=-90,this.playbackAnalyser.maxDecibels=-10),s.connect(this.playbackAnalyser),this.playbackAnalyser.connect(this.playbackContext.destination),this.circleElement&&this.startAnimation("play");const o=this.playbackContext.currentTime;this.isPlaybackStarted||(this.nextPlayTime=o+.05,this.isPlaybackStarted=!0),this.nextPlayTime<o&&(this.nextPlayTime=o+.01),s.start(this.nextPlayTime),this.playbackQueue.push(s),s.onended=()=>{const l=this.playbackQueue.indexOf(s);l>-1&&this.playbackQueue.splice(l,1),this.playbackQueue.length===0&&this.mediaStream&&this.circleElement&&this.startAnimation("record")};const a=r.length/Fw;this.nextPlayTime+=a}catch(t){console.error("[Gemini Audio] Error queuing audio:",t)}}startAnimation(e){if(this.currentAnimationType===e&&this.animationFrameId)return;this.stopAnimation(),this.currentAnimationType=e;const t=()=>{const r=e==="record"?this.analyserNode:this.playbackAnalyser;if(!r||!this.circleElement){console.warn("[Gemini Audio] Animation stopped - missing analyser or circle");return}(!this.dataArray||this.dataArray.length!==r.frequencyBinCount)&&(this.dataArray=new Uint8Array(r.frequencyBinCount)),r.getByteFrequencyData(this.dataArray);const i=Array.from(this.dataArray).reduce((s,o)=>s+o,0)/this.dataArray.length;this.updateCircle(i,e),this.animationFrameId=requestAnimationFrame(t)};console.log("[Gemini Audio] Starting animation:",e),t()}stopAnimation(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.currentAnimationType=null}updateCircle(e,t){if(!this.circleElement)return;const s=Math.min(120+e*3,200),o=Math.min(e/128,1);let a;if(t==="record"){const l=160+o*20,c=180+o*30,u=60+o*40,h=70-o*20;a=`linear-gradient(135deg, hsl(${l}, ${u}%, ${h}%), hsl(${c}, ${u}%, ${h}%))`}else{const l=260+o*20,c=300+o*30,u=60+o*40,h=70-o*20;a=`linear-gradient(135deg, hsl(${l}, ${u}%, ${h}%), hsl(${c}, ${u}%, ${h}%))`}this.circleElement.style.background=a,this.circleElement.style.width=`${s}px`,this.circleElement.style.height=`${s}px`,this.circleElement.style.boxShadow=`0 0 ${20+o*30}px rgba(${t==="record"?"20, 184, 166":"168, 85, 247"}, ${.3+o*.4})`}resetPlayback(){this.stopAnimation(),this.playbackQueue.forEach(e=>{try{e.stop()}catch{}}),this.playbackQueue=[],this.isPlaybackStarted=!1,this.nextPlayTime=0}stopPlayback(){console.log("[Gemini Audio] Stopping audio playback due to interruption"),this.stopAnimation(),this.playbackQueue.forEach(e=>{try{e.stop()}catch{}}),this.playbackQueue=[],this.isPlaybackStarted=!1,this.nextPlayTime=0,this.mediaStream&&this.circleElement&&this.startAnimation("record")}cleanup(){this.stopRecording(),this.resetPlayback(),this.recordingContext&&this.recordingContext.state!=="closed"&&this.recordingContext.close(),this.playbackContext&&this.playbackContext.state!=="closed"&&this.playbackContext.close()}}const dne="gemini-2.5-flash-native-audio-preview-12-2025";class hne{constructor(e){q(this,"session",null);q(this,"config");q(this,"productData","");q(this,"ai");q(this,"userSpeechEndTime",null);q(this,"firstAudioReceived",!1);this.config=e,this.ai=new lne({apiKey:e.apiKey})}setProductData(e){this.productData=e}markSpeechEnd(){this.userSpeechEndTime=performance.now(),this.firstAudioReceived=!1;const e=new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3});console.log(` [Gemini] Speech end detected by VAD at ${e}`)}async connect(){this.config.onStatusChange("connecting");try{const e=this.config.interruptionSensitivity||"medium";let t,r,i;switch(e){case"low":t=Fv.START_SENSITIVITY_LOW,r=jv.END_SENSITIVITY_LOW,i=800;break;case"high":t=Fv.START_SENSITIVITY_HIGH,r=jv.END_SENSITIVITY_HIGH,i=300;break;case"medium":default:t=Fv.START_SENSITIVITY_LOW,r=jv.END_SENSITIVITY_LOW,i=500;break}const s=this.config.enableProductLookup?[{functionDeclarations:[{name:"get_product_inventory",description:"Retrieves the full product catalog including SKUs, sizes, colors, and prices. Use this when the user asks about products, inventory, prices, or availability."}]}]:void 0,o=this.config.systemPrompt||(this.config.enableProductLookup?`You are a helpful voice assistant. You help customers find products.

When asked about products, use the get_product_inventory tool to retrieve the product catalog. Be conversational and helpful.

Keep your responses concise and natural for voice interaction. Focus on the most relevant information.`:`You are a helpful voice assistant for testing Gemini Live API integration with Azure TTS Playground.

Keep your responses concise and natural for voice interaction.`);console.log("[Gemini] Connecting with SDK..."),this.session=await this.ai.live.connect({model:dne,callbacks:{onopen:()=>{console.log("[Gemini] Connected via SDK"),this.config.onStatusChange("connected")},onmessage:a=>{this.handleServerMessage(a)},onerror:a=>{console.error("[Gemini] Session error:",a),this.config.onError(`Session error: ${a}`),this.config.onStatusChange("error")},onclose:()=>{console.log("[Gemini] Session closed"),this.config.onStatusChange("disconnected")}},config:{responseModalities:[qv.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Zephyr"}}},realtimeInputConfig:{automaticActivityDetection:{disabled:!1,startOfSpeechSensitivity:t,endOfSpeechSensitivity:r,prefixPaddingMs:20,silenceDurationMs:i}},inputAudioTranscription:{},outputAudioTranscription:{},systemInstruction:{parts:[{text:o}]},thinkingConfig:{thinkingBudget:0},...s&&{tools:s}}})}catch(e){throw console.error("[Gemini] Connection failed:",e),this.config.onError(`Failed to connect: ${e}`),this.config.onStatusChange("error"),e}}handleServerMessage(e){try{if(e.toolCall){const t=e.toolCall.functionCalls||[];for(const r of t)this.handleToolCall(r);return}e.serverContent&&this.handleServerContent(e.serverContent)}catch(t){console.error("[Gemini] Error handling server message:",t)}}handleServerContent(e){var t,r,i;try{if(e.interrupted){console.log("[Gemini] Generation was interrupted by user"),this.config.onInterrupted(),this.userSpeechEndTime=null,this.firstAudioReceived=!1;return}if(e.inputTranscription){const o=e.inputTranscription.text;o&&this.config.onInputTranscript(o)}if(e.outputTranscription){const o=e.outputTranscription.text;o&&this.config.onOutputTranscript(o)}const s=((t=e.modelTurn)==null?void 0:t.parts)||[];for(const o of s)if(!o.thought&&(o.text&&this.config.onOutputTranscript(o.text),o.inlineData)){if(!this.firstAudioReceived){const c=new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3});if(this.userSpeechEndTime!==null){const u=performance.now()-this.userSpeechEndTime;this.firstAudioReceived=!0,console.log(` [Gemini] First audio chunk received at ${c} - Response latency: ${u.toFixed(0)}ms`),(i=(r=this.config).onLatencyMeasured)==null||i.call(r,u)}else this.firstAudioReceived=!0,console.log(` [Gemini] First audio chunk received at ${c} (no VAD speech end detected)`)}const a=o.inlineData.data,l=this.base64ToArrayBuffer(a);this.config.onAudioData(l)}e.turnComplete&&(this.userSpeechEndTime=null,this.firstAudioReceived=!1,this.config.onTurnComplete())}catch(s){console.error("[Gemini] Error handling server content:",s)}}async handleToolCall(e){console.log("[Gemini] Tool call received:",e.name),this.config.onToolCall(e.name);let t;e.name==="get_product_inventory"?t=this.productData||"No product data available. Please enable product lookup.":t=`Unknown tool: ${e.name}`,this.session&&await this.session.sendToolResponse({functionResponses:[{id:e.id,name:e.name,response:{result:t}}]})}sendAudio(e){if(this.session)try{const t=this.arrayBufferToBase64(e);this.session.sendRealtimeInput({audio:{data:t,mimeType:`audio/pcm;rate=${zP}`}})}catch(t){console.debug("[Gemini] Failed to send audio:",t)}}sendText(e){this.session&&this.session.sendClientContent({turns:[{role:"user",parts:[{text:e}]}],turnComplete:!0})}disconnect(){this.session&&(this.session.close(),this.session=null),this.config.onStatusChange("disconnected")}base64ToArrayBuffer(e){const t=atob(e),r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r.buffer}arrayBufferToBase64(e){const t=new Uint8Array(e);let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return btoa(r)}}const pne=`
Zava Shop SKU Inventory (Expanded)
ZavaCore Field Premium
Product Name
Product Style
SKU
Size
Color
Price
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Men's
Short Sleeve Top
ZCPTM-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCPTW-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Long  Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
LS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Men's
Long Sleeve Top
ZCPTM-LS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Women's
Long Sleeve Top
ZCPTW-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel Women's
Athletic Apparel
ZCPTW-:S-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPTM
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Long Sleeve Top Youth
Long Sleeve Top
ZCPTY-LS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Sorts Mens
Athletic Shorts
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPSM
AS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Men's
Athletic Shorts
ZCPSM-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Shorts Women's
Athletic Shorts
Small Trim
$89
ZavaCore Premium Athletic Apparel Women's
Athletic Apparel
ZCPSW
AS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Women's
Athletic Shorts
ZCPSW-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts
Athletic Shorts
ZCPTS-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Shorts Youth
Athletic Shorts
Small Trim
$89
ZavaCore Premium Athletic Apparel Youth
Athletic Apparel
ZCPSY
AS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Shorts Youth
Athletic Shorts
ZCPSY-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Pants Mens
Athletic Pants
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCPPM
AP
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCPPM-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Pants Women's
Athletic Pants
Small Trim
$89
ZavaCore Premium Athletic Apparel Women's
Athletic Apparel
ZCPPW
AP
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Women's
Athletic Pants
ZCPPW-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Premium Pants Youth
Athletic Pants
Small Trim
$89
ZavaCore Premium Athletic Apparel Youth
Athletic Apparel
ZCPPY
AP
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Youth
Athletic Pants
ZCPPY-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Women's
Short Sleeve
Small Trim
$89
ZavaCore Premium Athletic Apparel Women's
Athletic Apparel
ZCETW
SS
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Short Sleeve Top Women's
Short Sleeve Top
ZCETW-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
ZavaCore Elite Pants Mens
Athletic Pants
Small Trim
$89
ZavaCore Premium Athletic Apparel Men's
Athletic Apparel
ZCEPM
AP
S Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Premium Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Premium Athletic Pants Men's
Athletic Pants
ZCEPM-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Field Elite
Product Name
Product Style
SKU
Size
Color
Price
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Elite Athletic Apparel Men's
Athletic Apparel
ZCETM
SS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Men's
Short Sleeve Top
ZCETM-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCPTY-SS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Youth
Short Sleeve
Small Trim
$89
ZavaCore Elite Athletic Apparel Youth
Athletic Apparel
ZCETY
SS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Short Sleeve Top Youth
Short Sleeve Top
ZCETY-SS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Mens
Short Sleeve
Small Trim
$89
ZavaCore Elite Athletic Apparel Men's
Athletic Apparel
ZCETM
SS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Men's
Long Sleeve Top
ZCETM-LS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Womens
Long Sleeve
Small Trim
$89
ZavaCore Elite Athletic Apparel Women's
Athletic Apparel
ZCPTW
LS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Women's
Long Sleeve Top
ZCETW-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel Women's
Athletic Apparel
ZCETW-:S-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Top Youth
Long Sleeve
Small Trim
$89
ZavaCore Elite Athletic Apparel Youth
Athletic Apparel
ZCETY
LS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Long Sleeve Top Youth
Long Sleeve Top
ZCETY-LS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Sorts Mens
Athletic Shorts
Small Trim
$89
ZavaCore Elite Athletic Apparel Men's
Athletic Apparel
ZCESM
AS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Men's
Athletic Shorts
ZCESM-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Shorts Women's
Athletic Shorts
Small Trim
$89
ZavaCore Elite Athletic Apparel Women's
Athletic Apparel
ZCESW
AS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Women's
Athletic Shorts
ZCESW-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts
Athletic Shorts
ZCETS-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Shorts Youth
Athletic Shorts
Small Trim
$89
ZavaCore Elite Athletic Apparel Youth
Athletic Apparel
ZCPSY
AS
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Shorts Youth
Athletic Shorts
ZCESY-AS-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Pants Women's
Athletic Pants
Small Trim
$89
ZavaCore Elite Athletic Apparel Women's
Athletic Apparel
ZCEPW
AP
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Women's
Athletic Pants
ZCEPW-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-BO
Small
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-BO
Medium
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-BO
Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-BO
Extra Large
Black W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
Product Name
Product style
Size Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
ZavaCore Elite Pants Youth
Athletic Pants
Small Trim
$89
ZavaCore Elite Athletic Apparel Youth
Athletic Apparel
ZCEPY
AP
S Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-RR
Small
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-RR
Medium
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-RR
Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-RR
Extra Large
Deep Red W/Red Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-RR
Small
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-RR
Medium
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-RR
Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-RR
Extra Large
Drk Blue W/White Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-CS
Small
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-CS
Medium
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-CS
Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-CS
Extra Large
Char W/Silver Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-TO
Small
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-TO
Medium
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-TO
Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-TO
Extra Large
Teal W/Orange Trim
$89
ZavaCore Elite Athletic Apparel
Athletic Apparel
SKU
SIZE
Color Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-S-OB
Small
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-M-OB
Medium
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-L-OB
Large
Orange W/Blk Trim
$89
ZavaCore Elite Athletic Pants Youth
Athletic Pants
ZCEPY-AP-XL-OB
Extra Large
Orange W/Blk Trim
$89

`;async function fne(){if(!window.vad)return await new Promise((n,e)=>{const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.19.0/dist/ort.min.js",t.onload=()=>n(),t.onerror=()=>e(new Error("Failed to load ONNX Runtime script")),document.head.appendChild(t)}),new Promise((n,e)=>{const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/@ricky0123/vad-web@0.0.30/dist/bundle.min.js",t.onload=()=>n(),t.onerror=()=>e(new Error("Failed to load VAD script")),document.head.appendChild(t)})}function mne({}){const[n,e]=O.useState(()=>localStorage.getItem("gemini-api-key")||""),[t,r]=O.useState("disconnected"),[i,s]=O.useState(!1),[o,a]=O.useState(!1),[l,c]=O.useState([]),[u,h]=O.useState(""),[m,v]=O.useState(!1),[C,T]=O.useState(()=>localStorage.getItem("gemini-show-latency")==="true"),[E,x]=O.useState("medium"),[P,b]=O.useState(`You are a helpful voice assistant. You help customers find products.

When asked about products, use the get_product_inventory tool to retrieve the product catalog. Be conversational and helpful.

Keep your responses concise and natural for voice interaction. Focus on the most relevant information.`),[I,M]=O.useState(null),[N,D]=O.useState(null),j=O.useRef(null),F=O.useRef(null),z=O.useRef(null),W=O.useRef(null),H=O.useRef(null),V=O.useRef(500),K=O.useRef(null),ee=O.useRef(null),G=O.useRef(C),X=O.useRef({inputTranscript:"",outputTranscript:"",inputMessageId:null,outputMessageId:null});O.useEffect(()=>{n&&localStorage.setItem("gemini-api-key",n)},[n]),O.useEffect(()=>{localStorage.setItem("gemini-show-latency",C.toString()),G.current=C},[C]),O.useEffect(()=>{var ie;(ie=W.current)==null||ie.scrollIntoView({behavior:"smooth"})},[l.length]),O.useEffect(()=>()=>{j.current&&j.current.disconnect(),F.current&&F.current.cleanup(),z.current&&z.current.destroy()},[]),O.useEffect(()=>{F.current&&H.current&&F.current.setCircleElement(H.current)},[]);const Y=O.useCallback(ie=>{c(Se=>[...Se,ie])},[]),ce=O.useCallback((ie,Se)=>{c(re=>re.map(pe=>pe.id===ie?{...pe,content:Se}:pe))},[]);async function ae(){if(!n.trim()){M("Please enter a Gemini API key");return}j.current&&j.current.disconnect(),F.current&&F.current.cleanup(),z.current&&(z.current.destroy(),z.current=null),X.current={inputTranscript:"",outputTranscript:"",inputMessageId:null,outputMessageId:null};const ie=new une;F.current=ie,H.current&&ie.setCircleElement(H.current);const Se=new hne({apiKey:n,enableProductLookup:m,interruptionSensitivity:E,systemPrompt:P.trim()||void 0,onAudioData:re=>{z.current&&z.current.pause(),ie.queueAudioForPlayback(re)},onInputTranscript:re=>{const pe=X.current;if(pe.inputTranscript+=re,pe.inputMessageId)ce(pe.inputMessageId,pe.inputTranscript);else{const ne=crypto.randomUUID();pe.inputMessageId=ne,Y({id:ne,type:"user",content:pe.inputTranscript,timestamp:new Date})}},onOutputTranscript:re=>{const pe=X.current;if(pe.inputTranscript&&(pe.inputTranscript="",pe.inputMessageId=null),pe.outputTranscript+=re,pe.outputMessageId)ce(pe.outputMessageId,pe.outputTranscript);else{const ne=crypto.randomUUID();pe.outputMessageId=ne,Y({id:ne,type:"assistant",content:pe.outputTranscript,timestamp:new Date})}},onToolCall:re=>{X.current.outputTranscript="",X.current.outputMessageId=null,Y({id:crypto.randomUUID(),type:"system",content:`Calling function: ${re}`,timestamp:new Date})},onTurnComplete:()=>{if(G.current&&K.current!==null&&ee.current!==null){const re=Math.round(K.current+ee.current);Y({id:crypto.randomUUID(),type:"system",content:`Response latency: ${Math.round(K.current)}ms (Gemini) + ${ee.current}ms (VAD) = ${re}ms (total)`,timestamp:new Date})}z.current&&z.current.start(),X.current={inputTranscript:"",outputTranscript:"",inputMessageId:null,outputMessageId:null},K.current=null,ee.current=null},onInterrupted:()=>{ie.stopPlayback(),z.current&&z.current.start(),X.current.outputTranscript="",X.current.outputMessageId=null,Y({id:crypto.randomUUID(),type:"system",content:"[Interrupted]",timestamp:new Date})},onError:re=>{M(re)},onStatusChange:re=>{r(re),re==="disconnected"&&(X.current={inputTranscript:"",outputTranscript:"",inputMessageId:null,outputMessageId:null},D(null))},onLatencyMeasured:re=>{const pe=V.current,ne=re+pe;D(re),K.current=re,ee.current=pe,console.log(`[Gemini] Response latency: ${re.toFixed(0)}ms (Gemini) + ${pe}ms (VAD silence) = ${ne.toFixed(0)}ms (total from actual speech end)`)}});m&&Se.setProductData(pne),j.current=Se;try{M(null);const re=fne();if(await Se.connect(),await re,!window.vad)console.warn("[VAD] Failed to load VAD library, latency measurement disabled");else{const pe="/AzureVoicePlayground/";let ne=null,ve=null;const ge=.5,Ie=Math.round(ge*1e3);V.current=Ie;const fe=await window.vad.MicVAD.new({onSpeechStart:()=>{const xe=new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3});console.log(`[VAD] Speech start detected at ${xe}`),ne=performance.now(),ve=performance.now()},onFrameProcessed:xe=>{xe.isSpeech>.5&&(ve=performance.now())},onSpeechEnd:xe=>{var be;const $e=new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3}),Ge=performance.now();if(ve!==null){const gt=Ge-ve;console.log(`[VAD] Speech end detected at ${$e}`),console.log(`  - Time since last speech audio: ${gt.toFixed(0)}ms`),console.log(`  - Configured silence threshold: ${Ie}ms`),console.log(`  - Additional VAD processing overhead: ${(gt-Ie).toFixed(0)}ms`),V.current=Math.round(gt)}else console.log(`[VAD] Speech end detected at ${$e} (using configured silence threshold: ${Ie}ms)`);(be=j.current)==null||be.markSpeechEnd(),ne=null,ve=null},onVADMisfire:()=>{var $e;const xe=new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3});console.log(`[VAD] Speech too short (misfire) at ${xe}, still marking end`),($e=j.current)==null||$e.markSpeechEnd()},model:"v5",positiveSpeechThreshold:.8,negativeSpeechThreshold:ge,redemptionMs:500,preSpeechPadMs:100,minSpeechMs:250,onnxWASMBasePath:`${window.location.origin}${pe}onnx/`,baseAssetPath:`${window.location.origin}${pe}vad/`});z.current=fe,fe.start(),console.log("[VAD] Voice Activity Detection initialized")}await J()}catch(re){M(`Connection failed: ${re}`)}}async function $(){F.current&&(F.current.stopRecording(),F.current.stopPlayback()),j.current&&j.current.disconnect(),z.current&&(z.current.destroy(),z.current=null),s(!1)}async function J(){if(!(!F.current||!j.current))try{await F.current.startRecording(ie=>{var Se;(Se=j.current)==null||Se.sendAudio(ie)}),s(!0),M(null)}catch(ie){M(`Microphone access failed: ${ie}`)}}function de(){F.current&&F.current.stopRecording(),s(!1)}function me(){i?de():J()}function Te(){!u.trim()||!j.current||t!=="connected"||(Y({id:crypto.randomUUID(),type:"user",content:u,timestamp:new Date}),j.current.sendText(u),h(""))}function le(){X.current={inputTranscript:"",outputTranscript:"",inputMessageId:null,outputMessageId:null},c([])}function se(ie){switch(ie){case"user":return"bg-blue-100 text-blue-900 ml-auto";case"assistant":return"bg-gray-100 text-gray-900 mr-auto";case"system":return"bg-yellow-100 text-yellow-800 mx-auto text-xs";default:return"bg-gray-100 text-gray-900"}}return g.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[g.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[g.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 shadow-md",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-3xl font-bold",children:"Gemini Live"}),g.jsx("p",{className:"text-purple-100 mt-1",children:"Real-time voice conversation with Gemini AI"})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${t==="connected"?"bg-green-500/20 text-green-100":"bg-white/20 text-white/80"}`,children:[g.jsx("span",{className:`w-2 h-2 rounded-full ${t==="connected"?"bg-green-400":"bg-white/60"}`}),t.charAt(0).toUpperCase()+t.slice(1)]}),i&&g.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium bg-red-500/20 text-red-100",children:[g.jsx("span",{className:"w-2 h-2 rounded-full bg-red-400 animate-pulse"}),"Recording"]})]})]})}),g.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center py-8 bg-white border-b border-gray-100",style:{height:"320px"},children:[g.jsx("div",{ref:H,className:"rounded-full transition-all duration-150 ease-out flex items-center justify-center",style:{width:"120px",height:"120px",backgroundColor:"#e5e7eb"},children:o?g.jsx("svg",{className:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})}):g.jsx("svg",{className:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),t!=="connected"&&g.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Click Connect to begin conversation"})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-white",children:l.length===0?g.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[g.jsx("p",{className:"text-sm",children:"Connect and speak to start chatting with Gemini"}),m&&g.jsx("p",{className:"text-xs mt-2 text-gray-500",children:'Try asking: "What products do you have?"'})]}):g.jsxs(g.Fragment,{children:[l.map(ie=>g.jsxs("div",{className:`max-w-[80%] px-4 py-2 rounded-lg ${se(ie.type)}`,children:[g.jsx("p",{className:"whitespace-pre-wrap",children:ie.content}),g.jsx("p",{className:"text-xs opacity-60 mt-1",children:ie.timestamp.toLocaleTimeString()})]},ie.id)),g.jsx("div",{ref:W})]})}),g.jsxs("div",{className:"bg-gray-50 border-t border-gray-200 p-4",children:[g.jsxs("div",{className:"flex gap-2 mb-2",children:[g.jsx("input",{type:"text",value:u,onChange:ie=>h(ie.target.value),onKeyDown:ie=>{ie.key==="Enter"&&!ie.shiftKey&&(ie.preventDefault(),Te())},placeholder:"Type a message (or just speak)...",disabled:t!=="connected",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed"}),g.jsx("button",{onClick:Te,disabled:t!=="connected"||!u.trim(),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})}),g.jsx("button",{onClick:le,disabled:l.length===0,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Clear chat",children:g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),I&&g.jsx("p",{className:"text-xs text-red-600",children:I})]})]}),g.jsxs("div",{className:"w-full md:w-80 flex-shrink-0 bg-gray-50 border-l border-gray-200 p-6 flex flex-col overflow-y-auto",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuration"}),g.jsxs("div",{className:"space-y-4 flex-1",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gemini API Key"}),g.jsx("input",{type:"password",value:n,onChange:ie=>e(ie.target.value),disabled:t==="connected",placeholder:"Enter your API key",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100"}),g.jsx("a",{href:"https://aistudio.google.com/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-purple-600 hover:text-purple-700 underline mt-1 inline-block",children:"Get API key"})]}),g.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[g.jsxs("label",{className:"flex items-center gap-2 mb-2",children:[g.jsx("input",{type:"checkbox",checked:m,onChange:ie=>v(ie.target.checked),disabled:t==="connected",className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),g.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Product Lookup"})]}),g.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Allows Gemini to look up product information when asked"})]}),g.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[g.jsxs("label",{className:"flex items-center gap-2 mb-2",children:[g.jsx("input",{type:"checkbox",checked:C,onChange:ie=>T(ie.target.checked),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),g.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Response Latency"})]}),g.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Display response time metrics in assistant messages"})]}),g.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interruption Sensitivity"}),g.jsxs("select",{value:E,onChange:ie=>x(ie.target.value),disabled:t==="connected",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100",children:[g.jsx("option",{value:"low",children:"Low - Less likely to interrupt"}),g.jsx("option",{value:"medium",children:"Medium - Balanced"}),g.jsx("option",{value:"high",children:"High - More responsive"})]}),g.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How easily Gemini gets interrupted when you speak"})]}),g.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"System Prompt"}),g.jsx("textarea",{value:P,onChange:ie=>b(ie.target.value),disabled:t==="connected",placeholder:"Enter custom instructions for Gemini's behavior",rows:6,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100 resize-none font-mono"}),g.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Custom instructions for Gemini's behavior"})]}),g.jsx("div",{className:"pt-2",children:t!=="connected"?g.jsxs("button",{onClick:ae,disabled:!n.trim()||t==="connecting",className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{d:"M8 5v14l11-7z"})}),t==="connecting"?"Connecting...":"Connect"]}):g.jsxs("button",{onClick:$,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[g.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{d:"M6 6h12v12H6z"})}),"Disconnect"]})}),t==="connected"&&g.jsx("div",{className:"pt-2",children:g.jsxs("button",{onClick:me,className:`w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-md transition-colors ${i?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),i?"Mute Microphone":"Unmute Microphone"]})}),g.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[g.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"About"}),g.jsx("p",{className:"text-xs text-gray-600",children:"This playground demonstrates Gemini Live API integration with real-time voice conversation and optional function calling capabilities."})]})]})]})]})}const nz=["text-to-speech","speech-to-text","voice-changer","multi-talker","voice-creation","video-translation","voice-live-chat","voice-live-translator","podcast-agent","gemini-live"];function gne(){const n=window.location.hash.slice(1);return n&&nz.includes(n)?n:"text-to-speech"}function vne(){const{settings:n,updateSettings:e,isConfigured:t}=h5(),[r,i]=O.useState(gne),o=new URLSearchParams(window.location.search).has("geminilive");O.useEffect(()=>{window.location.hash=r},[r]),O.useEffect(()=>{const v=()=>{const C=window.location.hash.slice(1);C&&nz.includes(C)&&i(C)};return window.addEventListener("hashchange",v),()=>window.removeEventListener("hashchange",v)},[]);const a=p5(),l=f5(),c=m5(),u=g5(),h=S5(),m=()=>{switch(r){case"text-to-speech":return g.jsx(P9,{settings:n,onSettingsChange:e,isConfigured:t,history:a.history,addToHistory:a.addToHistory,removeFromHistory:a.removeFromHistory,clearHistory:a.clearHistory});case"speech-to-text":return g.jsx(cV,{settings:n,onSettingsChange:e,isConfigured:t,history:u.history,addToHistory:u.addToHistory,removeFromHistory:u.removeFromHistory,clearHistory:u.clearHistory});case"voice-changer":return g.jsx(mV,{settings:n,onSettingsChange:e,isConfigured:t,history:l.history,addToHistory:l.addToHistory,removeFromHistory:l.removeFromHistory,clearHistory:l.clearHistory});case"multi-talker":return g.jsx(xH,{settings:n,onSettingsChange:e,isConfigured:t,history:c.history,addToHistory:c.addToHistory,removeFromHistory:c.removeFromHistory,clearHistory:c.clearHistory});case"voice-creation":return g.jsx(uG,{settings:n});case"video-translation":return g.jsx(PG,{settings:n,isConfigured:t});case"voice-live-chat":return g.jsx(cG,{endpoint:n.voiceLiveEndpoint||"",apiKey:n.voiceLiveApiKey||""});case"voice-live-translator":return g.jsx(nG,{endpoint:n.voiceLiveEndpoint||"",apiKey:n.voiceLiveApiKey||""});case"podcast-agent":return g.jsx(YG,{settings:n,isConfigured:t,history:h.history,addToHistory:h.addToHistory,removeFromHistory:h.removeFromHistory,clearHistory:h.clearHistory});case"gemini-live":return g.jsx(mne,{});default:return null}};return g.jsxs("div",{className:"h-screen flex overflow-hidden bg-white",children:[g.jsx(T5,{activeMode:r,onModeChange:i,settings:n,onSettingsChange:e,geminiLiveEnabled:o}),m()]})}c5.createRoot(document.getElementById("root")).render(g.jsx(dB.StrictMode,{children:g.jsx(vne,{})}));
